{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/panels/background/settings.vue?50d9","webpack:///./src/App.vue?926f","webpack:///./src/components/panels/character-pack.vue?5346","webpack:///./src/components/DokiButton.vue?d8da","webpack:///./src/components/panels/general.vue?6a33","webpack:///./src/components/panels/credits.vue?7375","webpack:///./src/components/panels/character/partButton.vue?d06f","webpack:///./src/App.vue?0939","webpack:///./src/components/DokiButton.vue?a7d6","webpack:///./src/components/DokiButton.vue?b2fb","webpack:///./src/components/DokiButton.vue?4a2f","webpack:///./src/components/DokiButton.vue","webpack:///./src/components/panels/general.vue?772a","webpack:///./src/components/Toggle.vue?0863","webpack:///./src/components/Toggle.vue?459d","webpack:///./src/components/Toggle.vue?2b98","webpack:///./src/components/Toggle.vue","webpack:///./src/environments/browser.ts","webpack:///./src/environments/edge.ts","webpack:///./src/models/seekers.ts","webpack:///./src/models/variant-background.ts","webpack:///./src/models/constants.ts","webpack:///./src/models/background.ts","webpack:///./src/event-bus.ts","webpack:///./src/models/error-asset.ts","webpack:///./src/models/json-config.ts","webpack:///./src/models/merge-characters.ts","webpack:///./src/asset-manager.ts","webpack:///./src/environments/electron.ts","webpack:///./src/environments/environment.ts","webpack:///./src/components/panels/panelMixin.ts","webpack:///./src/components/panels/general.vue?9cc8","webpack:///./src/components/panels/general.vue?db34","webpack:///./src/components/panels/general.vue","webpack:///./src/components/panels/add.vue?d6c7","webpack:///./src/components/panels/add.vue?1ebe","webpack:///./src/components/panels/add.vue?f816","webpack:///./src/components/panels/add.vue","webpack:///./src/components/panels/character.vue?318a","webpack:///./src/renderer/renderAbortedException.ts","webpack:///./src/renderer/rendererContext.ts","webpack:///./src/renderer/renderer.ts","webpack:///./src/models/character.ts","webpack:///./src/components/panels/character/parts.vue?94ab","webpack:///./src/components/panels/character/partButton.vue?7602","webpack:///./src/components/panels/character/partButton.vue?50ad","webpack:///./src/components/panels/character/partButton.vue?67eb","webpack:///./src/components/panels/character/partButton.vue","webpack:///./src/components/panels/character/parts.vue?49eb","webpack:///./src/components/panels/character/parts.vue?7d4a","webpack:///./src/components/panels/character/parts.vue","webpack:///./src/components/panels/character.vue?e10f","webpack:///./src/components/panels/character.vue?a2c7","webpack:///./src/components/panels/character.vue","webpack:///./src/components/panels/sprite.vue?74c2","webpack:///./src/models/sprite.ts","webpack:///./src/components/panels/sprite.vue?31ef","webpack:///./src/components/panels/sprite.vue?35a0","webpack:///./src/components/panels/sprite.vue","webpack:///./src/components/panels/credits.vue?dad9","webpack:///./src/components/panels/credits.vue?7293","webpack:///./src/components/panels/credits.vue?9bdc","webpack:///./src/components/panels/credits.vue","webpack:///./src/components/panels/backgrounds.vue?b876","webpack:///./src/components/panels/background/button.vue?b8bf","webpack:///./src/components/panels/background/button.vue?7d63","webpack:///./src/components/panels/background/button.vue?8c6a","webpack:///./src/components/panels/background/button.vue","webpack:///./src/components/panels/background/settings.vue?f26a","webpack:///./src/components/panels/background/settings.vue?7255","webpack:///./src/components/panels/background/settings.vue?74fa","webpack:///./src/components/panels/background/settings.vue","webpack:///./src/components/panels/backgrounds.vue?aa62","webpack:///./src/components/panels/backgrounds.vue?ceea","webpack:///./src/components/panels/backgrounds.vue","webpack:///./src/components/panels/character-pack.vue?99ef","webpack:///./src/components/panels/character-pack-sanitizer.ts","webpack:///./src/components/panels/character-pack.vue?d19b","webpack:///./src/components/panels/character-pack.vue?c39c","webpack:///./src/components/panels/character-pack.vue","webpack:///./src/components/message-console.vue?9ccd","webpack:///./src/components/message-console.vue?092b","webpack:///./src/components/message-console.vue?1d97","webpack:///./src/components/message-console.vue","webpack:///./src/models/textbox.ts","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/main.ts","webpack:///./src/components/panels/background/button.vue?5b91","webpack:///./src/components/panels/backgrounds.vue?d745","webpack:///./src/components/Toggle.vue?720b","webpack:///./src/components/message-console.vue?5df7","webpack:///./src/components/panels/character/parts.vue?5949","webpack:///./src/components/panels/add.vue?7fb0","webpack:///./src/components/panels/sprite.vue?19cd","webpack:///./src/components/panels/character.vue?4387"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","ref","style","width","canvasWidth","height","canvasHeight","on","onUiClick","onTouchStart","onDragStart","onSpriteDragMove","onSpriteDrop","onDragOver","onDrop","onMouseEnter","_v","class","vertical","currentlyRendering","active","panel","$event","download","textbox","prevRender","lqRendering","nsfw","showPreviousRender","_e","characterVersion","onCharacterCreate","onAssetCreate","invalidateRender","model","callback","$$v","currentBackground","expression","selectedCharacter","onObjectLayerShift","selectedSprite","staticRenderFns","staticClass","$emit","_t","components","component","hasPrevRender","options","$set","directives","rawName","$$selectedVal","Array","filter","target","selected","map","val","_value","multiple","domProps","composing","_m","_uid","onChange","_s","label","event","$refs","checkbox","checked","type","String","Boolean","default","allowLQ","downloadCanvas","filename","a","document","createElement","setAttribute","createObjectURL","url","body","appendChild","click","removeChild","background","Error","message","defaultValue","Promise","resolve","reject","prompt","handler","canvas","toBlob","URL","blob","toDataURL","dataURItoBlob","dataURI","binStr","atob","split","len","arr","Uint8Array","charCodeAt","Blob","navigator","msSaveBlob","nsfwArraySeeker","array","pos","delta","basefolder","variants","flip","variantI","variant","images","img","replace","path","rx","all","getAsset","hq","assets","asset","drawImage","image","x","y","positions","screenWidth","screenHeight","characterPositions","custom","scale","installed","HTMLImageElement","w","h","ratio","screenRatio","color","render","drawRect","fill","transparent","seekVariant","eventBus","fire","kind","subscribe","eventType","$on","unsubscribe","$off","error","normalizeCharacter","character","paths","charFolder","folder","id","internalId","chibi","normalizeUrl","appendUrl","undefined","eyes","normalizeParts","hairs","styles","normalizeStyles","heads","normalizeHeads","poses","normalizePoses","styleClasses","baseFolder","ret","styleKey","headGroupKey","headGroup","newHeadGroup","normalizeNsfwAbleCollection","offset","size","subFolder","base","sub","startsWith","isWebUrl","pose","poseFolder","compatibleHeads","headAnchor","headInForeground","static","left","right","collection","str","moveCharacterNsfw","moveHeadGroupNsfw","head","movePoseNsfw","part","moveStyleNsfw","matchingPoses","matchingPose","mergeCharacters","characterA","characterB","collidingStyle","find","oldStyle","oldHeadGroup","collidingPose","poseA","console","oldCollection","newCollection","freezeAssetUrls","eyeKey","registerAssetWithURL","hairKey","poseKey","webpSupportPromise","characterOrder","isWebPSupported","losslessCode","addEventListener","src","assetCache","customAssets","baseUrl","environment","Image","crossOrigin","display","registerAsset","file","backgrounds","loadCharacterPack","filePath","parts","baseDir","join","fetch","response","json","packId","indexOf","existing","electron","promptCache","lastPrompt","ipcRenderer","e","queuedUninstall","credits","packCredits","filepath","log","send","arrayBuffer","buffer","newUrl","chooseEnv","isElectron","msSaveOrOpenBlob","envX","toast","$el","currentTarget","classList","contains","ev","deltaY","mozInputSource","scrollLeft","passive","talking","required","Toggle","_l","assetPath","upload","onFileUpload","uploadFromURL","customAssetCount","lq","uploadInput","files","nr","panelForParts","hasMultiplePoses","seekStyle","seekPose","seekPart","captialize","allowFreeMove","modifiers","_n","stopPropagation","$forceUpdate","positionNames","move","fsCtx","preview","aborted","params","save","font","align","text","lineJoin","textAlign","outline","strokeStyle","lineWidth","strokeText","fillStyle","fillText","restore","measureText","opacity","globalAlpha","shadow","shadowColor","blur","shadowBlur","offsetX","shadowOffsetX","offsetY","shadowOffsetY","translate","paintOnto","beginPath","rect","stroke","runningContext","previewCanvas","renderCallback","abort","ctx","getContext","clearRect","context","saveToFile","getImageData","BaseCharacterYPos","CloseUpYOffset","invalidator","infront","close","styleData","lastBase","posePositions","headType","poseId","styleId","localRenderer","dirty","hitDetectionFallback","freeMove","pPos","pX","pY","partKeys","getParts","currentHeads","protectHeadGroup","ensurePoseIntegrity","headAsset","bodyParts","drawHead","bodyPart","updateLocalCanvas","zoom","hx","hy","getDataAt","DOMException","includes","Math","abs","headKey","seekHead","groupFound","compatibleHead","group","sorted","idx","sort","b","oldHeadCollection","newHeadCollectionNr","allow","closestCharacterSlot","partList","index","choose","choose_eyes","choose_hairs","lookup","lookup2","lookup3","loaded","image1","image2","floor","scaleX","scaleY","baseStyle","backgroundPosition","backgroundSize","backgroundImage","Number","reducedName","selection","subEyes","subHairs","setPart","updatePose","parseInt","headTypeIdx","headIdx","keys","headKeyIdx","poseIdx","generatePosePreview","dedupedStyles","styleIdx","partIdx","eyesColl","hairsColl","iEyes","exp","RegExp","match","iHair","fullName","PartButton","charAt","toUpperCase","substring","hasMultiple","Parts","sprite","setWidth","setHeight","lockedRatio","setRatioLock","BaseXPosition","assetName","then","catch","err","hitX","hitY","lock","customPathLookup","nsfwFilter","backgroundColor","colorBackground","install","uninstall","installBackground","uninstallBackground","hasVariants","isBackgroundInstallingSupported","customBGCount","bg","BackgroundButton","BackgroundSettings","addNew","pack","select","activate","deactivate","restart","allowedTags","allowedAttributes","schemaLimitedAttributes","allowedSchemas","enforceAttributes","rel","sanitize","html","retDoc","doc","innerHTML","from","childNodes","node","sanitizeElement","sanitizedNode","protocolMatcher","nodeType","Node","ELEMENT_NODE","el","tagName","toLowerCase","attributes","allowedAttrs","attr","protocolMatch","removeAttribute","enforce","attrName","createTextNode","subNode","concat","selectedPack","temporaryPacks","installedPacks","needRestart","packs","installedCharacterPacks","freshInstall","location","reload","installContentPack","uninstallContentPack","activateContentPack","deactivateContentPack","isPackInstallingSupported","messages","showLoading","showLoadingTimeout","hideLoadingTimeout","onLoadingChange","loading","setTimeout","pop","newValue","clearTimeout","ScreenWidth","TextBoxWidth","TextBoxCorruptedWidth","TextBoxY","TextBoxKerning","TextBoxLineHeight","TextBoxCorruptedKerning","TextBoxTextXOffset","TextBoxTextYOffset","TextBoxTextCorruptedXOffset","TextBoxTextCorruptedYOffset","NameboxHeight","NameboxWidth","NameboxXOffset","NameboxTextYOffset","ControlsYOffset","ControlsXHistoryOffset","ControlsXSkipOffset","ControlsXStuffOffset","ArrowX","ArrowY","NameboxTextStyle","ControlsTextStyle","ControlsTextDisabledStyle","TextBoxStyle","TextBoxCorruptedStyle","TextBoxX","TextBoxCorruptedX","TextBoxTextX","TextBoxTextY","NameboxY","NameboxX","NameboxTextX","NameboxTextY","ControlsY","ControlsXHistory","ControlsXSkip","ControlsXStuff","corrupted","showControls","allowSkipping","showContinueArrow","autoQuote","customName","dialog","drawText","renderText","line","cl","letter","ct","cb","characters","renderer","showUI","uiSize","queuedRender","showingLast","dropSpriteCount","dropPreventClick","draggedObject","dragXOffset","dragYOffset","dragXOriginal","dragYOriginal","newCharacter","oldCharacter","unselect","newSprite","oldSprite","newPanel","requestAnimationFrame","render_","cancelAnimationFrame","completed","cats","updateArea","removeEventListener","onKeydown","onPanelChange","sd","sdCtx","keyCode","alert","sw","sh","rh","rw","opth","optimum","optv","optimizeWithMenu","documentElement","clientWidth","clientHeight","cw","ch","v","$nextTick","revokeObjectURL","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","onload","offsetLeft","ry","offsetTop","sx","offsetWidth","sy","toRendererCoordinate","clientX","clientY","reset","selectedObject","objectsAt","currentCharacterIdx","hitTest","targetIdx","unshift","preventDefault","touches","dataTransfer","dropEffect","MouseEvent","deltaX","shiftKey","items","item","getAsFile","TouchEvent","buttons","newNSFW","nsfwCheck","deep","DokiButton","GeneralPanel","AddPanel","BackgroundsPanel","CreditsPanel","CharacterPanel","SpritePanel","MessageConsole","CharacterPack","config","productionTip","$mount"],"mappings":"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","file":"js/app.0d303b3b.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=4faf2618&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=4faf2618&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character-pack.vue?vue&type=style&index=0&id=749bf0f8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character-pack.vue?vue&type=style&index=0&id=749bf0f8&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DokiButton.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DokiButton.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=style&index=0&id=0440f908&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=style&index=0&id=0440f908&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=8f65fc3e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=8f65fc3e&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=e0ad2e54&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=e0ad2e54&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{attrs:{\"id\":\"container\"}},[_c('canvas',{ref:\"sd\",style:({width: _vm.canvasWidth+ 'px', height: _vm.canvasHeight + 'px'}),attrs:{\"id\":\"scaled_display\",\"height\":\"720\",\"width\":\"1280\",\"draggable\":\"\"},on:{\"click\":_vm.onUiClick,\"touchstart\":_vm.onTouchStart,\"dragstart\":_vm.onDragStart,\"touchmove\":_vm.onSpriteDragMove,\"mousemove\":_vm.onSpriteDragMove,\"touchend\":_vm.onSpriteDrop,\"mouseup\":_vm.onSpriteDrop,\"dragover\":_vm.onDragOver,\"drop\":_vm.onDrop,\"mouseenter\":_vm.onMouseEnter}},[_vm._v(\"HTML5 is required to use the Doki Doki Dialog Generator.\")])]),_c('message-console',{class:{ vertical: _vm.vertical },attrs:{\"loading\":_vm.currentlyRendering,\"id\":\"messages\"}}),_c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"panels\"}},[_c('div',{attrs:{\"id\":\"toolbar\"}},[_c('button',{class:{ active: _vm.panel === 'add' },on:{\"click\":function($event){_vm.panel = _vm.panel === 'add' ? '' : 'add'}}},[_vm._v(\"A\")]),_c('button',{class:{ active: _vm.panel === 'backgrounds' },on:{\"click\":function($event){_vm.panel = _vm.panel === 'backgrounds' ? '' : 'backgrounds'}}},[_vm._v(\"B\")]),_c('button',{class:{ active: _vm.panel === 'credits' },on:{\"click\":function($event){_vm.panel = _vm.panel === 'credits' ? '' : 'credits'}}},[_vm._v(\"C\")]),_c('button',{on:{\"click\":_vm.download}},[_vm._v(\"D\")])]),_c('keep-alive',[(_vm.panel === '')?_c('general-panel',{attrs:{\"options\":_vm.textbox,\"vertical\":_vm.vertical,\"has-prev-render\":_vm.prevRender !== '',\"lqRendering\":_vm.lqRendering,\"nsfw\":_vm.nsfw},on:{\"update:lqRendering\":function($event){_vm.lqRendering=$event},\"update:lq-rendering\":function($event){_vm.lqRendering=$event},\"update:nsfw\":function($event){_vm.nsfw=$event},\"open-panel\":function($event){_vm.panel = $event},\"show-prev-render\":_vm.showPreviousRender}}):_vm._e(),(_vm.panel === 'character-packs')?_c('character-pack',{attrs:{\"vertical\":_vm.vertical},on:{\"show-prev-render\":_vm.showPreviousRender,\"change\":function($event){++_vm.characterVersion}}}):_vm._e(),(_vm.panel === 'add')?_c('add-panel',{key:_vm.characterVersion,attrs:{\"vertical\":_vm.vertical},on:{\"chosen\":_vm.onCharacterCreate,\"add-custom-asset\":_vm.onAssetCreate}}):_vm._e(),(_vm.panel === 'backgrounds')?_c('backgrounds-panel',{attrs:{\"vertical\":_vm.vertical,\"nsfw\":_vm.nsfw},on:{\"invalidate-render\":_vm.invalidateRender},model:{value:(_vm.currentBackground),callback:function ($$v) {_vm.currentBackground=$$v},expression:\"currentBackground\"}}):_vm._e(),(_vm.panel === 'credits')?_c('credits-panel',{attrs:{\"vertical\":_vm.vertical}}):_vm._e(),(_vm.panel === 'character')?_c('character-panel',{ref:\"characters\",attrs:{\"vertical\":_vm.vertical,\"character\":_vm.selectedCharacter,\"nsfw\":_vm.nsfw},on:{\"shiftLayer\":_vm.onObjectLayerShift,\"invalidate-render\":_vm.invalidateRender}}):_vm._e(),(_vm.panel === 'sprite')?_c('sprite-panel',{attrs:{\"vertical\":_vm.vertical,\"sprite\":_vm.selectedSprite},on:{\"shiftLayer\":_vm.onObjectLayerShift,\"invalidate-render\":_vm.invalidateRender}}):_vm._e()],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"btn\",on:{\"click\":function($event){return _vm.$emit('click')}}},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class DokiButton extends Vue {}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DokiButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DokiButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./DokiButton.vue?vue&type=template&id=94e8b21e&\"\nimport script from \"./DokiButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./DokiButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./DokiButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"General\")]),_c('a',{staticClass:\"btn_link\",attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/edave64/Doki-Doki-Dialog-Generator/blob/v-1.5/docs/index.md\"}},[_vm._v(\"Help\")]),(_vm.allowsLQ)?_c('toggle',{attrs:{\"label\":\"Low quality preview?\",\"title\":\"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.\",\"value\":_vm.lqRendering},on:{\"input\":function($event){return _vm.$emit('update:lqRendering', $event)}}}):_vm._e(),_c('button',{attrs:{\"disabled\":!_vm.hasPrevRender},on:{\"click\":function($event){return _vm.$emit('show-prev-render')}}},[_vm._v(\"Compare to last download\")]),_c('button',{on:{\"click\":function($event){return _vm.$emit('open-panel', 'character-packs')}}},[_vm._v(\"Content Packs\")]),_c('toggle',{attrs:{\"label\":\"NSFW Mode?\",\"value\":_vm.nsfw},on:{\"input\":function($event){return _vm.$emit('update:nsfw', $event)}}}),_c('toggle',{attrs:{\"label\":\"Textbox visible?\"},model:{value:(_vm.options.display),callback:function ($$v) {_vm.$set(_vm.options, \"display\", $$v)},expression:\"options.display\"}}),_c('toggle',{attrs:{\"label\":\"Textbox corrupt?\"},model:{value:(_vm.options.corrupted),callback:function ($$v) {_vm.$set(_vm.options, \"corrupted\", $$v)},expression:\"options.corrupted\"}}),_c('toggle',{attrs:{\"label\":\"Auto quoting?\"},model:{value:(_vm.options.autoQuote),callback:function ($$v) {_vm.$set(_vm.options, \"autoQuote\", $$v)},expression:\"options.autoQuote\"}}),_c('div',[_c('label',{attrs:{\"for\":\"current_talking\"}},[_vm._v(\"Person talking:\")]),_c('br'),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.options.talking),expression:\"options.talking\"}],attrs:{\"id\":\"current_talking\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.options, \"talking\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"No-one\")]),_c('option',{attrs:{\"value\":\"Sayori\"}},[_vm._v(\"Sayori\")]),_c('option',{attrs:{\"value\":\"Yuri\"}},[_vm._v(\"Yuri\")]),_c('option',{attrs:{\"value\":\"Natsuki\"}},[_vm._v(\"Natsuki\")]),_c('option',{attrs:{\"value\":\"Monika\"}},[_vm._v(\"Monika\")]),_c('option',{attrs:{\"value\":\"FeMC\"}},[_vm._v(\"FeMC\")]),_c('option',{attrs:{\"value\":\"MC\"}},[_vm._v(\"MC\")]),_c('option',{attrs:{\"value\":\"Amy\"}},[_vm._v(\"Amy\")]),_c('option',{attrs:{\"value\":\"other\"}},[_vm._v(\"Other\")])])]),_c('div',[_c('label',{attrs:{\"for\":\"custom_name\"}},[_vm._v(\"Other name:\")]),_c('br'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.options.customName),expression:\"options.customName\"}],attrs:{\"id\":\"custom_name\"},domProps:{\"value\":(_vm.options.customName)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.options, \"customName\", $event.target.value)}}})]),_c('toggle',{attrs:{\"label\":\"Controls visible?\"},model:{value:(_vm.options.showControls),callback:function ($$v) {_vm.$set(_vm.options, \"showControls\", $$v)},expression:\"options.showControls\"}}),_c('toggle',{attrs:{\"label\":\"Able to skip?\"},model:{value:(_vm.options.allowSkipping),callback:function ($$v) {_vm.$set(_vm.options, \"allowSkipping\", $$v)},expression:\"options.allowSkipping\"}}),_c('toggle',{attrs:{\"label\":\"Continue arrow?\"},model:{value:(_vm.options.showContinueArrow),callback:function ($$v) {_vm.$set(_vm.options, \"showContinueArrow\", $$v)},expression:\"options.showContinueArrow\"}}),_c('div',{attrs:{\"id\":\"dialog_text_wrapper\"}},[_c('label',{attrs:{\"for\":\"dialog_text\"}},[_vm._v(\"Dialog:\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.options.dialog),expression:\"options.dialog\"}],attrs:{\"id\":\"dialog_text\"},domProps:{\"value\":(_vm.options.dialog)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.options, \"dialog\", $event.target.value)}}})]),_vm._m(0)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tFormatting:\\n\\t\\t\"),_c('br'),_vm._v(\"[In brackets] for editied style text\\n\\t\")])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{ref:\"checkbox\",attrs:{\"id\":_vm._uid,\"type\":\"checkbox\"},domProps:{\"checked\":_vm.value},on:{\"change\":_vm.onChange}}),_c('label',{attrs:{\"for\":_vm._uid}},[_vm._v(_vm._s(_vm.label))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class Toggle extends Vue {\r\n\t@Prop({ type: String }) private label!: string | undefined;\r\n\t@Prop({ type: Boolean, default: false }) private value!: boolean;\r\n\r\n\tprivate onChange(event: Event) {\r\n\t\tthis.$emit('input', !!(this.$refs.checkbox as HTMLInputElement).checked);\r\n\t}\r\n\r\n\tprivate get checkbox(): HTMLInputElement {\r\n\t\treturn this.$refs.checkbox as HTMLInputElement;\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toggle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toggle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Toggle.vue?vue&type=template&id=7e803566&scoped=true&\"\nimport script from \"./Toggle.vue?vue&type=script&lang=ts&\"\nexport * from \"./Toggle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Toggle.vue?vue&type=style&index=0&id=7e803566&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7e803566\",\n  null\n  \n)\n\nexport default component.exports","import { IEnvironment, IPack } from './environment';\r\nimport { IBackground } from '@/models/background';\r\n\r\nexport class Browser implements IEnvironment {\r\n\tpublic readonly allowLQ = true;\r\n\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\tconst a = document.createElement('a');\r\n\t\ta.setAttribute('download', filename);\r\n\t\tconst url = await this.createObjectURL(downloadCanvas);\r\n\t\ta.setAttribute('href', url);\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tdocument.body.removeChild(a);\r\n\t\treturn url;\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic installBackground(background: IBackground): boolean {\r\n\t\tthrow new Error('This environment does not support installing backgrounds');\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallBackground(background: IBackground): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling backgrounds'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\tpublic activateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tresolve(prompt(message, defaultValue));\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\treturn;\r\n\t}\r\n\r\n\tprotected createObjectURL(canvas: HTMLCanvasElement): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (canvas.toBlob && window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tcanvas.toBlob(blob => {\r\n\t\t\t\t\tif (!blob) {\r\n\t\t\t\t\t\treject();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t\t}, 'image/png');\r\n\t\t\t} else if (window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tconst url = canvas.toDataURL();\r\n\t\t\t\tconst blob = this.dataURItoBlob(url);\r\n\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t} else {\r\n\t\t\t\tresolve(canvas.toDataURL());\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected dataURItoBlob(dataURI: string) {\r\n\t\tconst binStr = atob(dataURI.split(',')[1]);\r\n\t\tconst len = binStr.length;\r\n\t\tconst arr = new Uint8Array(len);\r\n\r\n\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\tarr[i] = binStr.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\treturn new Blob([arr], { type: 'image/png' });\r\n\t}\r\n}\r\n","import { Browser } from './browser';\r\n\r\nexport class Edge extends Browser {\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\tlet url = downloadCanvas.toDataURL();\r\n\t\tconst blob = this.dataURItoBlob(url);\r\n\r\n\t\tif (window.URL && window.URL.createObjectURL) {\r\n\t\t\turl = URL.createObjectURL(blob);\r\n\t\t}\r\n\r\n\t\t// IE-specific code\r\n\t\twindow.navigator.msSaveBlob(blob, filename);\r\n\t\treturn url;\r\n\t}\r\n}\r\n","export function arraySeeker(array: any[], pos: number, delta: number) {\r\n\tlet val = pos + delta;\r\n\tconst length = array.length;\r\n\r\n\tif (val < 0) {\r\n\t\tval += length;\r\n\t}\r\n\tif (val >= length) {\r\n\t\tval -= length;\r\n\t}\r\n\treturn val;\r\n}\r\n\r\nexport function nsfwArraySeeker(\r\n\tarray: Array<{ nsfw?: boolean }>,\r\n\tpos: number,\r\n\tdelta: number,\r\n\tnsfw: boolean\r\n) {\r\n\tlet val = pos;\r\n\tconst length = array.length;\r\n\tdo {\r\n\t\tval += delta;\r\n\t\tif (val < 0) {\r\n\t\t\tval += length;\r\n\t\t}\r\n\t\tif (val >= length) {\r\n\t\t\tval -= length;\r\n\t\t}\r\n\t} while (array[val].nsfw && !nsfw);\r\n\treturn val;\r\n}\r\n","import { IBackground } from './background';\r\nimport { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset } from '@/asset-manager';\r\nimport { nsfwArraySeeker } from './seekers';\r\n\r\n// Formatter quirk\r\n// tslint:disable:indent\r\ntype VariantParam =\r\n\t| string[]\r\n\t| {\r\n\t\t\tnsfw: boolean;\r\n\t\t\timages: string[];\r\n\t  };\r\n// tslint:enable:indent\r\n\r\ninterface IVariant {\r\n\tnsfw: boolean;\r\n\timages: string[];\r\n}\r\n\r\nexport class VariantBackground implements IBackground {\r\n\tpublic readonly path: string;\r\n\tpublic flip: boolean = false;\r\n\tpublic readonly variants: IVariant[];\r\n\tprivate variantI: number = 0;\r\n\r\n\tpublic constructor(\r\n\t\tpublic readonly name: string,\r\n\t\treadonly basefolder: string,\r\n\t\tvariants: VariantParam[],\r\n\t\tpublic readonly nsfw = false\r\n\t) {\r\n\t\tthis.variants = variants.map(variant => {\r\n\t\t\tif (variant instanceof Array) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\timages: variant.map(img => (basefolder + img).replace(/\\/+/g, '/')),\r\n\t\t\t\t\tnsfw: false,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\timages: variant.images.map(img =>\r\n\t\t\t\t\t(basefolder + img).replace(/\\/+/g, '/')\r\n\t\t\t\t),\r\n\t\t\t\tnsfw: variant.nsfw,\r\n\t\t\t};\r\n\t\t});\r\n\t\tthis.path = this.variants[0].images[0];\r\n\t}\r\n\r\n\tpublic get variant(): number {\r\n\t\treturn this.variantI;\r\n\t}\r\n\r\n\tpublic hasVariants(nsfw: boolean): boolean {\r\n\t\treturn (\r\n\t\t\tthis.variants.filter(variant => {\r\n\t\t\t\treturn !variant.nsfw || nsfw;\r\n\t\t\t}).length > 1\r\n\t\t);\r\n\t}\r\n\r\n\tpublic seekVariant(delta: 1 | -1, nsfw: boolean) {\r\n\t\tthis.variantI = nsfwArraySeeker(this.variants, this.variantI, delta, nsfw);\r\n\t}\r\n\r\n\tpublic async render(rx: RenderContext): Promise<void> {\r\n\t\tconst assets = await Promise.all(\r\n\t\t\tthis.variants[this.variantI].images.map(img => getAsset(img, rx.hq))\r\n\t\t);\r\n\t\tfor (const asset of assets) {\r\n\t\t\trx.drawImage({ image: asset, x: 0, y: 0, flip: this.flip });\r\n\t\t}\r\n\t}\r\n}\r\n","export const positions = [\r\n\t'4-1',\r\n\t'3-1',\r\n\t'2-1',\r\n\t'4-2',\r\n\t'center',\r\n\t'4-3',\r\n\t'2-2',\r\n\t'3-3',\r\n\t'4-4',\r\n];\r\n\r\nexport const screenWidth = 1280;\r\nexport const screenHeight = 720;\r\n\r\nexport const characterPositions = [\r\n\t200,\r\n\t240,\r\n\t400,\r\n\t493,\r\n\t640,\r\n\t786,\r\n\t880,\r\n\t1040,\r\n\t1080,\r\n];\r\n\r\nexport const poses = {\r\n\tsayori: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tyuri: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tnatsuki: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tmonika: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n};\r\n","import { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset } from '@/asset-manager';\r\nimport { VariantBackground } from './variant-background';\r\nimport { screenWidth, screenHeight } from './constants';\r\n\r\nexport interface IBackground {\r\n\tname: string;\r\n\tnsfw?: boolean;\r\n\trender(rx: RenderContext): Promise<void>;\r\n}\r\n\r\nexport class Background implements IBackground {\r\n\tpublic readonly path: string;\r\n\tpublic flip: boolean = false;\r\n\tpublic constructor(\r\n\t\tpath: string,\r\n\t\tpublic readonly name: string,\r\n\t\tpublic readonly nsfw: boolean = false,\r\n\t\tpublic readonly custom: boolean = false,\r\n\t\tpublic readonly scale: string = '',\r\n\t\tpublic installed: boolean = false\r\n\t) {\r\n\t\tthis.path = (custom ? '' : '/backgrounds/') + path;\r\n\t}\r\n\r\n\tpublic async render(rx: RenderContext): Promise<void> {\r\n\t\tconst image = await getAsset(this.path, rx.hq);\r\n\t\tif (!(image instanceof HTMLImageElement)) return;\r\n\t\tlet x = 0;\r\n\t\tlet y = 0;\r\n\t\tlet w = image.width;\r\n\t\tlet h = image.height;\r\n\r\n\t\tswitch (this.scale) {\r\n\t\t\tcase '':\r\n\t\t\t\tx = screenWidth / 2 - w / 2;\r\n\t\t\t\ty = screenHeight / 2 - h / 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'stretch':\r\n\t\t\t\tw = screenWidth;\r\n\t\t\t\th = screenHeight;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'cover':\r\n\t\t\t\tconst ratio = w / h;\r\n\t\t\t\tconst screenRatio = screenWidth / screenHeight;\r\n\r\n\t\t\t\tif (ratio > screenRatio) {\r\n\t\t\t\t\th = screenHeight;\r\n\t\t\t\t\tw = h * ratio;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tw = screenWidth;\r\n\t\t\t\t\th = w / ratio;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tx = screenWidth / 2 - w / 2;\r\n\t\t\t\ty = screenHeight / 2 - h / 2;\r\n\t\t}\r\n\r\n\t\trx.drawImage({\r\n\t\t\timage,\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tw,\r\n\t\t\th,\r\n\t\t\tflip: this.flip,\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport const color = {\r\n\tname: 'Static color',\r\n\tcolor: '#000000',\r\n\r\n\tasync render(rx: RenderContext): Promise<void> {\r\n\t\trx.drawRect({ x: 0, y: 0, w: 1280, h: 720, fill: { style: this.color } });\r\n\t},\r\n};\r\n\r\nexport const transparent = {\r\n\tname: 'Transparent',\r\n\t// tslint:disable-next-line: no-empty\r\n\tasync render(rx: RenderContext): Promise<void> {},\r\n};\r\n\r\nexport function nsfwFilter(background: IBackground) {\r\n\tif (\r\n\t\tbackground instanceof VariantBackground &&\r\n\t\tbackground.variants[background.variant].nsfw\r\n\t) {\r\n\t\tbackground.seekVariant(1, false);\r\n\t}\r\n}\r\n","import Vue from 'vue';\r\n\r\nconst eventBus = new Vue();\r\n\r\nexport default {\r\n\tfire(event: IEvent) {\r\n\t\teventBus.$emit(event.kind, event);\r\n\t},\r\n\r\n\tsubscribe<T extends IEvent>(\r\n\t\teventType: IEventClass<T>,\r\n\t\thandler: (ev: T) => void\r\n\t) {\r\n\t\teventBus.$on(eventType.kind, handler);\r\n\t},\r\n\r\n\tunsubscribe<T extends IEvent>(\r\n\t\teventType: IEventClass<T>,\r\n\t\thandler: (ev: T) => void\r\n\t) {\r\n\t\teventBus.$off(eventType.kind, handler);\r\n\t},\r\n};\r\n\r\ninterface IEvent {\r\n\tkind: string;\r\n}\r\n\r\ninterface IEventClass<T> {\r\n\tkind: string;\r\n\tnew (...args: any[]): T;\r\n}\r\n\r\n// tslint:disable: max-classes-per-file\r\n\r\nexport class AssetFailureEvent implements IEvent {\r\n\tpublic static readonly kind = 'AssetFailureEvent';\r\n\tpublic readonly kind = 'AssetFailureEvent';\r\n\tpublic constructor(public path: string) {}\r\n}\r\n\r\nexport class CustomAssetFailureEvent implements IEvent {\r\n\tpublic static readonly kind = 'CustomAssetFailureEvent';\r\n\tpublic readonly kind = 'CustomAssetFailureEvent';\r\n\tpublic constructor(public error: ErrorEvent) {}\r\n}\r\n\r\nexport class ShowMessageEvent implements IEvent {\r\n\tpublic static readonly kind = 'ShowMessageEvent';\r\n\tpublic readonly kind = 'ShowMessageEvent';\r\n\tpublic constructor(public message: string) {}\r\n}\r\n","export class ErrorAsset {}\r\n","import {\r\n\tICharacter,\r\n\tHeads,\r\n\tINsfwAbleImg,\r\n\tIHeads,\r\n\tPose,\r\n\tIStyle,\r\n\tIStyleClasses,\r\n} from '@/asset-manager';\r\n\r\nexport function normalizeCharacter(\r\n\tcharacter: IJSONCharacter<JSONHeads>,\r\n\tpaths: IPaths\r\n): ICharacter<any> {\r\n\tconst charFolder = character.folder || '/';\r\n\treturn {\r\n\t\tid: character.id,\r\n\t\tinternalId: character.internalId,\r\n\t\tname: character.name,\r\n\t\tnsfw: !!character.nsfw,\r\n\t\tchibi: character.chibi\r\n\t\t\t? normalizeUrl(appendUrl(charFolder, character.chibi, paths), paths)\r\n\t\t\t: undefined,\r\n\t\teyes: normalizeParts(character.eyes, charFolder, paths),\r\n\t\thairs: normalizeParts(character.hairs, charFolder, paths),\r\n\t\tstyles: normalizeStyles(character.styles),\r\n\t\theads: normalizeHeads(character.heads, charFolder, paths),\r\n\t\tposes: normalizePoses(character.poses, charFolder, paths),\r\n\t} as ICharacter<any>;\r\n}\r\n\r\nfunction normalizeParts(\r\n\tstyleClasses: IJSONStyleClasses | undefined,\r\n\tbaseFolder: string,\r\n\tpaths: IPaths\r\n): IStyleClasses {\r\n\tif (!styleClasses) return {};\r\n\tconst ret: IStyleClasses = {};\r\n\tfor (const styleKey in styleClasses) {\r\n\t\tif (!styleClasses.hasOwnProperty(styleKey)) continue;\r\n\t\tret[styleKey] = normalizeUrl(\r\n\t\t\tappendUrl(baseFolder, styleClasses[styleKey], paths),\r\n\t\t\tpaths\r\n\t\t);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nfunction normalizeHeads(\r\n\theads: JSONHeads,\r\n\tbaseFolder: string,\r\n\tpaths: IPaths\r\n): Heads {\r\n\tconst ret: Heads = {};\r\n\r\n\tfor (const headGroupKey in heads) {\r\n\t\tif (!heads.hasOwnProperty(headGroupKey)) continue;\r\n\t\tconst headGroup = heads[headGroupKey];\r\n\t\tlet newHeadGroup: IHeads;\r\n\t\tif (headGroup instanceof Array) {\r\n\t\t\tnewHeadGroup = {\r\n\t\t\t\tall: normalizeNsfwAbleCollection(headGroup, baseFolder, paths),\r\n\t\t\t\tnsfw: false,\r\n\t\t\t\toffset: [290, 70],\r\n\t\t\t\tsize: [380, 380],\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tconst subFolder = appendUrl(baseFolder, headGroup.folder, paths);\r\n\t\t\tnewHeadGroup = {\r\n\t\t\t\tall: normalizeNsfwAbleCollection(headGroup.all, subFolder, paths),\r\n\t\t\t\tnsfw: !!headGroup.nsfw,\r\n\t\t\t\toffset: headGroup.offset || [290, 70],\r\n\t\t\t\tsize: headGroup.size || [380, 380],\r\n\t\t\t};\r\n\t\t}\r\n\t\tret[headGroupKey] = newHeadGroup;\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n\r\nfunction appendUrl(base: string, sub: string | undefined, paths: IPaths) {\r\n\tif (!sub) return base;\r\n\tfor (const path in paths) {\r\n\t\tif (sub.startsWith(path)) {\r\n\t\t\treturn sub;\r\n\t\t}\r\n\t}\r\n\tif (sub[0] === '/' || isWebUrl(sub)) {\r\n\t\treturn sub;\r\n\t}\r\n\treturn base + sub;\r\n}\r\n\r\nfunction isWebUrl(path: string) {\r\n\treturn (\r\n\t\tpath.startsWith('blob:') ||\r\n\t\tpath.startsWith('http://') ||\r\n\t\tpath.startsWith('https://') ||\r\n\t\tpath.startsWith('://')\r\n\t);\r\n}\r\n\r\nfunction normalizePoses(\r\n\tposes: Array<JSONPose<JSONHeads>>,\r\n\tbaseFolder: string,\r\n\tpaths: IPaths\r\n): Array<Pose<Heads>> {\r\n\treturn poses.map(pose => {\r\n\t\tconst poseFolder = appendUrl(baseFolder, pose.folder, paths);\r\n\t\tconst ret = ({\r\n\t\t\tcompatibleHeads: pose.compatibleHeads,\r\n\t\t\theadAnchor: pose.headAnchor || [0, 0],\r\n\t\t\theadInForeground: !!pose.headInForeground,\r\n\t\t\tname: pose.name,\r\n\t\t\tnsfw: !!pose.nsfw,\r\n\t\t\tstyle: pose.style,\r\n\t\t\toffset: [0, 0],\r\n\t\t\tsize: [960, 960],\r\n\t\t} as Pose<Heads>) as any;\r\n\r\n\t\tif ('static' in pose) {\r\n\t\t\tret.static = normalizeUrl(poseFolder + pose.static, paths);\r\n\t\t} else if ('variant' in pose) {\r\n\t\t\tret.variant = normalizeNsfwAbleCollection(\r\n\t\t\t\tpose.variant,\r\n\t\t\t\tposeFolder,\r\n\t\t\t\tpaths\r\n\t\t\t);\r\n\t\t} else if ('left' in pose) {\r\n\t\t\tret.left = normalizeNsfwAbleCollection(pose.left, poseFolder, paths);\r\n\t\t\tret.right = normalizeNsfwAbleCollection(pose.right, poseFolder, paths);\r\n\t\t}\r\n\r\n\t\treturn ret as Pose<Heads>;\r\n\t});\r\n}\r\n\r\nfunction normalizeNsfwAbleCollection(\r\n\tcollection: Array<string | INsfwAbleImg>,\r\n\tposeFolder: string,\r\n\tpaths: IPaths\r\n) {\r\n\treturn collection.map(\r\n\t\t(variant): INsfwAbleImg => {\r\n\t\t\tif (typeof variant === 'string') {\r\n\t\t\t\treturn {\r\n\t\t\t\t\timg: normalizeUrl(appendUrl(poseFolder, variant, paths), paths),\r\n\t\t\t\t\tnsfw: false,\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\timg: normalizeUrl(appendUrl(poseFolder, variant.img, paths), paths),\r\n\t\t\t\t\tnsfw: variant.nsfw,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n}\r\n\r\nfunction normalizeUrl(str: string, paths: IPaths) {\r\n\tfor (const path in paths) {\r\n\t\tif (str.startsWith(path)) {\r\n\t\t\tstr = paths[path] + str.slice(path.length);\r\n\t\t}\r\n\t}\r\n\tif (isWebUrl(str)) return str;\r\n\treturn str.replace(/\\/{2,}/g, '/');\r\n}\r\n\r\nfunction normalizeStyles(styles?: IJSONStyle[]): IStyle[] {\r\n\tif (!styles) return [];\r\n\treturn styles.map(style => ({\r\n\t\tname: style.name,\r\n\t\tlabel: style.label,\r\n\t\tnsfw: style.nsfw || false,\r\n\t}));\r\n}\r\n\r\nexport interface IJSONHeads {\r\n\tfolder?: string;\r\n\tnsfw?: boolean;\r\n\tall: Array<string | INsfwAbleImg>;\r\n\tsize?: [number, number];\r\n\toffset?: [number, number];\r\n}\r\n\r\nexport interface JSONHeads {\r\n\t[id: string]: IJSONHeads | Array<string | INsfwAbleImg>;\r\n}\r\n\r\ninterface IJSONPose<H> {\r\n\tcompatibleHeads: Array<keyof H>;\r\n\theadInForeground?: boolean;\r\n\tfolder?: string;\r\n\tnsfw?: boolean;\r\n\tname: string;\r\n\tstyle: string;\r\n\theadAnchor?: [number, number];\r\n\tsize?: [number, number];\r\n\toffset?: [number, number];\r\n}\r\n\r\ninterface IJSONStaticPose<H> extends IJSONPose<H> {\r\n\tstatic: string;\r\n}\r\n\r\ninterface IJSONVariantPose<H> extends IJSONPose<H> {\r\n\tvariant: Array<string | INsfwAbleImg>;\r\n}\r\n\r\ninterface IJSONTwoSidedPose<H> extends IJSONPose<H> {\r\n\tleft: Array<string | INsfwAbleImg>;\r\n\tright: Array<string | INsfwAbleImg>;\r\n}\r\n\r\nexport type JSONPose<H extends JSONHeads> =\r\n\t| IJSONStaticPose<H>\r\n\t| IJSONVariantPose<H>\r\n\t| IJSONTwoSidedPose<H>;\r\n\r\nexport interface IJSONStyle {\r\n\tname: string;\r\n\tlabel: string;\r\n\tnsfw?: boolean;\r\n}\r\n\r\nexport interface IJSONStyleClasses {\r\n\t[name: string]: string;\r\n}\r\n\r\nexport interface IJSONCharacter<H extends JSONHeads> {\r\n\tid: string;\r\n\tpackId: string;\r\n\tpackCredits: string;\r\n\tinternalId: string;\r\n\tname: string;\r\n\tfolder?: string;\r\n\tnsfw?: boolean;\r\n\teyes?: IJSONStyleClasses;\r\n\thairs?: IJSONStyleClasses;\r\n\tchibi?: string;\r\n\tstyles?: IJSONStyle[];\r\n\theads: H;\r\n\tposes: Array<JSONPose<H>>;\r\n}\r\n\r\nexport interface IPaths {\r\n\t[prefix: string]: string;\r\n}\r\n","import {\r\n\tregisterAssetWithURL,\r\n\tICharacter,\r\n\tHeads,\r\n\tINsfwAbleImg,\r\n\tPose,\r\n\tIHeads,\r\n\tIStyle,\r\n\tcharacters,\r\n} from '@/asset-manager';\r\n\r\nfunction moveCharacterNsfw(character: ICharacter<Heads>) {\r\n\tif (!character.nsfw) return;\r\n\tfor (const key in character.heads) {\r\n\t\tif (!character.heads.hasOwnProperty(key)) continue;\r\n\t\tcharacter.heads[key].nsfw = true;\r\n\t}\r\n\tfor (const pose of character.poses) {\r\n\t\tpose.nsfw = true;\r\n\t}\r\n}\r\n\r\nfunction moveHeadGroupNsfw(heads: IHeads) {\r\n\tif (!heads.nsfw) return;\r\n\tfor (const head of heads.all) {\r\n\t\thead.nsfw = true;\r\n\t}\r\n}\r\n\r\nfunction movePoseNsfw(pose: Pose<any>) {\r\n\tif (!pose.nsfw) return;\r\n\r\n\tif ('variant' in pose) {\r\n\t\tfor (const part of pose.variant) {\r\n\t\t\tpart.nsfw = true;\r\n\t\t}\r\n\t} else if ('left' in pose) {\r\n\t\tfor (const part of pose.left) {\r\n\t\t\tpart.nsfw = true;\r\n\t\t}\r\n\t\tfor (const part of pose.right) {\r\n\t\t\tpart.nsfw = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction moveStyleNsfw(style: IStyle, character: ICharacter<Heads>) {\r\n\tconst matchingPoses = character.poses.filter(\r\n\t\tpose => pose.style === style.name\r\n\t);\r\n\tfor (const matchingPose of matchingPoses) {\r\n\t\tmatchingPose.nsfw = style.nsfw;\r\n\t}\r\n\tstyle.nsfw = false;\r\n}\r\n\r\nexport function mergeCharacters(\r\n\tcharacterA: ICharacter<Heads>,\r\n\tcharacterB: ICharacter<Heads>\r\n): void {\r\n\tif (characterA.nsfw !== characterB.nsfw) {\r\n\t\tmoveCharacterNsfw(characterA);\r\n\t\tmoveCharacterNsfw(characterB);\r\n\t}\r\n\r\n\tcharacterA.hairs = {\r\n\t\t...characterA.hairs,\r\n\t\t...characterB.hairs,\r\n\t};\r\n\r\n\tcharacterA.eyes = {\r\n\t\t...characterA.eyes,\r\n\t\t...characterB.eyes,\r\n\t};\r\n\r\n\tfor (const style of characterB.styles) {\r\n\t\tconst collidingStyle = characterA.styles.find(\r\n\t\t\toldStyle => oldStyle.name === style.name\r\n\t\t);\r\n\t\tif (collidingStyle && collidingStyle.nsfw !== style.nsfw) {\r\n\t\t\tmoveStyleNsfw(style, characterB);\r\n\t\t\tmoveStyleNsfw(collidingStyle, characterA);\r\n\t\t}\r\n\t\tcharacterA.styles.push(style);\r\n\t}\r\n\r\n\tfor (const headGroupKey in characterB.heads) {\r\n\t\tif (!characterB.heads.hasOwnProperty(headGroupKey)) continue;\r\n\t\tconst headGroup = characterB.heads[headGroupKey];\r\n\t\tif (characterA.heads[headGroupKey]) {\r\n\t\t\tconst oldHeadGroup = characterA.heads[headGroupKey];\r\n\t\t\tif (headGroup.nsfw !== oldHeadGroup.nsfw) {\r\n\t\t\t\tmoveHeadGroupNsfw(headGroup);\r\n\t\t\t\tmoveHeadGroupNsfw(oldHeadGroup);\r\n\t\t\t}\r\n\t\t\tfor (const head of headGroup.all) {\r\n\t\t\t\toldHeadGroup.all.push(head);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcharacterA.heads[headGroupKey] = headGroup;\r\n\t\t}\r\n\t}\r\n\tfor (const pose of characterB.poses) {\r\n\t\tconst collidingPose = characterA.poses.find(\r\n\t\t\tposeA => poseA.name === pose.name\r\n\t\t);\r\n\t\tif (collidingPose) {\r\n\t\t\tif (pose.nsfw !== collidingPose.nsfw) {\r\n\t\t\t\tmovePoseNsfw(pose);\r\n\t\t\t\tmovePoseNsfw(collidingPose);\r\n\t\t\t}\r\n\t\t\tif ('left' in pose) {\r\n\t\t\t\tif ('left' in collidingPose) {\r\n\t\t\t\t\t(collidingPose as any).left = [...collidingPose.left, ...pose.left];\r\n\t\t\t\t\t(collidingPose as any).right = [\r\n\t\t\t\t\t\t...collidingPose.right,\r\n\t\t\t\t\t\t...pose.right,\r\n\t\t\t\t\t];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(\r\n\t\t\t\t\t\t'Incompatible poses ' + pose.name + ' in content packs'\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tlet oldCollection: INsfwAbleImg[] = [];\r\n\t\t\t\tlet newCollection: INsfwAbleImg[] = [];\r\n\t\t\t\tif ('variant' in collidingPose) {\r\n\t\t\t\t\toldCollection = collidingPose.variant;\r\n\t\t\t\t}\r\n\t\t\t\tif ('static' in collidingPose) {\r\n\t\t\t\t\toldCollection = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\timg: collidingPose.static,\r\n\t\t\t\t\t\t\tnsfw: collidingPose.nsfw,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t];\r\n\t\t\t\t\tdelete collidingPose.static;\r\n\t\t\t\t}\r\n\t\t\t\tif ('variant' in pose) {\r\n\t\t\t\t\tnewCollection = pose.variant;\r\n\t\t\t\t}\r\n\t\t\t\tif ('static' in pose) {\r\n\t\t\t\t\tnewCollection = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\timg: pose.static,\r\n\t\t\t\t\t\t\tnsfw: pose.nsfw,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\t\t\t\t(pose as any).variant = [...oldCollection, ...newCollection];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcharacterA.poses.push(pose);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function freezeAssetUrls(character: ICharacter<Heads>) {\r\n\tfor (const eyeKey in character.eyes) {\r\n\t\tif (!character.eyes.hasOwnProperty(eyeKey)) continue;\r\n\t\tregisterAssetWithURL(character.eyes[eyeKey], character.eyes[eyeKey]);\r\n\t}\r\n\tfor (const hairKey in character.hairs) {\r\n\t\tif (!character.hairs.hasOwnProperty(hairKey)) continue;\r\n\t\tregisterAssetWithURL(character.hairs[hairKey], character.hairs[hairKey]);\r\n\t}\r\n\tfor (const headGroupKey in character.heads) {\r\n\t\tif (!character.heads.hasOwnProperty(headGroupKey)) continue;\r\n\t\tconst headGroup = character.heads[headGroupKey];\r\n\t\tconst collection = headGroup.all || headGroup;\r\n\t\tfor (const head of collection) {\r\n\t\t\tconst path = head;\r\n\t\t\tregisterAssetWithURL(path.img, path.img);\r\n\t\t}\r\n\t}\r\n\tfor (const poseKey in character.poses) {\r\n\t\tif (!character.poses.hasOwnProperty(poseKey)) continue;\r\n\t\tconst pose = character.poses[poseKey];\r\n\t\tconst collection: string[] = [];\r\n\t\tif ('static' in pose) {\r\n\t\t\tcollection.push(pose.static);\r\n\t\t}\r\n\t\tif ('left' in pose) {\r\n\t\t\tfor (const left of pose.left) {\r\n\t\t\t\tif (typeof left === 'string') {\r\n\t\t\t\t\tcollection.push(left);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollection.push(left.img);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ('right' in pose) {\r\n\t\t\tfor (const right of pose.right) {\r\n\t\t\t\tif (typeof right === 'string') {\r\n\t\t\t\t\tcollection.push(right);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollection.push(right.img);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ('variant' in pose) {\r\n\t\t\tfor (const variant of pose.variant) {\r\n\t\t\t\tif (typeof variant === 'string') {\r\n\t\t\t\t\tcollection.push(variant);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollection.push(variant.img);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const part of collection) {\r\n\t\t\tconst path = part;\r\n\t\t\tregisterAssetWithURL(path, path);\r\n\t\t}\r\n\t}\r\n}\r\n","import {\r\n\tBackground,\r\n\ttransparent,\r\n\tcolor,\r\n\tIBackground,\r\n} from './models/background';\r\nimport Sayori from './characters/sayori.json';\r\nimport Yuri from './characters/yuri.json';\r\nimport Monika from './characters/monika.json';\r\nimport Natsuki from './characters/natsuki.json';\r\nimport FeMC from './characters/femc.json';\r\nimport MC from './characters/mc.json';\r\nimport MCChad from './characters/mc_chad.json';\r\nimport MCClassic from './characters/mc_classic.json';\r\nimport Amy from './characters/amy.json';\r\nimport AmyClassic from './characters/amy_classic.json';\r\nimport { VariantBackground } from './models/variant-background';\r\nimport EventBus, {\r\n\tAssetFailureEvent,\r\n\tCustomAssetFailureEvent,\r\n} from './event-bus';\r\nimport { ErrorAsset } from './models/error-asset';\r\nimport environment from './environments/environment';\r\nimport {\r\n\tnormalizeCharacter,\r\n\tIJSONCharacter,\r\n\tJSONHeads,\r\n} from './models/json-config';\r\nimport { mergeCharacters, freezeAssetUrls } from './models/merge-characters';\r\n\r\nexport const characters: { [name: string]: ICharacter<any> } = {\r\n\t[Sayori.id]: normalizeCharacter(Sayori as any, { './': '/' }),\r\n\t[Yuri.id]: normalizeCharacter(Yuri as any, { './': '/' }),\r\n\t[Natsuki.id]: normalizeCharacter(Natsuki as any, { './': '/' }),\r\n\t[Monika.id]: normalizeCharacter(Monika as any, { './': '/' }),\r\n\t[FeMC.id]: normalizeCharacter(FeMC as any, { './': '/' }),\r\n\t[MC.id]: normalizeCharacter(MC as any, { './': '/' }),\r\n\t[MCChad.id]: normalizeCharacter(MCChad as any, { './': '/' }),\r\n\t[MCClassic.id]: normalizeCharacter(MCClassic as any, { './': '/' }),\r\n\t[Amy.id]: normalizeCharacter(Amy as any, { './': '/' }),\r\n\t[AmyClassic.id]: normalizeCharacter(AmyClassic as any, { './': '/' }),\r\n};\r\n\r\nexport let version = 0;\r\n\r\nexport const characterOrder = ([\r\n\tcharacters[Monika.id],\r\n\tcharacters[Natsuki.id],\r\n\tcharacters[Sayori.id],\r\n\tcharacters[Yuri.id],\r\n\tcharacters[FeMC.id],\r\n\tcharacters[MC.id],\r\n\tcharacters[MCChad.id],\r\n\tcharacters[MCClassic.id],\r\n\tcharacters[Amy.id],\r\n\tcharacters[AmyClassic.id],\r\n] as any) as Array<ICharacter<any>>;\r\n\r\nlet webpSupportPromise: Promise<boolean>;\r\n\r\nexport function isWebPSupported(): Promise<boolean> {\r\n\tif (!webpSupportPromise) {\r\n\t\twebpSupportPromise = new Promise((resolve, reject) => {\r\n\t\t\tconst losslessCode =\r\n\t\t\t\t'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=';\r\n\t\t\tconst img = document.createElement('img');\r\n\t\t\timg.addEventListener('load', () => {\r\n\t\t\t\tresolve(img.width === 2 && img.height === 1);\r\n\t\t\t});\r\n\t\t\timg.addEventListener('error', () => {\r\n\t\t\t\tresolve(false);\r\n\t\t\t});\r\n\t\t\timg.src = losslessCode;\r\n\t\t});\r\n\t}\r\n\treturn webpSupportPromise;\r\n}\r\n\r\nconst assetCache: {\r\n\t[url: string]: Promise<HTMLImageElement | ErrorAsset> | undefined;\r\n} = {};\r\nconst customAssets: { [id: string]: Promise<HTMLImageElement> } = {};\r\nexport const baseUrl = process.env.BASE_URL === '' ? '.' : process.env.BASE_URL;\r\n\r\nexport async function getAsset(\r\n\tasset: string,\r\n\thq: boolean = true\r\n): Promise<HTMLImageElement | ErrorAsset> {\r\n\tif (customAssets[asset]) {\r\n\t\treturn customAssets[asset];\r\n\t}\r\n\r\n\tif (!environment.allowLQ) hq = true;\r\n\r\n\tconst url = `${baseUrl}/assets/${asset}${hq ? '' : '.lq'}${\r\n\t\t(await isWebPSupported()) ? '.webp' : '.png'\r\n\t}`.replace(/\\/+/, '/');\r\n\r\n\tif (!assetCache[url]) {\r\n\t\tassetCache[url] = new Promise((resolve, reject) => {\r\n\t\t\tconst img = new Image();\r\n\t\t\timg.addEventListener('load', () => {\r\n\t\t\t\tresolve(img);\r\n\t\t\t});\r\n\t\t\timg.addEventListener('error', () => {\r\n\t\t\t\tEventBus.fire(new AssetFailureEvent(url));\r\n\t\t\t\tassetCache[url] = undefined;\r\n\t\t\t\tresolve(new ErrorAsset());\r\n\t\t\t});\r\n\t\t\timg.crossOrigin = 'Anonymous';\r\n\t\t\timg.src = url;\r\n\t\t\timg.style.display = 'none';\r\n\t\t\tdocument.body.appendChild(img);\r\n\t\t});\r\n\t}\r\n\r\n\treturn assetCache[url]!;\r\n}\r\n\r\nexport function registerAsset(asset: string, file: File): string {\r\n\tconst url = URL.createObjectURL(file);\r\n\tcustomAssets[asset] = new Promise((resolve, reject) => {\r\n\t\tconst img = new Image();\r\n\t\timg.addEventListener('load', () => {\r\n\t\t\tresolve(img);\r\n\t\t});\r\n\t\timg.addEventListener('error', error => {\r\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\r\n\t\t\treject(`Failed to load \"${url}\"`);\r\n\t\t});\r\n\t\timg.crossOrigin = 'Anonymous';\r\n\t\timg.src = url;\r\n\t\timg.style.display = 'none';\r\n\t\tdocument.body.appendChild(img);\r\n\t});\r\n\treturn url;\r\n}\r\n\r\nexport function registerAssetWithURL(\r\n\tasset: string,\r\n\turl: string\r\n): Promise<HTMLImageElement> {\r\n\treturn (customAssets[asset] = new Promise((resolve, reject) => {\r\n\t\tconst img = new Image();\r\n\t\timg.addEventListener('load', () => {\r\n\t\t\tresolve(img);\r\n\t\t});\r\n\t\timg.addEventListener('error', error => {\r\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\r\n\t\t\treject(`Failed to load \"${url}\"`);\r\n\t\t});\r\n\t\timg.crossOrigin = 'Anonymous';\r\n\t\timg.src = url;\r\n\t\timg.style.display = 'none';\r\n\t\tdocument.body.appendChild(img);\r\n\t}));\r\n}\r\n\r\nexport const backgrounds: IBackground[] = [\r\n\tnew VariantBackground('Clubroom', '/backgrounds/', [\r\n\t\t['club'],\r\n\t\t{\r\n\t\t\tnsfw: true,\r\n\t\t\timages: ['club-skill'],\r\n\t\t},\r\n\t]),\r\n\tnew Background('closet', 'Closet'),\r\n\tnew Background('corridor', 'Corridor'),\r\n\tnew Background('class', 'Classroom'),\r\n\tnew Background('residential', 'Street'),\r\n\tnew Background('house', 'House'),\r\n\tnew Background('bedroom', 'Bedroom'),\r\n\tnew Background('kitchen', 'Kitchen'),\r\n\tnew VariantBackground(\"Sayori's bedroom\", '', [\r\n\t\t['/backgrounds/sayori_bedroom'],\r\n\t\t['/cg/sayori_kill/s_kill_bg'],\r\n\t\t['/cg/sayori_kill/s_kill_bg2'],\r\n\t]),\r\n\tnew Background('bsod', 'Blue screen of death'),\r\n\tnew Background('unused-house', 'Unused house found in game files'),\r\n\tnew VariantBackground('Natsuki reading manga', '/cg/natsuki_1/', [\r\n\t\t['n_cg1_bg'],\r\n\t\t['n_cg1_bg', 'n_cg1_base'],\r\n\t\t['n_cg1_bg', 'n_cg1_base', 'n_cg1_exp1'],\r\n\t\t['n_cg1_bg', 'n_cg1_base', 'n_cg1_exp2'],\r\n\t\t['n_cg1_bg', 'n_cg1_base', 'n_cg1_exp3'],\r\n\t\t['n_cg1_bg', 'n_cg1_base', 'n_cg1_exp4'],\r\n\t\t['n_cg1_bg', 'n_cg1_base', 'n_cg1_exp5'],\r\n\t]),\r\n\tnew VariantBackground('Natsuki in the closet', '/cg/natsuki_2/', [\r\n\t\t['n_cg2_bg'],\r\n\t\t['n_cg2_bg', 'n_cg2_base'],\r\n\t\t['n_cg2_bg', 'n_cg2_base', 'n_cg2_exp1'],\r\n\t\t['n_cg2_bg', 'n_cg2_base', 'n_cg2_exp2'],\r\n\t]),\r\n\tnew VariantBackground('Natsuki against the wall', '/cg/natsuki_3/', [\r\n\t\t['n_cg3_base'],\r\n\t\t['n_cg3_base', 'n_cg3_exp1'],\r\n\t\t['n_cg3_base', 'n_cg3_exp2'],\r\n\t\t['n_cg3_base', 'n_cg3_cake'],\r\n\t\t['n_cg3_base', 'n_cg3_exp1', 'n_cg3_cake'],\r\n\t\t['n_cg3_base', 'n_cg3_exp2', 'n_cg3_cake'],\r\n\t]),\r\n\tnew Background('../cg/sayori_1/s_cg1', 'Sayori dressing'),\r\n\tnew VariantBackground('Sayori bumped head', '/cg/sayori_2/', [\r\n\t\t['s_cg2_base1'],\r\n\t\t['s_cg2_base1', 's_cg2_exp1'],\r\n\t\t['s_cg2_base1', 's_cg2_exp2'],\r\n\t\t['s_cg2_base1', 's_cg2_exp3'],\r\n\t\t['s_cg2_base1', 's_cg2_exp1', 's_cg2_exp3'],\r\n\t\t['s_cg2_base1', 's_cg2_exp2', 's_cg2_exp3'],\r\n\t\t['s_cg2_base2'],\r\n\t\t['s_cg2_base2', 's_cg2_exp1'],\r\n\t\t['s_cg2_base2', 's_cg2_exp2'],\r\n\t\t['s_cg2_base2', 's_cg2_exp3'],\r\n\t\t['s_cg2_base2', 's_cg2_exp1', 's_cg2_exp3'],\r\n\t\t['s_cg2_base2', 's_cg2_exp2', 's_cg2_exp3'],\r\n\t]),\r\n\tnew Background('../cg/sayori_3/s_cg3', 'Sayori hug'),\r\n\tnew VariantBackground('Yuri reading', '/cg/yuri_1/', [\r\n\t\t['y_cg1_base'],\r\n\t\t['y_cg1_base', 'y_cg1_exp2'],\r\n\t\t['y_cg1_base', 'y_cg1_exp1'],\r\n\t\t['y_cg1_base', 'y_cg1_exp1', 'y_cg1_exp2'],\r\n\t\t['y_cg1_base', 'y_cg1_exp3'],\r\n\t]),\r\n\tnew VariantBackground('Yuri against the wall', '/cg/yuri_2/', [\r\n\t\t['y_cg2_bg1'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base', 'y_cg2_exp2', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base', 'y_cg2_exp3', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base', 'y_cg2_exp2'],\r\n\t\t['y_cg2_bg1', 'y_cg2_base', 'y_cg2_exp3'],\r\n\t\t['y_cg2_bg2'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base', 'y_cg2_exp2', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base', 'y_cg2_exp3', 'y_cg2_nochoc'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base', 'y_cg2_exp2'],\r\n\t\t['y_cg2_bg2', 'y_cg2_base', 'y_cg2_exp3'],\r\n\t]),\r\n\tnew VariantBackground('Yuri with towel', '/cg/yuri_3/', [\r\n\t\t['y_cg3_base'],\r\n\t\t['y_cg3_base', 'y_cg3_exp1'],\r\n\t]),\r\n\tnew VariantBackground(\r\n\t\t\"Yuri's death\",\r\n\t\t'/cg/yuri_kill/',\r\n\t\t[['1a'], ['1b'], ['1c'], ['2a'], ['2b'], ['2c'], ['3a'], ['3b'], ['3c']],\r\n\t\ttrue\r\n\t),\r\n\tnew VariantBackground('The spaceroom', '/cg/monika/', [\r\n\t\t['monika_room'],\r\n\t\t['space', 'monika_room'],\r\n\t\t['monika_room_highlight'],\r\n\t\t['space', 'monika_room_highlight'],\r\n\t\t['monika_bg'],\r\n\t\t['space', 'monika_bg'],\r\n\t\t['monika_bg_highlight'],\r\n\t\t['space', 'monika_bg_highlight'],\r\n\t\t['room'],\r\n\t\t['space', 'room'],\r\n\t\t['monika_bg_glitch'],\r\n\t\t['monika_bg_glitch', 'monika_glitch1'],\r\n\t\t['monika_bg_glitch', 'monika_glitch2'],\r\n\t\t['monika_bg_glitch', 'monika_glitch3'],\r\n\t\t['monika_bg_glitch', 'monika_glitch4'],\r\n\t\t{\r\n\t\t\tnsfw: true,\r\n\t\t\timages: ['monika_scare'],\r\n\t\t},\r\n\t\t{\r\n\t\t\tnsfw: true,\r\n\t\t\timages: ['space', 'monika_scare'],\r\n\t\t},\r\n\t]),\r\n\tcolor,\r\n\ttransparent,\r\n];\r\n\r\nexport interface IHeads {\r\n\tnsfw: boolean;\r\n\tall: INsfwAbleImg[];\r\n\tsize: [number, number];\r\n\toffset: [number, number];\r\n}\r\n\r\nexport interface Heads {\r\n\t[id: string]: IHeads;\r\n}\r\n\r\ninterface IPose<H> {\r\n\tcompatibleHeads: Array<keyof H>;\r\n\theadInForeground: boolean;\r\n\tnsfw: boolean;\r\n\tname: string;\r\n\theadAnchor: [number, number];\r\n\tsize: [number, number];\r\n\toffset: [number, number];\r\n\tstyle: string;\r\n}\r\n\r\ninterface IStaticPose<H> extends IPose<H> {\r\n\tstatic: string;\r\n}\r\n\r\nexport interface INsfwAbleImg {\r\n\timg: string;\r\n\tnsfw: boolean;\r\n}\r\n\r\ninterface IVariantPose<H> extends IPose<H> {\r\n\tvariant: INsfwAbleImg[];\r\n}\r\n\r\ninterface ITwoSidedPose<H> extends IPose<H> {\r\n\tleft: INsfwAbleImg[];\r\n\tright: INsfwAbleImg[];\r\n}\r\n\r\nexport type Pose<H extends Heads> =\r\n\t| IStaticPose<H>\r\n\t| IVariantPose<H>\r\n\t| ITwoSidedPose<H>;\r\n\r\nexport interface IStyle {\r\n\tname: string;\r\n\tlabel: string;\r\n\tnsfw: boolean;\r\n}\r\nexport interface IStyleClasses {\r\n\t[name: string]: string;\r\n}\r\n\r\nexport interface ICharacter<H extends Heads> {\r\n\tid: string;\r\n\tinternalId: string;\r\n\tname: string;\r\n\tnsfw: boolean;\r\n\teyes: IStyleClasses;\r\n\thairs: IStyleClasses;\r\n\tchibi?: string;\r\n\tstyles: IStyle[];\r\n\theads: H;\r\n\tposes: Array<Pose<H>>;\r\n}\r\n\r\nconst installed: string[] = [];\r\n\r\nexport async function loadCharacterPack(\r\n\tfilePath: string,\r\n\tactive: boolean = true\r\n): Promise<IJSONCharacter<any> | undefined> {\r\n\tconst parts = filePath.split('/');\r\n\tconst baseDir = parts.slice(0, -1).join('/');\r\n\r\n\tconst response = await fetch(filePath);\r\n\tconst json: IJSONCharacter<JSONHeads> = await response.json();\r\n\tif (!active) {\r\n\t\treturn json;\r\n\t}\r\n\tif (json.packId) {\r\n\t\tif (installed.indexOf(json.packId) >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tconst character = normalizeCharacter(json, {\r\n\t\t'./': baseDir + '/',\r\n\t}) as ICharacter<any>;\r\n\tif (characters[character.id]) {\r\n\t\tconst existing = characters[character.id];\r\n\t\tmergeCharacters(existing, character);\r\n\t} else {\r\n\t\tcharacters[character.id] = character;\r\n\t\tcharacterOrder.push(character);\r\n\t}\r\n\tfreezeAssetUrls(character);\r\n\tif (json.packId) {\r\n\t\tinstalled.push(json.packId);\r\n\t}\r\n\t++version;\r\n\treturn json;\r\n}\r\n","import { IEnvironment, IPack } from './environment';\r\nimport {\r\n\tcharacters,\r\n\tICharacter,\r\n\tcharacterOrder,\r\n\tbackgrounds,\r\n\tregisterAssetWithURL,\r\n\tgetAsset,\r\n\tloadCharacterPack,\r\n} from '@/asset-manager';\r\nimport { Background } from '@/models/background';\r\nimport eventBus, { ShowMessageEvent } from '@/event-bus';\r\n\r\nconst packs: IPack[] = [];\r\n\r\nexport class Electron implements IEnvironment {\r\n\tpublic readonly allowLQ = false;\r\n\tprivate electron = (window as any) as IElectronWindow;\r\n\tprivate promptCache: {\r\n\t\t[promptId: number]: (resolved: string | null) => void;\r\n\t} = {};\r\n\tprivate lastPrompt: number = 0;\r\n\r\n\tconstructor() {\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-character',\r\n\t\t\tasync (e, filePath: string, active: boolean = true) => {\r\n\t\t\t\tconst json = await loadCharacterPack(filePath, active);\r\n\t\t\t\tif (!json) return;\r\n\t\t\t\tpacks.push({\r\n\t\t\t\t\turl: filePath,\r\n\t\t\t\t\tqueuedUninstall: false,\r\n\t\t\t\t\tid: json.packId,\r\n\t\t\t\t\tcredits: json.packCredits,\r\n\t\t\t\t\tactive,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-background',\r\n\t\t\tasync (e, filepath: string) => {\r\n\t\t\t\tconst name = 'persistentBg-' + filepath;\r\n\t\t\t\tconst parts = filepath.split('/');\r\n\t\t\t\tregisterAssetWithURL(name, filepath);\r\n\t\t\t\tconsole.log(filepath);\r\n\t\t\t\tbackgrounds.push(\r\n\t\t\t\t\tnew Background(name, parts[parts.length - 1], false, true, '', true)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on('push-message', async (e, message: string) => {\r\n\t\t\teventBus.fire(new ShowMessageEvent(message));\r\n\t\t});\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'prompt-answered',\r\n\t\t\t(e, id: number, value: string | null) => {\r\n\t\t\t\tthis.promptCache[id](value);\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.send('find-customs');\r\n\t}\r\n\r\n\tpublic saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tdownloadCanvas.toBlob(async blob => {\r\n\t\t\t\tif (!blob) {\r\n\t\t\t\t\treject();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst buffer = await (blob as any).arrayBuffer();\r\n\t\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t\t'save-file',\r\n\t\t\t\t\tfilename,\r\n\t\t\t\t\tnew Uint8Array(buffer)\r\n\t\t\t\t);\r\n\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn packs;\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic async installBackground(background: Background): Promise<void> {\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tconst img = await fetch(asset.src);\r\n\t\tconst array = new Uint8Array(await img.arrayBuffer());\r\n\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t'install-background',\r\n\t\t\tbackground.name,\r\n\t\t\tarray\r\n\t\t);\r\n\t\tbackground.installed = true;\r\n\t}\r\n\r\n\tpublic async uninstallBackground(background: Background): Promise<void> {\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tif (!asset.src.startsWith('blob:')) {\r\n\t\t\tconst img = await fetch(asset.src);\r\n\t\t\tconst blob = await img.blob();\r\n\t\t\tconst newUrl = URL.createObjectURL(blob);\r\n\t\t\tregisterAssetWithURL(background.path, newUrl);\r\n\t\t}\r\n\t\tthis.electron.ipcRenderer.send('uninstall-background', background.name);\r\n\t\tbackground.installed = false;\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): void {\r\n\t\tconsole.log('installContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('install-content-pack', url);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): void {\r\n\t\tconsole.log('uninstallContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('uninstall-content-pack', url);\r\n\t}\r\n\r\n\tpublic activateContentPack(url: string): void {\r\n\t\tconsole.log('activateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('activate-content-pack', url);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): void {\r\n\t\tconsole.log('deactivateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('deactivate-content-pack', url);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.promptCache[++this.lastPrompt] = resolve;\r\n\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t'show-prompt',\r\n\t\t\t\tthis.lastPrompt,\r\n\t\t\t\tmessage,\r\n\t\t\t\tdefaultValue\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\tthis.electron.ipcRenderer.on('open-panel', (e, panel: string) => {\r\n\t\t\thandler(panel);\r\n\t\t});\r\n\t}\r\n}\r\n\r\ninterface IElectronWindow {\r\n\tisElectron: boolean;\r\n\tipcRenderer: IpcRenderer;\r\n}\r\n\r\ninterface IpcRenderer {\r\n\ton(\r\n\t\tchannel: string,\r\n\t\tlistener: (event: IpcRendererEvent, ...args: any[]) => void\r\n\t): void;\r\n\tsend(channel: string, ...args: any[]): void;\r\n}\r\n\r\ninterface IpcRendererEvent extends Event {\r\n\tsender: IpcRenderer;\r\n\tsenderId: number;\r\n}\r\n","import { Edge } from './edge';\r\nimport { Browser } from './browser';\r\nimport { Electron } from './electron';\r\nimport { Background } from '@/models/background';\r\n\r\nexport interface IPack {\r\n\turl: string;\r\n\tid: string;\r\n\tcredits: string;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n}\r\n\r\nexport interface IEnvironment {\r\n\treadonly allowLQ: boolean;\r\n\treadonly isBackgroundInstallingSupported: boolean;\r\n\treadonly isPackInstallingSupported: boolean;\r\n\treadonly installedCharacterPacks: Readonly<Array<Readonly<IPack>>>;\r\n\tsaveToFile(canvas: HTMLCanvasElement, filename: string): Promise<string>;\r\n\tinstallBackground(background: Background): void;\r\n\tuninstallBackground(background: Background): void;\r\n\tactivateContentPack(url: string): void;\r\n\tdeactivateContentPack(url: string): void;\r\n\tinstallContentPack(url: string): void;\r\n\tuninstallContentPack(url: string): void;\r\n\tprompt(message: string, defaultValue?: string): Promise<string | null>;\r\n\tonPanelChange(handler: (panel: string) => void): void;\r\n}\r\n\r\nfunction chooseEnv(): IEnvironment {\r\n\tif ((window as any).isElectron) {\r\n\t\treturn new Electron();\r\n\t}\r\n\tif (window.navigator.msSaveOrOpenBlob !== undefined) {\r\n\t\treturn new Edge();\r\n\t}\r\n\treturn new Browser();\r\n}\r\n\r\nconst envX = chooseEnv();\r\n\r\n(window as any).toast = envX;\r\nexport default envX;\r\n","import Vue from 'vue';\r\nimport Component from 'vue-class-component';\r\n\r\n@Component({})\r\nexport class PanelMixin extends Vue {\r\n\tprivate mounted() {\r\n\t\tthis.$el.addEventListener(\r\n\t\t\t'wheel',\r\n\t\t\te => {\r\n\t\t\t\tif (e.type !== 'wheel') return;\r\n\t\t\t\tif (!e.currentTarget) return;\r\n\t\t\t\tconst target = e.currentTarget as HTMLElement;\r\n\t\t\t\tif (target.classList.contains('vertical')) return;\r\n\r\n\t\t\t\tconst ev = e as WheelEvent;\r\n\t\t\t\tif (ev.deltaY === 0) return;\r\n\t\t\t\tif ((ev as any).mozInputSource) {\r\n\t\t\t\t\t// Firefox sends wierdly low delta values :/\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY * 25;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t}\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\r\nimport { Textbox } from '../../models/textbox';\r\nimport Toggle from '../Toggle.vue';\r\nimport environment from '../../environments/environment';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tToggle,\r\n\t},\r\n})\r\nexport default class GeneralPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true }) private readonly options!: Textbox;\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\t@Prop({ required: true, type: Boolean })\r\n\tprivate readonly lqRendering!: boolean;\r\n\t@Prop({ required: true, type: Boolean })\r\n\tprivate readonly hasPrevRender!: boolean;\r\n\t@Prop({ required: true, type: Boolean })\r\n\tprivate readonly nsfw!: boolean;\r\n\r\n\tprivate get allowsLQ(): boolean {\r\n\t\treturn environment.allowLQ;\r\n\t}\r\n\r\n\t@Watch('options.customName')\r\n\tprivate talkingChange(): void {\r\n\t\tthis.options.talking = 'other';\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./general.vue?vue&type=template&id=0440f908&scoped=true&\"\nimport script from \"./general.vue?vue&type=script&lang=ts&\"\nexport * from \"./general.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./general.vue?vue&type=style&index=0&id=0440f908&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0440f908\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isWebPSupported !== undefined)?_c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"Add character\")]),_vm._l((_vm.characters),function(character){return _c('div',{key:character.id,staticClass:\"character\",attrs:{\"title\":character.name},on:{\"click\":function($event){return _vm.$emit('chosen', character.id)}}},[_c('img',{attrs:{\"src\":_vm.assetPath(character),\"alt\":character.name}})])}),_c('div',{staticClass:\"btn custom-sprite\",on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\"\\n\\t\\tCustom sprite upload\\n\\t\\t\"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileUpload}})]),_c('div',{staticClass:\"btn custom-sprite\",on:{\"click\":_vm.uploadFromURL}},[_vm._v(\"Custom sprite from URL\")])],2):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport {\r\n\tisWebPSupported,\r\n\tICharacter,\r\n\tcharacterOrder,\r\n\tregisterAsset,\r\n\tregisterAssetWithURL,\r\n\tbaseUrl,\r\n} from '../../asset-manager';\r\nimport environment from '../../environments/environment';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class AddPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\r\n\tprivate isWebPSupported: boolean | null = null;\r\n\tprivate customAssetCount = 0;\r\n\r\n\tprivate async created() {\r\n\t\tthis.isWebPSupported = await isWebPSupported();\r\n\t}\r\n\r\n\tprivate get characters(): Array<ICharacter<any>> {\r\n\t\treturn characterOrder;\r\n\t}\r\n\r\n\tprivate assetPath(character: ICharacter<any>) {\r\n\t\tif (character.chibi) {\r\n\t\t\treturn character.chibi;\r\n\t\t}\r\n\t\tconst lq = environment.allowLQ ? '.lq' : '';\r\n\t\treturn `${baseUrl}/assets/chibis/${character.internalId + lq}.${\r\n\t\t\tthis.isWebPSupported ? 'webp' : 'png'\r\n\t\t}`.replace(/\\/+/, '/');\r\n\t}\r\n\r\n\tprivate onFileUpload(e: Event) {\r\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\r\n\t\tif (!uploadInput.files) return;\r\n\t\tfor (const file of uploadInput.files) {\r\n\t\t\t(nr => {\r\n\t\t\t\tconst name = 'customAsset' + nr;\r\n\t\t\t\tconst url = registerAsset(name, file);\r\n\t\t\t\tthis.$emit('add-custom-asset', name);\r\n\t\t\t})(++this.customAssetCount);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async uploadFromURL() {\r\n\t\tconst url = await environment.prompt('Enter the URL of the image');\r\n\t\tif (!url) return;\r\n\t\tconst name = 'customAsset' + ++this.customAssetCount;\r\n\t\tawait registerAssetWithURL(name, url);\r\n\t\tthis.$emit('add-custom-asset', name);\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./add.vue?vue&type=template&id=c63b9cc4&scoped=true&\"\nimport script from \"./add.vue?vue&type=script&lang=ts&\"\nexport * from \"./add.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=c63b9cc4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c63b9cc4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(_vm._s(_vm.character.label))]),(_vm.panelForParts)?_c('parts',{attrs:{\"vertical\":_vm.vertical,\"character\":_vm.character,\"part\":_vm.panelForParts,\"nsfw\":_vm.nsfw},on:{\"leave\":function($event){_vm.panelForParts = null}}}):[(_vm.hasMultiplePoses || _vm.parts.length > 0)?_c('fieldset',[_c('legend',[_vm._v(\"Pose:\")]),_c('table',[_c('tbody',[(_vm.hasMultipleStyles)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekStyle(-1, _vm.nsfw);}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'style'}}},[_vm._v(\"Style\")])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekStyle(1, _vm.nsfw);}}},[_vm._v(\">\")])])]):_vm._e(),(_vm.hasMultiplePoses)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekPose(-1, _vm.nsfw);}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'pose'}}},[_vm._v(\"Pose\")])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekPose(1, _vm.nsfw);}}},[_vm._v(\">\")])])]):_vm._e(),_vm._l((_vm.parts),function(part){return _c('tr',{key:part},[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekPart(part, -1, _vm.nsfw);}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = part}}},[_vm._v(_vm._s(_vm.captialize(part)))])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.character.seekPart(part, 1, _vm.nsfw);}}},[_vm._v(\">\")])])])})],2)])]):_vm._e(),_c('fieldset',[_c('legend',[_vm._v(\"Position:\")]),_c('toggle',{attrs:{\"label\":\"Move freely?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.character.allowFreeMove),callback:function ($$v) {_vm.$set(_vm.character, \"allowFreeMove\", $$v)},expression:\"character.allowFreeMove\"}}),(!_vm.character.allowFreeMove)?_c('div',[_c('button',{attrs:{\"disabled\":_vm.character.pos === 0},on:{\"click\":function($event){--_vm.character.pos;_vm.$emit('invalidate-render')}}},[_vm._v(\"<\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.character.pos),expression:\"character.pos\",modifiers:{\"number\":true}}],attrs:{\"id\":\"current_talking\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return _vm._n(val)}); _vm.$set(_vm.character, \"pos\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},_vm._l((_vm.positionNames),function(val,key){return _c('option',{key:key,domProps:{\"value\":key}},[_vm._v(_vm._s(val))])}),0),_c('button',{attrs:{\"disabled\":_vm.character.pos >= _vm.positionNames.length - 1},on:{\"click\":function($event){++_vm.character.pos;_vm.$emit('invalidate-render')}}},[_vm._v(\">\")])]):_c('div',[_c('label',{attrs:{\"for\":\"sprite_x\"}},[_vm._v(\"X:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.character.x),expression:\"character.x\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_x\",\"type\":\"number\"},domProps:{\"value\":(_vm.character.x)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.character, \"x\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_y\"}},[_vm._v(\"Y:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.character.y),expression:\"character.y\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_y\",\"type\":\"number\"},domProps:{\"value\":(_vm.character.y)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.character, \"y\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}})])],1),_c('fieldset',{attrs:{\"id\":\"layerfs\"}},[_c('legend',[_vm._v(\"Layer:\")]),_c('button',{attrs:{\"title\":\"Move to back\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.character, move: 'Back'})}}},[_vm._v(\"⤓\")]),_c('button',{attrs:{\"title\":\"Move backwards\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.character, move: 'Backward'})}}},[_vm._v(\"↓\")]),_c('button',{attrs:{\"title\":\"Move forwards\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.character, move: 'Forward'})}}},[_vm._v(\"↑\")]),_c('button',{attrs:{\"title\":\"Move to front\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.character, move: 'Front'})}}},[_vm._v(\"⤒\")]),_c('toggle',{attrs:{\"label\":\"In front of textbox?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.character.infront),callback:function ($$v) {_vm.$set(_vm.character, \"infront\", $$v)},expression:\"character.infront\"}})],1),_c('div',[_c('label',{attrs:{\"for\":\"characterOpacity\"}},[_vm._v(\"Opacity:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.character.opacity),expression:\"character.opacity\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"max\":\"100\",\"min\":\"0\",\"id\":\"characterOpacity\"},domProps:{\"value\":(_vm.character.opacity)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.character, \"opacity\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('toggle',{attrs:{\"label\":\"Close up?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.character.close),callback:function ($$v) {_vm.$set(_vm.character, \"close\", $$v)},expression:\"character.close\"}}),_c('toggle',{attrs:{\"label\":\"Flipped?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.character.flip),callback:function ($$v) {_vm.$set(_vm.character, \"flip\", $$v)},expression:\"character.flip\"}}),_c('button',{on:{\"click\":function($event){_vm.$emit('shiftLayer', {object: _vm.character, move: 'Delete'});_vm.$emit('close')}}},[_vm._v(\"Delete\")])]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class RenderAbortedException {}\r\n","import { RenderAbortedException } from './renderAbortedException';\r\nimport { Renderer } from './renderer';\r\nimport { ErrorAsset } from '@/models/error-asset';\r\n\r\nexport class RenderContext {\r\n\tprivate aborted: boolean = false;\r\n\r\n\tpublic constructor(\r\n\t\tprivate fsCtx: CanvasRenderingContext2D,\r\n\t\tpublic readonly hq: boolean,\r\n\t\tpublic readonly preview: boolean\r\n\t) {}\r\n\r\n\tpublic drawText(\r\n\t\tparams: { text: string; align?: CanvasTextAlign; font?: string } & IRPos &\r\n\t\t\tIOOutline &\r\n\t\t\tIOFill\r\n\t) {\r\n\t\tif (this.aborted) throw new RenderAbortedException();\r\n\t\tthis.fsCtx.save();\r\n\r\n\t\tconst { font, align, x = 0, y = 0, text = '' } = {\r\n\t\t\t...{\r\n\t\t\t\tfont: '20px aller',\r\n\t\t\t\talign: 'left' as CanvasTextAlign,\r\n\t\t\t},\r\n\t\t\t...params,\r\n\t\t};\r\n\r\n\t\tthis.fsCtx.lineJoin = 'round';\r\n\t\tthis.fsCtx.textAlign = align;\r\n\t\tthis.fsCtx.font = font;\r\n\r\n\t\tif (params.outline) {\r\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\r\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\r\n\t\t\tthis.fsCtx.strokeText(text, x, y);\r\n\t\t}\r\n\r\n\t\tif (params.fill) {\r\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\r\n\t\t\tthis.fsCtx.fillText(text, x, y);\r\n\t\t}\r\n\r\n\t\tthis.fsCtx.restore();\r\n\t}\r\n\r\n\tpublic measureText(\r\n\t\tparams: {\r\n\t\t\ttext: string;\r\n\t\t\talign?: CanvasTextAlign;\r\n\t\t\tfont?: string;\r\n\t\t} & IOOutline &\r\n\t\t\tIOFill\r\n\t): TextMetrics {\r\n\t\tif (this.aborted) throw new RenderAbortedException();\r\n\t\tthis.fsCtx.save();\r\n\r\n\t\tconst { font, align, text = '' } = {\r\n\t\t\t...{\r\n\t\t\t\tfont: '20px aller',\r\n\t\t\t\talign: 'left' as CanvasTextAlign,\r\n\t\t\t},\r\n\t\t\t...params,\r\n\t\t};\r\n\r\n\t\tthis.fsCtx.lineJoin = 'round';\r\n\t\tthis.fsCtx.textAlign = align;\r\n\t\tthis.fsCtx.font = font;\r\n\r\n\t\tif (params.outline) {\r\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\r\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\r\n\t\t}\r\n\r\n\t\tif (params.fill) {\r\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\r\n\t\t}\r\n\t\tconst ret = this.fsCtx.measureText(text);\r\n\t\tthis.fsCtx.restore();\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tpublic drawImage(\r\n\t\tparams: {\r\n\t\t\timage: HTMLImageElement | ErrorAsset | Renderer;\r\n\t\t\tflip?: boolean;\r\n\t\t} & IRPos &\r\n\t\t\tIOSize &\r\n\t\t\tIOShadow &\r\n\t\t\tIOOpacity\r\n\t): void {\r\n\t\tif (this.aborted) throw new RenderAbortedException();\r\n\t\tif (params.image instanceof ErrorAsset) return;\r\n\t\tconst { image, flip, x, y, w, h, opacity } = {\r\n\t\t\tflip: false,\r\n\t\t\tw: params.image.width,\r\n\t\t\th: params.image.height,\r\n\t\t\topacity: 100,\r\n\t\t\t...params,\r\n\t\t};\r\n\r\n\t\tthis.fsCtx.save();\r\n\r\n\t\tif (opacity < 100) {\r\n\t\t\tthis.fsCtx.globalAlpha = opacity / 100;\r\n\t\t}\r\n\r\n\t\tif (params.shadow) {\r\n\t\t\tconst shadow = params.shadow;\r\n\t\t\tif (shadow.color) {\r\n\t\t\t\tthis.fsCtx.shadowColor = shadow.color;\r\n\t\t\t}\r\n\t\t\tif (shadow.blur) {\r\n\t\t\t\tthis.fsCtx.shadowBlur = shadow.blur;\r\n\t\t\t}\r\n\t\t\tif (shadow.offsetX) {\r\n\t\t\t\tthis.fsCtx.shadowOffsetX = shadow.offsetX;\r\n\t\t\t}\r\n\t\t\tif (shadow.offsetY) {\r\n\t\t\t\tthis.fsCtx.shadowOffsetY = shadow.offsetY;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.fsCtx.translate(x + w / 2, y + h / 2);\r\n\t\tthis.fsCtx.scale(flip ? -1 : 1, 1);\r\n\r\n\t\tif (image instanceof Renderer) {\r\n\t\t\timage.paintOnto(this.fsCtx, -w / 2, -h / 2, w, h);\r\n\t\t} else {\r\n\t\t\tthis.fsCtx.drawImage(image as HTMLImageElement, -w / 2, -h / 2, w, h);\r\n\t\t}\r\n\r\n\t\tthis.fsCtx.restore();\r\n\t}\r\n\r\n\tpublic drawRect({\r\n\t\tx,\r\n\t\ty,\r\n\t\tw,\r\n\t\th,\r\n\t\toutline,\r\n\t\tfill,\r\n\t}: IRPos & IRSize & IOOutline & IOFill) {\r\n\t\tif (this.aborted) throw new RenderAbortedException();\r\n\t\tthis.fsCtx.save();\r\n\t\tthis.fsCtx.beginPath();\r\n\t\tthis.fsCtx.rect(x, y, w, h);\r\n\r\n\t\tif (fill) {\r\n\t\t\tthis.fsCtx.fillStyle = fill.style;\r\n\t\t\tthis.fsCtx.fill();\r\n\t\t}\r\n\t\tif (outline) {\r\n\t\t\tthis.fsCtx.strokeStyle = outline.style;\r\n\t\t\tthis.fsCtx.lineWidth = outline.width;\r\n\t\t\tthis.fsCtx.stroke();\r\n\t\t}\r\n\t\tthis.fsCtx.restore();\r\n\t}\r\n\r\n\tpublic abort(): void {\r\n\t\tthis.aborted = true;\r\n\t}\r\n}\r\n\r\nconst optSize = { w: 0, h: 0 };\r\nconst optShadow = {\r\n\tblur: 0,\r\n\tcolor: 'none',\r\n\toffsetX: 0,\r\n\toffsetY: 0,\r\n};\r\n\r\nexport interface IShadow {\r\n\tblur?: number;\r\n\tcolor?: string;\r\n\toffsetX?: number;\r\n\toffsetY?: number;\r\n}\r\n\r\nexport interface IOutline {\r\n\tstyle: string;\r\n\twidth: number;\r\n}\r\n\r\nexport interface IFill {\r\n\tstyle: string;\r\n}\r\n\r\ninterface IOShadow {\r\n\tshadow?: IShadow;\r\n}\r\n\r\ninterface IRPos {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\ninterface IRSize {\r\n\tw: number;\r\n\th: number;\r\n}\r\n\r\ninterface IOSize {\r\n\tw?: number;\r\n\th?: number;\r\n}\r\n\r\ninterface IOOutline {\r\n\toutline?: IOutline;\r\n}\r\ninterface IOOpacity {\r\n\topacity?: number;\r\n}\r\n\r\ninterface IOFill {\r\n\tfill?: IFill;\r\n}\r\n","import { RenderContext } from './rendererContext';\r\nimport { RenderAbortedException } from './renderAbortedException';\r\nimport environment from '@/environments/environment';\r\n\r\nexport class Renderer {\r\n\tprivate previewCanvas: HTMLCanvasElement;\r\n\tprivate runningContext: RenderContext | null = null;\r\n\r\n\tpublic constructor(w: number = 1280, h: number = 720) {\r\n\t\tthis.previewCanvas = document.createElement('canvas');\r\n\t\tthis.previewCanvas.width = w;\r\n\t\tthis.previewCanvas.height = h;\r\n\t}\r\n\r\n\tpublic async render(\r\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\r\n\t\thq: boolean = true\r\n\t): Promise<boolean> {\r\n\t\tif (this.runningContext) {\r\n\t\t\tthis.runningContext.abort();\r\n\t\t}\r\n\r\n\t\tconst ctx = this.previewCanvas.getContext('2d')!;\r\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\r\n\t\tconst context = (this.runningContext = new RenderContext(ctx, hq, true));\r\n\t\ttry {\r\n\t\t\tawait renderCallback(this.runningContext);\r\n\t\t} catch (e) {\r\n\t\t\tif (e instanceof RenderAbortedException) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthrow e;\r\n\t\t} finally {\r\n\t\t\tif (context === this.runningContext) {\r\n\t\t\t\tthis.runningContext = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic get width(): number {\r\n\t\treturn this.previewCanvas.width;\r\n\t}\r\n\r\n\tpublic get height(): number {\r\n\t\treturn this.previewCanvas.height;\r\n\t}\r\n\r\n\tpublic paintOnto(\r\n\t\tc: CanvasRenderingContext2D,\r\n\t\tx: number,\r\n\t\ty: number,\r\n\t\tw?: number,\r\n\t\th?: number\r\n\t) {\r\n\t\tif (w && h) {\r\n\t\t\tc.drawImage(this.previewCanvas, x, y, w, h);\r\n\t\t} else {\r\n\t\t\tc.drawImage(this.previewCanvas, x, y);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async download(\r\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\tconst downloadCanvas = document.createElement('canvas');\r\n\t\tdownloadCanvas.width = this.previewCanvas.width;\r\n\t\tdownloadCanvas.height = this.previewCanvas.height;\r\n\r\n\t\tconst ctx = downloadCanvas.getContext('2d')!;\r\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\r\n\t\tawait renderCallback(new RenderContext(ctx, true, false));\r\n\r\n\t\treturn await environment.saveToFile(downloadCanvas, filename);\r\n\t}\r\n\r\n\tpublic getDataAt(x: number, y: number): Uint8ClampedArray {\r\n\t\tconst ctx = this.previewCanvas.getContext('2d');\r\n\r\n\t\treturn ctx!.getImageData(x, y, 1, 1).data;\r\n\t}\r\n}\r\n","import { characterPositions } from './constants';\r\nimport { RenderContext } from '../renderer/rendererContext';\r\nimport {\r\n\tcharacters,\r\n\tgetAsset,\r\n\tPose,\r\n\tICharacter,\r\n\tIHeads,\r\n\tINsfwAbleImg,\r\n\tHeads,\r\n\tIStyle,\r\n} from '../asset-manager';\r\nimport { Renderer } from '../renderer/renderer';\r\nimport { IRenderable } from './renderable';\r\nimport { IDragable } from './dragable';\r\nimport { nsfwArraySeeker } from './seekers';\r\n\r\nexport type CharacterIds =\r\n\t| 'ddlc.monika'\r\n\t| 'ddlc.natsuki'\r\n\t| 'ddlc.sayori'\r\n\t| 'ddlc.yuri'\r\n\t| 'ddlc.fan.mc_classic'\r\n\t| 'ddlc.fan.femc';\r\nexport type Part = 'variant' | 'left' | 'right' | 'head';\r\n\r\nconst BaseCharacterYPos = -26;\r\nconst CloseUpYOffset = -74;\r\n\r\nexport class Character implements IRenderable, IDragable {\r\n\tpublic infront: boolean = false;\r\n\tpublic close: boolean = false;\r\n\tpublic flip: boolean = false;\r\n\tpublic opacity: number = 100;\r\n\tpublic styleData = {\r\n\t\tlastBase: '',\r\n\t\teyes: '',\r\n\t\thairs: '',\r\n\t};\r\n\tpublic posePositions = {\r\n\t\tvariant: 0,\r\n\t\tleft: 0,\r\n\t\tright: 0,\r\n\t\thead: 0,\r\n\t\theadType: 0,\r\n\t};\r\n\tprivate lq: boolean = true;\r\n\tprivate selected: boolean = false;\r\n\tprivate poseId: number = 0;\r\n\tprivate styleId: number = 0;\r\n\tprivate localRenderer = new Renderer(960, 960);\r\n\tprivate dirty = true;\r\n\tprivate hitDetectionFallback = false;\r\n\r\n\tprivate freeMove: boolean = false;\r\n\tprivate pPos: number = 4;\r\n\tprivate pX: number = characterPositions[4]!;\r\n\tprivate pY: number = BaseCharacterYPos;\r\n\r\n\tpublic constructor(\r\n\t\tpublic readonly name: CharacterIds,\r\n\t\tprivate readonly invalidator: Invalidator\r\n\t) {}\r\n\r\n\tpublic get label() {\r\n\t\treturn this.data.name;\r\n\t}\r\n\r\n\tpublic select() {\r\n\t\tthis.selected = true;\r\n\t}\r\n\r\n\tpublic unselect() {\r\n\t\tthis.selected = false;\r\n\t}\r\n\r\n\tpublic get data(): ICharacter<Heads> {\r\n\t\treturn characters[this.name];\r\n\t}\r\n\r\n\tpublic get style(): IStyle {\r\n\t\treturn this.data.styles[this.styleId];\r\n\t}\r\n\r\n\tpublic get poses(): Array<Pose<Heads>> {\r\n\t\treturn this.data.poses.filter(pose => pose.style === this.style.name);\r\n\t}\r\n\r\n\tpublic get pose(): Pose<Heads> {\r\n\t\treturn this.poses[this.poseId];\r\n\t}\r\n\r\n\tpublic nsfwCheck(): void {\r\n\t\tif (this.style.nsfw) {\r\n\t\t\tthis.seekStyle(1, false);\r\n\t\t}\r\n\r\n\t\tconst pose = this.pose as Pose<any>;\r\n\t\tconst partKeys = this.getParts();\r\n\r\n\t\tif (pose.nsfw) {\r\n\t\t\tthis.seekPose(1, false);\r\n\t\t}\r\n\r\n\t\tfor (const key of partKeys) {\r\n\t\t\tif (key === 'head') continue;\r\n\t\t\tconst image: { nsfw?: boolean } = (pose as any)[key][\r\n\t\t\t\tthis.posePositions[key]\r\n\t\t\t];\r\n\r\n\t\t\tif (image.nsfw) {\r\n\t\t\t\tthis.seekPart(key, 1, false);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.currentHeads) {\r\n\t\t\tif (this.currentHeads.nsfw) {\r\n\t\t\t\tthis.posePositions.headType = 0;\r\n\t\t\t\tthis.posePositions.head = 0;\r\n\t\t\t\tthis.dirty = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setPart(\r\n\t\tpart: Part | 'headType' | 'pose' | 'style',\r\n\t\tval: number\r\n\t): void {\r\n\t\tif (part === 'pose') {\r\n\t\t\tthis.protectHeadGroup(() => {\r\n\t\t\t\tthis.poseId = val;\r\n\t\t\t\tthis.ensurePoseIntegrity();\r\n\t\t\t});\r\n\t\t} else if (part === 'style') {\r\n\t\t\tthis.protectHeadGroup(() => {\r\n\t\t\t\tthis.styleId = val;\r\n\t\t\t\tif (this.poses.length <= this.poseId) {\r\n\t\t\t\t\tthis.poseId = 0;\r\n\t\t\t\t}\r\n\t\t\t\tthis.ensurePoseIntegrity();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.posePositions[part] = val;\r\n\t\t}\r\n\t\tthis.dirty = true;\r\n\t\tthis.invalidator();\r\n\t}\r\n\r\n\tpublic getParts(): Part[] {\r\n\t\tconst pose = this.pose;\r\n\t\tconst head: Array<'head'> =\r\n\t\t\tthis.pose.compatibleHeads.length > 0 ? ['head'] : [];\r\n\r\n\t\tif ('variant' in pose) {\r\n\t\t\treturn [...head, 'variant'];\r\n\t\t}\r\n\t\tif ('left' in pose) {\r\n\t\t\treturn [...head, 'left', 'right'];\r\n\t\t}\r\n\t\treturn head;\r\n\t}\r\n\r\n\tpublic get currentHeads(): IHeads | null {\r\n\t\tif (!this.pose.compatibleHeads || this.pose.compatibleHeads.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst heads = this.data.heads[\r\n\t\t\tthis.pose.compatibleHeads[this.posePositions.headType]\r\n\t\t];\r\n\t\treturn heads;\r\n\t}\r\n\r\n\tpublic async updateLocalCanvas() {\r\n\t\tawait this.localRenderer.render(async rx => {\r\n\t\t\tconst pose = this.pose as Pose<any>;\r\n\t\t\tconst assets: string[] = [];\r\n\t\t\tconst partKeys = this.getParts();\r\n\r\n\t\t\tif ('static' in pose) {\r\n\t\t\t\tassets.push(pose.static);\r\n\t\t\t} else {\r\n\t\t\t\tfor (const key of partKeys) {\r\n\t\t\t\t\tif (key === 'head') continue;\r\n\t\t\t\t\tconst image: INsfwAbleImg = (pose as any)[key][\r\n\t\t\t\t\t\tthis.posePositions[key]\r\n\t\t\t\t\t];\r\n\r\n\t\t\t\t\tassets.push(image.img);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst head = this.currentHeads\r\n\t\t\t\t? this.currentHeads.all[this.posePositions.head].img\r\n\t\t\t\t: null;\r\n\r\n\t\t\tconst [headAsset, ...bodyParts] = await Promise.all([\r\n\t\t\t\thead ? getAsset(head, rx.hq) : Promise.resolve(null),\r\n\t\t\t\t...assets.map(asset => getAsset(asset, rx.hq)),\r\n\t\t\t]);\r\n\r\n\t\t\tconst drawHead = () => {\r\n\t\t\t\tif (headAsset) {\r\n\t\t\t\t\tconst headAnchor = this.pose.headAnchor\r\n\t\t\t\t\t\t? this.pose.headAnchor\r\n\t\t\t\t\t\t: [0, 0];\r\n\r\n\t\t\t\t\trx.drawImage({\r\n\t\t\t\t\t\timage: headAsset,\r\n\t\t\t\t\t\tx: headAnchor[0],\r\n\t\t\t\t\t\ty: (this.name === 'ddlc.monika' ? 1 : 0) + headAnchor[1],\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (!this.pose.headInForeground) {\r\n\t\t\t\tdrawHead();\r\n\t\t\t}\r\n\r\n\t\t\tfor (const bodyPart of bodyParts) {\r\n\t\t\t\trx.drawImage({ image: bodyPart!, x: 0, y: 0 });\r\n\t\t\t}\r\n\r\n\t\t\tif (this.pose.headInForeground) {\r\n\t\t\t\tdrawHead();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic async render(rx: RenderContext) {\r\n\t\tif (this.dirty || this.lq !== !rx.hq) {\r\n\t\t\tawait this.updateLocalCanvas();\r\n\t\t\tthis.dirty = false;\r\n\t\t}\r\n\r\n\t\tconst zoom = this.close ? 1.6 : 0.8;\r\n\t\tconst size = 960 * zoom;\r\n\t\tconst x = this.pX - size / 2;\r\n\t\tconst y = (this.close ? CloseUpYOffset : 0) + this.pY;\r\n\r\n\t\trx.drawImage({\r\n\t\t\timage: this.localRenderer,\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tw: size,\r\n\t\t\th: size,\r\n\t\t\tflip: this.flip,\r\n\t\t\tshadow:\r\n\t\t\t\tthis.selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\r\n\t\t\topacity: this.opacity,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic hitTest(hx: number, hy: number): boolean {\r\n\t\tconst zoom = this.close ? 1.6 : 0.8;\r\n\t\tconst size = 960 * zoom;\r\n\t\tlet x = (hx - this.pX + size / 2) / zoom;\r\n\t\tconst y = (hy - (this.close ? CloseUpYOffset : 0) - this.pY) / zoom;\r\n\r\n\t\tif (this.flip) {\r\n\t\t\tx = 960 - x;\r\n\t\t}\r\n\t\tif (!this.hitDetectionFallback) {\r\n\t\t\ttry {\r\n\t\t\t\tconst data = this.localRenderer.getDataAt(x, y);\r\n\t\t\t\treturn data[3] !== 0;\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// On chrome for android, the hit test tends to fail because of cross-origin shinanigans, even though\r\n\t\t\t\t// we only ever load from one origin. ¯\\_(ツ)_/¯\r\n\t\t\t\t// So we have a fallback that doesn't read the contents of the canvas. This looses accuracy, but at\r\n\t\t\t\t// least works always.\r\n\t\t\t\tif (e instanceof DOMException && e.message.includes('cross-origin')) {\r\n\t\t\t\t\tthis.hitDetectionFallback = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow e;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (y < 50 || y > 680) return false;\r\n\t\treturn Math.abs(x - 480) < 150;\r\n\t}\r\n\r\n\tpublic seekHead(delta: 1 | -1, nsfw: boolean) {\r\n\t\tif (!this.currentHeads) return;\r\n\t\tthis.posePositions.head += delta;\r\n\t\tif (\r\n\t\t\tthis.posePositions.head < 0 ||\r\n\t\t\tthis.posePositions.head >= this.currentHeads.all.length\r\n\t\t) {\r\n\t\t\tthis.posePositions.headType = nsfwArraySeeker(\r\n\t\t\t\tthis.pose.compatibleHeads.map(headKey => this.data.heads[headKey]),\r\n\t\t\t\tthis.posePositions.headType,\r\n\t\t\t\tdelta,\r\n\t\t\t\tnsfw\r\n\t\t\t);\r\n\t\t\tthis.posePositions.head =\r\n\t\t\t\tdelta === 1 ? 0 : this.currentHeads.all.length - 1;\r\n\t\t}\r\n\t\tthis.dirty = true;\r\n\t\tthis.invalidator();\r\n\t}\r\n\r\n\tpublic seekPart(part: Part, delta: 1 | -1, nsfw: boolean) {\r\n\t\tif (part === 'head') return this.seekHead(delta, nsfw);\r\n\t\tif (!(this.pose as any)[part]) return;\r\n\t\tthis.posePositions[part] = nsfwArraySeeker(\r\n\t\t\t(this.pose as any)[part],\r\n\t\t\tthis.posePositions[part],\r\n\t\t\tdelta,\r\n\t\t\tnsfw\r\n\t\t);\r\n\t\tthis.dirty = true;\r\n\t\tthis.invalidator();\r\n\t}\r\n\r\n\tpublic seekPose(delta: number, nsfw: boolean) {\r\n\t\tthis.protectHeadGroup(() => {\r\n\t\t\tthis.poseId = nsfwArraySeeker(this.poses, this.poseId, delta, nsfw);\r\n\t\t\tif (this.poses.length <= this.poseId) {\r\n\t\t\t\tthis.poseId = 0;\r\n\t\t\t}\r\n\t\t\tthis.ensurePoseIntegrity();\r\n\t\t});\r\n\t\tthis.dirty = true;\r\n\t\tthis.invalidator();\r\n\t}\r\n\r\n\tpublic seekStyle(delta: number, nsfw: boolean) {\r\n\t\tthis.protectHeadGroup(() => {\r\n\t\t\tthis.styleId = nsfwArraySeeker(\r\n\t\t\t\tthis.data.styles,\r\n\t\t\t\tthis.styleId,\r\n\t\t\t\tdelta,\r\n\t\t\t\tnsfw\r\n\t\t\t);\r\n\t\t\tthis.ensurePoseIntegrity();\r\n\t\t});\r\n\t\tthis.dirty = true;\r\n\t\tthis.invalidator();\r\n\t}\r\n\r\n\tpublic get allowFreeMove(): boolean {\r\n\t\treturn this.freeMove;\r\n\t}\r\n\r\n\tpublic set allowFreeMove(allow: boolean) {\r\n\t\tif (allow) {\r\n\t\t\tthis.freeMove = true;\r\n\t\t} else {\r\n\t\t\tthis.freeMove = false;\r\n\t\t\tthis.pos = this.closestCharacterSlot(this.pX);\r\n\t\t\tthis.pY = BaseCharacterYPos;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get x(): number {\r\n\t\treturn this.pX;\r\n\t}\r\n\r\n\tpublic set x(pos: number) {\r\n\t\tif (this.allowFreeMove) {\r\n\t\t\tthis.pX = pos;\r\n\t\t} else {\r\n\t\t\tthis.pos = this.closestCharacterSlot(pos);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get y(): number {\r\n\t\treturn this.pY;\r\n\t}\r\n\r\n\tpublic set y(pos: number) {\r\n\t\tif (this.allowFreeMove) {\r\n\t\t\tthis.pY = pos;\r\n\t\t} else {\r\n\t\t\tthis.pY = BaseCharacterYPos;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get pos() {\r\n\t\treturn this.pPos;\r\n\t}\r\n\r\n\tpublic set pos(pos: number) {\r\n\t\tif (this.allowFreeMove) return;\r\n\t\tif (pos < 0) pos = 0;\r\n\t\tif (pos >= characterPositions.length) pos = characterPositions.length - 1;\r\n\r\n\t\tthis.pPos = pos;\r\n\t\tthis.pX = characterPositions[pos];\r\n\t}\r\n\r\n\tpublic hasMultiple(part: Part, nsfw: boolean) {\r\n\t\tif (part === 'head') {\r\n\t\t\tlet groupFound = false;\r\n\t\t\tfor (const compatibleHead of this.pose.compatibleHeads) {\r\n\t\t\t\tconst group = this.data.heads[compatibleHead];\r\n\t\t\t\tif (groupFound) return true;\r\n\t\t\t\tif (!nsfw) {\r\n\t\t\t\t\tif (group.nsfw) continue;\r\n\t\t\t\t\tif (group.all.filter(head => !head.nsfw).length > 1) return true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (group.all.length > 1) return true;\r\n\t\t\t\t}\r\n\t\t\t\tgroupFound = true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!(this.pose as any)[part]) return false;\r\n\t\tconst all = (this.pose as any)[part] as INsfwAbleImg[];\r\n\t\tif (!nsfw) {\r\n\t\t\treturn all.filter(img => !img.nsfw).length > 1;\r\n\t\t} else {\r\n\t\t\treturn all.length > 1;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate closestCharacterSlot(pos: number): number {\r\n\t\tconst sorted = characterPositions\r\n\t\t\t.map((x, idx) => ({ pos: Math.abs(pos - x), idx }))\r\n\t\t\t.sort((a, b) => a.pos - b.pos);\r\n\t\treturn sorted[0].idx;\r\n\t}\r\n\r\n\tprivate protectHeadGroup(callback: () => void) {\r\n\t\tconst oldHeadCollection = this.pose.compatibleHeads[\r\n\t\t\tthis.posePositions.headType\r\n\t\t];\r\n\r\n\t\tcallback();\r\n\r\n\t\tconst newHeadCollectionNr = this.pose.compatibleHeads.indexOf(\r\n\t\t\toldHeadCollection\r\n\t\t);\r\n\t\tif (newHeadCollectionNr >= 0) {\r\n\t\t\tthis.posePositions.headType = newHeadCollectionNr;\r\n\t\t} else {\r\n\t\t\tthis.posePositions.headType = 0;\r\n\t\t\tthis.posePositions.head = 0;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate ensurePoseIntegrity() {\r\n\t\tif (!this.pose) {\r\n\t\t\tthis.poseId = 0;\r\n\t\t}\r\n\t\tif ('left' in this.pose) {\r\n\t\t\tif (!this.pose.left[this.posePositions.left]) {\r\n\t\t\t\tthis.posePositions.left = 0;\r\n\t\t\t}\r\n\t\t\tif (!this.pose.right[this.posePositions.right]) {\r\n\t\t\t\tthis.posePositions.right = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ('variant' in this.pose) {\r\n\t\t\tif (!this.pose.variant[this.posePositions.variant]) {\r\n\t\t\t\tthis.posePositions.variant = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ partList: true, vertical: _vm.vertical }},[_c('button',{on:{\"click\":function($event){return _vm.$emit('leave')}}},[_vm._v(\"Back\")]),_vm._l((_vm.parts),function(part,index){return _c('part-button',{key:index,attrs:{\"value\":index,\"part\":part},on:{\"click\":function($event){_vm.choose(index);_vm.$emit('leave')}}})}),(_vm.eyes)?_c('fieldset',[_c('legend',[_vm._v(\"Eyes\")]),_vm._l((_vm.eyes),function(part,index){return _c('part-button',{key:index,attrs:{\"size\":130,\"value\":index,\"part\":part},on:{\"click\":function($event){return _vm.choose_eyes(index)}}})})],2):_vm._e(),(_vm.hairs)?_c('fieldset',[_c('legend',[_vm._v(\"Hairstyles\")]),_vm._l((_vm.hairs),function(part,index){return _c('part-button',{key:index,attrs:{\"size\":130,\"value\":index,\"part\":part},on:{\"click\":function($event){return _vm.choose_hairs(index)}}})})],2):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{part: true, active: false/*background === value*/},style:(_vm.style),on:{\"click\":function($event){return _vm.$emit('click')}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { IBackground, color, Background } from '../../../models/background';\r\nimport { VariantBackground } from '../../../models/variant-background';\r\nimport {\r\n\tisWebPSupported,\r\n\tgetAsset,\r\n\tINsfwAbleImg,\r\n} from '../../../asset-manager';\r\nimport environment from '../../../environments/environment';\r\nimport { ErrorAsset } from '../../../models/error-asset';\r\n\r\nexport interface IPartButtonImage {\r\n\timage1: string;\r\n\timage2?: string;\r\n\timage3?: string;\r\n\tsize: [number, number];\r\n\toffset: [number, number];\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class PartButton extends Vue {\r\n\t@Prop({ required: true }) private readonly part!: IPartButtonImage;\r\n\t@Prop({ required: true }) private readonly value!: number;\r\n\t@Prop({ default: 150, type: Number })\r\n\tprivate readonly size!: number;\r\n\r\n\tprivate lookup: HTMLImageElement | ErrorAsset | null = null;\r\n\tprivate lookup2: HTMLImageElement | ErrorAsset | null = null;\r\n\tprivate lookup3: HTMLImageElement | ErrorAsset | null = null;\r\n\tprivate loaded = false;\r\n\r\n\tprivate async created() {\r\n\t\tthis.lookup = await getAsset(this.part.image1, false);\r\n\t\tthis.lookup2 = this.part.image2\r\n\t\t\t? await getAsset(this.part.image2, false)\r\n\t\t\t: null;\r\n\t}\r\n\r\n\tprivate get scaleX(): number {\r\n\t\treturn this.size / this.part.size[0];\r\n\t}\r\n\r\n\tprivate get scaleY(): number {\r\n\t\treturn this.size / this.part.size[1];\r\n\t}\r\n\r\n\tprivate get backgroundSize(): string {\r\n\t\treturn `${Math.floor(960 * this.scaleX)}px ${Math.floor(\r\n\t\t\t960 * this.scaleY\r\n\t\t)}px`;\r\n\t}\r\n\r\n\tprivate get backgroundPosition(): string {\r\n\t\treturn (\r\n\t\t\t`${Math.floor(this.part.offset[0] * -this.scaleX)}px ` +\r\n\t\t\t`${Math.floor(this.part.offset[1] * -this.scaleY)}px`\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get style(): { [id: string]: string } {\r\n\t\tconst baseStyle = {\r\n\t\t\theight: this.size + 'px',\r\n\t\t\twidth: this.size + 'px',\r\n\t\t\tbackgroundPosition: this.backgroundPosition,\r\n\t\t\tbackgroundSize: this.backgroundSize,\r\n\t\t};\r\n\t\tconst lq = environment.allowLQ ? '.lq' : '';\r\n\t\tif (this.lookup instanceof HTMLImageElement) {\r\n\t\t\tif (this.lookup2 instanceof HTMLImageElement) {\r\n\t\t\t\tif (this.lookup3 instanceof HTMLImageElement) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tbackgroundImage: `url('${this.lookup.src.replace(\r\n\t\t\t\t\t\t\t\"'\",\r\n\t\t\t\t\t\t\t\"\\\\'\"\r\n\t\t\t\t\t\t)}'), url('${this.lookup2.src.replace(\r\n\t\t\t\t\t\t\t\"'\",\r\n\t\t\t\t\t\t\t\"\\\\'\"\r\n\t\t\t\t\t\t)}'), url('${this.lookup3.src.replace(\"'\", \"\\\\'\")}')`,\r\n\t\t\t\t\t\t...baseStyle,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tbackgroundImage: `url('${this.lookup.src.replace(\r\n\t\t\t\t\t\t\"'\",\r\n\t\t\t\t\t\t\"\\\\'\"\r\n\t\t\t\t\t)}'), url('${this.lookup2.src.replace(\"'\", \"\\\\'\")}')`,\r\n\t\t\t\t\t...baseStyle,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tbackgroundImage: `url('${this.lookup.src.replace(\"'\", \"\\\\'\")}')`,\r\n\t\t\t\t...baseStyle,\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {};\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./partButton.vue?vue&type=template&id=e0ad2e54&scoped=true&\"\nimport script from \"./partButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./partButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./partButton.vue?vue&type=style&index=0&id=e0ad2e54&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e0ad2e54\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\nimport {\r\n\tisWebPSupported,\r\n\tICharacter,\r\n\tcharacterOrder,\r\n\tregisterAsset,\r\n\tregisterAssetWithURL,\r\n\tINsfwAbleImg,\r\n\tPose,\r\n} from '@/asset-manager';\r\nimport environment from '@/environments/environment';\r\nimport { Part, Character } from '@/models/character';\r\nimport PartButton, { IPartButtonImage } from './partButton.vue';\r\nimport { poses } from '../../../models/constants';\r\nimport { baseUrl } from '../../../asset-manager';\r\n\r\ninterface IStyle {\r\n\tfullName: string;\r\n\treducedName: string;\r\n\tindex: number;\r\n\tlabel: string;\r\n\teyes: string | null;\r\n\thairs: string | null;\r\n}\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tPartButton,\r\n\t},\r\n})\r\nexport default class PartsPanel extends Vue {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\t@Prop({ type: Character, required: true }) private character!: Character;\r\n\t@Prop({ required: true, type: String }) private readonly part!:\r\n\t\t| Part\r\n\t\t| 'pose'\r\n\t\t| 'style';\r\n\t@Prop({ required: true, type: Boolean }) private readonly nsfw!: boolean;\r\n\r\n\tprivate isWebPSupported: boolean | null = null;\r\n\tprivate customAssetCount = 0;\r\n\r\n\tprivate async created() {\r\n\t\tthis.isWebPSupported = await isWebPSupported();\r\n\t\tif (this.character.styleData.lastBase === '') {\r\n\t\t\tconst baseStyle = this.styleData[0];\r\n\t\t\tthis.character.styleData.lastBase = baseStyle.reducedName;\r\n\t\t\tthis.character.styleData.eyes = baseStyle.eyes || '';\r\n\t\t\tthis.character.styleData.hairs = baseStyle.hairs || '';\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get eyes(): { [id: string]: IPartButtonImage } | null {\r\n\t\tif (this.part !== 'style') return null;\r\n\t\tconst keys = Object.keys(this.character.data.eyes);\r\n\t\tif (keys.length < 2) return null;\r\n\t\tconst ret: { [id: string]: IPartButtonImage } = {};\r\n\t\tfor (const key of keys) {\r\n\t\t\tret[key] = {\r\n\t\t\t\timage1: this.character.data.eyes[key],\r\n\t\t\t\tsize: [960, 960],\r\n\t\t\t\toffset: [0, 0],\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate get hairs(): { [id: string]: IPartButtonImage } | null {\r\n\t\tif (this.part !== 'style') return null;\r\n\t\tconst keys = Object.keys(this.character.data.hairs);\r\n\t\tif (keys.length < 2) return null;\r\n\t\tconst ret: { [id: string]: IPartButtonImage } = {};\r\n\t\tfor (const key of keys) {\r\n\t\t\tret[key] = {\r\n\t\t\t\timage1: this.character.data.hairs[key],\r\n\t\t\t\tsize: [960, 960],\r\n\t\t\t\toffset: [0, 0],\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate get parts(): { [id: number]: IPartButtonImage } {\r\n\t\tconst ret: { [id: string]: IPartButtonImage } = {};\r\n\t\tlet collection: INsfwAbleImg[];\r\n\t\tlet offset: IPartButtonImage['offset'];\r\n\t\tlet size: IPartButtonImage['size'];\r\n\t\tconst data = this.character.data;\r\n\t\tswitch (this.part) {\r\n\t\t\tcase 'head':\r\n\t\t\t\tfor (\r\n\t\t\t\t\tlet headKeyIdx = 0;\r\n\t\t\t\t\theadKeyIdx < this.character.pose.compatibleHeads.length;\r\n\t\t\t\t\t++headKeyIdx\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst headKey = this.character.pose.compatibleHeads[headKeyIdx];\r\n\t\t\t\t\tconst heads = data.heads[headKey];\r\n\t\t\t\t\tif (heads.nsfw && !this.nsfw) continue;\r\n\t\t\t\t\tfor (let headIdx = 0; headIdx < heads.all.length; ++headIdx) {\r\n\t\t\t\t\t\tconst head = heads.all[headIdx];\r\n\t\t\t\t\t\tif (head.nsfw && !this.nsfw) continue;\r\n\t\t\t\t\t\tret[`${headKeyIdx}_${headIdx}`] = {\r\n\t\t\t\t\t\t\timage1: head.img,\r\n\t\t\t\t\t\t\tsize: heads.size,\r\n\t\t\t\t\t\t\toffset: heads.offset,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'variant':\r\n\t\t\t\tcollection =\r\n\t\t\t\t\t'variant' in this.character.pose ? this.character.pose.variant : [];\r\n\t\t\t\tsize = this.character.pose.size;\r\n\t\t\t\toffset = this.character.pose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tcollection =\r\n\t\t\t\t\t'left' in this.character.pose ? this.character.pose.left : [];\r\n\t\t\t\tsize = this.character.pose.size;\r\n\t\t\t\toffset = this.character.pose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\tcollection =\r\n\t\t\t\t\t'right' in this.character.pose ? this.character.pose.right : [];\r\n\t\t\t\tsize = this.character.pose.size;\r\n\t\t\t\toffset = this.character.pose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pose':\r\n\t\t\t\tfor (\r\n\t\t\t\t\tlet poseIdx = 0;\r\n\t\t\t\t\tposeIdx < this.character.poses.length;\r\n\t\t\t\t\t++poseIdx\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst pose = this.character.poses[poseIdx];\r\n\t\t\t\t\tif (pose.nsfw && !this.nsfw) continue;\r\n\t\t\t\t\tret[poseIdx] = this.generatePosePreview(pose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'style':\r\n\t\t\t\tconst styles = data.styles.filter(style => !style.nsfw || this.nsfw);\r\n\t\t\t\tconst eyes = this.eyes ? Object.keys(this.eyes) : [];\r\n\t\t\t\tconst hairs = this.hairs ? Object.keys(this.hairs) : [];\r\n\t\t\t\tconst dedupedStyles = this.styleData\r\n\t\t\t\t\t.map(style => style.reducedName)\r\n\t\t\t\t\t.map((style, idx, all) => {\r\n\t\t\t\t\t\tif (all.indexOf(style) !== idx) return null;\r\n\t\t\t\t\t\treturn style;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tfor (let styleIdx = 0; styleIdx < styles.length; ++styleIdx) {\r\n\t\t\t\t\tif (dedupedStyles[styleIdx] === null) continue;\r\n\t\t\t\t\tconst style = styles[styleIdx];\r\n\t\t\t\t\tif (style.nsfw && !this.nsfw) continue;\r\n\t\t\t\t\tconst pose = data.poses.find(pose => pose.style === style.name)!;\r\n\t\t\t\t\tret[dedupedStyles[styleIdx]!] = this.generatePosePreview(pose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Unrecognised pose part: ' + this.part);\r\n\t\t}\r\n\t\tfor (let partIdx = 0; partIdx < collection.length; ++partIdx) {\r\n\t\t\tconst part = collection[partIdx];\r\n\t\t\tif (part.nsfw && !this.nsfw) continue;\r\n\t\t\tret[partIdx] = {\r\n\t\t\t\timage1: part.img,\r\n\t\t\t\tsize,\r\n\t\t\t\toffset,\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate generatePosePreview(pose: Pose<any>): IPartButtonImage {\r\n\t\tif ('static' in pose) {\r\n\t\t\treturn {\r\n\t\t\t\timage1: pose.static,\r\n\t\t\t\tsize: pose.size,\r\n\t\t\t\toffset: pose.offset,\r\n\t\t\t};\r\n\t\t} else if ('variant' in pose) {\r\n\t\t\treturn {\r\n\t\t\t\timage1: pose.variant[0].img,\r\n\t\t\t\tsize: pose.size,\r\n\t\t\t\toffset: pose.offset,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\timage1: pose.left[0].img,\r\n\t\t\t\timage2: pose.right[0].img,\r\n\t\t\t\tsize: pose.size,\r\n\t\t\t\toffset: pose.offset,\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get styleData(): IStyle[] {\r\n\t\tconst styles = this.character.data.styles;\r\n\t\tconst eyesColl = Object.keys(this.eyes || {});\r\n\t\tconst hairsColl = Object.keys(this.hairs || {});\r\n\r\n\t\tlet ret = styles.map((value, index) => {\r\n\t\t\tlet reducedName = value.name;\r\n\t\t\tlet eyes = null;\r\n\t\t\tfor (const iEyes of eyesColl) {\r\n\t\t\t\tconst exp = new RegExp('-' + iEyes + '\\\\b');\r\n\t\t\t\tif (reducedName.match(exp)) {\r\n\t\t\t\t\teyes = iEyes;\r\n\t\t\t\t\treducedName = reducedName.replace(exp, '');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet hairs = null;\r\n\t\t\tfor (const iHair of hairsColl) {\r\n\t\t\t\tconst exp = new RegExp('-' + iHair + '\\\\b');\r\n\t\t\t\tif (reducedName.match(exp)) {\r\n\t\t\t\t\thairs = iHair;\r\n\t\t\t\t\treducedName = reducedName.replace(exp, '');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tfullName: value.name,\r\n\t\t\t\tlabel: value.label,\r\n\t\t\t\tnsfw: value.nsfw,\r\n\t\t\t\tindex,\r\n\t\t\t\treducedName,\r\n\t\t\t\teyes,\r\n\t\t\t\thairs,\r\n\t\t\t};\r\n\t\t});\r\n\t\tif (!this.nsfw) {\r\n\t\t\tret = ret.filter(style => {\r\n\t\t\t\treturn !style.nsfw;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate updatePose() {\r\n\t\tlet selection = this.styleData.filter(\r\n\t\t\tstyle => style.reducedName === this.character.styleData.lastBase\r\n\t\t);\r\n\t\tconst subEyes = selection.filter(\r\n\t\t\tstyle => style.eyes === this.character.styleData.eyes\r\n\t\t);\r\n\t\tif (subEyes.length > 0) selection = subEyes;\r\n\t\tconst subHairs = selection.filter(\r\n\t\t\tstyle => style.hairs === this.character.styleData.hairs\r\n\t\t);\r\n\t\tif (subHairs.length > 0) selection = subHairs;\r\n\t\tthis.character.setPart('style', selection[0].index);\r\n\t}\r\n\r\n\tprivate choose(index: string) {\r\n\t\tif (this.part === 'style') {\r\n\t\t\tthis.character.styleData.lastBase = index;\r\n\t\t\tthis.updatePose();\r\n\t\t} else if (this.part === 'head') {\r\n\t\t\tconst [headTypeIdx, headIdx] = index\r\n\t\t\t\t.split('_', 2)\r\n\t\t\t\t.map(part => parseInt(part, 10));\r\n\t\t\tthis.character.setPart('headType', headTypeIdx);\r\n\t\t\tthis.character.setPart('head', headIdx);\r\n\t\t} else {\r\n\t\t\tthis.character.setPart(this.part, parseInt(index, 10));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate choose_eyes(index: string) {\r\n\t\tthis.character.styleData.eyes = index;\r\n\t\tthis.updatePose();\r\n\t}\r\n\r\n\tprivate choose_hairs(index: string) {\r\n\t\tthis.character.styleData.hairs = index;\r\n\t\tthis.updatePose();\r\n\t}\r\n\r\n\tprivate onFileUpload(e: Event) {\r\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\r\n\t\tif (!uploadInput.files) return;\r\n\t\tfor (const file of uploadInput.files) {\r\n\t\t\t(nr => {\r\n\t\t\t\tconst name = 'customAsset' + nr;\r\n\t\t\t\tconst url = registerAsset(name, file);\r\n\t\t\t\tthis.$emit('add-custom-asset', name);\r\n\t\t\t})(++this.customAssetCount);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async uploadFromURL() {\r\n\t\tconst url = prompt('Enter the URL of the image');\r\n\t\tif (!url) return;\r\n\t\tconst name = 'customAsset' + ++this.customAssetCount;\r\n\t\tawait registerAssetWithURL(name, url);\r\n\t\tthis.$emit('add-custom-asset', name);\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./parts.vue?vue&type=template&id=8370f658&scoped=true&\"\nimport script from \"./parts.vue?vue&type=script&lang=ts&\"\nexport * from \"./parts.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./parts.vue?vue&type=style&index=0&id=8370f658&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8370f658\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\r\nimport { isWebPSupported } from '../../asset-manager';\r\nimport { Character, Part } from '../../models/character';\r\nimport { IRenderable } from '../../models/renderable';\r\nimport { positions } from '../../models/constants';\r\nimport Toggle from '../Toggle.vue';\r\nimport Parts from './character/parts.vue';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tToggle,\r\n\t\tParts,\r\n\t},\r\n})\r\nexport default class CharacterPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\t@Prop({ type: Character, required: true }) private character!: Character;\r\n\t@Prop({ required: true, type: Boolean }) private readonly nsfw!: boolean;\r\n\r\n\tprivate panelForParts: Part | null = null;\r\n\tprivate isWebPSupported: boolean | null = null;\r\n\r\n\t@Watch('character')\r\n\tpublic reset() {\r\n\t\tthis.panelForParts = null;\r\n\t}\r\n\r\n\tprivate async created() {\r\n\t\tthis.isWebPSupported = await isWebPSupported();\r\n\t}\r\n\r\n\tprivate get positionNames(): string[] {\r\n\t\treturn positions;\r\n\t}\r\n\r\n\tprivate get parts(): string[] {\r\n\t\treturn this.character\r\n\t\t\t.getParts()\r\n\t\t\t.filter(part => this.character.hasMultiple(part, this.nsfw));\r\n\t}\r\n\r\n\tprivate get hasMultipleStyles(): boolean {\r\n\t\treturn (\r\n\t\t\tthis.character.data.styles.filter(style => !style.nsfw || this.nsfw)\r\n\t\t\t\t.length > 1\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get hasMultiplePoses(): boolean {\r\n\t\treturn (\r\n\t\t\tthis.character.poses.filter(style => !style.nsfw || this.nsfw).length > 1\r\n\t\t);\r\n\t}\r\n\r\n\tprivate captialize(str: string) {\r\n\t\treturn str.charAt(0).toUpperCase() + str.substring(1);\r\n\t}\r\n}\r\n\r\nexport interface MoveObject {\r\n\tobject: IRenderable;\r\n\tmove: 'Forward' | 'Backward' | 'Back' | 'Front' | 'Delete';\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./character.vue?vue&type=template&id=561345aa&scoped=true&\"\nimport script from \"./character.vue?vue&type=script&lang=ts&\"\nexport * from \"./character.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./character.vue?vue&type=style&index=0&id=561345aa&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"561345aa\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"Custom Sprite\")]),_c('fieldset',[_c('legend',[_vm._v(\"Position/Size:\")]),_c('label',{attrs:{\"for\":\"sprite_x\"}},[_vm._v(\"X:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.sprite.x),expression:\"sprite.x\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_x\",\"type\":\"number\"},domProps:{\"value\":(_vm.sprite.x)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.sprite, \"x\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_y\"}},[_vm._v(\"Y:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.sprite.y),expression:\"sprite.y\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_y\",\"type\":\"number\"},domProps:{\"value\":(_vm.sprite.y)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.sprite, \"y\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_w\"}},[_vm._v(\"Width:\")]),_c('input',{attrs:{\"id\":\"sprite_w\",\"type\":\"number\"},domProps:{\"value\":_vm.sprite.width},on:{\"input\":_vm.setWidth,\"keydown\":function($event){$event.stopPropagation();}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_h\"}},[_vm._v(\"Height:\")]),_c('input',{attrs:{\"id\":\"sprite_h\",\"type\":\"number\"},domProps:{\"value\":_vm.sprite.height},on:{\"input\":_vm.setHeight,\"keydown\":function($event){$event.stopPropagation();}}}),_c('toggle',{attrs:{\"value\":_vm.sprite.lockedRatio,\"label\":\"Lock ratio?\"},on:{\"input\":_vm.setRatioLock}})],1),_c('fieldset',{attrs:{\"id\":\"layerfs\"}},[_c('legend',[_vm._v(\"Layer:\")]),_c('button',{attrs:{\"title\":\"Move to back\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.sprite, move: 'Back'})}}},[_vm._v(\"⤓\")]),_c('button',{attrs:{\"title\":\"Move backwards\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.sprite, move: 'Backward'})}}},[_vm._v(\"↓\")]),_c('button',{attrs:{\"title\":\"Move forwards\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.sprite, move: 'Forward'})}}},[_vm._v(\"↑\")]),_c('button',{attrs:{\"title\":\"Move to front\"},on:{\"click\":function($event){return _vm.$emit('shiftLayer', {object: _vm.sprite, move: 'Front'})}}},[_vm._v(\"⤒\")]),_c('toggle',{attrs:{\"label\":\"In front of textbox?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.sprite.infront),callback:function ($$v) {_vm.$set(_vm.sprite, \"infront\", $$v)},expression:\"sprite.infront\"}})],1),_c('div',[_c('label',{attrs:{\"for\":\"characterOpacity\"}},[_vm._v(\"Opacity:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.sprite.opacity),expression:\"sprite.opacity\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"max\":\"100\",\"min\":\"0\",\"id\":\"characterOpacity\"},domProps:{\"value\":(_vm.sprite.opacity)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.sprite, \"opacity\", _vm._n($event.target.value))},function($event){return _vm.$emit('invalidate-render')}],\"keydown\":function($event){$event.stopPropagation();},\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('toggle',{attrs:{\"label\":\"Flip?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.sprite.flip),callback:function ($$v) {_vm.$set(_vm.sprite, \"flip\", $$v)},expression:\"sprite.flip\"}}),_c('button',{on:{\"click\":function($event){_vm.$emit('shiftLayer', {object: _vm.sprite, move: 'Delete'});_vm.$emit('close')}}},[_vm._v(\"Delete\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { RenderContext } from '../renderer/rendererContext';\r\nimport { getAsset } from '../asset-manager';\r\nimport { IRenderable } from './renderable';\r\nimport { IDragable } from './dragable';\r\nimport { ErrorAsset } from './error-asset';\r\n\r\nconst BaseXPosition = 640;\r\n\r\nexport class Sprite implements IRenderable, IDragable {\r\n\tpublic infront: boolean = false;\r\n\tpublic x: number = BaseXPosition;\r\n\tpublic y: number = 0;\r\n\tpublic width: number = 0;\r\n\tpublic height: number = 0;\r\n\tpublic ratio: number = 0;\r\n\tpublic lockedRatio: boolean = true;\r\n\tpublic flip: boolean = false;\r\n\tpublic opacity: number = 100;\r\n\tprivate asset: HTMLImageElement | null = null;\r\n\tprivate selected: boolean = false;\r\n\r\n\tpublic constructor(\r\n\t\tpublic readonly assetName: string,\r\n\t\tprivate readonly invalidator: Invalidator\r\n\t) {\r\n\t\tgetAsset(assetName)\r\n\t\t\t.then(asset => {\r\n\t\t\t\tif (asset instanceof ErrorAsset) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.asset = asset;\r\n\t\t\t\tthis.width = asset.width;\r\n\t\t\t\tthis.height = asset.height;\r\n\t\t\t\tthis.ratio = this.width / this.height;\r\n\t\t\t\tthis.invalidator();\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.error(`Failed to load asset: ${err}`);\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic select() {\r\n\t\tthis.selected = true;\r\n\t}\r\n\r\n\tpublic unselect() {\r\n\t\tthis.selected = false;\r\n\t}\r\n\r\n\tpublic async render(rx: RenderContext) {\r\n\t\tif (!this.asset) return;\r\n\t\tconst x = this.x - this.width / 2;\r\n\t\trx.drawImage({\r\n\t\t\timage: this.asset,\r\n\t\t\tx,\r\n\t\t\ty: this.y,\r\n\t\t\tw: this.width,\r\n\t\t\th: this.height,\r\n\t\t\tshadow:\r\n\t\t\t\tthis.selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\r\n\t\t\tflip: this.flip,\r\n\t\t\topacity: this.opacity,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic hitTest(hx: number, hy: number): boolean {\r\n\t\tconst hitX = hx - this.x + this.width / 2;\r\n\t\tconst hitY = hy - this.y;\r\n\t\treturn hitX >= 0 && hitX <= this.width && hitY >= 0 && hitY <= this.height;\r\n\t}\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { isWebPSupported } from '../../asset-manager';\r\nimport { Character } from '../../models/character';\r\nimport Toggle from '../Toggle.vue';\r\nimport { IRenderable } from '../../models/renderable';\r\nimport { Sprite } from '../../models/sprite';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tToggle,\r\n\t},\r\n})\r\nexport default class SpritePanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\t@Prop({ type: Sprite, required: true }) private sprite!: Sprite;\r\n\r\n\tprivate setHeight(event: Event): void {\r\n\t\tconst height = Number((event.target! as HTMLInputElement).value);\r\n\t\tif (this.sprite.lockedRatio) {\r\n\t\t\tthis.sprite.width = height * this.sprite.ratio;\r\n\t\t}\r\n\t\tthis.sprite.height = height;\r\n\t\tthis.$emit('invalidate-render');\r\n\t}\r\n\r\n\tprivate setWidth(event: Event): void {\r\n\t\tconst width = Number((event.target! as HTMLInputElement).value);\r\n\t\tif (this.sprite.lockedRatio) {\r\n\t\t\tthis.sprite.height = width / this.sprite.ratio;\r\n\t\t}\r\n\t\tthis.sprite.width = width;\r\n\t\tthis.$emit('invalidate-render');\r\n\t}\r\n\r\n\tprivate setRatioLock(lock: boolean) {\r\n\t\tthis.sprite.lockedRatio = lock;\r\n\t\tif (lock) {\r\n\t\t\tthis.sprite.ratio = this.sprite.width / this.sprite.height;\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./sprite.vue?vue&type=template&id=5448387c&scoped=true&\"\nimport script from \"./sprite.vue?vue&type=script&lang=ts&\"\nexport * from \"./sprite.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./sprite.vue?vue&type=style&index=0&id=5448387c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5448387c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"Credits\")]),_c('p',[_vm._v(\"All assets used are IP of Team Salvato and created by them, unless noted otherwise.\")]),_vm._m(0),_vm._m(1),_vm._m(2),_vm._m(3),_vm._m(4),_vm._m(5),_c('p',[_vm._v(\"Classic Amy Sprite by Meddy-sin\")]),_c('p',[_vm._v(\"Amy Sprite by Meddy-sin and SlightlySimple\")]),_c('p',[_vm._v(\"Special thanks to SlightlySimple for testing and technical help and Atlas421 for testing\")])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tUnused House Background by\\n\\t\\t\"),_c('a',{attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161\"}},[_vm._v(\"Fatelogic\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tDoki Doki Dialog Generator developed by EDave64\\n\\t\\t\"),_c('br'),_vm._v(\"Based on gemdude46's DDLC Shitpost generator\\n\\t\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tMC Classic Sprite by Childish-N\\n\\t\\t\"),_c('br'),_vm._v(\"MC Classic Chibi by GyleToTheRescue\\n\\t\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tMC Sprite by Childish-N\\n\\t\\t\"),_c('br'),_vm._v(\"MC Casual Sprite by SlightlySimple\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chibi by SlightlySimple\\n\\t\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tMC Chad Sprite by Cylent-Nite\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chad Poses and expressions by SlightlySimple\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chad Poses and chibi by Meddy-sin\\n\\t\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\"\\n\\t\\tFeMC Sprite by Meddy-sin\\n\\t\\t\"),_c('br'),_vm._v(\"FeMC Casual Sprite by SlightlySimple\\n\\t\")])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class AddPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./credits.vue?vue&type=template&id=8f65fc3e&scoped=true&\"\nimport script from \"./credits.vue?vue&type=script&lang=ts&\"\nexport * from \"./credits.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./credits.vue?vue&type=style&index=0&id=8f65fc3e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8f65fc3e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"Background\")]),_c('background-settings',{attrs:{\"value\":_vm.value,\"nsfw\":_vm.nsfw},on:{\"invalidate-render\":function($event){return _vm.$emit('invalidate-render')}}}),_vm._l((_vm.backgrounds),function(background){return _c('background-button',{key:background.name,attrs:{\"background\":background,\"value\":_vm.value,\"customPathLookup\":_vm.customPathLookup},on:{\"input\":function($event){_vm.nsfwFilter(background);_vm.$emit('input', background)}}})}),_c('div',{staticClass:\"btn upload-background\",on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\"\\n\\t\\tUpload\\n\\t\\t\"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileUpload}})])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{background: true, active: _vm.background === _vm.value},style:(_vm.style),attrs:{\"title\":_vm.background.name},on:{\"click\":function($event){return _vm.$emit('input', _vm.background)}}},[_vm._v(_vm._s(_vm.background.name))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { IBackground, color, Background } from '../../../models/background';\r\nimport { VariantBackground } from '../../../models/variant-background';\r\nimport { isWebPSupported, getAsset } from '../../../asset-manager';\r\nimport environment from '../../../environments/environment';\r\nimport { ErrorAsset } from '../../../models/error-asset';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class BackgroundButton extends Vue {\r\n\t@Prop({ required: true }) private readonly background!: IBackground;\r\n\t@Prop({ required: true }) private readonly value!: IBackground;\r\n\t@Prop({ required: true }) private readonly customPathLookup!: {\r\n\t\t[name: string]: string;\r\n\t};\r\n\r\n\tprivate lookup: HTMLImageElement | ErrorAsset | null = null;\r\n\tprivate loaded = false;\r\n\r\n\tprivate async created() {\r\n\t\tif (\r\n\t\t\tthis.background instanceof Background ||\r\n\t\t\tthis.background instanceof VariantBackground\r\n\t\t) {\r\n\t\t\tthis.lookup = await getAsset(this.background.path, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get style(): { [id: string]: string } {\r\n\t\tconst lq = environment.allowLQ ? '.lq' : '';\r\n\t\tif (this.background === color) {\r\n\t\t\treturn { backgroundColor: color.color };\r\n\t\t}\r\n\t\tif (this.lookup instanceof HTMLImageElement) {\r\n\t\t\treturn {\r\n\t\t\t\tbackgroundImage: `url(${this.lookup.src})`,\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {};\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./button.vue?vue&type=template&id=158ae924&scoped=true&\"\nimport script from \"./button.vue?vue&type=script&lang=ts&\"\nexport * from \"./button.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./button.vue?vue&type=style&index=0&id=158ae924&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"158ae924\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.value === _vm.colorBackground)?_c('fieldset',[_c('legend',[_vm._v(\"Settings:\")]),_c('label',{attrs:{\"for\":\"bg_color\"}},[_vm._v(\"Color:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.value.color),expression:\"value.color\"}],attrs:{\"id\":\"bg_color\",\"type\":\"color\"},domProps:{\"value\":(_vm.value.color)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.value, \"color\", $event.target.value)},function($event){return _vm.$emit('invalidate-render')}]}})]):_c('fieldset',[_c('legend',[_vm._v(\"Settings:\")]),_c('table',[_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('toggle',{attrs:{\"label\":\"Flipped?\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')}},model:{value:(_vm.value.flip),callback:function ($$v) {_vm.$set(_vm.value, \"flip\", $$v)},expression:\"value.flip\"}})],1)]),(_vm.isVariant)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){_vm.value.seekVariant(-1, _vm.nsfw);_vm.$emit('invalidate-render')}}},[_vm._v(\"<\")])]),_c('td',[_vm._v(\"Variant\")]),_c('td',[_c('button',{on:{\"click\":function($event){_vm.value.seekVariant(1, _vm.nsfw);_vm.$emit('invalidate-render')}}},[_vm._v(\">\")])])]):_vm._e(),(_vm.scaleable)?[_vm._m(0),_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.value.scale),expression:\"value.scale\"}],attrs:{\"id\":\"bgScaling\"},on:{\"input\":function($event){return _vm.$emit('invalidate-render')},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.$set(_vm.value, \"scale\", $event.target.multiple ? $$selectedVal : $$selectedVal[0])}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"None\")]),_c('option',{attrs:{\"value\":\"stretch\"}},[_vm._v(\"Stretch\")]),_c('option',{attrs:{\"value\":\"cover\"}},[_vm._v(\"Cover\")])])])])]:_vm._e(),(_vm.installable)?_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('button',{on:{\"click\":_vm.install}},[_vm._v(\"Install\")])])]):_vm._e(),(_vm.uninstallable)?_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('button',{on:{\"click\":_vm.uninstall}},[_vm._v(\"Uninstall\")])])]):_vm._e()],2)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('label',{attrs:{\"for\":\"bgScaling\"}},[_vm._v(\"Scale:\")])])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { IBackground, color, Background } from '../../../models/background';\r\nimport { VariantBackground } from '../../../models/variant-background';\r\nimport { isWebPSupported } from '../../../asset-manager';\r\nimport Toggle from '../../Toggle.vue';\r\nimport environment from '../../../environments/environment';\r\n\r\n@Component({\r\n\tcomponents: { Toggle },\r\n})\r\nexport default class BackgroundSettings extends Vue {\r\n\t@Prop({ required: true }) private readonly value!: IBackground;\r\n\t@Prop({ required: true, type: Boolean }) private readonly nsfw!: boolean;\r\n\r\n\tprivate get isVariant() {\r\n\t\treturn (\r\n\t\t\tthis.value instanceof VariantBackground &&\r\n\t\t\tthis.value.hasVariants(this.nsfw)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get colorBackground() {\r\n\t\treturn color;\r\n\t}\r\n\r\n\tprivate get installable(): boolean {\r\n\t\tif (!(this.value instanceof Background)) return false;\r\n\t\tif (!this.value.custom) return false;\r\n\t\tif (this.value.installed) return false;\r\n\t\treturn environment.isBackgroundInstallingSupported;\r\n\t}\r\n\r\n\tprivate get uninstallable(): boolean {\r\n\t\tif (!(this.value instanceof Background)) return false;\r\n\t\tif (!this.value.custom) return false;\r\n\t\tif (!this.value.installed) return false;\r\n\t\treturn environment.isBackgroundInstallingSupported;\r\n\t}\r\n\r\n\tprivate get scaleable(): boolean {\r\n\t\tif (!(this.value instanceof Background)) return false;\r\n\t\treturn this.value.custom;\r\n\t}\r\n\r\n\tprivate install() {\r\n\t\tenvironment.installBackground(this.value as Background);\r\n\t}\r\n\r\n\tprivate uninstall() {\r\n\t\tenvironment.uninstallBackground(this.value as Background);\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./settings.vue?vue&type=template&id=4faf2618&scoped=true&\"\nimport script from \"./settings.vue?vue&type=script&lang=ts&\"\nexport * from \"./settings.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./settings.vue?vue&type=style&index=0&id=4faf2618&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4faf2618\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { backgrounds, registerAsset, getAsset } from '../../asset-manager';\r\nimport {\r\n\tBackground,\r\n\tIBackground,\r\n\tcolor,\r\n\tnsfwFilter,\r\n} from '../../models/background';\r\nimport { VariantBackground } from '../../models/variant-background';\r\nimport BackgroundButton from './background/button.vue';\r\nimport BackgroundSettings from './background/settings.vue';\r\nimport { PanelMixin } from './panelMixin';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tBackgroundButton,\r\n\t\tBackgroundSettings,\r\n\t},\r\n})\r\nexport default class BackgroundsPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\t@Prop({ required: true }) private readonly value!: IBackground;\r\n\t@Prop({ required: true, type: Boolean }) private readonly nsfw!: boolean;\r\n\r\n\tprivate customPathLookup: { [name: string]: string } = {};\r\n\tprivate customBGCount = 0;\r\n\r\n\tprivate get backgrounds(): IBackground[] {\r\n\t\t// tslint:disable-next-line: no-unused-expression\r\n\t\tthis.customBGCount;\r\n\t\treturn this.nsfw ? backgrounds : backgrounds.filter(bg => !bg.nsfw);\r\n\t}\r\n\r\n\tprivate onFileUpload(e: Event) {\r\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\r\n\t\tif (!uploadInput.files) return;\r\n\t\tfor (const file of uploadInput.files) {\r\n\t\t\t(nr => {\r\n\t\t\t\tconst name = 'customBg' + nr;\r\n\t\t\t\tconst url = registerAsset(name, file);\r\n\t\t\t\tbackgrounds.push(new Background(name, file.name, false, true));\r\n\t\t\t\tthis.$set(this.customPathLookup, name, url);\r\n\t\t\t})(++this.customBGCount);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate nsfwFilter(background: IBackground) {\r\n\t\tif (!this.nsfw) {\r\n\t\t\tnsfwFilter(background);\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./backgrounds.vue?vue&type=template&id=26162fae&scoped=true&\"\nimport script from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nexport * from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./backgrounds.vue?vue&type=style&index=0&id=26162fae&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26162fae\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ panel: true, vertical: _vm.vertical }},[_c('h1',[_vm._v(\"Content Packs\")]),_c('button',{on:{\"click\":_vm.addNew}},[_vm._v(\"Add new Pack\")]),_c('fieldset',[_c('legend',[_vm._v(\"Installed Packs:\")]),_c('div',{staticClass:\"list\"},_vm._l((_vm.packs),function(pack){return _c('div',{key:pack.name,class:{ active: pack.name === _vm.name },on:{\"click\":function($event){return _vm.select(pack.name)}}},[_vm._v(_vm._s(pack.name))])}),0)]),_c('label',{attrs:{\"for\":\"pack_name\"}},[_vm._v(\"Name:\")]),_c('input',{attrs:{\"id\":\"pack_name\",\"readonly\":\"\"},domProps:{\"value\":_vm.name}}),_c('label',{attrs:{\"for\":\"pack_credits\"}},[_vm._v(\"Credits:\")]),_c('div',{attrs:{\"id\":\"pack_credits\"},domProps:{\"innerHTML\":_vm._s(_vm.credits)}}),(_vm.activatable)?_c('button',{on:{\"click\":_vm.activate}},[_vm._v(\"Activate\")]):_vm._e(),(_vm.deactivatable)?_c('button',{on:{\"click\":_vm.deactivate}},[_vm._v(\"Deactivate\")]):_vm._e(),(_vm.installable)?_c('button',{on:{\"click\":_vm.install}},[_vm._v(\"Install\")]):_vm._e(),(_vm.uninstallable)?_c('button',{on:{\"click\":_vm.uninstall}},[_vm._v(\"Uninstall\")]):_vm._e(),(_vm.needRestart)?_c('div',[_vm._v(\"\\n\\t\\tThe tool need restart for changes to take effect.\\n\\t\\t\"),_c('button',{on:{\"click\":_vm.restart}},[_vm._v(\"Restart Now\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const allowedTags = [\r\n\t'h3',\r\n\t'h4',\r\n\t'h5',\r\n\t'h6',\r\n\t'blockquote',\r\n\t'p',\r\n\t'a',\r\n\t'ul',\r\n\t'ol',\r\n\t'nl',\r\n\t'li',\r\n\t'b',\r\n\t'i',\r\n\t'strong',\r\n\t'em',\r\n\t'strike',\r\n\t'code',\r\n\t'hr',\r\n\t'br',\r\n\t'div',\r\n\t'table',\r\n\t'thead',\r\n\t'caption',\r\n\t'tbody',\r\n\t'tr',\r\n\t'th',\r\n\t'td',\r\n\t'pre',\r\n];\r\nconst allowedAttributes: { [tagName: string]: string[] | undefined } = {\r\n\ta: ['href'],\r\n\timg: ['src'],\r\n};\r\nconst schemaLimitedAttributes = ['href', 'src'];\r\nconst allowedSchemas = ['http', 'https'];\r\nconst enforceAttributes: {\r\n\t[tagName: string]: { [attr: string]: string } | undefined;\r\n} = {\r\n\ta: {\r\n\t\ttarget: '_blank',\r\n\t\trel: 'noopener noreferrer',\r\n\t},\r\n};\r\n\r\nexport function sanitize(html: string) {\r\n\tconst retDoc = document.createElement('div');\r\n\tconst doc = document.createElement('div');\r\n\tdoc.innerHTML = html;\r\n\r\n\tfor (const node of Array.from(doc.childNodes)) {\r\n\t\tfor (const sanitizedNode of sanitizeElement(node as Element)) {\r\n\t\t\tretDoc.appendChild(sanitizedNode);\r\n\t\t}\r\n\t}\r\n\r\n\treturn retDoc.innerHTML;\r\n}\r\n\r\nconst protocolMatcher = /^(\\w+):/;\r\n\r\nfunction sanitizeElement(node: Node): Node[] {\r\n\tif (node.nodeType !== Node.ELEMENT_NODE) return [node];\r\n\tconst el = node as Element;\r\n\tlet ret: Node[] = [];\r\n\tconst tagName = el.tagName.toLowerCase();\r\n\tif (allowedTags.includes(tagName)) {\r\n\t\tret.push(el);\r\n\t\tconst attrs: Attr[] = Array.prototype.slice.call(el.attributes);\r\n\t\tconst allowedAttrs = allowedAttributes[tagName] || [];\r\n\t\tfor (const attr of attrs) {\r\n\t\t\tif (!allowedAttrs.includes(attr.name)) {\r\n\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t} else if (schemaLimitedAttributes.includes(attr.name)) {\r\n\t\t\t\tconst protocolMatch = attr.value.match(protocolMatcher);\r\n\t\t\t\tif (protocolMatch && !allowedSchemas.includes(protocolMatch[1])) {\r\n\t\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst enforce = enforceAttributes[tagName];\r\n\t\tif (enforce) {\r\n\t\t\tfor (const attrName in enforce) {\r\n\t\t\t\tif (!enforce.hasOwnProperty(attrName)) continue;\r\n\t\t\t\tel.setAttribute(attrName, enforce[attrName]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tret.push(document.createTextNode(`<${tagName}>`));\r\n\t\tfor (const subNode of el.childNodes) {\r\n\t\t\tret = ret.concat(sanitizeElement(subNode));\r\n\t\t}\r\n\t\tret.push(document.createTextNode(`</${tagName}>`));\r\n\t}\r\n\treturn ret;\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { PanelMixin } from './panelMixin';\r\nimport environment from '../../environments/environment';\r\nimport { IJSONCharacter, JSONHeads } from '../../models/json-config';\r\nimport { loadCharacterPack } from '../../asset-manager';\r\nimport { sanitize } from './character-pack-sanitizer';\r\n\r\ninterface IPack {\r\n\tname: string;\r\n\tcredits: string;\r\n\tinstalled: boolean;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n\tfreshInstall: boolean;\r\n\turl: string;\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class CharacterPackPanel extends Mixins(PanelMixin) {\r\n\t@Prop({ required: true, type: Boolean }) private readonly vertical!: boolean;\r\n\r\n\tprivate selectedPack: IPack | null = null;\r\n\tprivate temporaryPacks: IPack[] = [];\r\n\tprivate installedPacks: IPack[] = [];\r\n\tprivate needRestart = false;\r\n\r\n\tprivate created() {\r\n\t\tconst packs = environment.installedCharacterPacks;\r\n\t\tconsole.log('packs:', packs);\r\n\t\tfor (const pack of packs) {\r\n\t\t\tthis.installedPacks.push({\r\n\t\t\t\tname: pack.id,\r\n\t\t\t\tcredits: pack.credits,\r\n\t\t\t\turl: pack.url,\r\n\t\t\t\tinstalled: true,\r\n\t\t\t\tqueuedUninstall: pack.queuedUninstall,\r\n\t\t\t\tactive: pack.active,\r\n\t\t\t\tfreshInstall: false,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get packs(): IPack[] {\r\n\t\treturn [...this.temporaryPacks, ...this.installedPacks];\r\n\t}\r\n\r\n\tprivate select(name: string) {\r\n\t\tthis.selectedPack = this.packs.find(pack => pack.name === name) || null;\r\n\t}\r\n\r\n\tprivate async addNew() {\r\n\t\tconst url = await environment.prompt(\r\n\t\t\t'Enter the URL of the character pack:'\r\n\t\t);\r\n\t\tif (!url) return;\r\n\t\tconst json = await loadCharacterPack(url);\r\n\t\tif (!json) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.temporaryPacks.push({\r\n\t\t\tname: json.packId,\r\n\t\t\tcredits: json.packCredits,\r\n\t\t\tinstalled: false,\r\n\t\t\tqueuedUninstall: false,\r\n\t\t\tactive: true,\r\n\t\t\turl,\r\n\t\t\tfreshInstall: true,\r\n\t\t});\r\n\t\tthis.$emit('change');\r\n\t}\r\n\r\n\tprivate restart() {\r\n\t\tlocation.reload(true);\r\n\t}\r\n\r\n\tprivate get name(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn this.selectedPack.name;\r\n\t}\r\n\tprivate get credits(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn sanitize(this.selectedPack.credits || '');\r\n\t}\r\n\tprivate get activatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !this.selectedPack.active;\r\n\t}\r\n\tprivate get deactivatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn this.selectedPack.active;\r\n\t}\r\n\tprivate get installable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\treturn this.selectedPack.queuedUninstall || !this.selectedPack.installed;\r\n\t}\r\n\tprivate get uninstallable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !(this.selectedPack.queuedUninstall || !this.selectedPack.installed);\r\n\t}\r\n\r\n\tprivate install(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.installContentPack(this.selectedPack.url);\r\n\t\tif (this.selectedPack.queuedUninstall) {\r\n\t\t\tthis.selectedPack.queuedUninstall = false;\r\n\t\t} else {\r\n\t\t\tthis.selectedPack.installed = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate uninstall(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.uninstallContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.queuedUninstall = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate activate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.activateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate deactivate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.deactivateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = false;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character-pack.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character-pack.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./character-pack.vue?vue&type=template&id=749bf0f8&scoped=true&\"\nimport script from \"./character-pack.vue?vue&type=script&lang=ts&\"\nexport * from \"./character-pack.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./character-pack.vue?vue&type=style&index=0&id=749bf0f8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"749bf0f8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"messageConsole\"},[(_vm.showLoading)?_c('p',[_vm._v(\"Loading...\")]):_vm._e(),_vm._l((_vm.messages),function(message,i){return _c('p',{key:message + '_' + i},[_vm._v(_vm._s(message))])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport EventBus, {\r\n\tAssetFailureEvent,\r\n\tCustomAssetFailureEvent,\r\n\tShowMessageEvent,\r\n} from '../event-bus';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class MessageConsole extends Vue {\r\n\t@Prop({ required: true, type: Boolean }) private readonly loading!: boolean;\r\n\r\n\tprivate messages: string[] = [];\r\n\tprivate showLoading: boolean = false;\r\n\tprivate showLoadingTimeout: number = 0;\r\n\tprivate hideLoadingTimeout: number = 0;\r\n\r\n\tprivate created() {\r\n\t\tthis.onLoadingChange(this.loading);\r\n\t\tEventBus.subscribe(AssetFailureEvent, ev => {\r\n\t\t\tthis.messages.push(`Failed to load asset '${ev.path}'`);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.messages.pop();\r\n\t\t\t}, 5000);\r\n\t\t});\r\n\r\n\t\tEventBus.subscribe(CustomAssetFailureEvent, ev => {\r\n\t\t\tthis.messages.push(\r\n\t\t\t\t'Failed to load custom asset. Try to download it manually and then upload it.'\r\n\t\t\t);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.messages.pop();\r\n\t\t\t}, 50000);\r\n\t\t});\r\n\r\n\t\tEventBus.subscribe(ShowMessageEvent, ev => {\r\n\t\t\tthis.messages.push(ev.message);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.messages.pop();\r\n\t\t\t}, 50000);\r\n\t\t});\r\n\t}\r\n\r\n\t@Watch('loading')\r\n\tprivate onLoadingChange(newValue: boolean) {\r\n\t\tconsole.log('onLoadingChange', newValue);\r\n\t\tif (newValue) {\r\n\t\t\tif (this.hideLoadingTimeout) {\r\n\t\t\t\tclearTimeout(this.hideLoadingTimeout);\r\n\t\t\t\tthis.hideLoadingTimeout = 0;\r\n\t\t\t}\r\n\t\t\tif (!this.showLoading && !this.showLoadingTimeout) {\r\n\t\t\t\tconsole.log('setting show Timeout');\r\n\t\t\t\tthis.showLoadingTimeout = setTimeout(() => {\r\n\t\t\t\t\tthis.showLoading = true;\r\n\t\t\t\t\tconsole.log('showingLoading');\r\n\t\t\t\t\tthis.showLoadingTimeout = 0;\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this.showLoadingTimeout) {\r\n\t\t\t\tclearTimeout(this.showLoadingTimeout);\r\n\t\t\t\tthis.showLoadingTimeout = 0;\r\n\t\t\t}\r\n\t\t\tif (this.showLoading && !this.hideLoadingTimeout) {\r\n\t\t\t\tconsole.log('setting hide Timeout');\r\n\t\t\t\tthis.hideLoadingTimeout = setTimeout(() => {\r\n\t\t\t\t\tthis.showLoading = false;\r\n\t\t\t\t\tconsole.log('hideLoading');\r\n\t\t\t\t\tthis.hideLoadingTimeout = 0;\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./message-console.vue?vue&type=template&id=ca90e228&scoped=true&\"\nimport script from \"./message-console.vue?vue&type=script&lang=ts&\"\nexport * from \"./message-console.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./message-console.vue?vue&type=style&index=0&id=ca90e228&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ca90e228\",\n  null\n  \n)\n\nexport default component.exports","import { RenderContext } from '../renderer/rendererContext';\r\nimport { getAsset } from '../asset-manager';\r\n\r\nconst ScreenWidth = 1280;\r\n\r\nconst TextBoxWidth = 816;\r\nconst TextBoxCorruptedWidth = 900;\r\nconst TextBoxY = 568;\r\nconst TextBoxKerning = 0;\r\nconst TextBoxLineHeight = 29;\r\nconst TextBoxCorruptedKerning = 8;\r\nconst TextBoxTextXOffset = 38;\r\nconst TextBoxTextYOffset = 50;\r\n\r\nconst TextBoxTextCorruptedXOffset = 9;\r\nconst TextBoxTextCorruptedYOffset = 9;\r\n\r\nconst NameboxHeight = 39;\r\nconst NameboxWidth = 168;\r\nconst NameboxXOffset = 34;\r\nconst NameboxTextYOffset = 29;\r\n\r\nconst ControlsYOffset = 134;\r\nconst ControlsXHistoryOffset = 282;\r\nconst ControlsXSkipOffset = 336;\r\nconst ControlsXStuffOffset = 370;\r\n\r\nconst ArrowX = 1017.25;\r\nconst ArrowY = 688;\r\n\r\nconst NameboxTextStyle = {\r\n\talign: 'center' as CanvasTextAlign,\r\n\tfont: '24px riffic',\r\n\toutline: {\r\n\t\tstyle: '#b59',\r\n\t\twidth: 6,\r\n\t},\r\n\tfill: {\r\n\t\tstyle: 'white',\r\n\t},\r\n};\r\n\r\nconst ControlsTextStyle = {\r\n\talign: 'left' as CanvasTextAlign,\r\n\tfont: '13px aller',\r\n\tfill: {\r\n\t\tstyle: '#522',\r\n\t},\r\n};\r\n\r\nconst ControlsTextDisabledStyle = {\r\n\t...ControlsTextStyle,\r\n\tfill: {\r\n\t\tstyle: '#a66',\r\n\t},\r\n};\r\n\r\nconst TextBoxStyle = {\r\n\talign: 'left' as CanvasTextAlign,\r\n\tfont: '24px aller',\r\n\toutline: {\r\n\t\tstyle: '#523140',\r\n\t\twidth: 4,\r\n\t},\r\n\tfill: {\r\n\t\tstyle: '#fff',\r\n\t},\r\n};\r\n\r\nconst TextBoxCorruptedStyle = {\r\n\talign: 'left' as CanvasTextAlign,\r\n\tfont: '24px verily',\r\n\toutline: {\r\n\t\tstyle: '#000',\r\n\t\twidth: 20,\r\n\t},\r\n\tfill: {\r\n\t\tstyle: '#fff',\r\n\t},\r\n};\r\n\r\nconst TextBoxX = ScreenWidth / 2 - TextBoxWidth / 2; // 232\r\nconst TextBoxCorruptedX = ScreenWidth / 2 - TextBoxCorruptedWidth / 2;\r\nconst TextBoxTextX = TextBoxX + TextBoxTextXOffset;\r\nconst TextBoxTextY = TextBoxY + TextBoxTextYOffset;\r\n\r\nconst NameboxY = TextBoxY - NameboxHeight;\r\nconst NameboxX = TextBoxX + NameboxXOffset;\r\nconst NameboxTextX = NameboxX + NameboxWidth / 2;\r\nconst NameboxTextY = NameboxY + NameboxTextYOffset;\r\n\r\nconst ControlsY = TextBoxY + ControlsYOffset;\r\nconst ControlsXHistory = TextBoxX + ControlsXHistoryOffset;\r\nconst ControlsXSkip = TextBoxX + ControlsXSkipOffset;\r\nconst ControlsXStuff = TextBoxX + ControlsXStuffOffset;\r\n\r\nexport class Textbox {\r\n\tpublic display: boolean = true;\r\n\tpublic corrupted: boolean = false;\r\n\tpublic showControls: boolean = true;\r\n\tpublic allowSkipping: boolean = true;\r\n\tpublic showContinueArrow: boolean = true;\r\n\tpublic autoQuote: boolean = true;\r\n\tpublic talking: string = '';\r\n\tpublic customName: string = '';\r\n\tpublic dialog: string = '';\r\n\r\n\tpublic async render(rx: RenderContext) {\r\n\t\tif (!this.display) return;\r\n\r\n\t\tif (this.corrupted) {\r\n\t\t\trx.drawImage({\r\n\t\t\t\timage: await getAsset('textbox_monika'),\r\n\t\t\t\tx: TextBoxCorruptedX,\r\n\t\t\t\ty: TextBoxY,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\trx.drawImage({\r\n\t\t\t\timage: await getAsset('textbox'),\r\n\t\t\t\tx: TextBoxX,\r\n\t\t\t\ty: TextBoxY,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst name = this.talking;\r\n\t\tif (name) {\r\n\t\t\trx.drawImage({\r\n\t\t\t\timage: await getAsset('namebox'),\r\n\t\t\t\tx: NameboxX,\r\n\t\t\t\ty: NameboxY,\r\n\t\t\t});\r\n\t\t\trx.drawText({\r\n\t\t\t\tx: NameboxTextX,\r\n\t\t\t\ty: NameboxTextY,\r\n\t\t\t\ttext: name === 'other' ? this.customName : name,\r\n\t\t\t\t...NameboxTextStyle,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.renderText(rx);\r\n\r\n\t\tif (this.showControls) {\r\n\t\t\trx.drawText({\r\n\t\t\t\ttext: 'History',\r\n\t\t\t\tx: ControlsXHistory,\r\n\t\t\t\ty: ControlsY,\r\n\t\t\t\t...ControlsTextStyle,\r\n\t\t\t});\r\n\t\t\trx.drawText({\r\n\t\t\t\ttext: 'Skip',\r\n\t\t\t\tx: ControlsXSkip,\r\n\t\t\t\ty: ControlsY,\r\n\t\t\t\t...(this.allowSkipping ? ControlsTextStyle : ControlsTextDisabledStyle),\r\n\t\t\t});\r\n\t\t\trx.drawText({\r\n\t\t\t\ttext: 'Auto   Save   Load   Settings',\r\n\t\t\t\tx: ControlsXStuff,\r\n\t\t\t\ty: ControlsY,\r\n\t\t\t\t...ControlsTextStyle,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.showContinueArrow) {\r\n\t\t\trx.drawImage({ image: await getAsset('next'), x: ArrowX, y: ArrowY });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderText(rx: RenderContext): void {\r\n\t\tconst text: DialogLetter[][] = [];\r\n\r\n\t\tlet b = false;\r\n\r\n\t\tlet dialog = this.dialog;\r\n\r\n\t\tif (this.autoQuote && this.talking) {\r\n\t\t\tdialog = `\"${dialog}\"`;\r\n\t\t}\r\n\r\n\t\tfor (const line of dialog.split('\\n')) {\r\n\t\t\tlet cl;\r\n\t\t\ttext.push((cl = []));\r\n\t\t\tfor (const l of line) {\r\n\t\t\t\tif (l === '[') {\r\n\t\t\t\t\tb = true;\r\n\t\t\t\t} else if (l === ']') {\r\n\t\t\t\t\tb = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcl.push({ l, b });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet y = TextBoxTextY;\r\n\r\n\t\tif (text[0] && text[0][0] && text[0][0].b) {\r\n\t\t\ty += TextBoxTextCorruptedYOffset;\r\n\t\t}\r\n\r\n\t\tfor (const line of text) {\r\n\t\t\tlet x = TextBoxTextX;\r\n\r\n\t\t\tif (line[0] && line[0].b) {\r\n\t\t\t\tx += TextBoxTextCorruptedXOffset;\r\n\t\t\t}\r\n\t\t\tfor (const letter of line) {\r\n\t\t\t\tconst ct = letter.l;\r\n\t\t\t\tconst cb = letter.b;\r\n\r\n\t\t\t\trx.drawText({\r\n\t\t\t\t\ttext: ct,\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty,\r\n\t\t\t\t\t...(cb ? TextBoxCorruptedStyle : TextBoxStyle),\r\n\t\t\t\t});\r\n\t\t\t\tx += rx.measureText({\r\n\t\t\t\t\ttext: ct,\r\n\t\t\t\t\t...(cb ? TextBoxCorruptedStyle : TextBoxStyle),\r\n\t\t\t\t}).width;\r\n\t\t\t\tx += cb ? TextBoxCorruptedKerning : TextBoxKerning;\r\n\t\t\t}\r\n\t\t\ty += TextBoxLineHeight;\r\n\t\t}\r\n\t}\r\n}\r\n\r\ninterface DialogLetter {\r\n\tl: string;\r\n\tb: boolean;\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n// App.vue has currently so many responsiblities that it's best to break it into chunks\r\n// tslint:disable:member-ordering\r\nimport { Component, Vue, Watch } from 'vue-property-decorator';\r\nimport DokiButton from './components/DokiButton.vue';\r\nimport GeneralPanel from './components/panels/general.vue';\r\nimport AddPanel from './components/panels/add.vue';\r\nimport CharacterPanel, { MoveObject } from './components/panels/character.vue';\r\nimport SpritePanel from './components/panels/sprite.vue';\r\nimport CreditsPanel from './components/panels/credits.vue';\r\nimport BackgroundsPanel from './components/panels/backgrounds.vue';\r\nimport CharacterPack from './components/panels/character-pack.vue';\r\nimport MessageConsole from './components/message-console.vue';\r\nimport { characterPositions } from './models/constants';\r\nimport { Textbox } from './models/textbox';\r\nimport { Character, CharacterIds } from './models/character';\r\nimport { backgrounds, getAsset, registerAsset } from './asset-manager';\r\nimport { Renderer } from './renderer/renderer';\r\nimport { RenderContext } from './renderer/rendererContext';\r\nimport { Background, IBackground, nsfwFilter } from './models/background';\r\nimport { IRenderable } from './models/renderable';\r\nimport { Sprite } from './models/sprite';\r\nimport { IDragable } from './models/dragable';\r\nimport { VariantBackground } from './models/variant-background';\r\nimport environment from './environments/environment';\r\nimport leftPad from 'left-pad';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tDokiButton,\r\n\t\tGeneralPanel,\r\n\t\tAddPanel,\r\n\t\tBackgroundsPanel,\r\n\t\tCreditsPanel,\r\n\t\tCharacterPanel,\r\n\t\tSpritePanel,\r\n\t\tMessageConsole,\r\n\t\tCharacterPack,\r\n\t},\r\n})\r\nexport default class App extends Vue {\r\n\tpublic canvasWidth: number = 0;\r\n\tpublic canvasHeight: number = 0;\r\n\tpublic currentBackground: IBackground | null = null;\r\n\r\n\tprivate sdCtx: CanvasRenderingContext2D | undefined;\r\n\tprivate characters: IRenderable[] = [];\r\n\tprivate selectedCharacter: Character | null = null;\r\n\tprivate selectedSprite: Sprite | null = null;\r\n\r\n\tprivate characterVersion: number = 0;\r\n\r\n\tprivate vertical: boolean = false;\r\n\tprivate nsfw: boolean = false;\r\n\tprivate textbox = new Textbox();\r\n\r\n\tprivate renderer: Renderer = new Renderer();\r\n\tprivate showUI: boolean = true;\r\n\tprivate loaded: boolean = false;\r\n\tprivate uiSize: number = 192;\r\n\tprivate lqRendering: boolean = environment.allowLQ;\r\n\tprivate currentlyRendering: boolean = false;\r\n\r\n\tprivate panel: string = '';\r\n\r\n\tprivate queuedRender: number | null = null;\r\n\tprivate prevRender: string = '';\r\n\tprivate showingLast: boolean = false;\r\n\r\n\tprivate dropSpriteCount = 0;\r\n\tprivate dropPreventClick = false;\r\n\r\n\t@Watch('selectedCharacter')\r\n\tpublic onSelectedCharacterChange(\r\n\t\tnewCharacter: Character,\r\n\t\toldCharacter: Character\r\n\t) {\r\n\t\tif (oldCharacter) oldCharacter.unselect();\r\n\t\tif (newCharacter) {\r\n\t\t\tnewCharacter.select();\r\n\t\t\tthis.panel = 'character';\r\n\t\t}\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\t@Watch('selectedSprite')\r\n\tpublic onSelectedSpriteChange(newSprite: Sprite, oldSprite: Sprite) {\r\n\t\tif (oldSprite) oldSprite.unselect();\r\n\t\tif (newSprite) {\r\n\t\t\tnewSprite.select();\r\n\t\t\tthis.panel = 'sprite';\r\n\t\t}\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\t@Watch('panel')\r\n\tpublic onPanel(newPanel: string) {\r\n\t\tif (newPanel !== 'character') {\r\n\t\t\tthis.selectedCharacter = null;\r\n\t\t}\r\n\t}\r\n\r\n\t@Watch('textbox', { deep: true })\r\n\t@Watch('lqRendering')\r\n\t@Watch('currentBackground')\r\n\tpublic invalidateRender() {\r\n\t\tif (this.queuedRender) return;\r\n\t\tthis.queuedRender = requestAnimationFrame(() => this.render_());\r\n\t}\r\n\r\n\tpublic async render_(): Promise<void> {\r\n\t\tif (this.queuedRender) {\r\n\t\t\tcancelAnimationFrame(this.queuedRender);\r\n\t\t\tthis.queuedRender = null;\r\n\t\t}\r\n\r\n\t\tconst completed = await this.renderer.render(\r\n\t\t\tthis.renderCallback,\r\n\t\t\t!this.lqRendering\r\n\t\t);\r\n\t\tif (completed) {\r\n\t\t\tthis.display();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async renderCallback(rx: RenderContext): Promise<void> {\r\n\t\tthis.currentlyRendering = true;\r\n\t\ttry {\r\n\t\t\tif (!this.loaded) {\r\n\t\t\t\trx.drawText({\r\n\t\t\t\t\ttext: 'Starting...',\r\n\t\t\t\t\tx: this.renderer.width / 2,\r\n\t\t\t\t\ty: this.renderer.height / 2,\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\toutline: {\r\n\t\t\t\t\t\twidth: 5,\r\n\t\t\t\t\t\tstyle: '#b59',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfont: '32px riffic',\r\n\t\t\t\t\tfill: {\r\n\t\t\t\t\t\tstyle: 'white',\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif (rx.preview) {\r\n\t\t\t\t\trx.drawImage({\r\n\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\timage: await getAsset('backgrounds/transparent'),\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.currentBackground) {\r\n\t\t\t\t\tawait this.currentBackground.render(rx);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (const character of this.characters) {\r\n\t\t\t\t\tif (!character.infront) {\r\n\t\t\t\t\t\tawait character.render(rx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait this.textbox.render(rx);\r\n\r\n\t\t\t\tfor (const character of this.characters) {\r\n\t\t\t\t\tif (character.infront) {\r\n\t\t\t\t\t\tawait character.render(rx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tthis.currentlyRendering = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate created(): void {\r\n\t\t(window as any).cats = this;\r\n\r\n\t\t// Moving this to the \"mounted\"-handler crashes safari over version 12.\r\n\t\t// My best guess is because it runs in a microtask, which have been added in that Version.\r\n\t\tthis.updateArea();\r\n\t\twindow.addEventListener('resize', this.updateArea);\r\n\r\n\t\twindow.removeEventListener('keydown', this.onKeydown);\r\n\t\twindow.addEventListener('keydown', this.onKeydown);\r\n\r\n\t\tenvironment.onPanelChange((panel: string) => {\r\n\t\t\tthis.panel = panel;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate destroyed(): void {\r\n\t\twindow.removeEventListener('keydown', this.onKeydown);\r\n\t}\r\n\r\n\tprivate mounted(): void {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tthis.sdCtx = sd.getContext('2d') || undefined;\r\n\r\n\t\twindow.addEventListener('keypress', e => {\r\n\t\t\tif (e.keyCode === 27) {\r\n\t\t\t\tthis.selectedCharacter = null;\r\n\t\t\t\tthis.panel = '';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.currentBackground = backgrounds[0];\r\n\t\tthis.invalidateRender();\r\n\t\tPromise.all([\r\n\t\t\tgetAsset((this.currentBackground as VariantBackground).path, false),\r\n\t\t\tgetAsset('textbox'),\r\n\t\t\tgetAsset('namebox'),\r\n\t\t\tgetAsset('next'),\r\n\t\t\tgetAsset('backgrounds/transparent'),\r\n\t\t])\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.loaded = true;\r\n\t\t\t\tthis.invalidateRender();\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\talert('Error while loading. Sorry :/');\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate optimum(sw: number, sh: number): [number, number] {\r\n\t\tlet rh = sw / (16 / 9);\r\n\t\tlet rw = sh * (16 / 9);\r\n\r\n\t\tif (rh > sh) {\r\n\t\t\trh = sh;\r\n\t\t} else {\r\n\t\t\trw = sw;\r\n\t\t}\r\n\r\n\t\treturn [rw, rh];\r\n\t}\r\n\r\n\tprivate optimizeWithMenu(sw: number, sh: number): [number, number, boolean] {\r\n\t\tconst opth = this.optimum(sw, sh - this.uiSize);\r\n\t\tconst optv = this.optimum(sw - this.uiSize, sh);\r\n\r\n\t\tif (opth[0] * opth[1] > optv[0] * optv[1]) {\r\n\t\t\treturn [opth[0], opth[1], false];\r\n\t\t} else {\r\n\t\t\treturn [optv[0], optv[1], true];\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateArea(): void {\r\n\t\tconst [cw, ch, v] = this.optimizeWithMenu(\r\n\t\t\tdocument.documentElement.clientWidth,\r\n\t\t\tdocument.documentElement.clientHeight\r\n\t\t);\r\n\r\n\t\tthis.canvasWidth = cw;\r\n\t\tthis.canvasHeight = ch;\r\n\t\tthis.vertical = v;\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.display();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate display(): void {\r\n\t\tif (!this.sdCtx) return;\r\n\t\tthis.showingLast = false;\r\n\t\tthis.renderer.paintOnto(this.sdCtx, 0, 0, 1280, 720);\r\n\t}\r\n\r\n\tprivate async download() {\r\n\t\tif (this.prevRender && window.URL && window.URL.revokeObjectURL) {\r\n\t\t\tURL.revokeObjectURL(this.prevRender);\r\n\t\t}\r\n\t\tconst date = new Date();\r\n\t\tconst filename = `panel-${date.getFullYear()}-${leftPad(\r\n\t\t\tdate.getMonth(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getDate(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getHours(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getMinutes(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getSeconds(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}.png`;\r\n\t\tthis.prevRender = await this.renderer.download(\r\n\t\t\tthis.renderCallback,\r\n\t\t\tfilename\r\n\t\t);\r\n\t}\r\n\r\n\tprivate async showPreviousRender() {\r\n\t\tif (this.showingLast) {\r\n\t\t\tthis.display();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.showingLast = true;\r\n\t\tconst img = new Image();\r\n\t\timg.onload = () => {\r\n\t\t\tthis.sdCtx!.drawImage(img, 0, 0, 1280, 720);\r\n\t\t};\r\n\t\timg.src = this.prevRender;\r\n\t}\r\n\r\n\tprivate onCharacterCreate(character: CharacterIds): void {\r\n\t\tthis.characters.push(new Character(character, this.invalidateRender));\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\tprivate toRendererCoordinate(x: number, y: number): [number, number] {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tconst rx = x - sd.offsetLeft;\r\n\t\tconst ry = y - sd.offsetTop;\r\n\t\tconst sx = (rx / sd.offsetWidth) * sd.width;\r\n\t\tconst sy = (ry / sd.offsetWidth) * sd.width;\r\n\t\treturn [sx, sy];\r\n\t}\r\n\r\n\tprivate onUiClick(e: MouseEvent): void {\r\n\t\tif (this.dropPreventClick) {\r\n\t\t\tthis.dropPreventClick = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.panel = '';\r\n\r\n\t\tconst [sx, sy] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\r\n\t\tif (this.$refs.characters) (this.$refs.characters as any).reset();\r\n\r\n\t\tconst characters = this.objectsAt(sx, sy);\r\n\r\n\t\tconst currentCharacterIdx = characters.indexOf(\r\n\t\t\t(this.selectedCharacter || this.selectedSprite)!\r\n\t\t);\r\n\t\tlet selectedObject: IRenderable | null;\r\n\r\n\t\tif (currentCharacterIdx === 0) {\r\n\t\t\tselectedObject = null;\r\n\t\t} else if (currentCharacterIdx !== -1) {\r\n\t\t\t// Select the next lower character\r\n\t\t\tselectedObject = characters[currentCharacterIdx - 1];\r\n\t\t} else {\r\n\t\t\tselectedObject = characters[characters.length - 1] || null;\r\n\t\t}\r\n\r\n\t\tif (!selectedObject) {\r\n\t\t\tthis.selectedCharacter = null;\r\n\t\t\tthis.selectedSprite = null;\r\n\t\t} else if (selectedObject instanceof Sprite) {\r\n\t\t\tthis.selectedCharacter = null;\r\n\t\t\tthis.selectedSprite = selectedObject;\r\n\t\t} else if (selectedObject instanceof Character) {\r\n\t\t\tthis.selectedSprite = null;\r\n\t\t\tthis.selectedCharacter = selectedObject;\r\n\t\t} else {\r\n\t\t\tthrow new Error('Unknown selected object');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate objectsAt(x: number, y: number): IRenderable[] {\r\n\t\treturn this.characters.filter(character => character.hitTest(x, y));\r\n\t}\r\n\r\n\tprivate onObjectLayerShift(event: MoveObject): void {\r\n\t\tconst idx = this.characters.indexOf(event.object);\r\n\t\tlet targetIdx = idx;\r\n\t\tthis.characters.splice(idx, 1);\r\n\t\tswitch (event.move) {\r\n\t\t\tcase 'Forward':\r\n\t\t\t\ttargetIdx += 1;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Backward':\r\n\t\t\t\ttargetIdx -= 1;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Back':\r\n\t\t\t\ttargetIdx = 0;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Front':\r\n\t\t\t\ttargetIdx = this.characters.length;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Delete':\r\n\t\t\t\tthis.panel = '';\r\n\t\t\t\tthis.invalidateRender();\r\n\t\t\t\treturn;\r\n\t\t}\r\n\t\tif (targetIdx <= 0) {\r\n\t\t\tthis.characters.unshift(event.object);\r\n\t\t} else if (targetIdx >= this.characters.length) {\r\n\t\t\tthis.characters.push(event.object);\r\n\t\t} else {\r\n\t\t\tthis.characters.splice(targetIdx, 0, event.object);\r\n\t\t}\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\tprivate onAssetCreate(assetName: string) {\r\n\t\tthis.characters.push(new Sprite(assetName, this.invalidateRender));\r\n\t}\r\n\r\n\tprivate draggedObject: IDragable | null = null;\r\n\tprivate dragXOffset: number = 0;\r\n\tprivate dragYOffset: number = 0;\r\n\tprivate dragXOriginal: number = 0;\r\n\tprivate dragYOriginal: number = 0;\r\n\r\n\tprivate onDragStart(e: DragEvent) {\r\n\t\te.preventDefault();\r\n\t\tconst selected = this.selectedCharacter || this.selectedSprite;\r\n\t\tif (!selected) return;\r\n\t\tthis.draggedObject = selected;\r\n\t\tconst [x, y] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\t\tthis.dragXOffset = x - selected.x;\r\n\t\tthis.dragYOffset = y - selected.y;\r\n\t\tthis.dragXOriginal = selected.x;\r\n\t\tthis.dragYOriginal = selected.y;\r\n\t}\r\n\r\n\tprivate onTouchStart(e: TouchEvent) {\r\n\t\tconst selected = this.selectedCharacter || this.selectedSprite;\r\n\t\tif (!selected) return;\r\n\t\tthis.draggedObject = selected;\r\n\t\tconst [x, y] = this.toRendererCoordinate(\r\n\t\t\te.touches[0].clientX,\r\n\t\t\te.touches[0].clientY\r\n\t\t);\r\n\t\tthis.dragXOffset = x - selected.x;\r\n\t\tthis.dragYOffset = y - selected.y;\r\n\t\tthis.dragXOriginal = selected.x;\r\n\t\tthis.dragYOriginal = selected.y;\r\n\t}\r\n\r\n\tprivate onDragOver(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\te.dataTransfer!.dropEffect = 'copy';\r\n\t}\r\n\r\n\tprivate onSpriteDragMove(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// Formatter quirk\r\n\t\t\t// tslint:disable:indent\r\n\t\t\tlet [x, y] =\r\n\t\t\t\te instanceof MouseEvent\r\n\t\t\t\t\t? this.toRendererCoordinate(e.clientX, e.clientY)\r\n\t\t\t\t\t: this.toRendererCoordinate(\r\n\t\t\t\t\t\t\te.touches[0].clientX,\r\n\t\t\t\t\t\t\te.touches[0].clientY\r\n\t\t\t\t\t  );\r\n\t\t\t// tslint:enable:indent\r\n\t\t\tx -= this.dragXOffset;\r\n\t\t\ty -= this.dragYOffset;\r\n\r\n\t\t\tconst deltaX = Math.abs(x - this.dragXOriginal);\r\n\t\t\tconst deltaY = Math.abs(y - this.dragYOriginal);\r\n\r\n\t\t\tif (deltaX + deltaY > 1) this.dropPreventClick = true;\r\n\r\n\t\t\tif (e.shiftKey) {\r\n\t\t\t\tif (deltaX > deltaY) {\r\n\t\t\t\t\ty = this.dragYOriginal;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tx = this.dragXOriginal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.draggedObject.x = x;\r\n\t\t\tthis.draggedObject.y = y;\r\n\t\t\tthis.invalidateRender();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onDrop(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!e.dataTransfer) return;\r\n\r\n\t\tfor (const item of e.dataTransfer.items) {\r\n\t\t\tif (item.kind === 'file' && item.type.match(/image.*/)) {\r\n\t\t\t\tconst name = 'dropCustomAsset' + ++this.dropSpriteCount;\r\n\t\t\t\tconst url = registerAsset(name, item.getAsFile()!);\r\n\t\t\t\tthis.onAssetCreate(name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onSpriteDrop(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\tif ('TouchEvent' in window && e instanceof TouchEvent) {\r\n\t\t\t\tthis.dropPreventClick = false;\r\n\t\t\t}\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onMouseEnter(e: MouseEvent) {\r\n\t\tif (e.buttons !== 1) {\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onKeydown(e: KeyboardEvent) {\r\n\t\tconst target = this.selectedCharacter || this.selectedSprite;\r\n\t\tif (target && e.key === 'Delete') {\r\n\t\t\tthis.onObjectLayerShift({\r\n\t\t\t\tobject: target,\r\n\t\t\t\tmove: 'Delete',\r\n\t\t\t});\r\n\t\t} else if (target && e.key === 'ArrowLeft') {\r\n\t\t\tif (target instanceof Character && !target.allowFreeMove) {\r\n\t\t\t\ttarget.pos -= 1;\r\n\t\t\t} else {\r\n\t\t\t\ttarget.x = Math.floor(target.x - (e.shiftKey ? 1 : 20));\r\n\t\t\t}\r\n\t\t\tthis.invalidateRender();\r\n\t\t} else if (target && e.key === 'ArrowRight') {\r\n\t\t\tif (target instanceof Character && !target.allowFreeMove) {\r\n\t\t\t\ttarget.pos += 1;\r\n\t\t\t} else {\r\n\t\t\t\ttarget.x = Math.floor(target.x + (e.shiftKey ? 1 : 20));\r\n\t\t\t}\r\n\t\t\tthis.invalidateRender();\r\n\t\t} else if (target && e.key === 'ArrowUp') {\r\n\t\t\ttarget.y = Math.floor(target.y - (e.shiftKey ? 1 : 20));\r\n\t\t\tthis.invalidateRender();\r\n\t\t} else if (target && e.key === 'ArrowDown') {\r\n\t\t\ttarget.y = Math.floor(target.y + (e.shiftKey ? 1 : 20));\r\n\t\t\tthis.invalidateRender();\r\n\t\t} else {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t}\r\n\r\n\t@Watch('nsfw')\r\n\tprivate onNSFWChange(newNSFW: boolean): void {\r\n\t\tif (!this.currentBackground) return;\r\n\t\tif (newNSFW) return;\r\n\t\tif (this.currentBackground.nsfw) {\r\n\t\t\tthis.currentBackground = backgrounds[0];\r\n\t\t}\r\n\t\tnsfwFilter(this.currentBackground);\r\n\t\tfor (const character of this.characters) {\r\n\t\t\tif (character instanceof Character) {\r\n\t\t\t\tcharacter.nsfwCheck();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.invalidateRender();\r\n\t}\r\n}\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=7e19d71e&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\r\nimport App from './App.vue';\r\n// import './registerServiceWorker';\r\n\r\nVue.config.productionTip = false;\r\n\r\nnew Vue({\r\n\trender: h => h(App),\r\n}).$mount('#app');\r\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=158ae924&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=158ae924&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=26162fae&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=26162fae&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toggle.vue?vue&type=style&index=0&id=7e803566&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Toggle.vue?vue&type=style&index=0&id=7e803566&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=ca90e228&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=ca90e228&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=8370f658&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=8370f658&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=c63b9cc4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=c63b9cc4&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=5448387c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=5448387c&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=561345aa&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=561345aa&lang=scss&scoped=true&\""],"sourceRoot":""}