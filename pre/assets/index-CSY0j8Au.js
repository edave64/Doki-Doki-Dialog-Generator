const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./single-box-DrW1BnDt.js","./single-box-NPFyOzrf.css","./expression-builder-N-xgXkpD.js","./expression-builder-CTViDayE.css"])))=>i.map(i=>d[i]);
var nh=Object.defineProperty;var oh=(n,t,e)=>t in n?nh(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var C=(n,t,e)=>oh(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ql(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Ae={},Qn=[],Gt=()=>{},sh=()=>!1,hr=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zl=n=>n.startsWith("onUpdate:"),ot=Object.assign,Xl=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},rh=Object.prototype.hasOwnProperty,Le=(n,t)=>rh.call(n,t),me=Array.isArray,eo=n=>bo(n)==="[object Map]",mo=n=>bo(n)==="[object Set]",Ya=n=>bo(n)==="[object Date]",ih=n=>bo(n)==="[object RegExp]",ke=n=>typeof n=="function",Ze=n=>typeof n=="string",Nt=n=>typeof n=="symbol",Fe=n=>n!==null&&typeof n=="object",Sd=n=>(Fe(n)||ke(n))&&ke(n.then)&&ke(n.catch),Pd=Object.prototype.toString,bo=n=>Pd.call(n),lh=n=>bo(n).slice(8,-1),Od=n=>bo(n)==="[object Object]",Yl=n=>Ze(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Fo=ql(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),vr=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},ah=/-(\w)/g,rn=vr(n=>n.replace(ah,(t,e)=>e?e.toUpperCase():"")),uh=/\B([A-Z])/g,an=vr(n=>n.replace(uh,"-$1").toLowerCase()),Td=vr(n=>n.charAt(0).toUpperCase()+n.slice(1)),Br=vr(n=>n?`on${Td(n)}`:""),bt=(n,t)=>!Object.is(n,t),to=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},$d=(n,t,e,o=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:o,value:e})},Ws=n=>{const t=parseFloat(n);return isNaN(t)?n:t},ch=n=>{const t=Ze(n)?Number(n):NaN;return isNaN(t)?n:t};let Ga;const gr=()=>Ga||(Ga=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(n){if(me(n)){const t={};for(let e=0;e<n.length;e++){const o=n[e],s=Ze(o)?hh(o):tt(o);if(s)for(const r in s)t[r]=s[r]}return t}else if(Ze(n)||Fe(n))return n}const dh=/;(?![^(]*\))/g,fh=/:([^]+)/,ph=/\/\*[^]*?\*\//g;function hh(n){const t={};return n.replace(ph,"").split(dh).forEach(e=>{if(e){const o=e.split(fh);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function He(n){let t="";if(Ze(n))t=n;else if(me(n))for(let e=0;e<n.length;e++){const o=He(n[e]);o&&(t+=o+" ")}else if(Fe(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const vh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",gh=ql(vh);function jd(n){return!!n||n===""}function mh(n,t){if(n.length!==t.length)return!1;let e=!0;for(let o=0;e&&o<n.length;o++)e=ds(n[o],t[o]);return e}function ds(n,t){if(n===t)return!0;let e=Ya(n),o=Ya(t);if(e||o)return e&&o?n.getTime()===t.getTime():!1;if(e=Nt(n),o=Nt(t),e||o)return n===t;if(e=me(n),o=me(t),e||o)return e&&o?mh(n,t):!1;if(e=Fe(n),o=Fe(t),e||o){if(!e||!o)return!1;const s=Object.keys(n).length,r=Object.keys(t).length;if(s!==r)return!1;for(const i in n){const l=n.hasOwnProperty(i),a=t.hasOwnProperty(i);if(l&&!a||!l&&a||!ds(n[i],t[i]))return!1}}return String(n)===String(t)}function Gl(n,t){return n.findIndex(e=>ds(e,t))}const Rd=n=>!!(n&&n.__v_isRef===!0),Pe=n=>Ze(n)?n:n==null?"":me(n)||Fe(n)&&(n.toString===Pd||!ke(n.toString))?Rd(n)?Pe(n.value):JSON.stringify(n,Ad,2):String(n),Ad=(n,t)=>Rd(t)?Ad(n,t.value):eo(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[o,s],r)=>(e[Er(o,r)+" =>"]=s,e),{})}:mo(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Er(e))}:Nt(t)?Er(t):Fe(t)&&!me(t)&&!Od(t)?String(t):t,Er=(n,t="")=>{var e;return Nt(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ct;class bh{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ct,!t&&Ct&&(this.index=(Ct.scopes||(Ct.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Ct;try{return Ct=this,t()}finally{Ct=e}}}on(){Ct=this}off(){Ct=this.parent}stop(t){if(this._active){this._active=!1;let e,o;for(e=0,o=this.effects.length;e<o;e++)this.effects[e].stop();for(this.effects.length=0,e=0,o=this.cleanups.length;e<o;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,o=this.scopes.length;e<o;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function yh(){return Ct}let Ue;const Lr=new WeakSet;class Id{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ct&&Ct.active&&Ct.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lr.has(this)&&(Lr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Dd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ka(this),Bd(this);const t=Ue,e=Et;Ue=this,Et=!0;try{return this.fn()}finally{Ed(this),Ue=t,Et=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zl(t);this.deps=this.depsTail=void 0,Ka(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){bl(this)&&this.run()}get dirty(){return bl(this)}}let Md=0,Uo,qo;function Dd(n,t=!1){if(n.flags|=8,t){n.next=qo,qo=n;return}n.next=Uo,Uo=n}function Kl(){Md++}function Jl(){if(--Md>0)return;if(qo){let t=qo;for(qo=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Uo;){let t=Uo;for(Uo=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(o){n||(n=o)}t=e}}if(n)throw n}function Bd(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ed(n){let t,e=n.depsTail,o=e;for(;o;){const s=o.prevDep;o.version===-1?(o===e&&(e=s),Zl(o),wh(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=s}n.deps=t,n.depsTail=e}function bl(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ld(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Ld(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ns))return;n.globalVersion=ns;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!bl(n)){n.flags&=-3;return}const e=Ue,o=Et;Ue=n,Et=!0;try{Bd(n);const s=n.fn(n._value);(t.version===0||bt(s,n._value))&&(n._value=s,t.version++)}catch(s){throw t.version++,s}finally{Ue=e,Et=o,Ed(n),n.flags&=-3}}function Zl(n,t=!1){const{dep:e,prevSub:o,nextSub:s}=n;if(o&&(o.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=o,n.nextSub=void 0),e.subs===n&&(e.subs=o,!o&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Zl(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function wh(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let Et=!0;const Nd=[];function _n(){Nd.push(Et),Et=!1}function xn(){const n=Nd.pop();Et=n===void 0?!0:n}function Ka(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=Ue;Ue=void 0;try{t()}finally{Ue=e}}}let ns=0;class kh{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mr{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ue||!Et||Ue===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==Ue)e=this.activeLink=new kh(Ue,this),Ue.deps?(e.prevDep=Ue.depsTail,Ue.depsTail.nextDep=e,Ue.depsTail=e):Ue.deps=Ue.depsTail=e,Hd(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const o=e.nextDep;o.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=o),e.prevDep=Ue.depsTail,e.nextDep=void 0,Ue.depsTail.nextDep=e,Ue.depsTail=e,Ue.deps===e&&(Ue.deps=o)}return e}trigger(t){this.version++,ns++,this.notify(t)}notify(t){Kl();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Jl()}}}function Hd(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let o=t.deps;o;o=o.nextDep)Hd(o)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const yl=new WeakMap,Mn=Symbol(""),wl=Symbol(""),os=Symbol("");function ft(n,t,e){if(Et&&Ue){let o=yl.get(n);o||yl.set(n,o=new Map);let s=o.get(e);s||(o.set(e,s=new mr),s.map=o,s.key=e),s.track()}}function tn(n,t,e,o,s,r){const i=yl.get(n);if(!i){ns++;return}const l=a=>{a&&a.trigger()};if(Kl(),t==="clear")i.forEach(l);else{const a=me(n),u=a&&Yl(e);if(a&&e==="length"){const c=Number(o);i.forEach((f,g)=>{(g==="length"||g===os||!Nt(g)&&g>=c)&&l(f)})}else switch((e!==void 0||i.has(void 0))&&l(i.get(e)),u&&l(i.get(os)),t){case"add":a?u&&l(i.get("length")):(l(i.get(Mn)),eo(n)&&l(i.get(wl)));break;case"delete":a||(l(i.get(Mn)),eo(n)&&l(i.get(wl)));break;case"set":eo(n)&&l(i.get(Mn));break}}Jl()}function Un(n){const t=Be(n);return t===n?t:(ft(t,"iterate",os),It(n)?t:t.map(pt))}function br(n){return ft(n=Be(n),"iterate",os),n}const Ch={__proto__:null,[Symbol.iterator](){return Nr(this,Symbol.iterator,pt)},concat(...n){return Un(this).concat(...n.map(t=>me(t)?Un(t):t))},entries(){return Nr(this,"entries",n=>(n[1]=pt(n[1]),n))},every(n,t){return Qt(this,"every",n,t,void 0,arguments)},filter(n,t){return Qt(this,"filter",n,t,e=>e.map(pt),arguments)},find(n,t){return Qt(this,"find",n,t,pt,arguments)},findIndex(n,t){return Qt(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Qt(this,"findLast",n,t,pt,arguments)},findLastIndex(n,t){return Qt(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Qt(this,"forEach",n,t,void 0,arguments)},includes(...n){return Hr(this,"includes",n)},indexOf(...n){return Hr(this,"indexOf",n)},join(n){return Un(this).join(n)},lastIndexOf(...n){return Hr(this,"lastIndexOf",n)},map(n,t){return Qt(this,"map",n,t,void 0,arguments)},pop(){return So(this,"pop")},push(...n){return So(this,"push",n)},reduce(n,...t){return Ja(this,"reduce",n,t)},reduceRight(n,...t){return Ja(this,"reduceRight",n,t)},shift(){return So(this,"shift")},some(n,t){return Qt(this,"some",n,t,void 0,arguments)},splice(...n){return So(this,"splice",n)},toReversed(){return Un(this).toReversed()},toSorted(n){return Un(this).toSorted(n)},toSpliced(...n){return Un(this).toSpliced(...n)},unshift(...n){return So(this,"unshift",n)},values(){return Nr(this,"values",pt)}};function Nr(n,t,e){const o=br(n),s=o[t]();return o!==n&&!It(n)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=e(r.value)),r}),s}const _h=Array.prototype;function Qt(n,t,e,o,s,r){const i=br(n),l=i!==n&&!It(n),a=i[t];if(a!==_h[t]){const f=a.apply(n,r);return l?pt(f):f}let u=e;i!==n&&(l?u=function(f,g){return e.call(this,pt(f),g,n)}:e.length>2&&(u=function(f,g){return e.call(this,f,g,n)}));const c=a.call(i,u,o);return l&&s?s(c):c}function Ja(n,t,e,o){const s=br(n);let r=e;return s!==n&&(It(n)?e.length>3&&(r=function(i,l,a){return e.call(this,i,l,a,n)}):r=function(i,l,a){return e.call(this,i,pt(l),a,n)}),s[t](r,...o)}function Hr(n,t,e){const o=Be(n);ft(o,"iterate",os);const s=o[t](...e);return(s===-1||s===!1)&&ta(e[0])?(e[0]=Be(e[0]),o[t](...e)):s}function So(n,t,e=[]){_n(),Kl();const o=Be(n)[t].apply(n,e);return Jl(),xn(),o}const xh=ql("__proto__,__v_isRef,__isVue"),Wd=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Nt));function Sh(n){Nt(n)||(n=String(n));const t=Be(this);return ft(t,"has",n),t.hasOwnProperty(n)}class Vd{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,o){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return o===(s?r?Dh:zd:r?qd:Ud).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(o)?t:void 0;const i=me(t);if(!s){let a;if(i&&(a=Ch[e]))return a;if(e==="hasOwnProperty")return Sh}const l=Reflect.get(t,e,ge(t)?t:o);return(Nt(e)?Wd.has(e):xh(e))||(s||ft(t,"get",e),r)?l:ge(l)?i&&Yl(e)?l:l.value:Fe(l)?s?Xd(l):Jt(l):l}}class Fd extends Vd{constructor(t=!1){super(!1,t)}set(t,e,o,s){let r=t[e];if(!this._isShallow){const a=ln(r);if(!It(o)&&!ln(o)&&(r=Be(r),o=Be(o)),!me(t)&&ge(r)&&!ge(o))return a?!1:(r.value=o,!0)}const i=me(t)&&Yl(e)?Number(e)<t.length:Le(t,e),l=Reflect.set(t,e,o,ge(t)?t:s);return t===Be(s)&&(i?bt(o,r)&&tn(t,"set",e,o):tn(t,"add",e,o)),l}deleteProperty(t,e){const o=Le(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&o&&tn(t,"delete",e,void 0),s}has(t,e){const o=Reflect.has(t,e);return(!Nt(e)||!Wd.has(e))&&ft(t,"has",e),o}ownKeys(t){return ft(t,"iterate",me(t)?"length":Mn),Reflect.ownKeys(t)}}class Ph extends Vd{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Oh=new Fd,Th=new Ph,$h=new Fd(!0);const kl=n=>n,ws=n=>Reflect.getPrototypeOf(n);function jh(n,t,e){return function(...o){const s=this.__v_raw,r=Be(s),i=eo(r),l=n==="entries"||n===Symbol.iterator&&i,a=n==="keys"&&i,u=s[n](...o),c=e?kl:t?Cl:pt;return!t&&ft(r,"iterate",a?wl:Mn),{next(){const{value:f,done:g}=u.next();return g?{value:f,done:g}:{value:l?[c(f[0]),c(f[1])]:c(f),done:g}},[Symbol.iterator](){return this}}}}function ks(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function Rh(n,t){const e={get(s){const r=this.__v_raw,i=Be(r),l=Be(s);n||(bt(s,l)&&ft(i,"get",s),ft(i,"get",l));const{has:a}=ws(i),u=t?kl:n?Cl:pt;if(a.call(i,s))return u(r.get(s));if(a.call(i,l))return u(r.get(l));r!==i&&r.get(s)},get size(){const s=this.__v_raw;return!n&&ft(Be(s),"iterate",Mn),Reflect.get(s,"size",s)},has(s){const r=this.__v_raw,i=Be(r),l=Be(s);return n||(bt(s,l)&&ft(i,"has",s),ft(i,"has",l)),s===l?r.has(s):r.has(s)||r.has(l)},forEach(s,r){const i=this,l=i.__v_raw,a=Be(l),u=t?kl:n?Cl:pt;return!n&&ft(a,"iterate",Mn),l.forEach((c,f)=>s.call(r,u(c),u(f),i))}};return ot(e,n?{add:ks("add"),set:ks("set"),delete:ks("delete"),clear:ks("clear")}:{add(s){!t&&!It(s)&&!ln(s)&&(s=Be(s));const r=Be(this);return ws(r).has.call(r,s)||(r.add(s),tn(r,"add",s,s)),this},set(s,r){!t&&!It(r)&&!ln(r)&&(r=Be(r));const i=Be(this),{has:l,get:a}=ws(i);let u=l.call(i,s);u||(s=Be(s),u=l.call(i,s));const c=a.call(i,s);return i.set(s,r),u?bt(r,c)&&tn(i,"set",s,r):tn(i,"add",s,r),this},delete(s){const r=Be(this),{has:i,get:l}=ws(r);let a=i.call(r,s);a||(s=Be(s),a=i.call(r,s)),l&&l.call(r,s);const u=r.delete(s);return a&&tn(r,"delete",s,void 0),u},clear(){const s=Be(this),r=s.size!==0,i=s.clear();return r&&tn(s,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=jh(s,n,t)}),e}function Ql(n,t){const e=Rh(n,t);return(o,s,r)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?o:Reflect.get(Le(e,s)&&s in o?e:o,s,r)}const Ah={get:Ql(!1,!1)},Ih={get:Ql(!1,!0)},Mh={get:Ql(!0,!1)};const Ud=new WeakMap,qd=new WeakMap,zd=new WeakMap,Dh=new WeakMap;function Bh(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Eh(n){return n.__v_skip||!Object.isExtensible(n)?0:Bh(lh(n))}function Jt(n){return ln(n)?n:ea(n,!1,Oh,Ah,Ud)}function Lh(n){return ea(n,!1,$h,Ih,qd)}function Xd(n){return ea(n,!0,Th,Mh,zd)}function ea(n,t,e,o,s){if(!Fe(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=s.get(n);if(r)return r;const i=Eh(n);if(i===0)return n;const l=new Proxy(n,i===2?o:e);return s.set(n,l),l}function no(n){return ln(n)?no(n.__v_raw):!!(n&&n.__v_isReactive)}function ln(n){return!!(n&&n.__v_isReadonly)}function It(n){return!!(n&&n.__v_isShallow)}function ta(n){return n?!!n.__v_raw:!1}function Be(n){const t=n&&n.__v_raw;return t?Be(t):n}function yt(n){return!Le(n,"__v_skip")&&Object.isExtensible(n)&&$d(n,"__v_skip",!0),n}const pt=n=>Fe(n)?Jt(n):n,Cl=n=>Fe(n)?Xd(n):n;function ge(n){return n?n.__v_isRef===!0:!1}function R(n){return Yd(n,!1)}function Nh(n){return Yd(n,!0)}function Yd(n,t){return ge(n)?n:new Hh(n,t)}class Hh{constructor(t,e){this.dep=new mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Be(t),this._value=e?t:pt(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,o=this.__v_isShallow||It(t)||ln(t);t=o?t:Be(t),bt(t,e)&&(this._rawValue=t,this._value=o?t:pt(t),this.dep.trigger())}}function Q(n){return ge(n)?n.value:n}const Wh={get:(n,t,e)=>t==="__v_raw"?n:Q(Reflect.get(n,t,e)),set:(n,t,e,o)=>{const s=n[t];return ge(s)&&!ge(e)?(s.value=e,!0):Reflect.set(n,t,e,o)}};function Gd(n){return no(n)?n:new Proxy(n,Wh)}class Vh{constructor(t){this.__v_isRef=!0,this._value=void 0;const e=this.dep=new mr,{get:o,set:s}=t(e.track.bind(e),e.trigger.bind(e));this._get=o,this._set=s}get value(){return this._value=this._get()}set value(t){this._set(t)}}function Fh(n){return new Vh(n)}class Uh{constructor(t,e,o){this.fn=t,this.setter=e,this._value=void 0,this.dep=new mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ns-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=o}notify(){if(this.flags|=16,!(this.flags&8)&&Ue!==this)return Dd(this,!0),!0}get value(){const t=this.dep.track();return Ld(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function qh(n,t,e=!1){let o,s;return ke(n)?o=n:(o=n.get,s=n.set),new Uh(o,s,e)}const Cs={},Vs=new WeakMap;let Rn;function zh(n,t=!1,e=Rn){if(e){let o=Vs.get(e);o||Vs.set(e,o=[]),o.push(n)}}function Xh(n,t,e=Ae){const{immediate:o,deep:s,once:r,scheduler:i,augmentJob:l,call:a}=e,u=p=>s?p:It(p)||s===!1||s===0?nn(p,1):nn(p);let c,f,g,m,_=!1,k=!1;if(ge(n)?(f=()=>n.value,_=It(n)):no(n)?(f=()=>u(n),_=!0):me(n)?(k=!0,_=n.some(p=>no(p)||It(p)),f=()=>n.map(p=>{if(ge(p))return p.value;if(no(p))return u(p);if(ke(p))return a?a(p,2):p()})):ke(n)?t?f=a?()=>a(n,2):n:f=()=>{if(g){_n();try{g()}finally{xn()}}const p=Rn;Rn=c;try{return a?a(n,3,[m]):n(m)}finally{Rn=p}}:f=Gt,t&&s){const p=f,P=s===!0?1/0:s;f=()=>nn(p(),P)}const y=yh(),w=()=>{c.stop(),y&&y.active&&Xl(y.effects,c)};if(r&&t){const p=t;t=(...P)=>{p(...P),w()}}let h=k?new Array(n.length).fill(Cs):Cs;const v=p=>{if(!(!(c.flags&1)||!c.dirty&&!p))if(t){const P=c.run();if(s||_||(k?P.some((M,N)=>bt(M,h[N])):bt(P,h))){g&&g();const M=Rn;Rn=c;try{const N=[P,h===Cs?void 0:k&&h[0]===Cs?[]:h,m];a?a(t,3,N):t(...N),h=P}finally{Rn=M}}}else c.run()};return l&&l(v),c=new Id(f),c.scheduler=i?()=>i(v,!1):v,m=p=>zh(p,!1,c),g=c.onStop=()=>{const p=Vs.get(c);if(p){if(a)a(p,4);else for(const P of p)P();Vs.delete(c)}},t?o?v(!0):h=c.run():i?i(v.bind(null,!0),!0):c.run(),w.pause=c.pause.bind(c),w.resume=c.resume.bind(c),w.stop=w,w}function nn(n,t=1/0,e){if(t<=0||!Fe(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,ge(n))nn(n.value,t,e);else if(me(n))for(let o=0;o<n.length;o++)nn(n[o],t,e);else if(mo(n)||eo(n))n.forEach(o=>{nn(o,t,e)});else if(Od(n)){for(const o in n)nn(n[o],t,e);for(const o of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,o)&&nn(n[o],t,e)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fs(n,t,e,o){try{return o?n(...o):n()}catch(s){ps(s,t,e)}}function Ht(n,t,e,o){if(ke(n)){const s=fs(n,t,e,o);return s&&Sd(s)&&s.catch(r=>{ps(r,t,e)}),s}if(me(n)){const s=[];for(let r=0;r<n.length;r++)s.push(Ht(n[r],t,e,o));return s}}function ps(n,t,e,o=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:i}=t&&t.appContext.config||Ae;if(t){let l=t.parent;const a=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;l;){const c=l.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](n,a,u)===!1)return}l=l.parent}if(r){_n(),fs(r,null,10,[n,a,u]),xn();return}}Yh(n,e,s,o,i)}function Yh(n,t,e,o=!0,s=!1){if(s)throw n;console.error(n)}const gt=[];let qt=-1;const oo=[];let vn=null,Xn=0;const Kd=Promise.resolve();let Fs=null;function yn(n){const t=Fs||Kd;return n?t.then(this?n.bind(this):n):t}function Gh(n){let t=qt+1,e=gt.length;for(;t<e;){const o=t+e>>>1,s=gt[o],r=ss(s);r<n||r===n&&s.flags&2?t=o+1:e=o}return t}function na(n){if(!(n.flags&1)){const t=ss(n),e=gt[gt.length-1];!e||!(n.flags&2)&&t>=ss(e)?gt.push(n):gt.splice(Gh(t),0,n),n.flags|=1,Jd()}}function Jd(){Fs||(Fs=Kd.then(Qd))}function Kh(n){me(n)?oo.push(...n):vn&&n.id===-1?vn.splice(Xn+1,0,n):n.flags&1||(oo.push(n),n.flags|=1),Jd()}function Za(n,t,e=qt+1){for(;e<gt.length;e++){const o=gt[e];if(o&&o.flags&2){if(n&&o.id!==n.uid)continue;gt.splice(e,1),e--,o.flags&4&&(o.flags&=-2),o(),o.flags&4||(o.flags&=-2)}}}function Zd(n){if(oo.length){const t=[...new Set(oo)].sort((e,o)=>ss(e)-ss(o));if(oo.length=0,vn){vn.push(...t);return}for(vn=t,Xn=0;Xn<vn.length;Xn++){const e=vn[Xn];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}vn=null,Xn=0}}const ss=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Qd(n){try{for(qt=0;qt<gt.length;qt++){const t=gt[qt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fs(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;qt<gt.length;qt++){const t=gt[qt];t&&(t.flags&=-2)}qt=-1,gt.length=0,Zd(),Fs=null,(gt.length||oo.length)&&Qd()}}let ut=null,ef=null;function Us(n){const t=ut;return ut=n,ef=n&&n.type.__scopeId||null,t}function ne(n,t=ut,e){if(!t||n._n)return n;const o=(...s)=>{o._d&&cu(-1);const r=Us(t);let i;try{i=n(...s)}finally{Us(r),o._d&&cu(1)}return i};return o._n=!0,o._c=!0,o._d=!0,o}function Se(n,t){if(ut===null)return n;const e=_r(ut),o=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[r,i,l,a=Ae]=t[s];r&&(ke(r)&&(r={mounted:r,updated:r}),r.deep&&nn(i),o.push({dir:r,instance:e,value:i,oldValue:void 0,arg:l,modifiers:a}))}return n}function On(n,t,e,o){const s=n.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){const l=s[i];r&&(l.oldValue=r[i].value);let a=l.dir[o];a&&(_n(),Ht(a,e,8,[n.el,l,n,t]),xn())}}const tf=Symbol("_vte"),Jh=n=>n.__isTeleport,zo=n=>n&&(n.disabled||n.disabled===""),Qa=n=>n&&(n.defer||n.defer===""),eu=n=>typeof SVGElement<"u"&&n instanceof SVGElement,tu=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,_l=(n,t)=>{const e=n&&n.to;return Ze(e)?t?t(e):null:e},nf={name:"Teleport",__isTeleport:!0,process(n,t,e,o,s,r,i,l,a,u){const{mc:c,pc:f,pbc:g,o:{insert:m,querySelector:_,createText:k,createComment:y}}=u,w=zo(t.props);let{shapeFlag:h,children:v,dynamicChildren:p}=t;if(n==null){const P=t.el=k(""),M=t.anchor=k("");m(P,e,o),m(M,e,o);const N=(O,T)=>{h&16&&(s&&s.isCE&&(s.ce._teleportTarget=O),c(v,O,T,s,r,i,l,a))},b=()=>{const O=t.target=_l(t.props,_),T=of(O,t,k,m);O&&(i!=="svg"&&eu(O)?i="svg":i!=="mathml"&&tu(O)&&(i="mathml"),w||(N(O,T),$s(t,!1)))};w&&(N(e,M),$s(t,!0)),Qa(t.props)?rt(()=>{b(),t.el.__isMounted=!0},r):b()}else{if(Qa(t.props)&&!n.el.__isMounted){rt(()=>{nf.process(n,t,e,o,s,r,i,l,a,u),delete n.el.__isMounted},r);return}t.el=n.el,t.targetStart=n.targetStart;const P=t.anchor=n.anchor,M=t.target=n.target,N=t.targetAnchor=n.targetAnchor,b=zo(n.props),O=b?e:M,T=b?P:N;if(i==="svg"||eu(M)?i="svg":(i==="mathml"||tu(M))&&(i="mathml"),p?(g(n.dynamicChildren,p,O,s,r,i,l),ua(n,t,!0)):a||f(n,t,O,T,s,r,i,l,!1),w)b?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):_s(t,e,P,u,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const L=t.target=_l(t.props,_);L&&_s(t,L,null,u,0)}else b&&_s(t,M,N,u,1);$s(t,w)}},remove(n,t,e,{um:o,o:{remove:s}},r){const{shapeFlag:i,children:l,anchor:a,targetStart:u,targetAnchor:c,target:f,props:g}=n;if(f&&(s(u),s(c)),r&&s(a),i&16){const m=r||!zo(g);for(let _=0;_<l.length;_++){const k=l[_];o(k,t,e,m,!!k.dynamicChildren)}}},move:_s,hydrate:Zh};function _s(n,t,e,{o:{insert:o},m:s},r=2){r===0&&o(n.targetAnchor,t,e);const{el:i,anchor:l,shapeFlag:a,children:u,props:c}=n,f=r===2;if(f&&o(i,t,e),(!f||zo(c))&&a&16)for(let g=0;g<u.length;g++)s(u[g],t,e,2);f&&o(l,t,e)}function Zh(n,t,e,o,s,r,{o:{nextSibling:i,parentNode:l,querySelector:a,insert:u,createText:c}},f){const g=t.target=_l(t.props,a);if(g){const m=zo(t.props),_=g._lpa||g.firstChild;if(t.shapeFlag&16)if(m)t.anchor=f(i(n),t,l(n),e,o,s,r),t.targetStart=_,t.targetAnchor=_&&i(_);else{t.anchor=i(n);let k=_;for(;k;){if(k&&k.nodeType===8){if(k.data==="teleport start anchor")t.targetStart=k;else if(k.data==="teleport anchor"){t.targetAnchor=k,g._lpa=t.targetAnchor&&i(t.targetAnchor);break}}k=i(k)}t.targetAnchor||of(g,t,c,u),f(_&&i(_),t,g,e,o,s,r)}$s(t,m)}return t.anchor&&i(t.anchor)}const oa=nf;function $s(n,t){const e=n.ctx;if(e&&e.ut){let o,s;for(t?(o=n.el,s=n.anchor):(o=n.targetStart,s=n.targetAnchor);o&&o!==s;)o.nodeType===1&&o.setAttribute("data-v-owner",e.uid),o=o.nextSibling;e.ut()}}function of(n,t,e,o){const s=t.targetStart=e(""),r=t.targetAnchor=e("");return s[tf]=r,n&&(o(s,n),o(r,n)),r}const qn=Symbol("_leaveCb"),xs=Symbol("_enterCb");function Qh(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wt(()=>{n.isMounted=!0}),la(()=>{n.isUnmounting=!0}),n}const Tt=[Function,Array],ev={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Tt,onEnter:Tt,onAfterEnter:Tt,onEnterCancelled:Tt,onBeforeLeave:Tt,onLeave:Tt,onAfterLeave:Tt,onLeaveCancelled:Tt,onBeforeAppear:Tt,onAppear:Tt,onAfterAppear:Tt,onAppearCancelled:Tt};function tv(n,t){const{leavingVNodes:e}=n;let o=e.get(t.type);return o||(o=Object.create(null),e.set(t.type,o)),o}function xl(n,t,e,o,s){const{appear:r,mode:i,persisted:l=!1,onBeforeEnter:a,onEnter:u,onAfterEnter:c,onEnterCancelled:f,onBeforeLeave:g,onLeave:m,onAfterLeave:_,onLeaveCancelled:k,onBeforeAppear:y,onAppear:w,onAfterAppear:h,onAppearCancelled:v}=t,p=String(n.key),P=tv(e,n),M=(O,T)=>{O&&Ht(O,o,9,T)},N=(O,T)=>{const L=T[1];M(O,T),me(O)?O.every(B=>B.length<=1)&&L():O.length<=1&&L()},b={mode:i,persisted:l,beforeEnter(O){let T=a;if(!e.isMounted)if(r)T=y||a;else return;O[qn]&&O[qn](!0);const L=P[p];L&&An(n,L)&&L.el[qn]&&L.el[qn](),M(T,[O])},enter(O){let T=u,L=c,B=f;if(!e.isMounted)if(r)T=w||u,L=h||c,B=v||f;else return;let H=!1;const ee=O[xs]=Y=>{H||(H=!0,Y?M(B,[O]):M(L,[O]),b.delayedLeave&&b.delayedLeave(),O[xs]=void 0)};T?N(T,[O,ee]):ee()},leave(O,T){const L=String(n.key);if(O[xs]&&O[xs](!0),e.isUnmounting)return T();M(g,[O]);let B=!1;const H=O[qn]=ee=>{B||(B=!0,T(),ee?M(k,[O]):M(_,[O]),O[qn]=void 0,P[L]===n&&delete P[L])};P[L]=n,m?N(m,[O,H]):H()},clone(O){return xl(O,t,e,o)}};return b}function io(n,t){n.shapeFlag&6&&n.component?(n.transition=t,io(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function sf(n,t=!1,e){let o=[],s=0;for(let r=0;r<n.length;r++){let i=n[r];const l=e==null?i.key:String(e)+String(i.key!=null?i.key:r);i.type===ue?(i.patchFlag&128&&s++,o=o.concat(sf(i.children,t,l))):(t||i.type!==Zt)&&o.push(l!=null?Cn(i,{key:l}):i)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}/*! #__NO_SIDE_EFFECTS__ */function _e(n,t){return ke(n)?ot({name:n.name},t,{setup:n}):n}function sa(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function nv(n){const t=Cr(),e=Nh(null);if(t){const s=t.refs===Ae?t.refs={}:t.refs;Object.defineProperty(s,n,{enumerable:!0,get:()=>e.value,set:r=>e.value=r})}return e}function qs(n,t,e,o,s=!1){if(me(n)){n.forEach((_,k)=>qs(_,t&&(me(t)?t[k]:t),e,o,s));return}if(Dn(o)&&!s){o.shapeFlag&512&&o.type.__asyncResolved&&o.component.subTree.component&&qs(n,t,e,o.component.subTree);return}const r=o.shapeFlag&4?_r(o.component):o.el,i=s?null:r,{i:l,r:a}=n,u=t&&t.r,c=l.refs===Ae?l.refs={}:l.refs,f=l.setupState,g=Be(f),m=f===Ae?()=>!1:_=>Le(g,_);if(u!=null&&u!==a&&(Ze(u)?(c[u]=null,m(u)&&(f[u]=null)):ge(u)&&(u.value=null)),ke(a))fs(a,l,12,[i,c]);else{const _=Ze(a),k=ge(a);if(_||k){const y=()=>{if(n.f){const w=_?m(a)?f[a]:c[a]:a.value;s?me(w)&&Xl(w,r):me(w)?w.includes(r)||w.push(r):_?(c[a]=[r],m(a)&&(f[a]=c[a])):(a.value=[r],n.k&&(c[n.k]=a.value))}else _?(c[a]=i,m(a)&&(f[a]=i)):k&&(a.value=i,n.k&&(c[n.k]=i))};i?(y.id=-1,rt(y,e)):y()}}}const nu=n=>n.nodeType===8;gr().requestIdleCallback;gr().cancelIdleCallback;function ov(n,t){if(nu(n)&&n.data==="["){let e=1,o=n.nextSibling;for(;o;){if(o.nodeType===1){if(t(o)===!1)break}else if(nu(o))if(o.data==="]"){if(--e===0)break}else o.data==="["&&e++;o=o.nextSibling}}else t(n)}const Dn=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function ou(n){ke(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:o,delay:s=200,hydrate:r,timeout:i,suspensible:l=!0,onError:a}=n;let u=null,c,f=0;const g=()=>(f++,u=null,m()),m=()=>{let _;return u||(_=u=t().catch(k=>{if(k=k instanceof Error?k:new Error(String(k)),a)return new Promise((y,w)=>{a(k,()=>y(g()),()=>w(k),f+1)});throw k}).then(k=>_!==u&&u?u:(k&&(k.__esModule||k[Symbol.toStringTag]==="Module")&&(k=k.default),c=k,k)))};return _e({name:"AsyncComponentWrapper",__asyncLoader:m,__asyncHydrate(_,k,y){const w=r?()=>{const h=r(y,v=>ov(_,v));h&&(k.bum||(k.bum=[])).push(h)}:y;c?w():m().then(()=>!k.isUnmounted&&w())},get __asyncResolved(){return c},setup(){const _=at;if(sa(_),c)return()=>Wr(c,_);const k=v=>{u=null,ps(v,_,13,!o)};if(l&&_.suspense||ao)return m().then(v=>()=>Wr(v,_)).catch(v=>(k(v),()=>o?q(o,{error:v}):null));const y=R(!1),w=R(),h=R(!!s);return s&&setTimeout(()=>{h.value=!1},s),i!=null&&setTimeout(()=>{if(!y.value&&!w.value){const v=new Error(`Async component timed out after ${i}ms.`);k(v),w.value=v}},i),m().then(()=>{y.value=!0,_.parent&&ra(_.parent.vnode)&&_.parent.update()}).catch(v=>{k(v),w.value=v}),()=>{if(y.value&&c)return Wr(c,_);if(w.value&&o)return q(o,{error:w.value});if(e&&!h.value)return q(e)}}})}function Wr(n,t){const{ref:e,props:o,children:s,ce:r}=t.vnode,i=q(n,o,s);return i.ref=e,i.ce=r,delete t.vnode.ce,i}const ra=n=>n.type.__isKeepAlive,sv={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:t}){const e=Cr(),o=e.ctx;if(!o.renderer)return()=>{const h=t.default&&t.default();return h&&h.length===1?h[0]:h};const s=new Map,r=new Set;let i=null;const l=e.suspense,{renderer:{p:a,m:u,um:c,o:{createElement:f}}}=o,g=f("div");o.activate=(h,v,p,P,M)=>{const N=h.component;u(h,v,p,0,l),a(N.vnode,h,v,p,N,l,P,h.slotScopeIds,M),rt(()=>{N.isDeactivated=!1,N.a&&to(N.a);const b=h.props&&h.props.onVnodeMounted;b&&$t(b,N.parent,h)},l)},o.deactivate=h=>{const v=h.component;Ys(v.m),Ys(v.a),u(h,g,null,1,l),rt(()=>{v.da&&to(v.da);const p=h.props&&h.props.onVnodeUnmounted;p&&$t(p,v.parent,h),v.isDeactivated=!0},l)};function m(h){Vr(h),c(h,e,l,!0)}function _(h){s.forEach((v,p)=>{const P=pu(v.type);P&&!h(P)&&k(p)})}function k(h){const v=s.get(h);v&&(!i||!An(v,i))?m(v):i&&Vr(i),s.delete(h),r.delete(h)}ze(()=>[n.include,n.exclude],([h,v])=>{h&&_(p=>Bo(h,p)),v&&_(p=>!Bo(v,p))},{flush:"post",deep:!0});let y=null;const w=()=>{y!=null&&(Gs(e.subTree.type)?rt(()=>{s.set(y,Ss(e.subTree))},e.subTree.suspense):s.set(y,Ss(e.subTree)))};return Wt(w),ia(w),la(()=>{s.forEach(h=>{const{subTree:v,suspense:p}=e,P=Ss(v);if(h.type===P.type&&h.key===P.key){Vr(P);const M=P.component.da;M&&rt(M,p);return}m(h)})}),()=>{if(y=null,!t.default)return i=null;const h=t.default(),v=h[0];if(h.length>1)return i=null,h;if(!lo(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return i=null,v;let p=Ss(v);if(p.type===Zt)return i=null,p;const P=p.type,M=pu(Dn(p)?p.type.__asyncResolved||{}:P),{include:N,exclude:b,max:O}=n;if(N&&(!M||!Bo(N,M))||b&&M&&Bo(b,M))return p.shapeFlag&=-257,i=p,v;const T=p.key==null?P:p.key,L=s.get(T);return p.el&&(p=Cn(p),v.shapeFlag&128&&(v.ssContent=p)),y=T,L?(p.el=L.el,p.component=L.component,p.transition&&io(p,p.transition),p.shapeFlag|=512,r.delete(T),r.add(T)):(r.add(T),O&&r.size>parseInt(O,10)&&k(r.values().next().value)),p.shapeFlag|=256,i=p,Gs(v.type)?v:p}}},rv=sv;function Bo(n,t){return me(n)?n.some(e=>Bo(e,t)):Ze(n)?n.split(",").includes(t):ih(n)?(n.lastIndex=0,n.test(t)):!1}function rf(n,t){af(n,"a",t)}function lf(n,t){af(n,"da",t)}function af(n,t,e=at){const o=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(yr(t,o,e),e){let s=e.parent;for(;s&&s.parent;)ra(s.parent.vnode)&&iv(o,t,e,s),s=s.parent}}function iv(n,t,e,o){const s=yr(t,n,o,!0);Sn(()=>{Xl(o[t],s)},e)}function Vr(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Ss(n){return n.shapeFlag&128?n.ssContent:n}function yr(n,t,e=at,o=!1){if(e){const s=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...i)=>{_n();const l=vs(e),a=Ht(t,e,n,i);return l(),xn(),a});return o?s.unshift(r):s.push(r),r}}const un=n=>(t,e=at)=>{(!ao||n==="sp")&&yr(n,(...o)=>t(...o),e)},lv=un("bm"),Wt=un("m"),av=un("bu"),ia=un("u"),la=un("bum"),Sn=un("um"),uv=un("sp"),cv=un("rtg"),dv=un("rtc");function fv(n,t=at){yr("ec",n,t)}const pv=Symbol.for("v-ndc");function qe(n,t,e,o){let s;const r=e,i=me(n);if(i||Ze(n)){const l=i&&no(n);let a=!1;l&&(a=!It(n),n=br(n)),s=new Array(n.length);for(let u=0,c=n.length;u<c;u++)s[u]=t(a?pt(n[u]):n[u],u,void 0,r)}else if(typeof n=="number"){s=new Array(n);for(let l=0;l<n;l++)s[l]=t(l+1,l,void 0,r)}else if(Fe(n))if(n[Symbol.iterator])s=Array.from(n,(l,a)=>t(l,a,void 0,r));else{const l=Object.keys(n);s=new Array(l.length);for(let a=0,u=l.length;a<u;a++){const c=l[a];s[a]=t(n[c],c,a,r)}}else s=[];return s}function Xt(n,t,e={},o,s){if(ut.ce||ut.parent&&Dn(ut.parent)&&ut.parent.ce)return t!=="default"&&(e.name=t),j(),ce(ue,null,[q("slot",e,o)],64);let r=n[t];r&&r._c&&(r._d=!1),j();const i=r&&uf(r(e)),l=e.key||i&&i.key,a=ce(ue,{key:(l&&!Nt(l)?l:`_${t}`)+""},i||[],i&&n._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function uf(n){return n.some(t=>lo(t)?!(t.type===Zt||t.type===ue&&!uf(t.children)):!0)?n:null}const Sl=n=>n?$f(n)?_r(n):Sl(n.parent):null,Xo=ot(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Sl(n.parent),$root:n=>Sl(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>df(n),$forceUpdate:n=>n.f||(n.f=()=>{na(n.update)}),$nextTick:n=>n.n||(n.n=yn.bind(n.proxy)),$watch:n=>Dv.bind(n)}),Fr=(n,t)=>n!==Ae&&!n.__isScriptSetup&&Le(n,t),hv={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:o,data:s,props:r,accessCache:i,type:l,appContext:a}=n;let u;if(t[0]!=="$"){const m=i[t];if(m!==void 0)switch(m){case 1:return o[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(Fr(o,t))return i[t]=1,o[t];if(s!==Ae&&Le(s,t))return i[t]=2,s[t];if((u=n.propsOptions[0])&&Le(u,t))return i[t]=3,r[t];if(e!==Ae&&Le(e,t))return i[t]=4,e[t];Pl&&(i[t]=0)}}const c=Xo[t];let f,g;if(c)return t==="$attrs"&&ft(n.attrs,"get",""),c(n);if((f=l.__cssModules)&&(f=f[t]))return f;if(e!==Ae&&Le(e,t))return i[t]=4,e[t];if(g=a.config.globalProperties,Le(g,t))return g[t]},set({_:n},t,e){const{data:o,setupState:s,ctx:r}=n;return Fr(s,t)?(s[t]=e,!0):o!==Ae&&Le(o,t)?(o[t]=e,!0):Le(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:o,appContext:s,propsOptions:r}},i){let l;return!!e[i]||n!==Ae&&Le(n,i)||Fr(t,i)||(l=r[0])&&Le(l,i)||Le(o,i)||Le(Xo,i)||Le(s.config.globalProperties,i)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Le(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function zs(n){return me(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}function En(n,t){return!n||!t?n||t:me(n)&&me(t)?n.concat(t):ot({},zs(n),zs(t))}let Pl=!0;function vv(n){const t=df(n),e=n.proxy,o=n.ctx;Pl=!1,t.beforeCreate&&su(t.beforeCreate,n,"bc");const{data:s,computed:r,methods:i,watch:l,provide:a,inject:u,created:c,beforeMount:f,mounted:g,beforeUpdate:m,updated:_,activated:k,deactivated:y,beforeDestroy:w,beforeUnmount:h,destroyed:v,unmounted:p,render:P,renderTracked:M,renderTriggered:N,errorCaptured:b,serverPrefetch:O,expose:T,inheritAttrs:L,components:B,directives:H,filters:ee}=t;if(u&&gv(u,o,null),i)for(const A in i){const G=i[A];ke(G)&&(o[A]=G.bind(e))}if(s){const A=s.call(e,e);Fe(A)&&(n.data=Jt(A))}if(Pl=!0,r)for(const A in r){const G=r[A],Ie=ke(G)?G.bind(e,e):ke(G.get)?G.get.bind(e,e):Gt,K=!ke(G)&&ke(G.set)?G.set.bind(e):Gt,ie=E({get:Ie,set:K});Object.defineProperty(o,A,{enumerable:!0,configurable:!0,get:()=>ie.value,set:be=>ie.value=be})}if(l)for(const A in l)cf(l[A],o,e,A);if(a){const A=ke(a)?a.call(e):a;Reflect.ownKeys(A).forEach(G=>{pf(G,A[G])})}c&&su(c,n,"c");function x(A,G){me(G)?G.forEach(Ie=>A(Ie.bind(e))):G&&A(G.bind(e))}if(x(lv,f),x(Wt,g),x(av,m),x(ia,_),x(rf,k),x(lf,y),x(fv,b),x(dv,M),x(cv,N),x(la,h),x(Sn,p),x(uv,O),me(T))if(T.length){const A=n.exposed||(n.exposed={});T.forEach(G=>{Object.defineProperty(A,G,{get:()=>e[G],set:Ie=>e[G]=Ie})})}else n.exposed||(n.exposed={});P&&n.render===Gt&&(n.render=P),L!=null&&(n.inheritAttrs=L),B&&(n.components=B),H&&(n.directives=H),O&&sa(n)}function gv(n,t,e=Gt){me(n)&&(n=Ol(n));for(const o in n){const s=n[o];let r;Fe(s)?"default"in s?r=Lt(s.from||o,s.default,!0):r=Lt(s.from||o):r=Lt(s),ge(r)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):t[o]=r}}function su(n,t,e){Ht(me(n)?n.map(o=>o.bind(t.proxy)):n.bind(t.proxy),t,e)}function cf(n,t,e,o){let s=o.includes(".")?xf(e,o):()=>e[o];if(Ze(n)){const r=t[n];ke(r)&&ze(s,r)}else if(ke(n))ze(s,n.bind(e));else if(Fe(n))if(me(n))n.forEach(r=>cf(r,t,e,o));else{const r=ke(n.handler)?n.handler.bind(e):t[n.handler];ke(r)&&ze(s,r,n)}}function df(n){const t=n.type,{mixins:e,extends:o}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=n.appContext,l=r.get(t);let a;return l?a=l:!s.length&&!e&&!o?a=t:(a={},s.length&&s.forEach(u=>Xs(a,u,i,!0)),Xs(a,t,i)),Fe(t)&&r.set(t,a),a}function Xs(n,t,e,o=!1){const{mixins:s,extends:r}=t;r&&Xs(n,r,e,!0),s&&s.forEach(i=>Xs(n,i,e,!0));for(const i in t)if(!(o&&i==="expose")){const l=mv[i]||e&&e[i];n[i]=l?l(n[i],t[i]):t[i]}return n}const mv={data:ru,props:iu,emits:iu,methods:Eo,computed:Eo,beforeCreate:ht,created:ht,beforeMount:ht,mounted:ht,beforeUpdate:ht,updated:ht,beforeDestroy:ht,beforeUnmount:ht,destroyed:ht,unmounted:ht,activated:ht,deactivated:ht,errorCaptured:ht,serverPrefetch:ht,components:Eo,directives:Eo,watch:yv,provide:ru,inject:bv};function ru(n,t){return t?n?function(){return ot(ke(n)?n.call(this,this):n,ke(t)?t.call(this,this):t)}:t:n}function bv(n,t){return Eo(Ol(n),Ol(t))}function Ol(n){if(me(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function ht(n,t){return n?[...new Set([].concat(n,t))]:t}function Eo(n,t){return n?ot(Object.create(null),n,t):t}function iu(n,t){return n?me(n)&&me(t)?[...new Set([...n,...t])]:ot(Object.create(null),zs(n),zs(t??{})):t}function yv(n,t){if(!n)return t;if(!t)return n;const e=ot(Object.create(null),n);for(const o in t)e[o]=ht(n[o],t[o]);return e}function ff(){return{app:null,config:{isNativeTag:sh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let wv=0;function kv(n,t){return function(o,s=null){ke(o)||(o=ot({},o)),s!=null&&!Fe(s)&&(s=null);const r=ff(),i=new WeakSet,l=[];let a=!1;const u=r.app={_uid:wv++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:tg,get config(){return r.config},set config(c){},use(c,...f){return i.has(c)||(c&&ke(c.install)?(i.add(c),c.install(u,...f)):ke(c)&&(i.add(c),c(u,...f))),u},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),u},component(c,f){return f?(r.components[c]=f,u):r.components[c]},directive(c,f){return f?(r.directives[c]=f,u):r.directives[c]},mount(c,f,g){if(!a){const m=u._ceVNode||q(o,s);return m.appContext=r,g===!0?g="svg":g===!1&&(g=void 0),n(m,c,g),a=!0,u._container=c,c.__vue_app__=u,_r(m.component)}},onUnmount(c){l.push(c)},unmount(){a&&(Ht(l,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(c,f){return r.provides[c]=f,u},runWithContext(c){const f=so;so=u;try{return c()}finally{so=f}}};return u}}let so=null;function pf(n,t){if(at){let e=at.provides;const o=at.parent&&at.parent.provides;o===e&&(e=at.provides=Object.create(o)),e[n]=t}}function Lt(n,t,e=!1){const o=at||ut;if(o||so){const s=so?so._context.provides:o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&ke(t)?t.call(o&&o.proxy):t}}const hf={},vf=()=>Object.create(hf),gf=n=>Object.getPrototypeOf(n)===hf;function Cv(n,t,e,o=!1){const s={},r=vf();n.propsDefaults=Object.create(null),mf(n,t,s,r);for(const i in n.propsOptions[0])i in s||(s[i]=void 0);e?n.props=o?s:Lh(s):n.type.props?n.props=s:n.props=r,n.attrs=r}function _v(n,t,e,o){const{props:s,attrs:r,vnode:{patchFlag:i}}=n,l=Be(s),[a]=n.propsOptions;let u=!1;if((o||i>0)&&!(i&16)){if(i&8){const c=n.vnode.dynamicProps;for(let f=0;f<c.length;f++){let g=c[f];if(wr(n.emitsOptions,g))continue;const m=t[g];if(a)if(Le(r,g))m!==r[g]&&(r[g]=m,u=!0);else{const _=rn(g);s[_]=Tl(a,l,_,m,n,!1)}else m!==r[g]&&(r[g]=m,u=!0)}}}else{mf(n,t,s,r)&&(u=!0);let c;for(const f in l)(!t||!Le(t,f)&&((c=an(f))===f||!Le(t,c)))&&(a?e&&(e[f]!==void 0||e[c]!==void 0)&&(s[f]=Tl(a,l,f,void 0,n,!0)):delete s[f]);if(r!==l)for(const f in r)(!t||!Le(t,f))&&(delete r[f],u=!0)}u&&tn(n.attrs,"set","")}function mf(n,t,e,o){const[s,r]=n.propsOptions;let i=!1,l;if(t)for(let a in t){if(Fo(a))continue;const u=t[a];let c;s&&Le(s,c=rn(a))?!r||!r.includes(c)?e[c]=u:(l||(l={}))[c]=u:wr(n.emitsOptions,a)||(!(a in o)||u!==o[a])&&(o[a]=u,i=!0)}if(r){const a=Be(e),u=l||Ae;for(let c=0;c<r.length;c++){const f=r[c];e[f]=Tl(s,a,f,u[f],n,!Le(u,f))}}return i}function Tl(n,t,e,o,s,r){const i=n[e];if(i!=null){const l=Le(i,"default");if(l&&o===void 0){const a=i.default;if(i.type!==Function&&!i.skipFactory&&ke(a)){const{propsDefaults:u}=s;if(e in u)o=u[e];else{const c=vs(s);o=u[e]=a.call(null,t),c()}}else o=a;s.ce&&s.ce._setProp(e,o)}i[0]&&(r&&!l?o=!1:i[1]&&(o===""||o===an(e))&&(o=!0))}return o}const xv=new WeakMap;function bf(n,t,e=!1){const o=e?xv:t.propsCache,s=o.get(n);if(s)return s;const r=n.props,i={},l=[];let a=!1;if(!ke(n)){const c=f=>{a=!0;const[g,m]=bf(f,t,!0);ot(i,g),m&&l.push(...m)};!e&&t.mixins.length&&t.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!r&&!a)return Fe(n)&&o.set(n,Qn),Qn;if(me(r))for(let c=0;c<r.length;c++){const f=rn(r[c]);lu(f)&&(i[f]=Ae)}else if(r)for(const c in r){const f=rn(c);if(lu(f)){const g=r[c],m=i[f]=me(g)||ke(g)?{type:g}:ot({},g),_=m.type;let k=!1,y=!0;if(me(_))for(let w=0;w<_.length;++w){const h=_[w],v=ke(h)&&h.name;if(v==="Boolean"){k=!0;break}else v==="String"&&(y=!1)}else k=ke(_)&&_.name==="Boolean";m[0]=k,m[1]=y,(k||Le(m,"default"))&&l.push(f)}}const u=[i,l];return Fe(n)&&o.set(n,u),u}function lu(n){return n[0]!=="$"&&!Fo(n)}const yf=n=>n[0]==="_"||n==="$stable",aa=n=>me(n)?n.map(zt):[zt(n)],Sv=(n,t,e)=>{if(t._n)return t;const o=ne((...s)=>aa(t(...s)),e);return o._c=!1,o},wf=(n,t,e)=>{const o=n._ctx;for(const s in n){if(yf(s))continue;const r=n[s];if(ke(r))t[s]=Sv(s,r,o);else if(r!=null){const i=aa(r);t[s]=()=>i}}},kf=(n,t)=>{const e=aa(t);n.slots.default=()=>e},Cf=(n,t,e)=>{for(const o in t)(e||o!=="_")&&(n[o]=t[o])},Pv=(n,t,e)=>{const o=n.slots=vf();if(n.vnode.shapeFlag&32){const s=t._;s?(Cf(o,t,e),e&&$d(o,"_",s,!0)):wf(t,o)}else t&&kf(n,t)},Ov=(n,t,e)=>{const{vnode:o,slots:s}=n;let r=!0,i=Ae;if(o.shapeFlag&32){const l=t._;l?e&&l===1?r=!1:Cf(s,t,e):(r=!t.$stable,wf(t,s)),i=t}else t&&(kf(n,t),i={default:1});if(r)for(const l in s)!yf(l)&&i[l]==null&&delete s[l]},rt=Wv;function Tv(n){return $v(n)}function $v(n,t){const e=gr();e.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:i,createText:l,createComment:a,setText:u,setElementText:c,parentNode:f,nextSibling:g,setScopeId:m=Gt,insertStaticContent:_}=n,k=(S,$,W,Z=null,J=null,D=null,I=void 0,F=null,X=!!$.dynamicChildren)=>{if(S===$)return;S&&!An(S,$)&&(Z=Ye(S),be(S,J,D,!0),S=null),$.patchFlag===-2&&(X=!1,$.dynamicChildren=null);const{type:z,ref:le,shapeFlag:se}=$;switch(z){case kr:y(S,$,W,Z);break;case Zt:w(S,$,W,Z);break;case js:S==null&&h($,W,Z,I);break;case ue:B(S,$,W,Z,J,D,I,F,X);break;default:se&1?P(S,$,W,Z,J,D,I,F,X):se&6?H(S,$,W,Z,J,D,I,F,X):(se&64||se&128)&&z.process(S,$,W,Z,J,D,I,F,X,xe)}le!=null&&J&&qs(le,S&&S.ref,D,$||S,!$)},y=(S,$,W,Z)=>{if(S==null)o($.el=l($.children),W,Z);else{const J=$.el=S.el;$.children!==S.children&&u(J,$.children)}},w=(S,$,W,Z)=>{S==null?o($.el=a($.children||""),W,Z):$.el=S.el},h=(S,$,W,Z)=>{[S.el,S.anchor]=_(S.children,$,W,Z,S.el,S.anchor)},v=({el:S,anchor:$},W,Z)=>{let J;for(;S&&S!==$;)J=g(S),o(S,W,Z),S=J;o($,W,Z)},p=({el:S,anchor:$})=>{let W;for(;S&&S!==$;)W=g(S),s(S),S=W;s($)},P=(S,$,W,Z,J,D,I,F,X)=>{$.type==="svg"?I="svg":$.type==="math"&&(I="mathml"),S==null?M($,W,Z,J,D,I,F,X):O(S,$,J,D,I,F,X)},M=(S,$,W,Z,J,D,I,F)=>{let X,z;const{props:le,shapeFlag:se,transition:ae,dirs:ve}=S;if(X=S.el=i(S.type,D,le&&le.is,le),se&8?c(X,S.children):se&16&&b(S.children,X,null,Z,J,Ur(S,D),I,F),ve&&On(S,null,Z,"created"),N(X,S,S.scopeId,I,Z),le){for(const Oe in le)Oe!=="value"&&!Fo(Oe)&&r(X,Oe,null,le[Oe],D,Z);"value"in le&&r(X,"value",null,le.value,D),(z=le.onVnodeBeforeMount)&&$t(z,Z,S)}ve&&On(S,null,Z,"beforeMount");const Ce=jv(J,ae);Ce&&ae.beforeEnter(X),o(X,$,W),((z=le&&le.onVnodeMounted)||Ce||ve)&&rt(()=>{z&&$t(z,Z,S),Ce&&ae.enter(X),ve&&On(S,null,Z,"mounted")},J)},N=(S,$,W,Z,J)=>{if(W&&m(S,W),Z)for(let D=0;D<Z.length;D++)m(S,Z[D]);if(J){let D=J.subTree;if($===D||Gs(D.type)&&(D.ssContent===$||D.ssFallback===$)){const I=J.vnode;N(S,I,I.scopeId,I.slotScopeIds,J.parent)}}},b=(S,$,W,Z,J,D,I,F,X=0)=>{for(let z=X;z<S.length;z++){const le=S[z]=F?gn(S[z]):zt(S[z]);k(null,le,$,W,Z,J,D,I,F)}},O=(S,$,W,Z,J,D,I)=>{const F=$.el=S.el;let{patchFlag:X,dynamicChildren:z,dirs:le}=$;X|=S.patchFlag&16;const se=S.props||Ae,ae=$.props||Ae;let ve;if(W&&Tn(W,!1),(ve=ae.onVnodeBeforeUpdate)&&$t(ve,W,$,S),le&&On($,S,W,"beforeUpdate"),W&&Tn(W,!0),(se.innerHTML&&ae.innerHTML==null||se.textContent&&ae.textContent==null)&&c(F,""),z?T(S.dynamicChildren,z,F,W,Z,Ur($,J),D):I||G(S,$,F,null,W,Z,Ur($,J),D,!1),X>0){if(X&16)L(F,se,ae,W,J);else if(X&2&&se.class!==ae.class&&r(F,"class",null,ae.class,J),X&4&&r(F,"style",se.style,ae.style,J),X&8){const Ce=$.dynamicProps;for(let Oe=0;Oe<Ce.length;Oe++){const De=Ce[Oe],st=se[De],ct=ae[De];(ct!==st||De==="value")&&r(F,De,st,ct,J,W)}}X&1&&S.children!==$.children&&c(F,$.children)}else!I&&z==null&&L(F,se,ae,W,J);((ve=ae.onVnodeUpdated)||le)&&rt(()=>{ve&&$t(ve,W,$,S),le&&On($,S,W,"updated")},Z)},T=(S,$,W,Z,J,D,I)=>{for(let F=0;F<$.length;F++){const X=S[F],z=$[F],le=X.el&&(X.type===ue||!An(X,z)||X.shapeFlag&70)?f(X.el):W;k(X,z,le,null,Z,J,D,I,!0)}},L=(S,$,W,Z,J)=>{if($!==W){if($!==Ae)for(const D in $)!Fo(D)&&!(D in W)&&r(S,D,$[D],null,J,Z);for(const D in W){if(Fo(D))continue;const I=W[D],F=$[D];I!==F&&D!=="value"&&r(S,D,F,I,J,Z)}"value"in W&&r(S,"value",$.value,W.value,J)}},B=(S,$,W,Z,J,D,I,F,X)=>{const z=$.el=S?S.el:l(""),le=$.anchor=S?S.anchor:l("");let{patchFlag:se,dynamicChildren:ae,slotScopeIds:ve}=$;ve&&(F=F?F.concat(ve):ve),S==null?(o(z,W,Z),o(le,W,Z),b($.children||[],W,le,J,D,I,F,X)):se>0&&se&64&&ae&&S.dynamicChildren?(T(S.dynamicChildren,ae,W,J,D,I,F),($.key!=null||J&&$===J.subTree)&&ua(S,$,!0)):G(S,$,W,le,J,D,I,F,X)},H=(S,$,W,Z,J,D,I,F,X)=>{$.slotScopeIds=F,S==null?$.shapeFlag&512?J.ctx.activate($,W,Z,I,X):ee($,W,Z,J,D,I,X):Y(S,$,X)},ee=(S,$,W,Z,J,D,I)=>{const F=S.component=Gv(S,Z,J);if(ra(S)&&(F.ctx.renderer=xe),Kv(F,!1,I),F.asyncDep){if(J&&J.registerDep(F,x,I),!S.el){const X=F.subTree=q(Zt);w(null,X,$,W)}}else x(F,S,$,W,J,D,I)},Y=(S,$,W)=>{const Z=$.component=S.component;if(Nv(S,$,W))if(Z.asyncDep&&!Z.asyncResolved){A(Z,$,W);return}else Z.next=$,Z.update();else $.el=S.el,Z.vnode=$},x=(S,$,W,Z,J,D,I)=>{const F=()=>{if(S.isMounted){let{next:se,bu:ae,u:ve,parent:Ce,vnode:Oe}=S;{const Vt=_f(S);if(Vt){se&&(se.el=Oe.el,A(S,se,I)),Vt.asyncDep.then(()=>{S.isUnmounted||F()});return}}let De=se,st;Tn(S,!1),se?(se.el=Oe.el,A(S,se,I)):se=Oe,ae&&to(ae),(st=se.props&&se.props.onVnodeBeforeUpdate)&&$t(st,Ce,se,Oe),Tn(S,!0);const ct=au(S),mt=S.subTree;S.subTree=ct,k(mt,ct,f(mt.el),Ye(mt),S,J,D),se.el=ct.el,De===null&&Hv(S,ct.el),ve&&rt(ve,J),(st=se.props&&se.props.onVnodeUpdated)&&rt(()=>$t(st,Ce,se,Oe),J)}else{let se;const{el:ae,props:ve}=$,{bm:Ce,m:Oe,parent:De,root:st,type:ct}=S,mt=Dn($);Tn(S,!1),Ce&&to(Ce),!mt&&(se=ve&&ve.onVnodeBeforeMount)&&$t(se,De,$),Tn(S,!0);{st.ce&&st.ce._injectChildStyle(ct);const Vt=S.subTree=au(S);k(null,Vt,W,Z,S,J,D),$.el=Vt.el}if(Oe&&rt(Oe,J),!mt&&(se=ve&&ve.onVnodeMounted)){const Vt=$;rt(()=>$t(se,De,Vt),J)}($.shapeFlag&256||De&&Dn(De.vnode)&&De.vnode.shapeFlag&256)&&S.a&&rt(S.a,J),S.isMounted=!0,$=W=Z=null}};S.scope.on();const X=S.effect=new Id(F);S.scope.off();const z=S.update=X.run.bind(X),le=S.job=X.runIfDirty.bind(X);le.i=S,le.id=S.uid,X.scheduler=()=>na(le),Tn(S,!0),z()},A=(S,$,W)=>{$.component=S;const Z=S.vnode.props;S.vnode=$,S.next=null,_v(S,$.props,Z,W),Ov(S,$.children,W),_n(),Za(S),xn()},G=(S,$,W,Z,J,D,I,F,X=!1)=>{const z=S&&S.children,le=S?S.shapeFlag:0,se=$.children,{patchFlag:ae,shapeFlag:ve}=$;if(ae>0){if(ae&128){K(z,se,W,Z,J,D,I,F,X);return}else if(ae&256){Ie(z,se,W,Z,J,D,I,F,X);return}}ve&8?(le&16&&Xe(z,J,D),se!==z&&c(W,se)):le&16?ve&16?K(z,se,W,Z,J,D,I,F,X):Xe(z,J,D,!0):(le&8&&c(W,""),ve&16&&b(se,W,Z,J,D,I,F,X))},Ie=(S,$,W,Z,J,D,I,F,X)=>{S=S||Qn,$=$||Qn;const z=S.length,le=$.length,se=Math.min(z,le);let ae;for(ae=0;ae<se;ae++){const ve=$[ae]=X?gn($[ae]):zt($[ae]);k(S[ae],ve,W,null,J,D,I,F,X)}z>le?Xe(S,J,D,!0,!1,se):b($,W,Z,J,D,I,F,X,se)},K=(S,$,W,Z,J,D,I,F,X)=>{let z=0;const le=$.length;let se=S.length-1,ae=le-1;for(;z<=se&&z<=ae;){const ve=S[z],Ce=$[z]=X?gn($[z]):zt($[z]);if(An(ve,Ce))k(ve,Ce,W,null,J,D,I,F,X);else break;z++}for(;z<=se&&z<=ae;){const ve=S[se],Ce=$[ae]=X?gn($[ae]):zt($[ae]);if(An(ve,Ce))k(ve,Ce,W,null,J,D,I,F,X);else break;se--,ae--}if(z>se){if(z<=ae){const ve=ae+1,Ce=ve<le?$[ve].el:Z;for(;z<=ae;)k(null,$[z]=X?gn($[z]):zt($[z]),W,Ce,J,D,I,F,X),z++}}else if(z>ae)for(;z<=se;)be(S[z],J,D,!0),z++;else{const ve=z,Ce=z,Oe=new Map;for(z=Ce;z<=ae;z++){const wt=$[z]=X?gn($[z]):zt($[z]);wt.key!=null&&Oe.set(wt.key,z)}let De,st=0;const ct=ae-Ce+1;let mt=!1,Vt=0;const xo=new Array(ct);for(z=0;z<ct;z++)xo[z]=0;for(z=ve;z<=se;z++){const wt=S[z];if(st>=ct){be(wt,J,D,!0);continue}let Ft;if(wt.key!=null)Ft=Oe.get(wt.key);else for(De=Ce;De<=ae;De++)if(xo[De-Ce]===0&&An(wt,$[De])){Ft=De;break}Ft===void 0?be(wt,J,D,!0):(xo[Ft-Ce]=z+1,Ft>=Vt?Vt=Ft:mt=!0,k(wt,$[Ft],W,null,J,D,I,F,X),st++)}const za=mt?Rv(xo):Qn;for(De=za.length-1,z=ct-1;z>=0;z--){const wt=Ce+z,Ft=$[wt],Xa=wt+1<le?$[wt+1].el:Z;xo[z]===0?k(null,Ft,W,Xa,J,D,I,F,X):mt&&(De<0||z!==za[De]?ie(Ft,W,Xa,2):De--)}}},ie=(S,$,W,Z,J=null)=>{const{el:D,type:I,transition:F,children:X,shapeFlag:z}=S;if(z&6){ie(S.component.subTree,$,W,Z);return}if(z&128){S.suspense.move($,W,Z);return}if(z&64){I.move(S,$,W,xe);return}if(I===ue){o(D,$,W);for(let se=0;se<X.length;se++)ie(X[se],$,W,Z);o(S.anchor,$,W);return}if(I===js){v(S,$,W);return}if(Z!==2&&z&1&&F)if(Z===0)F.beforeEnter(D),o(D,$,W),rt(()=>F.enter(D),J);else{const{leave:se,delayLeave:ae,afterLeave:ve}=F,Ce=()=>o(D,$,W),Oe=()=>{se(D,()=>{Ce(),ve&&ve()})};ae?ae(D,Ce,Oe):Oe()}else o(D,$,W)},be=(S,$,W,Z=!1,J=!1)=>{const{type:D,props:I,ref:F,children:X,dynamicChildren:z,shapeFlag:le,patchFlag:se,dirs:ae,cacheIndex:ve}=S;if(se===-2&&(J=!1),F!=null&&qs(F,null,W,S,!0),ve!=null&&($.renderCache[ve]=void 0),le&256){$.ctx.deactivate(S);return}const Ce=le&1&&ae,Oe=!Dn(S);let De;if(Oe&&(De=I&&I.onVnodeBeforeUnmount)&&$t(De,$,S),le&6)nt(S.component,W,Z);else{if(le&128){S.suspense.unmount(W,Z);return}Ce&&On(S,null,$,"beforeUnmount"),le&64?S.type.remove(S,$,W,xe,Z):z&&!z.hasOnce&&(D!==ue||se>0&&se&64)?Xe(z,$,W,!1,!0):(D===ue&&se&384||!J&&le&16)&&Xe(X,$,W),Z&&Me(S)}(Oe&&(De=I&&I.onVnodeUnmounted)||Ce)&&rt(()=>{De&&$t(De,$,S),Ce&&On(S,null,$,"unmounted")},W)},Me=S=>{const{type:$,el:W,anchor:Z,transition:J}=S;if($===ue){ye(W,Z);return}if($===js){p(S);return}const D=()=>{s(W),J&&!J.persisted&&J.afterLeave&&J.afterLeave()};if(S.shapeFlag&1&&J&&!J.persisted){const{leave:I,delayLeave:F}=J,X=()=>I(W,D);F?F(S.el,D,X):X()}else D()},ye=(S,$)=>{let W;for(;S!==$;)W=g(S),s(S),S=W;s($)},nt=(S,$,W)=>{const{bum:Z,scope:J,job:D,subTree:I,um:F,m:X,a:z}=S;Ys(X),Ys(z),Z&&to(Z),J.stop(),D&&(D.flags|=8,be(I,S,$,W)),F&&rt(F,$),rt(()=>{S.isUnmounted=!0},$),$&&$.pendingBranch&&!$.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===$.pendingId&&($.deps--,$.deps===0&&$.resolve())},Xe=(S,$,W,Z=!1,J=!1,D=0)=>{for(let I=D;I<S.length;I++)be(S[I],$,W,Z,J)},Ye=S=>{if(S.shapeFlag&6)return Ye(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const $=g(S.anchor||S.el),W=$&&$[tf];return W?g(W):$};let oe=!1;const we=(S,$,W)=>{S==null?$._vnode&&be($._vnode,null,null,!0):k($._vnode||null,S,$,null,null,null,W),$._vnode=S,oe||(oe=!0,Za(),Zd(),oe=!1)},xe={p:k,um:be,m:ie,r:Me,mt:ee,mc:b,pc:G,pbc:T,n:Ye,o:n};return{render:we,hydrate:void 0,createApp:kv(we)}}function Ur({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Tn({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function jv(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function ua(n,t,e=!1){const o=n.children,s=t.children;if(me(o)&&me(s))for(let r=0;r<o.length;r++){const i=o[r];let l=s[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[r]=gn(s[r]),l.el=i.el),!e&&l.patchFlag!==-2&&ua(i,l)),l.type===kr&&(l.el=i.el)}}function Rv(n){const t=n.slice(),e=[0];let o,s,r,i,l;const a=n.length;for(o=0;o<a;o++){const u=n[o];if(u!==0){if(s=e[e.length-1],n[s]<u){t[o]=s,e.push(o);continue}for(r=0,i=e.length-1;r<i;)l=r+i>>1,n[e[l]]<u?r=l+1:i=l;u<n[e[r]]&&(r>0&&(t[o]=e[r-1]),e[r]=o)}}for(r=e.length,i=e[r-1];r-- >0;)e[r]=i,i=t[i];return e}function _f(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_f(t)}function Ys(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const Av=Symbol.for("v-scx"),Iv=()=>Lt(Av);function Mv(n,t){return ca(n,null,{flush:"sync"})}function ze(n,t,e){return ca(n,t,e)}function ca(n,t,e=Ae){const{immediate:o,deep:s,flush:r,once:i}=e,l=ot({},e),a=t&&o||!t&&r!=="post";let u;if(ao){if(r==="sync"){const m=Iv();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!a){const m=()=>{};return m.stop=Gt,m.resume=Gt,m.pause=Gt,m}}const c=at;l.call=(m,_,k)=>Ht(m,c,_,k);let f=!1;r==="post"?l.scheduler=m=>{rt(m,c&&c.suspense)}:r!=="sync"&&(f=!0,l.scheduler=(m,_)=>{_?m():na(m)}),l.augmentJob=m=>{t&&(m.flags|=4),f&&(m.flags|=2,c&&(m.id=c.uid,m.i=c))};const g=Xh(n,t,l);return ao&&(u?u.push(g):a&&g()),g}function Dv(n,t,e){const o=this.proxy,s=Ze(n)?n.includes(".")?xf(o,n):()=>o[n]:n.bind(o,o);let r;ke(t)?r=t:(r=t.handler,e=t);const i=vs(this),l=ca(s,r.bind(o),e);return i(),l}function xf(n,t){const e=t.split(".");return()=>{let o=n;for(let s=0;s<e.length&&o;s++)o=o[e[s]];return o}}function hs(n,t,e=Ae){const o=Cr(),s=rn(t),r=an(t),i=Sf(n,s),l=Fh((a,u)=>{let c,f=Ae,g;return Mv(()=>{const m=n[s];bt(c,m)&&(c=m,u())}),{get(){return a(),e.get?e.get(c):c},set(m){const _=e.set?e.set(m):m;if(!bt(_,c)&&!(f!==Ae&&bt(m,f)))return;const k=o.vnode.props;k&&(t in k||s in k||r in k)&&(`onUpdate:${t}`in k||`onUpdate:${s}`in k||`onUpdate:${r}`in k)||(c=m,u()),o.emit(`update:${t}`,_),bt(m,_)&&bt(m,f)&&!bt(_,g)&&u(),f=m,g=_}}});return l[Symbol.iterator]=()=>{let a=0;return{next(){return a<2?{value:a++?i||Ae:l,done:!1}:{done:!0}}}},l}const Sf=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${rn(t)}Modifiers`]||n[`${an(t)}Modifiers`];function Bv(n,t,...e){if(n.isUnmounted)return;const o=n.vnode.props||Ae;let s=e;const r=t.startsWith("update:"),i=r&&Sf(o,t.slice(7));i&&(i.trim&&(s=e.map(c=>Ze(c)?c.trim():c)),i.number&&(s=e.map(Ws)));let l,a=o[l=Br(t)]||o[l=Br(rn(t))];!a&&r&&(a=o[l=Br(an(t))]),a&&Ht(a,n,6,s);const u=o[l+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[l])return;n.emitted[l]=!0,Ht(u,n,6,s)}}function Pf(n,t,e=!1){const o=t.emitsCache,s=o.get(n);if(s!==void 0)return s;const r=n.emits;let i={},l=!1;if(!ke(n)){const a=u=>{const c=Pf(u,t,!0);c&&(l=!0,ot(i,c))};!e&&t.mixins.length&&t.mixins.forEach(a),n.extends&&a(n.extends),n.mixins&&n.mixins.forEach(a)}return!r&&!l?(Fe(n)&&o.set(n,null),null):(me(r)?r.forEach(a=>i[a]=null):ot(i,r),Fe(n)&&o.set(n,i),i)}function wr(n,t){return!n||!hr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Le(n,t[0].toLowerCase()+t.slice(1))||Le(n,an(t))||Le(n,t))}function au(n){const{type:t,vnode:e,proxy:o,withProxy:s,propsOptions:[r],slots:i,attrs:l,emit:a,render:u,renderCache:c,props:f,data:g,setupState:m,ctx:_,inheritAttrs:k}=n,y=Us(n);let w,h;try{if(e.shapeFlag&4){const p=s||o,P=p;w=zt(u.call(P,p,c,f,m,g,_)),h=l}else{const p=t;w=zt(p.length>1?p(f,{attrs:l,slots:i,emit:a}):p(f,null)),h=t.props?l:Ev(l)}}catch(p){Yo.length=0,ps(p,n,1),w=q(Zt)}let v=w;if(h&&k!==!1){const p=Object.keys(h),{shapeFlag:P}=v;p.length&&P&7&&(r&&p.some(zl)&&(h=Lv(h,r)),v=Cn(v,h,!1,!0))}return e.dirs&&(v=Cn(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(e.dirs):e.dirs),e.transition&&io(v,e.transition),w=v,Us(y),w}const Ev=n=>{let t;for(const e in n)(e==="class"||e==="style"||hr(e))&&((t||(t={}))[e]=n[e]);return t},Lv=(n,t)=>{const e={};for(const o in n)(!zl(o)||!(o.slice(9)in t))&&(e[o]=n[o]);return e};function Nv(n,t,e){const{props:o,children:s,component:r}=n,{props:i,children:l,patchFlag:a}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&a>=0){if(a&1024)return!0;if(a&16)return o?uu(o,i,u):!!i;if(a&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const g=c[f];if(i[g]!==o[g]&&!wr(u,g))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:o===i?!1:o?i?uu(o,i,u):!0:!!i;return!1}function uu(n,t,e){const o=Object.keys(t);if(o.length!==Object.keys(n).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(t[r]!==n[r]&&!wr(e,r))return!0}return!1}function Hv({vnode:n,parent:t},e){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===n&&(o.el=n.el),o===n)(n=t.vnode).el=e,t=t.parent;else break}}const Gs=n=>n.__isSuspense;function Wv(n,t){t&&t.pendingBranch?me(n)?t.effects.push(...n):t.effects.push(n):Kh(n)}const ue=Symbol.for("v-fgt"),kr=Symbol.for("v-txt"),Zt=Symbol.for("v-cmt"),js=Symbol.for("v-stc"),Yo=[];let xt=null;function j(n=!1){Yo.push(xt=n?null:[])}function Vv(){Yo.pop(),xt=Yo[Yo.length-1]||null}let rs=1;function cu(n,t=!1){rs+=n,n<0&&xt&&t&&(xt.hasOnce=!0)}function Of(n){return n.dynamicChildren=rs>0?xt||Qn:null,Vv(),rs>0&&xt&&xt.push(n),n}function U(n,t,e,o,s,r){return Of(d(n,t,e,o,s,r,!0))}function ce(n,t,e,o,s){return Of(q(n,t,e,o,s,!0))}function lo(n){return n?n.__v_isVNode===!0:!1}function An(n,t){return n.type===t.type&&n.key===t.key}const Tf=({key:n})=>n??null,Rs=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Ze(n)||ge(n)||ke(n)?{i:ut,r:n,k:t,f:!!e}:n:null);function d(n,t=null,e=null,o=0,s=null,r=n===ue?0:1,i=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Tf(t),ref:t&&Rs(t),scopeId:ef,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ut};return l?(da(a,e),r&128&&n.normalize(a)):e&&(a.shapeFlag|=Ze(e)?8:16),rs>0&&!i&&xt&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&xt.push(a),a}const q=Fv;function Fv(n,t=null,e=null,o=0,s=null,r=!1){if((!n||n===pv)&&(n=Zt),lo(n)){const l=Cn(n,t,!0);return e&&da(l,e),rs>0&&!r&&xt&&(l.shapeFlag&6?xt[xt.indexOf(n)]=l:xt.push(l)),l.patchFlag=-2,l}if(eg(n)&&(n=n.__vccOpts),t){t=Uv(t);let{class:l,style:a}=t;l&&!Ze(l)&&(t.class=He(l)),Fe(a)&&(ta(a)&&!me(a)&&(a=ot({},a)),t.style=tt(a))}const i=Ze(n)?1:Gs(n)?128:Jh(n)?64:Fe(n)?4:ke(n)?2:0;return d(n,t,e,o,s,i,r,!0)}function Uv(n){return n?ta(n)||gf(n)?ot({},n):n:null}function Cn(n,t,e=!1,o=!1){const{props:s,ref:r,patchFlag:i,children:l,transition:a}=n,u=t?zv(s||{},t):s,c={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&Tf(u),ref:t&&t.ref?e&&r?me(r)?r.concat(Rs(t)):[r,Rs(t)]:Rs(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==ue?i===-1?16:i|16:i,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:a,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Cn(n.ssContent),ssFallback:n.ssFallback&&Cn(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return a&&o&&io(c,a.clone(c)),c}function te(n=" ",t=0){return q(kr,null,n,t)}function qv(n,t){const e=q(js,null,n);return e.staticCount=t,e}function de(n="",t=!1){return t?(j(),ce(Zt,null,n)):q(Zt,null,n)}function zt(n){return n==null||typeof n=="boolean"?q(Zt):me(n)?q(ue,null,n.slice()):lo(n)?gn(n):q(kr,null,String(n))}function gn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Cn(n)}function da(n,t){let e=0;const{shapeFlag:o}=n;if(t==null)t=null;else if(me(t))e=16;else if(typeof t=="object")if(o&65){const s=t.default;s&&(s._c&&(s._d=!1),da(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!gf(t)?t._ctx=ut:s===3&&ut&&(ut.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else ke(t)?(t={default:t,_ctx:ut},e=32):(t=String(t),o&64?(e=16,t=[te(t)]):e=8);n.children=t,n.shapeFlag|=e}function zv(...n){const t={};for(let e=0;e<n.length;e++){const o=n[e];for(const s in o)if(s==="class")t.class!==o.class&&(t.class=He([t.class,o.class]));else if(s==="style")t.style=tt([t.style,o.style]);else if(hr(s)){const r=t[s],i=o[s];i&&r!==i&&!(me(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=o[s])}return t}function $t(n,t,e,o=null){Ht(n,t,7,[e,o])}const Xv=ff();let Yv=0;function Gv(n,t,e){const o=n.type,s=(t?t.appContext:n.appContext)||Xv,r={uid:Yv++,vnode:n,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new bh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bf(o,s),emitsOptions:Pf(o,s),emit:null,emitted:null,propsDefaults:Ae,inheritAttrs:o.inheritAttrs,ctx:Ae,data:Ae,props:Ae,attrs:Ae,slots:Ae,refs:Ae,setupState:Ae,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Bv.bind(null,r),n.ce&&n.ce(r),r}let at=null;const Cr=()=>at||ut;let Ks,$l;{const n=gr(),t=(e,o)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(o),r=>{s.length>1?s.forEach(i=>i(r)):s[0](r)}};Ks=t("__VUE_INSTANCE_SETTERS__",e=>at=e),$l=t("__VUE_SSR_SETTERS__",e=>ao=e)}const vs=n=>{const t=at;return Ks(n),n.scope.on(),()=>{n.scope.off(),Ks(t)}},du=()=>{at&&at.scope.off(),Ks(null)};function $f(n){return n.vnode.shapeFlag&4}let ao=!1;function Kv(n,t=!1,e=!1){t&&$l(t);const{props:o,children:s}=n.vnode,r=$f(n);Cv(n,o,r,t),Pv(n,s,e);const i=r?Jv(n,t):void 0;return t&&$l(!1),i}function Jv(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,hv);const{setup:o}=e;if(o){_n();const s=n.setupContext=o.length>1?Qv(n):null,r=vs(n),i=fs(o,n,0,[n.props,s]),l=Sd(i);if(xn(),r(),(l||n.sp)&&!Dn(n)&&sa(n),l){if(i.then(du,du),t)return i.then(a=>{fu(n,a)}).catch(a=>{ps(a,n,0)});n.asyncDep=i}else fu(n,i)}else jf(n)}function fu(n,t,e){ke(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Fe(t)&&(n.setupState=Gd(t)),jf(n)}function jf(n,t,e){const o=n.type;n.render||(n.render=o.render||Gt);{const s=vs(n);_n();try{vv(n)}finally{xn(),s()}}}const Zv={get(n,t){return ft(n,"get",""),n[t]}};function Qv(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,Zv),slots:n.slots,emit:n.emit,expose:t}}function _r(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Gd(yt(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Xo)return Xo[e](n)},has(t,e){return e in t||e in Xo}})):n.proxy}function pu(n,t=!0){return ke(n)?n.displayName||n.name:n.name||t&&n.__name}function eg(n){return ke(n)&&"__vccOpts"in n}const E=(n,t)=>qh(n,t,ao);function hu(n,t,e){const o=arguments.length;return o===2?Fe(t)&&!me(t)?lo(t)?q(n,null,[t]):q(n,t):q(n,null,t):(o>3?e=Array.prototype.slice.call(arguments,2):o===3&&lo(e)&&(e=[e]),q(n,t,e))}const tg="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jl;const vu=typeof window<"u"&&window.trustedTypes;if(vu)try{jl=vu.createPolicy("vue",{createHTML:n=>n})}catch{}const Rf=jl?n=>jl.createHTML(n):n=>n,ng="http://www.w3.org/2000/svg",og="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,gu=en&&en.createElement("template"),sg={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,o)=>{const s=t==="svg"?en.createElementNS(ng,n):t==="mathml"?en.createElementNS(og,n):e?en.createElement(n,{is:e}):en.createElement(n);return n==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:n=>en.createTextNode(n),createComment:n=>en.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>en.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,o,s,r){const i=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{gu.innerHTML=Rf(o==="svg"?`<svg>${n}</svg>`:o==="mathml"?`<math>${n}</math>`:n);const l=gu.content;if(o==="svg"||o==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}t.insertBefore(l,e)}return[i?i.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},cn="transition",Po="animation",uo=Symbol("_vtc"),Af={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},rg=ot({},ev,Af),$n=(n,t=[])=>{me(n)?n.forEach(e=>e(...t)):n&&n(...t)},mu=n=>n?me(n)?n.some(t=>t.length>1):n.length>1:!1;function ig(n){const t={};for(const B in n)B in Af||(t[B]=n[B]);if(n.css===!1)return t;const{name:e="v",type:o,duration:s,enterFromClass:r=`${e}-enter-from`,enterActiveClass:i=`${e}-enter-active`,enterToClass:l=`${e}-enter-to`,appearFromClass:a=r,appearActiveClass:u=i,appearToClass:c=l,leaveFromClass:f=`${e}-leave-from`,leaveActiveClass:g=`${e}-leave-active`,leaveToClass:m=`${e}-leave-to`}=n,_=lg(s),k=_&&_[0],y=_&&_[1],{onBeforeEnter:w,onEnter:h,onEnterCancelled:v,onLeave:p,onLeaveCancelled:P,onBeforeAppear:M=w,onAppear:N=h,onAppearCancelled:b=v}=t,O=(B,H,ee,Y)=>{B._enterCancelled=Y,pn(B,H?c:l),pn(B,H?u:i),ee&&ee()},T=(B,H)=>{B._isLeaving=!1,pn(B,f),pn(B,m),pn(B,g),H&&H()},L=B=>(H,ee)=>{const Y=B?N:h,x=()=>O(H,B,ee);$n(Y,[H,x]),bu(()=>{pn(H,B?a:r),Ut(H,B?c:l),mu(Y)||yu(H,o,k,x)})};return ot(t,{onBeforeEnter(B){$n(w,[B]),Ut(B,r),Ut(B,i)},onBeforeAppear(B){$n(M,[B]),Ut(B,a),Ut(B,u)},onEnter:L(!1),onAppear:L(!0),onLeave(B,H){B._isLeaving=!0;const ee=()=>T(B,H);Ut(B,f),B._enterCancelled?(Ut(B,g),Rl()):(Rl(),Ut(B,g)),bu(()=>{B._isLeaving&&(pn(B,f),Ut(B,m),mu(p)||yu(B,o,y,ee))}),$n(p,[B,ee])},onEnterCancelled(B){O(B,!1,void 0,!0),$n(v,[B])},onAppearCancelled(B){O(B,!0,void 0,!0),$n(b,[B])},onLeaveCancelled(B){T(B),$n(P,[B])}})}function lg(n){if(n==null)return null;if(Fe(n))return[qr(n.enter),qr(n.leave)];{const t=qr(n);return[t,t]}}function qr(n){return ch(n)}function Ut(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[uo]||(n[uo]=new Set)).add(t)}function pn(n,t){t.split(/\s+/).forEach(o=>o&&n.classList.remove(o));const e=n[uo];e&&(e.delete(t),e.size||(n[uo]=void 0))}function bu(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let ag=0;function yu(n,t,e,o){const s=n._endId=++ag,r=()=>{s===n._endId&&o()};if(e!=null)return setTimeout(r,e);const{type:i,timeout:l,propCount:a}=If(n,t);if(!i)return o();const u=i+"end";let c=0;const f=()=>{n.removeEventListener(u,g),r()},g=m=>{m.target===n&&++c>=a&&f()};setTimeout(()=>{c<a&&f()},l+1),n.addEventListener(u,g)}function If(n,t){const e=window.getComputedStyle(n),o=_=>(e[_]||"").split(", "),s=o(`${cn}Delay`),r=o(`${cn}Duration`),i=wu(s,r),l=o(`${Po}Delay`),a=o(`${Po}Duration`),u=wu(l,a);let c=null,f=0,g=0;t===cn?i>0&&(c=cn,f=i,g=r.length):t===Po?u>0&&(c=Po,f=u,g=a.length):(f=Math.max(i,u),c=f>0?i>u?cn:Po:null,g=c?c===cn?r.length:a.length:0);const m=c===cn&&/\b(transform|all)(,|$)/.test(o(`${cn}Property`).toString());return{type:c,timeout:f,propCount:g,hasTransform:m}}function wu(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,o)=>ku(e)+ku(n[o])))}function ku(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function Rl(){return document.body.offsetHeight}function ug(n,t,e){const o=n[uo];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const Cu=Symbol("_vod"),cg=Symbol("_vsh"),dg=Symbol(""),fg=/(^|;)\s*display\s*:/;function pg(n,t,e){const o=n.style,s=Ze(e);let r=!1;if(e&&!s){if(t)if(Ze(t))for(const i of t.split(";")){const l=i.slice(0,i.indexOf(":")).trim();e[l]==null&&As(o,l,"")}else for(const i in t)e[i]==null&&As(o,i,"");for(const i in e)i==="display"&&(r=!0),As(o,i,e[i])}else if(s){if(t!==e){const i=o[dg];i&&(e+=";"+i),o.cssText=e,r=fg.test(e)}}else t&&n.removeAttribute("style");Cu in n&&(n[Cu]=r?o.display:"",n[cg]&&(o.display="none"))}const _u=/\s*!important$/;function As(n,t,e){if(me(e))e.forEach(o=>As(n,t,o));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const o=hg(n,t);_u.test(e)?n.setProperty(an(o),e.replace(_u,""),"important"):n[o]=e}}const xu=["Webkit","Moz","ms"],zr={};function hg(n,t){const e=zr[t];if(e)return e;let o=rn(t);if(o!=="filter"&&o in n)return zr[t]=o;o=Td(o);for(let s=0;s<xu.length;s++){const r=xu[s]+o;if(r in n)return zr[t]=r}return t}const Su="http://www.w3.org/1999/xlink";function Pu(n,t,e,o,s,r=gh(t)){o&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(Su,t.slice(6,t.length)):n.setAttributeNS(Su,t,e):e==null||r&&!jd(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Nt(e)?String(e):e)}function Ou(n,t,e,o,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Rf(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?n.getAttribute("value")||"":n.value,a=e==null?n.type==="checkbox"?"on":"":String(e);(l!==a||!("_value"in n))&&(n.value=a),e==null&&n.removeAttribute(t),n._value=e;return}let i=!1;if(e===""||e==null){const l=typeof n[t];l==="boolean"?e=jd(e):e==null&&l==="string"?(e="",i=!0):l==="number"&&(e=0,i=!0)}try{n[t]=e}catch{}i&&n.removeAttribute(s||t)}function mn(n,t,e,o){n.addEventListener(t,e,o)}function vg(n,t,e,o){n.removeEventListener(t,e,o)}const Tu=Symbol("_vei");function gg(n,t,e,o,s=null){const r=n[Tu]||(n[Tu]={}),i=r[t];if(o&&i)i.value=o;else{const[l,a]=mg(t);if(o){const u=r[t]=wg(o,s);mn(n,l,u,a)}else i&&(vg(n,l,i,a),r[t]=void 0)}}const $u=/(?:Once|Passive|Capture)$/;function mg(n){let t;if($u.test(n)){t={};let o;for(;o=n.match($u);)n=n.slice(0,n.length-o[0].length),t[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):an(n.slice(2)),t]}let Xr=0;const bg=Promise.resolve(),yg=()=>Xr||(bg.then(()=>Xr=0),Xr=Date.now());function wg(n,t){const e=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=e.attached)return;Ht(kg(o,e.value),t,5,[o])};return e.value=n,e.attached=yg(),e}function kg(n,t){if(me(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}const ju=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Cg=(n,t,e,o,s,r)=>{const i=s==="svg";t==="class"?ug(n,o,i):t==="style"?pg(n,e,o):hr(t)?zl(t)||gg(n,t,e,o,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):_g(n,t,o,i))?(Ou(n,t,o),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Pu(n,t,o,i,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Ze(o))?Ou(n,rn(t),o,r,t):(t==="true-value"?n._trueValue=o:t==="false-value"&&(n._falseValue=o),Pu(n,t,o,i))};function _g(n,t,e,o){if(o)return!!(t==="innerHTML"||t==="textContent"||t in n&&ju(t)&&ke(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return ju(t)&&Ze(e)?!1:t in n}const Mf=new WeakMap,Df=new WeakMap,Js=Symbol("_moveCb"),Ru=Symbol("_enterCb"),xg=n=>(delete n.props.mode,n),Sg=xg({name:"TransitionGroup",props:ot({},rg,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=Cr(),o=Qh();let s,r;return ia(()=>{if(!s.length)return;const i=n.moveClass||`${n.name||"v"}-move`;if(!$g(s[0].el,e.vnode.el,i))return;s.forEach(Pg),s.forEach(Og);const l=s.filter(Tg);Rl(),l.forEach(a=>{const u=a.el,c=u.style;Ut(u,i),c.transform=c.webkitTransform=c.transitionDuration="";const f=u[Js]=g=>{g&&g.target!==u||(!g||/transform$/.test(g.propertyName))&&(u.removeEventListener("transitionend",f),u[Js]=null,pn(u,i))};u.addEventListener("transitionend",f)})}),()=>{const i=Be(n),l=ig(i);let a=i.tag||ue;if(s=[],r)for(let u=0;u<r.length;u++){const c=r[u];c.el&&c.el instanceof Element&&(s.push(c),io(c,xl(c,l,o,e)),Mf.set(c,c.el.getBoundingClientRect()))}r=t.default?sf(t.default()):[];for(let u=0;u<r.length;u++){const c=r[u];c.key!=null&&io(c,xl(c,l,o,e))}return q(a,null,r)}}}),ex=Sg;function Pg(n){const t=n.el;t[Js]&&t[Js](),t[Ru]&&t[Ru]()}function Og(n){Df.set(n,n.el.getBoundingClientRect())}function Tg(n){const t=Mf.get(n),e=Df.get(n),o=t.left-e.left,s=t.top-e.top;if(o||s){const r=n.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",n}}function $g(n,t,e){const o=n.cloneNode(),s=n[uo];s&&s.forEach(l=>{l.split(/\s+/).forEach(a=>a&&o.classList.remove(a))}),e.split(/\s+/).forEach(l=>l&&o.classList.add(l)),o.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(o);const{hasTransform:i}=If(o);return r.removeChild(o),i}const co=n=>{const t=n.props["onUpdate:modelValue"]||!1;return me(t)?e=>to(t,e):t};function jg(n){n.target.composing=!0}function Au(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const sn=Symbol("_assign"),Je={created(n,{modifiers:{lazy:t,trim:e,number:o}},s){n[sn]=co(s);const r=o||s.props&&s.props.type==="number";mn(n,t?"change":"input",i=>{if(i.target.composing)return;let l=n.value;e&&(l=l.trim()),r&&(l=Ws(l)),n[sn](l)}),e&&mn(n,"change",()=>{n.value=n.value.trim()}),t||(mn(n,"compositionstart",jg),mn(n,"compositionend",Au),mn(n,"change",Au))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:o,trim:s,number:r}},i){if(n[sn]=co(i),n.composing)return;const l=(r||n.type==="number")&&!/^0\d/.test(n.value)?Ws(n.value):n.value,a=t??"";l!==a&&(document.activeElement===n&&n.type!=="range"&&(o&&t===e||s&&n.value.trim()===a)||(n.value=a))}},Rg={deep:!0,created(n,t,e){n[sn]=co(e),mn(n,"change",()=>{const o=n._modelValue,s=is(n),r=n.checked,i=n[sn];if(me(o)){const l=Gl(o,s),a=l!==-1;if(r&&!a)i(o.concat(s));else if(!r&&a){const u=[...o];u.splice(l,1),i(u)}}else if(mo(o)){const l=new Set(o);r?l.add(s):l.delete(s),i(l)}else i(Bf(n,r))})},mounted:Iu,beforeUpdate(n,t,e){n[sn]=co(e),Iu(n,t,e)}};function Iu(n,{value:t,oldValue:e},o){n._modelValue=t;let s;if(me(t))s=Gl(t,o.props.value)>-1;else if(mo(t))s=t.has(o.props.value);else{if(t===e)return;s=ds(t,Bf(n,!0))}n.checked!==s&&(n.checked=s)}const St={deep:!0,created(n,{value:t,modifiers:{number:e}},o){const s=mo(t);mn(n,"change",()=>{const r=Array.prototype.filter.call(n.options,i=>i.selected).map(i=>e?Ws(is(i)):is(i));n[sn](n.multiple?s?new Set(r):r:r[0]),n._assigning=!0,yn(()=>{n._assigning=!1})}),n[sn]=co(o)},mounted(n,{value:t}){Mu(n,t)},beforeUpdate(n,t,e){n[sn]=co(e)},updated(n,{value:t}){n._assigning||Mu(n,t)}};function Mu(n,t){const e=n.multiple,o=me(t);if(!(e&&!o&&!mo(t))){for(let s=0,r=n.options.length;s<r;s++){const i=n.options[s],l=is(i);if(e)if(o){const a=typeof l;a==="string"||a==="number"?i.selected=t.some(u=>String(u)===String(l)):i.selected=Gl(t,l)>-1}else i.selected=t.has(l);else if(ds(is(i),t)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function is(n){return"_value"in n?n._value:n.value}function Bf(n,t){const e=t?"_trueValue":"_falseValue";return e in n?n[e]:t}const Ag=["ctrl","shift","alt","meta"],Ig={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>Ag.some(e=>n[`${e}Key`]&&!t.includes(e))},pe=(n,t)=>{const e=n._withMods||(n._withMods={}),o=t.join(".");return e[o]||(e[o]=(s,...r)=>{for(let i=0;i<t.length;i++){const l=Ig[t[i]];if(l&&l(s,t))return}return n(s,...r)})},Mg={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},it=(n,t)=>{const e=n._withKeys||(n._withKeys={}),o=t.join(".");return e[o]||(e[o]=s=>{if(!("key"in s))return;const r=an(s.key);if(t.some(i=>i===r||Mg[i]===r))return n(s)})},Dg=ot({patchProp:Cg},sg);let Du;function Bg(){return Du||(Du=Tv(Dg))}const Ef=(...n)=>{const t=Bg().createApp(...n),{mount:e}=t;return t.mount=o=>{const s=Lg(o);if(!s)return;const r=t._component;!ke(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const i=e(s,!1,Eg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function Eg(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Lg(n){return Ze(n)?document.querySelector(n):n}const Ng="modulepreload",Hg=function(n,t){return new URL(n,t).href},Bu={},Al=function(t,e,o){let s=Promise.resolve();if(e&&e.length>0){let i=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};const l=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=i(e.map(c=>{if(c=Hg(c,o),c in Bu)return;Bu[c]=!0;const f=c.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(!!o)for(let k=l.length-1;k>=0;k--){const y=l[k];if(y.href===c&&(!f||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${g}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":Ng,f||(_.as="script"),_.crossOrigin="",_.href=c,u&&_.setAttribute("nonce",u),document.head.appendChild(_),f)return new Promise((k,y)=>{_.addEventListener("load",k),_.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})};function Wg(n){return{all:n=n||new Map,on:function(t,e){var o=n.get(t);o?o.push(e):n.set(t,[e])},off:function(t,e){var o=n.get(t);o&&(e?o.splice(o.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var o=n.get(t);o&&o.slice().map(function(s){s(e)}),(o=n.get("*"))&&o.slice().map(function(s){s(t,e)})}}}const Yr=Wg(),je={fire(n){Yr.emit(n.kind,n)},subscribe(n,t){Yr.on(n.kind,t)},unsubscribe(n,t){Yr.off(n.kind,t)}};class Zs{constructor(t){C(this,"kind","AssetFailureEvent");this.path=t}}C(Zs,"kind","AssetFailureEvent");class gs{constructor(t){C(this,"kind","FailureEvent");this.message=t}}C(gs,"kind","FailureEvent");class Lf{constructor(t){C(this,"kind","CustomAssetFailureEvent");this.error=t}}C(Lf,"kind","CustomAssetFailureEvent");class Qs{constructor(){C(this,"kind","InvalidateRenderEvent")}}C(Qs,"kind","InvalidateRenderEvent");const cr=class cr{constructor(){C(this,"kind",cr.kind)}};C(cr,"kind","RenderUpdatedEvent");let er=cr;const dr=class dr{constructor(){C(this,"kind",dr.kind)}};C(dr,"kind","StateLoadingEvent");let tr=dr;class _t{constructor(t){C(this,"kind","ShowMessageEvent");this.message=t}}C(_t,"kind","ShowMessageEvent");class fa{constructor(t,e){C(this,"kind","ResolvableErrorEvent");this.message=t,this.actions=e}}C(fa,"kind","ResolvableErrorEvent");class nr{constructor(t){C(this,"kind","ColorPickedEvent");this.color=t}}C(nr,"kind","ColorPickedEvent");class Nf{constructor(t,e){C(this,"kind","VueErrorEvent");this.error=t,this.info=e}}C(Nf,"kind","VueErrorEvent");function Ot(){return Lt("viewport")}const Eu=new WeakMap,Lu=new WeakMap;function Hf(){const n=Ot(),t=Eu.get(n);if(t)return t;const e=E({get(){return n.value.selection},set(o){n.value.selection=o}});return Eu.set(n,e),e}function Pn(){const n=Ot(),t=Lu.get(n);if(t)return t;console.log("make computed");const e=E(()=>n.value.isVertical);return Lu.set(n,e),e}const Vg={key:0},Fg=["onClick"],Ug=["onClick"],qg=5e3,Gr=2e4,Nu=100,zg=_e({__name:"message-console",props:{loading:{type:Boolean}},setup(n){const t=n,e=R([]),o=R([]),s=R([]),r=R(!1),i=R(0),l=R(0),a=Pn();u(t.loading),je.subscribe(Zs,g=>{e.value.push(`Failed to load asset '${g.path}'`),setTimeout(()=>{e.value.shift()},qg)}),je.subscribe(Lf,()=>{e.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{e.value.shift()},Gr)}),je.subscribe(gs,g=>{o.value.push(g.message)}),je.subscribe(fa,g=>{s.value.push(g)}),je.subscribe(_t,g=>{e.value.push(g.message),setTimeout(()=>{e.value.shift()},Gr)}),je.subscribe(Nf,g=>{e.value.push(g.error.name),e.value.push(JSON.stringify(g.error.stack)),e.value.push(g.info),setTimeout(()=>{e.value.shift(),e.value.shift(),e.value.shift()},Gr)});function u(g){g?(l.value&&(clearTimeout(l.value),l.value=0),!r.value&&!i.value&&(i.value=setTimeout(()=>{r.value=!0,i.value=0},Nu))):(i.value&&(clearTimeout(i.value),i.value=0),r.value&&!l.value&&(l.value=setTimeout(()=>{r.value=!1,l.value=0},Nu)))}function c(g){o.value.splice(g,1)}async function f(g,m){const _=s.value[g];s.value.splice(g,1),await _.actions.find(y=>y.name===m).exec()}return ze(()=>t.loading,g=>{u(g)}),(g,m)=>(j(),U("div",{id:"messageConsole",class:He({vertical:Q(a)})},[r.value?(j(),U("p",Vg,"Loading...")):de("",!0),(j(!0),U(ue,null,qe(e.value,(_,k)=>(j(),U("p",{key:_+"_"+k},Pe(_),1))),128)),(j(!0),U(ue,null,qe(s.value,(_,k)=>(j(),U("p",{class:"error",key:"resolvableError_"+k},[te(Pe(_.message)+" ",1),(j(!0),U(ue,null,qe(_.actions,y=>(j(),U("a",{href:"#",key:"resolvableError_"+k+y.name,onClick:w=>f(k,y.name)},"["+Pe(y.name)+"]",9,Fg))),128))]))),128)),(j(!0),U(ue,null,qe(o.value,(_,k)=>(j(),U("p",{class:"error",key:"error_"+k},[te(Pe(_)+" ",1),d("a",{href:"#",onClick:y=>c(k)},"[Dismiss]",8,Ug)]))),128))],2))}}),Ee=(n,t)=>{const e=n.__vccOpts||n;for(const[o,s]of t)e[o]=s;return e},Xg=Ee(zg,[["__scopeId","data-v-6b48a3f4"]]),Yg={key:0,id:"submit-options"},Gg=["onClick"],Kg={key:0,id:"submit-options"},Jg=["onClick"],Zg=_e({__name:"modal-dialog",props:{noBaseSize:{type:Boolean,default:!1},options:{default:()=>[]}},emits:["leave","option"],setup(n,{emit:t}){const e=n,o=t,s=typeof HTMLDialogElement<"u",r=R(null);function i(){if(s){const u=r.value;u!=null&&!u.open&&u.showModal()}window.addEventListener("click",a)}function l(){if(s){const u=r.value;u!=null&&u.open&&u.close(),o("leave")}window.removeEventListener("click",a)}function a(u){const c=r.value;c!=null&&c.open?u.target===c&&(l(),u.preventDefault(),u.stopPropagation()):window.removeEventListener("click",a)}return Wt(i),rf(i),lf(l),Sn(l),(u,c)=>s?(j(),U("dialog",{key:0,ref_key:"dialog",ref:r,class:He(["native",{"base-size":!e.noBaseSize}]),onCancel:l},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(j(),U("div",Yg,[(j(!0),U(ue,null,qe(u.options,f=>(j(),U("button",{key:f,class:"option",onClick:g=>o("option",f)},Pe(f),9,Gg))),128))])):de("",!0)],34)):(j(),U("div",{key:1,class:"dialog-wrapper",onClick:c[1]||(c[1]=f=>o("leave"))},[d("dialog",{ref_key:"dialog",ref:r,open:"",class:He({"base-size":!e.noBaseSize}),onClick:c[0]||(c[0]=pe(()=>{},["stop"]))},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(j(),U("div",Kg,[(j(!0),U(ue,null,qe(e.options,f=>(j(),U("button",{key:f,class:"option",onClick:g=>o("option",f)},Pe(f),9,Jg))),128))])):de("",!0)],2)]))}}),Bn=Ee(Zg,[["__scopeId","data-v-07b9fd71"]]),Qg="./",pa="/dddg-assets/v2/assets/",vt=`${Qg}packs/`,ha=!0,re=Wf();function Wf(){const n=[];let t=!1;const e=[],o=function(r){return new Promise(i=>{const l=async()=>{try{r.length>0?await r(Wf()):await r(),e.forEach(a=>a())}catch(a){console.log("Error during transaction!: ",a)}finally{t=!1}n.length>0&&n.shift()(),i()};t?n.push(l):l()})};return o.onClear=function(s){e.push(s)},o}async function Kr(n){await re(async()=>{await(n==null?void 0:n())})}function We(n,t){return n()}const va={"dddg.buildin.backgrounds.nsfw":`${vt}buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${vt}buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${vt}buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${vt}buildin.base.yuri.nsfw.json`},em=new Set(Object.keys(va)),tm=Object.values(va);var Oo={},Hu;function nm(){if(Hu)return Oo;Hu=1,Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.normalizeCharacter=void 0;function n(a,u){var c=l("",a.folder||"/",u),f=void 0;return a.chibi&&(f=l(c,a.chibi,u)),f===void 0&&a.internalId&&(f=(u["/"]||"")+"chibis/"+a.internalId),{id:a.id,packId:a.packId,packCredits:a.packCredits,name:a.name,nsfw:!!a.nsfw,chibi:f,eyes:t(a.eyes,c,u),hairs:t(a.hairs,c,u),styles:r(a.styles),heads:e(a.heads,c,u),poses:o(a.poses,c,u)}}Oo.normalizeCharacter=n;function t(a,u,c){if(!a)return{};var f={};for(var g in a)a.hasOwnProperty(g)&&(f[g]=l(u,a[g],c));return f}function e(a,u,c){var f={};if(!a)return f;for(var g in a)if(a.hasOwnProperty(g)){var m=a[g],_=void 0;if(m instanceof Array)_={all:s(m,u,c),nsfw:!1,offset:[290,70],size:[380,380]};else{var k=l(u,m.folder,c);_={all:s(m.all,k,c),nsfw:!!m.nsfw,offset:m.offset||[290,70],size:m.size||[380,380]}}f[g]=_}return f}function o(a,u,c){return a?a.map(function(f){var g=l(u,f.folder,c),m={compatibleHeads:f.compatibleHeads||[],headAnchor:f.headAnchor||[0,0],headInForeground:!!f.headInForeground,name:f.name,nsfw:!!f.nsfw,style:f.style,offset:[0,0],size:[960,960]};if("static"in f)m.static=l(g,f.static,c);else if("variant"in f)m.variant=s(f.variant,g,c);else if("left"in f)m.left=s(f.left,g,c),m.right=s(f.right,g,c);else throw new Error("Invalid pose");return m}):[]}function s(a,u,c){return a.map(function(f){return typeof f=="string"?{img:l(u,f,c),nsfw:!1}:{img:l(u,f.img,c),nsfw:f.nsfw||!1}})}function r(a){return a?a.map(function(u){return{name:u.name,label:u.label,nsfw:u.nsfw||!1}}):[]}function i(a){return a.startsWith("blob:")||a.startsWith("http://")||a.startsWith("https://")||a.startsWith("://")}function l(a,u,c){if(!u)return a;for(var f in c)if(u.startsWith(f))return c[f]+u.slice(f.length);return i(u)?u:a+u}return Oo}var om=nm(),kt={},Ge={},lt={},Wu;function Vf(){if(Wu)return lt;Wu=1;var n=lt&&lt.__assign||function(){return n=Object.assign||function(p){for(var P,M=1,N=arguments.length;M<N;M++){P=arguments[M];for(var b in P)Object.prototype.hasOwnProperty.call(P,b)&&(p[b]=P[b])}return p},n.apply(this,arguments)},t=lt&&lt.__values||function(p){var P=typeof Symbol=="function"&&Symbol.iterator,M=P&&p[P],N=0;if(M)return M.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&N>=p.length&&(p=void 0),{value:p&&p[N++],done:!p}}};throw new TypeError(P?"Object is not iterable.":"Symbol.iterator is not defined.")},e=lt&&lt.__read||function(p,P){var M=typeof Symbol=="function"&&p[Symbol.iterator];if(!M)return p;var N=M.call(p),b,O=[],T;try{for(;(P===void 0||P-- >0)&&!(b=N.next()).done;)O.push(b.value)}catch(L){T={error:L}}finally{try{b&&!b.done&&(M=N.return)&&M.call(N)}finally{if(T)throw T.error}}return O},o=lt&&lt.__spread||function(){for(var p=[],P=0;P<arguments.length;P++)p=p.concat(e(arguments[P]));return p};Object.defineProperty(lt,"__esModule",{value:!0}),lt.mapObject=lt.assetWalker=lt.normalizePath=void 0;var s=10;function r(p,P,M,N){for(var b,O,T="",L=0,B=new Map(Array.from(P.entries()).map(function(x){return[new RegExp("{"+x[0]+"}","g"),x[1]]}));T!==p;){if(T=p,++L>s)throw new Error("Maximum replacement recursion exceeded!");try{for(var H=(b=void 0,t(B.entries())),ee=H.next();!ee.done;ee=H.next()){var Y=ee.value;p=p.replace(Y[0],Y[1])}}catch(x){b={error:x}}finally{try{ee&&!ee.done&&(O=H.return)&&O.call(H)}finally{if(b)throw b.error}}p=p.replace(/{format(:.*?:.*?)+}/gi,function(x){x=x.slice(8,-1);for(var A=x.split(":"),G=0;G<A.length;G+=2)if(M.has(A[G]))return A[G+1];return""}),p=p.replace(/{lq:(.*?):(.*?)}/gi,function(x){return x.slice(4,-1).split(":")[N?0:1]})}return p}lt.normalizePath=r;function i(p,P){return{packId:p.packId,packCredits:p.packCredits,dependencies:p.dependencies,characters:p.characters.map(function(M){return l(M,P)}),backgrounds:p.backgrounds.map(function(M){return k(M,P)}),fonts:p.fonts.map(function(M){return y(M,P)}),poemStyles:o(p.poemStyles),poemBackgrounds:p.poemBackgrounds.map(function(M){return w(M,P)}),sprites:p.sprites.map(function(M){return h(M,P)}),colors:p.colors}}lt.assetWalker=i;function l(p,P){return{id:p.id,label:p.label,chibi:p.chibi?P(p.chibi,"image"):void 0,heads:m(p.heads,P),styleGroups:p.styleGroups.map(function(M){return a(M,P)}),defaultScale:p.defaultScale,hd:p.hd,size:p.size,sdVersion:p.sdVersion}}function a(p,P){return{id:p.id,styleComponents:p.styleComponents.map(function(M){return c(M,P)}),styles:p.styles.map(function(M){return u(M,P)})}}function u(p,P){return{components:p.components,poses:p.poses.map(function(M){return g(M,P)})}}function c(p,P){return n(n({},p),{variants:f(p.variants,P)})}function f(p,P){var M={};for(var N in p)p.hasOwnProperty(N)&&(M[N]=P(p[N],"image"));return M}function g(p,P){var M,N,b={};try{for(var O=t(Object.keys(p.positions)),T=O.next();!T.done;T=O.next()){var L=T.value,B=p.positions[L];b[L]=B.map(function(H){return H.map(function(ee){return P(ee,"image")})})}}catch(H){M={error:H}}finally{try{T&&!T.done&&(N=O.return)&&N.call(O)}finally{if(M)throw M.error}}return{compatibleHeads:p.compatibleHeads,id:p.id,previewOffset:p.previewOffset,previewSize:p.previewSize,renderCommands:p.renderCommands.map(function(H){return H.type==="image"?{type:"image",offset:H.offset,images:H.images.map(function(ee){return P(ee,"image")})}:H}),size:p.size,scale:p.scale,positions:b}}function m(p,P){var M={};for(var N in p)p.hasOwnProperty(N)&&(M[N]=_(p[N],P));return M}function _(p,P){return{previewOffset:p.previewOffset,previewSize:p.previewSize,variants:p.variants.map(function(M){return M.map(function(N){return P(N,"image")})})}}function k(p,P){return{id:p.id,label:p.label,variants:p.variants.map(function(M){return M.map(function(N){return P(N,"image")})}),scaling:p.scaling,sdVersion:p.sdVersion}}function y(p,P){return{id:p.id,label:p.label,files:p.files.map(function(M){return P(M,"font")})}}function w(p,P){return{id:p.id,fontColor:p.fontColor,label:p.label,images:p.images.map(function(M){return P(M,"image")}),sdVersion:p.sdVersion}}function h(p,P){return{id:p.id,label:p.label,variants:p.variants.map(function(M){return M.map(function(N){return P(N,"image")})}),defaultScale:p.defaultScale,hd:p.hd,sdVersion:p.sdVersion}}function v(p,P){var M={};for(var N in p)p.hasOwnProperty(N)&&(M[N]=P(p[N],N));return M}return lt.mapObject=v,lt}var Vu;function Ff(){if(Vu)return Ge;Vu=1;var n=Ge&&Ge.__assign||function(){return n=Object.assign||function(b){for(var O,T=1,L=arguments.length;T<L;T++){O=arguments[T];for(var B in O)Object.prototype.hasOwnProperty.call(O,B)&&(b[B]=O[B])}return b},n.apply(this,arguments)};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.expandId=Ge.normalizeStyleComponent=Ge.normalizeColor=Ge.normalizeBackground=Ge.normalizeFont=Ge.normalizePoemBackground=Ge.normalizePoemStyles=Ge.normalizeSprite=Ge.mapNormalize=Ge.normalizeContentPack=void 0;var t=Vf();function e(b,O){var T={paths:O,packId:b.packId},L=M("",b.folder||"/",T);return{packId:b.packId,packCredits:b.packCredits,dependencies:b.dependencies||[],characters:o(f,b.characters,L,T),backgrounds:o(a,b.backgrounds,L,T),fonts:o(l,b.fonts,L,T),poemStyles:o(r,b.poemStyles,L,T),poemBackgrounds:o(i,b.poemBackgrounds,L,T),sprites:o(s,b.sprites,L,T),colors:o(u,b.colors,L,T)}}Ge.normalizeContentPack=e;function o(b,O,T,L){return O?O.map(function(B){return b(B,T,L)}):[]}Ge.mapNormalize=o;function s(b,O,T){var L,B=M(O,b.folder,T);return{id:N(T.packId,b.id),label:b.label||b.variants[0][0],variants:b.variants.map(function(H){return c(H,B,T)}),defaultScale:b.defaultScale||[1,1],sdVersion:b.sdVersion,hd:(L=b.hd)!==null&&L!==void 0?L:null}}Ge.normalizeSprite=s;function r(b){return{label:b.label,defaultFont:b.defaultFont||"Aller",fontSize:b.fontSize!==void 0?b.fontSize:30,letterSpacing:b.letterSpacing!==void 0?b.letterSpacing:1,lineSpacing:b.lineSpacing!==void 0?b.lineSpacing:1.2}}Ge.normalizePoemStyles=r;function i(b,O,T){var L=M(O,b.folder,T);return{id:b.id,label:b.label,images:c(b.images,L,T),fontColor:b.fontColor||"black",sdVersion:b.sdVersion}}Ge.normalizePoemBackground=i;function l(b,O,T){var L=M(O,b.folder,T);return{id:N(T.packId,b.id?b.id:b.label?b.label:b.files[0]),label:b.label?b.label:b.id?b.id:b.files[0],files:c(b.files,L,T)}}Ge.normalizeFont=l;function a(b,O,T){var L,B=M(O,b.folder,T);return{id:N(T.packId,b.id),label:b.label?b.label:b.variants[0][0],variants:b.variants.map(function(H){return c(H,B,T)}),scaling:["none","strech","cover"].includes((L=b.scaling)===null||L===void 0?void 0:L.toLowerCase())?b.scaling.toLowerCase():"cover",sdVersion:b.sdVersion}}Ge.normalizeBackground=a;function u(b){return{label:b.label||b.color,color:b.color}}Ge.normalizeColor=u;function c(b,O,T){return b.map(function(L){return M(O,L,T)})}function f(b,O,T){var L,B,H,ee=M(O,b.folder,T);return{id:N(T.packId,b.id),label:b.label,chibi:b.chibi?M(ee,b.chibi,T):void 0,heads:y(b.heads,ee,T),defaultScale:(L=b.defaultScale)!==null&&L!==void 0?L:[.8,.8],size:(B=b.size)!==null&&B!==void 0?B:[960,960],hd:(H=b.hd)!==null&&H!==void 0?H:!1,sdVersion:b.sdVersion,styleGroups:o(g,b.styleGroups,ee,T)}}function g(b,O,T){var L=M(O,b.folder,T);return{id:N(T.packId,b.id),styleComponents:o(_,b.styleComponents,L,T),styles:b.styles.map(function(B){return m(B,L,T)})}}function m(b,O,T){var L=M(O,b.folder,T),B={};if(b.components)for(var H in b.components)b.components.hasOwnProperty(H)&&(B[N(T.packId,H)]=b.components[H]);return{components:B,poses:b.poses.map(function(ee){return w(ee,L,T)})}}function _(b,O,T){return{id:N(T.packId,b.id),label:b.label,variants:k(b.variants,O,T)}}Ge.normalizeStyleComponent=_;function k(b,O,T){if(!b)return{};var L={};for(var B in b)b.hasOwnProperty(B)&&(L[B]=M(O,b[B],T));return L}function y(b,O,T){var L={};if(!b)return L;for(var B in b)if(b.hasOwnProperty(B)){var H=b[B],ee=void 0;if(H instanceof Array)ee={variants:v(H,O,T),previewOffset:[290,70],previewSize:[380,380]};else{var Y=M(O,H.folder,T);ee={variants:v(H.variants,Y,T),previewOffset:H.previewOffset||[290,70],previewSize:H.previewSize||[380,380]}}L[N(T.packId,B)]=ee}return L}function w(b,O,T){var L,B,H=M(O,b.folder,T);return{compatibleHeads:((L=b.compatibleHeads)===null||L===void 0?void 0:L.map(function(ee){return N(T.packId,ee)}))||[],id:N(T.packId,b.id),previewOffset:b.previewOffset||[0,0],previewSize:b.previewSize||[960,960],size:b.size||[960,960],scale:b.scale||.8,positions:t.mapObject(b.positions||{},function(ee){return v(ee,H,T)}),renderCommands:((B=b.renderCommands)===null||B===void 0?void 0:B.map(function(ee){return h(ee,O,T)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function h(b,O,T){if(b.type==="image"){var L=M(O,b.folder,T);return{type:"image",composite:b.composite,offset:b.offset||[0,0],images:p(b.images,L,T)}}else return n(n({},b),{offset:b.offset||[0,0]})}function v(b,O,T){return b.map(function(L){return p(L,O,T)})}function p(b,O,T){return b.map(function(L){return M(O,L,T)})}function P(b){return b.startsWith("blob:")||b.startsWith("http://")||b.startsWith("https://")||b.startsWith("://")}function M(b,O,T){if(!O)return b;for(var L in T.paths)if(O.startsWith(L))return T.paths[L]+O.slice(L.length);return P(O)?O:b+O}function N(b,O){return O.indexOf(":")!==-1?O:b+":"+O}return Ge.expandId=N,Ge}var Fu;function sm(){if(Fu)return kt;Fu=1;var n=kt&&kt.__values||function(h){var v=typeof Symbol=="function"&&Symbol.iterator,p=v&&h[v],P=0;if(p)return p.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&P>=h.length&&(h=void 0),{value:h&&h[P++],done:!h}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},t=kt&&kt.__read||function(h,v){var p=typeof Symbol=="function"&&h[Symbol.iterator];if(!p)return h;var P=p.call(h),M,N=[],b;try{for(;(v===void 0||v-- >0)&&!(M=P.next()).done;)N.push(M.value)}catch(O){b={error:O}}finally{try{M&&!M.done&&(p=P.return)&&p.call(P)}finally{if(b)throw b.error}}return N},e=kt&&kt.__spread||function(){for(var h=[],v=0;v<arguments.length;v++)h=h.concat(t(arguments[v]));return h};Object.defineProperty(kt,"__esModule",{value:!0}),kt.expandOrTranslateId=kt.convert=void 0;var o=Ff();function s(h,v,p){if(!h.packId)throw new Error("");return{packId:h.packId,packCredits:h.packCredits?[h.packCredits]:[],dependencies:i(h.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[l(h,v,p)],colors:[]}}kt.convert=s;var r={"ddlc.monika":y("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":y("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":y("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":y("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":y("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":y("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":y("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":y("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":y("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":y("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function i(h){return[]}function l(h,v,p){var P={characterId:h.id,packId:h.packId,paths:v};return{id:w("character",h.id,P),chibi:h.chibi,label:h.name,heads:m(h.heads,P,p),styleGroups:a(h,P,p),defaultScale:[.8,.8],size:[960,960],hd:!1}}function a(h,v,p){var P,M,N=r[v.characterId],b=[],O=new Map,T=_(h,v),L=T.length===0?N&&N.defaultStyleComponents?u(N.defaultStyleComponents,v):[]:T,B=h.poses.map(function(G){return G.style}).filter(function(G,Ie,K){return K.indexOf(G)===Ie}),H=new Map(h.styles.map(function(G){return[G.name,G]})),ee=function(G){var Ie,K,ie,be,Me=H.get(G);if(Me&&Me.nsfw&&!p)return"continue";var ye=G,nt={};try{for(var Xe=(Ie=void 0,n(L)),Ye=Xe.next();!Ye.done;Ye=Xe.next()){var oe=Ye.value;try{for(var we=(ie=void 0,n(Object.keys(oe.variants))),xe=we.next();!xe.done;xe=we.next()){var $e=xe.value,S=new RegExp("-"+$e+"\\b");if(ye.match(S)){nt[oe.id]=$e,ye=ye.replace(S,"");break}}}catch(W){ie={error:W}}finally{try{xe&&!xe.done&&(be=we.return)&&be.call(we)}finally{if(ie)throw ie.error}}}}catch(W){Ie={error:W}}finally{try{Ye&&!Ye.done&&(K=Xe.return)&&K.call(Xe)}finally{if(Ie)throw Ie.error}}ye=w("styleGroups",ye,v);var $=O.get(ye);$||($={id:ye,styleComponents:L,styles:[]},O.set(ye,$),b.push(ye)),$.styles.push({components:nt,poses:f(h.poses.filter(function(W){return W.style===G}),v,p)})};try{for(var Y=n(B),x=Y.next();!x.done;x=Y.next()){var A=x.value;ee(A)}}catch(G){P={error:G}}finally{try{x&&!x.done&&(M=Y.return)&&M.call(Y)}finally{if(P)throw P.error}}return b.map(function(G){return O.get(G)})}function u(h,v){return o.mapNormalize(o.normalizeStyleComponent,h,"",{packId:v.packId,paths:v.paths})}function c(h,v){return h?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:v}]:[{type:"head",offset:v},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function f(h,v,p){return h.map(function(P){return{compatibleHeads:P.compatibleHeads.map(function(M){return w("heads",M.toString(),v)}),id:w("poses",P.name,v),renderCommands:c(P.headInForeground,P.headAnchor),previewOffset:P.offset,previewSize:P.size,size:[960,960],scale:.8,positions:{Static:"static"in P?[[P.static]]:[],Left:"left"in P?g(P.left,p):[],Right:"right"in P?g(P.right,p):[],Variant:"variant"in P?g(P.variant,p):[]}}})}function g(h,v){return h.filter(function(p){return!p.nsfw||v}).map(function(p){return[p.img]})}function m(h,v,p){var P,M,N={};try{for(var b=n(Object.keys(h)),O=b.next();!O.done;O=b.next()){var T=O.value,L=h[T];L.nsfw&&!p||(N[w("heads",T,v)]={previewOffset:L.offset,previewSize:L.size,variants:L.all.filter(function(B){return!B.nsfw||p}).map(function(B){return[B.img]})})}}catch(B){P={error:B}}finally{try{O&&!O.done&&(M=b.return)&&M.call(b)}finally{if(P)throw P.error}}return N}function _(h,v){var p=[],P=[];return Object.keys(h.eyes).length>0&&(Object.keys(h.eyes).forEach(function(M){return P.push(M)}),p.push({label:"Eyes",id:w("eyes","eyes",v),variants:h.eyes})),Object.keys(h.hairs).length>0&&(Object.keys(h.hairs).forEach(function(M){return P.push(M)}),p.push({label:"Hairs",id:w("hairs","hairs",v),variants:h.hairs})),p}function k(h,v){return new Map(v.map(function(p){return[p,h+":"+p]}))}function y(h,v,p){return p.extraHeadAssoc?p.extraHeadAssoc=p.extraHeadAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraHeadAssoc=[],p.extraPoseAssoc?p.extraPoseAssoc=p.extraPoseAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraPoseAssoc=[],p.extraStyleGroupAssoc?p.extraStyleGroupAssoc=p.extraStyleGroupAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraStyleGroupAssoc=[],{character:h+":"+v,eyes:h+":eyes",hairs:h+":hair",defaultStyleComponents:p.defaultStyleComponents||[],heads:new Map(e(k(h,p.heads),p.extraHeadAssoc)),poses:new Map(e(k(h,p.poses),p.extraPoseAssoc)),styleGroups:new Map(e(k(h,p.styleGroups),p.extraStyleGroupAssoc))}}function w(h,v,p){var P=r[p.characterId];if(P){if(h==="character"||h==="hairs"||h==="eyes")return P[h];var M=P[h].get(v);if(M)return M}return o.expandId(p.packId,v)}return kt.expandOrTranslateId=w,kt}var rm=sm(),im=Ff(),Jr=Vf();function lm(n,t){return{backgrounds:am(n.backgrounds,t.backgrounds),characters:cm(n.characters,t.characters),dependencies:Il(n.dependencies,t.dependencies),fonts:Yt(n.fonts,t.fonts,e=>e.id,(e,o)=>({...e,files:Il(e.files,o.files)})),poemStyles:Yt(n.poemStyles,t.poemStyles,e=>e.label,()=>{throw new Error}),poemBackgrounds:[...n.poemBackgrounds,...t.poemBackgrounds],sprites:Yt(n.sprites,t.sprites,e=>e.id,(e,o)=>({id:e.id,label:e.label,variants:[...e.variants,...o.variants],defaultScale:e.defaultScale,hd:e.hd,sdVersion:e.sdVersion??o.sdVersion})),colors:Yt(n.colors,t.colors,e=>e.color,e=>e)}}function am(n,t){return Yt(n,t,e=>e.id,um)}function um(n,t){return{id:n.id,label:n.label,variants:[...n.variants,...t.variants],scaling:n.scaling,sdVersion:n.sdVersion??t.sdVersion}}function cm(n,t){return Yt(n,t,e=>e.id,dm)}function dm(n,t){return{chibi:n.chibi,id:n.id,label:n.label,heads:hm(n.heads,t.heads),defaultScale:n.defaultScale,hd:n.hd,size:n.size,sdVersion:n.sdVersion,styleGroups:Yt(n.styleGroups,t.styleGroups,e=>e.id,(e,o)=>({id:e.id,styleComponents:Yt(e.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:fm(s.variants,r.variants)})),styles:Yt(e.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:Yt(s.poses,r.poses,i=>i.id,pm)}))}))}}function fm(n,t){const e={...n};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Object.prototype.hasOwnProperty.call(e,o)||(e[o]=t[o]));return e}function pm(n,t){const e={...n.positions};for(const o in t.positions)e[o]?e[o]=[...e[o],...t.positions[o]]:e[o]=t.positions[o];return{id:n.id,compatibleHeads:Il(n.compatibleHeads,t.compatibleHeads),previewOffset:n.previewOffset,previewSize:n.previewSize,scale:n.scale,size:n.size,renderCommands:n.renderCommands,positions:e}}function hm(n,t){const e={...n};for(const o in t){if(!Object.prototype.hasOwnProperty.call(t,o))continue;const s=t[o];if(e[o]){const r=e[o];e[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else e[o]=s}return e}function Il(n,t){const e=[...n];for(const o of t)e.includes(o)||e.push(o);return e}function Yt(n,t,e,o){const s=[...n],r=new Map(n.map((i,l)=>[e(i),l]));for(const i of t){const l=e(i);if(r.has(l)){const a=r.get(l),u=s[a];s.splice(a,1,o(u,i))}else r.set(l,s.length),s.push(i)}return s}function Lo(n,t,e){let o=t+e;const s=n.length;return o<0&&(o+=s),o>=s&&(o-=s),o}const Bt=class Bt{constructor(t,e,o,s){this.r=t,this.g=e,this.b=o,this.a=s,Object.freeze(this)}static validCss(t){return this.validCssRgb(t)||this.validHex(t)}static fromCss(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}static validCssRgb(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}static fromCssRgb(t){if(!this.validCssRgb(t))throw new Error("Invalid RGB color format");const e=t.slice(0,-1),o=e.indexOf("("),r=e.slice(o+1).split(",").map(i=>parseFloat(i.trim()));return new Bt(r[0],r[1],r[2],r.length===4?r[3]:1)}static validHex(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}static fromHex(t){if(!this.validHex(t))throw new Error("Invalid Hex color format");const e=t.slice(1);if(e.length===3)return new Bt(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),1);if(e.length===4)return new Bt(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)/255);if(e.length===6)return new Bt(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),1);if(e.length===8)return new Bt(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),parseInt(e[6]+e[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:t,g:e,b:o}=this;const{a:s}=this;t/=255,e/=255,o/=255;const r=Math.max(t,e,o),i=Math.min(t,e,o);let l,a;const u=(r+i)/2;if(r===i)l=a=0;else{const c=r-i;switch(a=u>.5?c/(2-r-i):c/(r+i),r){case t:l=(e-o)/c+(e<o?6:0);break;case e:l=(o-t)/c+2;break;case o:l=(t-e)/c+4;break}l/=6}return new Ve(l,a,u,s)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};C(Bt,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i),C(Bt,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i),C(Bt,"hexShortEx",/^#[0-9A-F]{3,4}$/i),C(Bt,"hexLongEx",/^#[0-9A-F]{6,8}$/i);let Ne=Bt;class Ve{constructor(t,e,o,s){this.h=t,this.s=e,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(t){let{h:e,s:o,l:s,a:r}=this;return e+=t.h,e>=1?e-=1:e<0&&(e+=1),o+t.s>1?o-=t.s:(o+=t.s,o<0&&(o=0)),s+t.l>1||s+t.l<0?s-=t.l:s+=t.l,r+t.a>1||r+t.a<0?r-=t.a:r+=t.a,new Ve(e,o,s,r)}toRgb(){const{h:t,s:e,l:o,a:s}=this;let r,i,l;if(e===0)r=i=l=o;else{const a=o<.5?o*(1+e):o+e-o*e,u=2*o-a;r=Ve.hue2rgb(u,a,t+1/3),i=Ve.hue2rgb(u,a,t),l=Ve.hue2rgb(u,a,t-1/3)}return new Ne(Math.round(r*255),Math.round(i*255),Math.round(l*255),s)}toHSL(){return this}static hue2rgb(t,e,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?t+(e-t)*6*o:o<1/2?e:o<2/3?t+(e-t)*(2/3-o)*6:t}}const xr=1280,ga=720,vm=128,gm=32,mm="rgba(60,60,60,0.8)",bm=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Uf=1,ym=1/1.5,wm=-74,km=358,Cm=[200,240,400,493,640,786,880,1040,1080],_m=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:km,CloseUpYOffset:wm,WheelBackground:mm,characterPositions:Cm,hdCharacterScaleFactor:ym,positions:bm,screenHeight:ga,screenWidth:xr,sdCharacterScaleFactor:Uf,wheelInnerRadius:vm,wheelWidth:gm},Symbol.toStringTag,{value:"Module"})),xm=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Sm="#ffe6f4",Pm="#ffbde1",Om=420,Tm=22,$m=640,qf=270,jm=7,zf=3,Rm=Math.ceil(zf/2),Am=(ga-qf)/2,Im={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Mm=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Pm,ChoiceButtonColor:Sm,ChoiceButtonWidth:Om,ChoiceOuterPadding:Rm,ChoicePadding:jm,ChoiceSpacing:Tm,ChoiceTextStyle:Im,ChoiceX:$m,ChoiceY:Am,ChoiceYOffset:qf,Outline:zf,nameboxTextOutlineDelta:xm},Symbol.toStringTag,{value:"Module"})),Xf="#ffa8d2",Dm="#552222",Bm="#ffeef6",ma="#bb5599",Yf=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Gf=new Ve(.002028397565922768,0,.13725490196078438,0),Kf=.82,Jf=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Zf=12,Qf=12,Em=.6,Lm=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Nm=new Ve(0,-.14285714285714296,.3,0),Hm=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Wm=9.5,Vm=47,ep=new Ve(.0023347701149424305,0,.10784313725490202,0),Yn=3,tp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Lm,controlDisableColorDelta:Nm,controlsDefaultColor:Dm,dotColorDelta:Hm,dotPatternSize:Vm,dotRadius:Wm,nameColorThreshold:Em,nameboxBackgroundDelta:Gf,nameboxDefaultColor:Bm,nameboxGradientEndDelta:Jf,nameboxGradientMiddleStopPosition:Kf,nameboxRounding:Zf,nameboxStrokeDefaultColor:ma,nameboxTextOutlineDelta:Yf,textboxDefaultColor:Xf,textboxOutlineColorDelta:ep,textboxOutlineWidth:Yn,textboxRounding:Qf},Symbol.toStringTag,{value:"Module"})),yo=816,ba=900,Sr=146,Fm=0,Um=29,qm=8,ms=38,Pr=44,zm=6,Xm=93,Ym=404,Gm=9,Km=9,Ln=39,bs=168,ys=34,Or=29,ya=12,wa=-126,ka=-72,Ca=-38,_a=30.75,xa=26,np=426,Ml=58,Sa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Tr={...Sa,fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:6,color:"white",letterSpacing:1},Pa={align:"left",font:"13px aller",fill:{style:"#522"}},op={...Pa,fill:{style:"#a66"}},Jm={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Oa={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},wo=xr/2-yo/2,Zm=xr/2-ba/2,Qm=wo+ms,sp=wo+ys,eb=sp+bs/2,tb=wo+wa,nb=wo+ka,ob=wo+Ca,sb="normal",rb=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:_a,ArrowYBottomOffset:xa,BaseTextStyle:Sa,ControlsTextDisabledStyle:op,ControlsTextStyle:Pa,ControlsXHistory:tb,ControlsXHistoryOffset:wa,ControlsXSkip:nb,ControlsXSkipOffset:ka,ControlsXStuff:ob,ControlsXStuffOffset:Ca,ControlsYBottomOffset:ya,DefaultTextboxStyle:sb,GlowRX:np,GlowRY:Ml,HdSideMargin:Ym,HdSpacing:Xm,NameboxHeight:Ln,NameboxTextStyle:Tr,NameboxTextX:eb,NameboxTextYOffset:Or,NameboxWidth:bs,NameboxX:sp,NameboxXOffset:ys,TextBoxBottomSpacing:zm,TextBoxCorruptedKerning:qm,TextBoxCorruptedStyle:Jm,TextBoxCorruptedWidth:ba,TextBoxCorruptedX:Zm,TextBoxHeight:Sr,TextBoxKerning:Fm,TextBoxLineHeight:Um,TextBoxStyle:Oa,TextBoxTextCorruptedXOffset:Gm,TextBoxTextCorruptedYOffset:Km,TextBoxTextX:Qm,TextBoxTextXOffset:ms,TextBoxTextYOffset:Pr,TextBoxWidth:yo,TextBoxX:wo},Symbol.toStringTag,{value:"Module"})),ib="#ffe6f4",lb="#ffbde1",ab="rgba(255,255,255,0.6)",ub=40,cb=30,db={...Sa,fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:8,letterSpacing:1,color:"white"},fb={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},pb=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:ab,NotificationBackgroundColor:ib,NotificationBorderColor:lb,NotificationOkTextStyle:db,NotificationPadding:ub,NotificationSpacing:cb,NotificationTextStyle:fb},Symbol.toStringTag,{value:"Module"})),rp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],hb=0,vb=0,gb=xr/2,mb=ga/2,bb=33,yb=100,wb=30,kb=800,Cb=720,_b=Uf,xb="#333333bf",Sb=480,Pb=180,Ob=3,Tb=7,dn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},ip=[{...dn,name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0},{...dn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:28},{...dn,name:"Monika",fontName:"journal",fontSize:34},{...dn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32},{...dn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8},{...dn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40},{...dn,name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53},{...dn,name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1}],$b=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:_b,consoleBackgroundColor:xb,consoleHeight:Pb,consoleWidth:Sb,defaultConsoleBackground:Ob,defaultConsoleStyle:Tb,defaultPoemBackground:hb,defaultPoemHeight:Cb,defaultPoemStyle:vb,defaultPoemWidth:kb,defaultX:gb,defaultY:mb,poemBackgrounds:rp,poemBottomPadding:yb,poemPadding:wb,poemTextStyles:ip,poemTopPadding:bb},Symbol.toStringTag,{value:"Module"})),jb={Base:_m,Choices:Mm,Notification:pb,Poem:$b,TextBox:rb,TextBoxCustom:tp},$r=1920,Ta=1080,Rb=128,Ab=32,Ib="rgba(60,60,60,0.8)",Mb=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],lp=1.5,Db=1,Bb=-111,Eb=537,Lb=[300,360,600,740,960,1180,1320,1560,1620],Nb=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:Eb,CloseUpYOffset:Bb,WheelBackground:Ib,characterPositions:Lb,hdCharacterScaleFactor:Db,positions:Mb,screenHeight:Ta,screenWidth:$r,sdCharacterScaleFactor:lp,wheelInnerRadius:Rb,wheelWidth:Ab},Symbol.toStringTag,{value:"Module"})),Hb=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Wb="#ffe6f4",Vb="#ffbde1",Fb=630,Ub=33,qb=960,ap=405,zb=10.5,up=4.5,Xb=Math.ceil(up/2),Yb=(Ta-ap)/2,Gb={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Kb=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Vb,ChoiceButtonColor:Wb,ChoiceButtonWidth:Fb,ChoiceOuterPadding:Xb,ChoicePadding:zb,ChoiceSpacing:Ub,ChoiceTextStyle:Gb,ChoiceX:qb,ChoiceY:Yb,ChoiceYOffset:ap,Outline:up,nameboxTextOutlineDelta:Hb},Symbol.toStringTag,{value:"Module"})),cp="#ffa8d2",Jb="#552222",Zb="#ffeef6",$a="#bb5599",dp=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),fp=new Ve(.002028397565922768,0,.13725490196078438,0),pp=.82,hp=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),vp=15,gp=19,Qb=.6,ey=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),ty=new Ve(0,-.14285714285714296,.3,0),ny=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),oy=9.5*1.5,sy=47*1.5,mp=new Ve(.0023347701149424305,0,.10784313725490202,0),Gn=5,bp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:ey,controlDisableColorDelta:ty,controlsDefaultColor:Jb,dotColorDelta:ny,dotPatternSize:sy,dotRadius:oy,nameColorThreshold:Qb,nameboxBackgroundDelta:fp,nameboxDefaultColor:Zb,nameboxGradientEndDelta:hp,nameboxGradientMiddleStopPosition:pp,nameboxRounding:vp,nameboxStrokeDefaultColor:$a,nameboxTextOutlineDelta:dp,textboxDefaultColor:cp,textboxOutlineColorDelta:mp,textboxOutlineWidth:Gn,textboxRounding:gp},Symbol.toStringTag,{value:"Module"})),ja=1220,yp=900,wp=219,ry=0,iy=29,ly=8,Ra=57,kp=68,ay=54,uy=9,cy=9,Aa=59,Ia=252,Ma=49,Cp=43,_p=12*1.5,xp=-126*1.5,Sp=-72*1.5,Pp=-38*1.5,Op=30.75*1.5,Tp=26*1.5,$p=426*1.5,Dl=58*1.5,Da={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},jp={...Da,fontName:"riffic",fontSize:36,strokeColor:$a,strokeWidth:9,color:"white",letterSpacing:2},or={align:"left",font:"24px aller",fill:{style:"#522"}},Rp={...or,fill:{style:"#a66"}},Ap={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},dy={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},ko=$r/2-ja/2,fy=$r/2-yp/2,py=ko+Ra,Ip=ko+Ma,hy=Ip+Ia/2,vy=ko+xp,gy=ko+Sp,my=ko+Pp,by="custom_plus",yy=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:Op,ArrowYBottomOffset:Tp,BaseTextStyle:Da,ControlsTextDisabledStyle:Rp,ControlsTextStyle:or,ControlsXHistory:vy,ControlsXHistoryOffset:xp,ControlsXSkip:gy,ControlsXSkipOffset:Sp,ControlsXStuff:my,ControlsXStuffOffset:Pp,ControlsYBottomOffset:_p,DefaultTextboxStyle:by,GlowRX:$p,GlowRY:Dl,NameboxHeight:Aa,NameboxTextStyle:jp,NameboxTextX:hy,NameboxTextYOffset:Cp,NameboxWidth:Ia,NameboxX:Ip,NameboxXOffset:Ma,TextBoxBottomSpacing:ay,TextBoxCorruptedKerning:ly,TextBoxCorruptedStyle:dy,TextBoxCorruptedWidth:yp,TextBoxCorruptedX:fy,TextBoxHeight:wp,TextBoxKerning:ry,TextBoxLineHeight:iy,TextBoxStyle:Ap,TextBoxTextCorruptedXOffset:uy,TextBoxTextCorruptedYOffset:cy,TextBoxTextX:py,TextBoxTextXOffset:Ra,TextBoxTextYOffset:kp,TextBoxWidth:ja,TextBoxX:ko},Symbol.toStringTag,{value:"Module"})),wy="#ffe6f4",ky="#ffbde1",Cy="rgba(255,255,255,0.6)",_y=60,xy=45,Sy={...Da,fontName:"riffic",fontSize:36,strokeColor:$a,strokeWidth:12,letterSpacing:1,color:"white"},Py={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Oy=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:Cy,NotificationBackgroundColor:wy,NotificationBorderColor:ky,NotificationOkTextStyle:Sy,NotificationPadding:_y,NotificationSpacing:xy,NotificationTextStyle:Py},Symbol.toStringTag,{value:"Module"})),Ty=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],$y=0,jy=0,Ry=$r/2,Ay=Ta/2,Iy=26,My=150,Dy=61,By=1200,Ey=1080,Ly=lp,Ny="#333333bf",Hy=720,Wy=270,Vy=3,Fy=7,fn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},Uy=[{...fn,name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1},{...fn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5},{...fn,name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5},{...fn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48},{...fn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12},{...fn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60},{...fn,name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53},{...fn,name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1}],qy=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:Ly,consoleBackgroundColor:Ny,consoleHeight:Wy,consoleWidth:Hy,defaultConsoleBackground:Vy,defaultConsoleStyle:Fy,defaultPoemBackground:$y,defaultPoemHeight:Ey,defaultPoemStyle:jy,defaultPoemWidth:By,defaultX:Ry,defaultY:Ay,poemBackgrounds:Ty,poemBottomPadding:My,poemPadding:Dy,poemTextStyles:Uy,poemTopPadding:Iy},Symbol.toStringTag,{value:"Module"})),zy={Base:Nb,Choices:Kb,Notification:Oy,Poem:qy,TextBox:yy,TextBoxCustom:bp};function fe(){return he.gameMode==="ddlc_plus"?zy:jb}const ls=Jt(Object.seal({lqRendering:!0,nsfw:!1,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,loadSave(n){},getSave(n){return{}},copyObjectToClipboard(n,t){const e=V.panels.panels[n],o=Object.values(e.objects),s=new Set;for(const a of t){const u=e.objects[a];s.add(u),l(u,u)}const r=Array.from(s).map(a=>a.save()),i=JSON.stringify(r);this.clipboard=i,navigator.clipboard.writeText(i);function l(a,u,c=!0){if(!c&&a===u)throw new Error("Recursively linked object");for(const f of o)f.linkedTo===a.id&&(s.add(f),l(f,u,!1))}},async pasteObjects(n){let t;try{const e=await navigator.clipboard.readText();t=JSON.parse(e)}catch{if(ls.clipboard==null)return;t=JSON.parse(ls.clipboard)}n.pasteObjects(t)}}));function sr(n,t,e){return n>t?n:t>e?e:t}function ro(n,t){return(n%t+t)%t}function Xy(n,t){return n===null&&t===null?!0:n===null||t===null?!1:n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d&&n.e===t.e&&n.f===t.f}function Mp(n){const{a:t,b:e,c:o,d:s,e:r,f:i}=n,l=t*s-e*o,a={x:r,y:i,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const u=Math.sqrt(t*t+e*e);a.rotation=(e>0?Math.acos(t/u):-Math.acos(t/u))/Math.PI*180,a.scaleX=u,a.scaleY=l/u,a.skewX=Math.atan((t*o+e*s)/(u*u))/Math.PI*180,a.skewY=0}else if(o!=0||s!=0){const u=Math.sqrt(o*o+s*s);a.rotation=(Math.PI/2-(s>0?Math.acos(-o/u):-Math.acos(o/u)))/Math.PI*180,a.scaleX=l/u,a.scaleY=u,a.skewX=0,a.skewY=Math.atan((t*o+e*s)/(u*u))/Math.PI*180}return a}var jn={},Zr={},Uu;function Yy(){return Uu||(Uu=1,Object.defineProperty(Zr,"__esModule",{value:!0})),Zr}var Qr={},qu;function Gy(){return qu||(qu=1,Object.defineProperty(Qr,"__esModule",{value:!0})),Qr}var ei={},zu;function Ky(){return zu||(zu=1,Object.defineProperty(ei,"__esModule",{value:!0})),ei}var ti={},Xu;function Jy(){return Xu||(Xu=1,Object.defineProperty(ti,"__esModule",{value:!0})),ti}var ni={},Yu;function Zy(){return Yu||(Yu=1,Object.defineProperty(ni,"__esModule",{value:!0})),ni}var oi={},Gu;function Qy(){return Gu||(Gu=1,Object.defineProperty(oi,"__esModule",{value:!0})),oi}var si={},Ku;function e0(){return Ku||(Ku=1,Object.defineProperty(si,"__esModule",{value:!0})),si}var ri={},Ju;function t0(){return Ju||(Ju=1,Object.defineProperty(ri,"__esModule",{value:!0})),ri}var ii={},Zu;function n0(){return Zu||(Zu=1,Object.defineProperty(ii,"__esModule",{value:!0})),ii}var li={},Qu;function o0(){return Qu||(Qu=1,Object.defineProperty(li,"__esModule",{value:!0})),li}var ai={},ec;function s0(){return ec||(ec=1,Object.defineProperty(ai,"__esModule",{value:!0})),ai}var ui={},tc;function r0(){return tc||(tc=1,Object.defineProperty(ui,"__esModule",{value:!0})),ui}var ci={},nc;function i0(){return nc||(nc=1,Object.defineProperty(ci,"__esModule",{value:!0})),ci}var di={},oc;function l0(){return oc||(oc=1,Object.defineProperty(di,"__esModule",{value:!0})),di}var fi={},sc;function a0(){return sc||(sc=1,Object.defineProperty(fi,"__esModule",{value:!0})),fi}var pi={},rc;function u0(){return rc||(rc=1,Object.defineProperty(pi,"__esModule",{value:!0})),pi}var hi={},ic;function c0(){return ic||(ic=1,Object.defineProperty(hi,"__esModule",{value:!0})),hi}var vi={},lc;function d0(){return lc||(lc=1,Object.defineProperty(vi,"__esModule",{value:!0})),vi}var gi={},ac;function f0(){return ac||(ac=1,Object.defineProperty(gi,"__esModule",{value:!0})),gi}var mi={},uc;function p0(){return uc||(uc=1,Object.defineProperty(mi,"__esModule",{value:!0})),mi}var bi={},cc;function h0(){return cc||(cc=1,Object.defineProperty(bi,"__esModule",{value:!0})),bi}var yi={},dc;function v0(){return dc||(dc=1,Object.defineProperty(yi,"__esModule",{value:!0})),yi}var wi={},fc;function g0(){return fc||(fc=1,Object.defineProperty(wi,"__esModule",{value:!0})),wi}var ki={},pc;function m0(){return pc||(pc=1,Object.defineProperty(ki,"__esModule",{value:!0})),ki}var Ci={},hc;function b0(){return hc||(hc=1,Object.defineProperty(Ci,"__esModule",{value:!0})),Ci}var _i={},vc;function y0(){return vc||(vc=1,Object.defineProperty(_i,"__esModule",{value:!0})),_i}var xi={},gc;function w0(){return gc||(gc=1,Object.defineProperty(xi,"__esModule",{value:!0})),xi}var Si={},mc;function k0(){return mc||(mc=1,Object.defineProperty(Si,"__esModule",{value:!0})),Si}var Pi={},bc;function C0(){return bc||(bc=1,Object.defineProperty(Pi,"__esModule",{value:!0})),Pi}var Oi={},yc;function _0(){return yc||(yc=1,Object.defineProperty(Oi,"__esModule",{value:!0})),Oi}var Ti={},wc;function x0(){return wc||(wc=1,Object.defineProperty(Ti,"__esModule",{value:!0})),Ti}var $i={},kc;function S0(){return kc||(kc=1,Object.defineProperty($i,"__esModule",{value:!0})),$i}var ji={},Cc;function P0(){return Cc||(Cc=1,Object.defineProperty(ji,"__esModule",{value:!0})),ji}var Ri={},_c;function O0(){return _c||(_c=1,Object.defineProperty(Ri,"__esModule",{value:!0})),Ri}var Ai={},xc;function T0(){return xc||(xc=1,Object.defineProperty(Ai,"__esModule",{value:!0})),Ai}var Ii={},Sc;function $0(){return Sc||(Sc=1,Object.defineProperty(Ii,"__esModule",{value:!0})),Ii}var Mi={},Pc;function j0(){return Pc||(Pc=1,Object.defineProperty(Mi,"__esModule",{value:!0})),Mi}var Di={},Oc;function R0(){return Oc||(Oc=1,Object.defineProperty(Di,"__esModule",{value:!0})),Di}var Bi={},Tc;function A0(){return Tc||(Tc=1,Object.defineProperty(Bi,"__esModule",{value:!0})),Bi}var Ei={},$c;function I0(){return $c||($c=1,Object.defineProperty(Ei,"__esModule",{value:!0})),Ei}var Li={},jc;function M0(){return jc||(jc=1,Object.defineProperty(Li,"__esModule",{value:!0})),Li}var Ni={},Rc;function D0(){return Rc||(Rc=1,Object.defineProperty(Ni,"__esModule",{value:!0})),Ni}var Hi={},Ac;function B0(){return Ac||(Ac=1,Object.defineProperty(Hi,"__esModule",{value:!0})),Hi}var Wi={},Ic;function E0(){return Ic||(Ic=1,Object.defineProperty(Wi,"__esModule",{value:!0})),Wi}var Vi={},Mc;function L0(){return Mc||(Mc=1,Object.defineProperty(Vi,"__esModule",{value:!0})),Vi}var Fi={},Dc;function N0(){return Dc||(Dc=1,Object.defineProperty(Fi,"__esModule",{value:!0})),Fi}var Ui={},Bc;function H0(){return Bc||(Bc=1,Object.defineProperty(Ui,"__esModule",{value:!0})),Ui}var qi={},Ec;function W0(){return Ec||(Ec=1,Object.defineProperty(qi,"__esModule",{value:!0})),qi}var zi={},Lc;function V0(){return Lc||(Lc=1,Object.defineProperty(zi,"__esModule",{value:!0})),zi}var Xi={},Nc;function F0(){return Nc||(Nc=1,Object.defineProperty(Xi,"__esModule",{value:!0})),Xi}var Yi={},Hc;function U0(){return Hc||(Hc=1,Object.defineProperty(Yi,"__esModule",{value:!0})),Yi}var Gi={},Wc;function q0(){return Wc||(Wc=1,Object.defineProperty(Gi,"__esModule",{value:!0})),Gi}var Ki={},Vc;function z0(){return Vc||(Vc=1,Object.defineProperty(Ki,"__esModule",{value:!0})),Ki}var Ji={},Fc;function X0(){return Fc||(Fc=1,Object.defineProperty(Ji,"__esModule",{value:!0})),Ji}var Zi={},Uc;function Y0(){return Uc||(Uc=1,Object.defineProperty(Zi,"__esModule",{value:!0})),Zi}var Qi={},qc;function G0(){return qc||(qc=1,Object.defineProperty(Qi,"__esModule",{value:!0})),Qi}var el={},zc;function K0(){return zc||(zc=1,Object.defineProperty(el,"__esModule",{value:!0})),el}var tl={},Xc;function J0(){return Xc||(Xc=1,Object.defineProperty(tl,"__esModule",{value:!0})),tl}var nl={},Yc;function Z0(){return Yc||(Yc=1,Object.defineProperty(nl,"__esModule",{value:!0})),nl}var ol={},Gc;function Q0(){return Gc||(Gc=1,Object.defineProperty(ol,"__esModule",{value:!0})),ol}var sl={},Kc;function ew(){return Kc||(Kc=1,Object.defineProperty(sl,"__esModule",{value:!0})),sl}var rl={},Jc;function tw(){return Jc||(Jc=1,Object.defineProperty(rl,"__esModule",{value:!0})),rl}var il={},Zc;function nw(){return Zc||(Zc=1,Object.defineProperty(il,"__esModule",{value:!0})),il}var ll={},Qc;function ow(){return Qc||(Qc=1,Object.defineProperty(ll,"__esModule",{value:!0})),ll}var al={},ed;function sw(){return ed||(ed=1,Object.defineProperty(al,"__esModule",{value:!0})),al}var To={},td;function rw(){if(td)return To;td=1,Object.defineProperty(To,"__esModule",{value:!0}),To.UnreachableCaseError=void 0;class n extends Error{constructor(e){super(`Unreachable case: ${e}`)}}return To.UnreachableCaseError=n,To}var $o={},nd;function iw(){if(nd)return $o;nd=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.assert=void 0;function n(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}return $o.assert=n,$o}var jo={},od;function lw(){if(od)return jo;od=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.createFactoryWithConstraint=void 0;const n=()=>t=>t;return jo.createFactoryWithConstraint=n,jo}var Ro={},sd;function aw(){if(sd)return Ro;sd=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.isExact=void 0;const n=()=>t=>t;return Ro.isExact=n,Ro}var Ao={},rd;function uw(){if(rd)return Ao;rd=1,Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.noop=void 0;function n(...t){}return Ao.noop=n,Ao}var ul={},id;function cw(){return id||(id=1,Object.defineProperty(ul,"__esModule",{value:!0})),ul}var ld;function dw(){return ld||(ld=1,function(n){var t=jn&&jn.__createBinding||(Object.create?function(o,s,r,i){i===void 0&&(i=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,i,l)}:function(o,s,r,i){i===void 0&&(i=r),o[i]=s[r]}),e=jn&&jn.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(n,"__esModule",{value:!0}),e(Yy(),n),e(Gy(),n),e(Ky(),n),e(Jy(),n),e(Zy(),n),e(Qy(),n),e(e0(),n),e(t0(),n),e(n0(),n),e(o0(),n),e(s0(),n),e(r0(),n),e(i0(),n),e(l0(),n),e(a0(),n),e(u0(),n),e(c0(),n),e(d0(),n),e(f0(),n),e(p0(),n),e(h0(),n),e(v0(),n),e(g0(),n),e(m0(),n),e(b0(),n),e(y0(),n),e(w0(),n),e(k0(),n),e(C0(),n),e(_0(),n),e(x0(),n),e(S0(),n),e(P0(),n),e(O0(),n),e(T0(),n),e($0(),n),e(j0(),n),e(R0(),n),e(A0(),n),e(I0(),n),e(M0(),n),e(D0(),n),e(B0(),n),e(E0(),n),e(L0(),n),e(N0(),n),e(H0(),n),e(W0(),n),e(V0(),n),e(F0(),n),e(U0(),n),e(q0(),n),e(z0(),n),e(X0(),n),e(Y0(),n),e(G0(),n),e(K0(),n),e(J0(),n),e(Z0(),n),e(Q0(),n),e(ew(),n),e(tw(),n),e(nw(),n),e(ow(),n),e(sw(),n),e(rw(),n),e(iw(),n),e(lw(),n),e(aw(),n),e(uw(),n),e(cw(),n)}(jn)),jn}var Kt=dw();const ad=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);class Ba{constructor(){C(this,"_filters",R([]));C(this,"_composite",R("source-over"))}get filters(){return this._filters.value}get composite(){return this._composite.value}set composite(t){this._composite.value,We(()=>void(this._composite.value=t))}addFilter(t,e){let o;switch(t){case"hue-rotate":o=new fo(t,0);break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":o=new fo(t,1);break;case"drop-shadow":o=new jr;break;default:throw new Kt.UnreachableCaseError(t)}const s=this._filters.value;We(()=>void s.splice(e,0,yt(o)))}removeFilter(t){const e=this._filters.value;e[t],We(()=>void e.splice(t,1))}moveFilter(t,e){const o=this._filters.value,s=o[t];We(()=>{o.splice(t,1),o.splice(t+e,0,s)})}}class fo{constructor(t,e=0){C(this,"_value");this.type=t,this._value=R(e)}get value(){return this._value.value}set value(t){this.value,We(()=>void(this._value.value=t))}clone(){return new fo(this.type,this.value)}getSave(){return{type:this.type,value:this.value}}}class jr{constructor(){C(this,"type","drop-shadow");C(this,"_offsetX",R(10));C(this,"_offsetY",R(10));C(this,"_blurRadius",R(0));C(this,"_color",R("#555555"))}get offsetX(){return this._offsetX.value}set offsetX(t){this._offsetX.value,We(()=>void(this._offsetX.value=t))}get offsetY(){return this._offsetY.value}set offsetY(t){this._offsetY.value,We(()=>void(this._offsetY.value=t))}get blurRadius(){return this._blurRadius.value}set blurRadius(t){this._blurRadius.value,We(()=>void(this._blurRadius.value=t))}get color(){return this._color.value}set color(t){this._color.value,We(()=>void(this._color.value=t))}clone(){const t=new jr;return t._offsetX.value=this._offsetX.value,t._offsetY.value=this._offsetY.value,t._blurRadius.value=this._blurRadius.value,t._color.value=this._color.value,t}getSave(){return{type:"drop-shadow",offsetX:this._offsetX.value,offsetY:this._offsetY.value,blurRadius:this._blurRadius.value,color:this._color.value}}}function Ea(n){const t=[];for(const e of n)if(e.type==="drop-shadow"){const o=new jr;o.offsetX=e.offsetX,o.offsetY=e.offsetY,o.blurRadius=e.blurRadius,o.color=e.color,t.push(yt(o))}else{const o=new fo(e.type,e.value);t.push(yt(o))}return t}class Co extends Ba{constructor(e,o,s){super();C(this,"panelId");C(this,"id");C(this,"_onTop",E({get:()=>this.panel.topOrder.includes(this.id),set:e=>{this.panel.setOnTop(this,e)}}));C(this,"_version",R(0));C(this,"_x");C(this,"_y",R(0));C(this,"_width",R(0));C(this,"_height",R(0));C(this,"_preserveRatio",R(!0));C(this,"_ratio",R(1));C(this,"_flip",R(!1));C(this,"_linkedTo",R(null));C(this,"_scaleX",R(1));C(this,"_scaleY",R(1));C(this,"_skewX",R(0));C(this,"_skewY",R(0));C(this,"_rotation",R(0));C(this,"_isTalking",E(()=>!!Object.values(this.panel.objects).find(e=>e.type==="textBox"&&e.talkingObjId===this.id)));C(this,"_localTransform",E(()=>{let e=new DOMMatrix;e=e.translate(this.x,this.y);const o=this.height/2*this.scaleX;return"close"in this&&this.close&&(e=e.translate(0,fe().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&this.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),this.rotation!==0&&(e=e.rotate(0,0,this.rotation)),this.skewX!==0&&(e=e.skewX(this.skewX)),this.skewY!==0&&(e=e.skewY(this.skewY)),this.flip&&(e=e.flipX()),(this.scaleX!==1||this.scaleY!==1)&&(e=e.scale(this.scaleX,this.scaleY)),e}));C(this,"_globalTransform",E(()=>{if(this._linkedTo.value){const e=this.panel.objects[this._linkedTo.value];return e?e.globalTransform.multiply(this.localTransform):this.localTransform}else return this.localTransform}));C(this,"_label",R(null));C(this,"_textboxColor",R(null));C(this,"_enlargeWhenTalking",R(!1));C(this,"_nameboxWidth",R(null));this.panel=e,this.panelId=e.id,s==null&&(s=e.lastObjId+1),this.id=s;const r=fe();this._x=R(r.Base.screenWidth/2),e.insertObject(this,o)}mutate(e,o){this._version.value;const s=this._version.value+1;e.value!==o&&We(()=>{e.value=o,this._version.value=s})}mutateX(e,o){this._version.value;const s=this._version.value+1,r=e.map(i=>i.value);for(let i=0;i<e.length;i++)e[i].value===o[i]&&(e.splice(i,1),o.splice(i,1),r.splice(i,1));e.length!==0&&We(()=>{for(let i=0;i<e.length;i++)e[i].value=o[i];this._version.value=s})}prepareSiblingRemoval(e){this.linkedTo===e.id&&(this.linkedTo=null)}get version(){return this._version.value}get x(){return this._x.value}set x(e){this.mutate(this._x,e)}get y(){return this._y.value}set y(e){this.mutate(this._y,e)}get width(){return this._width.value}set width(e){this.mutate(this._width,e)}get height(){return this._height.value}set height(e){this.mutate(this._height,e)}get preserveRatio(){return this._preserveRatio.value}set preserveRatio(e){this.mutateX([this._preserveRatio,this._ratio],[e,e?this.width/this.height:0])}get ratio(){return this._ratio.value}get flip(){return this._flip.value}set flip(e){this.mutate(this._flip,e)}get onTop(){return this._onTop.value}set onTop(e){this._onTop.value=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){if(this.linkedTo!==e)if(e!==null){if(e===this.id)throw new Error("Object cannot link to itself.");const o=this.panel.objects[e];let s=o;for(;s.linkedTo!==null;){if(s.linkedTo===this.id)throw new Error("Objects cannot be linked recursively.");s=this.panel.objects[s.linkedTo]}const i=o.globalTransform.inverse().multiply(this.globalTransform);this.mutateByMatrix(i),this.mutate(this._linkedTo,e)}else this.mutateByMatrix(this.globalTransform),this.mutate(this._linkedTo,null)}mutateByMatrix(e){const o=Mp(e);this.mutateX([this._scaleX,this._scaleY,this._skewX,this._skewY,this._rotation,this._x,this._y],[dt(o.scaleX),dt(o.scaleY),dt(o.skewX),dt(o.skewY),dt(o.rotation),dt(o.x),dt(o.y)])}get scaleX(){return this._scaleX.value}set scaleX(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[dt(e),dt(e*this.ratio)]):this.mutate(this._scaleX,dt(e))}get scaleY(){return this._scaleY.value}set scaleY(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[dt(e/this.ratio),dt(e)]):this.mutate(this._scaleY,dt(e))}get skewX(){return this._skewX.value}set skewX(e){this.mutate(this._skewX,dt(ro(e,180)))}get skewY(){return this._skewY.value}set skewY(e){this.mutate(this._skewY,dt(ro(e,180)))}get rotation(){return this._rotation.value}set rotation(e){this.mutate(this._rotation,dt(ro(e,360)))}get isTalking(){return this._isTalking.value}get localTransform(){return this._localTransform.value}get globalTransform(){return this._globalTransform.value}get label(){return this._label.value}set label(e){this.mutate(this._label,e)}get textboxColor(){return this._textboxColor.value}set textboxColor(e){this.mutate(this._textboxColor,e)}get enlargeWhenTalking(){return this._enlargeWhenTalking.value}set enlargeWhenTalking(e){this.mutate(this._enlargeWhenTalking,e)}get nameboxWidth(){return this._nameboxWidth.value}set nameboxWidth(e){this.mutate(this._nameboxWidth,e)}fixContentPackRemoval(e){}moveAllRefs(e,o){for(const[s,r]of Object.entries(e))ge(r)&&(s==="_filters"?o[s].value=r.value.map(i=>yt(i.clone())):s==="_choices"?o[s].value=r.value.map(i=>({...i})):o[s].value=r.value)}loadPropsFromSave(e,o){for(const[s,r]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(s.startsWith("_")){const i=r.value,l=s.substring(1);if(l==="version")continue;l in e&&ge(i)&&!ln(i)&&!("effect"in i)&&(l==="linkedTo"?i.value=o.get(e[l]):l==="filters"?i.value=Ea(e[l]):i.value=e[l])}}save(){const e={id:this.id,type:this.type,panelId:this.panelId,onTop:this.onTop};for(const[o,s]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(o.startsWith("_")){const r=s.value;ge(r)&&!ln(r)&&!("effect"in r)&&(o==="_filters"?e.filters=r.value.map(i=>i.getSave()):e[o.substring(1)]=r.value)}return e}}function dt(n){return Math.round(n*100)/100}let Dp=class Is extends Co{constructor(e,o,s,r){super(e,r??!1,s);C(this,"_freeMove",R(!1));C(this,"_close",R(!1));C(this,"_styleGroupId",R(0));C(this,"_styleId",R(0));C(this,"_poseId",R(0));C(this,"_posePositions",R({}));C(this,"_characterData",E(()=>Rt.characters.get(this.characterType)));C(this,"_poseData",E(()=>{var e,o,s;return(s=(o=(e=this._characterData.value)==null?void 0:e.styleGroups[this._styleGroupId.value])==null?void 0:o.styles[this._styleId.value])==null?void 0:s.poses[this._poseId.value]}));C(this,"_headData",E(()=>{var o,s;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:(s=this._characterData.value)==null?void 0:s.heads[e[0]]}));C(this,"_availablePartsKeys",E(()=>{const e=this._poseData.value;if(!e)return[];const o=Object.keys(e.positions).filter(s=>e.positions[s].length>1);return e.compatibleHeads.length>0&&o.unshift("head"),o}));C(this,"_heads",E(()=>{var o;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:this._characterData.value.heads[e[this.posePositions.headType||0]]}));this.characterType=o;const i=fe(),l=this.charData,a=l.hd?i.Base.hdCharacterScaleFactor:i.Base.sdCharacterScaleFactor;this._y.value=i.Base.BaseCharacterYPos,this._width.value=l.size[0],this._height.value=l.size[1],this._scaleX.value=l.defaultScale[0]*a,this._scaleY.value=l.defaultScale[1]*a,this._label.value=l.label??l.id,this._enlargeWhenTalking.value=ls.defaultCharacterTalkingZoom}get type(){return"character"}static create(e,o){return new Is(e,o)}makeClone(e,o){const s=new Is(e,this.characterType,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Is(e,o.characterType,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.characterType=this.characterType,e}get freeMove(){return this._freeMove.value}set freeMove(e){if(!(!e&&this.linkedTo!=null))if(e)this.mutate(this._freeMove,!0);else{const o=fe();this.mutateX([this._freeMove,this._x,this._y],[!1,o.Base.characterPositions[Ms(this.x)],o.Base.BaseCharacterYPos])}}get x(){return this._x.value}set x(e){this.freeMove||(e=fe().Base.characterPositions[Ms(e)]),super.x=e}get y(){return this._y.value}set y(e){this.freeMove||(e=fe().Base.BaseCharacterYPos),super.y=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){super.linkedTo=e,this._linkedTo.value!=null&&this.mutate(this._freeMove,!0)}shiftCharacterSlot(e){const o=fe();let r=Ms(this.x)+e;r<0&&(r=0),r>=o.Base.characterPositions.length&&(r=o.Base.characterPositions.length-1),this.x=o.Base.characterPositions[r]}get close(){return this._close.value}set close(e){this.mutate(this._close,e)}get styleId(){return this._styleId.value}set styleId(e){this.mutate(this._styleId,e)}get styleGroupId(){return this._styleGroupId.value}get posePositions(){return this._posePositions.value}get poseId(){return this._poseId.value}setPosePosition(e){this.mutate(this._posePositions,{...this._posePositions.value,...e})}seekPart(e,o){if(e==="head"){this.seekHead(o);return}const s=this._poseData.value;s.positions[e]&&this.setPosePosition({[e]:Lo(s.positions[e],this.posePositions[e]||0,o)})}seekPose(e){const s=this._characterData.value.styleGroups[this._styleGroupId.value].styles[this.styleId].poses;this.mutatePoseAndPositions(r=>{r.poseId=Lo(s,r.poseId,e)})}seekStyle(e){const s=this._characterData.value.styleGroups.flatMap((i,l)=>i.styles.map((a,u)=>({styleGroupIdx:l,styleIdx:u,styleGroupJson:JSON.stringify(a.components)}))).sort((i,l)=>i.styleGroupJson.localeCompare(l.styleGroupJson)),r=s.findIndex(i=>i.styleGroupIdx===this.styleGroupId&&i.styleIdx===this.styleId);this.mutatePoseAndPositions(i=>{const l=Lo(s,r,e),a=s[l];i.styleGroupId=a.styleGroupIdx,i.styleId=a.styleIdx})}seekHead(e){const o=this._characterData.value,s=this._poseData.value,r=this.posePositions;if(s.compatibleHeads.length===0)return null;let i=r.headType||0,l=o.heads[s.compatibleHeads[i]];if(!l)return;let a=(r.head||0)+e;(a<0||a>=l.variants.length)&&(i=Lo(s.compatibleHeads.map(u=>o.heads[u]),i,e),l=o.heads[s.compatibleHeads[i]],a=e===1?0:l.variants.length-1),this.setPosePosition({head:a,headType:i})}setPart(e,o){e==="pose"?this.mutatePoseAndPositions(s=>{s.poseId=o}):e==="style"?this.mutatePoseAndPositions(s=>{s.styleId=o}):this.mutatePoseAndPositions(s=>{s.posePositions[e]=o})}setCharStyle(e,o){this.mutatePoseAndPositions(s=>{s.styleGroupId=e,s.styleId=o})}get charData(){return this._characterData.value}get poseData(){return this._poseData.value}get availablePartsKeys(){return this._availablePartsKeys.value}mutatePoseAndPositions(e){const o=this._characterData.value,s=this.buildPoseAndPositionData();e(s),o.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=o.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const i=r.styles[s.styleId];i.poses[s.poseId]||(s.poseId=0);const l=i.poses[s.poseId];for(const f in l.positions)l.positions[f]&&(l.positions[f][s.posePositions[f]]||(s.posePositions[f]=0));const u=o.styleGroups[this._styleGroupId.value].styles[this.styleId].poses[this._poseId.value].compatibleHeads[this._posePositions.value.headType||0],c=l.compatibleHeads.indexOf(u);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),this.commitPoseAndPositionChanges(s)}commitPoseAndPositionChanges(e){JSON.stringify(e.posePositions)!==JSON.stringify(this._posePositions.value)&&this.mutate(this._posePositions,e.posePositions),this.mutateX([this._styleGroupId,this._styleId,this._poseId],[e.styleGroupId,e.styleId,e.poseId])}buildPoseAndPositionData(){return{styleGroupId:this._styleGroupId.value,styleId:this._styleId.value,poseId:this._poseId.value,posePositions:{...this._posePositions.value}}}get headsData(){return this._heads.value}};function Ms(n){return fe().Base.characterPositions.map((o,s)=>({pos:Math.abs(n-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}let Bp=class Ds extends Co{constructor(e,o,s){super(e,s??!0,o);C(this,"_customColor");C(this,"_choices",R([{selected:!1,text:"Click here to edit choice"}]));C(this,"_choiceDistance");C(this,"_autoWrap",R(!0));const r=fe();this._choiceDistance=R(r.Choices.ChoiceSpacing),this._customColor=R(r.Choices.ChoiceButtonColor),this._y.value=r.Choices.ChoiceY,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"choice"}static create(e){return new Ds(e)}makeClone(e,o){const s=new Ds(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Ds(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get choices(){return this._choices.value}addChoice(e){const o={selected:!1,text:e};We(()=>void this._choices.value.push(o))}removeChoice(e){this._choices.value[e],We(()=>void this._choices.value.splice(e,1))}setChoiceProperty(e,o,s){this._choices.value[e][o];const r=this._version.value;We(()=>{this._choices.value[e][o]=s,this._version.value=r+1})}get choiceDistance(){return this._choiceDistance.value}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}},Ep=class Bs extends Co{constructor(e,o,s){super(e,s??!0,o);C(this,"_text",R("Click here to edit notification"));C(this,"_autoWrap",R(!1));C(this,"_backdrop",R(!0));C(this,"_customColor");const r=fe();this._customColor=R(r.Choices.ChoiceButtonColor),this._y.value=r.Base.screenHeight/2,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"notification"}static create(e){return new Bs(e)}makeClone(e,o){const s=new Bs(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Bs(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get backdrop(){return this._backdrop.value}set backdrop(e){this.mutate(this._backdrop,e)}},Bl=class No extends Co{constructor(e,o,s,r){super(e,r??!0,s);C(this,"_autoWrap",R(!0));C(this,"_overflow",R(!1));C(this,"_text",R(""));C(this,"_background",R(0));C(this,"_font",R(0));C(this,"_consoleColor",R(null));this.subtype=o;const i=fe();o==="poem"?(this._x.value=i.Poem.defaultX,this._y.value=i.Poem.defaultY,this._height.value=i.Poem.defaultPoemHeight,this._width.value=i.Poem.defaultPoemWidth,this._background.value=i.Poem.defaultPoemBackground,this._font.value=i.Poem.defaultPoemStyle,this._text.value=`New poem

Click here to edit poem`):(this._x.value=i.Poem.consoleWidth/2,this._y.value=i.Poem.consoleHeight/2,this._height.value=i.Poem.consoleHeight,this._width.value=i.Poem.consoleWidth,this._background.value=i.Poem.defaultConsoleBackground,this._font.value=i.Poem.defaultConsoleStyle,this._text.value=`> _
  
  Console command
  Click here to edit`)}get type(){return"poem"}static createPoem(e){return new No(e,"poem")}static createConsole(e){return new No(e,"console")}makeClone(e,o){const s=new No(e,this.subtype,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new No(e,o.subtype,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.subtype=this.subtype,e}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get background(){return this._background.value}set background(e){this.mutate(this._background,e)}get font(){return this._font.value}set font(e){this.mutate(this._font,e)}get consoleColor(){return this._consoleColor.value}set consoleColor(e){this.mutate(this._consoleColor,e)}};class Nn{constructor(t){C(this,"width");C(this,"height");this.html=t,this.width=t.width,this.height=t.height}paintOnto(t,e={}){const{w:o,h:s}={w:this.width,h:this.height,...e},{x:r,y:i}={x:-o/2,y:-s/2,...e};t.drawImage(this.html,r,i,o,s)}}let La=class Es extends Co{constructor(t,e,o,s,{width:r,height:i}={}){super(t,s??!1,o),this.assets=e,r!=null&&(this._width.value=r),i!=null&&(this._height.value=i);const l=fe();this._y.value=l.Base.screenHeight/2,this._enlargeWhenTalking.value=ls.defaultCharacterTalkingZoom}get type(){return"sprite"}static async create(t,e){const o=await Fa(e[0],!1);if(o instanceof Nn)return new Es(t,e,void 0,!1,{width:o.width,height:o.height})}makeClone(t,e){const o=new Es(t,this.assets,e.get(this.id));return this.moveAllRefs(this,o),o}static fromSave(t,e,o){const s=new Es(t,e.assets,o.get(e.id),e.onTop);return s.loadPropsFromSave(e,o),s}save(){const t=super.save();return t.assets=this.assets,t}};const ud=5;class fw{constructor(t){C(this,"pos",0);this.str=t}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-ud),this.pos+ud)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function cd(n,t=!0){const e=[],o=new fw(n);let s=Rr;for(;s!==Ar;){const r=o.pos;try{s=s(e,o)}catch(i){if(t&&s!==El)o.pos=r,s=(l,a)=>El(l,a,!0);else throw i}}return e}function Rr(n,t){return t.current()===void 0?Ar:t.current()==="{"?pw:t.current()===`
`?hw:El}function Ar(){return Ar}function El(n,t,e=!1){const{pos:o}=t;let s="",r=e,i;for(;;){if(t.current()===void 0){i=Ar;break}else if(r)s+=t.current(),r=!1;else if(t.current()==="\\")r=!0;else if(t.current()==="{"||t.current()===`
`){i=Rr;break}else s+=t.current();t.next()}return n.push({type:"text",pos:o,content:s}),i}function cl(n,t){throw new Error(`Error when parsing text at position ${n.pos}: (around: "${n.around}") ${t}`)}function pw(n,t){const{pos:e}=t;if(t.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=t.next()==="/";o&&t.next();let s="",r="",i=!1;for(;t.current()===void 0&&cl(t,"Unexpected end of text inside a command"),t.current()!=="}";)i?r+=t.current():t.current().match(/[a-z]/i)?s+=t.current():t.current()==="="?(o&&cl(t,"Closing commands may not contain arguments"),i=!0):cl(t,`Unexpected character '${t.current()}' in command name.`),t.next();return t.next(),o?n.push({type:"commandClose",commandName:s,pos:e}):n.push({type:"command",pos:e,argument:r,commandName:s}),Rr}function hw(n,t){return n.push({type:"newline",pos:t.pos}),t.next(),Rr}function po(n){n.width=0,n.height=0,Na.delete(n.disposalId||0)}function Hn(){const n=document.createElement("canvas");return gw(n),n}const Na=new Map;let vw=0;function gw(n){n.disposalId=vw++,!(typeof WeakRef>"u")&&Na.set(n.disposalId,new WeakRef(n))}window.addEventListener("unload",()=>{Na.forEach(n=>{const t=n.deref();t&&po(t)})});const dd=new Map([zn("i",n=>({...n,isItalic:!0})),zn("b",n=>({...n,isBold:!0})),zn("u",n=>({...n,isUnderlined:!0})),zn("s",n=>({...n,isStrikethrough:!0})),zn("plain",n=>({...n,isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),zn("edited",n=>({...n,fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),Ps("k",(n,t,e)=>({...n,letterSpacing:t?n.letterSpacing+e:e})),Ps("size",(n,t,e)=>({...n,fontSize:t?n.fontSize+e:e})),Ps("alpha",(n,t,e)=>({...n,alpha:t?n.alpha+e:e})),Ps("stroke",(n,t,e)=>({...n,strokeWidth:t?n.strokeWidth+e:e})),["font",(n,t)=>({...n,fontName:t})],["color",(n,t)=>({...n,color:t})],["outlinecolor",(n,t)=>({...n,strokeColor:t})]]);function zn(n,t){return[n,(e,o)=>{if(o!=="")throw new Error(`Operator '${n}' does not take any arguments.`);return t(e)}]}function Ps(n,t){return[n,(e,o)=>{if(o=="")throw new Error(`Operator '${n}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${n}' needs a numeric argument.`);return t(e,s,r)}]}class Mt{constructor(t,e){C(this,"renderParts");C(this,"tokens");C(this,"loose");C(this,"lastLayoutHeight",null);C(this,"lastLayoutWidth",null);this.str=t,this.baseStyle=e,this.loose=he.state.looseTextParsing;try{this.tokens=cd(t,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=Mt.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const t=new Set;let e=null;for(const s of this.renderParts)"style"in s&&s.style!==e&&(e=s.style,e.fontName&&t.add(e.fontName));const o=[];for(const s of t){const r=document,i=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(i)||o.push(r.fonts.load(i))}if(o.length!==0)return Promise.all(o).then(()=>{const s=cd(this.str);this.renderParts=Mt.getRenderParts(s,this.baseStyle,this.loose)})}render(t){t.save();let e=null;for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),e.strokeWidth>0&&e.strokeColor>""&&t.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),t.fillText(o.character,o.x,o.y));t.restore()}quote(){let t;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(t||(t={}));let e=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const i=this.renderParts[r];if(i.type==="character")switch(o){case 0:if(i.character.match(/\s/))continue;i.character==='"'?(o=1,e=r):i.character==="*"?(o=3,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Io(i.style,'"')}),r++,e=r,o=2);break;case 1:e=r,i.character==='"'&&(o=0);break;case 2:if(i.character.match(/\s/))continue;i.character==="*"&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Io(i.style,'"')}),o=3,r++),e=r;break;case 3:i.character==="*"&&(o=0),e=r;break;default:throw new Kt.UnreachableCaseError(o)}}const s=this.renderParts[e];s&&o===3&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:Io(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:Io(s.style,'"')})}applyLayout(t,e,o,s,r){const i=this.renderParts,l=[];let a=null,u=0,c=0;const f=()=>{a={type:"group",renderParts:[],height:0,width:0},u=s,c=-1,l.push(a)};f();for(const p of i)if(p.type==="newline"||p.type==="alignment")if(l.push(p),p.type==="alignment"&&r){const P=u;f(),u=P}else f();else{if(u<p.width&&r){const P={type:"newline",height:p.height,width:p.height,x:0,y:0};if(p.character===" "){l.push(P),f();continue}else if(c!==-1){const M=a.renderParts.splice(c).slice(1),N=M.reduce((O,T)=>O+T.width,0),b=M.reduce((O,T)=>O>T.height?O:T.height,0);a.width-=N,a.height===b&&(a.height=a.renderParts.reduce((O,T)=>O>T.height?O:T.height,0)),l.push(P),f(),a.renderParts=M,a.width=N,a.height=b,u-=N}}else p.character===" "&&(c=a.renderParts.length);a.renderParts.push(p),a.height=Math.max(a.height,p.height),a.width+=p.width,u-=p.width}const g=[];let m=0;for(const p of l)m=Math.max(m,p.height),p.type==="newline"&&(g.push(m),m=0);g.push(m);let _=0,k=t,y=o,w=0,h=s;for(const p of l){if(p.type==="newline"){y+=g[++_]||0,w=0,h=s;continue}if(p.type==="alignment"){k=p.alignment;continue}switch(k){case"left":v(p,w,y),w+=p.width;break;case"center":v(p,w+(h-w)/2-p.width/2,y);break;case"right":v(p,h-p.width,y),h-=p.width;break}}this.lastLayoutHeight=y,this.lastLayoutWidth=s;function v(p,P,M){let N=P;for(const b of p.renderParts)b.y=M,b.x=e+N,N+=b.width}}getHeight(t){let e=0,o=0;const s=t===0?this.renderParts:Mt.applyLineWrapping(this.renderParts.slice(0),t);for(const r of s)e=Math.max(e,r.height),r.type==="newline"&&(o+=e,e=0);return o+=e,o}getWidth(){let t=0,e=0;for(const o of this.renderParts)t+=o.width,o.type==="newline"&&(e=Math.max(e,t),t=0);return e=Math.max(e,t),e}static getRenderParts(t,e,o){const s=[],r=[],i=[];let l=hd(e),a=e,u=null;function c(f){for(const g of f)s.push({type:"character",character:g,height:l,width:Io(a,g),style:a,x:0,y:0})}for(const f of t){const g=f.type;switch(g){case"command":if(f.commandName==="align"){const m=f.argument.toLowerCase();if(m!=="left"&&m!=="center"&&m!=="right")if(o){c("{align="+f.argument+"}");continue}else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);s.push({type:"alignment",alignment:m,height:l,width:0,x:0,y:0})}else if(dd.has(f.commandName)){r.push(a),i.push(u);try{a=dd.get(f.commandName)(a,f.argument),l=hd(a),u=f}catch(m){if(o){r.pop(),i.pop(),c("{"+f.commandName+(f.argument?"="+f.argument:"")+"}"),console.error("Parsing error",m);continue}else throw m}}else if(o)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!u)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==u.commandName)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${u}' first. (Opened at position ${u.pos})`);u=i.pop(),a=r.pop();break;case"newline":s.push({height:l,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new Kt.UnreachableCaseError(g)}}return s}static applyLineWrapping(t,e){let o=-1,s=0,r=0;const i=[];for(const l of t)if(l.type==="newline")o=-1,s=0,r=0,i.push(l);else if(l.type==="alignment")console.error("Alignment in context where it's not supported.");else if(l.type==="character")l.character===" "?s>e?(o=-1,s=0,r=0,i.push({type:"newline",height:l.height,width:0,x:0,y:0})):(s+=l.width,r=s,o=i.length,i.push(l)):(s+=l.width,s>e&&o!==-1&&(s-=r,i.splice(o,1,{type:"newline",height:l.height,width:0,x:0,y:0}),o=-1,r=0),i.push(l));else throw new Kt.UnreachableCaseError(l);return i}}const Ha=Hn();Ha.width=0;Ha.height=0;const fd=Ha.getContext("2d");let pd=null;function Io(n,t){n!==pd&&(Ll(n,fd),pd=n);let e=n.letterSpacing;return(typeof e!="number"||isNaN(e)||!isFinite(e))&&(e=0),fd.measureText(t).width+e}const dl=new Map;function hd(n){const t=n.fontSize+" "+n.fontName;if(dl.has(t))return dl.get(t)*n.lineSpacing;const e=document.createElement("span");e.innerHTML="Hg",e.style.fontFamily=n.fontName,e.style.fontSize=`${n.fontSize}px`,e.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=n.fontName,o.style.fontSize=`${n.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(e),document.body.appendChild(o);try{const s=o.offsetHeight;return dl.set(t,s),s*n.lineSpacing}finally{o.remove()}}function Ll(n,t){t.textAlign="left",t.font=(n.isItalic?"italic ":"")+(n.isBold?"bold ":"")+n.fontSize+"px "+n.fontName,t.lineJoin="round",n.strokeWidth>0&&n.strokeColor>""?(t.strokeStyle=n.strokeColor,t.lineWidth=n.strokeWidth):(t.strokeStyle="",t.lineWidth=0),t.globalAlpha=n.alpha||0,t.fillStyle=n.color}var on=(n=>(n[n.None=0]="None",n[n.Selected=1]="Selected",n[n.Focused=2]="Focused",n[n.Indirectly=4]="Indirectly",n))(on||{});const mw={0:void 0,1:"#f00",2:"#00f",3:"#f0f",4:"#f66",6:"#f6f"};function Lp(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.arcTo(t+o,e+s,t,e+s,r),n.arcTo(t,e+s,t,e,r),n.arcTo(t,e,t+o,e,r),n.closePath()}function Np(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.lineTo(t+o,e+s),n.lineTo(t,e+s),n.arcTo(t,e,t+o,e,r),n.closePath()}function wn(n,t){n.save();try{t()}finally{n.restore()}}function Go(n,t){t.align&&(n.textAlign=t.align),t.font!=null&&(n.font=t.font),t.fill&&(n.fillStyle=t.fill.style),t.outline&&(n.strokeStyle=t.outline.style,n.lineWidth=t.outline.width)}function bw(n,t){if("filter"in n){let e="";for(const o of t)o.type==="drop-shadow"?e+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?e+=` hue-rotate(${o.value}deg)`:o.type==="blur"?e+=` blur(${o.value}px)`:e+=` ${o.type}(${o.value*100}%)`;n.filter=(n.filter==="none"?"":n.filter)+e.trimStart()}else{let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);n.globalAlpha*=e}}class Hp{constructor(t){C(this,"lastVersion",null);C(this,"localCanvasInvalid",!0);C(this,"lastHit",null);C(this,"lastLocalTransform",null);C(this,"transformOverride",null);C(this,"hitDetectionFallback",!1);C(this,"localCanvas",null);this.obj=t}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let t=new DOMMatrix;const e=this.obj;t=t.translate(this.x,this.y);const o=this.height/2*e.scaleX;return"close"in e&&e.close&&(t=t.translate(0,fe().Base.CloseUpYOffset),t=t.translate(0,-o),t=t.scale(2,2),t=t.translate(0,o)),this.isTalking&&e.enlargeWhenTalking&&(t=t.translate(0,+o),t=t.scale(1.05,1.05),t=t.translate(0,-o)),(e.flip||e.rotation!==0||e.scaleX!==1||e.scaleY!==1||e.skewX!==0||e.skewY!==0)&&(e.rotation!==0&&(t=t.rotate(0,0,e.rotation)),e.skewX!==0&&(t=t.skewX(e.skewX)),e.skewY!==0&&(t=t.skewY(e.skewY)),e.flip&&(t=t.flipX()),(e.scaleX!==1||e.scaleY!==1)&&(t=t.scale(e.scaleX,e.scaleY))),t}getLocalSize(){if(this.transformIsLocal){const t=fe();return new DOMPointReadOnly(t.Base.screenWidth,t.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.obj.isTalking}get linkedTo(){return this.obj.linkedTo}get transform(){return this.transformOverride!=null?this.transformOverride:this.obj.globalTransform}prepareRender(t){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const e=this.transform;Xy(e,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=e)}else this.lastLocalTransform=null}render(t,e,o,s,r){o||(e=on.None),(!this.canSkipLocal||e!==on.None)&&(r=!1);const i=this.getLocalSize(),l=this.transform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==i.x||this.localCanvas.height!==i.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=Hn()),this.localCanvas.width=i.x,this.localCanvas.height=i.y;const u=this.localCanvas.getContext("2d");if(!u)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&u.setTransform(l),this.renderLocal(u,s),this.localCanvasInvalid=!1,u.resetTransform()}const a=mw[e];wn(t,()=>{a!=null&&(t.shadowColor=a,t.shadowBlur=20),(!this.transformIsLocal||r)&&t.setTransform(l),t.globalCompositeOperation=this.obj.composite??"source-over",bw(t,this.obj.filters),r?this.renderLocal(t,s):this.localCanvas&&this.localCanvas.height!==0&&this.localCanvas.width!==0&&t.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(t){const e=t.matrixTransform(this.transform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(e.x<0||e.y<0||e.x>o.x||e.y>o.y)return console.log("Hitbox text",e),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?t:e;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}class Ir extends Hp{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const t=this.obj.globalTransform;return"overflow"in this.obj&&this.obj.overflow?!0:he.supports.limitedCanvasSpace?!1:!(t.a===1&&t.b===0&&t.c===0&&t.d===1)}}class Wa{constructor(t){C(this,"nextArrow",null);this.base=t}static get defaultWidth(){return yo}static get defaultHeight(){return Sr+Ln}static get defaultX(){return fe().Base.screenWidth/2}static get defaultY(){return fe().Base.screenHeight-this.defaultHeight/2-fe().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Pa}getControlsDisabledStyle(){return op}get textboxStyle(){return Oa}renderControls(t,e){const s=this.width/2,r=this.getControlsStyle();Go(t,r),t.fillText("History",s+wa,e),Go(t,this.base.obj.skip?r:this.getControlsDisabledStyle()),t.fillText("Skip",s+ka,e),Go(t,r),t.fillText("Auto   Save   Load   Settings",s+Ca,e)}prepare(){if(!(this.nextArrow instanceof Nn))return(async()=>{this.nextArrow=await us("next")})()}}class Jn extends Wa{constructor(){super(...arguments);C(this,"backgroundImage","textbox");C(this,"xOffset",0);C(this,"nameBoxAsset",null);C(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return Sr+Ln}get width(){return yo}get nameboxWidth(){return bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}renderNamebox(e,o,s){var r;(r=this.nameBoxAsset)==null||r.paintOnto(e,{x:o,y:s})}renderBackdrop(e,o,s){var r;o+=this.xOffset,(r=this.backdropAsset)==null||r.paintOnto(e,{x:o,y:s})}render(e){var l;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,i=r-ya;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&((l=this.nextArrow)==null||l.paintOnto(e,{x:o-_a,y:r-xa}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof Nn?void 0:(async()=>{this.backdropAsset=await us(this.backgroundImage)})(),this.nameBoxAsset instanceof Nn?void 0:(async()=>{this.nameBoxAsset=await us("namebox")})()])}}C(Jn,"id","normal"),C(Jn,"label","Normal"),C(Jn,"priority",0),C(Jn,"gameMode","ddlc");class Ho extends Jn{constructor(){super(...arguments);C(this,"backgroundImage","textbox_monika");C(this,"xOffset",(yo-ba)/2)}}C(Ho,"id","corrupt"),C(Ho,"label","Corrupted"),C(Ho,"priority",1),C(Ho,"gameMode","ddlc");class Zn extends Wa{constructor(){super(...arguments);C(this,"_dotPattern",null);C(this,"_lastColor",null);C(this,"backgroundImage","textbox");C(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){const e=this.refObject.value;return e&&e.nameboxWidth!==null?e.nameboxWidth:this.obj.customNameboxWidth??bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return{...Tr,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return ms}get textOffsetY(){return Pr}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject.value;return e!=null&&e.textboxColor!=null?e.textboxColor:Xf}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(Yf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(Gf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Np(e,o,s,r,i,Zf),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Ne.fromCss(this.nameboxBackgroundColor),u=new Ne(a.r,a.g,a.b,.95),c=u.toHSL().shift(Jf).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(Kf,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=Ne.fromCss(this.customColor),r=s.toHSL(),i=this.obj.height-o,l=this.obj.width,a=()=>Lp(e,Yn/2,o+Yn/2,l-Yn,i-Yn,Qf);wn(e,()=>{e.beginPath(),a(),e.clip();const c=e.createLinearGradient(0,o,0,i);c.addColorStop(0,s.toCss()),c.addColorStop(1,`rgba(${s.r},${s.g},${s.b},0.6667)`),e.fillStyle=c,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,l,i),wn(e,()=>{e.translate(0,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,0,l,i)});const f=e.createLinearGradient(0,o+i-Ml,0,o+i);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(l/2,o+i,np,Ml,0,0,2*Math.PI),e.closePath(),e.fill()});const u=r.shift(ep).toRgb().toCss();e.strokeStyle=u,e.lineWidth=Yn,e.beginPath(),a(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-ya;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-_a,y:r-xa})}getDotPattern(e=tp){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;this._lastColor=this.customColor;const{dotPatternSize:o,dotColorDelta:s,dotRadius:r}=e,i=Ne.fromCss(this.customColor).toHSL(),l=Hn();l.height=o,l.width=o;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=i.shift(s).toRgb().toCss();function u(f,g){a.beginPath(),a.ellipse(f,g,r,r,0,0,2*Math.PI),a.closePath(),a.fill()}u(0,0),u(o,0),u(0,o),u(o,o),u(o/2,o/2);const c=a.createPattern(l,"repeat");if(!c)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=c,c}}C(Zn,"id","custom"),C(Zn,"label","Custom"),C(Zn,"priority",0),C(Zn,"gameMode","ddlc");const fr=class fr{constructor(t){C(this,"nextArrow",null);this.base=t}static get resizable(){return!1}static get defaultWidth(){return ja}static get defaultHeight(){return wp+Aa}static get defaultX(){return fe().Base.screenWidth/2}static get defaultY(){return fe().Base.screenHeight-this.defaultHeight/2-fe().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return or}getControlsDisabledStyle(){return Rp}renderControls(t,e){const o=this.width,s=o/2,i=s-s,l=this.getControlsStyle(),a=["History","Skip","Auto","Save","Load","Settings"],u=[];let c=0;for(const m of a){const _=fr.controlWidth(t,m);u.push(_),c+=_}const f=Math.min((o-c)/(a.length+2),78);let g=i+(o-c-f*(a.length-1))/2;for(let m=0;m<a.length;++m){const _=a[m],k=u[m],y=_==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():l;Go(t,y),t.fillText(_,g,e),g+=k+f}}static controlWidth(t,e){if(this.widthCache[e])return this.widthCache[e];Go(t,or);const o=t.measureText(e).width;return this.widthCache[e]=o,o}prepare(){if(!(this.nextArrow instanceof Nn))return(async()=>{this.nextArrow=await us("next_plus")})()}};C(fr,"widthCache",{});let Nl=fr;class Wo extends Nl{constructor(){super(...arguments);C(this,"_lastColor",null);C(this,"_dotPattern",null);C(this,"backgroundImage","textbox");C(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){const e=this.refObject.value;return e&&e.nameboxWidth!=null?e.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ia}get nameboxHeight(){return Aa}get nameboxOffsetX(){return Ma}get nameboxOffsetY(){return Cp}get nameboxStyle(){return{...jp,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return Ra}get textOffsetY(){return kp}get textboxStyle(){return Ap}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject.value;return e!=null&&e.textboxColor!=null?e.textboxColor:cp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(dp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(fp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Np(e,o,s,r,i,vp),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Ne.fromCss(this.nameboxBackgroundColor),u=new Ne(a.r,a.g,a.b,.95),c=u.toHSL().shift(hp).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(pp,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=this.obj.height-o,r=this.obj.width,i=Ne.fromCss(this.customColor).toHSL(),l=()=>Lp(e,Gn/2,o+Gn/2,r-Gn,s-Gn,gp);wn(e,()=>{e.beginPath(),l(),e.clip();const u=e.createLinearGradient(0,o,0,o+s),c=Ne.fromHex(this.customColor);u.addColorStop(0,c.toCss()),u.addColorStop(1,`rgba(${c.r},${c.g},${c.b},0.6667)`),e.fillStyle=u,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,r,s),e.strokeRect(0,o,r,s),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,o,r,s);const f=e.createLinearGradient(0,o+s-Dl,0,o+s);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(r/2,o+s,$p,Dl,0,0,2*Math.PI),e.closePath(),e.fill()});const a=i.shift(mp).toRgb().toCss();e.strokeStyle=a,e.lineWidth=Gn,e.beginPath(),l(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-_p;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-Op,y:r-Tp})}getDotPattern(){return Zn.prototype.getDotPattern.call(this,bp)}}C(Wo,"id","custom_plus"),C(Wo,"label","Custom (Plus)"),C(Wo,"priority",0),C(Wo,"gameMode","ddlc_plus");class Vo extends Wa{static get resizable(){return!0}get height(){return Sr+Ln}get width(){return yo}get nameboxWidth(){return bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}get textboxStyle(){return Oa}async render(){}}C(Vo,"id","none"),C(Vo,"label","None"),C(Vo,"priority",0),C(Vo,"gameMode","ddlc");const yw=[Jn,Ho,Zn,Vo,Wo],Ko=(()=>{const n={};for(const t of yw)n[t.id]=t;return n})();class ww extends Ir{constructor(){super(...arguments);C(this,"nbTextRenderer",null);C(this,"textRenderer",null);C(this,"_lastRefVars",null);C(this,"refObject",E(()=>{var e;return this.obj.talkingObjId==null?null:((e=V.panels.panels[this.obj.panelId])==null?void 0:e.objects[+this.obj.talkingObjId])??null}));C(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject.value;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:((e=this.refObject.value)==null?void 0:e.label)??"Missing name"}get canSkipLocal(){var e;return super.canSkipLocal&&(((e=this._lastRenderer)==null?void 0:e.allowSkippingLocal)??!0)}prepareRender(e){const o=super.prepareRender(e),s=this.textboxRenderer.prepare(),r=this.getRefVars();r!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=r),this.nbTextRenderer=new Mt(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new Mt(this.obj.text,this.textboxRenderer.textboxStyle);const i=this.nbTextRenderer.loadFonts(),l=this.textRenderer.loadFonts();if(!(!o&&!s&&!i&&!l))return Promise.all([o,s,i,l])}renderLocal(e){const o=this.textboxRenderer,s=o.width;if(!this.obj.overflow){const r=new Path2D;r.rect(0,0,o.width,this.height),e.clip(r)}o.render(e),this.obj.talkingObjId!==null&&this.renderName(e),this.renderText(e,0,0,s)}renderName(e){const o=this.textboxRenderer,s=o.nameboxWidth,r=o.nameboxOffsetX,i=o.nameboxOffsetX/2;console.log("rendering name",e.getTransform()),this.nbTextRenderer.applyLayout("center",r+i,o.nameboxOffsetY,s-i*2,!1),this.nbTextRenderer.render(e)}renderText(e,o,s,r){const i=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.applyLayout("left",o+i.textOffsetX,s+i.nameboxHeight+i.textOffsetY,r-i.textOffsetX*2,this.obj.autoWrap),l.render(e)}get forcedStyle(){const e=this.refObject.value;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,o=Ko[e];if(this._lastRenderer&&this._lastRenderer.constructor===o)return this._lastRenderer;const s=new o(this);return this._lastRenderer=s,s}}const vd=4;class bn extends Co{constructor(e,o,s,{text:r,resetBounds:i,style:l}={}){super(e,s??!0,o);C(this,"_text",R("Click here to edit the textbox"));C(this,"_talkingObjId",R(null));C(this,"_talkingOther",R(""));C(this,"_autoQuoting",R(!0));C(this,"_overflow",R(!1));C(this,"_style",R("normal"));C(this,"_overrideColor",R(!1));C(this,"_customColor");C(this,"_deriveCustomColors",R(!0));C(this,"_customControlsColor");C(this,"_customNameboxColor");C(this,"_customNameboxStroke");C(this,"_customNameboxWidth",R(null));C(this,"_resetBounds");C(this,"_controls",R(!0));C(this,"_skip",R(!0));C(this,"_autoWrap",R(!0));C(this,"_continue",R(!0));const a=fe();l??(l=a.TextBox.DefaultTextboxStyle);const u=Ko[l];this._resetBounds=R(i??{x:u.defaultX,y:u.defaultY,width:u.defaultWidth,height:u.defaultHeight,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0}),this._customColor=R(a.TextBoxCustom.textboxDefaultColor),this._customControlsColor=R(a.TextBoxCustom.controlsDefaultColor),this._customNameboxColor=R(a.TextBoxCustom.nameboxDefaultColor),this._customNameboxStroke=R(a.TextBoxCustom.nameboxStrokeDefaultColor),this.applyResetBounds(),this._style.value=l,r&&(this._text.value=r)}get type(){return"textBox"}static create(e,o){return new bn(e,void 0,void 0,{text:o})}makeClone(e,o){const s=new bn(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new bn(e,s.get(o.id),o.onTop);return o.panelId!==e.id&&!s.has(o.talkingObjId)?o.talkingObjId=null:o.talkingObjId=s.get(o.talkingObjId)??o.talkingObjId,o.talkingObjId=o.talkingObjId??null,r.loadPropsFromSave(o,s),r}prepareSiblingRemoval(e){e.id===this.talkingObjId&&(this.talkingObjId=null),super.prepareSiblingRemoval(e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get talkingObjId(){return this._talkingObjId.value}set talkingObjId(e){this.mutate(this._talkingObjId,e)}get talkingOther(){return this._talkingOther.value}set talkingOther(e){this.talkingObjId==="$other$"?this.mutate(this._talkingOther,e):this.mutateX([this._talkingObjId,this._talkingOther],["$other$",e])}get autoQuoting(){return this._autoQuoting.value}set autoQuoting(e){this.mutate(this._autoQuoting,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get style(){return this._style.value}set style(e){const o=fe(),s=this.style,r=this.x,i=this.y,l=this.width,a=this.height,u=Ko[s],c=Ko[e];let f=r,g=i,m=l,_=a;const k=10;c.resizable?(u.defaultWidth!==c.defaultWidth&&(m=Math.max(m+c.defaultWidth-u.defaultWidth,k)),u.defaultHeight!==c.defaultHeight&&(_=Math.max(_+c.defaultHeight-u.defaultHeight,k))):(m=c.defaultWidth,_=c.defaultHeight),u.defaultX!==c.defaultX&&(f=sr(-m+k,f+c.defaultX-u.defaultX,o.Base.screenWidth-k)),u.defaultY!==c.defaultY&&(g=sr(-_+k,g+c.defaultY-u.defaultY,o.Base.screenHeight-k)),this.mutateX([this._x,this._y,this._height,this._width,this._style],[f,g,_,m,e])}get overrideColor(){return this._overrideColor.value}set overrideColor(e){this.mutate(this._overrideColor,e)}get customColor(){return this._customColor.value}set customColor(e){this.mutate(this._customColor,e)}get deriveCustomColors(){return this._deriveCustomColors.value}set deriveCustomColors(e){this.mutate(this._deriveCustomColors,e)}get customControlsColor(){return this._customControlsColor.value}set customControlsColor(e){this.mutate(this._customControlsColor,e)}get customNameboxColor(){return this._customNameboxColor.value}set customNameboxColor(e){this.mutate(this._customNameboxColor,e)}get customNameboxStroke(){return this._customNameboxStroke.value}set customNameboxStroke(e){this.mutate(this._customNameboxStroke,e)}get customNameboxWidth(){return this._customNameboxWidth.value}set customNameboxWidth(e){this.mutate(this._customNameboxWidth,e)}applyResetBounds(){const e=this._resetBounds.value;this.mutateX([this._x,this._y,this._height,this._width,this._rotation,this._skewX,this._skewY,this._scaleX,this._scaleY],[e.x,e.y,e.height,e.width,e.rotation,e.skewX,e.skewY,e.scaleX,e.scaleY])}splitTextbox(){const e=(this.width-vd)/2,o=e/2+vd/2,s=this.localTransform,r=s.transformPoint(new DOMPointReadOnly(-o,0)),i=s.transformPoint(new DOMPointReadOnly(o,0)),l={x:r.x,y:r.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY};this.mutate(this._resetBounds,l),this.applyResetBounds();const a=this.style==="custom_plus"?"custom_plus":"custom";this.mutate(this._style,a);const u=new bn(this.panel,void 0,this.onTop,{resetBounds:{x:i.x,y:i.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY},style:a});this.flip&&(u.flip=!0),this.mutate(u._linkedTo,this._linkedTo.value)}get controls(){return this._controls.value}set controls(e){this.mutate(this._controls,e)}get skip(){return this._skip.value}set skip(e){this.mutate(this._skip,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get continue(){return this._continue.value}set continue(e){this.mutate(this._continue,e)}}const Ls=new class{constructor(){C(this,"_panels",R({}));C(this,"_order",R([]));C(this,"_lastPanelId",-1);Object.seal(this)}get panels(){return this._panels.value}get order(){return this._order.value}get lastPanelId(){return this._lastPanelId}createPanel(){const e=this._lastPanelId+1,o=new Jo(e);return We(()=>{this._lastPanelId=e,this._panels.value[o.id]=yt(o),this._order.value.push(o.id)}),o}duplicatePanel(t){const o=this._lastPanelId+1,s=Jo.fromExisting(t,o),r=this._order.value.indexOf(t.id);return We(()=>{this._lastPanelId=o,this._panels.value[o]=yt(s),this._order.value.splice(r+1,0,o)}),s}deletePanel(t){const e=this._order.value,o=e.indexOf(t.id);if(o===-1)return;const s=V.viewports.list.filter(i=>i.currentPanel===t.id),r=e.length-1===o?e[o-1]:e[o+1];We(()=>{delete this._panels.value[t.id],this._order.value.splice(o,1),s.forEach(i=>i.currentPanel=r)})}movePanel(t,e){const o=this._order.value.indexOf(t.id);o!==-1&&We(()=>{this._order.value.splice(o,1),this._order.value.splice(o+e,0,t.id)})}fixContentPackRemoval(t){for(const e of Object.values(this._panels))e.fixContentPackRemoval(t)}getSave(){return{lastPanelId:this._lastPanelId,panelOrder:[...this._order.value],currentPanel:V.viewports.list[0].currentPanel,panels:Object.fromEntries(Object.values(this._panels.value).map(t=>[t.id,t.getSave()]))}}loadSave(t){const e=t.panelOrder,o={};let s=-1;for(const r of e){const i=t.panels[r],l=new Jo(+r);l.loadSave(i),o[l.id]=yt(l),s=Math.max(s,l.id)}this._order.value=e,this._panels.value=o,this._lastPanelId=s}},ts=class ts extends Ba{constructor(e){super();C(this,"background",new Cw);C(this,"_lastObjId",-1);C(this,"_lowerOrder",R([]));C(this,"_topOrder",R([]));C(this,"_objects",R({}));C(this,"_lastRender",R(null));this.id=e}static fromExisting(e,o){const s=new ts(o);let r=-1;const i={},l=new Map;for(const a in e.objects)l.set(+a,++r);for(const a in e.objects){if(!Object.prototype.hasOwnProperty.call(e.objects,a))continue;const c=e.objects[a].makeClone(s,l);i[c.id]=c}return s._lastObjId=r,s._lowerOrder.value=e._lowerOrder.value.map(a=>l.get(a)),s._topOrder.value=e._topOrder.value.map(a=>l.get(a)),s._objects.value=i,s._lastRender.value=e._lastRender.value,s._composite.value=e._composite.value,s._filters.value=e._filters.value.map(a=>yt(a.clone())),s.background.fromExisting(e.background),s}loadSave(e){this.background.loadSave(e.background),this._filters.value=Ea(e.filters),this._composite.value=e.composite;const o=[];for(const s of[...e.order,...e.onTopOrder]){const r=e.objects[s];r!=null&&o.push(r)}this.pasteObjects(o)}getSave(){return{id:this.id,background:this.background.getSave(),composite:this._composite.value,filters:this._filters.value.map(e=>e.getSave()),order:[...this._lowerOrder.value],onTopOrder:[...this._topOrder.value],lastObjId:this._lastObjId,objects:Object.fromEntries(Object.entries(this.objects).map(([e,o])=>[e,o.save()]))}}get lowerOrder(){return this._lowerOrder.value}get topOrder(){return this._topOrder.value}get objects(){return this._objects.value}get lastRender(){return this._lastRender.value}set lastRender(e){this._lastRender.value=e}get lastObjId(){return this._lastObjId}fixContentPackRemoval(e){this.background.fixContentPackRemoval(e);for(const o in this.objects)this.objects[o].fixContentPackRemoval(e)}insertObject(e,o){const s=o?this._topOrder.value:this._lowerOrder.value,r=this._lastObjId,i=Math.max(r,e.id);We(()=>{this.objects[e.id]=yt(e),this._lastObjId=i,s.push(e.id)})}removeObject(e){const o=e.onTop?this._topOrder.value:this._lowerOrder.value,s=o.indexOf(e.id);for(const r of Object.values(this._objects.value))r!==e&&r.prepareSiblingRemoval(e);for(const r of V.viewports.list)r.currentPanel===this.id&&r.selection===e.id&&(r.selection=null);We(()=>{o.splice(s,1),delete this._objects.value[e.id]})}setOnTop(e,o){const s=o?this._lowerOrder.value:this._topOrder.value,r=o?this._topOrder.value:this._lowerOrder.value,i=s.indexOf(e.id);i!==-1&&We(()=>{s.splice(i,1),r.push(e.id)})}shiftLayer(e,o){const s=e.onTop?this._topOrder.value:this._lowerOrder.value,r=s.indexOf(e.id),i=Math.max(r+o,0);r!==i&&We(()=>{s.splice(r,1),s.splice(i,0,e.id)})}pasteObjects(e){const o=new Map;let s=this.lastObjId;for(const r of e)o.set(+r.id,++s);for(const r of e){const i=ts.objectClassTable[r.type];if(!i)throw new Error(`Unknown object type: ${r.type}`);i.fromSave(this,r,o)}}};C(ts,"objectClassTable",{character:Dp,choice:Bp,notification:Ep,poem:Bl,sprite:La,textBox:bn});let Jo=ts;const kw="buildin.transparent";var Ns=(n=>(n[n.None=0]="None",n[n.Stretch=1]="Stretch",n[n.Cover=2]="Cover",n))(Ns||{});class Cw extends Ba{constructor(){super();C(this,"_current",R(kw));C(this,"_color",R("#000000"));C(this,"_flipped",R(!1));C(this,"_variant",R(0));C(this,"_scaling",R(0))}fromExisting(e){this._current.value=e.current,this._color.value=e.color,this._flipped.value=e.flipped,this._variant.value=e.variant,this._scaling.value=e.scaling,this._composite.value=e.composite,this._filters.value=e.filters.map(o=>yt(o.clone()))}getSave(){return{current:this.current,color:this.color,flipped:this.flipped,variant:this.variant,scaling:this.scaling,composite:this.composite,filters:this._filters.value.map(e=>e.getSave())}}loadSave(e){this.current=e.current,this.color=e.color,this.flipped=e.flipped,this.variant=e.variant,this.scaling=e.scaling,this._composite.value=e.composite,this._filters.value=Ea(e.filters)}get current(){return this._current.value}set current(e){this._current.value,this._variant.value,We(()=>{this._current.value=e,this._variant.value=0})}get color(){return this._color.value}set color(e){this._color.value,We(()=>void(this._color.value=e))}get flipped(){return this._flipped.value}set flipped(e){this._flipped.value,We(()=>void(this._flipped.value=e))}get variant(){return this._variant.value}set variant(e){this._variant.value,We(()=>void(this._variant.value=e))}get scaling(){return this._scaling.value}set scaling(e){this._scaling.value,We(()=>void(this._scaling.value=e))}seekBackgroundVariant(e){const s=Rt.backgrounds.get(this.current);if(!s)return;const r=Lo(s.variants,this.variant,e);this.variant,We(()=>void(this.variant=r))}fixContentPackRemoval(e){const o=e.backgrounds.find(l=>l.id===this.current);if(!o)return;const s=Rt.backgrounds.get(this.current);if(!s){Rt.current.backgrounds.length>0?this.current=Rt.current.backgrounds[0].id:this.current="buildin.transparent";return}const r=JSON.stringify(o.variants[this.variant]),i=s.variants.findIndex(l=>JSON.stringify(l)===r);i!==this.variant&&(this.variant=i===-1?0:i)}}const _w={dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},Rt=new class{constructor(){C(this,"_contentPacks",R([]));C(this,"_current",E(()=>this._contentPacks.value.length===0?_w:this._contentPacks.value.reduce((t,e)=>lm(t,e))));C(this,"_characters",E(()=>{const t=new Map;for(const e of this.current.characters)t.set(e.id,e);return t}));C(this,"_backgrounds",E(()=>{const t=new Map;for(const e of this.current.backgrounds)t.set(e.id,e);return t}))}get contentPacks(){return this._contentPacks.value}get current(){return this._current.value}removeContentPacks(t){const e=JSON.parse(JSON.stringify(this.current)),o=this.contentPacks.filter(s=>!t.has(s.packId));Kr(()=>{this._contentPacks.value=o,Ls.fixContentPackRemoval(e)})}async replaceContentPack(t){const e=t.processed?t.contentPack:await Os(t.contentPack);let o=this._contentPacks.value;const s=o.findIndex(r=>r.packId===t.contentPack.packId);s===-1?o.push(e):o.splice(s,1,e),o=o,Kr(()=>{this._contentPacks.value=o})}async loadContentPacks(t){typeof t=="string"&&(t=[t]);const e=await Promise.all(t.map(async r=>await fl(r))),o=await Promise.all(e.map(r=>Os(r))),s=new Set(this.contentPacks.map(r=>r.packId));for(const r of o)for(const i of r.dependencies)if(!s.has(i))throw new Error(`Missing dependency '${i}'. Refusing to install ${r.packId}`);await Kr(async()=>{this._contentPacks.value=[...this.contentPacks,...o]})}get characters(){return this._characters.value}get backgrounds(){return this._backgrounds.value}async loadSave(t){const e=await Wn.getInstance(),o=new Set,s=await Promise.allSettled(t.map(async r=>{if(typeof r!="string")return r;let i=null,l;if(r.indexOf(";")>=0?[l,i]=r.split(";"):l=r,o.has(l))return null;o.add(l);const a=Rt.contentPacks.find(f=>f.packId===l);if(a)return a;if(r.startsWith("dddg.buildin.")&&r.endsWith(".nsfw")){const f=await fl(va[r]);return await Os(f)}i!=null&&!e.hasPack(l)&&await e.loadTempPack(i);const u=e.getPack(l);if(!u)return console.warn(`Pack Id ${r} not found!`),null;const c=await fl(u.dddg2Path||u.dddg1Path);return await Os(c)}));for(const r of s)r.status==="rejected"&&(je.fire(new gs(""+r.reason)),console.error(r.reason));Rt._contentPacks.value=[...Rt._contentPacks.value.filter(r=>{var i;return(i=r.packId)==null?void 0:i.startsWith("dddg.buildin.")}),...s.filter(r=>r.status==="fulfilled").map(r=>r.value).filter(r=>r!==null)]}async getSave(t){const e=Rt._contentPacks.value.filter(s=>{var r,i;return!((r=s.packId)!=null&&r.startsWith("dddg.buildin."))||((i=s.packId)==null?void 0:i.endsWith(".nsfw"))}),o=await Wn.getInstance();return t?e.map(s=>{var i;let r=(i=s.packId)!=null&&i.startsWith("dddg.uploads.")?s:s.packId;if(s.packId!=null){const l=o.getPack(s.packId);l&&l.repoUrl!=null&&(r+=`;${l.repoUrl}`)}return r}):e}};function xw(n){return n.split("/").slice(0,-1).join("/")+"/"}const gd=new Set(["png","gif","bmp","svg"]);async function fl(n){const t=await fetch(n);if(!t.ok)throw new Error(`Could not load content pack. Server responded with: ${t.statusText}`);let e;try{e=await t.json()}catch{throw new Error("Content pack is not valid json!")}try{const o={"./":xw(n),"/":pa};return e.version==="2.0"?im.normalizeContentPack(e,o):rm.convert(om.normalizeCharacter(e,o),o,!1)}catch{throw new Error("Content pack is not in a valid format!")}}async function Os(n){const t=new Set(await ho()?["webp",...gd]:gd),e=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Jr.assetWalker(n,o=>{const s=Jr.normalizePath(o,e,t,!1),r=Jr.normalizePath(o,e,t,!0);return{hq:s,lq:r,sourcePack:n.packId??"buildIn"}})}function Sw(n){var e,o,s;const t=Object.values(n.panels.panels);if(!t.find(r=>Object.values(r.objects).find(i=>"scaleX"in i)))for(const r of t)for(const i of Object.values(r.objects)){i.scaleX=i.zoom??1,i.scaleY=i.zoom??1,i.skewX=0,i.skewY=0,i.linkedTo=null;const l=fe();if(i.type==="character"){const a=i,u=n.content.current.characters.find(f=>f.id===a.characterType),c=((s=(o=(e=u==null?void 0:u.styleGroups[a.styleGroupId])==null?void 0:e.styles[a.styleId])==null?void 0:o.poses[a.poseId])==null?void 0:s.size)??[960,960];Va(a,i.zoom??1,c)}i.type==="textBox"&&(i.height+=l.TextBox.NameboxHeight,i.y+=i.height/2),i.type==="sprite"&&(i.requireFixing25=!0,n.requireFixing25=!0),delete i.zoom}}function Va(n,t,e){let o=new DOMMatrixReadOnly().translate(n.x,n.y+n.height/2);o=o.translate(0,-n.height/2).scale(n.width/e[0],n.height/e[1]).translate(0,e[1]/2),o=o.rotate(n.flip?-n.rotation:n.rotation),o=o.translate(0,e[1]/2).scale(t).translate(0,-e[1]/2);const s=n.rotation;Object.assign(n,Mp(o)),n.rotation=n.flip?360-s:s,n.skewX=0,n.skewY=0,n.width=e[0],n.height=e[1]}function Wp(n){for(const t of Object.values(V.panels.panels))for(const e of Object.values(t.objects)){if(e.type!=="sprite"||!e.requireFixing25||e.scaleX!==e.scaleY)continue;const o=e;o.assets.length===1&&o.assets[0].hq===n.url&&(Va(o,e.scaleX,n.size),delete e.requireFixing25)}}async function Vp(n){if("requireFixing25"in V){const t=await vo(n);Wp({url:n,size:[t.width,t.height]})}}function Fp(n){return!n.requireFixing25}const Pw=Object.freeze(Object.defineProperty({__proto__:null,adjustObjectSize2_5:Va,afterImageUpload2_5:Vp,allowScaleModification:Fp,fixSprites2_5:Wp,migrateSave2_5:Sw},Symbol.toStringTag,{value:"Module"})),pl=Jt(Object.seal({urls:{},async add(n,t){if(this.urls[n])throw new Error(`There is already an uploaded file called "${n}"`);const e="uploads:"+n;return this.urls[n]=t,Xp(e,t),await Vp(e),e},getSave(n){return Object.keys(this.urls)},loadSave(n){this.urls={}}})),Mo=192,Do=16/9;function Up(n){if(n===null)return!1;if(n instanceof HTMLInputElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return n instanceof t.defaultView.HTMLInputElement}return!1}function Ow(n){if(n===null)return!1;if(n instanceof HTMLTextAreaElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLTextAreaElement:!1}return!1}function Tw(n){if(n instanceof HTMLElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLElement:!1}return!1}function Zo(n){if(n instanceof MouseEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.MouseEvent:!1}function $w(n){if(n instanceof TouchEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.TouchEvent:!1}const rr=Jt(new class{constructor(){C(this,"_list",{});C(this,"_currentViewportCount",0);Object.seal(this)}get list(){return Object.values(this._list)}setUpViewport(t){if(t.body.dataset.viewportId!=null)return yt(this.list[+t.body.dataset.viewportId]);const e=this._currentViewportCount++,o=new jw(t);this._list[e]=yt(o);let s=null;return t.addEventListener("focus",r=>{s!=null&&(s.abort(),s=null);const i=r.target;Up(i)&&i.type==="number"&&(s=new AbortController,i.addEventListener("wheel",l=>{const a=l.deltaY>0||l.deltaX>0;l.preventDefault(),l.stopPropagation(),i.valueAsNumber+=(a?1:-1)*(l.shiftKey?10:l.altKey?.1:1),i.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))},{passive:!1,signal:s.signal}))},{capture:!0}),t.defaultView.addEventListener("close",r=>{this.removeViewport(r.target)}),t.body.dataset.viewportId=e.toString(),yt(o)}removeViewport(t){if(t.body.dataset.viewportId==null)return;const e=+t.body.dataset.viewportId;e!=null&&delete this._list[e]}loadSave(t){if(t.currentPanel!=null){const o=this._list[0];if(!o)return;o.currentPanel=t.currentPanel}const e=V.panels.panels[0];for(const o of this.list)V.panels.panels[o.currentPanel]||(o.currentPanel=e.id),V.panels.panels[o.currentPanel].objects[o.selection]===void 0&&(o.selection=null)}});class jw{constructor(t){C(this,"_selection",R(null));C(this,"_pickColor",R(!1));C(this,"_currentPanel",R(null));C(this,"_width");C(this,"_height");var e;this.doc=t,this._width=R(t.documentElement.clientWidth),this._height=R(t.documentElement.clientHeight),((e=rr.list[0])==null?void 0:e.currentPanel)!=null&&(this._currentPanel.value=rr.list[0].currentPanel),t.defaultView.addEventListener("resize",()=>{this._width.value=t.documentElement.clientWidth,this._height.value=t.documentElement.clientHeight})}get width(){return this._width.value}get height(){return this._height.value}get selection(){return this._selection.value}set selection(t){this._selection.value=t}get currentPanel(){return this._currentPanel.value}set currentPanel(t){this._currentPanel.value=t}get pickColor(){return this._pickColor.value}set pickColor(t){this._pickColor.value=t}get isVertical(){const t=this.height;return(this.width+Mo)/t>=Do}get canvasWidth(){if(this.isVertical){const t=this.width-Mo,e=this.height*Do;return Math.min(t,e)}else{const t=this.width,e=(this.height-Mo)*Do;return Math.min(t,e)}}get canvasHeight(){if(this.isVertical){const t=this.height,e=(this.width-Mo)/Do;return Math.min(t,e)}else{const t=this.height-Mo,e=this.width/Do;return Math.min(t,e)}}}const V=Object.freeze({ui:ls,panels:Ls,content:Rt,uploadUrls:pl,viewports:rr,unsafe:!1,async loadSave(n){const t=JSON.parse(n);(t.version==null||t.version<2.5)&&(await Al(()=>Promise.resolve().then(()=>Pw),void 0,import.meta.url)).migrateSave2_5(t),await Rt.loadSave(t.content),pl.loadSave(t.uploadUrls),Ls.loadSave(t.panels),rr.loadSave(t.panels)},async getSave(n){return JSON.stringify({version:2.5,panels:Ls.getSave(),content:await Rt.getSave(n),uploadUrls:pl.getSave(n),unsafe:!1},void 0,"	")}}),Rw="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",jt=class jt{constructor(t,e){C(this,"onlineRepo");C(this,"localRepo");C(this,"tempRepo",Jt({authors:{},packs:[]}));C(this,"combinedList");C(this,"authors");window.repo=this,t||(t={authors:{},packs:[]},je.fire(new _t("Couldn't load remote repository."))),e||(e={authors:{},packs:[]},he.supports.localRepo&&je.fire(new _t("Couldn't load local repository."))),this.onlineRepo=R(t),this.localRepo=R(e),this.combinedList=E(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.packs)??[],r=new Map(s.map(y=>[y.id,y])),i=this.localRepo.value,l=(i==null?void 0:i.packs)??[],a=new Map(l.map(y=>[y.id,y])),c=this.tempRepo.packs,f=new Map(c.map(y=>[y.id,y])),g=new Set(he.state.autoAdd),m=V.content.contentPacks.map(y=>y.packId).filter(y=>y!=null),_=new Set(m),k=new Set;return[...m,...l.map(y=>y.id),...s.map(y=>y.id),...c.map(y=>y.id)].filter(y=>y.startsWith("dddg.buildin.")||y.startsWith("dddg.uploads.")||y.startsWith("dddg.desktop.")||y==="concept_femc.shido_draws.edave64"||k.has(y)?!1:(k.add(y),!0)).map(y=>({...r.get(y)??{characters:[],kind:[],authors:[]},...a.get(y),...f.get(y),autoloading:g.has(y),installed:a.has(y),online:r.has(y)||f.has(y),loaded:_.has(y)}))}),this.authors=E(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.authors)??{},r=this.localRepo.value,i=(r==null?void 0:r.authors)??{};return{...s,...i}}),Object.freeze(this)}static getInstance(){return jt.instance||(jt.instance=this.createInstance()),jt.instance}static async createInstance(){const t=jt.loadRepo(Rw),e=he.supports.localRepo?await jt.loadRepo(he.localRepositoryUrl):null,[o,s]=await Promise.all([t,e]);return new jt(o,s)}static async loadRepo(t){try{const[e,o]=await Promise.all([jt.fetchJSON(t+"repo.json"),jt.fetchJSON(t+"people.json")]);return{packs:e,authors:o}}catch{return null}}static async fetchJSON(t){const e=await fetch(t);if(!e.ok)throw new Error("Could not load json");return await e.json()}async reloadLocalRepo(){this.localRepo.value=he.supports.localRepo?await jt.loadRepo(he.localRepositoryUrl):null}getPacks(){return this.combinedList.value}hasPack(t,e=!1){var o;return e?!!((o=this.onlineRepo.value)!=null&&o.packs.find(s=>s.id===t)):!!this.getPacks().find(s=>s.id===t)}getPack(t){return this.getPacks().find(e=>e.id===t)??null}getAuthor(t){return this.authors.value[t]||null}getAuthors(){return this.authors.value}async loadTempPack(t){const e=fetch(t);let o;try{o=await e}catch{throw new Error(`Failed to load '${t}'`)}if(!o.ok)throw o.status===404?new Error(`The pack '${t}' does not exist anymore.`):new Error(`Failed to load '${t}': ${o.statusText||o.status}`);let s;try{s=await o.json()}catch(i){throw new Error(`The contents of '${t}' is not a valid JSON: ${i.message}`)}if(!s.pack&&(!s.packs||s.packs.length===0))throw new Error(`The json file '${t}' does not contain any packages`);if(s.authors)for(const i in s.authors)this.tempRepo.authors[i]&&(this.tempRepo.authors[i]=s.authors[i]);let r=null;if(s.pack&&(this.addTempPack(s.pack,t),r=s.pack.id),s.packs)for(const i of s.packs)this.addTempPack(i,t),r===null&&(r=i.id);return r}addTempPack(t,e){if(t.repoUrl=e,t.dddg1Path&&(t.dddg1Path=new URL(t.dddg1Path,e).toString()),t.dddg2Path&&(t.dddg2Path=new URL(t.dddg2Path,e).toString()),t.preview)for(let o=0;o<t.preview.length;++o)t.preview[o]=new URL(t.preview[o],e).toString();this.tempRepo.packs.find(o=>o.id===t.id)||this.tempRepo.packs.push(t)}};C(jt,"instance");let Wn=jt;const ir=navigator.userAgent,Aw=!!ir.match(/iPad/i)||!!ir.match(/iPhone/i),Iw=!!ir.match(/WebKit/i),md=Aw&&Iw&&!ir.match(/CriOS/i);class qp{constructor(){C(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder",hasTemplate:!1}));C(this,"supports");C(this,"_gameMode",null);C(this,"isSavingEnabled",R(!1));C(this,"localRepositoryUrl","");C(this,"loading");C(this,"creatingDB");C(this,"loadingContentPacksAllowed");C(this,"loadContentPacks");C(this,"updateProgress",null);const t=et.canSave(),e=this.isSavingEnabled;window.addEventListener("beforeunload",o=>{o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise(o=>{this.loadContentPacks=()=>o()}),this.supports=Jt({optionalSaving:t,get autoLoading(){return t&&e.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!md,allowWebP:!0,limitedCanvasSpace:md}),t?this.loading=(async()=>{this.savingEnabled=await et.doesDbExists()})():this.loading=Promise.resolve(),this.loading.then(async()=>{if(await this.loadingContentPacksAllowed,this.creatingDB&&await this.creatingDB,this.savingEnabled){const o=await et.loadAutoload()??[];this.state.autoAdd=o;const s=await Wn.getInstance(),r=await Promise.all(o.map(async i=>{const[l,a]=i.split(";",2);a!=null&&!s.hasPack(l)&&await s.loadTempPack(a);const u=s.getPack(l);return u.dddg2Path??u.dddg1Path}));await re(async()=>{await V.content.loadContentPacks(r)})}})}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(t){t?(localStorage.setItem("saving","true"),this.creatingDB=et.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=et.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}async loadGameMode(){const e=new URLSearchParams(location.search).get("mode");if(e==="ddlc"||e==="ddlc_plus"){this._gameMode=e;return}await this.loading,await this.creatingDB;let o="";this.isSavingEnabled.value&&(o=await et.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s}async setGameMode(t){this.isSavingEnabled.value&&await et.saveGameMode(t);const e=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${e}?mode=${t}`}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(){throw new Error("Method not implemented.")}openNewWindow(){const t=window.open(void 0,"_blank","left=100,top=100");return!t||t.closed?null:t}async saveToFile(t,e,o="image/png",s=1){const r=document.createElement("a");r.setAttribute("download",e);const i=await this.createObjectURL(t,o,s);return r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),i}localRepoInstall(){return Promise.reject(new Error("This environment does not support a local repository"))}localRepoUninstall(){throw new Error("This environment does not support a local repository")}async autoLoadAdd(t){await this.loading,await this.creatingDB,await et.saveAutoload([...this.state.autoAdd,t]),this.state.autoAdd.push(t)}async autoLoadRemove(t){await this.loading,await this.creatingDB;const e=this.normalizePackId(t);await et.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=e));const o=this.state.autoAdd.indexOf(t);this.state.autoAdd.splice(o,1)}normalizePackId(t){const e=t.split(";");return e.length===1?e[0]:e[e.length-1]}async loadSettings(){await this.loading,await this.creatingDB;const t={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?{...t,...await et.loadSettings()}:t}async saveSettings(t){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&await et.saveSettings(t)}async loadDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return!1;const t=await et.loadTemplate();return t==null?!1:(this.state.hasTemplate=!0,await V.loadSave(t),!0)}async saveDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return;const t=await V.getSave(!0);et.saveTemplate(t),this.state.hasTemplate=!0}async clearDefaultTemplate(){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&(await et.saveTemplate(null),this.state.hasTemplate=!1)}async isInitialized(){await this.loading,await this.creatingDB}prompt(t,e){return new Promise(o=>{o(prompt(t,e))})}onPanelChange(){}createObjectURL(t,e,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(t.toDataURL(e,o));if(t.toBlob!=null)t.toBlob(l=>{if(!l){r();return}s(URL.createObjectURL(l))},e,o);else{const l=t.toDataURL(e,o),a=this.dataURItoBlob(l,e);s(URL.createObjectURL(a))}})}dataURItoBlob(t,e){const o=atob(t.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=o.charCodeAt(i);return new Blob([r],{type:e})}}const et={indexedDB:(()=>{try{return window.indexedDB??window.mozIndexedDB??window.webkitIndexedDB??window.msIndexedDB??null}catch{return null}})(),transaction:(()=>{try{return window.IDBTransaction??window.mozIDBTransaction??window.webkitIDBTransaction??window.msIDBTransaction??null}catch{return null}})(),db:null,canSave(){return!!(et.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return et.db?et.db:et.db=new Promise((n,t)=>{const e=et.indexedDB.open("dddg",3);e.onerror=o=>{t(o)},e.onupgradeneeded=o=>{const s=e.result,r=o.oldVersion??o.version;r<1&&s.createObjectStore("settings"),r===1&&(s.deleteObjectStore("settings"),s.createObjectStore("settings"))},e.onsuccess=()=>{n(e.result)}})},clearDB(){return new Promise((n,t)=>{if(!et.db){n();return}const e=et.indexedDB.deleteDatabase("dddg");et.db=null,e.onerror=o=>{t(o)},e.onsuccess=()=>{n()}})},loadAutoload(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("autoload")))},saveAutoload(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put([...n],"autoload"))})},loadGameMode(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("gameMode")))},saveGameMode(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put(n,"gameMode"))})},saveTemplate(n){return this.objectStorePromise("readwrite",async t=>{n==null?await this.reqPromise(t.delete("template")):await this.reqPromise(t.put(n,"template"))})},loadTemplate(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("template")))},saveSettings(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put({...n},"settings"))})},loadSettings(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("settings")))},async objectStorePromise(n,t){const e=await this.db;if(!e)throw new Error("No database");const s=e.transaction(["settings"],n).objectStore("settings");return await t(s)},reqPromise(n){return new Promise((t,e)=>{n.onerror=o=>{e(o)},n.onsuccess=()=>{t(n.result)}})}};class Mw extends qp{saveToFile(t,e,o="image/png",s=1){let r=t.toDataURL(o,s);const i=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,e),Promise.resolve(r)}}class Dw{constructor(){C(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"",hasTemplate:!1}));C(this,"localRepositoryUrl","/repo/");C(this,"_gameMode",null);C(this,"electron",window);C(this,"bgInvalidation",null);C(this,"loadingContentPacksAllowed");C(this,"loadContentPacks");C(this,"updateProgress",R("wait"));C(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1});C(this,"savingEnabled",!0);this.loadingContentPacksAllowed=new Promise(e=>{this.loadContentPacks=()=>e()}),this.electron.ipcRenderer.on("add-persistent-content-pack",async e=>{await this.loadingContentPacksAllowed,await re(async()=>{await V.content.loadContentPacks(e)})}),this.electron.ipcRenderer.on("add-persistent-background",async e=>{const o="persistentBg-"+e,s=e.split("/");Xp(o,e),bd.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()}),this.electron.ipcRenderer.on("push-message",e=>{je.fire(new _t(e))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",e=>{this.state.downloadLocation=e}),this.electron.ipcRenderer.onConversation("load-packs",async e=>{const o=await Wn.getInstance(),s=await Promise.all(e.map(async r=>{const[i,l]=r.split(";",2);l!=null&&!o.hasPack(i)&&await o.loadTempPack(l);const a=o.getPack(i);return a.dddg2Path||a.dddg1Path}));await re(async()=>{await V.content.loadContentPacks(s)})}),this.electron.ipcRenderer.onConversation("auto-load.changed",e=>{this.state.autoAdd=e}),this.electron.ipcRenderer.onConversation("reload-repo",async()=>{await(await Wn.getInstance()).reloadLocalRepo()}),this.electron.ipcRenderer.onConversation("replace-pack",async e=>{const o={processed:!1,contentPack:e};await re(async()=>{await V.content.replaceContentPack(o)})}),this.electron.ipcRenderer.onConversation("resolvable-error",(e,o)=>new Promise(s=>{je.fire(new fa(e,o.map(r=>({exec:()=>s(r),name:r}))))}));let t=!1;this.electron.ipcRenderer.on("update.progress",e=>{this.updateProgress.value=e,e==="done"?(t=!1,je.fire(new _t("An update is downloaded and will be installed once DDDG closes."))):t||(t=!0,je.fire(new _t("An update was found and will download in the background.")))}),this.electron.ipcRenderer.on("update.checkStopped",()=>{this.updateProgress.value="none"}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}loadDefaultTemplate(){throw new Error("Method not implemented.")}saveDefaultTemplate(){throw new Error("Method not implemented.")}clearDefaultTemplate(){throw new Error("Method not implemented.")}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(t){this.electron.ipcRenderer.send("open-folder",t)}onPanelChange(){}async saveSettings(t){await this.electron.ipcRenderer.sendConvo("config.set","nsfw",t.nsfw),await this.electron.ipcRenderer.sendConvo("config.set","darkMode",t.darkMode??void 0),await this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",t.defaultCharacterTalkingZoom)}async loadGameMode(){this._gameMode=await this.electron.ipcRenderer.sendConvo("config.get","gameMode")||"ddlc"}async setGameMode(t){await this.electron.ipcRenderer.sendConvo("config.set","gameMode",t),this.electron.ipcRenderer.send("reload")}async loadSettings(){return{lq:!1,nsfw:await this.electron.ipcRenderer.sendConvo("config.get","nsfw")??!1,darkMode:await this.electron.ipcRenderer.sendConvo("config.get","darkMode")??void 0,defaultCharacterTalkingZoom:await this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom")??void 0}}async localRepoInstall(t,e,o){await this.electron.ipcRenderer.sendConvo("repo.install",t,e,o)}async localRepoUninstall(t){await this.electron.ipcRenderer.sendConvo("repo.uninstall",t)}async autoLoadAdd(t){await this.electron.ipcRenderer.sendConvo("auto-load.add",t)}async autoLoadRemove(t){await this.electron.ipcRenderer.sendConvo("auto-load.remove",t)}saveToFile(t,e,o="image/png",s=1){return new Promise((r,i)=>{t.toBlob(async l=>{if(!l){i();return}const a=await l.arrayBuffer();await this.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(a)),r(URL.createObjectURL(l))},o,s)})}async prompt(t,e){return await this.electron.ipcRenderer.sendConvo("show-prompt",t,e)}openNewWindow(){return window.open(void 0,"_blank","left=100,top=100")}invalidateInstalledBGs(){this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),re(async()=>{await V.content.replaceContentPack({contentPack:bd,processed:!1})})}}const bd={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};function Bw(){return window.isElectron?new Dw:"msSaveOrOpenBlob"in window.navigator?new Mw:new qp}const he=Bw(),zp="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!--%20Source:%20https://fonts.google.com/icons?selected=Material%2520Icons%2520Round%253Awarning%253A%20--%3e%3csvg%20fill='%23FFFFFF'%20version='1.1'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cfilter%20id='a'%20x='-.07126'%20y='-.079384'%20width='1.1425'%20height='1.1597'%20color-interpolation-filters='sRGB'%3e%3cfeGaussianBlur%20stdDeviation='0.36070242'/%3e%3c/filter%3e%3c/defs%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23fff'%20filter='url(%23a)'%20stroke='%23fff'/%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23000'/%3e%3c/svg%3e";let Hl=null;setTimeout(()=>vo(zp).then(n=>{n instanceof Nn&&(Hl=n)}),0);class as{constructor(){C(this,"width",300);C(this,"height",300)}paintOnto(t,e={}){Hl&&Hl.paintOnto(t,e)}}let hl;function ho(){if(hl)return hl;if(!he.supports.allowWebP)return Promise.resolve(!1);const n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",t="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return hl=(async()=>{const e=await Promise.all([Wl(n,1,2),Wl(t,720,1280)]);return e[0]&&e[1]})()}function Wl(n,t,e){return new Promise(o=>{const s=document.createElement("img");s.addEventListener("load",()=>{o(s.width===e&&s.height===t)}),s.addEventListener("error",()=>{o(!1)}),s.src=n})}let vl;function Ew(){return vl||(vl=(async()=>await Wl("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2))())}class Lw{constructor(){C(this,"cache",new Map)}get(t){const e=this.cache.get(t);if(e)return e;const o=ar(t);return this.cache.set(t,o),o}remove(t){this.cache.delete(t)}}class Nw{constructor(){C(this,"cache",new Map)}get(t){var s;const e=(s=this.cache.get(t))==null?void 0:s.deref();if(e)return e;const o=Ww(t);return this.cache.set(t,new WeakRef(o)),o}remove(t){this.cache.delete(t)}}let gl=null;function lr(){return gl||(window.assetCache=gl=he.supports.assetCaching||typeof WeakRef>"u"?new Lw:new Nw)}const Vn={};function Fa(n,t=!0){return vo(he.supports.lq&&!t?n.lq:n.hq)}function kn(n,t=!0){const e=he.supports.lq&&ha&&!t?n.lq:n.hq;return Vn[e]?Vn[e]:e}function vo(n){return Vn[n]&&(n=Vn[n]),lr().get(n)}async function us(n,t=!0){const e=`${pa}${n}${he.supports.lq&&ha&&!t?".lq":""}${await ho()?".webp":".png"}`.replace(/\/+/,"/");return await lr().get(e)}async function Hw(n,t=!0){return`${pa}${n}${he.supports.lq&&ha&&!t?".lq":""}${await ho()?".webp":".png"}`.replace(/\/+/,"/")}function Xp(n,t){Vn[n]=t}async function Ww(n){const t=!!Vn[n];return t&&(n=Vn[n]),await(async()=>{try{return await ar(n)}catch{if(n.endsWith(".webp")&&!t)try{return await ar(n.replace(/\.webp$/,".png"))}catch{return je.fire(new Zs(n)),lr().remove(n),new as}else return je.fire(new Zs(n)),lr().remove(n),new as}})()}function ar(n,t=!1){return new Promise(e=>{const o=new Image;o.addEventListener("load",()=>{e(new Nn(o)),(t||!he.supports.assetCaching)&&document.body.removeChild(o)}),o.addEventListener("error",()=>{e(new as),(t||!he.supports.assetCaching)&&document.body.removeChild(o)}),o.crossOrigin="Anonymous",o.src=n,o.style.display="none",document.body.appendChild(o)})}class Kn{}class Fn{constructor(t,e,o,s){C(this,"aborted",!1);this.canvas=t,this.fsCtx=e,this.hq=o,this.preview=s}static make(t,e,o){return new Fn(t,t.getContext("2d"),e,o)}static makeWithContext(t,e,o,s){return new Fn(t,e,o,s)}drawText(t){if(this.aborted)throw new Kn;this.fsCtx.save();const{font:e,align:o,x:s=0,y:r=0,text:i=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(i,s,r)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(i,s,r)),this.fsCtx.restore()}measureText(t){if(this.aborted)throw new Kn;this.fsCtx.save();const{font:e,align:o,text:s=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(t){if(this.aborted)throw new Kn;const{image:e,flip:o,x:s,y:r,w:i,h:l,filters:a,composite:u}={flip:!1,w:t.image.width,h:t.image.height,composite:"source-over",...t};if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=u,a)if("filter"in this.fsCtx){const c=[];for(const f of a)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of a)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(t.shadow){const c=t.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(t.rotation!=null&&t.rotation!==0){const c=t.rotationAnchor?t.rotationAnchor.x:0,f=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+i/2,r+l/2),this.fsCtx.scale(o?-1:1,1),e.paintOnto(this.fsCtx,{x:-i/2,y:-l/2,w:i,h:l}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:t,y:e,w:o,h:s,outline:r,fill:i,composition:l,rotation:a,rotationAnchor:u}){if(this.aborted)throw new Kn;if(this.fsCtx.save(),a!=null&&a!==0){const c=u?u.x:0,f=u?u.y:0;u&&this.fsCtx.translate(c,f),this.fsCtx.rotate(a),u&&this.fsCtx.translate(-c,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(t,e,o,s),l&&(this.fsCtx.globalCompositeOperation=l),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:t,fill:e,path:o}){if(this.aborted)throw new Kn;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),e&&(this.fsCtx.fillStyle=e.style,this.fsCtx.fill()),t&&(this.fsCtx.strokeStyle=t.style,this.fsCtx.lineWidth=t.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(t,e="repeat"){return t instanceof Yp&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}async customTransform(t,e){this.fsCtx.save(),await t(this.fsCtx),await e(this),this.fsCtx.restore()}linearGradient(t,e,o,s){return this.fsCtx.createLinearGradient(t,e,o,s)}applyFilters(t){if(t.length===0)return;this.fsCtx.save();let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of t)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),e!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${e})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}class Yp{constructor(t,e){C(this,"previewCanvas");C(this,"runningContext",null);C(this,"_disposed",!1);const o=fe();this.previewCanvas=Hn(),this.previewCanvas.width=t??o.Base.screenWidth,this.previewCanvas.height=e??o.Base.screenHeight}get disposed(){return this._disposed}async render(t,e=!0,o=!0){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=Fn.makeWithContext(this.previewCanvas,s,e,o);try{await t(this.runningContext)}catch(i){if(i instanceof Kn)return!1;throw i}finally{r===this.runningContext&&(this.runningContext=null)}return!0}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(t,e){e.w!=null&&e.h!=null?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}async download(t,e){const o=await this.drawToCanvas(t);return await he.saveToFile(o,e)}async renderToBlob(t){const e=await this.drawToCanvas(t);return await new Promise((o,s)=>{e.toBlob(r=>{r?o(r):s()})})}async drawToCanvas(t){const e=Hn();e.width=this.previewCanvas.width,e.height=this.previewCanvas.height;const o=e.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),await t(Fn.makeWithContext(e,o,!0,!1)),e}dispose(){this.runningContext&&this.runningContext.abort(),po(this.previewCanvas),this._disposed=!0}getDataAt(t,e){return this.previewCanvas.getContext("2d").getImageData(t,e,1,1).data}}class Vw{constructor(t,e,o,s,r,i){this.id=t,this.assets=e,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=i}async render(t){const{screenWidth:e,screenHeight:o}=fe().Base,s=await Promise.all(this.assets.map(r=>Fa(r,t.hq)));for(const r of s){let i=0,l=0,a=r.width,u=r.height;const c=this.scale;switch(c){case Ns.None:i=e/2-a/2,l=o/2-u/2;break;case Ns.Stretch:a=e,u=o;break;case Ns.Cover:{const f=a/u,g=e/o;f>g?(u=o,a=u*f):(a=e,u=a/f),i=e/2-a/2,l=o/2-u/2;break}default:throw new Kt.UnreachableCaseError(c)}t.drawImage({image:r,x:i,y:l,w:a,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters})}}}const yd={id:"buildin.static-color",name:"Static color",color:"#000000",render(n){const{screenWidth:t,screenHeight:e}=fe().Base;return n.drawRect({x:0,y:0,w:t,h:e,fill:{style:this.color}}),Promise.resolve()}};class Gp extends Hp{constructor(){super(...arguments);C(this,"lastUploadCount",0);C(this,"lastHq",null);C(this,"missingAsset",!1);C(this,"_canSkipLocal",!1);C(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareRender(e){super.prepareRender(e);let o=!1;if(this.missingAsset){const s=Object.keys(V.uploadUrls).length;s!==this.lastUploadCount&&(this.lastHq=null),this.lastUploadCount=s}if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),o||(o=!!this.assetList.find(s=>!("loadedAssets"in s)||s.hasMissing))),!e!==this.lastHq)for(let s=0;s<this.assetList.length;++s){const r=this.assetList[s];"loadedAssets"in r&&!r.assets.every(i=>i.hq===i.lq)&&(this.assetList[s]={assets:r.assets,offset:r.offset,composite:r.composite},o=!0)}if(this.lastHq=!e,!!o)return this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!e)}getAssetsSize(){let e=0,o=0;for(const s of this.assetList)if("loadedAssets"in s)for(const r of s.loadedAssets)e=Math.max(e,s.offset[0]+r.width),o=Math.max(o,s.offset[1]+r.height);return new DOMPointReadOnly(e,o)}loadAssets(e){const o=[];this.missingAsset=!1;for(const s of this.assetList)"loadedAssets"in s&&!s.hasMissing||o.push((async r=>{const i=await Promise.all(r.assets.map(a=>Fa(a,e))),l=r;l.loadedAssets=i,l.hasMissing=i.some(a=>a instanceof as),this.missingAsset||(this.missingAsset=l.hasMissing)})(s));if(o.length!==0)return Promise.all(o)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e){console.log("rerendering local");for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=o.composite??"source-over"),s instanceof as?s.paintOnto(e,{x:o.offset[0],y:o.offset[1],h:this.height,w:this.width}):s.paintOnto(e,{x:o.offset[0],y:o.offset[1]})}}class Fw extends Gp{constructor(e){super(e);C(this,"data");this.data=V.content.characters.get(this.obj.characterType)}prepareRender(e){return super.prepareRender(e)}isAssetListOutdated(){return!0}getAssetList(){const e=this.obj.poseData,o=this.obj.headsData,s=[],r=this.assetList??[];for(const i of e.renderCommands){let l=null;switch(i.type){case"head":{if(!o)continue;const a=o.variants[this.obj.posePositions.head||0];if(a==null)continue;l=a;break}case"image":l=i.images;break;case"pose-part":{const a=e.positions[i.part];if(!a||a.length===0)break;const u=a[this.obj.posePositions[i.part]||0];if(!u)break;l=u;break}}if(l){const a=r.find(u=>u.assets===l);a?s.push({...a,offset:i.offset,composite:i.composite}):s.push({assets:l,offset:i.offset,composite:i.composite})}}return s}}class Uw extends Ir{constructor(){super(...arguments);C(this,"_height",0);C(this,"choiceRenderers",[])}get height(){const e=fe().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=fe().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e){const o=fe().Choices,s=this.obj.width,r=o.ChoiceOuterPadding;let i=o.ChoiceOuterPadding;for(const l of this.choiceRenderers){const a=l.getHeight(this.obj.autoWrap?s:0);e.strokeStyle=o.ChoiceButtonBorderColor,e.lineWidth=o.Outline,e.fillStyle=o.ChoiceButtonColor,e.fillRect(r,i,s,a+o.ChoicePadding*2),e.strokeRect(r,i,s,a+o.ChoicePadding*2),l.applyLayout("center",r+o.ChoicePadding,i+o.ChoiceSpacing*1.25,s-o.ChoicePadding*2,this.obj.autoWrap),l.render(e),i+=a+o.ChoicePadding*2+o.ChoiceSpacing}}prepareRender(e){const o=fe();this.choiceRenderers=this.obj.choices.map(i=>new Mt(i.text||" ",o.Choices.ChoiceTextStyle));const s=()=>(this._height=this.choiceRenderers.reduce((i,l)=>i+l.getHeight(this.obj.autoWrap?this.obj.width:0)+o.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e)),r=this.choiceRenderers.map(i=>i.loadFonts()).filter(i=>i!==void 0);if(r.length===0)s();else return Promise.all(r).then(s)}}class qw extends Ir{constructor(){super(...arguments);C(this,"_height",0);C(this,"_width",0);C(this,"_textRenderer",null);C(this,"_buttonRenderer",null)}get height(){const e=fe().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=fe().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e){const o=super.prepareRender(e),s=fe().Notification,r=this._textRenderer=new Mt(this.obj.text,s.NotificationTextStyle),i=this._buttonRenderer=new Mt("OK",s.NotificationOkTextStyle),l=r.loadFonts(),a=i.loadFonts(),u=()=>{const c=this.obj.autoWrap?this.obj.width-s.NotificationPadding*2:0,f=this.obj.autoWrap?c:r.getWidth(),g=r.getHeight(c),m=this.obj.autoWrap?c:i.getWidth(),_=i.getHeight(c);this._width=Math.max(f,m)+s.NotificationPadding*2,this._height=g+s.NotificationPadding*2+s.NotificationSpacing+_};if(o||l||a)return Promise.all([o,l,a]).then(u);u()}render(e,o,s,r,i){return this.obj.backdrop&&wn(e,()=>{const l=fe();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,o,s,r,i)}renderLocal(e){const o=fe(),s=this._textRenderer,r=this._buttonRenderer,i=this._width,l=this._height,a=o.Choices.ChoiceOuterPadding;e.fillStyle=o.Choices.ChoiceButtonColor,e.strokeStyle=o.Choices.ChoiceButtonBorderColor,e.lineWidth=o.Choices.Outline,e.fillRect(a,a,i,l),e.strokeRect(a,a,i,l),s.applyLayout("center",a+o.Notification.NotificationPadding,a+o.Notification.NotificationPadding*1.5,i-o.Notification.NotificationPadding*2,!1),s.render(e),r.applyLayout("center",a,a+l-o.Notification.NotificationPadding,i+a,!1),r.render(e)}}const zw=-2,Xw=26,Yw=10,Gw=10;class Kw extends Ir{constructor(){super(...arguments);C(this,"_paperHeight",null);C(this,"_paperWidth",null);C(this,"_paper",null);C(this,"_lastPaperUrl",null)}get height(){return this._paperHeight??this.obj.height}get width(){return this._paperWidth??this.obj.width}prepareRender(e){const o=super.prepareRender(e),s=fe().Poem,r=s.poemBackgrounds[this.obj.background],i=s.poemTextStyles[this.obj.font],a=new Mt(this.obj.text,i).loadFonts();let u;if(r.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==r.file&&(u=(async()=>{this._paper=await vo(`assets/poemBackgrounds/${r.file}`),this._lastPaperUrl=r.file,this._paperHeight=this._paper.height*s.backgroundScale,this._paperWidth=this._paper.width*s.backgroundScale})()),o||a||u)return Promise.all([o,a,u])}renderLocal(e){const o=fe().Poem,s=o.poemBackgrounds[this.obj.background],r=this.width,i=this.height;let l=o.poemPadding,a=o.poemTopPadding,u=l*2;if(s.file==="internal:console")e.fillStyle=this.obj.consoleColor||o.consoleBackgroundColor,e.fillRect(0,0,r,i),l=zw,a=Xw,u=Yw;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:r,h:i}),!this.obj.overflow)){const g=new Path2D;g.rect(0,0,r,i),e.clip(g)}const c=o.poemTextStyles[this.obj.font],f=new Mt(this.obj.text,c);f.applyLayout("left",Gw+l,l+a,this.width-u,this.obj.autoWrap),f.render(e)}}class Jw extends Gp{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}const pr=class pr{constructor(t,e,o,s){C(this,"renderObjectCache",new Map);C(this,"renderer");C(this,"_disposed",!1);this._panelId=t,this.canvasWidth=e,this.canvasHeight=o,this.viewport=s,this.renderer=new Yp(e,o)}get panelId(){return this._panelId}setPanelId(t){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==t&&(this._panelId=t,this.renderObjectCache.forEach(e=>{e.dispose()}),this.renderObjectCache.clear())}render(t,e,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),t,e):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const t=new Date,e=`panel-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),e)}paintOnto(t,e){this.renderer.paintOnto(t,e)}objectsAt(t,e){const o=new DOMPointReadOnly(t,e);return this.getRenderObjects().filter(s=>s.hitTest(o)).map(s=>s.id)}getLastRenderObject(t){return this.renderObjectCache.get(t)??null}async renderCallback(t,e){var u,c,f;if(this._disposed)throw new Error("Disposed scene-renderer called");e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",await((u=this.getBackgroundRenderer())==null?void 0:u.render(e));const o=this.getRenderObjects(),s=o.map(g=>g.prepareRender(!e.hq)).filter(g=>g!==void 0);s.length>0&&await Promise.all(s);const r=((c=this.viewport)==null?void 0:c.selection)??null,i=new Set;r!==null&&a(r,i);const l=(f=document.querySelector(pr.FocusProp))==null?void 0:f.getAttribute("data-obj-id");for(const g of o){const m=r===g.id,_=l===""+g.id;g.render(e.fsCtx,(m?on.Selected:i.has(g.id)?on.Indirectly:on.None)+(_?on.Focused:on.None),e.preview,e.hq,t)}e.applyFilters([...this.panel.filters]),e.preview&&e.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:await us("backgrounds/transparent")});function a(g,m){m.add(g);for(const _ of o.filter(k=>k.linkedTo===g))a(_.id,m)}}getRenderObjects(){const t=V.panels.panels[this.panelId],e=[...t.lowerOrder,...t.topOrder],o=t.objects,s=Array.from(this.renderObjectCache.keys()).filter(r=>!e.includes(r));for(const r of s)this.renderObjectCache.get(r).dispose(),this.renderObjectCache.delete(r);return e.map(r=>{let i=this.renderObjectCache.get(r);if(!i){const l=o[r],a=l.type;switch(a){case"sprite":i=new Jw(l);break;case"character":{i=new Fw(l);break}case"textBox":i=new ww(l);break;case"choice":i=new Uw(l);break;case"notification":i=new qw(l);break;case"poem":i=new Kw(l);break;default:throw new Kt.UnreachableCaseError(a)}this.renderObjectCache.set(r,i)}return i})}get panel(){return V.panels.panels[this.panelId]}getBackgroundRenderer(){const t=this.panel;switch(t.background.current){case"buildin.static-color":return yd.color=t.background.color,yd;default:{const o=V.content.backgrounds.get(t.background.current);if(!o)return null;const s=o.variants[t.background.variant];return new Vw(t.background.current,s,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}drawDebugZoom(t,e,o,s,r,i=7){const l=t.fsCtx.getImageData(e,o,s,r),a=document.createElement("canvas");a.width=s,a.height=r,a.getContext("2d").putImageData(l,0,0),t.fsCtx.imageSmoothingEnabled=!1,t.fsCtx.drawImage(a,0,0,s*i,r*i)}};C(pr,"FocusProp",typeof CSS<"u"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let cs=pr;const Vl=new WeakMap;window.asdwefweg=Vl;function ur(n){let t=Vl.get(n);if(t==null||t.disposed){if(n.currentPanel===-1)return null;const e=fe().Base;t=new cs(n.currentPanel,e.screenWidth,e.screenHeight,n),Vl.set(n,t)}return t}const Zw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Qw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",e1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e",t1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e";async function go(n,t){try{await t()}catch(e){n1(n,e)}}function n1(n,t){console.error("Error in promise",n,t),je.fire(new gs("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+n+'", '+o1(t)))}function o1(n){if(n instanceof Error){if(n.stack!=null){const t=n.stack.split(`
`);return t[0].includes(n.name)&&t[0].includes(n.message)?t[0]+`
<br />`+t[1]:n.name+": "+n.message+`
<br />`+t[0]}return n.name+": "+n.message}return n instanceof Object?JSON.stringify(n):""+n}const hn=window.devicePixelRatio??1;class s1{constructor(t){C(this,"dragData",null);C(this,"grabbies",[new Zp,new Jp]);this.viewport=t}paint(t,e){const o=r1(e),s=this.viewport.value;if(t.save(),this.dragData&&this.dragData.viewport===s)r(e,this.dragData.lastPos),this.dragData.grabby.paint(t,this.dragData),t.translate(this.dragData.lastPos.x,this.dragData.lastPos.y),t.scale(hn,hn),this.dragData.grabby.drawGrabby(t,new DOMPointReadOnly);else{const i=fe();t.translate(o.x,o.y),t.scale(hn,hn),e.x>i.Base.screenWidth/2&&t.scale(-1,1),e.y>i.Base.screenHeight/2&&t.scale(1,-1);for(let l=0;l<this.grabbies.length;l++){const a=this.grabbies[l];a.pos||(a.pos=l1(i1*(l+1))),a.drawGrabby(t,a.pos)}}t.restore();function r(i,l){t.save();try{t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(l.x,l.y),t.setLineDash([5*hn,5*hn]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}onDown(t){const e=this.viewport.value,o=fe(),s=this.grabbies.find(r=>{const i=r.lastDrawPos;return i?Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))<=o.Base.wheelWidth/2*hn:!1});return s?(this.dragData={lastPos:t,started:!1,grabby:s,center:null,renderObj:null,viewport:e},!0):!1}onMove(t,e){var l;if(!this.dragData)return!1;const o=this.viewport.value,i=V.panels.panels[o.currentPanel].objects[o.selection];if(!this.dragData.started){this.dragData.started=!0;const a=ur(o),u=a.getLastRenderObject(i.id),c=((l=a==null?void 0:a.getLastRenderObject(i.linkedTo))==null?void 0:l.transform)??new DOMMatrixReadOnly;this.dragData.renderObj=u,this.dragData.center=c.transformPoint(new DOMPointReadOnly(i.x,i.y)),this.dragData.grabby.onStartMove(i,this.dragData)}return this.dragData.lastPos=t,this.dragData.grabby.onMove(i,e,this.dragData),!0}onDrop(){return this.dragData?(this.dragData=null,!0):!1}}const Mr=2*Math.PI;class Kp{constructor(){C(this,"pos",null);C(this,"lastDrawPos",null)}drawGrabby(t,e){var i;const o=fe();t.save(),t.translate(e.x,e.y),this.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,o.Base.wheelWidth/2,o.Base.wheelWidth/2,0,0,Mr),t.closePath();const s=getComputedStyle(document.body);t.fillStyle=s.getPropertyValue("--accent-background"),t.strokeStyle=s.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const r=document.body.classList.contains("dark-theme")?this.iconDark:this.icon;(i=Fl.get(r))==null||i.paintOnto(t),t.restore()}}class Jp extends Kp{constructor(){super(...arguments);C(this,"icon",e1);C(this,"iconDark",t1);C(this,"pos",null);C(this,"lastDrawPos",null)}paint(e,{lastPos:o,center:s,initialDragAngle:r}){const{angle:i}=Hs(Qo(s,o)),l=fe().Base,a=ro(r-i,Mr);e.beginPath(),e.moveTo(s.x,s.y);let u=r-Math.PI,c=u+i-r;if(a<=Math.PI){const f=c;c=u,u=f}e.arc(s.x,s.y,l.wheelInnerRadius,u,c),e.lineTo(s.x,s.y),e.globalCompositeOperation="difference",e.fillStyle="rgba(255, 255, 255, 1)",e.fill(),e.globalCompositeOperation="source-over"}onStartMove(e,o){o.initalObjRotation=e.rotation;const{angle:s}=Hs(Qo(o.center,o.lastPos));o.initialDragAngle=s}onMove(e,o,{center:s,initalObjRotation:r,initialDragAngle:i,lastPos:l}){const{angle:a}=Hs(Qo(s,l));let u=ro(r+(a-i)/Math.PI*180,360);o&&(u=Math.round(u/22.5)*22.5),e.rotation!==u&&re(()=>{V.panels.panels[e.panelId].objects[e.id].rotation=u})}}class Zp extends Kp{constructor(){super(...arguments);C(this,"icon",Zw);C(this,"iconDark",Qw);C(this,"pos",null);C(this,"lastDrawPos",null)}paint(e,{renderObj:o,originalObjTransform:s}){if(s!=null)try{o.transformOverride=s,wn(e,()=>{e.globalAlpha=.5,o.render(e,on.None,!0,!1,!0),e.globalAlpha=1})}finally{o.transformOverride=null}}onStartMove(e,o){o.originalObjTransform=o.renderObj.obj.globalTransform,o.initialScaleX=e.scaleX,o.initialScaleY=e.scaleY,o.initialDelta=Qo(o.center,o.lastPos)}onMove(e,o,{initialScaleX:s,initialScaleY:r,initialDelta:i,center:l,lastPos:a}){const u=fe(),c=Qo(l,a);let f=c.x/i.x*s,g=c.y/i.y*r;if(o){let m=c;l.x>u.Base.screenWidth/2&&(m=new DOMPointReadOnly(-m.x,m.y)),l.y>u.Base.screenHeight/2&&(m=new DOMPointReadOnly(m.x,-m.y));const{angle:_}=Hs(m),k=Math.round(_/Mr*11),y=(Math.abs(c.x)/Math.abs(i.x)+Math.abs(c.y)/Math.abs(i.y))/2;k===0||k===11?g=r:k===1?(f=-y*s,g=-y*r):k===2||k===3?f=s:k===4?(f=y*s,g=-y*r):k===5||k===6?g=r:k===7?(f=y*s,g=y*r):k===8||k===9?f=s:k===10&&(f=-y*s,g=y*r)}e.scaleX===f&&e.scaleY===g||re(()=>{V.panels.panels[e.panelId].objects[e.id].scaleX=f,V.panels.panels[e.panelId].objects[e.id].scaleY=g})}}const Fl=new Map;for(const n of[Zp,Jp])go("Loading grabby icon",async()=>{const t=new n;Fl.set(t.icon,await vo(t.icon)),Fl.set(t.iconDark,await vo(t.iconDark))});function r1(n){const t=fe(),e=t.Base.wheelWidth+t.Base.wheelInnerRadius*hn;return new DOMPointReadOnly(sr(e,n.x,t.Base.screenWidth-e),sr(e,n.y,t.Base.screenHeight-e))}const i1=Math.PI/6;function l1(n){const t=fe().Base;return new DOMPointReadOnly(t.wheelInnerRadius*Math.cos(n),t.wheelInnerRadius*Math.sin(n))}function Qo(n,t){return new DOMPointReadOnly(n.x-t.x,n.y-t.y)}function Hs(n){const t=Math.atan2(n.y,n.x);return{angle:ro(t,Mr),distance:Math.sqrt(n.x*n.x+n.y*n.y)}}const a1=["height","width"],u1=_e({__name:"preview-render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean,default:!1}},setup(n,{expose:t}){const e=n,o=R(null),s=R(null),r=R(null),i=R(!1),l=R(!1),a=Ot(),u=E(()=>V.panels.panels[a.value.currentPanel]),c=new s1(a),f=Hf(),g=E(()=>V.panels.panels[a.value.currentPanel]),m=E(()=>V.ui.lqRendering);function _(){if(e.preLoading)return null;const oe=ur(a.value);return oe==null||oe.setPanelId(a.value.currentPanel),oe}const k=E(()=>(e.preLoading,fe().Base.screenHeight)),y=E(()=>(e.preLoading,fe().Base.screenWidth));function w(){r.value==null&&(r.value=requestAnimationFrame(h))}async function h(){var oe;if(r.value!=null&&(cancelAnimationFrame(r.value),r.value=null),!e.preLoading&&!V.unsafe){try{if(V.panels.order.includes(a.value.currentPanel))await((oe=_())==null?void 0:oe.render(!m.value,!0,!0));else{p();return}}catch(we){console.log(we)}P(),je.fire(new er)}}function v(){const oe=document.createElement("canvas");oe.height=k.value,oe.width=y.value;try{Fn.make(oe,!0,!1).drawText({text:"Starting...",x:oe.width/2,y:oe.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),s.value.drawImage(oe,e.canvasWidth,e.canvasHeight)}finally{po(oe)}}function p(){const oe=o.value,we=Fn.make(oe,!0,!1),xe=_();xe==null||xe.paintOnto(we.fsCtx,{x:0,y:0,w:y.value,h:k.value}),we.applyFilters([new fo("blur",10)]),we.drawText({text:"No panel selected",x:oe.width/2,y:oe.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}})}function P(){const oe=_();i.value=!1,oe==null||oe.paintOnto(s.value,{x:0,y:0,w:y.value,h:k.value});const we=oe==null?void 0:oe.getLastRenderObject(f.value);we&&c.paint(s.value,we.transform.transformPoint(new DOMPoint(0,0))),b.value=!1}function M(oe,we,xe){const $e=o.value,S=oe-$e.offsetLeft,$=we-$e.offsetTop;let W=S/$e.offsetWidth*$e.width,Z=$/$e.offsetWidth*$e.width;if(xe){const J=xe.transformPoint(new DOMPointReadOnly(W,Z));W=J.x,Z=J.y}return[W,Z]}function N(oe){const[we,xe]=M(oe.clientX,oe.clientY);if(B(we,xe))return;if(l.value){l.value=!1;return}const $e=_().objectsAt(we,xe),S=f.value,$=$e.findIndex(Z=>Z===S);let W;$===0?W=null:$!==-1?W=$e[$-1]:W=$e[$e.length-1]??null,re(()=>{a.value.selection!==W&&(a.value.selection=W)})}window.redraw=function(){je.fire(new Qs)},ze(()=>[e.canvasWidth,e.canvasHeight],()=>P()),je.subscribe(Qs,w),je.subscribe(tr,()=>{const oe=_();oe&&oe.setPanelId(-1)}),re.onClear(()=>{w()}),ze(()=>[f.value,a.value.currentPanel],()=>{w()}),Wt(()=>{s.value=o.value.getContext("2d"),v(),w()}),Sn(()=>{_().dispose()});const b=R(!1);async function O(oe){if(b.value)h(),b.value=!1;else{const we=await ar(oe,!0);s.value.clearRect(0,0,o.value.width,o.value.height),we.paintOnto(s.value,{x:0,y:0}),b.value=!0}}const T=E(()=>a.value.pickColor),L=E(()=>T.value?"crosshair":"default");function B(oe,we){if(T.value){const xe=s.value.getImageData(oe,we,1,1).data,$e=`rgba(${xe[0].toString()},${xe[1].toString()},${xe[2].toString()},${(xe[3]/255).toString()})`;return re(()=>{a.value.pickColor=!1,je.fire(new nr($e))}),!0}return!1}async function H(){const oe=await _().download(),we=V.ui.lastDownload;V.ui.lastDownload=oe,we!=null&&URL.revokeObjectURL(we)}let ee=null,Y=null,x=0,A=0,G=0,Ie=0;function K(oe){oe.preventDefault(),be(oe.clientX,oe.clientY)}function ie(oe){be(oe.touches[0].clientX,oe.touches[0].clientY)}function be(oe,we){var $,W;const xe=f.value;if(xe===null)return;ee=g.value.objects[xe],Y=((W=($=ur(a.value).getLastRenderObject(ee.linkedTo))==null?void 0:$.transform)==null?void 0:W.inverse())??new DOMMatrixReadOnly;const[$e,S]=M(oe,we,Y);xe!=null&&c.onDown(new DOMPointReadOnly(...M(oe,we)))||(x=$e-ee.x,A=S-ee.y,G=ee.x,Ie=ee.y)}function Me(oe){oe.stopPropagation(),oe.preventDefault(),oe.dataTransfer.dropEffect="copy"}function ye(oe){if(!ee)return;oe.preventDefault();const we=Zo(oe)?oe.clientX:oe.touches[0].clientX,xe=Zo(oe)?oe.clientY:oe.touches[0].clientY;let[$e,S]=M(we,xe,Y);if(c.onMove(new DOMPointReadOnly(...M(we,xe)),oe.shiftKey)){w();return}$e-=x,S-=A;const $=Math.abs($e-G),W=Math.abs(S-Ie);$+W>1&&(l.value=!0),oe.shiftKey&&($>W?S=Ie:$e=G),re(async()=>{const Z=V.panels.panels[ee.panelId].objects[ee.id];re(()=>{Z.x=$e,Z.y=S})})}async function nt(oe){if(oe.stopPropagation(),oe.preventDefault(),!!oe.dataTransfer){for(const we of oe.dataTransfer.items)if(we.kind==="file"&&we.type.match(/image.*/)){const xe=we.getAsFile(),$e=URL.createObjectURL(xe);try{const S=await V.uploadUrls.add(xe.name,$e);await re(async()=>{await La.create(u.value,[{hq:S,lq:S,sourcePack:"dddg.uploaded.sprites"}])})}catch{URL.revokeObjectURL($e)}}}}function Xe(oe){if(c.onDrop()){w(),oe.preventDefault(),ee=null,l.value=!0;return}ee&&("TouchEvent"in window&&$w(oe)&&(l.value=!1),ee=null)}function Ye(oe){oe.buttons!==1&&(ee=null,c.onDrop()&&w())}return t({download:H,blendOver:O}),(oe,we)=>(j(),U("canvas",{id:"scaled_display",ref_key:"sd",ref:o,height:k.value,width:y.value,style:tt({width:oe.canvasWidth+"px",height:oe.canvasHeight+"px",cursor:L.value}),draggable:"true",onClick:N,onTouchstart:ie,onDragstart:K,onTouchmove:ye,onMousemove:ye,onTouchend:Xe,onMouseup:Xe,onDragover:Me,onDrop:nt,onMouseenter:Ye,onContextmenu:we[0]||(we[0]=pe(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,a1))}}),c1=["disabled","title","aria-label"],d1={key:0,class:"material-icons","aria-hidden":"true"},f1={class:"content"},p1={key:1,class:"shortcut-popup"},h1=_e({__name:"d-button",props:{icon:{},iconPos:{default:"left"},disabled:{type:Boolean,default:!1},shortcut:{},title:{}},setup(n){const t=n,e=R(null),o=E(()=>t.shortcut!=null&&!t.shortcut.startsWith("!")),s=E(()=>{const i=t.shortcut;return i==null?"":i.startsWith("!")?i.substring(1):i});function r(i){t.disabled||i.key===t.shortcut&&i.ctrlKey&&!i.altKey&&!i.metaKey&&!i.shiftKey&&(e.value.focus({focusVisible:!1}),e.value.click(),i.preventDefault(),i.stopPropagation())}return Wt(()=>{t.shortcut!=null&&window.addEventListener("keydown",r)}),Sn(()=>{window.removeEventListener("keydown",r)}),(i,l)=>(j(),U("button",{class:He([i.iconPos]),disabled:i.disabled,title:i.title,"aria-label":i.title,style:tt(i.icon?"height: auto":""),ref_key:"btn",ref:e},[i.icon?(j(),U("div",d1,Pe(i.icon),1)):de("",!0),d("div",f1,[Xt(i.$slots,"default",{},void 0,!0)]),o.value?(j(),U("div",p1,Pe(s.value),1)):de("",!0)],14,c1))}}),Te=Ee(h1,[["__scopeId","data-v-bbb09c0d"]]),v1={methods:{verticalScrollRedirect:Qp}};function Qp(n){if(n.type!=="wheel"||!n.currentTarget)return;const t=n.currentTarget,e=getComputedStyle(t),o=n;if(o.deltaY===0)return;if(e.overflowY==="auto"){if(o.deltaY>0){if(t.scrollHeight>t.scrollTop+t.clientHeight){n.stopPropagation();return}}else if(t.scrollTop>0){n.stopPropagation();return}}const s=t.scrollLeft;t.scrollLeft+=o.deltaY,t.scrollLeft!==s&&n.stopPropagation()}function Dt(n){const t=Pn();function e(){const s=n.value;return s==null?null:s.$el?s.$el:s}function o(){n.value!=null&&e().classList.toggle("vertical",t.value)}return ze(()=>t.value,o),Wt(()=>{o(),e().addEventListener("wheel",s=>{t.value||Qp(s)},{passive:!0})}),{vertical:t,getRoot:e}}const g1=["title","onClick","onKeypress"],m1=["src","alt"],b1=_e({__name:"characters-tab",emits:["show-dialog"],setup(n,{emit:t}){const e=t,o=Ot(),s=E(()=>V.content.current.characters),r=E(()=>V.panels.panels[o.value.currentPanel]);function i(a){return a.chibi?he.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){re(async()=>{Dp.create(r.value,a)})}return(a,u)=>(j(),U(ue,null,[(j(!0),U(ue,null,qe(s.value,c=>(j(),U("div",{class:"character",tabindex:"0",key:c.id,title:c.label,onClick:pe(f=>l(c.id),["left"]),onKeypress:[it(pe(f=>l(c.id),["prevent","stop"]),["enter"]),it(pe(f=>l(c.id),["prevent","stop"]),["space"])]},[d("img",{src:i(c),alt:c.label},null,8,m1)],40,g1))),128)),q(Te,{class:"custom-sprite",icon:"extension",onClick:u[0]||(u[0]=c=>e("show-dialog","type: Characters"))},{default:ne(()=>u[1]||(u[1]=[te(" Search in content packs ")])),_:1})],64))}}),y1=Ee(b1,[["__scopeId","data-v-13d7a68a"]]),w1=_e({__name:"drop-target",emits:["drop"],setup(n,{expose:t,emit:e}){const o=e,s=R(!1),r=Pn();function i(){s.value=!0}function l(){s.value=!1}function a(u){if(l(),u.stopPropagation(),u.preventDefault(),!!u.dataTransfer){for(const c of u.dataTransfer.items)if(c.kind==="file"&&c.type.match(/image.*/)){const f=c.getAsFile();f!=null&&o("drop",f)}}}return t({show:i,hide:l}),(u,c)=>s.value?(j(),U("div",{key:0,onDragleave:c[0]||(c[0]=f=>s.value=!1),onDrop:a,class:He({vertical:Q(r)})},[Xt(u.$slots,"default",{},void 0,!0)],34)):de("",!0)}}),eh=Ee(w1,[["__scopeId","data-v-43b59d3a"]]),k1=["title","onClick","onKeypress"],C1=["title","onClick","onKeypress"],_1=_e({__name:"sprites-tab",emits:["show-dialog"],setup(n,{expose:t,emit:e}){const o=e,s=R(""),r=E(()=>s.value.toLowerCase()),i=Ot(),l=E(()=>V.panels.panels[i.value.currentPanel]),a=E(()=>V.content.current.sprites.map(O=>{let T=null;const L=O.variants[0].map(B=>{const H=kn(B,!1);return H.startsWith("uploads:")?(Object.keys(V.uploadUrls),T=H,zp):H});return{...O,missing:T,urls:L,search:O.label.toLocaleLowerCase()}})),u=E(()=>he.supports.openableFolders.has("sprites"));function c(O){return O.variants[0].map(T=>`url('${kn(T,!1)}')`).join(",")}async function f(O){await re(async()=>{await La.create(l.value,O.variants[0])})}function g(){he.openFolder("sprites")}const m=R(null);async function _(){const O=m.value,T=O.uploadingSprite;if(!O.files)return;if(O.files.length!==1){console.error("More than one file uploaded!");return}const L=O.files[0];await re(async()=>{const B=URL.createObjectURL(L);await V.uploadUrls.add(T,B)})}function k(O){const T=m.value;T.uploadingSprite=kn(O.variants[0][0]).substring(8),T.click()}const y={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},w=R(null);function h(){const O=w.value;if(O.files)for(const T of O.files)p(T)}async function v(){const O=prompt("Enter the URL of the image");if(O==null)return;const T=O.split("/").slice(-1)[0];await P(T,O)}async function p(O){await re(async T=>{const L=URL.createObjectURL(O),B=await V.uploadUrls.add(O.name,L);await P(O.name,B,T)})}async function P(O,T,L=re){const B=V.content.contentPacks.find(ee=>ee.packId===y.packId)||y,H={...B,sprites:[...B.sprites,{id:T,label:O,variants:[[{lq:T,hq:T,sourcePack:y.packId}]],defaultScale:[1,1],hd:null}]};await L(async()=>{await V.content.replaceContentPack({contentPack:H,processed:!0})})}const M=R(null);function N(O){O.dataTransfer&&(O.dataTransfer.effectAllowed="none",Array.from(O.dataTransfer.items).find(T=>T.type.match(/^image.*$/))&&(O.dataTransfer.effectAllowed="link",M.value.show()))}function b(){M.value.hide()}return t({showDropTarget:N,hideDropTarget:b}),(O,T)=>(j(),U(ue,null,[q(eh,{ref_key:"spriteDt",ref:M,class:"drop-target",onDrop:p},{default:ne(()=>T[3]||(T[3]=[te("Drop here to add as a new sprite ")])),_:1},512),Se(d("input",{placeholder:"Search",class:"search","onUpdate:modelValue":T[0]||(T[0]=L=>s.value=L)},null,512),[[Je,s.value]]),q(Te,{class:"custom-sprite v-w100",icon:"publish",onClick:T[1]||(T[1]=L=>w.value.click())},{default:ne(()=>[T[4]||(T[4]=te(" Upload new sprite ")),d("input",{type:"file",ref_key:"spriteUpload",ref:w,onChange:h,multiple:""},null,544)]),_:1}),q(Te,{icon:"insert_link",onClick:v},{default:ne(()=>T[5]||(T[5]=[te(" New sprite from URL ")])),_:1}),q(Te,{icon:"extension",onClick:T[2]||(T[2]=L=>o("show-dialog","type: Sprites"))},{default:ne(()=>T[6]||(T[6]=[te(" Search in content packs ")])),_:1}),u.value?(j(),ce(Te,{key:0,icon:"folder",onClick:g},{default:ne(()=>T[7]||(T[7]=[te(" Open sprites folder ")])),_:1})):de("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:m,onChange:_},null,544),(j(!0),U(ue,null,qe(a.value,L=>(j(),U(ue,null,[!s.value||L.search.includes(r.value)?(j(),U(ue,{key:0},[L.missing!==null?(j(),U("div",{class:"sprite",tabindex:"0",key:`${L.label}_missing`,title:L.label,style:tt({background:c(L)}),onClick:B=>k(L),onKeypress:[it(pe(B=>k(L),["prevent","stop"]),["enter"]),it(pe(B=>k(L),["prevent","stop"]),["space"])]},Pe(L.label),45,k1)):(j(),U("div",{class:"sprite",tabindex:"0",key:L.label,title:L.label,style:tt({background:c(L)}),onClick:B=>f(L),onKeypress:[it(pe(B=>f(L),["prevent","stop"]),["enter"]),it(pe(B=>f(L),["prevent","stop"]),["space"])]},Pe(L.label),45,C1))],64)):de("",!0)],64))),256))],64))}}),x1=Ee(_1,[["__scopeId","data-v-6817d420"]]),S1=_e({__name:"ui-tab",setup(n){const t=Ot(),e=E(()=>V.panels.panels[t.value.currentPanel]);async function o(){re(()=>{bn.create(e.value)})}async function s(){re(()=>{Bp.create(e.value)})}async function r(){re(()=>{Ep.create(e.value)})}async function i(){re(()=>{Bl.createPoem(e.value)})}async function l(){re(()=>{Bl.createConsole(e.value)})}return(a,u)=>(j(),U(ue,null,[d("button",{class:"v-w100",onClick:o},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:i},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:r},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:s},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}}),P1=["innerHTML"],O1=["disabled"],T1=_e({__name:"add-tool",setup(n){const t={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},e=R(null),o=R("characters"),s=R(null),{vertical:r}=Dt(e),i=E(()=>V.ui.clipboard!=null),l=Ot();function a(){re(async()=>{V.ui.pasteObjects(V.panels.panels[l.value.currentPanel])})}return(u,c)=>(j(),U("div",{class:"panel",ref_key:"root",ref:e,onDragenter:c[2]||(c[2]=(...f)=>{var g,m;return((g=s.value)==null?void 0:g.showDropTarget)&&((m=s.value)==null?void 0:m.showDropTarget(...f))}),onMouseleave:c[3]||(c[3]=(...f)=>{var g,m;return((g=s.value)==null?void 0:g.hideDropTarget)&&((m=s.value)==null?void 0:m.hideDropTarget(...f))})},[c[4]||(c[4]=d("h1",null,"Add",-1)),d("div",{class:He({"group-selector":!0,vertical:Q(r)})},[(j(),U(ue,null,qe(t,(f,g)=>q(Te,{key:g,class:He({active:o.value===g,"v-bl0":g!=="characters","h-bt0":g!=="characters"}),"icon-pos":"top",icon:f.icon,shortcut:f.shortcut,onClick:m=>o.value=g},{default:ne(()=>[d("span",{innerHTML:f.text},null,8,P1)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:He({"item-grid":!0,vertical:Q(r)})},[o.value==="characters"?(j(),ce(y1,{key:0,onShowDialog:c[0]||(c[0]=f=>u.$emit("show-dialog",f))})):o.value==="sprites"?(j(),ce(x1,{key:1,ref_key:"sprites",ref:s,onShowDialog:c[1]||(c[1]=f=>u.$emit("show-dialog",f))},null,512)):o.value==="ui"?(j(),ce(S1,{key:2})):de("",!0),d("button",{class:"v-w100",onClick:a,disabled:!i.value}," Paste ",8,O1)],2)],544))}}),$1=Ee(T1,[["__scopeId","data-v-ec062df1"]]),j1=["href"],Qe=_e({__name:"external-link",props:{to:{}},setup(n){const t=n,e=R(null),o=E(()=>{let s=t.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,i)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+i.replaceAll(" ","-")),s});return(s,r)=>(j(),U("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[Xt(s.$slots,"default")],8,j1))}}),R1=_e({__name:"app-credits",setup(n){const t=R(null);return Dt(t),(e,o)=>(j(),U("div",{class:"panel",ref_key:"root",ref:t},[o[35]||(o[35]=d("h1",null,"Help and Credits",-1)),q(Qe,{class:"btn",to:"wiki://Dokumentation"},{default:ne(()=>o[0]||(o[0]=[te("Help")])),_:1}),q(Qe,{class:"btn",to:"github://"},{default:ne(()=>o[1]||(o[1]=[te("Fork me on GitHub")])),_:1}),q(Qe,{class:"btn",to:"wiki://Privacy Statement"},{default:ne(()=>o[2]||(o[2]=[te("Privacy Statement")])),_:1}),o[36]||(o[36]=d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),o[37]||(o[37]=d("p",null,[te(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),te("Based on gemdude46's DDLC Shitpost generator ")],-1)),d("p",null,[o[4]||(o[4]=te(" Unused House Background by ")),q(Qe,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:ne(()=>o[3]||(o[3]=[te(" Fatelogic ")])),_:1})]),d("p",null,[o[6]||(o[6]=te(" Aller Font by ")),q(Qe,{to:"https://www.daltonmaag.com/library/aller"},{default:ne(()=>o[5]||(o[5]=[te("Dalton Maag Ltd")])),_:1})]),d("p",null,[o[8]||(o[8]=te(" Riffic Bold Font by ")),q(Qe,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:ne(()=>o[7]||(o[7]=[te("InkyType")])),_:1})]),d("p",null,[o[10]||(o[10]=te(" Verily Serif Mono Font by ")),q(Qe,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:ne(()=>o[9]||(o[9]=[te("Stephen G. Hartke")])),_:1})]),d("p",null,[o[12]||(o[12]=te(" F25 Bank Printer Font by ")),q(Qe,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:ne(()=>o[11]||(o[11]=[te("F25 Digital Typeface Design")])),_:1})]),d("p",null,[o[14]||(o[14]=te(" Journal Font by ")),q(Qe,{to:"https://www.dafont.com/journal.font"},{default:ne(()=>o[13]||(o[13]=[te("Fontourist")])),_:1})]),d("p",null,[o[16]||(o[16]=te(" Hashtag Font by ")),q(Qe,{to:"https://www.dafont.com/hashtag.font"},{default:ne(()=>o[15]||(o[15]=[te(" TitanVex")])),_:1})]),d("p",null,[o[18]||(o[18]=te(" JP Hand Slanted Font by ")),q(Qe,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:ne(()=>o[17]||(o[17]=[te("Jonathan Paterson")])),_:1})]),d("p",null,[o[20]||(o[20]=te(" As I Lay Dying Font by ")),q(Qe,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:ne(()=>o[19]||(o[19]=[te("Moises Esqueda")])),_:1})]),d("p",null,[o[22]||(o[22]=te(" Damagrafik Script Font by ")),q(Qe,{to:"https://www.dafont.com/damagrafik-script.font"},{default:ne(()=>o[21]||(o[21]=[te("Davide Terenzi")])),_:1})]),d("p",null,[o[24]||(o[24]=te(" Ammy's Handwriting Font by ")),q(Qe,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:ne(()=>o[23]||(o[23]=[te("Ammy K.")])),_:1})]),d("p",null,[o[26]||(o[26]=te(" Halogen Font by ")),q(Qe,{to:"https://www.dafont.com/halogen.font"},{default:ne(()=>o[25]||(o[25]=[te("JLH Fonts")])),_:1})]),o[38]||(o[38]=d("p",null,[te(" MC Sprite by Childish-N "),d("br"),te("MC Casual Sprite by SlightlySimple "),d("br"),te("MC Chibi by SlightlySimple ")],-1)),d("p",null,[q(Qe,{to:"https://www.reddit.com/r/DDLCMods/comments/1hhmu77/"},{default:ne(()=>o[27]||(o[27]=[te("Concept MC")])),_:1}),o[29]||(o[29]=te(" by StormBlazed76, ")),q(Qe,{to:"https://www.reddit.com/ofof3o"},{default:ne(()=>o[28]||(o[28]=[te("chibi")])),_:1}),o[30]||(o[30]=te(" by Hadrosaur838 "))]),o[39]||(o[39]=d("p",null,[te(" MC Chad Sprite by Cylent-Nite "),d("br"),te("MC Chad Poses and expressions by SlightlySimple "),d("br"),te("MC Chad Poses and chibi by Meddy-sin ")],-1)),o[40]||(o[40]=d("p",null,[te(" FeMC Sprite by Meddy-sin "),d("br"),te("FeMC Casual Sprite by SlightlySimple ")],-1)),d("p",null,[q(Qe,{to:"https://www.reddit.com/oizaow"},{default:ne(()=>o[31]||(o[31]=[te("Concept FeMC")])),_:1}),o[33]||(o[33]=te(" by ShidoDraws, ")),q(Qe,{to:"https://www.reddit.com/oosuxu"},{default:ne(()=>o[32]||(o[32]=[te("additional poses, expressions and chibi")])),_:1}),o[34]||(o[34]=te(" by SlightlySimple "))]),o[41]||(o[41]=d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),o[42]||(o[42]=d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),o[43]||(o[43]=d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1))],512))}}),A1=Ee(R1,[["__scopeId","data-v-deba67a0"]]);let Ul=0;typeof BigInt<"u"&&(Ul=BigInt(0));function Ua(){const n=Ul;return Ul++,n+""}const I1={class:"toggle_box"},M1=["id"],D1=["for"],B1=["for"],Ke=_e({__name:"d-toggle",props:En({label:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=hs(n,"modelValue"),e=Ua(),o=R(null);return(s,r)=>(j(),U("div",I1,[Se(d("input",{id:Q(e),type:"checkbox",ref_key:"checkbox",ref:o,"onUpdate:modelValue":r[0]||(r[0]=i=>t.value=i)},null,8,M1),[[Rg,t.value]]),d("label",{for:Q(e),class:"switch"},null,8,D1),d("label",{for:Q(e),class:"toggle_label"},Pe(s.label),9,B1)]))}}),E1={class:"modal-scroll-area"},L1={class:"modal-scroll-area"},N1={key:0},H1={key:1},W1={key:2},V1={key:3,disabled:""},F1={class:"v-w100"},U1={key:7,class:"downloadTable"},q1=_e({__name:"app-settings",setup(n){const t=R(null),e=he.updateProgress;Dt(t);function o(){he.saveSettings({lq:V.ui.lqRendering,nsfw:V.ui.nsfw,darkMode:V.ui.useDarkTheme??void 0,looseTextParsing:he.state.looseTextParsing,defaultCharacterTalkingZoom:V.ui.defaultCharacterTalkingZoom})}const s=E(()=>he.supports.optionalSaving),r=R(!1),i=R(!1),l=R(!1),a=E({get(){return he.savingEnabled},set(B){l.value=!0,he.savingEnabled=B,o()}});function u(B){r.value=!1,B==="Allow"&&(a.value=!0)}function c(B){i.value=!1,B==="Deny"&&(a.value=!1)}ze(()=>a.value,()=>l.value=!1);const f=R(!1),g=E(()=>he.gameMode==="ddlc_plus");function m(B){go("changing modes",async()=>{B==="Enter Classic Mode"?await he.setGameMode("ddlc"):B==="Enter Plus mode"?await he.setGameMode("ddlc_plus"):f.value=!1})}const _=E(()=>he.supports.lq),k=E({get(){return V.ui.lqRendering},set(B){re(()=>{V.ui.lqRendering=B}),o()}}),y=E({get(){return!!V.ui.nsfw},set(B){re(()=>{V.ui.nsfw=B,o()})}}),w=E({get(){return!!V.ui.defaultCharacterTalkingZoom},set(B){re(()=>{V.ui.defaultCharacterTalkingZoom=B,o()})}}),h=E({get(){return he.state.looseTextParsing},set(B){he.state.looseTextParsing=B,o()}}),v=E({get(){return V.ui.useDarkTheme},set(B){re(()=>{V.ui.useDarkTheme=B,o()})}}),p=E(()=>he.supports.setDownloadFolder),P=E(()=>he.state.downloadLocation);function M(){he.updateDownloadFolder()}function N(){he.openFolder("downloads")}const b=E(()=>he.state.hasTemplate);function O(){he.saveDefaultTemplate()}function T(){he.clearDefaultTemplate()}function L(){const B=he.openNewWindow();if(!B){je.fire(new gs("Failed to open new window. You may need to enable popups."));return}const H=B.document.createElement("div");B.document.body.appendChild(H);for(const Y of document.head.querySelectorAll("style,link[rel=stylesheet]"))B.document.head.appendChild(Y.cloneNode(!0));document.body.classList.contains("dark-theme")&&B.document.body.classList.add("dark-theme");const ee=B.document.createElement("title");B.document.title="DDLC child",B.document.head.appendChild(ee),Ef(th).mount(H)}return(B,H)=>(j(),U("div",{class:"panel",ref_key:"root",ref:t},[H[27]||(H[27]=d("h1",null,"Settings",-1)),(j(),ce(oa,{to:"#modal-messages"},[r.value?(j(),ce(Bn,{key:0,options:["Allow","Deny"],onLeave:H[0]||(H[0]=ee=>u("Deny")),onOption:u,"no-base-size":""},{default:ne(()=>[d("div",E1,[H[14]||(H[14]=d("p",null," Do you want to allow DDDG to save settings on your device? ",-1)),H[15]||(H[15]=d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),H[16]||(H[16]=d("p",null,"You can revoke this permission at any time.",-1)),d("p",null,[H[12]||(H[12]=te(" Our usual ")),q(Qe,{to:"wiki://Privacy Statement"},{default:ne(()=>H[11]||(H[11]=[te("privacy policy")])),_:1}),H[13]||(H[13]=te(" still applies. "))])])]),_:1})):de("",!0),i.value?(j(),ce(Bn,{key:1,options:["Deny","Cancle"],onLeave:H[1]||(H[1]=ee=>c("Cancel")),onOption:c,"no-base-size":""},{default:ne(()=>[d("div",L1,[H[20]||(H[20]=d("p",null," Do you want to deny DDDG from saving settings on your device? ",-1)),H[21]||(H[21]=d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),d("p",null,[H[18]||(H[18]=te(" Our usual ")),q(Qe,{to:"wiki://Privacy Statement"},{default:ne(()=>H[17]||(H[17]=[te("privacy policy")])),_:1}),H[19]||(H[19]=te(" still applies. "))])])]),_:1})):de("",!0),f.value?(j(),ce(Bn,{key:2,options:[g.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:H[2]||(H[2]=ee=>f.value=!1),onOption:m,"no-base-size":""},{default:ne(()=>H[22]||(H[22]=[d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)])),_:1},8,["options"])):de("",!0)])),Q(e)==="done"?(j(),U("p",N1," Update is successfully downloaded. It will be installed once the application is closed. ")):de("",!0),Q(e)==="wait"?(j(),U("p",H1,"Checking for updates...")):de("",!0),typeof Q(e)=="number"?(j(),U("p",W1," Downloading update ("+Pe(Q(e))+"%) ",1)):de("",!0),l.value?(j(),U("button",V1,"Applying...")):!a.value&&s.value?(j(),U("button",{key:4,onClick:H[3]||(H[3]=ee=>r.value=!0)}," Allow saving options ")):a.value&&s.value?(j(),U("button",{key:5,onClick:H[4]||(H[4]=ee=>i.value=!0)}," Deny saving options ")):de("",!0),d("button",{onClick:H[5]||(H[5]=ee=>f.value=!0),class:He(s.value?"bt0":"")},[g.value?(j(),U(ue,{key:0},[te(" Enter Classic Mode ")],64)):(j(),U(ue,{key:1},[te(" Enter DDLC Plus Mode ")],64))],2),q(Te,{class:"bt0",onClick:L,icon:"open_in_new",style:{height:"auto"}},{default:ne(()=>H[23]||(H[23]=[te(" Open additional window ")])),_:1}),_.value?(j(),ce(Ke,{key:6,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:k.value,"onUpdate:modelValue":H[6]||(H[6]=ee=>k.value=ee)},null,8,["modelValue"])):de("",!0),q(Ke,{label:"NSFW Mode?",modelValue:y.value,"onUpdate:modelValue":H[7]||(H[7]=ee=>y.value=ee)},null,8,["modelValue"]),q(Ke,{label:"Enlarge talking objects? (Default value)",modelValue:w.value,"onUpdate:modelValue":H[8]||(H[8]=ee=>w.value=ee)},null,8,["modelValue"]),q(Ke,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:h.value,"onUpdate:modelValue":H[9]||(H[9]=ee=>h.value=ee)},null,8,["modelValue"]),d("table",F1,[d("tbody",null,[d("tr",null,[H[25]||(H[25]=d("td",null,[d("label",null,"Theme:")],-1)),d("td",null,[Se(d("select",{"onUpdate:modelValue":H[10]||(H[10]=ee=>v.value=ee),class:"v-w100"},H[24]||(H[24]=[d("option",{value:null},"System",-1),d("option",{value:!1},"Light",-1),d("option",{value:!0},"Dark",-1)]),512),[[St,v.value]])])])])]),p.value?(j(),U("table",U1,[d("tbody",null,[d("tr",null,[H[26]||(H[26]=d("td",null,[d("label",null,"Download folder:")],-1)),d("td",null,Pe(P.value),1),d("td",null,[d("button",{onClick:M},"Set"),d("button",{onClick:N},"Open")])])])])):de("",!0),a.value?(j(),U(ue,{key:8},[d("button",{onClick:O},"Save as template"),b.value?(j(),U("button",{key:0,onClick:T}," Clear template ")):de("",!0)],64)):de("",!0)],512))}}),z1=Ee(q1,[["__scopeId","data-v-57e1dbee"]]),X1=_e({mixins:[v1],inject:["viewport"],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.viewport.isVertical?"vertical":"horizontal":this.direction==="inverted"?this.viewport.isVertical?"horizontal":"vertical":this.direction}},render(){const n=this.noWraping?"no-wraping":"wraping",t=hu("div",{class:["d-flow",this.finalDirection,n],style:{gap:this.gap}},this.$slots.default());if(this.maxSize!==void 0){const e=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return hu("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:e}},[t])}return t},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}}),At=Ee(X1,[["__scopeId","data-v-592e1a80"]]),Y1=["for"],G1=["id","x1","x2"],K1=["offset"],J1=["fill"],Z1=["d"],Q1=["id","max","value"],Ts=255,ml=8,ek=_e({__name:"color-slider",props:En({label:{},gradientStops:{},maxValue:{},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=Ua(),s=Pn(),r=R(null),i=E(()=>{const m=e.value/t.maxValue*Ts;return`M${m} 0L${m+14} 0L${m+7} 12Z`}),l=E(()=>!t.shiftGradient||e.value===0?0:e.value/t.maxValue);function a(m){e.value=parseFloat(m.target.value)}const u=R(!1);function c(m){u.value=!0,f(m),Zo(m)&&(window.addEventListener("mousemove",f),window.addEventListener("mouseup",g)),m.preventDefault()}function f(m){if(!u.value)return;const _=r.value;if(Zo(m)&&m.buttons===0){g();return}m.preventDefault();const k=_.getBoundingClientRect(),y=k.width/(ml+Ts+ml),h=((Zo(m)?m.clientX:m.touches[0].clientX)-k.x)/y,v=Math.max(Math.min(h-ml,Ts),0)/Ts*t.maxValue;e.value=v,m.preventDefault()}function g(){u.value=!1,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",g)}return(m,_)=>(j(),U("div",{class:He({slider:!0,vertical:Q(s)}),onKeydown:_[1]||(_[1]=pe(()=>{},["stop"]))},[m.noInput?de("",!0):(j(),U("label",{key:0,for:Q(o)},Pe(m.label),9,Y1)),d("div",null,[(j(),U("svg",{ref_key:"svg",ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:c,onTouchstart:c,onTouchmove:f,onTouchend:g},[d("defs",null,[d("linearGradient",{id:`gradient${Q(o)}`,x1:l.value*100+"%",y1:"0%",x2:(l.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(j(!0),U(ue,null,qe(m.gradientStops,(k,y)=>(j(),U("stop",{key:y,offset:y/(m.gradientStops.length-1)*100+"%",style:tt("stop-color:"+k)},null,12,K1))),128))],8,G1)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${Q(o)})`},null,8,J1),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,Z1)])],544))]),m.noInput?de("",!0):(j(),U("input",{key:1,id:Q(o),class:"sliderInput",min:"0",max:m.maxValue,value:e.value,type:"number",onInput:a,onKeydown:_[0]||(_[0]=pe(()=>{},["stop"]))},null,40,Q1))],34))}}),In=Ee(ek,[["__scopeId","data-v-7d9ad553"]]),tk=_e({__name:"slider-group",props:En({mode:{default:"hsla"},relative:{type:Boolean,default:!1}},{modelValue:{required:!0,validator:n=>!!n.match(/^#[0-9a-f]{6,8}$/i)},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=R(null),s=R(0),r=R(0),i=R(0),l=R(0),a=y({rgba:{label:"Red",stops(){const w=t.relative?r.value:0,h=t.relative?i.value:0;return[new Ne(0,w,h,1),new Ne(255,w,h,1)]}},hsla:{label:"Hue",max:360,stops(){const w=t.relative?r.value/100:1,h=t.relative?i.value/100:.5;return k(v=>new Ve(v,w,h,1))}}}),u=y({rgba:{label:"Green",stops(){const w=t.relative?s.value:0,h=t.relative?i.value:0;return[new Ne(w,0,h,1),new Ne(w,255,h,1)]}},hsla:{label:"Saturation",stops(){const w=t.relative?s.value/360:0,h=t.relative?i.value/100:.5;return k(v=>new Ve(w,v,h,1))}}}),c=y({rgba:{label:"Blue",stops(){const w=t.relative?s.value:0,h=t.relative?r.value:0;return[new Ne(w,h,0,1),new Ne(w,h,255,1)]}},hsla:{label:"Luminosity",stops(){const w=t.relative?s.value/360:0,h=t.relative?r.value/100:.5;return k(v=>new Ve(w,h,v,1))}}}),f=E(()=>{const w=Ne.fromHex(e.value);return[new Ne(w.r,w.g,w.b,0).toCss(),new Ne(w.r,w.g,w.b,1).toCss()]});function g(){e.value!==o.value&&_()}function m(){let w;t.mode==="rgba"?w=new Ne(s.value,r.value,i.value,l.value/255):w=new Ve(s.value/360,r.value/100,i.value/100,l.value/255);const h=w.toRgb().toHex();if(o.value!==h){if(h.length!==9)throw new Error(`Invalid color code: ${h}`);o.value=h,e.value=h}}function _(){const w=Ne.fromHex(e.value);if(o.value=w.toHex(),l.value=w.a*255,t.mode==="hsla"){const h=w.toHSL();s.value=h.h*360,r.value=h.s*100,i.value=h.l*100}else s.value=w.r,r.value=w.g,i.value=w.b}function k(w){const h=[];for(let v=0;v<=8;++v)h.push(w(v/8));return h}ze(()=>e.value,g),ze(()=>t.mode,_,{immediate:!0}),ze(()=>[s.value,r.value,i.value,l.value],m);function y({rgba:w,hsla:h}){const v=E(()=>t.mode==="rgba"?255:h.max??100),p=E(()=>t.mode==="rgba"?w.label:h.label),P=E(()=>(t.mode==="rgba"?w.stops():h.stops()).map(N=>N.toRgb().toCss()));return{maxValue:v,label:p,stops:P}}return(w,h)=>(j(),U("div",null,[q(In,{label:Q(a).label.value,modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=v=>s.value=v),"max-value":Q(a).maxValue.value,"gradient-stops":Q(a).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),q(In,{label:Q(u).label.value,modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=v=>r.value=v),"max-value":Q(u).maxValue.value,"gradient-stops":Q(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),q(In,{label:Q(c).label.value,modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=v=>i.value=v),"max-value":Q(c).maxValue.value,"gradient-stops":Q(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),q(In,{label:"Alpha",modelValue:l.value,"onUpdate:modelValue":h[3]||(h[3]=v=>l.value=v),"max-value":255,"gradient-stops":f.value},null,8,["modelValue","gradient-stops"])]))}}),nk=Ee(tk,[["__scopeId","data-v-0d496402"]]),ok={class:"v-w100 h-h100"},sk={class:"hex-selector"},rk=["for"],ik=["id","value"],lk=["title","onClick"],wd="dddg.generated.colors",ak=_e({inheritAttrs:!1,__name:"color-picker",props:En({title:{default:""},format:{default:"hex"}},{modelValue:{required:!0},modelModifiers:{}}),emits:En(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=n,o=hs(n,"modelValue"),s=t,r=Ua(),i=R("hsla"),l=Pn(),a=E({get(){return e.format==="rgb"?Ne.fromCss(o.value).toHex():o.value},set(k){if(e.format==="rgb"){const y=Ne.fromCss(k);o.value=y.toCss()}else o.value=k}});function u(k){const y=k.target.value;Ne.validHex(y)&&(y.length===7||y.length===9)&&(a.value=y)}const c=E(()=>V.content.current.colors);function f(){if(c.value.find(w=>w.color===a.value))return;const k=V.content.contentPacks.find(w=>w.packId===wd)||{packId:wd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},y={...k,colors:[...k.colors,{label:a.value,color:a.value}]};re(async()=>{await V.content.replaceContentPack({contentPack:y,processed:!0})})}const g=Ot();function m(){re(()=>{g.value.pickColor=!0})}function _(k){a.value=Ne.fromCss(k.color).toHex()}return Wt(()=>{je.subscribe(nr,_)}),Sn(()=>{je.unsubscribe(nr,_)}),(k,y)=>(j(),U("div",{class:He([{color:!0,vertical:Q(l)},"v-w100 h-h100"])},[d("h2",null,Pe(k.title),1),d("button",{onClick:y[0]||(y[0]=w=>s("leave"))},"OK"),d("table",null,[d("tbody",null,[d("tr",null,[d("td",null,[d("button",{onClick:y[1]||(y[1]=w=>i.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:y[2]||(y[2]=w=>i.value="rgba")},"RGBA")])])])]),d("div",ok,[q(nk,{mode:i.value,modelValue:a.value,"onUpdate:modelValue":y[3]||(y[3]=w=>a.value=w),relative:!0},null,8,["mode","modelValue"]),d("div",sk,[d("label",{class:"hex-label",for:`hex_${Q(r)}`},"Hex",8,rk),d("input",{id:`hex_${Q(r)}`,value:a.value,onInput:u,onKeydown:y[4]||(y[4]=pe(()=>{},["stop"]))},null,40,ik)]),q(At,{direction:"global",class:"color-tools"},{default:ne(()=>[d("button",{onClick:f},"Add as swatch"),q(Te,{class:"h-bl0 v-bt0",icon:"colorize",onClick:m},{default:ne(()=>y[5]||(y[5]=[te("Pick color")])),_:1})]),_:1})]),d("div",{id:"color-swatches",class:He({vertical:Q(l)})},[(j(!0),U(ue,null,qe(c.value,w=>(j(),U("button",{class:"swatch",key:w.color,style:tt({backgroundColor:w.color}),title:w.label,onClick:h=>{a.value=w.color,s("leave")}},null,12,lk))),128))],2)],2))}}),Dr=Ee(ak,[["__scopeId","data-v-808c5333"]]),uk={class:"fieldset_wrapper"},ck={key:0},dk={class:"fieldset_contents"},fk=_e({__name:"d-fieldset",props:{title:{}},setup(n){const t=n;return(e,o)=>(j(),U("div",uk,[d("fieldset",null,[e.title>""?(j(),U("legend",ck,Pe(t.title),1)):de("",!0),d("div",dk,[Xt(e.$slots,"default",{},void 0,!0)])])]))}}),Pt=Ee(fk,[["__scopeId","data-v-bca80d0b"]]),pk={class:"column ok-col"},hk={key:0,class:"column"},vk=["value"],gk=["disabled"],mk=["disabled"],bk=["disabled"],yk=["disabled"],wk=["onClick","onKeydown"],kk={key:0,class:"value-input-table"},Ck=["value","max","min"],_k={key:0},xk={colspan:"2"},Sk=["value","max","min"],Pk={key:0},Ok={colspan:"2"},Tk=_e({__name:"image-options",props:{type:{},id:{},panelId:{},noComposition:{type:Boolean}},emits:["leave"],setup(n,{emit:t}){const e=n,o=t,s=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),r=(()=>{try{const Y=Hn();Y.width=0,Y.height=0;const A="filter"in Y.getContext("2d");if(po(Y),A)return Array.from(s.keys()).sort()}catch{}return["opacity"]})(),i=R(null),l=R(0),a=E(()=>{switch(e.type){case"object":return V.panels.panels[e.panelId].objects[e.id];case"background":return V.panels.panels[e.panelId].background;case"panel":return V.panels.panels[e.panelId];default:throw new Kt.UnreachableCaseError(e.type)}}),u=E({get(){return a.value.composite},set(Y){re(()=>{a.value.composite=Y})}}),c=E(()=>a.value.filters),f=E(()=>c.value[l.value]??null),g=E(()=>{const Y=f.value;return Y==null?!1:ad.has(Y.type)}),m=E(()=>{const Y=f.value;if(Y!=null){if(Y.type==="hue-rotate")return 360;if(Y.type==="grayscale"||Y.type==="sepia"||Y.type==="opacity"||Y.type==="invert")return 100}}),_=E(()=>{const Y=f.value;if(Y!=null)switch(Y.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function k(Y){return s.get(Y)}function y(Y){return ad.has(Y.type)?`${s.get(Y.type)} ${(Y.value*100).toFixed()}%`:Y.type==="hue-rotate"?`${s.get(Y.type)} ${Y.value.toFixed()}`:Y.type==="blur"?`${s.get(Y.type)} ${Y.value.toFixed()}px`:s.get(Y.type)}function w(){re(()=>{const Y=i.value;Y!=null&&a.value.addFilter(Y,l.value+1)})}function h(Y){l.value=Y}function v(){re(()=>{a.value.removeFilter(l.value),l.value>=a.value.filters.length&&(l.value=a.value.filters.length-1)})}function p(Y){re(async()=>{a.value.moveFilter(l.value,Y),l.value+=Y})}function P(Y){let x=Number(Y.target.value);g.value&&(x=x/100),M(x)}function M(Y){const x=a.value.filters[l.value];re(()=>{x.value=Y})}const N=E(()=>b(x=>new Ve(x,1,.5,1)).map(x=>x.toRgb().toCss()));function b(Y){const x=[];for(let A=0;A<=8;++A)x.push(Y(A/8));return x}const O=R(!1),T=ee("color"),L=ee("offsetX"),B=ee("offsetY"),H=ee("blurRadius");function ee(Y){return E({get(){const x=f.value;if(x==null||!(Y in x))throw new Error("Tried reading shadow prop on a non shadow object");return x[Y]},set(x){re(()=>{const A=a.value.filters[l.value];A[Y]=x})}})}return(Y,x)=>O.value?(j(),ce(Dr,{key:0,modelValue:Q(T),"onUpdate:modelValue":x[0]||(x[0]=A=>ge(T)?T.value=A:null),format:"rgb",onLeave:x[1]||(x[1]=A=>O.value=!1)},null,8,["modelValue"])):(j(),ce(At,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:ne(()=>[x[35]||(x[35]=d("h2",null,"Image options",-1)),d("div",pk,[d("button",{onClick:x[2]||(x[2]=A=>o("leave"))},"Back")]),Y.noComposition?de("",!0):(j(),U("div",hk,[x[26]||(x[26]=d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),q(Qe,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:ne(()=>x[24]||(x[24]=[te("[?] ")])),_:1}),Se(d("select",{id:"compositionSelect","onUpdate:modelValue":x[3]||(x[3]=A=>u.value=A),onKeydown:x[4]||(x[4]=pe(()=>{},["stop"]))},x[25]||(x[25]=[d("option",{value:"source-over"},"Normal",-1),d("option",{value:"source-atop"},"source-atop",-1),d("option",{value:"destination-over"},"destination-over",-1),d("option",{value:"destination-in"},"destination-in",-1),d("option",{value:"destination-in"},"destination-out",-1),d("option",{value:"destination-in"},"destination-atop",-1),d("option",{value:"lighter"},"lighter",-1),d("option",{value:"xor"},"xor",-1),d("option",{value:"multiply"},"multiply",-1),d("option",{value:"screen"},"screen",-1),d("option",{value:"overlay"},"overlay",-1),d("option",{value:"darken"},"darken",-1),d("option",{value:"lighten"},"lighten",-1),d("option",{value:"color-dodge"},"color-dodge",-1),d("option",{value:"color-burn"},"color-burn",-1),d("option",{value:"hard-light"},"hard-light",-1),d("option",{value:"soft-light"},"soft-light",-1),d("option",{value:"difference"},"difference",-1),d("option",{value:"exclusion"},"exclusion",-1),d("option",{value:"hue"},"hue",-1),d("option",{value:"saturation"},"saturation",-1),d("option",{value:"color"},"color",-1),d("option",{value:"luminosity"},"luminosity",-1)]),544),[[St,u.value]])])),q(Pt,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:ne(()=>[q(At,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:ne(()=>[q(At,{direction:"vertical","no-wraping":""},{default:ne(()=>[x[27]||(x[27]=d("label",{for:"addEffect"},"Add new effect",-1)),Se(d("select",{id:"addEffect","onUpdate:modelValue":x[5]||(x[5]=A=>i.value=A),onKeydown:x[6]||(x[6]=pe(()=>{},["stop"]))},[(j(!0),U(ue,null,qe(Q(r),A=>(j(),U("option",{key:A,value:A},Pe(k(A)),9,vk))),128))],544),[[St,i.value]]),d("button",{disabled:i.value===null,onClick:w,onKeydown:x[7]||(x[7]=pe(()=>{},["stop"]))}," Add ",40,gk),d("button",{disabled:!f.value,onClick:v,onKeydown:x[8]||(x[8]=pe(()=>{},["stop"]))}," Remove ",40,mk),d("button",{disabled:l.value===0,onClick:x[9]||(x[9]=A=>p(-1)),onKeydown:x[10]||(x[10]=pe(()=>{},["stop"]))}," Move up ",40,bk),d("button",{disabled:l.value===c.value.length-1||c.value.length===0,onClick:x[11]||(x[11]=A=>p(1)),onKeydown:x[12]||(x[12]=pe(()=>{},["stop"]))}," Move down ",40,yk)]),_:1}),q(At,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:ne(()=>[(j(!0),U(ue,null,qe(c.value,(A,G)=>(j(),U("div",{key:G,class:He({choiceBtn:!0,active:G===l.value}),tabindex:"0",onClick:Ie=>h(G),onKeydown:[it(Ie=>h(G),["enter"]),it(pe(Ie=>h(G),["prevent"]),["space"])]},Pe(y(A)),43,wk))),128))]),_:1}),f.value?(j(),U("table",kk,[d("tbody",null,[f.value.type==="drop-shadow"?(j(),U(ue,{key:0},[d("tr",null,[x[28]||(x[28]=d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:tt({background:Q(T)}),onClick:x[13]||(x[13]=A=>O.value=!0)},"  ",4)])]),d("tr",null,[x[29]||(x[29]=d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),d("td",null,[Se(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":x[14]||(x[14]=A=>ge(L)?L.value=A:null),onKeydown:x[15]||(x[15]=pe(()=>{},["stop"]))},null,544),[[Je,Q(L),void 0,{number:!0}]])])]),d("tr",null,[x[30]||(x[30]=d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),d("td",null,[Se(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":x[16]||(x[16]=A=>ge(B)?B.value=A:null),onKeydown:x[17]||(x[17]=pe(()=>{},["stop"]))},null,544),[[Je,Q(B),void 0,{number:!0}]])])]),d("tr",null,[x[31]||(x[31]=d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),d("td",null,[Se(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":x[18]||(x[18]=A=>ge(H)?H.value=A:null),onKeydown:x[19]||(x[19]=pe(()=>{},["stop"]))},null,544),[[Je,Q(H),void 0,{number:!0}]])])])],64)):g.value?(j(),U(ue,{key:1},[d("tr",null,[x[33]||(x[33]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:(f.value.value*100).toFixed(),type:"number",max:m.value,min:_.value,onInput:P,onKeydown:x[20]||(x[20]=pe(()=>{},["stop"]))},null,40,Ck),x[32]||(x[32]=te("% "))])]),_.value===0&&m.value!==void 0?(j(),U("tr",_k,[d("td",xk,[q(In,{gradientStops:["#000000","#ffffff"],label:"",maxValue:m.value,modelValue:f.value.value*100,"no-input":"","onUpdate:modelValue":x[21]||(x[21]=A=>M(Math.round(A)/100))},null,8,["maxValue","modelValue"])])])):de("",!0)],64)):(j(),U(ue,{key:2},[d("tr",null,[x[34]||(x[34]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:f.value.value,type:"number",max:m.value,min:_.value,onInput:P,onKeydown:x[22]||(x[22]=pe(()=>{},["stop"]))},null,40,Sk)])]),_.value===0&&m.value!==void 0?(j(),U("tr",Pk,[d("td",Ok,[q(In,{gradientStops:N.value,label:"",maxValue:m.value,modelValue:f.value.value,"no-input":"","onUpdate:modelValue":x[23]||(x[23]=A=>M(Math.round(A)))},null,8,["gradientStops","maxValue","modelValue"]),q(In,{gradientStops:N.value,label:"",maxValue:m.value,modelValue:f.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):de("",!0)],64))])])):de("",!0)]),_:1})]),_:1})]),_:1}))}}),qa=Ee(Tk,[["__scopeId","data-v-05583125"]]),$k=["title"],jk=["title"],Rk=_e({__name:"bg-button",props:{backgroundId:{}},setup(n){const t=n,e=Ot(),o=E(()=>{const g=e.value.currentPanel;return V.panels.panels[g].background}),s=R(null),r=E(()=>{Object.keys(V.uploadUrls);const g=i.value;if(!g)return null;for(const m of g.variants)for(const _ of m){const k=kn(_,!1);if(k.startsWith("uploads:"))return Object.keys(V.uploadUrls),k.substring(8)}return null}),i=E(()=>V.content.backgrounds.get(t.backgroundId)||null),l=E(()=>t.backgroundId===o.value.current),a=E(()=>{switch(t.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return i.value.label??""}),u=E(()=>{var _;switch(t.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let g=!1;const m=(_=i.value)==null?void 0:_.variants[0].map(k=>{const y=kn(k,!1);return y.startsWith("uploads:")&&(g=!0),`url('${y}')`}).join(",");return g&&Object.keys(V.uploadUrls),{backgroundImage:m??""}});function c(){s.value.click()}async function f(){const g=s.value,m=r.value;if(!g.files)return;if(g.files.length!==1){console.error("More than one file uploaded!");return}const _=g.files[0];await re(async()=>{const k=URL.createObjectURL(_);V.uploadUrls.add(m,k)})}return(g,m)=>r.value!==null?(j(),U("div",{key:0,class:He({background:!0,active:l.value}),title:a.value,style:tt(u.value),tabindex:"0",onClick:m[0]||(m[0]=_=>c()),onKeypress:[m[1]||(m[1]=it(pe(_=>c(),["prevent","stop"]),["enter"])),m[2]||(m[2]=it(pe(_=>c(),["prevent","stop"]),["space"]))]},[te(Pe(a.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,$k)):(j(),U("div",{key:1,class:He({background:!0,active:l.value}),title:a.value,style:tt(u.value),tabindex:"0",onClick:m[3]||(m[3]=_=>g.$emit("input",g.backgroundId)),onKeydown:[m[4]||(m[4]=it(_=>g.$emit("input",g.backgroundId),["enter"])),m[5]||(m[5]=it(pe(_=>g.$emit("input",g.backgroundId),["prevent"]),["space"]))]},Pe(a.value),47,jk))}}),Ak=Ee(Rk,[["__scopeId","data-v-7d07eaaf"]]),Ik={key:1},Mk={colspan:"3"},Dk={key:0},Bk={class:"arrow-col"},Ek={class:"arrow-col"},Lk={colspan:"3"},Nk={colspan:"3"},Hk=_e({__name:"bg-settings",emits:["open-image-options","change-color"],setup(n,{emit:t}){const e=t,o=Ot(),s=Pn(),r=E(()=>{const k=o.value.currentPanel;return V.panels.panels[k].background}),i=E({get(){return r.value.flipped},set(k){re(()=>{V.panels.panels[o.value.currentPanel].background.flipped=k})}}),l=E({get(){return r.value.scaling.toString()},set(k){re(()=>{V.panels.panels[o.value.currentPanel].background.scaling=parseInt(k,10)})}}),a=E(()=>r.value.current),u=E(()=>V.content.current.backgrounds.find(k=>k.id===a.value)||null),c=E(()=>a.value==="buildin.static-color"),f=E({get(){return r.value.color},set(k){re(()=>{V.panels.panels[o.value.currentPanel].background.color=k})}}),g=E(()=>!!u.value),m=E(()=>u.value?u.value.variants.length>1:!1);function _(k){re(async()=>{V.panels.panels[o.value.currentPanel].background.seekBackgroundVariant(k)})}return(k,y)=>(j(),ce(Pt,{class:He({"bg-settings":!0,vertical:Q(s)}),title:"Settings:"},{default:ne(()=>[c.value?(j(),U(ue,{key:0},[y[7]||(y[7]=d("label",{for:"bg_color"},"Color:",-1)),d("button",{id:"bg_color",class:"color-button",style:tt({background:f.value}),onClick:y[0]||(y[0]=w=>e("change-color"))},null,4)],64)):de("",!0),g.value?(j(),U("table",Ik,[d("tbody",null,[d("tr",null,[d("td",Mk,[q(Ke,{modelValue:i.value,"onUpdate:modelValue":y[1]||(y[1]=w=>i.value=w),label:"Flipped?"},null,8,["modelValue"])])]),m.value?(j(),U("tr",Dk,[d("td",Bk,[d("button",{class:"small-button",onClick:y[2]||(y[2]=w=>_(-1))}," < ")]),y[8]||(y[8]=d("td",{style:{"text-align":"center"}},"Variant",-1)),d("td",Ek,[d("button",{class:"small-button",onClick:y[3]||(y[3]=w=>_(1))}," > ")])])):de("",!0),d("tr",null,[d("td",Lk,[Se(d("select",{"onUpdate:modelValue":y[4]||(y[4]=w=>l.value=w),onKeydown:y[5]||(y[5]=pe(()=>{},["stop"]))},y[9]||(y[9]=[d("option",{value:"0"},"None",-1),d("option",{value:"1"},"Stretch",-1),d("option",{value:"2"},"Cover",-1)]),544),[[St,l.value]])])]),d("tr",null,[d("td",Nk,[d("button",{id:"image_options_button",class:"v-w100",onClick:y[6]||(y[6]=w=>e("open-image-options"))}," Image options ")])])])])):de("",!0)]),_:1},8,["class"]))}}),Wk=Ee(Hk,[["__scopeId","data-v-eacb0b71"]]),Vk=_e({__name:"backgrounds-tool",setup(n){const t={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},e=R(null);Dt(e);const o=Ot(),s=R(!1),r=R(!1),i=E({get(){return V.panels.panels[o.value.currentPanel].background.color},set(h){re(()=>{V.panels.panels[o.value.currentPanel].background.color=h})}}),l=E(()=>[...V.content.current.backgrounds.map(h=>h.id),"buildin.static-color","buildin.transparent"]),a=E(()=>he.supports.openableFolders.has("backgrounds"));function u(h){re(()=>{V.panels.panels[o.value.currentPanel].background.current=h})}function c(){he.openFolder("backgrounds")}const f=R(null);function g(){const h=f.value;if(h.files)for(const v of h.files)m(v)}async function m(h){await re(async()=>{const v=URL.createObjectURL(h),p=await V.uploadUrls.add(h.name,v);await k(h.name,h.name,p)})}function _(){const h=prompt("Enter the URL of the image");if(h==null)return;const v=h.split("/").slice(-1)[0];k(v,v,h)}async function k(h,v,p){const P=V.content.contentPacks.find(N=>N.packId===t.packId)||t,M={...P,backgrounds:[...P.backgrounds,{id:h,label:v,variants:[[{hq:p,lq:p,sourcePack:t.packId}]],scaling:"none"}]};await re(async()=>{await V.content.replaceContentPack({contentPack:M,processed:!0}),u(h)})}const y=R(null);function w(h){h.dataTransfer&&(h.dataTransfer.effectAllowed="none",Array.from(h.dataTransfer.items).find(v=>v.type.match(/^image.*$/))&&(h.dataTransfer.effectAllowed="link",y.value.show()))}return(h,v)=>(j(),U("div",{class:"panel",ref_key:"root",ref:e,onDragenter:w,onMouseleave:v[7]||(v[7]=p=>y.value.hide())},[q(eh,{ref_key:"dt",ref:y,class:"drop-target",onDrop:m},{default:ne(()=>v[8]||(v[8]=[te("Drop here to add as a new background ")])),_:1},512),v[13]||(v[13]=d("h1",null,"Background",-1)),s.value?(j(),ce(Dr,{key:0,modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=p=>i.value=p),onLeave:v[1]||(v[1]=p=>s.value=!1)},null,8,["modelValue"])):r.value?(j(),ce(qa,{key:1,type:"background",title:"","panel-id":Q(o).currentPanel,"no-composition":"",onLeave:v[2]||(v[2]=p=>r.value=!1)},null,8,["panel-id"])):(j(),U(ue,{key:2},[q(Wk,{onChangeColor:v[3]||(v[3]=p=>s.value=!0),onOpenImageOptions:v[4]||(v[4]=p=>r.value=!0)}),q(Te,{icon:"upload",class:"upload-background",onClick:v[5]||(v[5]=p=>f.value.click())},{default:ne(()=>[v[9]||(v[9]=te(" Upload ")),d("input",{type:"file",ref_key:"upload",ref:f,onChange:g,multiple:""},null,544)]),_:1}),q(Te,{icon:"link",class:"upload-background",onClick:_},{default:ne(()=>v[10]||(v[10]=[te(" Add by URL ")])),_:1}),q(Te,{icon:"extension",class:"upload-background",onClick:v[6]||(v[6]=p=>h.$emit("show-dialog","type: Backgrounds"))},{default:ne(()=>v[11]||(v[11]=[te(" Search in content packs ")])),_:1}),a.value?(j(),ce(Te,{key:0,icon:"folder",class:"upload-background",onClick:c},{default:ne(()=>v[12]||(v[12]=[te(" Open backgrounds folder ")])),_:1})):de("",!0),(j(!0),U(ue,null,qe(l.value,p=>(j(),ce(Ak,{key:p,backgroundId:p,onInput:P=>u(p)},null,8,["backgroundId","onInput"]))),128))],64))],544))}}),Fk=Ee(Vk,[["__scopeId","data-v-68dabeb4"]]);function Re(n,t){return E({get(){return n.value[t]},set(e){re(()=>{n.value[t]=e})}})}function es(n,t){return(...e)=>{re(()=>{n.value[t](...e)})}}const Uk=["onKeydown"],kd=960,qk=_e({__name:"part-button",props:{part:{},size:{default:150}},emits:["click","quick-click"],setup(n,{emit:t}){const e=n,o=t,s=R([]),r=E(()=>e.size/e.part.size[0]),i=E(()=>e.size/e.part.size[1]),l=E(()=>`${Math.floor(kd*r.value)}px ${Math.floor(kd*i.value)}px`),a=E(()=>{let g="";const m=l.value,_=e.part.offset??[0,0],k=e.part.images.length-1;for(let y=0;y<=k;++y){const w=e.part.images[k-y],h=s.value[k-y];if(!h)continue;y>0&&(g+=", ");const v=w.offset??[0,0],p=`${Math.floor((_[0]-v[0])*-r.value)}px ${Math.floor((_[1]-v[1])*-i.value)}px`;g+=`url('${h.replace("'","\\'")}') ${p} / ${m}`}return g}),u=E(()=>({height:e.size+"px",width:e.size+"px",background:a.value}));function c(g){g.preventDefault(),o("quick-click")}async function f(){s.value=await Promise.all(e.part.images.map(g=>typeof g.asset=="string"?Hw(g.asset,!1):kn(g.asset,!1)))}return go("Initialization of parts button",f),(g,m)=>{var _;return j(),U("div",{class:He({part:!0,active:(_=g.part)==null?void 0:_.active}),style:tt(u.value),tabindex:"0",onClick:m[0]||(m[0]=k=>o("click")),onContextmenu:c,onKeydown:[m[1]||(m[1]=it(pe(k=>o("click"),["prevent"]),["enter"])),it(pe(c,["prevent"]),["space"])]},null,46,Uk)}}}),Cd=Ee(qk,[["__scopeId","data-v-a09133e4"]]),zk=_e({__name:"part-selection",props:{character:{},part:{}},emits:["leave","show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=n,o=t,s=R(null),r=R([]),i=E(()=>{switch(e.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),l=E(()=>e.character.charData),a=E(()=>{if(e.part!=="style")return[];const w=l.value.styleGroups[e.character.styleGroupId];return w.styleComponents.map(h=>{const v={};for(const p in h.variants){if(!h.variants.hasOwnProperty(p))continue;const P=h.variants[p];v[p]={size:w.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:P}],active:!1}}return{label:h.label,name:h.id,buttons:v}})}),u=E(()=>{const w={};let h,v,p;const P=l.value,M=e.character.poseData;switch(e.part){case"head":{const b=e.character.posePositions.headType||0,O=e.character.posePositions.head||0;for(let T=0;T<M.compatibleHeads.length;++T){const L=M.compatibleHeads[T],B=P.heads[L];for(let H=0;H<B.variants.length;++H){const ee=B.variants[H];w[`${T}_${H}`]={size:B.previewSize,offset:B.previewOffset,images:ee.map(Y=>({asset:Y,offset:[0,0]})),active:O===H&&b===T}}}return w}case"pose":const N=P.styleGroups[e.character.styleGroupId].styles[e.character.styleId];for(let b=0;b<N.poses.length;++b){const O=N.poses[b],T=f(O);w[b]=T,T.active=b===e.character.poseId}return w;case"style":for(let b=0;b<P.styleGroups.length;++b){const O=P.styleGroups[b],T=f(O.styles[0].poses[0]);w[O.id]=T,T.active=b===e.character.styleGroupId}return w;default:h=M.positions[e.part],p=M.previewSize,v=M.previewOffset;break}for(let N=0;N<h.length;++N){const b=h[N];w[N]={images:b.map(O=>({offset:[0,0],asset:O})),size:p,offset:v,active:N===(e.character.posePositions[e.part]||0)}}return w});function c(){const w=l.value.styleGroups[e.character.styleGroupId].styles[e.character.styleId];r.value=Object.keys(w.components).map(h=>[h,w.components[h]])}function f(w){const h=l.value;let v=[];for(const p of w.renderCommands)switch(p.type){case"pose-part":const P=w.positions[p.part];if(P==null||P.length===0)break;v=v.concat(P[0].map(M=>({asset:M,offset:p.offset})));break;case"head":{const M=h.heads[w.compatibleHeads[0]];if(w.compatibleHeads.length===0)break;const N=M.variants[0];v=v.concat(N.map(b=>({asset:b,offset:p.offset})));break}case"image":v=v.concat(p.images.map(M=>({asset:M,offset:p.offset})));break}return{images:v,size:w.previewSize,offset:w.previewOffset,active:!1}}function g(w){w==null&&(w=e.character.styleGroupId);const v=l.value.styleGroups[w];let p=v.styles;for(const P of r.value){const M=p.filter(N=>N.components[P[0]]===P[1]);M.length>0&&(p=M)}re(async()=>{e.character.setCharStyle(w,v.styles.indexOf(p[0]))})}function m(w){if(e.part==="style")g(l.value.styleGroups.findIndex(h=>h.id===w));else if(e.part==="head"){const[h,v]=(""+w).split("_",2).map(p=>parseInt(p,10));re(()=>{e.character.setPosePosition({headType:h,head:v})})}else y(e.part,parseInt(""+w,10))}function _(w,h){const v=r.value.findIndex(p=>p[0]===w);r.value.splice(v,1),r.value.unshift([w,""+h]),g()}function k(w){(w.key==="Backspace"||w.key==="Escape")&&(o("leave"),w.preventDefault(),w.stopPropagation())}function y(w,h){re(async()=>{e.character.setPart(w,h)})}return go("Initializing parts data",async()=>{s.value=await ho()}),ze(()=>e.character,c,{immediate:!0}),(w,h)=>(j(),ce(At,{"no-wraping":"",onKeydown:k},{default:ne(()=>[d("button",{onClick:h[0]||(h[0]=v=>o("leave")),class:"h-h100"},"Back"),q(At,{direction:"vertical",class:"parts-fnc-btns"},{default:ne(()=>[q(Te,{icon:"extension",class:"h-bl0 v-w100 v-bt0",onClick:h[1]||(h[1]=v=>o("show-dialog",`type: ${i.value} character: ${l.value.label}`))},{default:ne(()=>h[3]||(h[3]=[te(" Search in content packs ")])),_:1}),w.part==="head"?(j(),ce(Te,{key:0,icon:"extension",class:"h-bl0 h-bt0 v-w100 v-bt0",onClick:h[2]||(h[2]=v=>o("show-expression-dialog",{character:w.character.characterType}))},{default:ne(()=>h[4]||(h[4]=[te(" Create new expressions ")])),_:1})):de("",!0)]),_:1}),(j(!0),U(ue,null,qe(u.value,(v,p)=>(j(),ce(Cd,{key:p,value:p,part:v,onClick:P=>{m(p),o("leave")},onQuickClick:P=>m(p)},null,8,["value","part","onClick","onQuickClick"]))),128)),(j(!0),U(ue,null,qe(a.value,v=>(j(),ce(Pt,{key:v.name,title:v.label,class:"h-h100"},{default:ne(()=>[q(At,{noWraping:""},{default:ne(()=>[(j(!0),U(ue,null,qe(v.buttons,(p,P)=>(j(),ce(Cd,{size:130,key:P,value:P,part:p,onClick:M=>_(v.name,P)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}}),Xk=Ee(zk,[["__scopeId","data-v-21ad448a"]]),Yk=_e({__name:"delete-btn",props:{obj:{}},setup(n){const t=n;function e(){re(async()=>{V.panels.panels[t.obj.panelId].removeObject(t.obj)})}return(o,s)=>(j(),U("button",{onClick:e},"Delete"))}}),Gk=_e({__name:"layer-btns",props:{object:{}},setup(n){const t=n,e=E(()=>t.object),o=E(()=>V.panels.panels[t.object.panelId]),s=Re(e,"onTop");function r(i){re(async()=>{o.value.shiftLayer(t.object,i)})}return(i,l)=>(j(),ce(Pt,{id:"layerfs",title:"Layer:"},{default:ne(()=>[q(At,{class:"layer_flow",direction:"horizontal"},{default:ne(()=>[q(Te,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>r(-1/0)),title:"Move to back"}),q(Te,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>r(-1)),title:"Move backwards"}),q(Te,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>r(1)),title:"Move forwards"}),q(Te,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>r(1/0)),title:"Move to front"})]),_:1}),q(Ke,{modelValue:Q(s),"onUpdate:modelValue":l[4]||(l[4]=a=>ge(s)?s.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}}),Kk=Ee(Gk,[["__scopeId","data-v-2b245c52"]]),Jk={class:"v-w100"},Zk={colspan:"2"},Qk={key:0},eC={colspan:"2"},tC={class:"v-w100 button-tbl"},nC={class:"arrow-col"},oC=["disabled"],sC=["value"],rC={class:"arrow-col"},iC=["disabled"],lC={class:"v-w50"},aC={class:"v-w50"},uC={class:"v-w50"},cC={class:"v-w50"},dC=_e({__name:"position-and-size",props:{obj:{}},setup(n){const t=n,e=E(()=>t.obj),o=E({get(){const k=fe().TextBox;return t.obj.height-(i.value?k.NameboxHeight:0)},set(k){const y=fe().TextBox;re(()=>{t.obj.height=k+(i.value?y.NameboxHeight:0)})}}),s=Re(e,"width"),r=E(()=>{const k=t.obj;if(k.type==="textBox")return Ko[k.style].resizable;const y=fe().Poem;return k.type==="poem"?y.poemBackgrounds[k.background].file.startsWith("internal:"):!1}),i=E(()=>t.obj.type==="textBox"&&location.search.includes("alex")),l=E(()=>"freeMove"in t.obj&&t.obj.linkedTo==null),a=E(()=>fe().Base.positions),u=E(()=>f.value===0),c=E(()=>f.value===fe().Base.positions.length-1),f=E({get(){return Ms(t.obj.x)},set(k){re(async()=>{t.obj.x=fe().Base.characterPositions[k]})}}),g=E({get(){return!!t.obj.freeMove},set(k){re(()=>{t.obj.freeMove=k})}}),m=Re(e,"x"),_=Re(e,"y");return(k,y)=>(j(),ce(Pt,{title:"Position"+(r.value?"/Size":"")},{default:ne(()=>[d("table",Jk,[d("tbody",null,[d("tr",null,[d("td",Zk,[l.value?(j(),ce(Ke,{key:0,modelValue:g.value,"onUpdate:modelValue":y[0]||(y[0]=w=>g.value=w),label:"Move freely?"},null,8,["modelValue"])):de("",!0)])]),l.value&&!g.value?(j(),U("tr",Qk,[d("td",eC,[d("table",tC,[d("tbody",null,[d("tr",null,[d("td",nC,[d("button",{onClick:y[1]||(y[1]=w=>--f.value),disabled:u.value}," < ",8,oC)]),d("td",null,[Se(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":y[2]||(y[2]=w=>f.value=w)},[(j(!0),U(ue,null,qe(a.value,(w,h)=>(j(),U("option",{key:h,value:h},Pe(w),9,sC))),128))],512),[[St,f.value,void 0,{number:!0}]])]),d("td",rC,[d("button",{onClick:y[3]||(y[3]=w=>++f.value),disabled:c.value}," > ",8,iC)])])])])])])):(j(),U(ue,{key:1},[d("tr",null,[y[12]||(y[12]=d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),d("td",lC,[Se(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":y[4]||(y[4]=w=>ge(m)?m.value=w:null),onKeydown:y[5]||(y[5]=pe(()=>{},["stop"]))},null,544),[[Je,Q(m),void 0,{number:!0}]])])]),d("tr",null,[y[13]||(y[13]=d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),d("td",aC,[Se(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":y[6]||(y[6]=w=>ge(_)?_.value=w:null),onKeydown:y[7]||(y[7]=pe(()=>{},["stop"]))},null,544),[[Je,Q(_),void 0,{number:!0}]])])])],64)),r.value?(j(),U(ue,{key:2},[d("tr",null,[y[14]||(y[14]=d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),d("td",uC,[Se(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":y[8]||(y[8]=w=>ge(s)?s.value=w:null),onKeydown:y[9]||(y[9]=pe(()=>{},["stop"]))},null,544),[[Je,Q(s),void 0,{number:!0}]])])]),d("tr",null,[y[15]||(y[15]=d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),d("td",cC,[Se(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":y[10]||(y[10]=w=>o.value=w),onKeydown:y[11]||(y[11]=pe(()=>{},["stop"]))},null,544),[[Je,o.value,void 0,{number:!0}]])])])],64)):de("",!0)])])]),_:1},8,["title"]))}}),fC=Ee(dC,[["__scopeId","data-v-3be3f0bb"]]),pC={class:"column ok-col"},hC={class:"column"},vC=["value"],gC={key:0,class:"column error-col"},mC={class:"column"},bC={class:"column"},yC={class:"column"},wC={class:"column"},kC=_e({inheritAttrs:!1,__name:"text-formatting",props:En({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:En(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=hs(n,"modelValue"),o=t,s=R(null),r=R(""),i=R(""),l=R("#000000"),a=R(""),u=R(0),c=R(0),f=R(""),g=Pn();ze(()=>g.value,()=>{const h=s.value;h!=null&&(h.style.height="",h.style.width="")}),ze(()=>i.value,()=>{i.value!==""&&(w("font",i.value),i.value="")}),ze(()=>a.value,()=>{if(a.value==="")return;const h=s.value,v=h==null?void 0:h.selectionStart,p=h==null?void 0:h.selectionEnd;h&&(h.selectionEnd=h.selectionStart);const P=`{align=${a.value}}`;y(P),h&&(h.selectionStart=v+P.length,h.selectionEnd=p+P.length),a.value=""});function m(){const h=fe(),v=s.value.value;try{new Mt(v,h.TextBox.NameboxTextStyle),f.value=""}catch(p){f.value=p.message}e.value=v}function _(h){const v=s.value;r.value=h,u.value=v.selectionStart,c.value=v.selectionEnd}function k(){const h=l.value,v=r.value,p=()=>{const P=s.value;if(P==null){yn(p);return}P.selectionStart=u.value,P.selectionEnd=c.value,w(v==="text"?"color":"outlinecolor",h)};yn(p),l.value="#000000",r.value=""}function y(h){const v=s.value,p=v.value,P=v.selectionStart,M=v.selectionEnd;v.value=p.slice(0,P)+h+p.slice(M),v.selectionStart=v.selectionEnd=P+h.length,v.focus(),m()}function w(h,v){const p=s.value,P=p.value,M=p.selectionStart,N=p.selectionEnd,b=P.slice(M,N),O=P.slice(0,M),T=P.slice(N);let L=h;v!=null&&(L+="="+v),p.value=`${O}{${L}}${b}{/${h}}${T}`,p.selectionStart=M+L.length+2,p.selectionEnd=p.selectionStart+b.length,p.focus(),m()}return(h,v)=>r.value?(j(),ce(Dr,{key:0,modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=p=>l.value=p),onLeave:k},null,8,["modelValue"])):(j(),U("div",{key:1,class:He({"text-subpanel":!0,vertical:Q(g)})},[d("h2",null,Pe(h.title),1),d("div",pC,[d("button",{onClick:v[1]||(v[1]=p=>o("leave"))},"OK")]),d("div",hC,[d("textarea",{class:"v-w100",ref_key:"textArea",ref:s,value:e.value,onInput:m,onKeydown:v[2]||(v[2]=pe(()=>{},["stop"])),onKeypress:v[3]||(v[3]=pe(()=>{},["stop"]))},null,40,vC)]),f.value?(j(),U("div",gC,Pe(f.value),1)):de("",!0),d("div",mC,[d("button",{onClick:v[4]||(v[4]=p=>y("\\\\")),class:"style-button"}," Insert \\ "),d("button",{onClick:v[5]||(v[5]=p=>y("\\{")),class:"style-button"}," Insert { "),d("button",{onClick:v[6]||(v[6]=p=>y("\\}")),class:"style-button"}," Insert } ")]),v[20]||(v[20]=d("p",{class:"hint-col"},"Apply style to selected text:",-1)),d("div",bC,[d("button",{onClick:v[7]||(v[7]=p=>w("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:v[8]||(v[8]=p=>w("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:v[9]||(v[9]=p=>w("plain")),class:"style-button"}," Plain "),d("button",{onClick:v[10]||(v[10]=p=>w("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:v[11]||(v[11]=p=>w("k",2)),class:"style-button",style:{"letter-spacing":"5px","padding-right":"0"}}," Kerning ")]),d("div",yC,[d("button",{onClick:v[12]||(v[12]=p=>w("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",wC,[d("button",{onClick:v[13]||(v[13]=p=>w("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Se(d("select",{"onUpdate:modelValue":v[14]||(v[14]=p=>i.value=p),class:"style-button"},v[18]||(v[18]=[qv('<option value data-v-e10386b2>Font</option><option value="aller" style="font-family:aller;" data-v-e10386b2> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-e10386b2> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-e10386b2> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-e10386b2> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-e10386b2> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-e10386b2> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-e10386b2> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-e10386b2> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-e10386b2> Halogen (MC) </option>',10)]),512),[[St,i.value]]),Se(d("select",{"onUpdate:modelValue":v[15]||(v[15]=p=>a.value=p),class:"style-button"},v[19]||(v[19]=[d("option",{value:""},"Alignment",-1),d("option",{value:"left",style:{"text-align":"left"}},"Left",-1),d("option",{value:"right",style:{"text-align":"right"}},"Right",-1),d("option",{value:"center",style:{"text-align":"center"}}," Center ",-1)]),512),[[St,a.value]]),d("button",{onClick:v[16]||(v[16]=p=>_("text")),class:"style-button"}," Text color "),d("button",{onClick:v[17]||(v[17]=p=>_("outline")),class:"style-button"}," Outline color ")])],2))}}),CC=Ee(kC,[["__scopeId","data-v-e10386b2"]]),_C={class:"modal-text"},xC=["value"],SC={class:"input-table v-w100"},PC={for:"zoom",class:"v-w100"},OC={key:0},TC={key:0,colspan:"2"},$C={key:0},jC=["placeholder"],RC=_e({__name:"object-tool",props:{object:{},title:{},textHandler:{},colorHandler:{},showAltPanel:{type:Boolean,default:!1}},setup(n){const t=n,e=R(null);Dt(e);const o=E(()=>t.object),s=Re(o,"linkedTo"),r=R(!1),i=R(""),l=R(!1),a=R(null),u=Re(o,"flip"),c=Re(o,"rotation"),f=Re(o,"enlargeWhenTalking"),g=E(()=>Fp(t.object)),m=E(()=>V.panels.panels[t.object.panelId]),_=E(()=>{const Y=m.value,x=[];for(const A of[...Y.lowerOrder,...Y.topOrder]){const G=Y.objects[A];G.label===null||G===t.object||x.push([A,G.label])}return x}),k=location.search.includes("alex"),y=Re(o,"preserveRatio"),w=E({get(){return t.object.nameboxWidth},set(Y){re(()=>{o.value.nameboxWidth=Y===""?null:Y})}}),h=E({get(){return t.object.scaleX*100},set(Y){re(()=>{o.value.scaleX=Y/100})}}),v=E({get(){return t.object.scaleY*100},set(Y){re(()=>{o.value.scaleY=Y/100})}}),p=Re(o,"skewX"),P=Re(o,"skewY"),M=E(()=>fe().TextBox.NameboxWidth),N=E(()=>a.value||t.colorHandler||null),b=E(()=>t.object.label!==null),O=E(()=>t.object.label??t.title??"Object"),T=E({get(){return t.object.textboxColor!==null},set(Y){re(()=>{o.value.textboxColor=Y?fe().TextBoxCustom.textboxDefaultColor:null})}});function L(){re(async()=>{V.ui.copyObjectToClipboard(t.object.panelId,[t.object.id])})}function B(){i.value=t.object.label??"",l.value=!0}function H(Y){l.value=!1,Y==="Apply"&&re(()=>{o.value.label=i.value})}function ee(){a.value={title:"Textbox color",get:()=>t.object.textboxColor,set:Y=>{re(()=>{o.value.textboxColor=Y})},leave:()=>{a.value=null}}}return(Y,x)=>(j(),U("div",{class:"panel",ref_key:"root",ref:e},[d("h1",{style:tt({fontStyle:b.value?"italic":"normal"}),onClick:B},[te(Pe(O.value)+" ",1),x[26]||(x[26]=d("span",{class:"icon material-icons"},"edit",-1))],4),(j(),ce(oa,{to:"#modal-messages"},[l.value?(j(),ce(Bn,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:H,onLeave:x[2]||(x[2]=A=>H("Cancel"))},{default:ne(()=>[x[27]||(x[27]=d("p",{class:"modal-text"},"Enter the new name",-1)),d("p",_C,[Se(d("input",{"onUpdate:modelValue":x[0]||(x[0]=A=>i.value=A),style:{width:"100%"},onKeydown:x[1]||(x[1]=it(pe(A=>H("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Je,i.value]])])]),_:1})):de("",!0)])),Y.textHandler?(j(),ce(CC,{key:0,title:Y.textHandler.title,modelValue:Y.textHandler.get(),"onUpdate:modelValue":x[3]||(x[3]=A=>Y.textHandler.set(A)),onLeave:x[4]||(x[4]=A=>Y.textHandler.leave())},null,8,["title","modelValue"])):N.value?(j(),ce(Dr,{key:1,title:N.value.title,modelValue:N.value.get(),"onUpdate:modelValue":x[5]||(x[5]=A=>N.value.set(A)),onLeave:x[6]||(x[6]=A=>N.value.leave())},null,8,["title","modelValue"])):r.value?(j(),ce(qa,{key:2,type:"object","panel-id":o.value.panelId,id:o.value.id,onLeave:x[7]||(x[7]=A=>r.value=!1)},null,8,["panel-id","id"])):Y.showAltPanel?Xt(Y.$slots,"alt-panel",{key:3},void 0,!0):(j(),U(ue,{key:4},[Xt(Y.$slots,"default",{},void 0,!0),q(fC,{obj:o.value},null,8,["obj"]),q(Kk,{object:o.value},null,8,["object"]),q(Pt,{title:"Transform",class:"transforms"},{default:ne(()=>[q(Ke,{modelValue:Q(u),"onUpdate:modelValue":x[8]||(x[8]=A=>ge(u)?u.value=A:null),label:"Flip?"},null,8,["modelValue"]),x[33]||(x[33]=d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),Se(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":x[9]||(x[9]=A=>ge(s)?s.value=A:null),onKeydown:x[10]||(x[10]=pe(()=>{},["stop"]))},[x[28]||(x[28]=d("option",{value:""},"None",-1)),(j(!0),U(ue,null,qe(_.value,([A,G])=>(j(),U("option",{key:A,value:A},Pe(G),9,xC))),128))],544),[[St,Q(s)]]),d("table",SC,[d("tbody",null,[d("tr",null,[x[29]||(x[29]=d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation:")],-1)),d("td",null,[Se(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":x[11]||(x[11]=A=>ge(c)?c.value=A:null),onKeydown:x[12]||(x[12]=pe(()=>{},["stop"]))},null,544),[[Je,Q(c)]])])]),g.value?(j(),U(ue,{key:0},[d("tr",null,[d("td",null,[d("label",PC,Pe(Q(k)?"Zoom":"Scale X"),1)]),d("td",null,[Se(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":x[13]||(x[13]=A=>h.value=A),onKeydown:x[14]||(x[14]=pe(()=>{},["stop"]))},null,544),[[Je,h.value]])])]),Q(k)?de("",!0):(j(),U("tr",OC,[x[30]||(x[30]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),d("td",null,[Se(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":x[15]||(x[15]=A=>v.value=A),onKeydown:x[16]||(x[16]=pe(()=>{},["stop"]))},null,544),[[Je,v.value]])])]))],64)):de("",!0),d("tr",null,[x[31]||(x[31]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),d("td",null,[Se(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":x[17]||(x[17]=A=>ge(p)?p.value=A:null),onKeydown:x[18]||(x[18]=pe(()=>{},["stop"]))},null,544),[[Je,Q(p)]])])]),d("tr",null,[x[32]||(x[32]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),d("td",null,[Se(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":x[19]||(x[19]=A=>ge(P)?P.value=A:null),onKeydown:x[20]||(x[20]=pe(()=>{},["stop"]))},null,544),[[Je,Q(P)]])])]),d("tr",null,[Q(k)?de("",!0):(j(),U("td",TC,[q(Ke,{modelValue:Q(y),"onUpdate:modelValue":x[21]||(x[21]=A=>ge(y)?y.value=A:null),label:"Lock scale ratio?"},null,8,["modelValue"])]))])])]),Xt(Y.$slots,"transform",{},void 0,!0)]),_:3}),Xt(Y.$slots,"options",{},void 0,!0),b.value?(j(),ce(Pt,{key:0,title:"Textbox settings"},{default:ne(()=>[o.value.type==="character"||o.value.type==="sprite"?(j(),ce(Ke,{key:0,label:"Enlarge when talking",modelValue:Q(f),"onUpdate:modelValue":x[22]||(x[22]=A=>ge(f)?f.value=A:null)},null,8,["modelValue"])):de("",!0),q(Ke,{label:"Own textbox color",modelValue:T.value,"onUpdate:modelValue":x[23]||(x[23]=A=>T.value=A)},null,8,["modelValue"]),d("table",null,[d("tbody",null,[T.value?(j(),U("tr",$C,[x[34]||(x[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:tt({background:o.value.textboxColor??""}),onClick:ee},null,4)])])):de("",!0),d("tr",null,[x[35]||(x[35]=d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),d("td",null,[Se(d("input",{id:"namebox_width",type:"number",placeholder:M.value+"","onUpdate:modelValue":x[24]||(x[24]=A=>w.value=A)},null,8,jC),[[Je,w.value]])])])])])]),_:1})):de("",!0),d("button",{onClick:x[25]||(x[25]=A=>r.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:L},"Copy"),q(Yk,{class:"v-bt0",obj:o.value},null,8,["obj"])],64))],512))}}),_o=Ee(RC,[["__scopeId","data-v-a1b871fb"]]),AC={class:"warning"},IC={style:{"word-wrap":"break-word"}},MC={class:"button-tbl"},DC={key:0},BC={class:"arrow-col"},EC={class:"arrow-col"},LC={key:1},NC={class:"arrow-col"},HC={class:"arrow-col"},WC={class:"arrow-col"},VC=["onClick"],FC=["onClick"],UC={class:"arrow-col"},qC=["onClick"],zC=_e({__name:"character-tool",emits:["show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=R(null),s=R(null);Dt(o);const r=R(null),i=Lt("viewport"),l=E(()=>V.panels.panels[i.value.currentPanel]),a=E(()=>i.value.selection),u=E(()=>{const N=l.value.objects[a.value];if(N.type==="character")return N}),c=Re(u,"close"),f=es(u,"seekStyle"),g=es(u,"seekPart"),m=es(u,"seekPose"),_=E(()=>{const b=u.value.headsData;if(!b)return null;for(const O of b.variants){const T=kn(O[0],!1);if(T.startsWith("uploads:"))return T.substring(8)}return null}),k=E(()=>V.content.characters.get(u.value.characterType)),y=E(()=>k.value.label??""),w=E(()=>u.value.availablePartsKeys),h=E(()=>k.value.styleGroups[u.value.styleGroupId].styles.length>1||k.value.styleGroups.length>1),v=E(()=>k.value.styleGroups[u.value.styleGroupId].styles[u.value.styleId].poses.length>1);function p(){s.value.click()}async function P(){const N=s.value;if(!N.files)return;if(N.files.length!==1){console.error("More than one file uploaded!");return}const b=N.files[0];await re(async()=>{const O=URL.createObjectURL(b);V.uploadUrls.add(_.value,O)})}function M(N){return N.charAt(0).toUpperCase()+N.substring(1)}return ze(()=>a.value,()=>{r.value=null}),(N,b)=>(j(),ce(_o,{ref_key:"root",ref:o,object:u.value,title:y.value,showAltPanel:!!r.value},{"alt-panel":ne(()=>[r.value?(j(),ce(Xk,{key:0,character:u.value,part:r.value,onLeave:b[0]||(b[0]=O=>r.value=null),onShowDialog:b[1]||(b[1]=O=>e("show-dialog",O)),onShowExpressionDialog:b[2]||(b[2]=O=>e("show-expression-dialog",O))},null,8,["character","part"])):de("",!0)]),default:ne(()=>[_.value?(j(),U(ue,{key:0},[d("p",AC,[b[11]||(b[11]=te(" MISSING Head sprite! Click below to re-upload ")),d("span",IC,'"'+Pe(_.value)+'"',1),b[12]||(b[12]=te(". "))]),d("button",{onClick:b[3]||(b[3]=O=>p())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:s,onChange:P},null,544)],64)):de("",!0),v.value||w.value.length>0||h.value?(j(),ce(Pt,{key:1,class:"pose-list",title:"Pose:"},{default:ne(()=>[d("table",MC,[d("tbody",null,[h.value?(j(),U("tr",DC,[d("td",BC,[d("button",{onClick:b[4]||(b[4]=O=>Q(f)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:b[5]||(b[5]=O=>r.value="style")}," Style ")]),d("td",EC,[d("button",{onClick:b[6]||(b[6]=O=>Q(f)(1))},">")])])):de("",!0),v.value?(j(),U("tr",LC,[d("td",NC,[d("button",{onClick:b[7]||(b[7]=O=>Q(m)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:b[8]||(b[8]=O=>r.value="pose")}," Pose ")]),d("td",HC,[d("button",{onClick:b[9]||(b[9]=O=>Q(m)(1))},">")])])):de("",!0),(j(!0),U(ue,null,qe(w.value,O=>(j(),U("tr",{key:O},[d("td",WC,[d("button",{onClick:T=>Q(g)(O,-1)}," < ",8,VC)]),d("td",null,[d("button",{class:"middle-button",onClick:T=>r.value=O},Pe(M(O)),9,FC)]),d("td",UC,[d("button",{onClick:T=>Q(g)(O,1)},">",8,qC)])]))),128))])])]),_:1})):de("",!0)]),transform:ne(()=>[q(Ke,{modelValue:Q(c),"onUpdate:modelValue":b[10]||(b[10]=O=>ge(c)?c.value=O:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}}),XC=Ee(zC,[["__scopeId","data-v-8c562c62"]]),YC=["onClick"],GC=_e({__name:"choice-tool",setup(n){const t=R(null),e=Lt("viewport");Dt(t);const o=E(()=>V.panels.panels[e.value.currentPanel]),s=E(()=>{const k=o.value.objects[e.value.selection];if(k.type==="choice")return k}),r=R(0),i=R(!1),l=Re(s,"autoWrap"),a=_("text"),u=E(()=>s.value.choices),c=E(()=>{if(i.value)return{title:"Text",get:()=>a.value,set:k=>{a.value=k},leave:()=>{i.value=!1}}});function f(k){r.value=k}function g(){re(async()=>{s.value.addChoice("")})}function m(){re(async()=>{r.value===s.value.choices.length-1&&r.value>0&&f(r.value-1),s.value.removeChoice(r.value)})}function _(k){return E({get(){return s.value.choices[r.value][k]},set(y){re(()=>{s.value.setChoiceProperty(r.value,k,y)})}})}return(k,y)=>(j(),ce(_o,{ref_key:"root",ref:t,object:s.value,title:"Choice",textHandler:c.value},{default:ne(()=>[q(Pt,{class:"buttons",title:"Buttons:"},{default:ne(()=>[q(At,{maxSize:"100%",direction:"vertical",noWraping:""},{default:ne(()=>[(j(!0),U(ue,null,qe(u.value,(w,h)=>(j(),U("div",{class:He({choiceBtn:!0,active:h===r.value}),key:h,onClick:v=>f(h)},Pe(w.text.trim()===""?"[Empty]":w.text),11,YC))),128))]),_:1})]),_:1}),q(Pt,{class:"current_button",title:"Current button:"},{default:ne(()=>[d("table",null,[d("tbody",null,[y[4]||(y[4]=d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),d("tr",null,[d("td",null,[Se(d("input",{id:"choice-button-input","onUpdate:modelValue":y[0]||(y[0]=w=>ge(a)?a.value=w:null),onKeydown:y[1]||(y[1]=pe(()=>{},["stop"]))},null,544),[[Je,Q(a)]])]),d("td",null,[d("button",{onClick:y[2]||(y[2]=w=>i.value=!0)},"...")])])])])]),_:1}),d("button",{onClick:g},"Add"),d("button",{onClick:m},"Remove"),q(Ke,{label:"Auto line wrap?",modelValue:Q(l),"onUpdate:modelValue":y[3]||(y[3]=w=>ge(l)?l.value=w:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),KC=Ee(GC,[["__scopeId","data-v-f58a4f6c"]]),JC={id:"notification_text_wrapper"},ZC=_e({__name:"notification-tool",setup(n){const t=R(null);Dt(t);const e=Lt("viewport"),o=E(()=>V.panels.panels[e.value.currentPanel]),s=E(()=>{const u=o.value.objects[e.value.selection];if(u.type==="notification")return u}),r=Re(s,"text"),i=Re(s,"backdrop"),l=R(!1),a=E(()=>{if(l.value)return{title:"Text",get:()=>r.value,set:u=>{r.value=u},leave:()=>{l.value=!1}}});return(u,c)=>(j(),ce(_o,{ref_key:"root",ref:t,object:s.value,title:"Notification",textHandler:a.value},{default:ne(()=>[d("div",JC,[c[4]||(c[4]=d("label",{for:"notification_text"},"Text:",-1)),Se(d("textarea",{"onUpdate:modelValue":c[0]||(c[0]=f=>ge(r)?r.value=f:null),id:"notification_text",onKeydown:c[1]||(c[1]=pe(()=>{},["stop"]))},null,544),[[Je,Q(r)]]),d("button",{onClick:c[2]||(c[2]=f=>l.value=!0)},"Formatting")])]),options:ne(()=>[q(Ke,{modelValue:Q(i),"onUpdate:modelValue":c[3]||(c[3]=f=>ge(i)?i.value=f:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),QC=Ee(ZC,[["__scopeId","data-v-c6c0f92a"]]),e_=["onClick","onKeydown"],t_={class:"panel_text"},n_={class:"panel_nr"},o_={class:"column"},s_={class:"v-w100"},r_={colspan:"2"},i_={key:0,value:"image/webp"},l_={key:1,value:"image/heif"},a_={key:0},u_={for:"export_ppi"},c_={key:0},d_={for:"export_pages"},f_={key:0},p_={colspan:"2"},h_={class:"column"},v_={style:{display:"flex"}},g_={class:"modal-text"},m_=100,b_=90,_d=70,xd=1/4,y_=.5,w_=_e({__name:"panels-tool",setup(n){const t=R(null),{vertical:e,getRoot:o}=Dt(t),s=R(he.supports.limitedCanvasSpace?10:0),r=R(""),i=R("image/png"),l=R(b_),a=R(!1),u=R(!1),c=R(null),f=R(null),g=fe().Base,m=window.showDirectoryPicker!==void 0&&"webkitRelativePath"in((File==null?void 0:File.prototype)??{});E(()=>V.panels.panels[Ye.value.currentPanel]);const _=E(()=>i.value!=="image/png"),k=E(()=>T.value.length>1);function y(D){return D===""}const w=R(!1),h=R(""),v=R(null);function p(D){var I;w.value=!1,D==="Yes"&&((I=v.value)==null||I.call(v,!0))}function P(D){return new Promise(I=>{h.value=D,w.value=!0,v.value=I})}const M=R(!1),N=R(!1);Promise.allSettled([ho(),Ew()]).then(([D,I])=>{D.status==="fulfilled"&&(M.value=D.value),I.status==="fulfilled"&&(N.value=I.value)});const b=E(()=>V.panels.order.indexOf(Ye.value.currentPanel)>0),O=E(()=>{const D=V.panels.order;return D.indexOf(Ye.value.currentPanel)<D.length-1}),T=E(()=>V.panels.order.map(I=>{const F=V.panels.panels[I],X=[...F.lowerOrder,...F.topOrder].map(z=>F.objects[z]).map(L);return{id:F.id,image:F.lastRender,text:X.reduce((z,le)=>z.length>le.length?z:le,"")}}));function L(D){switch(D.type){case"textBox":return D.text;case"notification":return D.text;case"poem":return D.text;case"choice":return D.choices.map(I=>`[${I.text}]`).join(`
`)}return""}function B(){const D=o().querySelector(".panel_button.active");D!=null&&H(D)}function H(D){const I=D.parentElement.parentElement;e.value?(I.scrollTop=D.offsetTop-I.clientHeight/2,I.scrollLeft=0):(I.scrollLeft=D.offsetLeft-I.clientWidth/2,I.scrollTop=0)}Wt(()=>{B()});function ee(){const D=new Date;return`cd-${[D.getFullYear(),`${D.getMonth()+1}`.padStart(2,"0"),`${D.getDate()}`.padStart(2,"0"),`${D.getHours()}`.padStart(2,"0"),`${D.getMinutes()}`.padStart(2,"0"),`${D.getSeconds()}`.padStart(2,"0")].join("-")}`}async function Y(){await go("export image",async()=>{const D=G(),I=i.value.split("/")[1],F=i.value,X=l.value,z=a.value,le=ee();await x(D,!0,z,async(se,ae)=>{await he.saveToFile(ae,`${le}_${se}.${I}`,F,X/m_)})})}async function x(D,I,F,X){const z=fe().Base,le=[],se=F?z.screenWidth:0,ae=F?0:z.screenHeight;for(let ve=0;ve<D.length;++ve){const Ce=D[ve],Oe=document.createElement("canvas");Oe.width=F?z.screenWidth*Ce.length:z.screenWidth,Oe.height=F?z.screenHeight:z.screenHeight*Ce.length;try{const De=Oe.getContext("2d");for(let st=0;st<Ce.length;++st){const ct=Ce[st],mt=new cs(ct,z.screenWidth,z.screenHeight);try{await mt.render(I,!1,!0),mt.paintOnto(De,{x:se*st,y:ae*st,w:z.screenWidth,h:z.screenHeight})}finally{mt.dispose()}}le.push(await X(ve,Oe))}finally{po(Oe)}}return le}function A(){const D=V.panels.order.length-1,I=0,F=r.value.split(","),X=[];let z=!1;for(const le of F){const se=le.trim(),ae=se.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!ae){se!==""&&je.fire(new _t(`Could not read '${le}' in the page list.`));continue}if(z=!0,ae[2])X.push(parseInt(ae[2],10)-1);else{const ve=Math.max(parseInt(ae[3],10)-1,I),Ce=Math.min(parseInt(ae[4],10)-1,D);if(ve==null||Ce==null||ve>Ce)continue;for(let Oe=ve;Oe<=Ce;++Oe)X.push(Oe)}}return z?X.sort((le,se)=>le-se).filter((le,se,ae)=>ae[se-1]!==le).map(le=>V.panels.panels[le].id):V.panels.order}function G(){const D=A();if(isNaN(s.value)&&(s.value=0),s.value===0)return[D];const I=[];for(let F=0;F<D.length/s.value;++F){const X=F*s.value,z=X+s.value;I.push(D.slice(X,z))}return I}async function Ie(){re(async()=>{V.panels.duplicatePanel(V.panels.panels[Ye.value.currentPanel]),Ye.value.currentPanel=V.panels.lastPanelId}),await yn(),B()}function K(D){re(()=>{Ye.value.currentPanel=D}),yn(()=>{B()})}function ie(){re(async()=>{V.panels.deletePanel(V.panels.panels[Ye.value.currentPanel])}),yn(()=>{B()})}function be(){re(()=>{V.panels.movePanel(V.panels.panels[Ye.value.currentPanel],-1)})}function Me(){re(()=>{V.panels.movePanel(V.panels.panels[Ye.value.currentPanel],1)})}const ye=Hn();ye.width=g.screenWidth*xd,ye.height=g.screenHeight*xd;const nt=ye.getContext("2d"),Xe=R(!1),Ye=Ot(),oe=E(()=>V.panels.order.filter(D=>V.panels.panels[D].lastRender==null));async function we(){const D=await window.showDirectoryPicker();if(!D)return;const I=await Array.fromAsync(D.values());if(I.some(X=>X.kind==="file"&&X.name==="save.dddg")){if(!await P("A save file already exists in this folder. Do you want to overwrite it?"))return}else if(I.length>0&&!await P("This folder already contains files. They might get overwritten. Do you want to continue?"))return;const F=[(async()=>{const X=await D.getFileHandle("save.dddg",{create:!0}),z=new Blob([await V.getSave(!1)],{type:"text/plain"}),le=await X.createWritable();await le.write(z),await le.close()})()];for(const[X,z]of Object.entries(V.uploadUrls.urls))F.push((async()=>{const se=await(await D.getFileHandle(X,{create:!0})).createWritable(),ve=await(await fetch(z)).blob();await se.write(ve),await se.close()})())}async function xe(D){const I=D.target.files;I&&(await re(async()=>{for(const F of I){const X=F.name;if(X==="save.dddg"){const le=await F.text();await V.loadSave(le)}const z=URL.createObjectURL(F);V.uploadUrls.add(X,z)}}),await $e(),he.supports.limitedCanvasSpace?je.fire(new _t("To prevent running out of memory, thumbnails will not be automatically restored in the background.")):setTimeout(()=>{$()},1e3))}async function $e(){const D=ur(Ye.value);D&&await S(D)}async function S(D){await go("render thumbnail",async()=>{const I=D.panelId;D.paintOnto(nt,{x:0,y:0,w:nt.canvas.width,h:nt.canvas.height}),nt.canvas.toBlob(F=>{if(!F)return;const X=V.panels.panels[I];if(!X)return;const z=URL.createObjectURL(F);X.lastRender=z},await ho()?"image/webp":"image/jpeg",y_)})}async function $(){try{const D=fe().Base;if(!Xe.value||he.supports.limitedCanvasSpace)return;const I=oe.value;if(I.length===0)return;const F=I[0],X=new cs(F,D.screenWidth,D.screenHeight);await X.render(!1,!1,!0),await S(X)}catch(D){console.error(D)}setTimeout(()=>{$()},100)}Wt(()=>{Xe.value=!0,requestAnimationFrame(()=>$e().catch(()=>{}))}),Sn(()=>{Xe.value=!1,po(nt.canvas)}),je.subscribe(er,()=>requestAnimationFrame($e));async function W(){const D=await V.getSave(!0),I=new Blob([D],{type:"text/plain"}),F=new Date,X=`save-${[F.getFullYear(),`${F.getMonth()+1}`.padStart(2,"0"),`${F.getDate()}`.padStart(2,"0"),`${F.getHours()}`.padStart(2,"0"),`${F.getMinutes()}`.padStart(2,"0"),`${F.getSeconds()}`.padStart(2,"0")].join("-")}`;he.storeSaveFile(I,`${X}.dddg`)}async function Z(){await re(async()=>{const D=c.value;if(!D.files)return;je.fire(new tr);const I=await J(D.files[0]);await V.loadSave(I)}),await $e(),he.supports.limitedCanvasSpace?je.fire(new _t("To prevent running out of memory, thumbnails will not be automatically restored in the background.")):setTimeout(()=>{$()},1e3)}function J(D){return new Promise((I,F)=>{const X=new FileReader;X.onload=function(){I(X.result)},X.onerror=function(z){F(z)},X.readAsText(D)})}return ze(()=>l.value,(D,I)=>{if(D===100){je.fire(new _t("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(I>_d&&D<=_d){je.fire(new _t("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),ze(()=>s.value,(D,I)=>{if(he.supports.limitedCanvasSpace&&(I<=10&&D>10||D===0&&T.value.length>10)){je.fire(new _t("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(D,I)=>(j(),U(ue,null,[d("div",{class:"panel",ref_key:"root",ref:t},[I[31]||(I[31]=d("h1",null,"Panels",-1)),u.value?(j(),ce(qa,{key:0,type:"panel",title:"","panel-id":Q(Ye).currentPanel,"no-composition":"",onLeave:I[0]||(I[0]=F=>{u.value=!1,$e()})},null,8,["panel-id"])):(j(),U(ue,{key:1},[q(Pt,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:ne(()=>[q(At,{"no-wraping":"",maxSize:"350px"},{default:ne(()=>[(j(!0),U(ue,null,qe(T.value,(F,X)=>(j(),U("div",{key:F.id,class:He({panel_button:!0,active:F.id===Q(Ye).currentPanel}),style:tt(`background-image: url('${F.image}')`),tabindex:"0",onClick:z=>K(F.id),onKeydown:[it(z=>K(F.id),["enter"]),it(pe(z=>K(F.id),["prevent"]),["space"])]},[d("div",t_,[d("p",null,Pe(F.text),1)]),d("div",n_,Pe(X+1),1)],46,e_))),128))]),_:1})]),_:1}),d("div",o_,[q(Te,{icon:"add_to_queue",onClick:Ie},{default:ne(()=>I[13]||(I[13]=[te(" Add new")])),_:1}),q(Te,{icon:"remove_from_queue",class:"bt0",onClick:ie,disabled:!k.value},{default:ne(()=>I[14]||(I[14]=[te(" Delete panel ")])),_:1},8,["disabled"]),q(Te,{icon:"arrow_upward",class:"bt0",onClick:be,disabled:!b.value},{default:ne(()=>I[15]||(I[15]=[te(" Move ahead ")])),_:1},8,["disabled"]),q(Te,{icon:"arrow_downward",class:"bt0",onClick:Me,disabled:!O.value},{default:ne(()=>I[16]||(I[16]=[te(" Move behind ")])),_:1},8,["disabled"]),q(Te,{class:"bt0",icon:"color_lens",onClick:I[1]||(I[1]=F=>u.value=!0)},{default:ne(()=>I[17]||(I[17]=[te(" Image options ")])),_:1})]),q(Pt,{title:"Export",class:"h-h100 export_settings"},{default:ne(()=>[d("table",s_,[d("tbody",null,[d("tr",null,[d("td",r_,[q(Te,{icon:"photo_camera",class:"w100",onClick:Y},{default:ne(()=>I[18]||(I[18]=[te(" Download ")])),_:1})])]),d("tr",null,[I[22]||(I[22]=d("td",null,[d("label",{for:"export_format"},"Format")],-1)),d("td",null,[Se(d("select",{id:"export_format","onUpdate:modelValue":I[2]||(I[2]=F=>i.value=F)},[I[19]||(I[19]=d("option",{value:"image/png"}," PNG (lossless) ",-1)),M.value?(j(),U("option",i_," WebP (lossy) ")):de("",!0),N.value?(j(),U("option",l_," HEIF (lossy) ")):de("",!0),I[20]||(I[20]=d("option",{value:"image/jpeg"}," JPEG (lossy) ",-1)),I[21]||(I[21]=d("option",{value:"image/jpeg"}," WebM (lossy, video) ",-1))],512),[[St,i.value]])])]),_.value?(j(),U("tr",a_,[I[23]||(I[23]=d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),d("td",null,[Se(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":I[3]||(I[3]=F=>l.value=F),onKeydown:I[4]||(I[4]=pe(()=>{},["stop"]))},null,544),[[Je,l.value,void 0,{number:!0}]])])])):de("",!0),d("tr",null,[d("td",null,[d("label",u_,[I[25]||(I[25]=te(" Panels per image: ")),!_.value||Q(e)?(j(),U("small",c_,I[24]||(I[24]=[d("br",null,null,-1),te("(0 for one single image)")]))):de("",!0)])]),d("td",null,[Se(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":I[5]||(I[5]=F=>s.value=F),onKeydown:I[6]||(I[6]=pe(()=>{},["stop"])),onBlur:I[7]||(I[7]=F=>{y(s.value)&&(s.value=0)})},null,544),[[Je,s.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",d_,[I[27]||(I[27]=te(" Panels to export: ")),!_.value||Q(e)?(j(),U("small",f_,I[26]||(I[26]=[d("br",null,null,-1),te("(Leave empty for all)")]))):de("",!0)])]),d("td",null,[Se(d("input",{id:"export_pages","onUpdate:modelValue":I[8]||(I[8]=F=>r.value=F),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Je,r.value]])])]),d("tr",null,[d("td",p_,[q(Ke,{modelValue:a.value,"onUpdate:modelValue":I[9]||(I[9]=F=>a.value=F),label:"Horizontal arrangement?",title:"Order panels side by side instead of top to bottom"},null,8,["modelValue"])])])])])]),_:1}),d("div",h_,[d("div",v_,[q(Te,{icon:"download",onClick:W},{default:ne(()=>I[28]||(I[28]=[te("Quick Save")])),_:1}),q(Te,{class:"bl0",icon:"upload",onClick:I[10]||(I[10]=F=>c.value.click()),style:{width:"auto"}},{default:ne(()=>[d("input",{type:"file",ref_key:"loadUpload",ref:c,onChange:Z},null,544)]),_:1})]),Q(m)?(j(),ce(Te,{key:0,class:"bt0",icon:"save",onClick:we},{default:ne(()=>I[29]||(I[29]=[te("Save Folder ")])),_:1})):de("",!0),Q(m)?(j(),ce(Te,{key:1,class:"bt0",icon:"folder_open",onClick:I[11]||(I[11]=F=>f.value.click())},{default:ne(()=>[I[30]||(I[30]=te("Load Folder ")),d("input",{type:"file",ref_key:"loadOpenFolder",ref:f,onChange:xe,webkitdirectory:""},null,544)]),_:1})):de("",!0)])],64))],512),(j(),ce(oa,{to:"#modal-messages"},[w.value?(j(),ce(Bn,{key:0,options:["No","Yes"],"no-base-size":"",class:"modal-rename",onOption:p,onLeave:I[12]||(I[12]=F=>p("No"))},{default:ne(()=>[d("p",g_,Pe(h.value),1)]),_:1})):de("",!0)]))],64))}}),k_=Ee(w_,[["__scopeId","data-v-05c8f5a8"]]),C_={id:"poem_text",class:"v-w100"},__=["value"],x_=["value"],S_={key:1},P_={class:"v-w100"},O_=_e({__name:"poem-tool",setup(n){const t=R(null),e=R(null),{vertical:o}=Dt(t),s=R(!1),r=R("");ze(()=>o.value,()=>{e.value.style.height="",e.value.style.width=""});const i=Lt("viewport"),l=E(()=>V.panels.panels[i.value.currentPanel]),a=E(()=>{const y=l.value.objects[i.value.selection];if(y.type==="poem")return y}),u=E(()=>{if(s.value)return{title:"Text",get:()=>f.value,set:y=>{f.value=y},leave:()=>{s.value=!1}}}),c=E(()=>{if(r.value)return{title:"Color",get:()=>{switch(r.value){case"":return"#000000";case"base":const y=fe().Poem;return a.value.consoleColor??y.consoleBackgroundColor;default:throw new Kt.UnreachableCaseError(r.value)}},set:y=>{re(()=>{y!==void 0&&(a.value.consoleColor=y)})},leave:()=>{r.value=""}}}),f=Re(a,"text"),g=Re(a,"autoWrap"),m=Re(a,"font"),_=Re(a,"overflow"),k=Re(a,"background");return(y,w)=>(j(),ce(_o,{ref_key:"root",ref:t,object:a.value,title:a.value.subtype==="poem"?"Poem":"Console",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("div",C_,[w[10]||(w[10]=d("label",{for:"poem_text"},"Text:",-1)),Se(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":w[0]||(w[0]=h=>ge(f)?f.value=h:null),onKeydown:w[1]||(w[1]=pe(()=>{},["stop"]))},null,544),[[Je,Q(f)]]),d("button",{class:"w100 bt0",onClick:w[2]||(w[2]=h=>s.value=!0)}," Formatting ")]),q(Ke,{label:"Auto line wrap?",modelValue:Q(g),"onUpdate:modelValue":w[3]||(w[3]=h=>ge(g)?g.value=h:null)},null,8,["modelValue"]),q(Ke,{label:"Allow overflow?",modelValue:Q(_),"onUpdate:modelValue":w[4]||(w[4]=h=>ge(_)?_.value=h:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),a.value.subtype==="poem"?(j(),U(ue,{key:0},[Se(d("select",{"onUpdate:modelValue":w[5]||(w[5]=h=>ge(k)?k.value=h:null),onKeydown:w[6]||(w[6]=pe(()=>{},["stop"]))},[(j(!0),U(ue,null,qe(Q(rp),(h,v)=>(j(),U("option",{value:v,key:v},Pe(h.name),9,__))),128))],544),[[St,Q(k)]]),Se(d("select",{"onUpdate:modelValue":w[7]||(w[7]=h=>ge(m)?m.value=h:null),onKeydown:w[8]||(w[8]=pe(()=>{},["stop"]))},[(j(!0),U(ue,null,qe(Q(ip),(h,v)=>(j(),U("option",{value:v,key:v},Pe(h.name),9,x_))),128))],544),[[St,Q(m)]])],64)):(j(),U("table",S_,[d("tbody",null,[d("tr",null,[w[11]||(w[11]=d("td",{style:{width:"0"}},"Color:",-1)),d("td",P_,[d("button",{id:"console_color",class:"w100",style:tt([{background:a.value.consoleColor},{"min-width":"64px"}]),onClick:w[9]||(w[9]=h=>r.value="base")},null,4)])])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}}),T_=Ee(O_,[["__scopeId","data-v-459fc793"]]),$_={class:"warning"},j_={style:{"word-wrap":"break-word"}},R_=_e({__name:"sprite-tool",setup(n){const t=R(null),e=R(null);Dt(t);const o=Lt("viewport"),s=E(()=>{for(const u of i.value.assets){const c=kn(u,!1);if(console.log(c),c.startsWith("uploads:"))return c.substring(8)}return null}),r=E(()=>V.panels.panels[o.value.currentPanel]),i=E(()=>{const u=r.value.objects[o.value.selection];if(u.type==="sprite")return u});function l(){e.value.click()}async function a(){const u=e.value;if(!u.files)return;if(u.files.length!==1){console.error("More than one file uploaded!");return}const c=u.files[0];re(()=>{const f=URL.createObjectURL(c);V.uploadUrls.add(s.value,f)})}return(u,c)=>(j(),ce(_o,{ref_key:"root",ref:t,object:i.value,title:"Custom Sprite"},{default:ne(()=>[s.value?(j(),U(ue,{key:0},[d("p",$_,[c[1]||(c[1]=te(" MISSING SPRITE! Click below to re-upload ")),d("span",j_,'"'+Pe(s.value)+'"',1),c[2]||(c[2]=te(". "))]),d("button",{onClick:c[0]||(c[0]=f=>l())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:e,onChange:a},null,544)],64)):de("",!0)]),_:1},8,["object"]))}}),A_=Ee(R_,[["__scopeId","data-v-e15e7e5e"]]),I_={class:"upper-combos"},M_={colspan:"2"},D_=["value"],B_=["disabled"],E_={id:"dialog_text_wrapper",class:"v-w100"},L_={key:0},N_=["placeholder"],H_={colspan:"2"},W_={key:0},V_={key:1},F_={colspan:"2"},U_=_e({__name:"textbox-tool",setup(n){const t=R(null),e=R(null),{vertical:o}=Dt(t),s=R(""),r=R("");ze(()=>o.value,()=>{const x=e.value;x!=null&&(x.style.height="",x.style.width="")});const i=Lt("viewport"),l=E(()=>V.panels.panels[i.value.currentPanel]),a=E(()=>{const x=l.value.objects[i.value.selection];if(x.type==="textBox")return x}),u=E(()=>{if(s.value)return{title:_.value,get(){return s.value==="name"?a.value.talkingOther:s.value==="body"?v.value:""},set(x){s.value==="name"?g.value=x:s.value==="body"&&(v.value=x)},leave(){s.value=""}}}),c=E(()=>{if(r.value)return{title:k.value,get:()=>{switch(r.value){case"":return"#000000";case"base":return a.value.customColor;case"controls":return a.value.customControlsColor;case"namebox":return a.value.customNameboxColor;case"nameboxStroke":return a.value.customNameboxStroke;default:throw new Kt.UnreachableCaseError(r.value)}},set:x=>{re(()=>{const A={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[r.value];x!==void 0&&re(()=>{a.value[A]=x})})},leave:()=>{r.value=""}}}),f=E({get(){return a.value.talkingObjId??"$null$"},set(x){re(()=>{a.value.talkingObjId=x==="$null$"?null:x})}}),g=Re(a,"talkingOther"),m=E(()=>{const x=l.value,A=[];for(const G of[...x.lowerOrder,...x.topOrder]){const Ie=x.objects[G];Ie.label!==null&&A.push([G,Ie.label])}return A}),_=E(()=>s.value==="name"?"Name":s.value==="body"?"Dialog":""),k=E(()=>{switch(r.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Kt.UnreachableCaseError(r.value)}}),y=Re(a,"autoQuoting"),w=Re(a,"autoWrap"),h=Re(a,"overflow"),v=Re(a,"text"),p=E(()=>P.value.startsWith("custom")),P=Re(a,"style"),M=Re(a,"controls"),N=Re(a,"skip"),b=Re(a,"continue"),O=Re(a,"overrideColor"),T=Re(a,"deriveCustomColors"),L=Re(a,"customNameboxWidth"),B=E(()=>fe().TextBox.NameboxWidth),H=es(a,"splitTextbox"),ee=es(a,"applyResetBounds");function Y(){re(()=>{const x=f.value;i.value.selection=x==="$other$"||x==="$null$"?null:x})}return(x,A)=>(j(),ce(_o,{ref_key:"root",ref:t,object:a.value,title:"Textbox",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("table",I_,[d("tbody",null,[d("tr",null,[A[27]||(A[27]=d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),d("td",M_,[Se(d("select",{id:"text_style","onUpdate:modelValue":A[0]||(A[0]=G=>ge(P)?P.value=G:null),onKeydown:A[1]||(A[1]=pe(()=>{},["stop"]))},A[26]||(A[26]=[d("option",{value:"normal"},"Normal",-1),d("option",{value:"corrupt"},"Corrupt",-1),d("option",{value:"custom"},"Custom",-1),d("option",{value:"custom_plus"}," Custom (Plus) ",-1),d("option",{value:"none"},"None",-1)]),544),[[St,Q(P)]])])]),d("tr",null,[A[30]||(A[30]=d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),d("td",null,[Se(d("select",{id:"current_talking","onUpdate:modelValue":A[2]||(A[2]=G=>f.value=G),onKeydown:A[3]||(A[3]=pe(()=>{},["stop"]))},[A[28]||(A[28]=d("option",{value:"$null$"},"No-one",-1)),(j(!0),U(ue,null,qe(m.value,([G,Ie])=>(j(),U("option",{key:G,value:G},Pe(Ie),9,D_))),128)),A[29]||(A[29]=d("option",{value:"$other$"},"Other",-1))],544),[[St,f.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:Y,disabled:f.value==="$null$"||f.value==="$other$"}," > ",8,B_)])]),d("tr",null,[A[31]||(A[31]=d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),d("td",null,[Se(d("input",{id:"custom_name","onUpdate:modelValue":A[4]||(A[4]=G=>ge(g)?g.value=G:null),onKeydown:A[5]||(A[5]=pe(()=>{},["stop"]))},null,544),[[Je,Q(g)]])]),d("td",null,[d("button",{onClick:A[6]||(A[6]=G=>s.value="name")},"...")])])])]),q(Ke,{label:"Auto quoting?",modelValue:Q(y),"onUpdate:modelValue":A[7]||(A[7]=G=>ge(y)?y.value=G:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),q(Ke,{label:"Auto line wrap?",modelValue:Q(w),"onUpdate:modelValue":A[8]||(A[8]=G=>ge(w)?w.value=G:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),q(Ke,{label:"Allow overflow?",modelValue:Q(h),"onUpdate:modelValue":A[9]||(A[9]=G=>ge(h)?h.value=G:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",E_,[A[32]||(A[32]=d("label",{for:"dialog_text"},"Dialog:",-1)),Se(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":A[10]||(A[10]=G=>ge(v)?v.value=G:null),id:"dialog_text",onKeydown:A[11]||(A[11]=pe(()=>{},["stop"]))},null,544),[[Je,Q(v)]]),d("button",{class:"w100 bt0",onClick:A[12]||(A[12]=G=>s.value="body")}," Formatting ")])]),options:ne(()=>[q(Pt,{title:"Customization:",class:He(p.value?"customization-set":"")},{default:ne(()=>[q(At,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:ne(()=>[q(Ke,{label:"Controls visible?",modelValue:Q(M),"onUpdate:modelValue":A[13]||(A[13]=G=>ge(M)?M.value=G:null)},null,8,["modelValue"]),q(Ke,{label:"Able to skip?",modelValue:Q(N),"onUpdate:modelValue":A[14]||(A[14]=G=>ge(N)?N.value=G:null)},null,8,["modelValue"]),q(Ke,{label:"Continue arrow?",modelValue:Q(b),"onUpdate:modelValue":A[15]||(A[15]=G=>ge(b)?b.value=G:null)},null,8,["modelValue"]),p.value?(j(),U("table",L_,[d("tbody",null,[d("tr",null,[A[33]||(A[33]=d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),d("td",null,[Se(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:B.value+"","onUpdate:modelValue":A[16]||(A[16]=G=>ge(L)?L.value=G:null),onKeydown:A[17]||(A[17]=pe(()=>{},["stop"]))},null,40,N_),[[Je,Q(L),void 0,{number:!0}]])])]),d("tr",null,[d("td",H_,[q(Ke,{modelValue:Q(O),"onUpdate:modelValue":A[18]||(A[18]=G=>ge(O)?O.value=G:null),label:"Override color"},null,8,["modelValue"])])]),Q(O)?(j(),U("tr",W_,[A[34]||(A[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:tt({background:a.value.customColor}),onClick:A[19]||(A[19]=G=>r.value="base")},null,4)])])):de("",!0),Q(O)?(j(),U("tr",V_,[d("td",F_,[q(Ke,{id:"derive_custom_colors",modelValue:Q(T),"onUpdate:modelValue":A[20]||(A[20]=G=>ge(T)?T.value=G:null),label:"Derive other colors"},null,8,["modelValue"])])])):de("",!0),Q(O)&&!Q(T)?(j(),U(ue,{key:2},[d("tr",null,[A[35]||(A[35]=d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:tt({background:a.value.customControlsColor}),onClick:A[21]||(A[21]=G=>r.value="controls")},null,4)])]),d("tr",null,[A[36]||(A[36]=d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:tt({background:a.value.customNameboxColor}),onClick:A[22]||(A[22]=G=>r.value="namebox")},null,4)])]),d("tr",null,[A[37]||(A[37]=d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:tt({background:a.value.customNameboxStroke}),onClick:A[23]||(A[23]=G=>r.value="nameboxStroke")},null,4)])])],64)):de("",!0)])])):de("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:A[24]||(A[24]=(...G)=>Q(ee)&&Q(ee)(...G))},"Reset position"),d("button",{class:"bt0",onClick:A[25]||(A[25]=(...G)=>Q(H)&&Q(H)(...G))},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}}),q_=Ee(U_,[["__scopeId","data-v-3720aae2"]]),z_={id:"toolbar"},X_={id:"toolbar-end"},Y_=_e({__name:"tool-box",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=R(null),s=R("add"),r=E(()=>V.panels.panels[i.value.currentPanel]),i=Ot(),l=Pn(),a=Hf(),u=E(()=>{if(s.value==="selection")if(a.value===null)s.value="add";else return r.value.objects[a.value].type;return s.value}),c=E(()=>V.ui.lastDownload!==null);function f(m){m===s.value&&(m="add"),s.value=m,a.value!==null&&(i.value.selection=null)}function g(){Tw(o.value)&&(o.value.scrollTop=0,o.value.scrollLeft=0)}return ze(()=>a.value,m=>{if(console.log("selection changed",m),m!=null){s.value="selection";return}s.value==="selection"&&(s.value="add")}),he.onPanelChange(m=>{s.value=m}),(m,_)=>(j(),U("div",{id:"panels",class:He({vertical:Q(l)}),onScroll:g,ref_key:"panels",ref:o},[d("div",z_,[q(Te,{icon:"add_box","icon-pos":"top",class:He({active:u.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:_[0]||(_[0]=k=>f("add"))},null,8,["class"]),q(Te,{icon:"panorama","icon-pos":"top",class:He({active:u.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:_[1]||(_[1]=k=>f("backgrounds"))},null,8,["class"]),q(Te,{icon:"view_module","icon-pos":"top",class:He({active:u.value==="panels"}),title:"Panels",shortcut:"d",onClick:_[2]||(_[2]=k=>f("panels"))},null,8,["class"]),q(Te,{icon:"settings_applications","icon-pos":"top",class:He({active:u.value==="settings"}),title:"Settings",shortcut:"f",onClick:_[3]||(_[3]=k=>f("settings"))},null,8,["class"])]),u.value==="settings"?(j(),ce(z1,{key:0})):u.value==="backgrounds"?(j(),ce(Fk,{key:1,onShowDialog:_[4]||(_[4]=k=>e("show-dialog",k))})):u.value==="help_credits"?(j(),ce(A1,{key:2})):u.value==="character"?(j(),ce(XC,{key:3,onShowDialog:_[5]||(_[5]=k=>e("show-dialog",k)),onShowExpressionDialog:_[6]||(_[6]=k=>e("show-expression-dialog",k))})):u.value==="sprite"?(j(),ce(A_,{key:4})):u.value==="textBox"?(j(),ce(q_,{key:5})):u.value==="choice"?(j(),ce(KC,{key:6})):u.value==="panels"?(j(),ce(k_,{key:7})):u.value==="notification"?(j(),ce(QC,{key:8})):u.value==="poem"?(j(),ce(T_,{key:9})):(j(),ce($1,{key:10,onShowDialog:_[7]||(_[7]=k=>e("show-dialog",k))})),d("div",X_,[q(Te,{icon:"help","icon-pos":"top",class:He({active:u.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:_[8]||(_[8]=k=>f("help_credits"))},null,8,["class"]),q(Te,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:_[9]||(_[9]=k=>e("show-dialog"))}),q(Te,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:_[10]||(_[10]=k=>e("show-prev-render")),disabled:!c.value},null,8,["disabled"]),q(Te,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:_[11]||(_[11]=k=>e("download"))})])],34))}}),G_={class:"hidden-selectors"},K_=["data-obj-id","onKeydown"],J_=20,Z_=50,th=_e({__name:"app",setup(n){const t=nv("app"),e=ou(()=>Al(()=>import("./single-box-DrW1BnDt.js"),__vite__mapDeps([0,1]),import.meta.url)),o=ou(()=>Al(()=>import("./expression-builder-N-xgXkpD.js"),__vite__mapDeps([2,3]),import.meta.url)),s=R(!0),r=R(null);function i(){const K=V.ui.lastDownload;K!=null&&r.value.blendOver(K)}const l=R(V.viewports.setUpViewport(document));pf("viewport",l),ze(()=>{var K;return(K=t.value)==null?void 0:K.ownerDocument},(K,ie)=>{K!=null&&(K!==document&&(l.value=V.viewports.setUpViewport(K)),ie!=null&&_(ie),m(K))},{immediate:!0});const a=Symbol("capturing"),u=new Map;function c(K,ie,be=!1){if(be){const nt=ie;ie=Xe=>nt(Xe),ie[a]=!0}const Me=u.get(K);Me==null?u.set(K,[ie]):Me.push(ie);const ye=t.value;ye!=null&&ye.ownerDocument.addEventListener(K,ie,be)}const f=new Map;function g(K,ie,be=!1){if(be){const nt=ie;ie=Xe=>nt(Xe),ie[a]=!0}const Me=f.get(K);Me==null?f.set(K,[ie]):Me.push(ie);const ye=t.value;ye!=null&&ye.ownerDocument.defaultView.addEventListener(K,ie)}function m(K){var ie;for(const[be,Me]of u)for(const ye of Me)K.addEventListener(be,ye);for(const[be,Me]of f)for(const ye of Me)(ie=K.defaultView)==null||ie.addEventListener(be,ye)}function _(K){var ie;for(const[be,Me]of u)for(const ye of Me)K.removeEventListener(be,ye);for(const[be,Me]of f)for(const ye of Me)(ie=K.defaultView)==null||ie.removeEventListener(be,ye)}Sn(()=>{const K=l.value.doc;_(K)});const k=E(()=>{const ie=V.panels.panels[l.value.currentPanel];return ie==null?[]:[...ie.lowerOrder,...ie.topOrder]});function y(K){K.preventDefault()}c("drop",y,!0),c("dragover",y,!0);const w=R(!1),h=E(()=>V.ui.useDarkTheme);if(ze(()=>h.value??w.value,K=>{l.value.doc.body.classList.toggle("dark-theme",K)},{immediate:!0}),window.matchMedia!=null){const K=window.matchMedia("(prefers-color-scheme: dark)");w.value=K.matches;const ie=be=>w.value=be.matches;K.addEventListener?K.addEventListener("change",ie):K.addListener(ie)}const v=R(!1),p=R(""),P=R(void 0);function M(K){v.value=!0,p.value=K.character,P.value=K.headGroup}const N=R(null),b=R(!1);function O(K){if(b.value=!0,K==null)return;const ie=()=>{N.value?N.value.setSearch(K):setTimeout(ie,Z_)};yn(ie)}const T=E(()=>V.ui.nsfw);ze(()=>T.value,async K=>{K?V.content.loadContentPacks(tm):V.content.removeContentPacks(em)});let L=null;function B(){L==null&&(L=requestAnimationFrame(()=>{L=null,je.fire(new Qs)}))}function H(K){if(Up(K.target)||Ow(K.target)){console.log("skip keydown on potential target");return}re(async()=>{const ie=(K.ctrlKey||K.metaKey)&&!K.altKey&&!K.shiftKey,be=!K.ctrlKey&&!K.altKey&&!K.metaKey&&!K.shiftKey;if(ie&&K.key==="v"){await V.ui.pasteObjects(V.panels.panels[l.value.currentPanel]),K.preventDefault();return}if(be&&K.key==="Escape"){if(l.value.selection===null)return;l.value.selection=null;return}const Me=V.panels.panels[l.value.currentPanel],ye=Me.objects[l.value.selection];if(ye!=null){if(ie){if(K.key==="c"||K.key==="x"){V.ui.copyObjectToClipboard(Me.id,[ye.id]),K.key==="x"&&Me.removeObject(ye),K.preventDefault();return}}else if(be){if(K.key==="Delete"){V.panels.panels[l.value.currentPanel].removeObject(ye);return}if(K.key==="/"||K.key==="*"){let Xe=K.key==="/"?-10:10;K.shiftKey&&(Xe/=Math.abs(Xe)),ye.rotation+=Xe,K.stopPropagation(),K.preventDefault();return}if(ye.type==="character"&&!ye.freeMove){if(K.key==="ArrowLeft"){ye.shiftCharacterSlot(-1);return}if(K.key==="ArrowRight"){ye.shiftCharacterSlot(1);return}}const nt=K.shiftKey?1:J_;switch(K.key){case"ArrowLeft":ye.x-=nt;break;case"ArrowRight":ye.x+=nt;break;case"ArrowUp":ye.y-=nt;break;case"ArrowDown":ye.y+=nt;break;default:return}}}})}g("keydown",H);let ee=null,Y=!1;function x(K){K.ctrlKey?!Y&&ee===null&&(ee=setTimeout(A)):G()}function A(){document.body.classList.add("ctrl-key"),Y=!0}function G(){ee!==null&&(clearTimeout(ee),ee=null),document.body.classList.remove("ctrl-key"),Y=!1}g("keydown",x,!0),g("keyup",x,!0),g("mousemove",x,!0),g("blur",G);function Ie(K){re(()=>{l.value.selection!==K&&(l.value.selection=K)})}return ze(()=>l.value.selection,K=>{var ie,be;((ie=document.activeElement)==null?void 0:ie.getAttribute("data-obj-id"))!==""+K&&((be=document.querySelector(`*[data-obj-id='${K}']`))==null||be.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),window.store=V,window.env=he,Wt(async()=>{await he.loadGameMode(),s.value=!1;const K=await he.loadSettings();V.panels.lastPanelId===-1&&await re(async()=>{if(he.state.looseTextParsing=K.looseTextParsing||!0,V.ui.lqRendering=K.lq??!1,V.ui.useDarkTheme=K.darkMode??null,V.ui.defaultCharacterTalkingZoom=K.defaultCharacterTalkingZoom??!0,await V.content.loadContentPacks([`${vt}buildin.base.backgrounds.json`,`${vt}buildin.base.monika.json`,`${vt}buildin.base.sayori.json`,`${vt}buildin.base.natsuki.json`,`${vt}buildin.base.yuri.json`,`${vt}buildin.extra.mc.json`,`${vt}buildin.extra.concept_mc_v2.json`,`${vt}buildin.extra.mc_chad.json`,`${vt}buildin.extra.femc.json`,`${vt}buildin.extra.concept_femc.json`,`${vt}buildin.extra.amy.json`]),!await he.loadDefaultTemplate()){he.loadContentPacks();const ie=V.panels.createPanel();l.value.currentPanel=ie.id,Object.keys(ie.objects).length===0&&bn.create(ie,`Hi! Click here to edit this textbox! ${l.value.isVertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`),ie.background.current="dddg.buildin.backgrounds:ddlc.clubroom",V.ui.nsfw=K.nsfw??!1}})}),(K,ie)=>(j(),U(ue,null,[d("div",{id:"app",ref_key:"app",ref:t},[d("div",G_,[(j(!0),U(ue,null,qe(k.value,be=>(j(),U("div",{key:be,tabindex:"0","data-obj-id":be,onFocus:ie[0]||(ie[0]=Me=>B()),onBlur:ie[1]||(ie[1]=Me=>B()),onKeydown:[it(pe(Me=>Ie(be),["prevent"]),["enter"]),it(pe(Me=>Ie(be),["prevent"]),["space"])]},null,40,K_))),128))]),q(u1,{ref_key:"renderer",ref:r,canvasWidth:l.value.canvasWidth,canvasHeight:l.value.canvasHeight,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),q(Xg),q(Y_,{onShowPrevRender:i,onDownload:ie[2]||(ie[2]=be=>r.value.download()),onShowDialog:O,onShowExpressionDialog:M}),(j(),ce(rv,null,[b.value?(j(),ce(Bn,{key:0,ref:"dialog",onLeave:ie[4]||(ie[4]=be=>b.value=!1)},{default:ne(()=>[q(Q(e),{ref_key:"packDialog",ref:N,onLeave:ie[3]||(ie[3]=be=>b.value=!1)},null,512)]),_:1},512)):de("",!0)],1024)),v.value?(j(),ce(Bn,{key:0,ref:"dialog",onLeave:ie[6]||(ie[6]=be=>v.value=!1)},{default:ne(()=>[q(Q(o),{character:p.value,initHeadGroup:P.value,onLeave:ie[5]||(ie[5]=be=>v.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):de("",!0)],512),ie[7]||(ie[7]=d("div",{id:"modal-messages"},null,-1))],64))}});Ef(th).mount("#main_wrapper");export{Wt as A,Sn as B,Se as C,Je as D,qv as E,ue as F,rf as G,go as H,je as I,Jt as J,Xt as K,kn as L,vo as M,Yp as N,Dp as O,Jo as P,eh as Q,Wn as R,Qp as S,ex as T,St as U,Nf as V,Pt as W,Fw as X,on as Y,re as Z,Qe as _,U as a,d as b,E as c,_e as d,he as e,de as f,te as g,q as h,ne as i,ce as j,Ke as k,qe as l,n1 as m,tt as n,j as o,Ee as p,ze as q,R as r,V as s,Pe as t,Q as u,He as v,pe as w,yn as x,En as y,hs as z};
