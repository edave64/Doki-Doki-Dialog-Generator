const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./single-box-CNnlws6h.js","./single-box-NPFyOzrf.css","./expression-builder-ChUyMMB2.js","./expression-builder-BmWJ_DoD.css"])))=>i.map(i=>d[i]);
var th=Object.defineProperty;var nh=(n,t,e)=>t in n?th(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var _=(n,t,e)=>nh(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ql(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Ae={},Kn=[],Gt=()=>{},oh=()=>!1,hr=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zl=n=>n.startsWith("onUpdate:"),nt=Object.assign,Xl=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},sh=Object.prototype.hasOwnProperty,Ee=(n,t)=>sh.call(n,t),me=Array.isArray,Jn=n=>mo(n)==="[object Map]",go=n=>mo(n)==="[object Set]",za=n=>mo(n)==="[object Date]",rh=n=>mo(n)==="[object RegExp]",_e=n=>typeof n=="function",Je=n=>typeof n=="string",Lt=n=>typeof n=="symbol",Fe=n=>n!==null&&typeof n=="object",_d=n=>(Fe(n)||_e(n))&&_e(n.then)&&_e(n.catch),xd=Object.prototype.toString,mo=n=>xd.call(n),ih=n=>mo(n).slice(8,-1),Sd=n=>mo(n)==="[object Object]",Yl=n=>Je(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Vo=ql(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),vr=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},lh=/-(\w)/g,rn=vr(n=>n.replace(lh,(t,e)=>e?e.toUpperCase():"")),ah=/\B([A-Z])/g,an=vr(n=>n.replace(ah,"-$1").toLowerCase()),Pd=vr(n=>n.charAt(0).toUpperCase()+n.slice(1)),Br=vr(n=>n?`on${Pd(n)}`:""),gt=(n,t)=>!Object.is(n,t),Zn=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},Od=(n,t,e,o=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:o,value:e})},Ws=n=>{const t=parseFloat(n);return isNaN(t)?n:t},uh=n=>{const t=Je(n)?Number(n):NaN;return isNaN(t)?n:t};let Xa;const gr=()=>Xa||(Xa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function tt(n){if(me(n)){const t={};for(let e=0;e<n.length;e++){const o=n[e],s=Je(o)?ph(o):tt(o);if(s)for(const r in s)t[r]=s[r]}return t}else if(Je(n)||Fe(n))return n}const ch=/;(?![^(]*\))/g,dh=/:([^]+)/,fh=/\/\*[^]*?\*\//g;function ph(n){const t={};return n.replace(fh,"").split(ch).forEach(e=>{if(e){const o=e.split(dh);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function Ne(n){let t="";if(Je(n))t=n;else if(me(n))for(let e=0;e<n.length;e++){const o=Ne(n[e]);o&&(t+=o+" ")}else if(Fe(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const hh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vh=ql(hh);function Td(n){return!!n||n===""}function gh(n,t){if(n.length!==t.length)return!1;let e=!0;for(let o=0;e&&o<n.length;o++)e=ds(n[o],t[o]);return e}function ds(n,t){if(n===t)return!0;let e=za(n),o=za(t);if(e||o)return e&&o?n.getTime()===t.getTime():!1;if(e=Lt(n),o=Lt(t),e||o)return n===t;if(e=me(n),o=me(t),e||o)return e&&o?gh(n,t):!1;if(e=Fe(n),o=Fe(t),e||o){if(!e||!o)return!1;const s=Object.keys(n).length,r=Object.keys(t).length;if(s!==r)return!1;for(const i in n){const l=n.hasOwnProperty(i),a=t.hasOwnProperty(i);if(l&&!a||!l&&a||!ds(n[i],t[i]))return!1}}return String(n)===String(t)}function Gl(n,t){return n.findIndex(e=>ds(e,t))}const $d=n=>!!(n&&n.__v_isRef===!0),Oe=n=>Je(n)?n:n==null?"":me(n)||Fe(n)&&(n.toString===xd||!_e(n.toString))?$d(n)?Oe(n.value):JSON.stringify(n,jd,2):String(n),jd=(n,t)=>$d(t)?jd(n,t.value):Jn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[o,s],r)=>(e[Er(o,r)+" =>"]=s,e),{})}:go(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Er(e))}:Lt(t)?Er(t):Fe(t)&&!me(t)&&!Sd(t)?String(t):t,Er=(n,t="")=>{var e;return Lt(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let kt;class mh{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=kt,!t&&kt&&(this.index=(kt.scopes||(kt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=kt;try{return kt=this,t()}finally{kt=e}}}on(){kt=this}off(){kt=this.parent}stop(t){if(this._active){this._active=!1;let e,o;for(e=0,o=this.effects.length;e<o;e++)this.effects[e].stop();for(this.effects.length=0,e=0,o=this.cleanups.length;e<o;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,o=this.scopes.length;e<o;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function bh(){return kt}let qe;const Lr=new WeakSet;class Rd{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,kt&&kt.active&&kt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lr.has(this)&&(Lr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ad(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ya(this),Md(this);const t=qe,e=Bt;qe=this,Bt=!0;try{return this.fn()}finally{Dd(this),qe=t,Bt=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zl(t);this.deps=this.depsTail=void 0,Ya(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){bl(this)&&this.run()}get dirty(){return bl(this)}}let Id=0,Fo,Uo;function Ad(n,t=!1){if(n.flags|=8,t){n.next=Uo,Uo=n;return}n.next=Fo,Fo=n}function Kl(){Id++}function Jl(){if(--Id>0)return;if(Uo){let t=Uo;for(Uo=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Fo;){let t=Fo;for(Fo=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(o){n||(n=o)}t=e}}if(n)throw n}function Md(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Dd(n){let t,e=n.depsTail,o=e;for(;o;){const s=o.prevDep;o.version===-1?(o===e&&(e=s),Zl(o),yh(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=s}n.deps=t,n.depsTail=e}function bl(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Bd(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Bd(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ts))return;n.globalVersion=ts;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!bl(n)){n.flags&=-3;return}const e=qe,o=Bt;qe=n,Bt=!0;try{Md(n);const s=n.fn(n._value);(t.version===0||gt(s,n._value))&&(n._value=s,t.version++)}catch(s){throw t.version++,s}finally{qe=e,Bt=o,Dd(n),n.flags&=-3}}function Zl(n,t=!1){const{dep:e,prevSub:o,nextSub:s}=n;if(o&&(o.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=o,n.nextSub=void 0),e.subs===n&&(e.subs=o,!o&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Zl(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function yh(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let Bt=!0;const Ed=[];function _n(){Ed.push(Bt),Bt=!1}function xn(){const n=Ed.pop();Bt=n===void 0?!0:n}function Ya(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=qe;qe=void 0;try{t()}finally{qe=e}}}let ts=0;class wh{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mr{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!qe||!Bt||qe===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==qe)e=this.activeLink=new wh(qe,this),qe.deps?(e.prevDep=qe.depsTail,qe.depsTail.nextDep=e,qe.depsTail=e):qe.deps=qe.depsTail=e,Ld(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const o=e.nextDep;o.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=o),e.prevDep=qe.depsTail,e.nextDep=void 0,qe.depsTail.nextDep=e,qe.depsTail=e,qe.deps===e&&(qe.deps=o)}return e}trigger(t){this.version++,ts++,this.notify(t)}notify(t){Kl();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Jl()}}}function Ld(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let o=t.deps;o;o=o.nextDep)Ld(o)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const yl=new WeakMap,Mn=Symbol(""),wl=Symbol(""),ns=Symbol("");function ct(n,t,e){if(Bt&&qe){let o=yl.get(n);o||yl.set(n,o=new Map);let s=o.get(e);s||(o.set(e,s=new mr),s.map=o,s.key=e),s.track()}}function tn(n,t,e,o,s,r){const i=yl.get(n);if(!i){ts++;return}const l=a=>{a&&a.trigger()};if(Kl(),t==="clear")i.forEach(l);else{const a=me(n),u=a&&Yl(e);if(a&&e==="length"){const c=Number(o);i.forEach((f,m)=>{(m==="length"||m===ns||!Lt(m)&&m>=c)&&l(f)})}else switch((e!==void 0||i.has(void 0))&&l(i.get(e)),u&&l(i.get(ns)),t){case"add":a?u&&l(i.get("length")):(l(i.get(Mn)),Jn(n)&&l(i.get(wl)));break;case"delete":a||(l(i.get(Mn)),Jn(n)&&l(i.get(wl)));break;case"set":Jn(n)&&l(i.get(Mn));break}}Jl()}function Wn(n){const t=De(n);return t===n?t:(ct(t,"iterate",ns),It(n)?t:t.map(dt))}function br(n){return ct(n=De(n),"iterate",ns),n}const kh={__proto__:null,[Symbol.iterator](){return Nr(this,Symbol.iterator,dt)},concat(...n){return Wn(this).concat(...n.map(t=>me(t)?Wn(t):t))},entries(){return Nr(this,"entries",n=>(n[1]=dt(n[1]),n))},every(n,t){return Qt(this,"every",n,t,void 0,arguments)},filter(n,t){return Qt(this,"filter",n,t,e=>e.map(dt),arguments)},find(n,t){return Qt(this,"find",n,t,dt,arguments)},findIndex(n,t){return Qt(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Qt(this,"findLast",n,t,dt,arguments)},findLastIndex(n,t){return Qt(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Qt(this,"forEach",n,t,void 0,arguments)},includes(...n){return Hr(this,"includes",n)},indexOf(...n){return Hr(this,"indexOf",n)},join(n){return Wn(this).join(n)},lastIndexOf(...n){return Hr(this,"lastIndexOf",n)},map(n,t){return Qt(this,"map",n,t,void 0,arguments)},pop(){return xo(this,"pop")},push(...n){return xo(this,"push",n)},reduce(n,...t){return Ga(this,"reduce",n,t)},reduceRight(n,...t){return Ga(this,"reduceRight",n,t)},shift(){return xo(this,"shift")},some(n,t){return Qt(this,"some",n,t,void 0,arguments)},splice(...n){return xo(this,"splice",n)},toReversed(){return Wn(this).toReversed()},toSorted(n){return Wn(this).toSorted(n)},toSpliced(...n){return Wn(this).toSpliced(...n)},unshift(...n){return xo(this,"unshift",n)},values(){return Nr(this,"values",dt)}};function Nr(n,t,e){const o=br(n),s=o[t]();return o!==n&&!It(n)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=e(r.value)),r}),s}const Ch=Array.prototype;function Qt(n,t,e,o,s,r){const i=br(n),l=i!==n&&!It(n),a=i[t];if(a!==Ch[t]){const f=a.apply(n,r);return l?dt(f):f}let u=e;i!==n&&(l?u=function(f,m){return e.call(this,dt(f),m,n)}:e.length>2&&(u=function(f,m){return e.call(this,f,m,n)}));const c=a.call(i,u,o);return l&&s?s(c):c}function Ga(n,t,e,o){const s=br(n);let r=e;return s!==n&&(It(n)?e.length>3&&(r=function(i,l,a){return e.call(this,i,l,a,n)}):r=function(i,l,a){return e.call(this,i,dt(l),a,n)}),s[t](r,...o)}function Hr(n,t,e){const o=De(n);ct(o,"iterate",ns);const s=o[t](...e);return(s===-1||s===!1)&&ta(e[0])?(e[0]=De(e[0]),o[t](...e)):s}function xo(n,t,e=[]){_n(),Kl();const o=De(n)[t].apply(n,e);return Jl(),xn(),o}const _h=ql("__proto__,__v_isRef,__isVue"),Nd=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Lt));function xh(n){Lt(n)||(n=String(n));const t=De(this);return ct(t,"has",n),t.hasOwnProperty(n)}class Hd{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,o){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return o===(s?r?Mh:Ud:r?Fd:Vd).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(o)?t:void 0;const i=me(t);if(!s){let a;if(i&&(a=kh[e]))return a;if(e==="hasOwnProperty")return xh}const l=Reflect.get(t,e,ve(t)?t:o);return(Lt(e)?Nd.has(e):_h(e))||(s||ct(t,"get",e),r)?l:ve(l)?i&&Yl(e)?l:l.value:Fe(l)?s?qd(l):Jt(l):l}}class Wd extends Hd{constructor(t=!1){super(!1,t)}set(t,e,o,s){let r=t[e];if(!this._isShallow){const a=ln(r);if(!It(o)&&!ln(o)&&(r=De(r),o=De(o)),!me(t)&&ve(r)&&!ve(o))return a?!1:(r.value=o,!0)}const i=me(t)&&Yl(e)?Number(e)<t.length:Ee(t,e),l=Reflect.set(t,e,o,ve(t)?t:s);return t===De(s)&&(i?gt(o,r)&&tn(t,"set",e,o):tn(t,"add",e,o)),l}deleteProperty(t,e){const o=Ee(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&o&&tn(t,"delete",e,void 0),s}has(t,e){const o=Reflect.has(t,e);return(!Lt(e)||!Nd.has(e))&&ct(t,"has",e),o}ownKeys(t){return ct(t,"iterate",me(t)?"length":Mn),Reflect.ownKeys(t)}}class Sh extends Hd{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Ph=new Wd,Oh=new Sh,Th=new Wd(!0);const kl=n=>n,ws=n=>Reflect.getPrototypeOf(n);function $h(n,t,e){return function(...o){const s=this.__v_raw,r=De(s),i=Jn(r),l=n==="entries"||n===Symbol.iterator&&i,a=n==="keys"&&i,u=s[n](...o),c=e?kl:t?Cl:dt;return!t&&ct(r,"iterate",a?wl:Mn),{next(){const{value:f,done:m}=u.next();return m?{value:f,done:m}:{value:l?[c(f[0]),c(f[1])]:c(f),done:m}},[Symbol.iterator](){return this}}}}function ks(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function jh(n,t){const e={get(s){const r=this.__v_raw,i=De(r),l=De(s);n||(gt(s,l)&&ct(i,"get",s),ct(i,"get",l));const{has:a}=ws(i),u=t?kl:n?Cl:dt;if(a.call(i,s))return u(r.get(s));if(a.call(i,l))return u(r.get(l));r!==i&&r.get(s)},get size(){const s=this.__v_raw;return!n&&ct(De(s),"iterate",Mn),Reflect.get(s,"size",s)},has(s){const r=this.__v_raw,i=De(r),l=De(s);return n||(gt(s,l)&&ct(i,"has",s),ct(i,"has",l)),s===l?r.has(s):r.has(s)||r.has(l)},forEach(s,r){const i=this,l=i.__v_raw,a=De(l),u=t?kl:n?Cl:dt;return!n&&ct(a,"iterate",Mn),l.forEach((c,f)=>s.call(r,u(c),u(f),i))}};return nt(e,n?{add:ks("add"),set:ks("set"),delete:ks("delete"),clear:ks("clear")}:{add(s){!t&&!It(s)&&!ln(s)&&(s=De(s));const r=De(this);return ws(r).has.call(r,s)||(r.add(s),tn(r,"add",s,s)),this},set(s,r){!t&&!It(r)&&!ln(r)&&(r=De(r));const i=De(this),{has:l,get:a}=ws(i);let u=l.call(i,s);u||(s=De(s),u=l.call(i,s));const c=a.call(i,s);return i.set(s,r),u?gt(r,c)&&tn(i,"set",s,r):tn(i,"add",s,r),this},delete(s){const r=De(this),{has:i,get:l}=ws(r);let a=i.call(r,s);a||(s=De(s),a=i.call(r,s)),l&&l.call(r,s);const u=r.delete(s);return a&&tn(r,"delete",s,void 0),u},clear(){const s=De(this),r=s.size!==0,i=s.clear();return r&&tn(s,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=$h(s,n,t)}),e}function Ql(n,t){const e=jh(n,t);return(o,s,r)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?o:Reflect.get(Ee(e,s)&&s in o?e:o,s,r)}const Rh={get:Ql(!1,!1)},Ih={get:Ql(!1,!0)},Ah={get:Ql(!0,!1)};const Vd=new WeakMap,Fd=new WeakMap,Ud=new WeakMap,Mh=new WeakMap;function Dh(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Bh(n){return n.__v_skip||!Object.isExtensible(n)?0:Dh(ih(n))}function Jt(n){return ln(n)?n:ea(n,!1,Ph,Rh,Vd)}function Eh(n){return ea(n,!1,Th,Ih,Fd)}function qd(n){return ea(n,!0,Oh,Ah,Ud)}function ea(n,t,e,o,s){if(!Fe(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=s.get(n);if(r)return r;const i=Bh(n);if(i===0)return n;const l=new Proxy(n,i===2?o:e);return s.set(n,l),l}function Qn(n){return ln(n)?Qn(n.__v_raw):!!(n&&n.__v_isReactive)}function ln(n){return!!(n&&n.__v_isReadonly)}function It(n){return!!(n&&n.__v_isShallow)}function ta(n){return n?!!n.__v_raw:!1}function De(n){const t=n&&n.__v_raw;return t?De(t):n}function mt(n){return!Ee(n,"__v_skip")&&Object.isExtensible(n)&&Od(n,"__v_skip",!0),n}const dt=n=>Fe(n)?Jt(n):n,Cl=n=>Fe(n)?qd(n):n;function ve(n){return n?n.__v_isRef===!0:!1}function I(n){return zd(n,!1)}function Lh(n){return zd(n,!0)}function zd(n,t){return ve(n)?n:new Nh(n,t)}class Nh{constructor(t,e){this.dep=new mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:De(t),this._value=e?t:dt(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,o=this.__v_isShallow||It(t)||ln(t);t=o?t:De(t),gt(t,e)&&(this._rawValue=t,this._value=o?t:dt(t),this.dep.trigger())}}function J(n){return ve(n)?n.value:n}const Hh={get:(n,t,e)=>t==="__v_raw"?n:J(Reflect.get(n,t,e)),set:(n,t,e,o)=>{const s=n[t];return ve(s)&&!ve(e)?(s.value=e,!0):Reflect.set(n,t,e,o)}};function Xd(n){return Qn(n)?n:new Proxy(n,Hh)}class Wh{constructor(t){this.__v_isRef=!0,this._value=void 0;const e=this.dep=new mr,{get:o,set:s}=t(e.track.bind(e),e.trigger.bind(e));this._get=o,this._set=s}get value(){return this._value=this._get()}set value(t){this._set(t)}}function Vh(n){return new Wh(n)}class Fh{constructor(t,e,o){this.fn=t,this.setter=e,this._value=void 0,this.dep=new mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ts-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=o}notify(){if(this.flags|=16,!(this.flags&8)&&qe!==this)return Ad(this,!0),!0}get value(){const t=this.dep.track();return Bd(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Uh(n,t,e=!1){let o,s;return _e(n)?o=n:(o=n.get,s=n.set),new Fh(o,s,e)}const Cs={},Vs=new WeakMap;let Rn;function qh(n,t=!1,e=Rn){if(e){let o=Vs.get(e);o||Vs.set(e,o=[]),o.push(n)}}function zh(n,t,e=Ae){const{immediate:o,deep:s,once:r,scheduler:i,augmentJob:l,call:a}=e,u=p=>s?p:It(p)||s===!1||s===0?nn(p,1):nn(p);let c,f,m,b,x=!1,k=!1;if(ve(n)?(f=()=>n.value,x=It(n)):Qn(n)?(f=()=>u(n),x=!0):me(n)?(k=!0,x=n.some(p=>Qn(p)||It(p)),f=()=>n.map(p=>{if(ve(p))return p.value;if(Qn(p))return u(p);if(_e(p))return a?a(p,2):p()})):_e(n)?t?f=a?()=>a(n,2):n:f=()=>{if(m){_n();try{m()}finally{xn()}}const p=Rn;Rn=c;try{return a?a(n,3,[b]):n(b)}finally{Rn=p}}:f=Gt,t&&s){const p=f,O=s===!0?1/0:s;f=()=>nn(p(),O)}const y=bh(),w=()=>{c.stop(),y&&y.active&&Xl(y.effects,c)};if(r&&t){const p=t;t=(...O)=>{p(...O),w()}}let h=k?new Array(n.length).fill(Cs):Cs;const v=p=>{if(!(!(c.flags&1)||!c.dirty&&!p))if(t){const O=c.run();if(s||x||(k?O.some((M,A)=>gt(M,h[A])):gt(O,h))){m&&m();const M=Rn;Rn=c;try{const A=[O,h===Cs?void 0:k&&h[0]===Cs?[]:h,b];a?a(t,3,A):t(...A),h=O}finally{Rn=M}}}else c.run()};return l&&l(v),c=new Rd(f),c.scheduler=i?()=>i(v,!1):v,b=p=>qh(p,!1,c),m=c.onStop=()=>{const p=Vs.get(c);if(p){if(a)a(p,4);else for(const O of p)O();Vs.delete(c)}},t?o?v(!0):h=c.run():i?i(v.bind(null,!0),!0):c.run(),w.pause=c.pause.bind(c),w.resume=c.resume.bind(c),w.stop=w,w}function nn(n,t=1/0,e){if(t<=0||!Fe(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,ve(n))nn(n.value,t,e);else if(me(n))for(let o=0;o<n.length;o++)nn(n[o],t,e);else if(go(n)||Jn(n))n.forEach(o=>{nn(o,t,e)});else if(Sd(n)){for(const o in n)nn(n[o],t,e);for(const o of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,o)&&nn(n[o],t,e)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fs(n,t,e,o){try{return o?n(...o):n()}catch(s){ps(s,t,e)}}function Nt(n,t,e,o){if(_e(n)){const s=fs(n,t,e,o);return s&&_d(s)&&s.catch(r=>{ps(r,t,e)}),s}if(me(n)){const s=[];for(let r=0;r<n.length;r++)s.push(Nt(n[r],t,e,o));return s}}function ps(n,t,e,o=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:i}=t&&t.appContext.config||Ae;if(t){let l=t.parent;const a=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;l;){const c=l.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](n,a,u)===!1)return}l=l.parent}if(r){_n(),fs(r,null,10,[n,a,u]),xn();return}}Xh(n,e,s,o,i)}function Xh(n,t,e,o=!0,s=!1){if(s)throw n;console.error(n)}const ht=[];let qt=-1;const eo=[];let vn=null,Un=0;const Yd=Promise.resolve();let Fs=null;function yn(n){const t=Fs||Yd;return n?t.then(this?n.bind(this):n):t}function Yh(n){let t=qt+1,e=ht.length;for(;t<e;){const o=t+e>>>1,s=ht[o],r=os(s);r<n||r===n&&s.flags&2?t=o+1:e=o}return t}function na(n){if(!(n.flags&1)){const t=os(n),e=ht[ht.length-1];!e||!(n.flags&2)&&t>=os(e)?ht.push(n):ht.splice(Yh(t),0,n),n.flags|=1,Gd()}}function Gd(){Fs||(Fs=Yd.then(Jd))}function Gh(n){me(n)?eo.push(...n):vn&&n.id===-1?vn.splice(Un+1,0,n):n.flags&1||(eo.push(n),n.flags|=1),Gd()}function Ka(n,t,e=qt+1){for(;e<ht.length;e++){const o=ht[e];if(o&&o.flags&2){if(n&&o.id!==n.uid)continue;ht.splice(e,1),e--,o.flags&4&&(o.flags&=-2),o(),o.flags&4||(o.flags&=-2)}}}function Kd(n){if(eo.length){const t=[...new Set(eo)].sort((e,o)=>os(e)-os(o));if(eo.length=0,vn){vn.push(...t);return}for(vn=t,Un=0;Un<vn.length;Un++){const e=vn[Un];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}vn=null,Un=0}}const os=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Jd(n){try{for(qt=0;qt<ht.length;qt++){const t=ht[qt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fs(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;qt<ht.length;qt++){const t=ht[qt];t&&(t.flags&=-2)}qt=-1,ht.length=0,Kd(),Fs=null,(ht.length||eo.length)&&Jd()}}let at=null,Zd=null;function Us(n){const t=at;return at=n,Zd=n&&n.type.__scopeId||null,t}function ne(n,t=at,e){if(!t||n._n)return n;const o=(...s)=>{o._d&&au(-1);const r=Us(t);let i;try{i=n(...s)}finally{Us(r),o._d&&au(1)}return i};return o._n=!0,o._c=!0,o._d=!0,o}function Pe(n,t){if(at===null)return n;const e=_r(at),o=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[r,i,l,a=Ae]=t[s];r&&(_e(r)&&(r={mounted:r,updated:r}),r.deep&&nn(i),o.push({dir:r,instance:e,value:i,oldValue:void 0,arg:l,modifiers:a}))}return n}function On(n,t,e,o){const s=n.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){const l=s[i];r&&(l.oldValue=r[i].value);let a=l.dir[o];a&&(_n(),Nt(a,e,8,[n.el,l,n,t]),xn())}}const Qd=Symbol("_vte"),Kh=n=>n.__isTeleport,qo=n=>n&&(n.disabled||n.disabled===""),Ja=n=>n&&(n.defer||n.defer===""),Za=n=>typeof SVGElement<"u"&&n instanceof SVGElement,Qa=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,_l=(n,t)=>{const e=n&&n.to;return Je(e)?t?t(e):null:e},ef={name:"Teleport",__isTeleport:!0,process(n,t,e,o,s,r,i,l,a,u){const{mc:c,pc:f,pbc:m,o:{insert:b,querySelector:x,createText:k,createComment:y}}=u,w=qo(t.props);let{shapeFlag:h,children:v,dynamicChildren:p}=t;if(n==null){const O=t.el=k(""),M=t.anchor=k("");b(O,e,o),b(M,e,o);const A=(T,$)=>{h&16&&(s&&s.isCE&&(s.ce._teleportTarget=T),c(v,T,$,s,r,i,l,a))},g=()=>{const T=t.target=_l(t.props,x),$=nf(T,t,k,b);T&&(i!=="svg"&&Za(T)?i="svg":i!=="mathml"&&Qa(T)&&(i="mathml"),w||(A(T,$),$s(t,!1)))};w&&(A(e,M),$s(t,!0)),Ja(t.props)?st(()=>{g(),t.el.__isMounted=!0},r):g()}else{if(Ja(t.props)&&!n.el.__isMounted){st(()=>{ef.process(n,t,e,o,s,r,i,l,a,u),delete n.el.__isMounted},r);return}t.el=n.el,t.targetStart=n.targetStart;const O=t.anchor=n.anchor,M=t.target=n.target,A=t.targetAnchor=n.targetAnchor,g=qo(n.props),T=g?e:M,$=g?O:A;if(i==="svg"||Za(M)?i="svg":(i==="mathml"||Qa(M))&&(i="mathml"),p?(m(n.dynamicChildren,p,T,s,r,i,l),aa(n,t,!0)):a||f(n,t,T,$,s,r,i,l,!1),w)g?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):_s(t,e,O,u,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const W=t.target=_l(t.props,x);W&&_s(t,W,null,u,0)}else g&&_s(t,M,A,u,1);$s(t,w)}},remove(n,t,e,{um:o,o:{remove:s}},r){const{shapeFlag:i,children:l,anchor:a,targetStart:u,targetAnchor:c,target:f,props:m}=n;if(f&&(s(u),s(c)),r&&s(a),i&16){const b=r||!qo(m);for(let x=0;x<l.length;x++){const k=l[x];o(k,t,e,b,!!k.dynamicChildren)}}},move:_s,hydrate:Jh};function _s(n,t,e,{o:{insert:o},m:s},r=2){r===0&&o(n.targetAnchor,t,e);const{el:i,anchor:l,shapeFlag:a,children:u,props:c}=n,f=r===2;if(f&&o(i,t,e),(!f||qo(c))&&a&16)for(let m=0;m<u.length;m++)s(u[m],t,e,2);f&&o(l,t,e)}function Jh(n,t,e,o,s,r,{o:{nextSibling:i,parentNode:l,querySelector:a,insert:u,createText:c}},f){const m=t.target=_l(t.props,a);if(m){const b=qo(t.props),x=m._lpa||m.firstChild;if(t.shapeFlag&16)if(b)t.anchor=f(i(n),t,l(n),e,o,s,r),t.targetStart=x,t.targetAnchor=x&&i(x);else{t.anchor=i(n);let k=x;for(;k;){if(k&&k.nodeType===8){if(k.data==="teleport start anchor")t.targetStart=k;else if(k.data==="teleport anchor"){t.targetAnchor=k,m._lpa=t.targetAnchor&&i(t.targetAnchor);break}}k=i(k)}t.targetAnchor||nf(m,t,c,u),f(x&&i(x),t,m,e,o,s,r)}$s(t,b)}return t.anchor&&i(t.anchor)}const tf=ef;function $s(n,t){const e=n.ctx;if(e&&e.ut){let o,s;for(t?(o=n.el,s=n.anchor):(o=n.targetStart,s=n.targetAnchor);o&&o!==s;)o.nodeType===1&&o.setAttribute("data-v-owner",e.uid),o=o.nextSibling;e.ut()}}function nf(n,t,e,o){const s=t.targetStart=e(""),r=t.targetAnchor=e("");return s[Qd]=r,n&&(o(s,n),o(r,n)),r}const Vn=Symbol("_leaveCb"),xs=Symbol("_enterCb");function Zh(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ht(()=>{n.isMounted=!0}),ia(()=>{n.isUnmounting=!0}),n}const Pt=[Function,Array],Qh={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Pt,onEnter:Pt,onAfterEnter:Pt,onEnterCancelled:Pt,onBeforeLeave:Pt,onLeave:Pt,onAfterLeave:Pt,onLeaveCancelled:Pt,onBeforeAppear:Pt,onAppear:Pt,onAfterAppear:Pt,onAppearCancelled:Pt};function ev(n,t){const{leavingVNodes:e}=n;let o=e.get(t.type);return o||(o=Object.create(null),e.set(t.type,o)),o}function xl(n,t,e,o,s){const{appear:r,mode:i,persisted:l=!1,onBeforeEnter:a,onEnter:u,onAfterEnter:c,onEnterCancelled:f,onBeforeLeave:m,onLeave:b,onAfterLeave:x,onLeaveCancelled:k,onBeforeAppear:y,onAppear:w,onAfterAppear:h,onAppearCancelled:v}=t,p=String(n.key),O=ev(e,n),M=(T,$)=>{T&&Nt(T,o,9,$)},A=(T,$)=>{const W=$[1];M(T,$),me(T)?T.every(L=>L.length<=1)&&W():T.length<=1&&W()},g={mode:i,persisted:l,beforeEnter(T){let $=a;if(!e.isMounted)if(r)$=y||a;else return;T[Vn]&&T[Vn](!0);const W=O[p];W&&In(n,W)&&W.el[Vn]&&W.el[Vn](),M($,[T])},enter(T){let $=u,W=c,L=f;if(!e.isMounted)if(r)$=w||u,W=h||c,L=v||f;else return;let E=!1;const ee=T[xs]=U=>{E||(E=!0,U?M(L,[T]):M(W,[T]),g.delayedLeave&&g.delayedLeave(),T[xs]=void 0)};$?A($,[T,ee]):ee()},leave(T,$){const W=String(n.key);if(T[xs]&&T[xs](!0),e.isUnmounting)return $();M(m,[T]);let L=!1;const E=T[Vn]=ee=>{L||(L=!0,$(),ee?M(k,[T]):M(x,[T]),T[Vn]=void 0,O[W]===n&&delete O[W])};O[W]=n,b?A(b,[T,E]):E()},clone(T){return xl(T,t,e,o)}};return g}function so(n,t){n.shapeFlag&6&&n.component?(n.transition=t,so(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function of(n,t=!1,e){let o=[],s=0;for(let r=0;r<n.length;r++){let i=n[r];const l=e==null?i.key:String(e)+String(i.key!=null?i.key:r);i.type===ce?(i.patchFlag&128&&s++,o=o.concat(of(i.children,t,l))):(t||i.type!==Zt)&&o.push(l!=null?Cn(i,{key:l}):i)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}/*! #__NO_SIDE_EFFECTS__ */function Se(n,t){return _e(n)?nt({name:n.name},t,{setup:n}):n}function oa(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function tv(n){const t=Cr(),e=Lh(null);if(t){const s=t.refs===Ae?t.refs={}:t.refs;Object.defineProperty(s,n,{enumerable:!0,get:()=>e.value,set:r=>e.value=r})}return e}function qs(n,t,e,o,s=!1){if(me(n)){n.forEach((x,k)=>qs(x,t&&(me(t)?t[k]:t),e,o,s));return}if(Dn(o)&&!s){o.shapeFlag&512&&o.type.__asyncResolved&&o.component.subTree.component&&qs(n,t,e,o.component.subTree);return}const r=o.shapeFlag&4?_r(o.component):o.el,i=s?null:r,{i:l,r:a}=n,u=t&&t.r,c=l.refs===Ae?l.refs={}:l.refs,f=l.setupState,m=De(f),b=f===Ae?()=>!1:x=>Ee(m,x);if(u!=null&&u!==a&&(Je(u)?(c[u]=null,b(u)&&(f[u]=null)):ve(u)&&(u.value=null)),_e(a))fs(a,l,12,[i,c]);else{const x=Je(a),k=ve(a);if(x||k){const y=()=>{if(n.f){const w=x?b(a)?f[a]:c[a]:a.value;s?me(w)&&Xl(w,r):me(w)?w.includes(r)||w.push(r):x?(c[a]=[r],b(a)&&(f[a]=c[a])):(a.value=[r],n.k&&(c[n.k]=a.value))}else x?(c[a]=i,b(a)&&(f[a]=i)):k&&(a.value=i,n.k&&(c[n.k]=i))};i?(y.id=-1,st(y,e)):y()}}}const eu=n=>n.nodeType===8;gr().requestIdleCallback;gr().cancelIdleCallback;function nv(n,t){if(eu(n)&&n.data==="["){let e=1,o=n.nextSibling;for(;o;){if(o.nodeType===1){if(t(o)===!1)break}else if(eu(o))if(o.data==="]"){if(--e===0)break}else o.data==="["&&e++;o=o.nextSibling}}else t(n)}const Dn=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function tu(n){_e(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:o,delay:s=200,hydrate:r,timeout:i,suspensible:l=!0,onError:a}=n;let u=null,c,f=0;const m=()=>(f++,u=null,b()),b=()=>{let x;return u||(x=u=t().catch(k=>{if(k=k instanceof Error?k:new Error(String(k)),a)return new Promise((y,w)=>{a(k,()=>y(m()),()=>w(k),f+1)});throw k}).then(k=>x!==u&&u?u:(k&&(k.__esModule||k[Symbol.toStringTag]==="Module")&&(k=k.default),c=k,k)))};return Se({name:"AsyncComponentWrapper",__asyncLoader:b,__asyncHydrate(x,k,y){const w=r?()=>{const h=r(y,v=>nv(x,v));h&&(k.bum||(k.bum=[])).push(h)}:y;c?w():b().then(()=>!k.isUnmounted&&w())},get __asyncResolved(){return c},setup(){const x=lt;if(oa(x),c)return()=>Wr(c,x);const k=v=>{u=null,ps(v,x,13,!o)};if(l&&x.suspense||io)return b().then(v=>()=>Wr(v,x)).catch(v=>(k(v),()=>o?F(o,{error:v}):null));const y=I(!1),w=I(),h=I(!!s);return s&&setTimeout(()=>{h.value=!1},s),i!=null&&setTimeout(()=>{if(!y.value&&!w.value){const v=new Error(`Async component timed out after ${i}ms.`);k(v),w.value=v}},i),b().then(()=>{y.value=!0,x.parent&&sa(x.parent.vnode)&&x.parent.update()}).catch(v=>{k(v),w.value=v}),()=>{if(y.value&&c)return Wr(c,x);if(w.value&&o)return F(o,{error:w.value});if(e&&!h.value)return F(e)}}})}function Wr(n,t){const{ref:e,props:o,children:s,ce:r}=t.vnode,i=F(n,o,s);return i.ref=e,i.ce=r,delete t.vnode.ce,i}const sa=n=>n.type.__isKeepAlive,ov={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:t}){const e=Cr(),o=e.ctx;if(!o.renderer)return()=>{const h=t.default&&t.default();return h&&h.length===1?h[0]:h};const s=new Map,r=new Set;let i=null;const l=e.suspense,{renderer:{p:a,m:u,um:c,o:{createElement:f}}}=o,m=f("div");o.activate=(h,v,p,O,M)=>{const A=h.component;u(h,v,p,0,l),a(A.vnode,h,v,p,A,l,O,h.slotScopeIds,M),st(()=>{A.isDeactivated=!1,A.a&&Zn(A.a);const g=h.props&&h.props.onVnodeMounted;g&&Ot(g,A.parent,h)},l)},o.deactivate=h=>{const v=h.component;Ys(v.m),Ys(v.a),u(h,m,null,1,l),st(()=>{v.da&&Zn(v.da);const p=h.props&&h.props.onVnodeUnmounted;p&&Ot(p,v.parent,h),v.isDeactivated=!0},l)};function b(h){Vr(h),c(h,e,l,!0)}function x(h){s.forEach((v,p)=>{const O=du(v.type);O&&!h(O)&&k(p)})}function k(h){const v=s.get(h);v&&(!i||!In(v,i))?b(v):i&&Vr(i),s.delete(h),r.delete(h)}Xe(()=>[n.include,n.exclude],([h,v])=>{h&&x(p=>Do(h,p)),v&&x(p=>!Do(v,p))},{flush:"post",deep:!0});let y=null;const w=()=>{y!=null&&(Gs(e.subTree.type)?st(()=>{s.set(y,Ss(e.subTree))},e.subTree.suspense):s.set(y,Ss(e.subTree)))};return Ht(w),ra(w),ia(()=>{s.forEach(h=>{const{subTree:v,suspense:p}=e,O=Ss(v);if(h.type===O.type&&h.key===O.key){Vr(O);const M=O.component.da;M&&st(M,p);return}b(h)})}),()=>{if(y=null,!t.default)return i=null;const h=t.default(),v=h[0];if(h.length>1)return i=null,h;if(!ro(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return i=null,v;let p=Ss(v);if(p.type===Zt)return i=null,p;const O=p.type,M=du(Dn(p)?p.type.__asyncResolved||{}:O),{include:A,exclude:g,max:T}=n;if(A&&(!M||!Do(A,M))||g&&M&&Do(g,M))return p.shapeFlag&=-257,i=p,v;const $=p.key==null?O:p.key,W=s.get($);return p.el&&(p=Cn(p),v.shapeFlag&128&&(v.ssContent=p)),y=$,W?(p.el=W.el,p.component=W.component,p.transition&&so(p,p.transition),p.shapeFlag|=512,r.delete($),r.add($)):(r.add($),T&&r.size>parseInt(T,10)&&k(r.values().next().value)),p.shapeFlag|=256,i=p,Gs(v.type)?v:p}}},sv=ov;function Do(n,t){return me(n)?n.some(e=>Do(e,t)):Je(n)?n.split(",").includes(t):rh(n)?(n.lastIndex=0,n.test(t)):!1}function sf(n,t){lf(n,"a",t)}function rf(n,t){lf(n,"da",t)}function lf(n,t,e=lt){const o=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(yr(t,o,e),e){let s=e.parent;for(;s&&s.parent;)sa(s.parent.vnode)&&rv(o,t,e,s),s=s.parent}}function rv(n,t,e,o){const s=yr(t,n,o,!0);Sn(()=>{Xl(o[t],s)},e)}function Vr(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Ss(n){return n.shapeFlag&128?n.ssContent:n}function yr(n,t,e=lt,o=!1){if(e){const s=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...i)=>{_n();const l=vs(e),a=Nt(t,e,n,i);return l(),xn(),a});return o?s.unshift(r):s.push(r),r}}const un=n=>(t,e=lt)=>{(!io||n==="sp")&&yr(n,(...o)=>t(...o),e)},iv=un("bm"),Ht=un("m"),lv=un("bu"),ra=un("u"),ia=un("bum"),Sn=un("um"),av=un("sp"),uv=un("rtg"),cv=un("rtc");function dv(n,t=lt){yr("ec",n,t)}const fv=Symbol.for("v-ndc");function ze(n,t,e,o){let s;const r=e,i=me(n);if(i||Je(n)){const l=i&&Qn(n);let a=!1;l&&(a=!It(n),n=br(n)),s=new Array(n.length);for(let u=0,c=n.length;u<c;u++)s[u]=t(a?dt(n[u]):n[u],u,void 0,r)}else if(typeof n=="number"){s=new Array(n);for(let l=0;l<n;l++)s[l]=t(l+1,l,void 0,r)}else if(Fe(n))if(n[Symbol.iterator])s=Array.from(n,(l,a)=>t(l,a,void 0,r));else{const l=Object.keys(n);s=new Array(l.length);for(let a=0,u=l.length;a<u;a++){const c=l[a];s[a]=t(n[c],c,a,r)}}else s=[];return s}function Xt(n,t,e={},o,s){if(at.ce||at.parent&&Dn(at.parent)&&at.parent.ce)return t!=="default"&&(e.name=t),R(),pe(ce,null,[F("slot",e,o)],64);let r=n[t];r&&r._c&&(r._d=!1),R();const i=r&&af(r(e)),l=e.key||i&&i.key,a=pe(ce,{key:(l&&!Lt(l)?l:`_${t}`)+""},i||[],i&&n._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function af(n){return n.some(t=>ro(t)?!(t.type===Zt||t.type===ce&&!af(t.children)):!0)?n:null}const Sl=n=>n?Tf(n)?_r(n):Sl(n.parent):null,zo=nt(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Sl(n.parent),$root:n=>Sl(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>cf(n),$forceUpdate:n=>n.f||(n.f=()=>{na(n.update)}),$nextTick:n=>n.n||(n.n=yn.bind(n.proxy)),$watch:n=>Mv.bind(n)}),Fr=(n,t)=>n!==Ae&&!n.__isScriptSetup&&Ee(n,t),pv={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:o,data:s,props:r,accessCache:i,type:l,appContext:a}=n;let u;if(t[0]!=="$"){const b=i[t];if(b!==void 0)switch(b){case 1:return o[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(Fr(o,t))return i[t]=1,o[t];if(s!==Ae&&Ee(s,t))return i[t]=2,s[t];if((u=n.propsOptions[0])&&Ee(u,t))return i[t]=3,r[t];if(e!==Ae&&Ee(e,t))return i[t]=4,e[t];Pl&&(i[t]=0)}}const c=zo[t];let f,m;if(c)return t==="$attrs"&&ct(n.attrs,"get",""),c(n);if((f=l.__cssModules)&&(f=f[t]))return f;if(e!==Ae&&Ee(e,t))return i[t]=4,e[t];if(m=a.config.globalProperties,Ee(m,t))return m[t]},set({_:n},t,e){const{data:o,setupState:s,ctx:r}=n;return Fr(s,t)?(s[t]=e,!0):o!==Ae&&Ee(o,t)?(o[t]=e,!0):Ee(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:o,appContext:s,propsOptions:r}},i){let l;return!!e[i]||n!==Ae&&Ee(n,i)||Fr(t,i)||(l=r[0])&&Ee(l,i)||Ee(o,i)||Ee(zo,i)||Ee(s.config.globalProperties,i)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Ee(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function zs(n){return me(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}function Bn(n,t){return!n||!t?n||t:me(n)&&me(t)?n.concat(t):nt({},zs(n),zs(t))}let Pl=!0;function hv(n){const t=cf(n),e=n.proxy,o=n.ctx;Pl=!1,t.beforeCreate&&nu(t.beforeCreate,n,"bc");const{data:s,computed:r,methods:i,watch:l,provide:a,inject:u,created:c,beforeMount:f,mounted:m,beforeUpdate:b,updated:x,activated:k,deactivated:y,beforeDestroy:w,beforeUnmount:h,destroyed:v,unmounted:p,render:O,renderTracked:M,renderTriggered:A,errorCaptured:g,serverPrefetch:T,expose:$,inheritAttrs:W,components:L,directives:E,filters:ee}=t;if(u&&vv(u,o,null),i)for(const j in i){const q=i[j];_e(q)&&(o[j]=q.bind(e))}if(s){const j=s.call(e,e);Fe(j)&&(n.data=Jt(j))}if(Pl=!0,r)for(const j in r){const q=r[j],je=_e(q)?q.bind(e,e):_e(q.get)?q.get.bind(e,e):Gt,Y=!_e(q)&&_e(q.set)?q.set.bind(e):Gt,se=D({get:je,set:Y});Object.defineProperty(o,j,{enumerable:!0,configurable:!0,get:()=>se.value,set:we=>se.value=we})}if(l)for(const j in l)uf(l[j],o,e,j);if(a){const j=_e(a)?a.call(e):a;Reflect.ownKeys(j).forEach(q=>{ff(q,j[q])})}c&&nu(c,n,"c");function P(j,q){me(q)?q.forEach(je=>j(je.bind(e))):q&&j(q.bind(e))}if(P(iv,f),P(Ht,m),P(lv,b),P(ra,x),P(sf,k),P(rf,y),P(dv,g),P(cv,M),P(uv,A),P(ia,h),P(Sn,p),P(av,T),me($))if($.length){const j=n.exposed||(n.exposed={});$.forEach(q=>{Object.defineProperty(j,q,{get:()=>e[q],set:je=>e[q]=je})})}else n.exposed||(n.exposed={});O&&n.render===Gt&&(n.render=O),W!=null&&(n.inheritAttrs=W),L&&(n.components=L),E&&(n.directives=E),T&&oa(n)}function vv(n,t,e=Gt){me(n)&&(n=Ol(n));for(const o in n){const s=n[o];let r;Fe(s)?"default"in s?r=Et(s.from||o,s.default,!0):r=Et(s.from||o):r=Et(s),ve(r)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):t[o]=r}}function nu(n,t,e){Nt(me(n)?n.map(o=>o.bind(t.proxy)):n.bind(t.proxy),t,e)}function uf(n,t,e,o){let s=o.includes(".")?_f(e,o):()=>e[o];if(Je(n)){const r=t[n];_e(r)&&Xe(s,r)}else if(_e(n))Xe(s,n.bind(e));else if(Fe(n))if(me(n))n.forEach(r=>uf(r,t,e,o));else{const r=_e(n.handler)?n.handler.bind(e):t[n.handler];_e(r)&&Xe(s,r,n)}}function cf(n){const t=n.type,{mixins:e,extends:o}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=n.appContext,l=r.get(t);let a;return l?a=l:!s.length&&!e&&!o?a=t:(a={},s.length&&s.forEach(u=>Xs(a,u,i,!0)),Xs(a,t,i)),Fe(t)&&r.set(t,a),a}function Xs(n,t,e,o=!1){const{mixins:s,extends:r}=t;r&&Xs(n,r,e,!0),s&&s.forEach(i=>Xs(n,i,e,!0));for(const i in t)if(!(o&&i==="expose")){const l=gv[i]||e&&e[i];n[i]=l?l(n[i],t[i]):t[i]}return n}const gv={data:ou,props:su,emits:su,methods:Bo,computed:Bo,beforeCreate:ft,created:ft,beforeMount:ft,mounted:ft,beforeUpdate:ft,updated:ft,beforeDestroy:ft,beforeUnmount:ft,destroyed:ft,unmounted:ft,activated:ft,deactivated:ft,errorCaptured:ft,serverPrefetch:ft,components:Bo,directives:Bo,watch:bv,provide:ou,inject:mv};function ou(n,t){return t?n?function(){return nt(_e(n)?n.call(this,this):n,_e(t)?t.call(this,this):t)}:t:n}function mv(n,t){return Bo(Ol(n),Ol(t))}function Ol(n){if(me(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function ft(n,t){return n?[...new Set([].concat(n,t))]:t}function Bo(n,t){return n?nt(Object.create(null),n,t):t}function su(n,t){return n?me(n)&&me(t)?[...new Set([...n,...t])]:nt(Object.create(null),zs(n),zs(t??{})):t}function bv(n,t){if(!n)return t;if(!t)return n;const e=nt(Object.create(null),n);for(const o in t)e[o]=ft(n[o],t[o]);return e}function df(){return{app:null,config:{isNativeTag:oh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yv=0;function wv(n,t){return function(o,s=null){_e(o)||(o=nt({},o)),s!=null&&!Fe(s)&&(s=null);const r=df(),i=new WeakSet,l=[];let a=!1;const u=r.app={_uid:yv++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:eg,get config(){return r.config},set config(c){},use(c,...f){return i.has(c)||(c&&_e(c.install)?(i.add(c),c.install(u,...f)):_e(c)&&(i.add(c),c(u,...f))),u},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),u},component(c,f){return f?(r.components[c]=f,u):r.components[c]},directive(c,f){return f?(r.directives[c]=f,u):r.directives[c]},mount(c,f,m){if(!a){const b=u._ceVNode||F(o,s);return b.appContext=r,m===!0?m="svg":m===!1&&(m=void 0),n(b,c,m),a=!0,u._container=c,c.__vue_app__=u,_r(b.component)}},onUnmount(c){l.push(c)},unmount(){a&&(Nt(l,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(c,f){return r.provides[c]=f,u},runWithContext(c){const f=to;to=u;try{return c()}finally{to=f}}};return u}}let to=null;function ff(n,t){if(lt){let e=lt.provides;const o=lt.parent&&lt.parent.provides;o===e&&(e=lt.provides=Object.create(o)),e[n]=t}}function Et(n,t,e=!1){const o=lt||at;if(o||to){const s=to?to._context.provides:o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&_e(t)?t.call(o&&o.proxy):t}}const pf={},hf=()=>Object.create(pf),vf=n=>Object.getPrototypeOf(n)===pf;function kv(n,t,e,o=!1){const s={},r=hf();n.propsDefaults=Object.create(null),gf(n,t,s,r);for(const i in n.propsOptions[0])i in s||(s[i]=void 0);e?n.props=o?s:Eh(s):n.type.props?n.props=s:n.props=r,n.attrs=r}function Cv(n,t,e,o){const{props:s,attrs:r,vnode:{patchFlag:i}}=n,l=De(s),[a]=n.propsOptions;let u=!1;if((o||i>0)&&!(i&16)){if(i&8){const c=n.vnode.dynamicProps;for(let f=0;f<c.length;f++){let m=c[f];if(wr(n.emitsOptions,m))continue;const b=t[m];if(a)if(Ee(r,m))b!==r[m]&&(r[m]=b,u=!0);else{const x=rn(m);s[x]=Tl(a,l,x,b,n,!1)}else b!==r[m]&&(r[m]=b,u=!0)}}}else{gf(n,t,s,r)&&(u=!0);let c;for(const f in l)(!t||!Ee(t,f)&&((c=an(f))===f||!Ee(t,c)))&&(a?e&&(e[f]!==void 0||e[c]!==void 0)&&(s[f]=Tl(a,l,f,void 0,n,!0)):delete s[f]);if(r!==l)for(const f in r)(!t||!Ee(t,f))&&(delete r[f],u=!0)}u&&tn(n.attrs,"set","")}function gf(n,t,e,o){const[s,r]=n.propsOptions;let i=!1,l;if(t)for(let a in t){if(Vo(a))continue;const u=t[a];let c;s&&Ee(s,c=rn(a))?!r||!r.includes(c)?e[c]=u:(l||(l={}))[c]=u:wr(n.emitsOptions,a)||(!(a in o)||u!==o[a])&&(o[a]=u,i=!0)}if(r){const a=De(e),u=l||Ae;for(let c=0;c<r.length;c++){const f=r[c];e[f]=Tl(s,a,f,u[f],n,!Ee(u,f))}}return i}function Tl(n,t,e,o,s,r){const i=n[e];if(i!=null){const l=Ee(i,"default");if(l&&o===void 0){const a=i.default;if(i.type!==Function&&!i.skipFactory&&_e(a)){const{propsDefaults:u}=s;if(e in u)o=u[e];else{const c=vs(s);o=u[e]=a.call(null,t),c()}}else o=a;s.ce&&s.ce._setProp(e,o)}i[0]&&(r&&!l?o=!1:i[1]&&(o===""||o===an(e))&&(o=!0))}return o}const _v=new WeakMap;function mf(n,t,e=!1){const o=e?_v:t.propsCache,s=o.get(n);if(s)return s;const r=n.props,i={},l=[];let a=!1;if(!_e(n)){const c=f=>{a=!0;const[m,b]=mf(f,t,!0);nt(i,m),b&&l.push(...b)};!e&&t.mixins.length&&t.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!r&&!a)return Fe(n)&&o.set(n,Kn),Kn;if(me(r))for(let c=0;c<r.length;c++){const f=rn(r[c]);ru(f)&&(i[f]=Ae)}else if(r)for(const c in r){const f=rn(c);if(ru(f)){const m=r[c],b=i[f]=me(m)||_e(m)?{type:m}:nt({},m),x=b.type;let k=!1,y=!0;if(me(x))for(let w=0;w<x.length;++w){const h=x[w],v=_e(h)&&h.name;if(v==="Boolean"){k=!0;break}else v==="String"&&(y=!1)}else k=_e(x)&&x.name==="Boolean";b[0]=k,b[1]=y,(k||Ee(b,"default"))&&l.push(f)}}const u=[i,l];return Fe(n)&&o.set(n,u),u}function ru(n){return n[0]!=="$"&&!Vo(n)}const bf=n=>n[0]==="_"||n==="$stable",la=n=>me(n)?n.map(zt):[zt(n)],xv=(n,t,e)=>{if(t._n)return t;const o=ne((...s)=>la(t(...s)),e);return o._c=!1,o},yf=(n,t,e)=>{const o=n._ctx;for(const s in n){if(bf(s))continue;const r=n[s];if(_e(r))t[s]=xv(s,r,o);else if(r!=null){const i=la(r);t[s]=()=>i}}},wf=(n,t)=>{const e=la(t);n.slots.default=()=>e},kf=(n,t,e)=>{for(const o in t)(e||o!=="_")&&(n[o]=t[o])},Sv=(n,t,e)=>{const o=n.slots=hf();if(n.vnode.shapeFlag&32){const s=t._;s?(kf(o,t,e),e&&Od(o,"_",s,!0)):yf(t,o)}else t&&wf(n,t)},Pv=(n,t,e)=>{const{vnode:o,slots:s}=n;let r=!0,i=Ae;if(o.shapeFlag&32){const l=t._;l?e&&l===1?r=!1:kf(s,t,e):(r=!t.$stable,yf(t,s)),i=t}else t&&(wf(n,t),i={default:1});if(r)for(const l in s)!bf(l)&&i[l]==null&&delete s[l]},st=Hv;function Ov(n){return Tv(n)}function Tv(n,t){const e=gr();e.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:i,createText:l,createComment:a,setText:u,setElementText:c,parentNode:f,nextSibling:m,setScopeId:b=Gt,insertStaticContent:x}=n,k=(C,S,B,X=null,z=null,G=null,re=void 0,te=null,ie=!!S.dynamicChildren)=>{if(C===S)return;C&&!In(C,S)&&(X=oe(C),we(C,z,G,!0),C=null),S.patchFlag===-2&&(ie=!1,S.dynamicChildren=null);const{type:K,ref:ye,shapeFlag:ae}=S;switch(K){case kr:y(C,S,B,X);break;case Zt:w(C,S,B,X);break;case js:C==null&&h(S,B,X,re);break;case ce:L(C,S,B,X,z,G,re,te,ie);break;default:ae&1?O(C,S,B,X,z,G,re,te,ie):ae&6?E(C,S,B,X,z,G,re,te,ie):(ae&64||ae&128)&&K.process(C,S,B,X,z,G,re,te,ie,H)}ye!=null&&z&&qs(ye,C&&C.ref,G,S||C,!S)},y=(C,S,B,X)=>{if(C==null)o(S.el=l(S.children),B,X);else{const z=S.el=C.el;S.children!==C.children&&u(z,S.children)}},w=(C,S,B,X)=>{C==null?o(S.el=a(S.children||""),B,X):S.el=C.el},h=(C,S,B,X)=>{[C.el,C.anchor]=x(C.children,S,B,X,C.el,C.anchor)},v=({el:C,anchor:S},B,X)=>{let z;for(;C&&C!==S;)z=m(C),o(C,B,X),C=z;o(S,B,X)},p=({el:C,anchor:S})=>{let B;for(;C&&C!==S;)B=m(C),s(C),C=B;s(S)},O=(C,S,B,X,z,G,re,te,ie)=>{S.type==="svg"?re="svg":S.type==="math"&&(re="mathml"),C==null?M(S,B,X,z,G,re,te,ie):T(C,S,z,G,re,te,ie)},M=(C,S,B,X,z,G,re,te)=>{let ie,K;const{props:ye,shapeFlag:ae,transition:be,dirs:ke}=C;if(ie=C.el=i(C.type,G,ye&&ye.is,ye),ae&8?c(ie,C.children):ae&16&&g(C.children,ie,null,X,z,Ur(C,G),re,te),ke&&On(C,null,X,"created"),A(ie,C,C.scopeId,re,X),ye){for(const Ue in ye)Ue!=="value"&&!Vo(Ue)&&r(ie,Ue,null,ye[Ue],G,X);"value"in ye&&r(ie,"value",null,ye.value,G),(K=ye.onVnodeBeforeMount)&&Ot(K,X,C)}ke&&On(C,null,X,"beforeMount");const $e=$v(z,be);$e&&be.beforeEnter(ie),o(ie,S,B),((K=ye&&ye.onVnodeMounted)||$e||ke)&&st(()=>{K&&Ot(K,X,C),$e&&be.enter(ie),ke&&On(C,null,X,"mounted")},z)},A=(C,S,B,X,z)=>{if(B&&b(C,B),X)for(let G=0;G<X.length;G++)b(C,X[G]);if(z){let G=z.subTree;if(S===G||Gs(G.type)&&(G.ssContent===S||G.ssFallback===S)){const re=z.vnode;A(C,re,re.scopeId,re.slotScopeIds,z.parent)}}},g=(C,S,B,X,z,G,re,te,ie=0)=>{for(let K=ie;K<C.length;K++){const ye=C[K]=te?gn(C[K]):zt(C[K]);k(null,ye,S,B,X,z,G,re,te)}},T=(C,S,B,X,z,G,re)=>{const te=S.el=C.el;let{patchFlag:ie,dynamicChildren:K,dirs:ye}=S;ie|=C.patchFlag&16;const ae=C.props||Ae,be=S.props||Ae;let ke;if(B&&Tn(B,!1),(ke=be.onVnodeBeforeUpdate)&&Ot(ke,B,S,C),ye&&On(S,C,B,"beforeUpdate"),B&&Tn(B,!0),(ae.innerHTML&&be.innerHTML==null||ae.textContent&&be.textContent==null)&&c(te,""),K?$(C.dynamicChildren,K,te,B,X,Ur(S,z),G):re||q(C,S,te,null,B,X,Ur(S,z),G,!1),ie>0){if(ie&16)W(te,ae,be,B,z);else if(ie&2&&ae.class!==be.class&&r(te,"class",null,be.class,z),ie&4&&r(te,"style",ae.style,be.style,z),ie&8){const $e=S.dynamicProps;for(let Ue=0;Ue<$e.length;Ue++){const He=$e[Ue],bt=ae[He],vt=be[He];(vt!==bt||He==="value")&&r(te,He,bt,vt,z,B)}}ie&1&&C.children!==S.children&&c(te,S.children)}else!re&&K==null&&W(te,ae,be,B,z);((ke=be.onVnodeUpdated)||ye)&&st(()=>{ke&&Ot(ke,B,S,C),ye&&On(S,C,B,"updated")},X)},$=(C,S,B,X,z,G,re)=>{for(let te=0;te<S.length;te++){const ie=C[te],K=S[te],ye=ie.el&&(ie.type===ce||!In(ie,K)||ie.shapeFlag&70)?f(ie.el):B;k(ie,K,ye,null,X,z,G,re,!0)}},W=(C,S,B,X,z)=>{if(S!==B){if(S!==Ae)for(const G in S)!Vo(G)&&!(G in B)&&r(C,G,S[G],null,z,X);for(const G in B){if(Vo(G))continue;const re=B[G],te=S[G];re!==te&&G!=="value"&&r(C,G,te,re,z,X)}"value"in B&&r(C,"value",S.value,B.value,z)}},L=(C,S,B,X,z,G,re,te,ie)=>{const K=S.el=C?C.el:l(""),ye=S.anchor=C?C.anchor:l("");let{patchFlag:ae,dynamicChildren:be,slotScopeIds:ke}=S;ke&&(te=te?te.concat(ke):ke),C==null?(o(K,B,X),o(ye,B,X),g(S.children||[],B,ye,z,G,re,te,ie)):ae>0&&ae&64&&be&&C.dynamicChildren?($(C.dynamicChildren,be,B,z,G,re,te),(S.key!=null||z&&S===z.subTree)&&aa(C,S,!0)):q(C,S,B,ye,z,G,re,te,ie)},E=(C,S,B,X,z,G,re,te,ie)=>{S.slotScopeIds=te,C==null?S.shapeFlag&512?z.ctx.activate(S,B,X,re,ie):ee(S,B,X,z,G,re,ie):U(C,S,ie)},ee=(C,S,B,X,z,G,re)=>{const te=C.component=Yv(C,X,z);if(sa(C)&&(te.ctx.renderer=H),Gv(te,!1,re),te.asyncDep){if(z&&z.registerDep(te,P,re),!C.el){const ie=te.subTree=F(Zt);w(null,ie,S,B)}}else P(te,C,S,B,z,G,re)},U=(C,S,B)=>{const X=S.component=C.component;if(Lv(C,S,B))if(X.asyncDep&&!X.asyncResolved){j(X,S,B);return}else X.next=S,X.update();else S.el=C.el,X.vnode=S},P=(C,S,B,X,z,G,re)=>{const te=()=>{if(C.isMounted){let{next:ae,bu:be,u:ke,parent:$e,vnode:Ue}=C;{const Vt=Cf(C);if(Vt){ae&&(ae.el=Ue.el,j(C,ae,re)),Vt.asyncDep.then(()=>{C.isUnmounted||te()});return}}let He=ae,bt;Tn(C,!1),ae?(ae.el=Ue.el,j(C,ae,re)):ae=Ue,be&&Zn(be),(bt=ae.props&&ae.props.onVnodeBeforeUpdate)&&Ot(bt,$e,ae,Ue),Tn(C,!0);const vt=iu(C),Wt=C.subTree;C.subTree=vt,k(Wt,vt,f(Wt.el),oe(Wt),C,z,G),ae.el=vt.el,He===null&&Nv(C,vt.el),ke&&st(ke,z),(bt=ae.props&&ae.props.onVnodeUpdated)&&st(()=>Ot(bt,$e,ae,Ue),z)}else{let ae;const{el:be,props:ke}=S,{bm:$e,m:Ue,parent:He,root:bt,type:vt}=C,Wt=Dn(S);Tn(C,!1),$e&&Zn($e),!Wt&&(ae=ke&&ke.onVnodeBeforeMount)&&Ot(ae,He,S),Tn(C,!0);{bt.ce&&bt.ce._injectChildStyle(vt);const Vt=C.subTree=iu(C);k(null,Vt,B,X,C,z,G),S.el=Vt.el}if(Ue&&st(Ue,z),!Wt&&(ae=ke&&ke.onVnodeMounted)){const Vt=S;st(()=>Ot(ae,He,Vt),z)}(S.shapeFlag&256||He&&Dn(He.vnode)&&He.vnode.shapeFlag&256)&&C.a&&st(C.a,z),C.isMounted=!0,S=B=X=null}};C.scope.on();const ie=C.effect=new Rd(te);C.scope.off();const K=C.update=ie.run.bind(ie),ye=C.job=ie.runIfDirty.bind(ie);ye.i=C,ye.id=C.uid,ie.scheduler=()=>na(ye),Tn(C,!0),K()},j=(C,S,B)=>{S.component=C;const X=C.vnode.props;C.vnode=S,C.next=null,Cv(C,S.props,X,B),Pv(C,S.children,B),_n(),Ka(C),xn()},q=(C,S,B,X,z,G,re,te,ie=!1)=>{const K=C&&C.children,ye=C?C.shapeFlag:0,ae=S.children,{patchFlag:be,shapeFlag:ke}=S;if(be>0){if(be&128){Y(K,ae,B,X,z,G,re,te,ie);return}else if(be&256){je(K,ae,B,X,z,G,re,te,ie);return}}ke&8?(ye&16&&Ze(K,z,G),ae!==K&&c(B,ae)):ye&16?ke&16?Y(K,ae,B,X,z,G,re,te,ie):Ze(K,z,G,!0):(ye&8&&c(B,""),ke&16&&g(ae,B,X,z,G,re,te,ie))},je=(C,S,B,X,z,G,re,te,ie)=>{C=C||Kn,S=S||Kn;const K=C.length,ye=S.length,ae=Math.min(K,ye);let be;for(be=0;be<ae;be++){const ke=S[be]=ie?gn(S[be]):zt(S[be]);k(C[be],ke,B,null,z,G,re,te,ie)}K>ye?Ze(C,z,G,!0,!1,ae):g(S,B,X,z,G,re,te,ie,ae)},Y=(C,S,B,X,z,G,re,te,ie)=>{let K=0;const ye=S.length;let ae=C.length-1,be=ye-1;for(;K<=ae&&K<=be;){const ke=C[K],$e=S[K]=ie?gn(S[K]):zt(S[K]);if(In(ke,$e))k(ke,$e,B,null,z,G,re,te,ie);else break;K++}for(;K<=ae&&K<=be;){const ke=C[ae],$e=S[be]=ie?gn(S[be]):zt(S[be]);if(In(ke,$e))k(ke,$e,B,null,z,G,re,te,ie);else break;ae--,be--}if(K>ae){if(K<=be){const ke=be+1,$e=ke<ye?S[ke].el:X;for(;K<=be;)k(null,S[K]=ie?gn(S[K]):zt(S[K]),B,$e,z,G,re,te,ie),K++}}else if(K>be)for(;K<=ae;)we(C[K],z,G,!0),K++;else{const ke=K,$e=K,Ue=new Map;for(K=$e;K<=be;K++){const yt=S[K]=ie?gn(S[K]):zt(S[K]);yt.key!=null&&Ue.set(yt.key,K)}let He,bt=0;const vt=be-$e+1;let Wt=!1,Vt=0;const _o=new Array(vt);for(K=0;K<vt;K++)_o[K]=0;for(K=ke;K<=ae;K++){const yt=C[K];if(bt>=vt){we(yt,z,G,!0);continue}let Ft;if(yt.key!=null)Ft=Ue.get(yt.key);else for(He=$e;He<=be;He++)if(_o[He-$e]===0&&In(yt,S[He])){Ft=He;break}Ft===void 0?we(yt,z,G,!0):(_o[Ft-$e]=K+1,Ft>=Vt?Vt=Ft:Wt=!0,k(yt,S[Ft],B,null,z,G,re,te,ie),bt++)}const Ua=Wt?jv(_o):Kn;for(He=Ua.length-1,K=vt-1;K>=0;K--){const yt=$e+K,Ft=S[yt],qa=yt+1<ye?S[yt+1].el:X;_o[K]===0?k(null,Ft,B,qa,z,G,re,te,ie):Wt&&(He<0||K!==Ua[He]?se(Ft,B,qa,2):He--)}}},se=(C,S,B,X,z=null)=>{const{el:G,type:re,transition:te,children:ie,shapeFlag:K}=C;if(K&6){se(C.component.subTree,S,B,X);return}if(K&128){C.suspense.move(S,B,X);return}if(K&64){re.move(C,S,B,H);return}if(re===ce){o(G,S,B);for(let ae=0;ae<ie.length;ae++)se(ie[ae],S,B,X);o(C.anchor,S,B);return}if(re===js){v(C,S,B);return}if(X!==2&&K&1&&te)if(X===0)te.beforeEnter(G),o(G,S,B),st(()=>te.enter(G),z);else{const{leave:ae,delayLeave:be,afterLeave:ke}=te,$e=()=>o(G,S,B),Ue=()=>{ae(G,()=>{$e(),ke&&ke()})};be?be(G,$e,Ue):Ue()}else o(G,S,B)},we=(C,S,B,X=!1,z=!1)=>{const{type:G,props:re,ref:te,children:ie,dynamicChildren:K,shapeFlag:ye,patchFlag:ae,dirs:be,cacheIndex:ke}=C;if(ae===-2&&(z=!1),te!=null&&qs(te,null,B,C,!0),ke!=null&&(S.renderCache[ke]=void 0),ye&256){S.ctx.deactivate(C);return}const $e=ye&1&&be,Ue=!Dn(C);let He;if(Ue&&(He=re&&re.onVnodeBeforeUnmount)&&Ot(He,S,C),ye&6)ot(C.component,B,X);else{if(ye&128){C.suspense.unmount(B,X);return}$e&&On(C,null,S,"beforeUnmount"),ye&64?C.type.remove(C,S,B,H,X):K&&!K.hasOnce&&(G!==ce||ae>0&&ae&64)?Ze(K,S,B,!1,!0):(G===ce&&ae&384||!z&&ye&16)&&Ze(ie,S,B),X&&Te(C)}(Ue&&(He=re&&re.onVnodeUnmounted)||$e)&&st(()=>{He&&Ot(He,S,C),$e&&On(C,null,S,"unmounted")},B)},Te=C=>{const{type:S,el:B,anchor:X,transition:z}=C;if(S===ce){Ce(B,X);return}if(S===js){p(C);return}const G=()=>{s(B),z&&!z.persisted&&z.afterLeave&&z.afterLeave()};if(C.shapeFlag&1&&z&&!z.persisted){const{leave:re,delayLeave:te}=z,ie=()=>re(B,G);te?te(C.el,G,ie):ie()}else G()},Ce=(C,S)=>{let B;for(;C!==S;)B=m(C),s(C),C=B;s(S)},ot=(C,S,B)=>{const{bum:X,scope:z,job:G,subTree:re,um:te,m:ie,a:K}=C;Ys(ie),Ys(K),X&&Zn(X),z.stop(),G&&(G.flags|=8,we(re,C,S,B)),te&&st(te,S),st(()=>{C.isUnmounted=!0},S),S&&S.pendingBranch&&!S.isUnmounted&&C.asyncDep&&!C.asyncResolved&&C.suspenseId===S.pendingId&&(S.deps--,S.deps===0&&S.resolve())},Ze=(C,S,B,X=!1,z=!1,G=0)=>{for(let re=G;re<C.length;re++)we(C[re],S,B,X,z)},oe=C=>{if(C.shapeFlag&6)return oe(C.component.subTree);if(C.shapeFlag&128)return C.suspense.next();const S=m(C.anchor||C.el),B=S&&S[Qd];return B?m(B):S};let xe=!1;const Z=(C,S,B)=>{C==null?S._vnode&&we(S._vnode,null,null,!0):k(S._vnode||null,C,S,null,null,null,B),S._vnode=C,xe||(xe=!0,Ka(),Kd(),xe=!1)},H={p:k,um:we,m:se,r:Te,mt:ee,mc:g,pc:q,pbc:$,n:oe,o:n};return{render:Z,hydrate:void 0,createApp:wv(Z)}}function Ur({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Tn({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function $v(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function aa(n,t,e=!1){const o=n.children,s=t.children;if(me(o)&&me(s))for(let r=0;r<o.length;r++){const i=o[r];let l=s[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[r]=gn(s[r]),l.el=i.el),!e&&l.patchFlag!==-2&&aa(i,l)),l.type===kr&&(l.el=i.el)}}function jv(n){const t=n.slice(),e=[0];let o,s,r,i,l;const a=n.length;for(o=0;o<a;o++){const u=n[o];if(u!==0){if(s=e[e.length-1],n[s]<u){t[o]=s,e.push(o);continue}for(r=0,i=e.length-1;r<i;)l=r+i>>1,n[e[l]]<u?r=l+1:i=l;u<n[e[r]]&&(r>0&&(t[o]=e[r-1]),e[r]=o)}}for(r=e.length,i=e[r-1];r-- >0;)e[r]=i,i=t[i];return e}function Cf(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Cf(t)}function Ys(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const Rv=Symbol.for("v-scx"),Iv=()=>Et(Rv);function Av(n,t){return ua(n,null,{flush:"sync"})}function Xe(n,t,e){return ua(n,t,e)}function ua(n,t,e=Ae){const{immediate:o,deep:s,flush:r,once:i}=e,l=nt({},e),a=t&&o||!t&&r!=="post";let u;if(io){if(r==="sync"){const b=Iv();u=b.__watcherHandles||(b.__watcherHandles=[])}else if(!a){const b=()=>{};return b.stop=Gt,b.resume=Gt,b.pause=Gt,b}}const c=lt;l.call=(b,x,k)=>Nt(b,c,x,k);let f=!1;r==="post"?l.scheduler=b=>{st(b,c&&c.suspense)}:r!=="sync"&&(f=!0,l.scheduler=(b,x)=>{x?b():na(b)}),l.augmentJob=b=>{t&&(b.flags|=4),f&&(b.flags|=2,c&&(b.id=c.uid,b.i=c))};const m=zh(n,t,l);return io&&(u?u.push(m):a&&m()),m}function Mv(n,t,e){const o=this.proxy,s=Je(n)?n.includes(".")?_f(o,n):()=>o[n]:n.bind(o,o);let r;_e(t)?r=t:(r=t.handler,e=t);const i=vs(this),l=ua(s,r.bind(o),e);return i(),l}function _f(n,t){const e=t.split(".");return()=>{let o=n;for(let s=0;s<e.length&&o;s++)o=o[e[s]];return o}}function hs(n,t,e=Ae){const o=Cr(),s=rn(t),r=an(t),i=xf(n,s),l=Vh((a,u)=>{let c,f=Ae,m;return Av(()=>{const b=n[s];gt(c,b)&&(c=b,u())}),{get(){return a(),e.get?e.get(c):c},set(b){const x=e.set?e.set(b):b;if(!gt(x,c)&&!(f!==Ae&&gt(b,f)))return;const k=o.vnode.props;k&&(t in k||s in k||r in k)&&(`onUpdate:${t}`in k||`onUpdate:${s}`in k||`onUpdate:${r}`in k)||(c=b,u()),o.emit(`update:${t}`,x),gt(b,x)&&gt(b,f)&&!gt(x,m)&&u(),f=b,m=x}}});return l[Symbol.iterator]=()=>{let a=0;return{next(){return a<2?{value:a++?i||Ae:l,done:!1}:{done:!0}}}},l}const xf=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${rn(t)}Modifiers`]||n[`${an(t)}Modifiers`];function Dv(n,t,...e){if(n.isUnmounted)return;const o=n.vnode.props||Ae;let s=e;const r=t.startsWith("update:"),i=r&&xf(o,t.slice(7));i&&(i.trim&&(s=e.map(c=>Je(c)?c.trim():c)),i.number&&(s=e.map(Ws)));let l,a=o[l=Br(t)]||o[l=Br(rn(t))];!a&&r&&(a=o[l=Br(an(t))]),a&&Nt(a,n,6,s);const u=o[l+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[l])return;n.emitted[l]=!0,Nt(u,n,6,s)}}function Sf(n,t,e=!1){const o=t.emitsCache,s=o.get(n);if(s!==void 0)return s;const r=n.emits;let i={},l=!1;if(!_e(n)){const a=u=>{const c=Sf(u,t,!0);c&&(l=!0,nt(i,c))};!e&&t.mixins.length&&t.mixins.forEach(a),n.extends&&a(n.extends),n.mixins&&n.mixins.forEach(a)}return!r&&!l?(Fe(n)&&o.set(n,null),null):(me(r)?r.forEach(a=>i[a]=null):nt(i,r),Fe(n)&&o.set(n,i),i)}function wr(n,t){return!n||!hr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ee(n,t[0].toLowerCase()+t.slice(1))||Ee(n,an(t))||Ee(n,t))}function iu(n){const{type:t,vnode:e,proxy:o,withProxy:s,propsOptions:[r],slots:i,attrs:l,emit:a,render:u,renderCache:c,props:f,data:m,setupState:b,ctx:x,inheritAttrs:k}=n,y=Us(n);let w,h;try{if(e.shapeFlag&4){const p=s||o,O=p;w=zt(u.call(O,p,c,f,b,m,x)),h=l}else{const p=t;w=zt(p.length>1?p(f,{attrs:l,slots:i,emit:a}):p(f,null)),h=t.props?l:Bv(l)}}catch(p){Xo.length=0,ps(p,n,1),w=F(Zt)}let v=w;if(h&&k!==!1){const p=Object.keys(h),{shapeFlag:O}=v;p.length&&O&7&&(r&&p.some(zl)&&(h=Ev(h,r)),v=Cn(v,h,!1,!0))}return e.dirs&&(v=Cn(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(e.dirs):e.dirs),e.transition&&so(v,e.transition),w=v,Us(y),w}const Bv=n=>{let t;for(const e in n)(e==="class"||e==="style"||hr(e))&&((t||(t={}))[e]=n[e]);return t},Ev=(n,t)=>{const e={};for(const o in n)(!zl(o)||!(o.slice(9)in t))&&(e[o]=n[o]);return e};function Lv(n,t,e){const{props:o,children:s,component:r}=n,{props:i,children:l,patchFlag:a}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&a>=0){if(a&1024)return!0;if(a&16)return o?lu(o,i,u):!!i;if(a&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const m=c[f];if(i[m]!==o[m]&&!wr(u,m))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:o===i?!1:o?i?lu(o,i,u):!0:!!i;return!1}function lu(n,t,e){const o=Object.keys(t);if(o.length!==Object.keys(n).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(t[r]!==n[r]&&!wr(e,r))return!0}return!1}function Nv({vnode:n,parent:t},e){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===n&&(o.el=n.el),o===n)(n=t.vnode).el=e,t=t.parent;else break}}const Gs=n=>n.__isSuspense;function Hv(n,t){t&&t.pendingBranch?me(n)?t.effects.push(...n):t.effects.push(n):Gh(n)}const ce=Symbol.for("v-fgt"),kr=Symbol.for("v-txt"),Zt=Symbol.for("v-cmt"),js=Symbol.for("v-stc"),Xo=[];let Ct=null;function R(n=!1){Xo.push(Ct=n?null:[])}function Wv(){Xo.pop(),Ct=Xo[Xo.length-1]||null}let ss=1;function au(n,t=!1){ss+=n,n<0&&Ct&&t&&(Ct.hasOnce=!0)}function Pf(n){return n.dynamicChildren=ss>0?Ct||Kn:null,Wv(),ss>0&&Ct&&Ct.push(n),n}function V(n,t,e,o,s,r){return Pf(d(n,t,e,o,s,r,!0))}function pe(n,t,e,o,s){return Pf(F(n,t,e,o,s,!0))}function ro(n){return n?n.__v_isVNode===!0:!1}function In(n,t){return n.type===t.type&&n.key===t.key}const Of=({key:n})=>n??null,Rs=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Je(n)||ve(n)||_e(n)?{i:at,r:n,k:t,f:!!e}:n:null);function d(n,t=null,e=null,o=0,s=null,r=n===ce?0:1,i=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Of(t),ref:t&&Rs(t),scopeId:Zd,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:at};return l?(ca(a,e),r&128&&n.normalize(a)):e&&(a.shapeFlag|=Je(e)?8:16),ss>0&&!i&&Ct&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&Ct.push(a),a}const F=Vv;function Vv(n,t=null,e=null,o=0,s=null,r=!1){if((!n||n===fv)&&(n=Zt),ro(n)){const l=Cn(n,t,!0);return e&&ca(l,e),ss>0&&!r&&Ct&&(l.shapeFlag&6?Ct[Ct.indexOf(n)]=l:Ct.push(l)),l.patchFlag=-2,l}if(Qv(n)&&(n=n.__vccOpts),t){t=Fv(t);let{class:l,style:a}=t;l&&!Je(l)&&(t.class=Ne(l)),Fe(a)&&(ta(a)&&!me(a)&&(a=nt({},a)),t.style=tt(a))}const i=Je(n)?1:Gs(n)?128:Kh(n)?64:Fe(n)?4:_e(n)?2:0;return d(n,t,e,o,s,i,r,!0)}function Fv(n){return n?ta(n)||vf(n)?nt({},n):n:null}function Cn(n,t,e=!1,o=!1){const{props:s,ref:r,patchFlag:i,children:l,transition:a}=n,u=t?qv(s||{},t):s,c={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&Of(u),ref:t&&t.ref?e&&r?me(r)?r.concat(Rs(t)):[r,Rs(t)]:Rs(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==ce?i===-1?16:i|16:i,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:a,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Cn(n.ssContent),ssFallback:n.ssFallback&&Cn(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return a&&o&&so(c,a.clone(c)),c}function Q(n=" ",t=0){return F(kr,null,n,t)}function Uv(n,t){const e=F(js,null,n);return e.staticCount=t,e}function he(n="",t=!1){return t?(R(),pe(Zt,null,n)):F(Zt,null,n)}function zt(n){return n==null||typeof n=="boolean"?F(Zt):me(n)?F(ce,null,n.slice()):ro(n)?gn(n):F(kr,null,String(n))}function gn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Cn(n)}function ca(n,t){let e=0;const{shapeFlag:o}=n;if(t==null)t=null;else if(me(t))e=16;else if(typeof t=="object")if(o&65){const s=t.default;s&&(s._c&&(s._d=!1),ca(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!vf(t)?t._ctx=at:s===3&&at&&(at.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else _e(t)?(t={default:t,_ctx:at},e=32):(t=String(t),o&64?(e=16,t=[Q(t)]):e=8);n.children=t,n.shapeFlag|=e}function qv(...n){const t={};for(let e=0;e<n.length;e++){const o=n[e];for(const s in o)if(s==="class")t.class!==o.class&&(t.class=Ne([t.class,o.class]));else if(s==="style")t.style=tt([t.style,o.style]);else if(hr(s)){const r=t[s],i=o[s];i&&r!==i&&!(me(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=o[s])}return t}function Ot(n,t,e,o=null){Nt(n,t,7,[e,o])}const zv=df();let Xv=0;function Yv(n,t,e){const o=n.type,s=(t?t.appContext:n.appContext)||zv,r={uid:Xv++,vnode:n,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new mh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:mf(o,s),emitsOptions:Sf(o,s),emit:null,emitted:null,propsDefaults:Ae,inheritAttrs:o.inheritAttrs,ctx:Ae,data:Ae,props:Ae,attrs:Ae,slots:Ae,refs:Ae,setupState:Ae,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Dv.bind(null,r),n.ce&&n.ce(r),r}let lt=null;const Cr=()=>lt||at;let Ks,$l;{const n=gr(),t=(e,o)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(o),r=>{s.length>1?s.forEach(i=>i(r)):s[0](r)}};Ks=t("__VUE_INSTANCE_SETTERS__",e=>lt=e),$l=t("__VUE_SSR_SETTERS__",e=>io=e)}const vs=n=>{const t=lt;return Ks(n),n.scope.on(),()=>{n.scope.off(),Ks(t)}},uu=()=>{lt&&lt.scope.off(),Ks(null)};function Tf(n){return n.vnode.shapeFlag&4}let io=!1;function Gv(n,t=!1,e=!1){t&&$l(t);const{props:o,children:s}=n.vnode,r=Tf(n);kv(n,o,r,t),Sv(n,s,e);const i=r?Kv(n,t):void 0;return t&&$l(!1),i}function Kv(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,pv);const{setup:o}=e;if(o){_n();const s=n.setupContext=o.length>1?Zv(n):null,r=vs(n),i=fs(o,n,0,[n.props,s]),l=_d(i);if(xn(),r(),(l||n.sp)&&!Dn(n)&&oa(n),l){if(i.then(uu,uu),t)return i.then(a=>{cu(n,a)}).catch(a=>{ps(a,n,0)});n.asyncDep=i}else cu(n,i)}else $f(n)}function cu(n,t,e){_e(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Fe(t)&&(n.setupState=Xd(t)),$f(n)}function $f(n,t,e){const o=n.type;n.render||(n.render=o.render||Gt);{const s=vs(n);_n();try{hv(n)}finally{xn(),s()}}}const Jv={get(n,t){return ct(n,"get",""),n[t]}};function Zv(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,Jv),slots:n.slots,emit:n.emit,expose:t}}function _r(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Xd(mt(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in zo)return zo[e](n)},has(t,e){return e in t||e in zo}})):n.proxy}function du(n,t=!0){return _e(n)?n.displayName||n.name:n.name||t&&n.__name}function Qv(n){return _e(n)&&"__vccOpts"in n}const D=(n,t)=>Uh(n,t,io);function fu(n,t,e){const o=arguments.length;return o===2?Fe(t)&&!me(t)?ro(t)?F(n,null,[t]):F(n,t):F(n,null,t):(o>3?e=Array.prototype.slice.call(arguments,2):o===3&&ro(e)&&(e=[e]),F(n,t,e))}const eg="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jl;const pu=typeof window<"u"&&window.trustedTypes;if(pu)try{jl=pu.createPolicy("vue",{createHTML:n=>n})}catch{}const jf=jl?n=>jl.createHTML(n):n=>n,tg="http://www.w3.org/2000/svg",ng="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,hu=en&&en.createElement("template"),og={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,o)=>{const s=t==="svg"?en.createElementNS(tg,n):t==="mathml"?en.createElementNS(ng,n):e?en.createElement(n,{is:e}):en.createElement(n);return n==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:n=>en.createTextNode(n),createComment:n=>en.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>en.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,o,s,r){const i=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{hu.innerHTML=jf(o==="svg"?`<svg>${n}</svg>`:o==="mathml"?`<math>${n}</math>`:n);const l=hu.content;if(o==="svg"||o==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}t.insertBefore(l,e)}return[i?i.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},cn="transition",So="animation",lo=Symbol("_vtc"),Rf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},sg=nt({},Qh,Rf),$n=(n,t=[])=>{me(n)?n.forEach(e=>e(...t)):n&&n(...t)},vu=n=>n?me(n)?n.some(t=>t.length>1):n.length>1:!1;function rg(n){const t={};for(const L in n)L in Rf||(t[L]=n[L]);if(n.css===!1)return t;const{name:e="v",type:o,duration:s,enterFromClass:r=`${e}-enter-from`,enterActiveClass:i=`${e}-enter-active`,enterToClass:l=`${e}-enter-to`,appearFromClass:a=r,appearActiveClass:u=i,appearToClass:c=l,leaveFromClass:f=`${e}-leave-from`,leaveActiveClass:m=`${e}-leave-active`,leaveToClass:b=`${e}-leave-to`}=n,x=ig(s),k=x&&x[0],y=x&&x[1],{onBeforeEnter:w,onEnter:h,onEnterCancelled:v,onLeave:p,onLeaveCancelled:O,onBeforeAppear:M=w,onAppear:A=h,onAppearCancelled:g=v}=t,T=(L,E,ee,U)=>{L._enterCancelled=U,pn(L,E?c:l),pn(L,E?u:i),ee&&ee()},$=(L,E)=>{L._isLeaving=!1,pn(L,f),pn(L,b),pn(L,m),E&&E()},W=L=>(E,ee)=>{const U=L?A:h,P=()=>T(E,L,ee);$n(U,[E,P]),gu(()=>{pn(E,L?a:r),Ut(E,L?c:l),vu(U)||mu(E,o,k,P)})};return nt(t,{onBeforeEnter(L){$n(w,[L]),Ut(L,r),Ut(L,i)},onBeforeAppear(L){$n(M,[L]),Ut(L,a),Ut(L,u)},onEnter:W(!1),onAppear:W(!0),onLeave(L,E){L._isLeaving=!0;const ee=()=>$(L,E);Ut(L,f),L._enterCancelled?(Ut(L,m),Rl()):(Rl(),Ut(L,m)),gu(()=>{L._isLeaving&&(pn(L,f),Ut(L,b),vu(p)||mu(L,o,y,ee))}),$n(p,[L,ee])},onEnterCancelled(L){T(L,!1,void 0,!0),$n(v,[L])},onAppearCancelled(L){T(L,!0,void 0,!0),$n(g,[L])},onLeaveCancelled(L){$(L),$n(O,[L])}})}function ig(n){if(n==null)return null;if(Fe(n))return[qr(n.enter),qr(n.leave)];{const t=qr(n);return[t,t]}}function qr(n){return uh(n)}function Ut(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[lo]||(n[lo]=new Set)).add(t)}function pn(n,t){t.split(/\s+/).forEach(o=>o&&n.classList.remove(o));const e=n[lo];e&&(e.delete(t),e.size||(n[lo]=void 0))}function gu(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let lg=0;function mu(n,t,e,o){const s=n._endId=++lg,r=()=>{s===n._endId&&o()};if(e!=null)return setTimeout(r,e);const{type:i,timeout:l,propCount:a}=If(n,t);if(!i)return o();const u=i+"end";let c=0;const f=()=>{n.removeEventListener(u,m),r()},m=b=>{b.target===n&&++c>=a&&f()};setTimeout(()=>{c<a&&f()},l+1),n.addEventListener(u,m)}function If(n,t){const e=window.getComputedStyle(n),o=x=>(e[x]||"").split(", "),s=o(`${cn}Delay`),r=o(`${cn}Duration`),i=bu(s,r),l=o(`${So}Delay`),a=o(`${So}Duration`),u=bu(l,a);let c=null,f=0,m=0;t===cn?i>0&&(c=cn,f=i,m=r.length):t===So?u>0&&(c=So,f=u,m=a.length):(f=Math.max(i,u),c=f>0?i>u?cn:So:null,m=c?c===cn?r.length:a.length:0);const b=c===cn&&/\b(transform|all)(,|$)/.test(o(`${cn}Property`).toString());return{type:c,timeout:f,propCount:m,hasTransform:b}}function bu(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,o)=>yu(e)+yu(n[o])))}function yu(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function Rl(){return document.body.offsetHeight}function ag(n,t,e){const o=n[lo];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const wu=Symbol("_vod"),ug=Symbol("_vsh"),cg=Symbol(""),dg=/(^|;)\s*display\s*:/;function fg(n,t,e){const o=n.style,s=Je(e);let r=!1;if(e&&!s){if(t)if(Je(t))for(const i of t.split(";")){const l=i.slice(0,i.indexOf(":")).trim();e[l]==null&&Is(o,l,"")}else for(const i in t)e[i]==null&&Is(o,i,"");for(const i in e)i==="display"&&(r=!0),Is(o,i,e[i])}else if(s){if(t!==e){const i=o[cg];i&&(e+=";"+i),o.cssText=e,r=dg.test(e)}}else t&&n.removeAttribute("style");wu in n&&(n[wu]=r?o.display:"",n[ug]&&(o.display="none"))}const ku=/\s*!important$/;function Is(n,t,e){if(me(e))e.forEach(o=>Is(n,t,o));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const o=pg(n,t);ku.test(e)?n.setProperty(an(o),e.replace(ku,""),"important"):n[o]=e}}const Cu=["Webkit","Moz","ms"],zr={};function pg(n,t){const e=zr[t];if(e)return e;let o=rn(t);if(o!=="filter"&&o in n)return zr[t]=o;o=Pd(o);for(let s=0;s<Cu.length;s++){const r=Cu[s]+o;if(r in n)return zr[t]=r}return t}const _u="http://www.w3.org/1999/xlink";function xu(n,t,e,o,s,r=vh(t)){o&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(_u,t.slice(6,t.length)):n.setAttributeNS(_u,t,e):e==null||r&&!Td(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Lt(e)?String(e):e)}function Su(n,t,e,o,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?jf(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?n.getAttribute("value")||"":n.value,a=e==null?n.type==="checkbox"?"on":"":String(e);(l!==a||!("_value"in n))&&(n.value=a),e==null&&n.removeAttribute(t),n._value=e;return}let i=!1;if(e===""||e==null){const l=typeof n[t];l==="boolean"?e=Td(e):e==null&&l==="string"?(e="",i=!0):l==="number"&&(e=0,i=!0)}try{n[t]=e}catch{}i&&n.removeAttribute(s||t)}function mn(n,t,e,o){n.addEventListener(t,e,o)}function hg(n,t,e,o){n.removeEventListener(t,e,o)}const Pu=Symbol("_vei");function vg(n,t,e,o,s=null){const r=n[Pu]||(n[Pu]={}),i=r[t];if(o&&i)i.value=o;else{const[l,a]=gg(t);if(o){const u=r[t]=yg(o,s);mn(n,l,u,a)}else i&&(hg(n,l,i,a),r[t]=void 0)}}const Ou=/(?:Once|Passive|Capture)$/;function gg(n){let t;if(Ou.test(n)){t={};let o;for(;o=n.match(Ou);)n=n.slice(0,n.length-o[0].length),t[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):an(n.slice(2)),t]}let Xr=0;const mg=Promise.resolve(),bg=()=>Xr||(mg.then(()=>Xr=0),Xr=Date.now());function yg(n,t){const e=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=e.attached)return;Nt(wg(o,e.value),t,5,[o])};return e.value=n,e.attached=bg(),e}function wg(n,t){if(me(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}const Tu=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,kg=(n,t,e,o,s,r)=>{const i=s==="svg";t==="class"?ag(n,o,i):t==="style"?fg(n,e,o):hr(t)?zl(t)||vg(n,t,e,o,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Cg(n,t,o,i))?(Su(n,t,o),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&xu(n,t,o,i,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Je(o))?Su(n,rn(t),o,r,t):(t==="true-value"?n._trueValue=o:t==="false-value"&&(n._falseValue=o),xu(n,t,o,i))};function Cg(n,t,e,o){if(o)return!!(t==="innerHTML"||t==="textContent"||t in n&&Tu(t)&&_e(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Tu(t)&&Je(e)?!1:t in n}const Af=new WeakMap,Mf=new WeakMap,Js=Symbol("_moveCb"),$u=Symbol("_enterCb"),_g=n=>(delete n.props.mode,n),xg=_g({name:"TransitionGroup",props:nt({},sg,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=Cr(),o=Zh();let s,r;return ra(()=>{if(!s.length)return;const i=n.moveClass||`${n.name||"v"}-move`;if(!Tg(s[0].el,e.vnode.el,i))return;s.forEach(Sg),s.forEach(Pg);const l=s.filter(Og);Rl(),l.forEach(a=>{const u=a.el,c=u.style;Ut(u,i),c.transform=c.webkitTransform=c.transitionDuration="";const f=u[Js]=m=>{m&&m.target!==u||(!m||/transform$/.test(m.propertyName))&&(u.removeEventListener("transitionend",f),u[Js]=null,pn(u,i))};u.addEventListener("transitionend",f)})}),()=>{const i=De(n),l=rg(i);let a=i.tag||ce;if(s=[],r)for(let u=0;u<r.length;u++){const c=r[u];c.el&&c.el instanceof Element&&(s.push(c),so(c,xl(c,l,o,e)),Af.set(c,c.el.getBoundingClientRect()))}r=t.default?of(t.default()):[];for(let u=0;u<r.length;u++){const c=r[u];c.key!=null&&so(c,xl(c,l,o,e))}return F(a,null,r)}}}),Z_=xg;function Sg(n){const t=n.el;t[Js]&&t[Js](),t[$u]&&t[$u]()}function Pg(n){Mf.set(n,n.el.getBoundingClientRect())}function Og(n){const t=Af.get(n),e=Mf.get(n),o=t.left-e.left,s=t.top-e.top;if(o||s){const r=n.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",n}}function Tg(n,t,e){const o=n.cloneNode(),s=n[lo];s&&s.forEach(l=>{l.split(/\s+/).forEach(a=>a&&o.classList.remove(a))}),e.split(/\s+/).forEach(l=>l&&o.classList.add(l)),o.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(o);const{hasTransform:i}=If(o);return r.removeChild(o),i}const ao=n=>{const t=n.props["onUpdate:modelValue"]||!1;return me(t)?e=>Zn(t,e):t};function $g(n){n.target.composing=!0}function ju(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const sn=Symbol("_assign"),Ke={created(n,{modifiers:{lazy:t,trim:e,number:o}},s){n[sn]=ao(s);const r=o||s.props&&s.props.type==="number";mn(n,t?"change":"input",i=>{if(i.target.composing)return;let l=n.value;e&&(l=l.trim()),r&&(l=Ws(l)),n[sn](l)}),e&&mn(n,"change",()=>{n.value=n.value.trim()}),t||(mn(n,"compositionstart",$g),mn(n,"compositionend",ju),mn(n,"change",ju))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:o,trim:s,number:r}},i){if(n[sn]=ao(i),n.composing)return;const l=(r||n.type==="number")&&!/^0\d/.test(n.value)?Ws(n.value):n.value,a=t??"";l!==a&&(document.activeElement===n&&n.type!=="range"&&(o&&t===e||s&&n.value.trim()===a)||(n.value=a))}},jg={deep:!0,created(n,t,e){n[sn]=ao(e),mn(n,"change",()=>{const o=n._modelValue,s=rs(n),r=n.checked,i=n[sn];if(me(o)){const l=Gl(o,s),a=l!==-1;if(r&&!a)i(o.concat(s));else if(!r&&a){const u=[...o];u.splice(l,1),i(u)}}else if(go(o)){const l=new Set(o);r?l.add(s):l.delete(s),i(l)}else i(Df(n,r))})},mounted:Ru,beforeUpdate(n,t,e){n[sn]=ao(e),Ru(n,t,e)}};function Ru(n,{value:t,oldValue:e},o){n._modelValue=t;let s;if(me(t))s=Gl(t,o.props.value)>-1;else if(go(t))s=t.has(o.props.value);else{if(t===e)return;s=ds(t,Df(n,!0))}n.checked!==s&&(n.checked=s)}const _t={deep:!0,created(n,{value:t,modifiers:{number:e}},o){const s=go(t);mn(n,"change",()=>{const r=Array.prototype.filter.call(n.options,i=>i.selected).map(i=>e?Ws(rs(i)):rs(i));n[sn](n.multiple?s?new Set(r):r:r[0]),n._assigning=!0,yn(()=>{n._assigning=!1})}),n[sn]=ao(o)},mounted(n,{value:t}){Iu(n,t)},beforeUpdate(n,t,e){n[sn]=ao(e)},updated(n,{value:t}){n._assigning||Iu(n,t)}};function Iu(n,t){const e=n.multiple,o=me(t);if(!(e&&!o&&!go(t))){for(let s=0,r=n.options.length;s<r;s++){const i=n.options[s],l=rs(i);if(e)if(o){const a=typeof l;a==="string"||a==="number"?i.selected=t.some(u=>String(u)===String(l)):i.selected=Gl(t,l)>-1}else i.selected=t.has(l);else if(ds(rs(i),t)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function rs(n){return"_value"in n?n._value:n.value}function Df(n,t){const e=t?"_trueValue":"_falseValue";return e in n?n[e]:t}const Rg=["ctrl","shift","alt","meta"],Ig={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>Rg.some(e=>n[`${e}Key`]&&!t.includes(e))},fe=(n,t)=>{const e=n._withMods||(n._withMods={}),o=t.join(".");return e[o]||(e[o]=(s,...r)=>{for(let i=0;i<t.length;i++){const l=Ig[t[i]];if(l&&l(s,t))return}return n(s,...r)})},Ag={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},rt=(n,t)=>{const e=n._withKeys||(n._withKeys={}),o=t.join(".");return e[o]||(e[o]=s=>{if(!("key"in s))return;const r=an(s.key);if(t.some(i=>i===r||Ag[i]===r))return n(s)})},Mg=nt({patchProp:kg},og);let Au;function Dg(){return Au||(Au=Ov(Mg))}const Bf=(...n)=>{const t=Dg().createApp(...n),{mount:e}=t;return t.mount=o=>{const s=Eg(o);if(!s)return;const r=t._component;!_e(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const i=e(s,!1,Bg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function Bg(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Eg(n){return Je(n)?document.querySelector(n):n}const Lg="modulepreload",Ng=function(n,t){return new URL(n,t).href},Mu={},Il=function(t,e,o){let s=Promise.resolve();if(e&&e.length>0){let i=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const l=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=i(e.map(c=>{if(c=Ng(c,o),c in Mu)return;Mu[c]=!0;const f=c.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(!!o)for(let k=l.length-1;k>=0;k--){const y=l[k];if(y.href===c&&(!f||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const x=document.createElement("link");if(x.rel=f?"stylesheet":Lg,f||(x.as="script"),x.crossOrigin="",x.href=c,u&&x.setAttribute("nonce",u),document.head.appendChild(x),f)return new Promise((k,y)=>{x.addEventListener("load",k),x.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})};function Hg(n){return{all:n=n||new Map,on:function(t,e){var o=n.get(t);o?o.push(e):n.set(t,[e])},off:function(t,e){var o=n.get(t);o&&(e?o.splice(o.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var o=n.get(t);o&&o.slice().map(function(s){s(e)}),(o=n.get("*"))&&o.slice().map(function(s){s(t,e)})}}}const Yr=Hg(),Me={fire(n){Yr.emit(n.kind,n)},subscribe(n,t){Yr.on(n.kind,t)},unsubscribe(n,t){Yr.off(n.kind,t)}};class Zs{constructor(t){_(this,"kind","AssetFailureEvent");this.path=t}}_(Zs,"kind","AssetFailureEvent");class gs{constructor(t){_(this,"kind","FailureEvent");this.message=t}}_(gs,"kind","FailureEvent");class Ef{constructor(t){_(this,"kind","CustomAssetFailureEvent");this.error=t}}_(Ef,"kind","CustomAssetFailureEvent");class Qs{constructor(){_(this,"kind","InvalidateRenderEvent")}}_(Qs,"kind","InvalidateRenderEvent");const cr=class cr{constructor(){_(this,"kind",cr.kind)}};_(cr,"kind","RenderUpdatedEvent");let er=cr;const dr=class dr{constructor(){_(this,"kind",dr.kind)}};_(dr,"kind","StateLoadingEvent");let tr=dr;class $t{constructor(t){_(this,"kind","ShowMessageEvent");this.message=t}}_($t,"kind","ShowMessageEvent");class da{constructor(t,e){_(this,"kind","ResolvableErrorEvent");this.message=t,this.actions=e}}_(da,"kind","ResolvableErrorEvent");class nr{constructor(t){_(this,"kind","ColorPickedEvent");this.color=t}}_(nr,"kind","ColorPickedEvent");class Lf{constructor(t,e){_(this,"kind","VueErrorEvent");this.error=t,this.info=e}}_(Lf,"kind","VueErrorEvent");function St(){return Et("viewport")}const Du=new WeakMap,Bu=new WeakMap;function Nf(){const n=St(),t=Du.get(n);if(t)return t;const e=D({get(){return n.value.selection},set(o){n.value.selection=o}});return Du.set(n,e),e}function Pn(){const n=St(),t=Bu.get(n);if(t)return t;console.log("make computed");const e=D(()=>n.value.isVertical);return Bu.set(n,e),e}const Wg={key:0},Vg=["onClick"],Fg=["onClick"],Ug=5e3,Gr=2e4,Eu=100,qg=Se({__name:"message-console",props:{loading:{type:Boolean}},setup(n){const t=n,e=I([]),o=I([]),s=I([]),r=I(!1),i=I(0),l=I(0),a=Pn();u(t.loading),Me.subscribe(Zs,m=>{e.value.push(`Failed to load asset '${m.path}'`),setTimeout(()=>{e.value.shift()},Ug)}),Me.subscribe(Ef,()=>{e.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{e.value.shift()},Gr)}),Me.subscribe(gs,m=>{o.value.push(m.message)}),Me.subscribe(da,m=>{s.value.push(m)}),Me.subscribe($t,m=>{e.value.push(m.message),setTimeout(()=>{e.value.shift()},Gr)}),Me.subscribe(Lf,m=>{e.value.push(m.error.name),e.value.push(JSON.stringify(m.error.stack)),e.value.push(m.info),setTimeout(()=>{e.value.shift(),e.value.shift(),e.value.shift()},Gr)});function u(m){m?(l.value&&(clearTimeout(l.value),l.value=0),!r.value&&!i.value&&(i.value=setTimeout(()=>{r.value=!0,i.value=0},Eu))):(i.value&&(clearTimeout(i.value),i.value=0),r.value&&!l.value&&(l.value=setTimeout(()=>{r.value=!1,l.value=0},Eu)))}function c(m){o.value.splice(m,1)}async function f(m,b){const x=s.value[m];s.value.splice(m,1),await x.actions.find(y=>y.name===b).exec()}return Xe(()=>t.loading,m=>{u(m)}),(m,b)=>(R(),V("div",{id:"messageConsole",class:Ne({vertical:J(a)})},[r.value?(R(),V("p",Wg,"Loading...")):he("",!0),(R(!0),V(ce,null,ze(e.value,(x,k)=>(R(),V("p",{key:x+"_"+k},Oe(x),1))),128)),(R(!0),V(ce,null,ze(s.value,(x,k)=>(R(),V("p",{class:"error",key:"resolvableError_"+k},[Q(Oe(x.message)+" ",1),(R(!0),V(ce,null,ze(x.actions,y=>(R(),V("a",{href:"#",key:"resolvableError_"+k+y.name,onClick:w=>f(k,y.name)},"["+Oe(y.name)+"]",9,Vg))),128))]))),128)),(R(!0),V(ce,null,ze(o.value,(x,k)=>(R(),V("p",{class:"error",key:"error_"+k},[Q(Oe(x)+" ",1),d("a",{href:"#",onClick:y=>c(k)},"[Dismiss]",8,Fg)]))),128))],2))}}),Be=(n,t)=>{const e=n.__vccOpts||n;for(const[o,s]of t)e[o]=s;return e},zg=Be(qg,[["__scopeId","data-v-6b48a3f4"]]),Xg={key:0,id:"submit-options"},Yg=["onClick"],Gg={key:0,id:"submit-options"},Kg=["onClick"],Jg=Se({__name:"modal-dialog",props:{noBaseSize:{type:Boolean,default:!1},options:{default:()=>[]}},emits:["leave","option"],setup(n,{emit:t}){const e=n,o=t,s=typeof HTMLDialogElement<"u",r=I(null);function i(){if(s){const u=r.value;u!=null&&!u.open&&u.showModal()}window.addEventListener("click",a)}function l(){if(s){const u=r.value;u!=null&&u.open&&u.close(),o("leave")}window.removeEventListener("click",a)}function a(u){const c=r.value;c!=null&&c.open?u.target===c&&(l(),u.preventDefault(),u.stopPropagation()):window.removeEventListener("click",a)}return Ht(i),sf(i),rf(l),Sn(l),(u,c)=>s?(R(),V("dialog",{key:0,ref_key:"dialog",ref:r,class:Ne(["native",{"base-size":!e.noBaseSize}]),onCancel:l},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(R(),V("div",Xg,[(R(!0),V(ce,null,ze(u.options,f=>(R(),V("button",{key:f,class:"option",onClick:m=>o("option",f)},Oe(f),9,Yg))),128))])):he("",!0)],34)):(R(),V("div",{key:1,class:"dialog-wrapper",onClick:c[1]||(c[1]=f=>o("leave"))},[d("dialog",{ref_key:"dialog",ref:r,open:"",class:Ne({"base-size":!e.noBaseSize}),onClick:c[0]||(c[0]=fe(()=>{},["stop"]))},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(R(),V("div",Gg,[(R(!0),V(ce,null,ze(e.options,f=>(R(),V("button",{key:f,class:"option",onClick:m=>o("option",f)},Oe(f),9,Kg))),128))])):he("",!0)],2)]))}}),no=Be(Jg,[["__scopeId","data-v-07b9fd71"]]),Zg="./",fa="/dddg-assets/v2/assets/",pt=`${Zg}packs/`,pa=!0,le=Hf();function Hf(){const n=[];let t=!1;const e=[],o=function(r){return new Promise(i=>{const l=async()=>{try{r.length>0?await r(Hf()):await r(),e.forEach(a=>a())}catch(a){console.log("Error during transaction!: ",a)}finally{t=!1}n.length>0&&n.shift()(),i()};t?n.push(l):l()})};return o.onClear=function(s){e.push(s)},o}async function Kr(n){await le(async()=>{await(n==null?void 0:n())})}function We(n,t){return n()}const ha={"dddg.buildin.backgrounds.nsfw":`${pt}buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${pt}buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${pt}buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${pt}buildin.base.yuri.nsfw.json`},Qg=new Set(Object.keys(ha)),em=Object.values(ha);var Po={},Lu;function tm(){if(Lu)return Po;Lu=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.normalizeCharacter=void 0;function n(a,u){var c=l("",a.folder||"/",u),f=void 0;return a.chibi&&(f=l(c,a.chibi,u)),f===void 0&&a.internalId&&(f=(u["/"]||"")+"chibis/"+a.internalId),{id:a.id,packId:a.packId,packCredits:a.packCredits,name:a.name,nsfw:!!a.nsfw,chibi:f,eyes:t(a.eyes,c,u),hairs:t(a.hairs,c,u),styles:r(a.styles),heads:e(a.heads,c,u),poses:o(a.poses,c,u)}}Po.normalizeCharacter=n;function t(a,u,c){if(!a)return{};var f={};for(var m in a)a.hasOwnProperty(m)&&(f[m]=l(u,a[m],c));return f}function e(a,u,c){var f={};if(!a)return f;for(var m in a)if(a.hasOwnProperty(m)){var b=a[m],x=void 0;if(b instanceof Array)x={all:s(b,u,c),nsfw:!1,offset:[290,70],size:[380,380]};else{var k=l(u,b.folder,c);x={all:s(b.all,k,c),nsfw:!!b.nsfw,offset:b.offset||[290,70],size:b.size||[380,380]}}f[m]=x}return f}function o(a,u,c){return a?a.map(function(f){var m=l(u,f.folder,c),b={compatibleHeads:f.compatibleHeads||[],headAnchor:f.headAnchor||[0,0],headInForeground:!!f.headInForeground,name:f.name,nsfw:!!f.nsfw,style:f.style,offset:[0,0],size:[960,960]};if("static"in f)b.static=l(m,f.static,c);else if("variant"in f)b.variant=s(f.variant,m,c);else if("left"in f)b.left=s(f.left,m,c),b.right=s(f.right,m,c);else throw new Error("Invalid pose");return b}):[]}function s(a,u,c){return a.map(function(f){return typeof f=="string"?{img:l(u,f,c),nsfw:!1}:{img:l(u,f.img,c),nsfw:f.nsfw||!1}})}function r(a){return a?a.map(function(u){return{name:u.name,label:u.label,nsfw:u.nsfw||!1}}):[]}function i(a){return a.startsWith("blob:")||a.startsWith("http://")||a.startsWith("https://")||a.startsWith("://")}function l(a,u,c){if(!u)return a;for(var f in c)if(u.startsWith(f))return c[f]+u.slice(f.length);return i(u)?u:a+u}return Po}var nm=tm(),wt={},Ye={},it={},Nu;function Wf(){if(Nu)return it;Nu=1;var n=it&&it.__assign||function(){return n=Object.assign||function(p){for(var O,M=1,A=arguments.length;M<A;M++){O=arguments[M];for(var g in O)Object.prototype.hasOwnProperty.call(O,g)&&(p[g]=O[g])}return p},n.apply(this,arguments)},t=it&&it.__values||function(p){var O=typeof Symbol=="function"&&Symbol.iterator,M=O&&p[O],A=0;if(M)return M.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&A>=p.length&&(p=void 0),{value:p&&p[A++],done:!p}}};throw new TypeError(O?"Object is not iterable.":"Symbol.iterator is not defined.")},e=it&&it.__read||function(p,O){var M=typeof Symbol=="function"&&p[Symbol.iterator];if(!M)return p;var A=M.call(p),g,T=[],$;try{for(;(O===void 0||O-- >0)&&!(g=A.next()).done;)T.push(g.value)}catch(W){$={error:W}}finally{try{g&&!g.done&&(M=A.return)&&M.call(A)}finally{if($)throw $.error}}return T},o=it&&it.__spread||function(){for(var p=[],O=0;O<arguments.length;O++)p=p.concat(e(arguments[O]));return p};Object.defineProperty(it,"__esModule",{value:!0}),it.mapObject=it.assetWalker=it.normalizePath=void 0;var s=10;function r(p,O,M,A){for(var g,T,$="",W=0,L=new Map(Array.from(O.entries()).map(function(P){return[new RegExp("{"+P[0]+"}","g"),P[1]]}));$!==p;){if($=p,++W>s)throw new Error("Maximum replacement recursion exceeded!");try{for(var E=(g=void 0,t(L.entries())),ee=E.next();!ee.done;ee=E.next()){var U=ee.value;p=p.replace(U[0],U[1])}}catch(P){g={error:P}}finally{try{ee&&!ee.done&&(T=E.return)&&T.call(E)}finally{if(g)throw g.error}}p=p.replace(/{format(:.*?:.*?)+}/gi,function(P){P=P.slice(8,-1);for(var j=P.split(":"),q=0;q<j.length;q+=2)if(M.has(j[q]))return j[q+1];return""}),p=p.replace(/{lq:(.*?):(.*?)}/gi,function(P){return P.slice(4,-1).split(":")[A?0:1]})}return p}it.normalizePath=r;function i(p,O){return{packId:p.packId,packCredits:p.packCredits,dependencies:p.dependencies,characters:p.characters.map(function(M){return l(M,O)}),backgrounds:p.backgrounds.map(function(M){return k(M,O)}),fonts:p.fonts.map(function(M){return y(M,O)}),poemStyles:o(p.poemStyles),poemBackgrounds:p.poemBackgrounds.map(function(M){return w(M,O)}),sprites:p.sprites.map(function(M){return h(M,O)}),colors:p.colors}}it.assetWalker=i;function l(p,O){return{id:p.id,label:p.label,chibi:p.chibi?O(p.chibi,"image"):void 0,heads:b(p.heads,O),styleGroups:p.styleGroups.map(function(M){return a(M,O)}),defaultScale:p.defaultScale,hd:p.hd,size:p.size,sdVersion:p.sdVersion}}function a(p,O){return{id:p.id,styleComponents:p.styleComponents.map(function(M){return c(M,O)}),styles:p.styles.map(function(M){return u(M,O)})}}function u(p,O){return{components:p.components,poses:p.poses.map(function(M){return m(M,O)})}}function c(p,O){return n(n({},p),{variants:f(p.variants,O)})}function f(p,O){var M={};for(var A in p)p.hasOwnProperty(A)&&(M[A]=O(p[A],"image"));return M}function m(p,O){var M,A,g={};try{for(var T=t(Object.keys(p.positions)),$=T.next();!$.done;$=T.next()){var W=$.value,L=p.positions[W];g[W]=L.map(function(E){return E.map(function(ee){return O(ee,"image")})})}}catch(E){M={error:E}}finally{try{$&&!$.done&&(A=T.return)&&A.call(T)}finally{if(M)throw M.error}}return{compatibleHeads:p.compatibleHeads,id:p.id,previewOffset:p.previewOffset,previewSize:p.previewSize,renderCommands:p.renderCommands.map(function(E){return E.type==="image"?{type:"image",offset:E.offset,images:E.images.map(function(ee){return O(ee,"image")})}:E}),size:p.size,scale:p.scale,positions:g}}function b(p,O){var M={};for(var A in p)p.hasOwnProperty(A)&&(M[A]=x(p[A],O));return M}function x(p,O){return{previewOffset:p.previewOffset,previewSize:p.previewSize,variants:p.variants.map(function(M){return M.map(function(A){return O(A,"image")})})}}function k(p,O){return{id:p.id,label:p.label,variants:p.variants.map(function(M){return M.map(function(A){return O(A,"image")})}),scaling:p.scaling,sdVersion:p.sdVersion}}function y(p,O){return{id:p.id,label:p.label,files:p.files.map(function(M){return O(M,"font")})}}function w(p,O){return{id:p.id,fontColor:p.fontColor,label:p.label,images:p.images.map(function(M){return O(M,"image")}),sdVersion:p.sdVersion}}function h(p,O){return{id:p.id,label:p.label,variants:p.variants.map(function(M){return M.map(function(A){return O(A,"image")})}),defaultScale:p.defaultScale,hd:p.hd,sdVersion:p.sdVersion}}function v(p,O){var M={};for(var A in p)p.hasOwnProperty(A)&&(M[A]=O(p[A],A));return M}return it.mapObject=v,it}var Hu;function Vf(){if(Hu)return Ye;Hu=1;var n=Ye&&Ye.__assign||function(){return n=Object.assign||function(g){for(var T,$=1,W=arguments.length;$<W;$++){T=arguments[$];for(var L in T)Object.prototype.hasOwnProperty.call(T,L)&&(g[L]=T[L])}return g},n.apply(this,arguments)};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.expandId=Ye.normalizeStyleComponent=Ye.normalizeColor=Ye.normalizeBackground=Ye.normalizeFont=Ye.normalizePoemBackground=Ye.normalizePoemStyles=Ye.normalizeSprite=Ye.mapNormalize=Ye.normalizeContentPack=void 0;var t=Wf();function e(g,T){var $={paths:T,packId:g.packId},W=M("",g.folder||"/",$);return{packId:g.packId,packCredits:g.packCredits,dependencies:g.dependencies||[],characters:o(f,g.characters,W,$),backgrounds:o(a,g.backgrounds,W,$),fonts:o(l,g.fonts,W,$),poemStyles:o(r,g.poemStyles,W,$),poemBackgrounds:o(i,g.poemBackgrounds,W,$),sprites:o(s,g.sprites,W,$),colors:o(u,g.colors,W,$)}}Ye.normalizeContentPack=e;function o(g,T,$,W){return T?T.map(function(L){return g(L,$,W)}):[]}Ye.mapNormalize=o;function s(g,T,$){var W,L=M(T,g.folder,$);return{id:A($.packId,g.id),label:g.label||g.variants[0][0],variants:g.variants.map(function(E){return c(E,L,$)}),defaultScale:g.defaultScale||[1,1],sdVersion:g.sdVersion,hd:(W=g.hd)!==null&&W!==void 0?W:null}}Ye.normalizeSprite=s;function r(g){return{label:g.label,defaultFont:g.defaultFont||"Aller",fontSize:g.fontSize!==void 0?g.fontSize:30,letterSpacing:g.letterSpacing!==void 0?g.letterSpacing:1,lineSpacing:g.lineSpacing!==void 0?g.lineSpacing:1.2}}Ye.normalizePoemStyles=r;function i(g,T,$){var W=M(T,g.folder,$);return{id:g.id,label:g.label,images:c(g.images,W,$),fontColor:g.fontColor||"black",sdVersion:g.sdVersion}}Ye.normalizePoemBackground=i;function l(g,T,$){var W=M(T,g.folder,$);return{id:A($.packId,g.id?g.id:g.label?g.label:g.files[0]),label:g.label?g.label:g.id?g.id:g.files[0],files:c(g.files,W,$)}}Ye.normalizeFont=l;function a(g,T,$){var W,L=M(T,g.folder,$);return{id:A($.packId,g.id),label:g.label?g.label:g.variants[0][0],variants:g.variants.map(function(E){return c(E,L,$)}),scaling:["none","strech","cover"].includes((W=g.scaling)===null||W===void 0?void 0:W.toLowerCase())?g.scaling.toLowerCase():"cover",sdVersion:g.sdVersion}}Ye.normalizeBackground=a;function u(g){return{label:g.label||g.color,color:g.color}}Ye.normalizeColor=u;function c(g,T,$){return g.map(function(W){return M(T,W,$)})}function f(g,T,$){var W,L,E,ee=M(T,g.folder,$);return{id:A($.packId,g.id),label:g.label,chibi:g.chibi?M(ee,g.chibi,$):void 0,heads:y(g.heads,ee,$),defaultScale:(W=g.defaultScale)!==null&&W!==void 0?W:[.8,.8],size:(L=g.size)!==null&&L!==void 0?L:[960,960],hd:(E=g.hd)!==null&&E!==void 0?E:!1,sdVersion:g.sdVersion,styleGroups:o(m,g.styleGroups,ee,$)}}function m(g,T,$){var W=M(T,g.folder,$);return{id:A($.packId,g.id),styleComponents:o(x,g.styleComponents,W,$),styles:g.styles.map(function(L){return b(L,W,$)})}}function b(g,T,$){var W=M(T,g.folder,$),L={};if(g.components)for(var E in g.components)g.components.hasOwnProperty(E)&&(L[A($.packId,E)]=g.components[E]);return{components:L,poses:g.poses.map(function(ee){return w(ee,W,$)})}}function x(g,T,$){return{id:A($.packId,g.id),label:g.label,variants:k(g.variants,T,$)}}Ye.normalizeStyleComponent=x;function k(g,T,$){if(!g)return{};var W={};for(var L in g)g.hasOwnProperty(L)&&(W[L]=M(T,g[L],$));return W}function y(g,T,$){var W={};if(!g)return W;for(var L in g)if(g.hasOwnProperty(L)){var E=g[L],ee=void 0;if(E instanceof Array)ee={variants:v(E,T,$),previewOffset:[290,70],previewSize:[380,380]};else{var U=M(T,E.folder,$);ee={variants:v(E.variants,U,$),previewOffset:E.previewOffset||[290,70],previewSize:E.previewSize||[380,380]}}W[A($.packId,L)]=ee}return W}function w(g,T,$){var W,L,E=M(T,g.folder,$);return{compatibleHeads:((W=g.compatibleHeads)===null||W===void 0?void 0:W.map(function(ee){return A($.packId,ee)}))||[],id:A($.packId,g.id),previewOffset:g.previewOffset||[0,0],previewSize:g.previewSize||[960,960],size:g.size||[960,960],scale:g.scale||.8,positions:t.mapObject(g.positions||{},function(ee){return v(ee,E,$)}),renderCommands:((L=g.renderCommands)===null||L===void 0?void 0:L.map(function(ee){return h(ee,T,$)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function h(g,T,$){if(g.type==="image"){var W=M(T,g.folder,$);return{type:"image",composite:g.composite,offset:g.offset||[0,0],images:p(g.images,W,$)}}else return n(n({},g),{offset:g.offset||[0,0]})}function v(g,T,$){return g.map(function(W){return p(W,T,$)})}function p(g,T,$){return g.map(function(W){return M(T,W,$)})}function O(g){return g.startsWith("blob:")||g.startsWith("http://")||g.startsWith("https://")||g.startsWith("://")}function M(g,T,$){if(!T)return g;for(var W in $.paths)if(T.startsWith(W))return $.paths[W]+T.slice(W.length);return O(T)?T:g+T}function A(g,T){return T.indexOf(":")!==-1?T:g+":"+T}return Ye.expandId=A,Ye}var Wu;function om(){if(Wu)return wt;Wu=1;var n=wt&&wt.__values||function(h){var v=typeof Symbol=="function"&&Symbol.iterator,p=v&&h[v],O=0;if(p)return p.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&O>=h.length&&(h=void 0),{value:h&&h[O++],done:!h}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},t=wt&&wt.__read||function(h,v){var p=typeof Symbol=="function"&&h[Symbol.iterator];if(!p)return h;var O=p.call(h),M,A=[],g;try{for(;(v===void 0||v-- >0)&&!(M=O.next()).done;)A.push(M.value)}catch(T){g={error:T}}finally{try{M&&!M.done&&(p=O.return)&&p.call(O)}finally{if(g)throw g.error}}return A},e=wt&&wt.__spread||function(){for(var h=[],v=0;v<arguments.length;v++)h=h.concat(t(arguments[v]));return h};Object.defineProperty(wt,"__esModule",{value:!0}),wt.expandOrTranslateId=wt.convert=void 0;var o=Vf();function s(h,v,p){if(!h.packId)throw new Error("");return{packId:h.packId,packCredits:h.packCredits?[h.packCredits]:[],dependencies:i(h.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[l(h,v,p)],colors:[]}}wt.convert=s;var r={"ddlc.monika":y("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":y("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":y("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":y("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":y("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":y("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":y("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":y("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":y("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":y("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function i(h){return[]}function l(h,v,p){var O={characterId:h.id,packId:h.packId,paths:v};return{id:w("character",h.id,O),chibi:h.chibi,label:h.name,heads:b(h.heads,O,p),styleGroups:a(h,O,p),defaultScale:[.8,.8],size:[960,960],hd:!1}}function a(h,v,p){var O,M,A=r[v.characterId],g=[],T=new Map,$=x(h,v),W=$.length===0?A&&A.defaultStyleComponents?u(A.defaultStyleComponents,v):[]:$,L=h.poses.map(function(q){return q.style}).filter(function(q,je,Y){return Y.indexOf(q)===je}),E=new Map(h.styles.map(function(q){return[q.name,q]})),ee=function(q){var je,Y,se,we,Te=E.get(q);if(Te&&Te.nsfw&&!p)return"continue";var Ce=q,ot={};try{for(var Ze=(je=void 0,n(W)),oe=Ze.next();!oe.done;oe=Ze.next()){var xe=oe.value;try{for(var Z=(se=void 0,n(Object.keys(xe.variants))),H=Z.next();!H.done;H=Z.next()){var ue=H.value,C=new RegExp("-"+ue+"\\b");if(Ce.match(C)){ot[xe.id]=ue,Ce=Ce.replace(C,"");break}}}catch(B){se={error:B}}finally{try{H&&!H.done&&(we=Z.return)&&we.call(Z)}finally{if(se)throw se.error}}}}catch(B){je={error:B}}finally{try{oe&&!oe.done&&(Y=Ze.return)&&Y.call(Ze)}finally{if(je)throw je.error}}Ce=w("styleGroups",Ce,v);var S=T.get(Ce);S||(S={id:Ce,styleComponents:W,styles:[]},T.set(Ce,S),g.push(Ce)),S.styles.push({components:ot,poses:f(h.poses.filter(function(B){return B.style===q}),v,p)})};try{for(var U=n(L),P=U.next();!P.done;P=U.next()){var j=P.value;ee(j)}}catch(q){O={error:q}}finally{try{P&&!P.done&&(M=U.return)&&M.call(U)}finally{if(O)throw O.error}}return g.map(function(q){return T.get(q)})}function u(h,v){return o.mapNormalize(o.normalizeStyleComponent,h,"",{packId:v.packId,paths:v.paths})}function c(h,v){return h?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:v}]:[{type:"head",offset:v},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function f(h,v,p){return h.map(function(O){return{compatibleHeads:O.compatibleHeads.map(function(M){return w("heads",M.toString(),v)}),id:w("poses",O.name,v),renderCommands:c(O.headInForeground,O.headAnchor),previewOffset:O.offset,previewSize:O.size,size:[960,960],scale:.8,positions:{Static:"static"in O?[[O.static]]:[],Left:"left"in O?m(O.left,p):[],Right:"right"in O?m(O.right,p):[],Variant:"variant"in O?m(O.variant,p):[]}}})}function m(h,v){return h.filter(function(p){return!p.nsfw||v}).map(function(p){return[p.img]})}function b(h,v,p){var O,M,A={};try{for(var g=n(Object.keys(h)),T=g.next();!T.done;T=g.next()){var $=T.value,W=h[$];W.nsfw&&!p||(A[w("heads",$,v)]={previewOffset:W.offset,previewSize:W.size,variants:W.all.filter(function(L){return!L.nsfw||p}).map(function(L){return[L.img]})})}}catch(L){O={error:L}}finally{try{T&&!T.done&&(M=g.return)&&M.call(g)}finally{if(O)throw O.error}}return A}function x(h,v){var p=[],O=[];return Object.keys(h.eyes).length>0&&(Object.keys(h.eyes).forEach(function(M){return O.push(M)}),p.push({label:"Eyes",id:w("eyes","eyes",v),variants:h.eyes})),Object.keys(h.hairs).length>0&&(Object.keys(h.hairs).forEach(function(M){return O.push(M)}),p.push({label:"Hairs",id:w("hairs","hairs",v),variants:h.hairs})),p}function k(h,v){return new Map(v.map(function(p){return[p,h+":"+p]}))}function y(h,v,p){return p.extraHeadAssoc?p.extraHeadAssoc=p.extraHeadAssoc.map(function(O){return[O[0],h+":"+O[1]]}):p.extraHeadAssoc=[],p.extraPoseAssoc?p.extraPoseAssoc=p.extraPoseAssoc.map(function(O){return[O[0],h+":"+O[1]]}):p.extraPoseAssoc=[],p.extraStyleGroupAssoc?p.extraStyleGroupAssoc=p.extraStyleGroupAssoc.map(function(O){return[O[0],h+":"+O[1]]}):p.extraStyleGroupAssoc=[],{character:h+":"+v,eyes:h+":eyes",hairs:h+":hair",defaultStyleComponents:p.defaultStyleComponents||[],heads:new Map(e(k(h,p.heads),p.extraHeadAssoc)),poses:new Map(e(k(h,p.poses),p.extraPoseAssoc)),styleGroups:new Map(e(k(h,p.styleGroups),p.extraStyleGroupAssoc))}}function w(h,v,p){var O=r[p.characterId];if(O){if(h==="character"||h==="hairs"||h==="eyes")return O[h];var M=O[h].get(v);if(M)return M}return o.expandId(p.packId,v)}return wt.expandOrTranslateId=w,wt}var sm=om(),rm=Vf(),Jr=Wf();function im(n,t){return{backgrounds:lm(n.backgrounds,t.backgrounds),characters:um(n.characters,t.characters),dependencies:Al(n.dependencies,t.dependencies),fonts:Yt(n.fonts,t.fonts,e=>e.id,(e,o)=>({...e,files:Al(e.files,o.files)})),poemStyles:Yt(n.poemStyles,t.poemStyles,e=>e.label,()=>{throw new Error}),poemBackgrounds:[...n.poemBackgrounds,...t.poemBackgrounds],sprites:Yt(n.sprites,t.sprites,e=>e.id,(e,o)=>({id:e.id,label:e.label,variants:[...e.variants,...o.variants],defaultScale:e.defaultScale,hd:e.hd,sdVersion:e.sdVersion??o.sdVersion})),colors:Yt(n.colors,t.colors,e=>e.color,e=>e)}}function lm(n,t){return Yt(n,t,e=>e.id,am)}function am(n,t){return{id:n.id,label:n.label,variants:[...n.variants,...t.variants],scaling:n.scaling,sdVersion:n.sdVersion??t.sdVersion}}function um(n,t){return Yt(n,t,e=>e.id,cm)}function cm(n,t){return{chibi:n.chibi,id:n.id,label:n.label,heads:pm(n.heads,t.heads),defaultScale:n.defaultScale,hd:n.hd,size:n.size,sdVersion:n.sdVersion,styleGroups:Yt(n.styleGroups,t.styleGroups,e=>e.id,(e,o)=>({id:e.id,styleComponents:Yt(e.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:dm(s.variants,r.variants)})),styles:Yt(e.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:Yt(s.poses,r.poses,i=>i.id,fm)}))}))}}function dm(n,t){const e={...n};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Object.prototype.hasOwnProperty.call(e,o)||(e[o]=t[o]));return e}function fm(n,t){const e={...n.positions};for(const o in t.positions)e[o]?e[o]=[...e[o],...t.positions[o]]:e[o]=t.positions[o];return{id:n.id,compatibleHeads:Al(n.compatibleHeads,t.compatibleHeads),previewOffset:n.previewOffset,previewSize:n.previewSize,scale:n.scale,size:n.size,renderCommands:n.renderCommands,positions:e}}function pm(n,t){const e={...n};for(const o in t){if(!Object.prototype.hasOwnProperty.call(t,o))continue;const s=t[o];if(e[o]){const r=e[o];e[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else e[o]=s}return e}function Al(n,t){const e=[...n];for(const o of t)e.includes(o)||e.push(o);return e}function Yt(n,t,e,o){const s=[...n],r=new Map(n.map((i,l)=>[e(i),l]));for(const i of t){const l=e(i);if(r.has(l)){const a=r.get(l),u=s[a];s.splice(a,1,o(u,i))}else r.set(l,s.length),s.push(i)}return s}function Eo(n,t,e){let o=t+e;const s=n.length;return o<0&&(o+=s),o>=s&&(o-=s),o}const Dt=class Dt{constructor(t,e,o,s){this.r=t,this.g=e,this.b=o,this.a=s,Object.freeze(this)}static validCss(t){return this.validCssRgb(t)||this.validHex(t)}static fromCss(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}static validCssRgb(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}static fromCssRgb(t){if(!this.validCssRgb(t))throw new Error("Invalid RGB color format");const e=t.slice(0,-1),o=e.indexOf("("),r=e.slice(o+1).split(",").map(i=>parseFloat(i.trim()));return new Dt(r[0],r[1],r[2],r.length===4?r[3]:1)}static validHex(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}static fromHex(t){if(!this.validHex(t))throw new Error("Invalid Hex color format");const e=t.slice(1);if(e.length===3)return new Dt(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),1);if(e.length===4)return new Dt(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)/255);if(e.length===6)return new Dt(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),1);if(e.length===8)return new Dt(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),parseInt(e[6]+e[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:t,g:e,b:o}=this;const{a:s}=this;t/=255,e/=255,o/=255;const r=Math.max(t,e,o),i=Math.min(t,e,o);let l,a;const u=(r+i)/2;if(r===i)l=a=0;else{const c=r-i;switch(a=u>.5?c/(2-r-i):c/(r+i),r){case t:l=(e-o)/c+(e<o?6:0);break;case e:l=(o-t)/c+2;break;case o:l=(t-e)/c+4;break}l/=6}return new Ve(l,a,u,s)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};_(Dt,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i),_(Dt,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i),_(Dt,"hexShortEx",/^#[0-9A-F]{3,4}$/i),_(Dt,"hexLongEx",/^#[0-9A-F]{6,8}$/i);let Le=Dt;class Ve{constructor(t,e,o,s){this.h=t,this.s=e,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(t){let{h:e,s:o,l:s,a:r}=this;return e+=t.h,e>=1?e-=1:e<0&&(e+=1),o+t.s>1?o-=t.s:(o+=t.s,o<0&&(o=0)),s+t.l>1||s+t.l<0?s-=t.l:s+=t.l,r+t.a>1||r+t.a<0?r-=t.a:r+=t.a,new Ve(e,o,s,r)}toRgb(){const{h:t,s:e,l:o,a:s}=this;let r,i,l;if(e===0)r=i=l=o;else{const a=o<.5?o*(1+e):o+e-o*e,u=2*o-a;r=Ve.hue2rgb(u,a,t+1/3),i=Ve.hue2rgb(u,a,t),l=Ve.hue2rgb(u,a,t-1/3)}return new Le(Math.round(r*255),Math.round(i*255),Math.round(l*255),s)}toHSL(){return this}static hue2rgb(t,e,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?t+(e-t)*6*o:o<1/2?e:o<2/3?t+(e-t)*(2/3-o)*6:t}}const xr=1280,va=720,hm=128,vm=32,gm="rgba(60,60,60,0.8)",mm=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Ff=1,bm=1/1.5,ym=-74,wm=358,km=[200,240,400,493,640,786,880,1040,1080],Cm=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:wm,CloseUpYOffset:ym,WheelBackground:gm,characterPositions:km,hdCharacterScaleFactor:bm,positions:mm,screenHeight:va,screenWidth:xr,sdCharacterScaleFactor:Ff,wheelInnerRadius:hm,wheelWidth:vm},Symbol.toStringTag,{value:"Module"})),_m=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),xm="#ffe6f4",Sm="#ffbde1",Pm=420,Om=22,Tm=640,Uf=270,$m=7,qf=3,jm=Math.ceil(qf/2),Rm=(va-Uf)/2,Im={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Am=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Sm,ChoiceButtonColor:xm,ChoiceButtonWidth:Pm,ChoiceOuterPadding:jm,ChoicePadding:$m,ChoiceSpacing:Om,ChoiceTextStyle:Im,ChoiceX:Tm,ChoiceY:Rm,ChoiceYOffset:Uf,Outline:qf,nameboxTextOutlineDelta:_m},Symbol.toStringTag,{value:"Module"})),zf="#ffa8d2",Mm="#552222",Dm="#ffeef6",ga="#bb5599",Xf=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Yf=new Ve(.002028397565922768,0,.13725490196078438,0),Gf=.82,Kf=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Jf=12,Zf=12,Bm=.6,Em=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Lm=new Ve(0,-.14285714285714296,.3,0),Nm=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Hm=9.5,Wm=47,Qf=new Ve(.0023347701149424305,0,.10784313725490202,0),qn=3,ep=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Em,controlDisableColorDelta:Lm,controlsDefaultColor:Mm,dotColorDelta:Nm,dotPatternSize:Wm,dotRadius:Hm,nameColorThreshold:Bm,nameboxBackgroundDelta:Yf,nameboxDefaultColor:Dm,nameboxGradientEndDelta:Kf,nameboxGradientMiddleStopPosition:Gf,nameboxRounding:Jf,nameboxStrokeDefaultColor:ga,nameboxTextOutlineDelta:Xf,textboxDefaultColor:zf,textboxOutlineColorDelta:Qf,textboxOutlineWidth:qn,textboxRounding:Zf},Symbol.toStringTag,{value:"Module"})),bo=816,ma=900,Sr=146,Vm=0,Fm=29,Um=8,ms=38,Pr=44,qm=6,zm=93,Xm=404,Ym=9,Gm=9,En=39,bs=168,ys=34,Or=29,ba=12,ya=-126,wa=-72,ka=-38,Ca=30.75,_a=26,tp=426,Ml=58,xa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Tr={...xa,fontName:"riffic",fontSize:24,strokeColor:ga,strokeWidth:6,color:"white",letterSpacing:1},Sa={align:"left",font:"13px aller",fill:{style:"#522"}},np={...Sa,fill:{style:"#a66"}},Km={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Pa={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},yo=xr/2-bo/2,Jm=xr/2-ma/2,Zm=yo+ms,op=yo+ys,Qm=op+bs/2,eb=yo+ya,tb=yo+wa,nb=yo+ka,ob="normal",sb=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:Ca,ArrowYBottomOffset:_a,BaseTextStyle:xa,ControlsTextDisabledStyle:np,ControlsTextStyle:Sa,ControlsXHistory:eb,ControlsXHistoryOffset:ya,ControlsXSkip:tb,ControlsXSkipOffset:wa,ControlsXStuff:nb,ControlsXStuffOffset:ka,ControlsYBottomOffset:ba,DefaultTextboxStyle:ob,GlowRX:tp,GlowRY:Ml,HdSideMargin:Xm,HdSpacing:zm,NameboxHeight:En,NameboxTextStyle:Tr,NameboxTextX:Qm,NameboxTextYOffset:Or,NameboxWidth:bs,NameboxX:op,NameboxXOffset:ys,TextBoxBottomSpacing:qm,TextBoxCorruptedKerning:Um,TextBoxCorruptedStyle:Km,TextBoxCorruptedWidth:ma,TextBoxCorruptedX:Jm,TextBoxHeight:Sr,TextBoxKerning:Vm,TextBoxLineHeight:Fm,TextBoxStyle:Pa,TextBoxTextCorruptedXOffset:Ym,TextBoxTextCorruptedYOffset:Gm,TextBoxTextX:Zm,TextBoxTextXOffset:ms,TextBoxTextYOffset:Pr,TextBoxWidth:bo,TextBoxX:yo},Symbol.toStringTag,{value:"Module"})),rb="#ffe6f4",ib="#ffbde1",lb="rgba(255,255,255,0.6)",ab=40,ub=30,cb={...xa,fontName:"riffic",fontSize:24,strokeColor:ga,strokeWidth:8,letterSpacing:1,color:"white"},db={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},fb=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:lb,NotificationBackgroundColor:rb,NotificationBorderColor:ib,NotificationOkTextStyle:cb,NotificationPadding:ab,NotificationSpacing:ub,NotificationTextStyle:db},Symbol.toStringTag,{value:"Module"})),sp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],pb=0,hb=0,vb=xr/2,gb=va/2,mb=33,bb=100,yb=30,wb=800,kb=720,Cb=Ff,_b="#333333bf",xb=480,Sb=180,Pb=3,Ob=7,dn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},rp=[{...dn,name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0},{...dn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:28},{...dn,name:"Monika",fontName:"journal",fontSize:34},{...dn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32},{...dn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8},{...dn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40},{...dn,name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53},{...dn,name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1}],Tb=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:Cb,consoleBackgroundColor:_b,consoleHeight:Sb,consoleWidth:xb,defaultConsoleBackground:Pb,defaultConsoleStyle:Ob,defaultPoemBackground:pb,defaultPoemHeight:kb,defaultPoemStyle:hb,defaultPoemWidth:wb,defaultX:vb,defaultY:gb,poemBackgrounds:sp,poemBottomPadding:bb,poemPadding:yb,poemTextStyles:rp,poemTopPadding:mb},Symbol.toStringTag,{value:"Module"})),$b={Base:Cm,Choices:Am,Notification:fb,Poem:Tb,TextBox:sb,TextBoxCustom:ep},$r=1920,Oa=1080,jb=128,Rb=32,Ib="rgba(60,60,60,0.8)",Ab=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],ip=1.5,Mb=1,Db=-111,Bb=537,Eb=[300,360,600,740,960,1180,1320,1560,1620],Lb=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:Bb,CloseUpYOffset:Db,WheelBackground:Ib,characterPositions:Eb,hdCharacterScaleFactor:Mb,positions:Ab,screenHeight:Oa,screenWidth:$r,sdCharacterScaleFactor:ip,wheelInnerRadius:jb,wheelWidth:Rb},Symbol.toStringTag,{value:"Module"})),Nb=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Hb="#ffe6f4",Wb="#ffbde1",Vb=630,Fb=33,Ub=960,lp=405,qb=10.5,ap=4.5,zb=Math.ceil(ap/2),Xb=(Oa-lp)/2,Yb={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Gb=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Wb,ChoiceButtonColor:Hb,ChoiceButtonWidth:Vb,ChoiceOuterPadding:zb,ChoicePadding:qb,ChoiceSpacing:Fb,ChoiceTextStyle:Yb,ChoiceX:Ub,ChoiceY:Xb,ChoiceYOffset:lp,Outline:ap,nameboxTextOutlineDelta:Nb},Symbol.toStringTag,{value:"Module"})),up="#ffa8d2",Kb="#552222",Jb="#ffeef6",Ta="#bb5599",cp=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),dp=new Ve(.002028397565922768,0,.13725490196078438,0),fp=.82,pp=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),hp=15,vp=19,Zb=.6,Qb=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),ey=new Ve(0,-.14285714285714296,.3,0),ty=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),ny=9.5*1.5,oy=47*1.5,gp=new Ve(.0023347701149424305,0,.10784313725490202,0),zn=5,mp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Qb,controlDisableColorDelta:ey,controlsDefaultColor:Kb,dotColorDelta:ty,dotPatternSize:oy,dotRadius:ny,nameColorThreshold:Zb,nameboxBackgroundDelta:dp,nameboxDefaultColor:Jb,nameboxGradientEndDelta:pp,nameboxGradientMiddleStopPosition:fp,nameboxRounding:hp,nameboxStrokeDefaultColor:Ta,nameboxTextOutlineDelta:cp,textboxDefaultColor:up,textboxOutlineColorDelta:gp,textboxOutlineWidth:zn,textboxRounding:vp},Symbol.toStringTag,{value:"Module"})),$a=1220,bp=900,yp=219,sy=0,ry=29,iy=8,ja=57,wp=68,ly=54,ay=9,uy=9,Ra=59,Ia=252,Aa=49,kp=43,Cp=12*1.5,_p=-126*1.5,xp=-72*1.5,Sp=-38*1.5,Pp=30.75*1.5,Op=26*1.5,Tp=426*1.5,Dl=58*1.5,Ma={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},$p={...Ma,fontName:"riffic",fontSize:36,strokeColor:Ta,strokeWidth:9,color:"white",letterSpacing:2},or={align:"left",font:"24px aller",fill:{style:"#522"}},jp={...or,fill:{style:"#a66"}},Rp={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},cy={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},wo=$r/2-$a/2,dy=$r/2-bp/2,fy=wo+ja,Ip=wo+Aa,py=Ip+Ia/2,hy=wo+_p,vy=wo+xp,gy=wo+Sp,my="custom_plus",by=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:Pp,ArrowYBottomOffset:Op,BaseTextStyle:Ma,ControlsTextDisabledStyle:jp,ControlsTextStyle:or,ControlsXHistory:hy,ControlsXHistoryOffset:_p,ControlsXSkip:vy,ControlsXSkipOffset:xp,ControlsXStuff:gy,ControlsXStuffOffset:Sp,ControlsYBottomOffset:Cp,DefaultTextboxStyle:my,GlowRX:Tp,GlowRY:Dl,NameboxHeight:Ra,NameboxTextStyle:$p,NameboxTextX:py,NameboxTextYOffset:kp,NameboxWidth:Ia,NameboxX:Ip,NameboxXOffset:Aa,TextBoxBottomSpacing:ly,TextBoxCorruptedKerning:iy,TextBoxCorruptedStyle:cy,TextBoxCorruptedWidth:bp,TextBoxCorruptedX:dy,TextBoxHeight:yp,TextBoxKerning:sy,TextBoxLineHeight:ry,TextBoxStyle:Rp,TextBoxTextCorruptedXOffset:ay,TextBoxTextCorruptedYOffset:uy,TextBoxTextX:fy,TextBoxTextXOffset:ja,TextBoxTextYOffset:wp,TextBoxWidth:$a,TextBoxX:wo},Symbol.toStringTag,{value:"Module"})),yy="#ffe6f4",wy="#ffbde1",ky="rgba(255,255,255,0.6)",Cy=60,_y=45,xy={...Ma,fontName:"riffic",fontSize:36,strokeColor:Ta,strokeWidth:12,letterSpacing:1,color:"white"},Sy={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Py=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:ky,NotificationBackgroundColor:yy,NotificationBorderColor:wy,NotificationOkTextStyle:xy,NotificationPadding:Cy,NotificationSpacing:_y,NotificationTextStyle:Sy},Symbol.toStringTag,{value:"Module"})),Oy=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Ty=0,$y=0,jy=$r/2,Ry=Oa/2,Iy=26,Ay=150,My=61,Dy=1200,By=1080,Ey=ip,Ly="#333333bf",Ny=720,Hy=270,Wy=3,Vy=7,fn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},Fy=[{...fn,name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1},{...fn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5},{...fn,name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5},{...fn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48},{...fn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12},{...fn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60},{...fn,name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53},{...fn,name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1}],Uy=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:Ey,consoleBackgroundColor:Ly,consoleHeight:Hy,consoleWidth:Ny,defaultConsoleBackground:Wy,defaultConsoleStyle:Vy,defaultPoemBackground:Ty,defaultPoemHeight:By,defaultPoemStyle:$y,defaultPoemWidth:Dy,defaultX:jy,defaultY:Ry,poemBackgrounds:Oy,poemBottomPadding:Ay,poemPadding:My,poemTextStyles:Fy,poemTopPadding:Iy},Symbol.toStringTag,{value:"Module"})),qy={Base:Lb,Choices:Gb,Notification:Py,Poem:Uy,TextBox:by,TextBoxCustom:mp};function de(){return ge.gameMode==="ddlc_plus"?qy:$b}const is=Jt(Object.seal({lqRendering:!0,nsfw:!1,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,loadSave(n){},getSave(n){return{}},copyObjectToClipboard(n,t){const e=N.panels.panels[n],o=Object.values(e.objects),s=new Set;for(const a of t){const u=e.objects[a];s.add(u),l(u,u)}const r=Array.from(s).map(a=>a.save()),i=JSON.stringify(r);this.clipboard=i,navigator.clipboard.writeText(i);function l(a,u,c=!0){if(!c&&a===u)throw new Error("Recursively linked object");for(const f of o)f.linkedTo===a.id&&(s.add(f),l(f,u,!1))}},async pasteObjects(n){let t;try{const e=await navigator.clipboard.readText();t=JSON.parse(e)}catch{if(is.clipboard==null)return;t=JSON.parse(is.clipboard)}n.pasteObjects(t)}}));function sr(n,t,e){return n>t?n:t>e?e:t}function oo(n,t){return(n%t+t)%t}function zy(n,t){return n===null&&t===null?!0:n===null||t===null?!1:n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d&&n.e===t.e&&n.f===t.f}function Ap(n){const{a:t,b:e,c:o,d:s,e:r,f:i}=n,l=t*s-e*o,a={x:r,y:i,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const u=Math.sqrt(t*t+e*e);a.rotation=(e>0?Math.acos(t/u):-Math.acos(t/u))/Math.PI*180,a.scaleX=u,a.scaleY=l/u,a.skewX=Math.atan((t*o+e*s)/(u*u))/Math.PI*180,a.skewY=0}else if(o!=0||s!=0){const u=Math.sqrt(o*o+s*s);a.rotation=(Math.PI/2-(s>0?Math.acos(-o/u):-Math.acos(o/u)))/Math.PI*180,a.scaleX=l/u,a.scaleY=u,a.skewX=0,a.skewY=Math.atan((t*o+e*s)/(u*u))/Math.PI*180}return a}var jn={},Zr={},Vu;function Xy(){return Vu||(Vu=1,Object.defineProperty(Zr,"__esModule",{value:!0})),Zr}var Qr={},Fu;function Yy(){return Fu||(Fu=1,Object.defineProperty(Qr,"__esModule",{value:!0})),Qr}var ei={},Uu;function Gy(){return Uu||(Uu=1,Object.defineProperty(ei,"__esModule",{value:!0})),ei}var ti={},qu;function Ky(){return qu||(qu=1,Object.defineProperty(ti,"__esModule",{value:!0})),ti}var ni={},zu;function Jy(){return zu||(zu=1,Object.defineProperty(ni,"__esModule",{value:!0})),ni}var oi={},Xu;function Zy(){return Xu||(Xu=1,Object.defineProperty(oi,"__esModule",{value:!0})),oi}var si={},Yu;function Qy(){return Yu||(Yu=1,Object.defineProperty(si,"__esModule",{value:!0})),si}var ri={},Gu;function e0(){return Gu||(Gu=1,Object.defineProperty(ri,"__esModule",{value:!0})),ri}var ii={},Ku;function t0(){return Ku||(Ku=1,Object.defineProperty(ii,"__esModule",{value:!0})),ii}var li={},Ju;function n0(){return Ju||(Ju=1,Object.defineProperty(li,"__esModule",{value:!0})),li}var ai={},Zu;function o0(){return Zu||(Zu=1,Object.defineProperty(ai,"__esModule",{value:!0})),ai}var ui={},Qu;function s0(){return Qu||(Qu=1,Object.defineProperty(ui,"__esModule",{value:!0})),ui}var ci={},ec;function r0(){return ec||(ec=1,Object.defineProperty(ci,"__esModule",{value:!0})),ci}var di={},tc;function i0(){return tc||(tc=1,Object.defineProperty(di,"__esModule",{value:!0})),di}var fi={},nc;function l0(){return nc||(nc=1,Object.defineProperty(fi,"__esModule",{value:!0})),fi}var pi={},oc;function a0(){return oc||(oc=1,Object.defineProperty(pi,"__esModule",{value:!0})),pi}var hi={},sc;function u0(){return sc||(sc=1,Object.defineProperty(hi,"__esModule",{value:!0})),hi}var vi={},rc;function c0(){return rc||(rc=1,Object.defineProperty(vi,"__esModule",{value:!0})),vi}var gi={},ic;function d0(){return ic||(ic=1,Object.defineProperty(gi,"__esModule",{value:!0})),gi}var mi={},lc;function f0(){return lc||(lc=1,Object.defineProperty(mi,"__esModule",{value:!0})),mi}var bi={},ac;function p0(){return ac||(ac=1,Object.defineProperty(bi,"__esModule",{value:!0})),bi}var yi={},uc;function h0(){return uc||(uc=1,Object.defineProperty(yi,"__esModule",{value:!0})),yi}var wi={},cc;function v0(){return cc||(cc=1,Object.defineProperty(wi,"__esModule",{value:!0})),wi}var ki={},dc;function g0(){return dc||(dc=1,Object.defineProperty(ki,"__esModule",{value:!0})),ki}var Ci={},fc;function m0(){return fc||(fc=1,Object.defineProperty(Ci,"__esModule",{value:!0})),Ci}var _i={},pc;function b0(){return pc||(pc=1,Object.defineProperty(_i,"__esModule",{value:!0})),_i}var xi={},hc;function y0(){return hc||(hc=1,Object.defineProperty(xi,"__esModule",{value:!0})),xi}var Si={},vc;function w0(){return vc||(vc=1,Object.defineProperty(Si,"__esModule",{value:!0})),Si}var Pi={},gc;function k0(){return gc||(gc=1,Object.defineProperty(Pi,"__esModule",{value:!0})),Pi}var Oi={},mc;function C0(){return mc||(mc=1,Object.defineProperty(Oi,"__esModule",{value:!0})),Oi}var Ti={},bc;function _0(){return bc||(bc=1,Object.defineProperty(Ti,"__esModule",{value:!0})),Ti}var $i={},yc;function x0(){return yc||(yc=1,Object.defineProperty($i,"__esModule",{value:!0})),$i}var ji={},wc;function S0(){return wc||(wc=1,Object.defineProperty(ji,"__esModule",{value:!0})),ji}var Ri={},kc;function P0(){return kc||(kc=1,Object.defineProperty(Ri,"__esModule",{value:!0})),Ri}var Ii={},Cc;function O0(){return Cc||(Cc=1,Object.defineProperty(Ii,"__esModule",{value:!0})),Ii}var Ai={},_c;function T0(){return _c||(_c=1,Object.defineProperty(Ai,"__esModule",{value:!0})),Ai}var Mi={},xc;function $0(){return xc||(xc=1,Object.defineProperty(Mi,"__esModule",{value:!0})),Mi}var Di={},Sc;function j0(){return Sc||(Sc=1,Object.defineProperty(Di,"__esModule",{value:!0})),Di}var Bi={},Pc;function R0(){return Pc||(Pc=1,Object.defineProperty(Bi,"__esModule",{value:!0})),Bi}var Ei={},Oc;function I0(){return Oc||(Oc=1,Object.defineProperty(Ei,"__esModule",{value:!0})),Ei}var Li={},Tc;function A0(){return Tc||(Tc=1,Object.defineProperty(Li,"__esModule",{value:!0})),Li}var Ni={},$c;function M0(){return $c||($c=1,Object.defineProperty(Ni,"__esModule",{value:!0})),Ni}var Hi={},jc;function D0(){return jc||(jc=1,Object.defineProperty(Hi,"__esModule",{value:!0})),Hi}var Wi={},Rc;function B0(){return Rc||(Rc=1,Object.defineProperty(Wi,"__esModule",{value:!0})),Wi}var Vi={},Ic;function E0(){return Ic||(Ic=1,Object.defineProperty(Vi,"__esModule",{value:!0})),Vi}var Fi={},Ac;function L0(){return Ac||(Ac=1,Object.defineProperty(Fi,"__esModule",{value:!0})),Fi}var Ui={},Mc;function N0(){return Mc||(Mc=1,Object.defineProperty(Ui,"__esModule",{value:!0})),Ui}var qi={},Dc;function H0(){return Dc||(Dc=1,Object.defineProperty(qi,"__esModule",{value:!0})),qi}var zi={},Bc;function W0(){return Bc||(Bc=1,Object.defineProperty(zi,"__esModule",{value:!0})),zi}var Xi={},Ec;function V0(){return Ec||(Ec=1,Object.defineProperty(Xi,"__esModule",{value:!0})),Xi}var Yi={},Lc;function F0(){return Lc||(Lc=1,Object.defineProperty(Yi,"__esModule",{value:!0})),Yi}var Gi={},Nc;function U0(){return Nc||(Nc=1,Object.defineProperty(Gi,"__esModule",{value:!0})),Gi}var Ki={},Hc;function q0(){return Hc||(Hc=1,Object.defineProperty(Ki,"__esModule",{value:!0})),Ki}var Ji={},Wc;function z0(){return Wc||(Wc=1,Object.defineProperty(Ji,"__esModule",{value:!0})),Ji}var Zi={},Vc;function X0(){return Vc||(Vc=1,Object.defineProperty(Zi,"__esModule",{value:!0})),Zi}var Qi={},Fc;function Y0(){return Fc||(Fc=1,Object.defineProperty(Qi,"__esModule",{value:!0})),Qi}var el={},Uc;function G0(){return Uc||(Uc=1,Object.defineProperty(el,"__esModule",{value:!0})),el}var tl={},qc;function K0(){return qc||(qc=1,Object.defineProperty(tl,"__esModule",{value:!0})),tl}var nl={},zc;function J0(){return zc||(zc=1,Object.defineProperty(nl,"__esModule",{value:!0})),nl}var ol={},Xc;function Z0(){return Xc||(Xc=1,Object.defineProperty(ol,"__esModule",{value:!0})),ol}var sl={},Yc;function Q0(){return Yc||(Yc=1,Object.defineProperty(sl,"__esModule",{value:!0})),sl}var rl={},Gc;function ew(){return Gc||(Gc=1,Object.defineProperty(rl,"__esModule",{value:!0})),rl}var il={},Kc;function tw(){return Kc||(Kc=1,Object.defineProperty(il,"__esModule",{value:!0})),il}var ll={},Jc;function nw(){return Jc||(Jc=1,Object.defineProperty(ll,"__esModule",{value:!0})),ll}var al={},Zc;function ow(){return Zc||(Zc=1,Object.defineProperty(al,"__esModule",{value:!0})),al}var Oo={},Qc;function sw(){if(Qc)return Oo;Qc=1,Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.UnreachableCaseError=void 0;class n extends Error{constructor(e){super(`Unreachable case: ${e}`)}}return Oo.UnreachableCaseError=n,Oo}var To={},ed;function rw(){if(ed)return To;ed=1,Object.defineProperty(To,"__esModule",{value:!0}),To.assert=void 0;function n(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}return To.assert=n,To}var $o={},td;function iw(){if(td)return $o;td=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.createFactoryWithConstraint=void 0;const n=()=>t=>t;return $o.createFactoryWithConstraint=n,$o}var jo={},nd;function lw(){if(nd)return jo;nd=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.isExact=void 0;const n=()=>t=>t;return jo.isExact=n,jo}var Ro={},od;function aw(){if(od)return Ro;od=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.noop=void 0;function n(...t){}return Ro.noop=n,Ro}var ul={},sd;function uw(){return sd||(sd=1,Object.defineProperty(ul,"__esModule",{value:!0})),ul}var rd;function cw(){return rd||(rd=1,function(n){var t=jn&&jn.__createBinding||(Object.create?function(o,s,r,i){i===void 0&&(i=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,i,l)}:function(o,s,r,i){i===void 0&&(i=r),o[i]=s[r]}),e=jn&&jn.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(n,"__esModule",{value:!0}),e(Xy(),n),e(Yy(),n),e(Gy(),n),e(Ky(),n),e(Jy(),n),e(Zy(),n),e(Qy(),n),e(e0(),n),e(t0(),n),e(n0(),n),e(o0(),n),e(s0(),n),e(r0(),n),e(i0(),n),e(l0(),n),e(a0(),n),e(u0(),n),e(c0(),n),e(d0(),n),e(f0(),n),e(p0(),n),e(h0(),n),e(v0(),n),e(g0(),n),e(m0(),n),e(b0(),n),e(y0(),n),e(w0(),n),e(k0(),n),e(C0(),n),e(_0(),n),e(x0(),n),e(S0(),n),e(P0(),n),e(O0(),n),e(T0(),n),e($0(),n),e(j0(),n),e(R0(),n),e(I0(),n),e(A0(),n),e(M0(),n),e(D0(),n),e(B0(),n),e(E0(),n),e(L0(),n),e(N0(),n),e(H0(),n),e(W0(),n),e(V0(),n),e(F0(),n),e(U0(),n),e(q0(),n),e(z0(),n),e(X0(),n),e(Y0(),n),e(G0(),n),e(K0(),n),e(J0(),n),e(Z0(),n),e(Q0(),n),e(ew(),n),e(tw(),n),e(nw(),n),e(ow(),n),e(sw(),n),e(rw(),n),e(iw(),n),e(lw(),n),e(aw(),n),e(uw(),n)}(jn)),jn}var Kt=cw();const id=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);class Da{constructor(){_(this,"_filters",I([]));_(this,"_composite",I("source-over"))}get filters(){return this._filters.value}get composite(){return this._composite.value}set composite(t){this._composite.value,We(()=>void(this._composite.value=t))}addFilter(t,e){let o;switch(t){case"hue-rotate":o=new ls(t,0);break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":o=new ls(t,1);break;case"drop-shadow":o=new jr;break;default:throw new Kt.UnreachableCaseError(t)}const s=this._filters.value;We(()=>void s.splice(e,0,mt(o)))}removeFilter(t){const e=this._filters.value;e[t],We(()=>void e.splice(t,1))}moveFilter(t,e){const o=this._filters.value,s=o[t];We(()=>{o.splice(t,1),o.splice(t+e,0,s)})}}class ls{constructor(t,e=0){_(this,"_value");this.type=t,this._value=I(e)}get value(){return this._value.value}set value(t){this.value,We(()=>void(this._value.value=t))}clone(){return new ls(this.type,this.value)}getSave(){return{type:this.type,value:this.value}}}class jr{constructor(){_(this,"type","drop-shadow");_(this,"_offsetX",I(10));_(this,"_offsetY",I(10));_(this,"_blurRadius",I(0));_(this,"_color",I("#555555"))}get offsetX(){return this._offsetX.value}set offsetX(t){this._offsetX.value,We(()=>void(this._offsetX.value=t))}get offsetY(){return this._offsetY.value}set offsetY(t){this._offsetY.value,We(()=>void(this._offsetY.value=t))}get blurRadius(){return this._blurRadius.value}set blurRadius(t){this._blurRadius.value,We(()=>void(this._blurRadius.value=t))}get color(){return this._color.value}set color(t){this._color.value,We(()=>void(this._color.value=t))}clone(){const t=new jr;return t._offsetX.value=this._offsetX.value,t._offsetY.value=this._offsetY.value,t._blurRadius.value=this._blurRadius.value,t._color.value=this._color.value,t}getSave(){return{type:"drop-shadow",offsetX:this._offsetX.value,offsetY:this._offsetY.value,blurRadius:this._blurRadius.value,color:this._color.value}}}function Ba(n){const t=[];for(const e of n)if(e.type==="drop-shadow"){const o=new jr;o.offsetX=e.offsetX,o.offsetY=e.offsetY,o.blurRadius=e.blurRadius,o.color=e.color,t.push(mt(o))}else{const o=new ls(e.type,e.value);t.push(mt(o))}return t}class ko extends Da{constructor(e,o,s){super();_(this,"panelId");_(this,"id");_(this,"_onTop",D({get:()=>this.panel.topOrder.includes(this.id),set:e=>{this.panel.setOnTop(this,e)}}));_(this,"_version",I(0));_(this,"_x");_(this,"_y",I(0));_(this,"_width",I(0));_(this,"_height",I(0));_(this,"_preserveRatio",I(!0));_(this,"_ratio",I(1));_(this,"_flip",I(!1));_(this,"_linkedTo",I(null));_(this,"_scaleX",I(1));_(this,"_scaleY",I(1));_(this,"_skewX",I(0));_(this,"_skewY",I(0));_(this,"_rotation",I(0));_(this,"_isTalking",D(()=>!!Object.values(this.panel.objects).find(e=>e.type==="textBox"&&e.talkingObjId===this.id)));_(this,"_localTransform",D(()=>{let e=new DOMMatrix;e=e.translate(this.x,this.y);const o=this.height/2*this.scaleX;return"close"in this&&this.close&&(e=e.translate(0,de().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&this.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),this.rotation!==0&&(e=e.rotate(0,0,this.rotation)),this.skewX!==0&&(e=e.skewX(this.skewX)),this.skewY!==0&&(e=e.skewY(this.skewY)),this.flip&&(e=e.flipX()),(this.scaleX!==1||this.scaleY!==1)&&(e=e.scale(this.scaleX,this.scaleY)),e}));_(this,"_globalTransform",D(()=>{if(this._linkedTo.value){const e=this.panel.objects[this._linkedTo.value];return e?e.globalTransform.multiply(this.localTransform):this.localTransform}else return this.localTransform}));_(this,"_label",I(null));_(this,"_textboxColor",I(null));_(this,"_enlargeWhenTalking",I(!1));_(this,"_nameboxWidth",I(null));this.panel=e,this.panelId=e.id,s==null&&(s=e.lastObjId+1),this.id=s;const r=de();this._x=I(r.Base.screenWidth/2),e.insertObject(this,o)}mutate(e,o){this._version.value;const s=this._version.value+1;e.value!==o&&We(()=>{e.value=o,this._version.value=s})}mutateX(e,o){this._version.value;const s=this._version.value+1,r=e.map(i=>i.value);for(let i=0;i<e.length;i++)e[i].value===o[i]&&(e.splice(i,1),o.splice(i,1),r.splice(i,1));e.length!==0&&We(()=>{for(let i=0;i<e.length;i++)e[i].value=o[i];this._version.value=s})}prepareSiblingRemoval(e){this.linkedTo===e.id&&(this.linkedTo=null)}get version(){return this._version.value}get x(){return this._x.value}set x(e){this.mutate(this._x,e)}get y(){return this._y.value}set y(e){this.mutate(this._y,e)}get width(){return this._width.value}set width(e){this.mutate(this._width,e)}get height(){return this._height.value}set height(e){this.mutate(this._height,e)}get preserveRatio(){return this._preserveRatio.value}set preserveRatio(e){this.mutateX([this._preserveRatio,this._ratio],[e,e?this.width/this.height:0])}get ratio(){return this._ratio.value}get flip(){return this._flip.value}set flip(e){this.mutate(this._flip,e)}get onTop(){return this._onTop.value}set onTop(e){this._onTop.value=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){if(this.linkedTo!==e)if(e!==null){if(e===this.id)throw new Error("Object cannot link to itself.");const o=this.panel.objects[e];let s=o;for(;s.linkedTo!==null;){if(s.linkedTo===this.id)throw new Error("Objects cannot be linked recursively.");s=this.panel.objects[s.linkedTo]}const i=o.globalTransform.inverse().multiply(this.globalTransform);this.mutateByMatrix(i),this.mutate(this._linkedTo,e)}else this.mutateByMatrix(this.globalTransform),this.mutate(this._linkedTo,null)}mutateByMatrix(e){const o=Ap(e);this.mutateX([this._scaleX,this._scaleY,this._skewX,this._skewY,this._rotation,this._x,this._y],[ut(o.scaleX),ut(o.scaleY),ut(o.skewX),ut(o.skewY),ut(o.rotation),ut(o.x),ut(o.y)])}get scaleX(){return this._scaleX.value}set scaleX(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[ut(e),ut(e*this.ratio)]):this.mutate(this._scaleX,ut(e))}get scaleY(){return this._scaleY.value}set scaleY(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[ut(e/this.ratio),ut(e)]):this.mutate(this._scaleY,ut(e))}get skewX(){return this._skewX.value}set skewX(e){this.mutate(this._skewX,ut(oo(e,180)))}get skewY(){return this._skewY.value}set skewY(e){this.mutate(this._skewY,ut(oo(e,180)))}get rotation(){return this._rotation.value}set rotation(e){this.mutate(this._rotation,ut(oo(e,360)))}get isTalking(){return this._isTalking.value}get localTransform(){return this._localTransform.value}get globalTransform(){return this._globalTransform.value}get label(){return this._label.value}set label(e){this.mutate(this._label,e)}get textboxColor(){return this._textboxColor.value}set textboxColor(e){this.mutate(this._textboxColor,e)}get enlargeWhenTalking(){return this._enlargeWhenTalking.value}set enlargeWhenTalking(e){this.mutate(this._enlargeWhenTalking,e)}get nameboxWidth(){return this._nameboxWidth.value}set nameboxWidth(e){this.mutate(this._nameboxWidth,e)}fixContentPackRemoval(e){}moveAllRefs(e,o){for(const[s,r]of Object.entries(e))ve(r)&&(s==="_filters"?o[s].value=r.value.map(i=>mt(i.clone())):s==="_choices"?o[s].value=r.value.map(i=>({...i})):o[s].value=r.value)}loadPropsFromSave(e,o){for(const[s,r]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(s.startsWith("_")){const i=r.value,l=s.substring(1);if(l==="version")continue;l in e&&ve(i)&&!ln(i)&&!("effect"in i)&&(l==="linkedTo"?i.value=o.get(e[l]):l==="filters"?i.value=Ba(e[l]):i.value=e[l])}}save(){const e={id:this.id,type:this.type,panelId:this.panelId,onTop:this.onTop};for(const[o,s]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(o.startsWith("_")){const r=s.value;ve(r)&&!ln(r)&&!("effect"in r)&&(o==="_filters"?e.filters=r.value.map(i=>i.getSave()):e[o.substring(1)]=r.value)}return e}}function ut(n){return Math.round(n*100)/100}let Mp=class As extends ko{constructor(e,o,s,r){super(e,r??!1,s);_(this,"_freeMove",I(!1));_(this,"_close",I(!1));_(this,"_styleGroupId",I(0));_(this,"_styleId",I(0));_(this,"_poseId",I(0));_(this,"_posePositions",I({}));_(this,"_characterData",D(()=>jt.characters.get(this.characterType)));_(this,"_poseData",D(()=>{var e,o,s;return(s=(o=(e=this._characterData.value)==null?void 0:e.styleGroups[this._styleGroupId.value])==null?void 0:o.styles[this._styleId.value])==null?void 0:s.poses[this._poseId.value]}));_(this,"_headData",D(()=>{var o,s;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:(s=this._characterData.value)==null?void 0:s.heads[e[0]]}));_(this,"_availablePartsKeys",D(()=>{const e=this._poseData.value;if(!e)return[];const o=Object.keys(e.positions).filter(s=>e.positions[s].length>1);return e.compatibleHeads.length>0&&o.unshift("head"),o}));_(this,"_heads",D(()=>{var o;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:this._characterData.value.heads[e[this.posePositions.headType||0]]}));this.characterType=o;const i=de(),l=this.charData,a=l.hd?i.Base.hdCharacterScaleFactor:i.Base.sdCharacterScaleFactor;this._y.value=i.Base.BaseCharacterYPos,this._width.value=l.size[0],this._height.value=l.size[1],this._scaleX.value=l.defaultScale[0]*a,this._scaleY.value=l.defaultScale[1]*a,this._label.value=l.label??l.id,this._enlargeWhenTalking.value=is.defaultCharacterTalkingZoom}get type(){return"character"}static create(e,o){return new As(e,o)}makeClone(e,o){const s=new As(e,this.characterType,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new As(e,o.characterType,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.characterType=this.characterType,e}get freeMove(){return this._freeMove.value}set freeMove(e){if(!(!e&&this.linkedTo!=null))if(e)this.mutate(this._freeMove,!0);else{const o=de();this.mutateX([this._freeMove,this._x,this._y],[!1,o.Base.characterPositions[Ms(this.x)],o.Base.BaseCharacterYPos])}}get x(){return this._x.value}set x(e){this.freeMove||(e=de().Base.characterPositions[Ms(e)]),super.x=e}get y(){return this._y.value}set y(e){this.freeMove||(e=de().Base.BaseCharacterYPos),super.y=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){super.linkedTo=e,this._linkedTo.value!=null&&this.mutate(this._freeMove,!0)}shiftCharacterSlot(e){const o=de();let r=Ms(this.x)+e;r<0&&(r=0),r>=o.Base.characterPositions.length&&(r=o.Base.characterPositions.length-1),this.x=o.Base.characterPositions[r]}get close(){return this._close.value}set close(e){this.mutate(this._close,e)}get styleId(){return this._styleId.value}set styleId(e){this.mutate(this._styleId,e)}get styleGroupId(){return this._styleGroupId.value}get posePositions(){return this._posePositions.value}get poseId(){return this._poseId.value}setPosePosition(e){this.mutate(this._posePositions,{...this._posePositions.value,...e})}seekPart(e,o){if(e==="head"){this.seekHead(o);return}const s=this._poseData.value;s.positions[e]&&this.setPosePosition({[e]:Eo(s.positions[e],this.posePositions[e]||0,o)})}seekPose(e){const s=this._characterData.value.styleGroups[this._styleGroupId.value].styles[this.styleId].poses;this.mutatePoseAndPositions(r=>{r.poseId=Eo(s,r.poseId,e)})}seekStyle(e){const s=this._characterData.value.styleGroups.flatMap((i,l)=>i.styles.map((a,u)=>({styleGroupIdx:l,styleIdx:u,styleGroupJson:JSON.stringify(a.components)}))).sort((i,l)=>i.styleGroupJson.localeCompare(l.styleGroupJson)),r=s.findIndex(i=>i.styleGroupIdx===this.styleGroupId&&i.styleIdx===this.styleId);this.mutatePoseAndPositions(i=>{const l=Eo(s,r,e),a=s[l];i.styleGroupId=a.styleGroupIdx,i.styleId=a.styleIdx})}seekHead(e){const o=this._characterData.value,s=this._poseData.value,r=this.posePositions;if(s.compatibleHeads.length===0)return null;let i=r.headType||0,l=o.heads[s.compatibleHeads[i]];if(!l)return;let a=(r.head||0)+e;(a<0||a>=l.variants.length)&&(i=Eo(s.compatibleHeads.map(u=>o.heads[u]),i,e),l=o.heads[s.compatibleHeads[i]],a=e===1?0:l.variants.length-1),this.setPosePosition({head:a,headType:i})}setPart(e,o){e==="pose"?this.mutatePoseAndPositions(s=>{s.poseId=o}):e==="style"?this.mutatePoseAndPositions(s=>{s.styleId=o}):this.mutatePoseAndPositions(s=>{s.posePositions[e]=o})}setCharStyle(e,o){this.mutatePoseAndPositions(s=>{s.styleGroupId=e,s.styleId=o})}get charData(){return this._characterData.value}get poseData(){return this._poseData.value}get availablePartsKeys(){return this._availablePartsKeys.value}mutatePoseAndPositions(e){const o=this._characterData.value,s=this.buildPoseAndPositionData();e(s),o.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=o.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const i=r.styles[s.styleId];i.poses[s.poseId]||(s.poseId=0);const l=i.poses[s.poseId];for(const f in l.positions)l.positions[f]&&(l.positions[f][s.posePositions[f]]||(s.posePositions[f]=0));const u=o.styleGroups[this._styleGroupId.value].styles[this.styleId].poses[this._poseId.value].compatibleHeads[this._posePositions.value.headType||0],c=l.compatibleHeads.indexOf(u);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),this.commitPoseAndPositionChanges(s)}commitPoseAndPositionChanges(e){JSON.stringify(e.posePositions)!==JSON.stringify(this._posePositions.value)&&this.mutate(this._posePositions,e.posePositions),this.mutateX([this._styleGroupId,this._styleId,this._poseId],[e.styleGroupId,e.styleId,e.poseId])}buildPoseAndPositionData(){return{styleGroupId:this._styleGroupId.value,styleId:this._styleId.value,poseId:this._poseId.value,posePositions:{...this._posePositions.value}}}get headsData(){return this._heads.value}};function Ms(n){return de().Base.characterPositions.map((o,s)=>({pos:Math.abs(n-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}let Dp=class Ds extends ko{constructor(e,o,s){super(e,s??!0,o);_(this,"_customColor");_(this,"_choices",I([{selected:!1,text:"Click here to edit choice"}]));_(this,"_choiceDistance");_(this,"_autoWrap",I(!0));const r=de();this._choiceDistance=I(r.Choices.ChoiceSpacing),this._customColor=I(r.Choices.ChoiceButtonColor),this._y.value=r.Choices.ChoiceY,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"choice"}static create(e){return new Ds(e)}makeClone(e,o){const s=new Ds(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Ds(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get choices(){return this._choices.value}addChoice(e){const o={selected:!1,text:e};We(()=>void this._choices.value.push(o))}removeChoice(e){this._choices.value[e],We(()=>void this._choices.value.splice(e,1))}setChoiceProperty(e,o,s){this._choices.value[e][o];const r=this._version.value;We(()=>{this._choices.value[e][o]=s,this._version.value=r+1})}get choiceDistance(){return this._choiceDistance.value}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}},Bp=class Bs extends ko{constructor(e,o,s){super(e,s??!0,o);_(this,"_text",I("Click here to edit notification"));_(this,"_autoWrap",I(!1));_(this,"_backdrop",I(!0));_(this,"_customColor");const r=de();this._customColor=I(r.Choices.ChoiceButtonColor),this._y.value=r.Base.screenHeight/2,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"notification"}static create(e){return new Bs(e)}makeClone(e,o){const s=new Bs(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Bs(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get backdrop(){return this._backdrop.value}set backdrop(e){this.mutate(this._backdrop,e)}},Bl=class Lo extends ko{constructor(e,o,s,r){super(e,r??!0,s);_(this,"_autoWrap",I(!0));_(this,"_overflow",I(!1));_(this,"_text",I(""));_(this,"_background",I(0));_(this,"_font",I(0));_(this,"_consoleColor",I(null));this.subtype=o;const i=de();o==="poem"?(this._x.value=i.Poem.defaultX,this._y.value=i.Poem.defaultY,this._height.value=i.Poem.defaultPoemHeight,this._width.value=i.Poem.defaultPoemWidth,this._background.value=i.Poem.defaultPoemBackground,this._font.value=i.Poem.defaultPoemStyle,this._text.value=`New poem

Click here to edit poem`):(this._x.value=i.Poem.consoleWidth/2,this._y.value=i.Poem.consoleHeight/2,this._height.value=i.Poem.consoleHeight,this._width.value=i.Poem.consoleWidth,this._background.value=i.Poem.defaultConsoleBackground,this._font.value=i.Poem.defaultConsoleStyle,this._text.value=`> _
  
  Console command
  Click here to edit`)}get type(){return"poem"}static createPoem(e){return new Lo(e,"poem")}static createConsole(e){return new Lo(e,"console")}makeClone(e,o){const s=new Lo(e,this.subtype,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Lo(e,o.subtype,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.subtype=this.subtype,e}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get background(){return this._background.value}set background(e){this.mutate(this._background,e)}get font(){return this._font.value}set font(e){this.mutate(this._font,e)}get consoleColor(){return this._consoleColor.value}set consoleColor(e){this.mutate(this._consoleColor,e)}},Ea=class Es extends ko{constructor(t,e,o,s){super(t,s??!1,o),this.assets=e,this._enlargeWhenTalking.value=is.defaultCharacterTalkingZoom}get type(){return"sprite"}static create(t,e){return new Es(t,e)}makeClone(t,e){const o=new Es(t,this.assets,e.get(this.id));return this.moveAllRefs(this,o),o}static fromSave(t,e,o){const s=new Es(t,e.assets,o.get(e.id),e.onTop);return s.loadPropsFromSave(e,o),s}save(){const t=super.save();return t.assets=this.assets,t}};const ld=5;class dw{constructor(t){_(this,"pos",0);this.str=t}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-ld),this.pos+ld)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function ad(n,t=!0){const e=[],o=new dw(n);let s=Rr;for(;s!==Ir;){const r=o.pos;try{s=s(e,o)}catch(i){if(t&&s!==El)o.pos=r,s=(l,a)=>El(l,a,!0);else throw i}}return e}function Rr(n,t){return t.current()===void 0?Ir:t.current()==="{"?fw:t.current()===`
`?pw:El}function Ir(){return Ir}function El(n,t,e=!1){const{pos:o}=t;let s="",r=e,i;for(;;){if(t.current()===void 0){i=Ir;break}else if(r)s+=t.current(),r=!1;else if(t.current()==="\\")r=!0;else if(t.current()==="{"||t.current()===`
`){i=Rr;break}else s+=t.current();t.next()}return n.push({type:"text",pos:o,content:s}),i}function cl(n,t){throw new Error(`Error when parsing text at position ${n.pos}: (around: "${n.around}") ${t}`)}function fw(n,t){const{pos:e}=t;if(t.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=t.next()==="/";o&&t.next();let s="",r="",i=!1;for(;t.current()===void 0&&cl(t,"Unexpected end of text inside a command"),t.current()!=="}";)i?r+=t.current():t.current().match(/[a-z]/i)?s+=t.current():t.current()==="="?(o&&cl(t,"Closing commands may not contain arguments"),i=!0):cl(t,`Unexpected character '${t.current()}' in command name.`),t.next();return t.next(),o?n.push({type:"commandClose",commandName:s,pos:e}):n.push({type:"command",pos:e,argument:r,commandName:s}),Rr}function pw(n,t){return n.push({type:"newline",pos:t.pos}),t.next(),Rr}function uo(n){n.width=0,n.height=0,La.delete(n.disposalId||0)}function Ln(){const n=document.createElement("canvas");return vw(n),n}const La=new Map;let hw=0;function vw(n){n.disposalId=hw++,!(typeof WeakRef>"u")&&La.set(n.disposalId,new WeakRef(n))}window.addEventListener("unload",()=>{La.forEach(n=>{const t=n.deref();t&&uo(t)})});const ud=new Map([Fn("i",n=>({...n,isItalic:!0})),Fn("b",n=>({...n,isBold:!0})),Fn("u",n=>({...n,isUnderlined:!0})),Fn("s",n=>({...n,isStrikethrough:!0})),Fn("plain",n=>({...n,isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),Fn("edited",n=>({...n,fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),Ps("k",(n,t,e)=>({...n,letterSpacing:t?n.letterSpacing+e:e})),Ps("size",(n,t,e)=>({...n,fontSize:t?n.fontSize+e:e})),Ps("alpha",(n,t,e)=>({...n,alpha:t?n.alpha+e:e})),Ps("stroke",(n,t,e)=>({...n,strokeWidth:t?n.strokeWidth+e:e})),["font",(n,t)=>({...n,fontName:t})],["color",(n,t)=>({...n,color:t})],["outlinecolor",(n,t)=>({...n,strokeColor:t})]]);function Fn(n,t){return[n,(e,o)=>{if(o!=="")throw new Error(`Operator '${n}' does not take any arguments.`);return t(e)}]}function Ps(n,t){return[n,(e,o)=>{if(o=="")throw new Error(`Operator '${n}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${n}' needs a numeric argument.`);return t(e,s,r)}]}class At{constructor(t,e){_(this,"renderParts");_(this,"tokens");_(this,"loose");_(this,"lastLayoutHeight",null);_(this,"lastLayoutWidth",null);this.str=t,this.baseStyle=e,this.loose=ge.state.looseTextParsing;try{this.tokens=ad(t,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=At.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const t=new Set;let e=null;for(const s of this.renderParts)"style"in s&&s.style!==e&&(e=s.style,e.fontName&&t.add(e.fontName));const o=[];for(const s of t){const r=document,i=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(i)||o.push(r.fonts.load(i))}if(o.length!==0)return Promise.all(o).then(()=>{const s=ad(this.str);this.renderParts=At.getRenderParts(s,this.baseStyle,this.loose)})}render(t){t.save();let e=null;for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),e.strokeWidth>0&&e.strokeColor>""&&t.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),t.fillText(o.character,o.x,o.y));t.restore()}quote(){let t;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(t||(t={}));let e=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const i=this.renderParts[r];if(i.type==="character")switch(o){case 0:if(i.character.match(/\s/))continue;i.character==='"'?(o=1,e=r):i.character==="*"?(o=3,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Io(i.style,'"')}),r++,e=r,o=2);break;case 1:e=r,i.character==='"'&&(o=0);break;case 2:if(i.character.match(/\s/))continue;i.character==="*"&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Io(i.style,'"')}),o=3,r++),e=r;break;case 3:i.character==="*"&&(o=0),e=r;break;default:throw new Kt.UnreachableCaseError(o)}}const s=this.renderParts[e];s&&o===3&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:Io(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:Io(s.style,'"')})}applyLayout(t,e,o,s,r){const i=this.renderParts,l=[];let a=null,u=0,c=0;const f=()=>{a={type:"group",renderParts:[],height:0,width:0},u=s,c=-1,l.push(a)};f();for(const p of i)if(p.type==="newline"||p.type==="alignment")if(l.push(p),p.type==="alignment"&&r){const O=u;f(),u=O}else f();else{if(u<p.width&&r){const O={type:"newline",height:p.height,width:p.height,x:0,y:0};if(p.character===" "){l.push(O),f();continue}else if(c!==-1){const M=a.renderParts.splice(c).slice(1),A=M.reduce((T,$)=>T+$.width,0),g=M.reduce((T,$)=>T>$.height?T:$.height,0);a.width-=A,a.height===g&&(a.height=a.renderParts.reduce((T,$)=>T>$.height?T:$.height,0)),l.push(O),f(),a.renderParts=M,a.width=A,a.height=g,u-=A}}else p.character===" "&&(c=a.renderParts.length);a.renderParts.push(p),a.height=Math.max(a.height,p.height),a.width+=p.width,u-=p.width}const m=[];let b=0;for(const p of l)b=Math.max(b,p.height),p.type==="newline"&&(m.push(b),b=0);m.push(b);let x=0,k=t,y=o,w=0,h=s;for(const p of l){if(p.type==="newline"){y+=m[++x]||0,w=0,h=s;continue}if(p.type==="alignment"){k=p.alignment;continue}switch(k){case"left":v(p,w,y),w+=p.width;break;case"center":v(p,w+(h-w)/2-p.width/2,y);break;case"right":v(p,h-p.width,y),h-=p.width;break}}this.lastLayoutHeight=y,this.lastLayoutWidth=s;function v(p,O,M){let A=O;for(const g of p.renderParts)g.y=M,g.x=e+A,A+=g.width}}getHeight(t){let e=0,o=0;const s=t===0?this.renderParts:At.applyLineWrapping(this.renderParts.slice(0),t);for(const r of s)e=Math.max(e,r.height),r.type==="newline"&&(o+=e,e=0);return o+=e,o}getWidth(){let t=0,e=0;for(const o of this.renderParts)t+=o.width,o.type==="newline"&&(e=Math.max(e,t),t=0);return e=Math.max(e,t),e}static getRenderParts(t,e,o){const s=[],r=[],i=[];let l=fd(e),a=e,u=null;function c(f){for(const m of f)s.push({type:"character",character:m,height:l,width:Io(a,m),style:a,x:0,y:0})}for(const f of t){const m=f.type;switch(m){case"command":if(f.commandName==="align"){const b=f.argument.toLowerCase();if(b!=="left"&&b!=="center"&&b!=="right")if(o){c("{align="+f.argument+"}");continue}else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);s.push({type:"alignment",alignment:b,height:l,width:0,x:0,y:0})}else if(ud.has(f.commandName)){r.push(a),i.push(u);try{a=ud.get(f.commandName)(a,f.argument),l=fd(a),u=f}catch(b){if(o){r.pop(),i.pop(),c("{"+f.commandName+(f.argument?"="+f.argument:"")+"}"),console.error("Parsing error",b);continue}else throw b}}else if(o)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!u)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==u.commandName)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${u}' first. (Opened at position ${u.pos})`);u=i.pop(),a=r.pop();break;case"newline":s.push({height:l,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new Kt.UnreachableCaseError(m)}}return s}static applyLineWrapping(t,e){let o=-1,s=0,r=0;const i=[];for(const l of t)if(l.type==="newline")o=-1,s=0,r=0,i.push(l);else if(l.type==="alignment")console.error("Alignment in context where it's not supported.");else if(l.type==="character")l.character===" "?s>e?(o=-1,s=0,r=0,i.push({type:"newline",height:l.height,width:0,x:0,y:0})):(s+=l.width,r=s,o=i.length,i.push(l)):(s+=l.width,s>e&&o!==-1&&(s-=r,i.splice(o,1,{type:"newline",height:l.height,width:0,x:0,y:0}),o=-1,r=0),i.push(l));else throw new Kt.UnreachableCaseError(l);return i}}const Na=Ln();Na.width=0;Na.height=0;const cd=Na.getContext("2d");let dd=null;function Io(n,t){n!==dd&&(Ll(n,cd),dd=n);let e=n.letterSpacing;return(typeof e!="number"||isNaN(e)||!isFinite(e))&&(e=0),cd.measureText(t).width+e}const dl=new Map;function fd(n){const t=n.fontSize+" "+n.fontName;if(dl.has(t))return dl.get(t)*n.lineSpacing;const e=document.createElement("span");e.innerHTML="Hg",e.style.fontFamily=n.fontName,e.style.fontSize=`${n.fontSize}px`,e.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=n.fontName,o.style.fontSize=`${n.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(e),document.body.appendChild(o);try{const s=o.offsetHeight;return dl.set(t,s),s*n.lineSpacing}finally{o.remove()}}function Ll(n,t){t.textAlign="left",t.font=(n.isItalic?"italic ":"")+(n.isBold?"bold ":"")+n.fontSize+"px "+n.fontName,t.lineJoin="round",n.strokeWidth>0&&n.strokeColor>""?(t.strokeStyle=n.strokeColor,t.lineWidth=n.strokeWidth):(t.strokeStyle="",t.lineWidth=0),t.globalAlpha=n.alpha||0,t.fillStyle=n.color}var on=(n=>(n[n.None=0]="None",n[n.Selected=1]="Selected",n[n.Focused=2]="Focused",n[n.Indirectly=4]="Indirectly",n))(on||{});const gw={0:void 0,1:"#f00",2:"#00f",3:"#f0f",4:"#f66",6:"#f6f"};function Ep(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.arcTo(t+o,e+s,t,e+s,r),n.arcTo(t,e+s,t,e,r),n.arcTo(t,e,t+o,e,r),n.closePath()}function Lp(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.lineTo(t+o,e+s),n.lineTo(t,e+s),n.arcTo(t,e,t+o,e,r),n.closePath()}function wn(n,t){n.save();try{t()}finally{n.restore()}}function Yo(n,t){t.align&&(n.textAlign=t.align),t.font!=null&&(n.font=t.font),t.fill&&(n.fillStyle=t.fill.style),t.outline&&(n.strokeStyle=t.outline.style,n.lineWidth=t.outline.width)}function mw(n,t){if("filter"in n){let e="";for(const o of t)o.type==="drop-shadow"?e+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?e+=` hue-rotate(${o.value}deg)`:o.type==="blur"?e+=` blur(${o.value}px)`:e+=` ${o.type}(${o.value*100}%)`;n.filter=(n.filter==="none"?"":n.filter)+e.trimStart()}else{let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);n.globalAlpha*=e}}class Np{constructor(t){_(this,"lastVersion",null);_(this,"localCanvasInvalid",!0);_(this,"lastHit",null);_(this,"lastLocalTransform",null);_(this,"refTextbox",null);_(this,"transformOverride",null);_(this,"hitDetectionFallback",!1);_(this,"localCanvas",null);this.obj=t}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let t=new DOMMatrix;const e=this.obj;t=t.translate(this.x,this.y);const o=this.height/2*e.scaleX;return"close"in e&&e.close&&(t=t.translate(0,de().Base.CloseUpYOffset),t=t.translate(0,-o),t=t.scale(2,2),t=t.translate(0,o)),this.isTalking&&e.enlargeWhenTalking&&(t=t.translate(0,+o),t=t.scale(1.05,1.05),t=t.translate(0,-o)),(e.flip||e.rotation!==0||e.scaleX!==1||e.scaleY!==1||e.skewX!==0||e.skewY!==0)&&(e.rotation!==0&&(t=t.rotate(0,0,e.rotation)),e.skewX!==0&&(t=t.skewX(e.skewX)),e.skewY!==0&&(t=t.skewY(e.skewY)),e.flip&&(t=t.flipX()),(e.scaleX!==1||e.scaleY!==1)&&(t=t.scale(e.scaleX,e.scaleY))),t}getLocalSize(){if(this.transformIsLocal){const t=de();return new DOMPointReadOnly(t.Base.screenWidth,t.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.refTextbox!==null}get linkedTo(){return this.obj.linkedTo}get transform(){return this.transformOverride!=null?this.transformOverride:this.obj.globalTransform}prepareData(t){this.refTextbox=null;const e=[...t.lowerOrder,...t.topOrder];for(const o of e){const s=t.objects[o];if(s.type==="textBox"&&s.talkingObjId===this.obj.id){this.refTextbox=s;return}}}prepareRender(t){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const e=this.transform;zy(e,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=e)}else this.lastLocalTransform=null}render(t,e,o,s,r){o||(e=on.None),(!this.canSkipLocal||e!==on.None)&&(r=!1);const i=this.getLocalSize(),l=this.transform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==i.x||this.localCanvas.height!==i.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=Ln()),this.localCanvas.width=i.x,this.localCanvas.height=i.y;const u=this.localCanvas.getContext("2d");if(!u)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&u.setTransform(l),this.renderLocal(u,s),this.localCanvasInvalid=!1,u.resetTransform()}const a=gw[e];wn(t,()=>{a!=null&&(t.shadowColor=a,t.shadowBlur=20),(!this.transformIsLocal||r)&&t.setTransform(l),t.globalCompositeOperation=this.obj.composite??"source-over",mw(t,this.obj.filters),r?this.renderLocal(t,s):this.localCanvas&&this.localCanvas.height!==0&&this.localCanvas.width!==0&&t.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(t){const e=t.matrixTransform(this.transform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(e.x<0||e.y<0||e.x>o.x||e.y>o.y)return console.log("Hitbox text",e),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?t:e;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}class Ar extends Np{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const t=this.obj.globalTransform;return"overflow"in this.obj&&this.obj.overflow?!0:ge.supports.limitedCanvasSpace?!1:!(t.a===1&&t.b===0&&t.c===0&&t.d===1)}}class co{constructor(t){_(this,"width");_(this,"height");this.html=t,this.width=t.width,this.height=t.height}paintOnto(t,e={}){const{w:o,h:s}={w:this.width,h:this.height,...e},{x:r,y:i}={x:-o/2,y:-s/2,...e};t.drawImage(this.html,r,i,o,s)}}class Ha{constructor(t){_(this,"nextArrow",null);this.base=t}static get defaultWidth(){return bo}static get defaultHeight(){return Sr+En}static get defaultX(){return de().Base.screenWidth/2}static get defaultY(){return de().Base.screenHeight-this.defaultHeight/2-de().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Sa}getControlsDisabledStyle(){return np}get textboxStyle(){return Pa}renderControls(t,e){const s=this.width/2,r=this.getControlsStyle();Yo(t,r),t.fillText("History",s+ya,e),Yo(t,this.base.obj.skip?r:this.getControlsDisabledStyle()),t.fillText("Skip",s+wa,e),Yo(t,r),t.fillText("Auto   Save   Load   Settings",s+ka,e)}prepare(){if(!(this.nextArrow instanceof co))return(async()=>{this.nextArrow=await us("next")})()}}class Yn extends Ha{constructor(){super(...arguments);_(this,"backgroundImage","textbox");_(this,"xOffset",0);_(this,"nameBoxAsset",null);_(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return Sr+En}get width(){return bo}get nameboxWidth(){return bs}get nameboxHeight(){return En}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}renderNamebox(e,o,s){var r;(r=this.nameBoxAsset)==null||r.paintOnto(e,{x:o,y:s})}renderBackdrop(e,o,s){var r;o+=this.xOffset,(r=this.backdropAsset)==null||r.paintOnto(e,{x:o,y:s})}render(e){var l;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,i=r-ba;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&((l=this.nextArrow)==null||l.paintOnto(e,{x:o-Ca,y:r-_a}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof co?void 0:(async()=>{this.backdropAsset=await us(this.backgroundImage)})(),this.nameBoxAsset instanceof co?void 0:(async()=>{this.nameBoxAsset=await us("namebox")})()])}}_(Yn,"id","normal"),_(Yn,"label","Normal"),_(Yn,"priority",0),_(Yn,"gameMode","ddlc");class No extends Yn{constructor(){super(...arguments);_(this,"backgroundImage","textbox_monika");_(this,"xOffset",(bo-ma)/2)}}_(No,"id","corrupt"),_(No,"label","Corrupted"),_(No,"priority",1),_(No,"gameMode","ddlc");class Gn extends Ha{constructor(){super(...arguments);_(this,"_dotPattern",null);_(this,"_lastColor",null);_(this,"backgroundImage","textbox");_(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth??bs}get nameboxHeight(){return En}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return{...Tr,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return ms}get textOffsetY(){return Pr}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:zf}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(Xf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(Yf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Lp(e,o,s,r,i,Jf),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Le.fromCss(this.nameboxBackgroundColor),u=new Le(a.r,a.g,a.b,.95),c=u.toHSL().shift(Kf).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(Gf,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=Le.fromCss(this.customColor),r=s.toHSL(),i=this.obj.height-o,l=this.obj.width,a=()=>Ep(e,qn/2,o+qn/2,l-qn,i-qn,Zf);wn(e,()=>{e.beginPath(),a(),e.clip();const c=e.createLinearGradient(0,o,0,i);c.addColorStop(0,s.toCss()),c.addColorStop(1,`rgba(${s.r},${s.g},${s.b},0.6667)`),e.fillStyle=c,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,l,i),wn(e,()=>{e.translate(0,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,0,l,i)});const f=e.createLinearGradient(0,o+i-Ml,0,o+i);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(l/2,o+i,tp,Ml,0,0,2*Math.PI),e.closePath(),e.fill()});const u=r.shift(Qf).toRgb().toCss();e.strokeStyle=u,e.lineWidth=qn,e.beginPath(),a(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-ba;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-Ca,y:r-_a})}getDotPattern(e=ep){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;this._lastColor=this.customColor;const{dotPatternSize:o,dotColorDelta:s,dotRadius:r}=e,i=Le.fromCss(this.customColor).toHSL(),l=Ln();l.height=o,l.width=o;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=i.shift(s).toRgb().toCss();function u(f,m){a.beginPath(),a.ellipse(f,m,r,r,0,0,2*Math.PI),a.closePath(),a.fill()}u(0,0),u(o,0),u(0,o),u(o,o),u(o/2,o/2);const c=a.createPattern(l,"repeat");if(!c)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=c,c}}_(Gn,"id","custom"),_(Gn,"label","Custom"),_(Gn,"priority",0),_(Gn,"gameMode","ddlc");const fr=class fr{constructor(t){_(this,"nextArrow",null);this.base=t}static get resizable(){return!1}static get defaultWidth(){return $a}static get defaultHeight(){return yp+Ra}static get defaultX(){return de().Base.screenWidth/2}static get defaultY(){return de().Base.screenHeight-this.defaultHeight/2-de().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return or}getControlsDisabledStyle(){return jp}renderControls(t,e){const o=this.width,s=o/2,i=s-s,l=this.getControlsStyle(),a=["History","Skip","Auto","Save","Load","Settings"],u=[];let c=0;for(const b of a){const x=fr.controlWidth(t,b);u.push(x),c+=x}const f=Math.min((o-c)/(a.length+2),78);let m=i+(o-c-f*(a.length-1))/2;for(let b=0;b<a.length;++b){const x=a[b],k=u[b],y=x==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():l;Yo(t,y),t.fillText(x,m,e),m+=k+f}}static controlWidth(t,e){if(this.widthCache[e])return this.widthCache[e];Yo(t,or);const o=t.measureText(e).width;return this.widthCache[e]=o,o}prepare(){if(!(this.nextArrow instanceof co))return(async()=>{this.nextArrow=await us("next_plus")})()}};_(fr,"widthCache",{});let Nl=fr;class Ho extends Nl{constructor(){super(...arguments);_(this,"_lastColor",null);_(this,"_dotPattern",null);_(this,"backgroundImage","textbox");_(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ia}get nameboxHeight(){return Ra}get nameboxOffsetX(){return Aa}get nameboxOffsetY(){return kp}get nameboxStyle(){return{...$p,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return ja}get textOffsetY(){return wp}get textboxStyle(){return Rp}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:up}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(cp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(dp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Lp(e,o,s,r,i,hp),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Le.fromCss(this.nameboxBackgroundColor),u=new Le(a.r,a.g,a.b,.95),c=u.toHSL().shift(pp).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(fp,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=this.obj.height-o,r=this.obj.width,i=Le.fromCss(this.customColor).toHSL(),l=()=>Ep(e,zn/2,o+zn/2,r-zn,s-zn,vp);wn(e,()=>{e.beginPath(),l(),e.clip();const u=e.createLinearGradient(0,o,0,o+s),c=Le.fromHex(this.customColor);u.addColorStop(0,c.toCss()),u.addColorStop(1,`rgba(${c.r},${c.g},${c.b},0.6667)`),e.fillStyle=u,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,r,s),e.strokeRect(0,o,r,s),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,o,r,s);const f=e.createLinearGradient(0,o+s-Dl,0,o+s);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(r/2,o+s,Tp,Dl,0,0,2*Math.PI),e.closePath(),e.fill()});const a=i.shift(gp).toRgb().toCss();e.strokeStyle=a,e.lineWidth=zn,e.beginPath(),l(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-Cp;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-Pp,y:r-Op})}getDotPattern(){return Gn.prototype.getDotPattern.call(this,mp)}}_(Ho,"id","custom_plus"),_(Ho,"label","Custom (Plus)"),_(Ho,"priority",0),_(Ho,"gameMode","ddlc_plus");class Wo extends Ha{static get resizable(){return!0}get height(){return Sr+En}get width(){return bo}get nameboxWidth(){return bs}get nameboxHeight(){return En}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}get textboxStyle(){return Pa}async render(){}}_(Wo,"id","none"),_(Wo,"label","None"),_(Wo,"priority",0),_(Wo,"gameMode","ddlc");const bw=[Yn,No,Gn,Wo,Ho],Go=(()=>{const n={};for(const t of bw)n[t.id]=t;return n})();class yw extends Ar{constructor(){super(...arguments);_(this,"nbTextRenderer",null);_(this,"textRenderer",null);_(this,"_lastRefVars",null);_(this,"refObject",null);_(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:((e=this.refObject)==null?void 0:e.label)??"Missing name"}get canSkipLocal(){var e;return super.canSkipLocal&&(((e=this._lastRenderer)==null?void 0:e.allowSkippingLocal)??!0)}prepareData(e){super.prepareData(e),typeof this.obj.talkingObjId=="number"&&(this.refObject=e.objects[this.obj.talkingObjId]??null)}prepareRender(e){const o=super.prepareRender(e),s=this.textboxRenderer.prepare(),r=this.getRefVars();r!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=r),this.nbTextRenderer=new At(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new At(this.obj.text,this.textboxRenderer.textboxStyle);const i=this.nbTextRenderer.loadFonts(),l=this.textRenderer.loadFonts();if(!(!o&&!s&&!i&&!l))return Promise.all([o,s,i,l])}renderLocal(e){const o=this.textboxRenderer,s=o.width;if(!this.obj.overflow){const r=new Path2D;r.rect(0,0,o.width,this.height),e.clip(r)}o.render(e),this.obj.talkingObjId!==null&&this.renderName(e),this.renderText(e,0,0,s)}renderName(e){const o=this.textboxRenderer,s=o.nameboxWidth,r=o.nameboxOffsetX,i=o.nameboxOffsetX/2;console.log("rendering name",e.getTransform()),this.nbTextRenderer.applyLayout("center",r+i,o.nameboxOffsetY,s-i*2,!1),this.nbTextRenderer.render(e)}renderText(e,o,s,r){const i=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.applyLayout("left",o+i.textOffsetX,s+i.nameboxHeight+i.textOffsetY,r-i.textOffsetX*2,this.obj.autoWrap),l.render(e)}get forcedStyle(){const e=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,o=Go[e];if(this._lastRenderer&&this._lastRenderer.constructor===o)return this._lastRenderer;const s=new o(this);return this._lastRenderer=s,s}}const pd=4;class bn extends ko{constructor(e,o,s,{text:r,resetBounds:i,style:l}={}){super(e,s??!0,o);_(this,"_text",I("Click here to edit the textbox"));_(this,"_talkingObjId",I(null));_(this,"_talkingOther",I(""));_(this,"_autoQuoting",I(!0));_(this,"_overflow",I(!1));_(this,"_style",I("normal"));_(this,"_overrideColor",I(!1));_(this,"_customColor");_(this,"_deriveCustomColors",I(!0));_(this,"_customControlsColor");_(this,"_customNameboxColor");_(this,"_customNameboxStroke");_(this,"_customNameboxWidth",I(null));_(this,"_resetBounds");_(this,"_controls",I(!0));_(this,"_skip",I(!0));_(this,"_autoWrap",I(!0));_(this,"_continue",I(!0));const a=de();l??(l=a.TextBox.DefaultTextboxStyle);const u=Go[l];this._resetBounds=I(i??{x:u.defaultX,y:u.defaultY,width:u.defaultWidth,height:u.defaultHeight,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0}),this._customColor=I(a.TextBoxCustom.textboxDefaultColor),this._customControlsColor=I(a.TextBoxCustom.controlsDefaultColor),this._customNameboxColor=I(a.TextBoxCustom.nameboxDefaultColor),this._customNameboxStroke=I(a.TextBoxCustom.nameboxStrokeDefaultColor),this.applyResetBounds(),this._style.value=l,r&&(this._text.value=r)}get type(){return"textBox"}static create(e,o){return new bn(e,void 0,void 0,{text:o})}makeClone(e,o){const s=new bn(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new bn(e,s.get(o.id),o.onTop);return o.panelId!==e.id&&!s.has(o.talkingObjId)?o.talkingObjId=null:o.talkingObjId=s.get(o.talkingObjId)??o.talkingObjId,o.talkingObjId=o.talkingObjId??null,r.loadPropsFromSave(o,s),r}prepareSiblingRemoval(e){e.id===this.talkingObjId&&(this.talkingObjId=null),super.prepareSiblingRemoval(e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get talkingObjId(){return this._talkingObjId.value}set talkingObjId(e){this.mutate(this._talkingObjId,e)}get talkingOther(){return this._talkingOther.value}set talkingOther(e){this.talkingObjId==="$other$"?this.mutate(this._talkingOther,e):this.mutateX([this._talkingObjId,this._talkingOther],["$other$",e])}get autoQuoting(){return this._autoQuoting.value}set autoQuoting(e){this.mutate(this._autoQuoting,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get style(){return this._style.value}set style(e){const o=de(),s=this.style,r=this.x,i=this.y,l=this.width,a=this.height,u=Go[s],c=Go[e];let f=r,m=i,b=l,x=a;const k=10;c.resizable?(u.defaultWidth!==c.defaultWidth&&(b=Math.max(b+c.defaultWidth-u.defaultWidth,k)),u.defaultHeight!==c.defaultHeight&&(x=Math.max(x+c.defaultHeight-u.defaultHeight,k))):(b=c.defaultWidth,x=c.defaultHeight),u.defaultX!==c.defaultX&&(f=sr(-b+k,f+c.defaultX-u.defaultX,o.Base.screenWidth-k)),u.defaultY!==c.defaultY&&(m=sr(-x+k,m+c.defaultY-u.defaultY,o.Base.screenHeight-k)),this.mutateX([this._x,this._y,this._height,this._width,this._style],[f,m,x,b,e])}get overrideColor(){return this._overrideColor.value}set overrideColor(e){this.mutate(this._overrideColor,e)}get customColor(){return this._customColor.value}set customColor(e){this.mutate(this._customColor,e)}get deriveCustomColors(){return this._deriveCustomColors.value}set deriveCustomColors(e){this.mutate(this._deriveCustomColors,e)}get customControlsColor(){return this._customControlsColor.value}set customControlsColor(e){this.mutate(this._customControlsColor,e)}get customNameboxColor(){return this._customNameboxColor.value}set customNameboxColor(e){this.mutate(this._customNameboxColor,e)}get customNameboxStroke(){return this._customNameboxStroke.value}set customNameboxStroke(e){this.mutate(this._customNameboxStroke,e)}get customNameboxWidth(){return this._customNameboxWidth.value}set customNameboxWidth(e){this.mutate(this._customNameboxWidth,e)}applyResetBounds(){const e=this._resetBounds.value;this.mutateX([this._x,this._y,this._height,this._width,this._rotation,this._skewX,this._skewY,this._scaleX,this._scaleY],[e.x,e.y,e.height,e.width,e.rotation,e.skewX,e.skewY,e.scaleX,e.scaleY])}splitTextbox(){const e=(this.width-pd)/2,o=e/2+pd/2,s=this.localTransform,r=s.transformPoint(new DOMPointReadOnly(-o,0)),i=s.transformPoint(new DOMPointReadOnly(o,0)),l={x:r.x,y:r.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY};this.mutate(this._resetBounds,l),this.applyResetBounds();const a=this.style==="custom_plus"?"custom_plus":"custom";this.mutate(this._style,a);const u=new bn(this.panel,void 0,this.onTop,{resetBounds:{x:i.x,y:i.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY},style:a});this.flip&&(u.flip=!0),this.mutate(u._linkedTo,this._linkedTo.value)}get controls(){return this._controls.value}set controls(e){this.mutate(this._controls,e)}get skip(){return this._skip.value}set skip(e){this.mutate(this._skip,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get continue(){return this._continue.value}set continue(e){this.mutate(this._continue,e)}}const Ls=new class{constructor(){_(this,"_panels",I({}));_(this,"_order",I([]));_(this,"_lastPanelId",-1);Object.seal(this)}get panels(){return this._panels.value}get order(){return this._order.value}get lastPanelId(){return this._lastPanelId}createPanel(){const e=this._lastPanelId+1,o=new Ko(e);return We(()=>{this._lastPanelId=e,this._panels.value[o.id]=mt(o),this._order.value.push(o.id)}),o}duplicatePanel(t){const o=this._lastPanelId+1,s=Ko.fromExisting(t,o),r=this._order.value.indexOf(t.id);return We(()=>{this._lastPanelId=o,this._panels.value[o]=mt(s),this._order.value.splice(r+1,0,o)}),s}deletePanel(t){const e=this._order.value.indexOf(t.id);e!==-1&&We(()=>{delete this._panels.value[t.id],this._order.value.splice(e,1)})}movePanel(t,e){const o=this._order.value.indexOf(t.id);o!==-1&&We(()=>{this._order.value.splice(o,1),this._order.value.splice(o+e,0,t.id)})}fixContentPackRemoval(t){for(const e of Object.values(this._panels))e.fixContentPackRemoval(t)}getSave(){return{lastPanelId:this._lastPanelId,panelOrder:[...this._order.value],currentPanel:N.viewports.list[0].currentPanel,panels:Object.fromEntries(Object.values(this._panels.value).map(t=>[t.id,t.getSave()]))}}loadSave(t){const e=t.panelOrder,o={};let s=-1;for(const r of e){const i=t.panels[r],l=new Ko(+r);l.loadSave(i),o[l.id]=mt(l),s=Math.max(s,l.id)}this._order.value=e,this._panels.value=o,this._lastPanelId=s}},es=class es extends Da{constructor(e){super();_(this,"background",new kw);_(this,"_lastObjId",-1);_(this,"_lowerOrder",I([]));_(this,"_topOrder",I([]));_(this,"_objects",I({}));_(this,"_lastRender",I(null));this.id=e}static fromExisting(e,o){const s=new es(o);let r=-1;const i={},l=new Map;for(const a in e.objects)l.set(+a,++r);for(const a in e.objects){if(!Object.prototype.hasOwnProperty.call(e.objects,a))continue;const c=e.objects[a].makeClone(s,l);i[c.id]=c}return s._lastObjId=r,s._lowerOrder.value=e._lowerOrder.value.map(a=>l.get(a)),s._topOrder.value=e._topOrder.value.map(a=>l.get(a)),s._objects.value=i,s._lastRender.value=e._lastRender.value,s._composite.value=e._composite.value,s._filters.value=e._filters.value.map(a=>mt(a.clone())),s.background.fromExisting(e.background),s}loadSave(e){this.background.loadSave(e.background),this._filters.value=Ba(e.filters),this._composite.value=e.composite;const o=[];for(const s of[...e.order,...e.onTopOrder]){const r=e.objects[s];r!=null&&o.push(r)}this.pasteObjects(o)}getSave(){return{id:this.id,background:this.background.getSave(),composite:this._composite.value,filters:this._filters.value.map(e=>e.getSave()),order:[...this._lowerOrder.value],onTopOrder:[...this._topOrder.value],lastObjId:this._lastObjId,objects:Object.fromEntries(Object.entries(this.objects).map(([e,o])=>[e,o.save()]))}}get lowerOrder(){return this._lowerOrder.value}get topOrder(){return this._topOrder.value}get objects(){return this._objects.value}get lastRender(){return this._lastRender.value}set lastRender(e){this._lastRender.value=e}get lastObjId(){return this._lastObjId}fixContentPackRemoval(e){this.background.fixContentPackRemoval(e);for(const o in this.objects)this.objects[o].fixContentPackRemoval(e)}insertObject(e,o){const s=o?this._topOrder.value:this._lowerOrder.value,r=this._lastObjId,i=Math.max(r,e.id);We(()=>{this.objects[e.id]=mt(e),this._lastObjId=i,s.push(e.id)})}removeObject(e){const o=e.onTop?this._topOrder.value:this._lowerOrder.value,s=o.indexOf(e.id);for(const r of Object.values(this._objects.value))r!==e&&r.prepareSiblingRemoval(e);for(const r of N.viewports.list)r.currentPanel===this.id&&r.selection===e.id&&(r.selection=null);We(()=>{o.splice(s,1),delete this._objects.value[e.id]})}setOnTop(e,o){const s=o?this._topOrder.value:this._lowerOrder.value,r=o?this._lowerOrder.value:this._topOrder.value,i=s.indexOf(e.id);i!==-1&&We(()=>{s.splice(i,1),r.push(e.id)})}shiftLayer(e,o){const s=e.onTop?this._topOrder.value:this._lowerOrder.value,r=s.indexOf(e.id),i=Math.max(r+o,0);r!==i&&We(()=>{s.splice(r,1),s.splice(i,0,e.id)})}pasteObjects(e){const o=new Map;let s=this.lastObjId;for(const r of e)o.set(+r.id,++s);for(const r of e){const i=es.objectClassTable[r.type];if(!i)throw new Error(`Unknown object type: ${r.type}`);i.fromSave(this,r,o)}}};_(es,"objectClassTable",{character:Mp,choice:Dp,notification:Bp,poem:Bl,sprite:Ea,textBox:bn});let Ko=es;const ww="buildin.transparent";var Ns=(n=>(n[n.None=0]="None",n[n.Stretch=1]="Stretch",n[n.Cover=2]="Cover",n))(Ns||{});class kw extends Da{constructor(){super();_(this,"_current",I(ww));_(this,"_color",I("#000000"));_(this,"_flipped",I(!1));_(this,"_variant",I(0));_(this,"_scaling",I(0))}fromExisting(e){this._current.value=e.current,this._color.value=e.color,this._flipped.value=e.flipped,this._variant.value=e.variant,this._scaling.value=e.scaling,this._composite.value=e.composite,this._filters.value=e.filters.map(o=>mt(o.clone()))}getSave(){return{current:this.current,color:this.color,flipped:this.flipped,variant:this.variant,scaling:this.scaling,composite:this.composite,filters:this._filters.value.map(e=>e.getSave())}}loadSave(e){this.current=e.current,this.color=e.color,this.flipped=e.flipped,this.variant=e.variant,this.scaling=e.scaling,this._composite.value=e.composite,this._filters.value=Ba(e.filters)}get current(){return this._current.value}set current(e){this._current.value,this._variant.value,We(()=>{this._current.value=e,this._variant.value=0})}get color(){return this._color.value}set color(e){this._color.value,We(()=>void(this._color.value=e))}get flipped(){return this._flipped.value}set flipped(e){this._flipped.value,We(()=>void(this._flipped.value=e))}get variant(){return this._variant.value}set variant(e){this._variant.value,We(()=>void(this._variant.value=e))}get scaling(){return this._scaling.value}set scaling(e){this._scaling.value,We(()=>void(this._scaling.value=e))}seekBackgroundVariant(e){const s=jt.backgrounds.get(this.current);if(!s)return;const r=Eo(s.variants,this.variant,e);this.variant,We(()=>void(this.variant=r))}fixContentPackRemoval(e){const o=e.backgrounds.find(l=>l.id===this.current);if(!o)return;const s=jt.backgrounds.get(this.current);if(!s){jt.current.backgrounds.length>0?this.current=jt.current.backgrounds[0].id:this.current="buildin.transparent";return}const r=JSON.stringify(o.variants[this.variant]),i=s.variants.findIndex(l=>JSON.stringify(l)===r);i!==this.variant&&(this.variant=i===-1?0:i)}}const Cw={dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},jt=new class{constructor(){_(this,"_contentPacks",I([]));_(this,"_current",D(()=>this._contentPacks.value.length===0?Cw:this._contentPacks.value.reduce((t,e)=>im(t,e))));_(this,"_characters",D(()=>{const t=new Map;for(const e of this.current.characters)t.set(e.id,e);return t}));_(this,"_backgrounds",D(()=>{const t=new Map;for(const e of this.current.backgrounds)t.set(e.id,e);return t}))}get contentPacks(){return this._contentPacks.value}get current(){return this._current.value}removeContentPacks(t){const e=JSON.parse(JSON.stringify(this.current)),o=this.contentPacks.filter(s=>!t.has(s.packId));Kr(()=>{this._contentPacks.value=o,Ls.fixContentPackRemoval(e)})}async replaceContentPack(t){const e=t.processed?t.contentPack:await Os(t.contentPack);let o=this._contentPacks.value;const s=o.findIndex(r=>r.packId===t.contentPack.packId);s===-1?o.push(e):o.splice(s,1,e),o=o,Kr(()=>{this._contentPacks.value=o})}async loadContentPacks(t){typeof t=="string"&&(t=[t]);const e=await Promise.all(t.map(async r=>await fl(r))),o=await Promise.all(e.map(r=>Os(r))),s=new Set(this.contentPacks.map(r=>r.packId));for(const r of o)for(const i of r.dependencies)if(!s.has(i))throw new Error(`Missing dependency '${i}'. Refusing to install ${r.packId}`);await Kr(async()=>{this._contentPacks.value=[...this.contentPacks,...o]})}get characters(){return this._characters.value}get backgrounds(){return this._backgrounds.value}async loadSave(t){const e=await Nn.getInstance(),o=new Set,s=await Promise.allSettled(t.map(async r=>{if(typeof r!="string")return r;let i=null,l;if(r.indexOf(";")>=0?[l,i]=r.split(";"):l=r,o.has(l))return null;o.add(l);const a=jt.contentPacks.find(f=>f.packId===l);if(a)return a;if(r.startsWith("dddg.buildin.")&&r.endsWith(".nsfw")){const f=await fl(ha[r]);return await Os(f)}i!=null&&!e.hasPack(l)&&await e.loadTempPack(i);const u=e.getPack(l);if(!u)return console.warn(`Pack Id ${r} not found!`),null;const c=await fl(u.dddg2Path||u.dddg1Path);return await Os(c)}));for(const r of s)r.status==="rejected"&&(Me.fire(new gs(""+r.reason)),console.error(r.reason));jt._contentPacks.value=[...jt._contentPacks.value.filter(r=>{var i;return(i=r.packId)==null?void 0:i.startsWith("dddg.buildin.")}),...s.filter(r=>r.status==="fulfilled").map(r=>r.value).filter(r=>r!==null)]}async getSave(t){const e=[...jt._contentPacks.value],o=await Nn.getInstance();return t?e.filter(s=>{var r,i;return!((r=s.packId)!=null&&r.startsWith("dddg.buildin."))||((i=s.packId)==null?void 0:i.endsWith(".nsfw"))}).map(s=>{var i;let r=(i=s.packId)!=null&&i.startsWith("dddg.uploads.")?s:s.packId;if(s.packId!=null){const l=o.getPack(s.packId);l&&l.repoUrl!=null&&(r+=`;${l.repoUrl}`)}return r}):e}};function _w(n){return n.split("/").slice(0,-1).join("/")+"/"}const hd=new Set(["png","gif","bmp","svg"]);async function fl(n){const t=await fetch(n);if(!t.ok)throw new Error(`Could not load content pack. Server responded with: ${t.statusText}`);let e;try{e=await t.json()}catch{throw new Error("Content pack is not valid json!")}try{const o={"./":_w(n),"/":fa};return e.version==="2.0"?rm.normalizeContentPack(e,o):sm.convert(nm.normalizeCharacter(e,o),o,!1)}catch{throw new Error("Content pack is not in a valid format!")}}async function Os(n){const t=new Set(await fo()?["webp",...hd]:hd),e=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Jr.assetWalker(n,o=>{const s=Jr.normalizePath(o,e,t,!1),r=Jr.normalizePath(o,e,t,!0);return{hq:s,lq:r,sourcePack:n.packId??"buildIn"}})}function xw(n){var e,o,s;const t=Object.values(n.panels.panels);if(!t.find(r=>Object.values(r.objects).find(i=>"scaleX"in i)))for(const r of t)for(const i of Object.values(r.objects)){i.scaleX=i.zoom??1,i.scaleY=i.zoom??1,i.skewX=0,i.skewY=0,i.linkedTo=null;const l=de();if(i.type==="character"){const a=i,u=n.content.current.characters.find(f=>f.id===a.characterType),c=((s=(o=(e=u==null?void 0:u.styleGroups[a.styleGroupId])==null?void 0:e.styles[a.styleId])==null?void 0:o.poses[a.poseId])==null?void 0:s.size)??[960,960];Wa(a,i.zoom??1,c)}i.type==="textBox"&&(i.height+=l.TextBox.NameboxHeight,i.y+=i.height/2),i.type==="sprite"&&(i.requireFixing25=!0,n.requireFixing25=!0),delete i.zoom}}function Wa(n,t,e){let o=new DOMMatrixReadOnly().translate(n.x,n.y+n.height/2);o=o.translate(0,-n.height/2).scale(n.width/e[0],n.height/e[1]).translate(0,e[1]/2),o=o.rotate(n.flip?-n.rotation:n.rotation),o=o.translate(0,e[1]/2).scale(t).translate(0,-e[1]/2);const s=n.rotation;Object.assign(n,Ap(o)),n.rotation=n.flip?360-s:s,n.skewX=0,n.skewY=0,n.width=e[0],n.height=e[1]}function Hp(n){for(const t of Object.values(N.panels.panels))for(const e of Object.values(t.objects)){if(e.type!=="sprite"||!e.requireFixing25||e.scaleX!==e.scaleY)continue;const o=e;o.assets.length===1&&o.assets[0].hq===n.url&&(Wa(o,e.scaleX,n.size),delete e.requireFixing25)}}async function Wp(n){if("requireFixing25"in N){const t=await po(n);Hp({url:n,size:[t.width,t.height]})}}function Vp(n){return!n.requireFixing25}const Sw=Object.freeze(Object.defineProperty({__proto__:null,adjustObjectSize2_5:Wa,afterImageUpload2_5:Wp,allowScaleModification:Vp,fixSprites2_5:Hp,migrateSave2_5:xw},Symbol.toStringTag,{value:"Module"})),pl=Jt(Object.seal({urls:{},async add(n,t){if(this.urls[n])throw new Error(`There is already an uploaded file called "${n}"`);const e="uploads:"+n;return this.urls[n]=t,zp(e,t),await Wp(e),e},getSave(n){return Object.keys(this.urls)},loadSave(n){this.urls={}}})),Ao=192,Mo=16/9,rr=Jt(new class{constructor(){_(this,"_list",{});_(this,"_currentViewportCount",0);Object.seal(this)}get list(){return Object.values(this._list)}setUpViewport(t){if(t.body.dataset.viewportId!=null)return mt(this.list[+t.body.dataset.viewportId]);const e=this._currentViewportCount++,o=new Pw(t);return this._list[e]=mt(o),t.defaultView.addEventListener("close",s=>{this.removeViewport(s.target)}),t.body.dataset.viewportId=e.toString(),mt(o)}removeViewport(t){if(t.body.dataset.viewportId==null)return;const e=+t.body.dataset.viewportId;e!=null&&delete this._list[e]}loadSave(t){if(t.currentPanel!=null){const o=this._list[0];if(!o)return;o.currentPanel=t.currentPanel}const e=N.panels.panels[0];for(const o of this.list)N.panels.panels[o.currentPanel]||(o.currentPanel=e.id),N.panels.panels[o.currentPanel].objects[o.selection]===void 0&&(o.selection=null)}});class Pw{constructor(t){_(this,"_selection",I(null));_(this,"_pickColor",I(!1));_(this,"_currentPanel",I(null));_(this,"_width");_(this,"_height");var e;this.doc=t,this._width=I(t.documentElement.clientWidth),this._height=I(t.documentElement.clientHeight),((e=rr.list[0])==null?void 0:e.currentPanel)!=null&&(this._currentPanel.value=rr.list[0].currentPanel),t.defaultView.addEventListener("resize",()=>{this._width.value=t.documentElement.clientWidth,this._height.value=t.documentElement.clientHeight})}get width(){return this._width.value}get height(){return this._height.value}get selection(){return this._selection.value}set selection(t){this._selection.value=t}get currentPanel(){return this._currentPanel.value}set currentPanel(t){this._currentPanel.value=t}get pickColor(){return this._pickColor.value}set pickColor(t){this._pickColor.value=t}get isVertical(){const t=this.height;return(this.width+Ao)/t>=Mo}get canvasWidth(){if(this.isVertical){const t=this.width-Ao,e=this.height*Mo;return Math.min(t,e)}else{const t=this.width,e=(this.height-Ao)*Mo;return Math.min(t,e)}}get canvasHeight(){if(this.isVertical){const t=this.height,e=(this.width-Ao)/Mo;return Math.min(t,e)}else{const t=this.height-Ao,e=this.width/Mo;return Math.min(t,e)}}}const N=Object.freeze({ui:is,panels:Ls,content:jt,uploadUrls:pl,viewports:rr,unsafe:!1,async loadSave(n){const t=JSON.parse(n);(t.version==null||t.version<2.5)&&(await Il(()=>Promise.resolve().then(()=>Sw),void 0,import.meta.url)).migrateSave2_5(t),await jt.loadSave(t.content),pl.loadSave(t.uploadUrls),Ls.loadSave(t.panels),rr.loadSave(t.panels)},async getSave(n){return JSON.stringify({version:2.5,panels:Ls.getSave(),content:await jt.getSave(n),uploadUrls:pl.getSave(n),unsafe:!1},void 0,"	")}}),Ow="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",Tt=class Tt{constructor(t,e){_(this,"onlineRepo");_(this,"localRepo");_(this,"tempRepo",Jt({authors:{},packs:[]}));_(this,"combinedList");_(this,"authors");window.repo=this,t||(t={authors:{},packs:[]},Me.fire(new $t("Couldn't load remote repository."))),e||(e={authors:{},packs:[]},ge.supports.localRepo&&Me.fire(new $t("Couldn't load local repository."))),this.onlineRepo=I(t),this.localRepo=I(e),this.combinedList=D(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.packs)??[],r=new Map(s.map(y=>[y.id,y])),i=this.localRepo.value,l=(i==null?void 0:i.packs)??[],a=new Map(l.map(y=>[y.id,y])),c=this.tempRepo.packs,f=new Map(c.map(y=>[y.id,y])),m=new Set(ge.state.autoAdd),b=N.content.contentPacks.map(y=>y.packId).filter(y=>y!=null),x=new Set(b),k=new Set;return[...b,...l.map(y=>y.id),...s.map(y=>y.id),...c.map(y=>y.id)].filter(y=>y.startsWith("dddg.buildin.")||y.startsWith("dddg.uploads.")||y.startsWith("dddg.desktop.")||y==="concept_femc.shido_draws.edave64"||k.has(y)?!1:(k.add(y),!0)).map(y=>({...r.get(y)??{characters:[],kind:[],authors:[]},...a.get(y),...f.get(y),autoloading:m.has(y),installed:a.has(y),online:r.has(y)||f.has(y),loaded:x.has(y)}))}),this.authors=D(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.authors)??{},r=this.localRepo.value,i=(r==null?void 0:r.authors)??{};return{...s,...i}}),Object.freeze(this)}static getInstance(){return Tt.instance||(Tt.instance=this.createInstance()),Tt.instance}static async createInstance(){const t=Tt.loadRepo(Ow),e=ge.supports.localRepo?await Tt.loadRepo(ge.localRepositoryUrl):null,[o,s]=await Promise.all([t,e]);return new Tt(o,s)}static async loadRepo(t){try{const[e,o]=await Promise.all([Tt.fetchJSON(t+"repo.json"),Tt.fetchJSON(t+"people.json")]);return{packs:e,authors:o}}catch{return null}}static async fetchJSON(t){const e=await fetch(t);if(!e.ok)throw new Error("Could not load json");return await e.json()}async reloadLocalRepo(){this.localRepo.value=ge.supports.localRepo?await Tt.loadRepo(ge.localRepositoryUrl):null}getPacks(){return this.combinedList.value}hasPack(t,e=!1){var o;return e?!!((o=this.onlineRepo.value)!=null&&o.packs.find(s=>s.id===t)):!!this.getPacks().find(s=>s.id===t)}getPack(t){return this.getPacks().find(e=>e.id===t)??null}getAuthor(t){return this.authors.value[t]||null}getAuthors(){return this.authors.value}async loadTempPack(t){const e=fetch(t);let o;try{o=await e}catch{throw new Error(`Failed to load '${t}'`)}if(!o.ok)throw o.status===404?new Error(`The pack '${t}' does not exist anymore.`):new Error(`Failed to load '${t}': ${o.statusText||o.status}`);let s;try{s=await o.json()}catch(i){throw new Error(`The contents of '${t}' is not a valid JSON: ${i.message}`)}if(!s.pack&&(!s.packs||s.packs.length===0))throw new Error(`The json file '${t}' does not contain any packages`);if(s.authors)for(const i in s.authors)this.tempRepo.authors[i]&&(this.tempRepo.authors[i]=s.authors[i]);let r=null;if(s.pack&&(this.addTempPack(s.pack,t),r=s.pack.id),s.packs)for(const i of s.packs)this.addTempPack(i,t),r===null&&(r=i.id);return r}addTempPack(t,e){if(t.repoUrl=e,t.dddg1Path&&(t.dddg1Path=new URL(t.dddg1Path,e).toString()),t.dddg2Path&&(t.dddg2Path=new URL(t.dddg2Path,e).toString()),t.preview)for(let o=0;o<t.preview.length;++o)t.preview[o]=new URL(t.preview[o],e).toString();this.tempRepo.packs.find(o=>o.id===t.id)||this.tempRepo.packs.push(t)}};_(Tt,"instance");let Nn=Tt;const ir=navigator.userAgent,Tw=!!ir.match(/iPad/i)||!!ir.match(/iPhone/i),$w=!!ir.match(/WebKit/i),vd=Tw&&$w&&!ir.match(/CriOS/i);class Fp{constructor(){_(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder",hasTemplate:!1}));_(this,"supports");_(this,"_gameMode",null);_(this,"isSavingEnabled",I(!1));_(this,"localRepositoryUrl","");_(this,"loading");_(this,"creatingDB");_(this,"loadingContentPacksAllowed");_(this,"loadContentPacks");_(this,"updateProgress",null);const t=et.canSave(),e=this.isSavingEnabled;window.addEventListener("beforeunload",o=>{o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise(o=>{this.loadContentPacks=()=>o()}),this.supports=Jt({optionalSaving:t,get autoLoading(){return t&&e.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!vd,allowWebP:!0,limitedCanvasSpace:vd}),t?this.loading=(async()=>{this.savingEnabled=await et.doesDbExists()})():this.loading=Promise.resolve(),this.loading.then(async()=>{if(await this.loadingContentPacksAllowed,this.creatingDB&&await this.creatingDB,this.savingEnabled){const o=await et.loadAutoload()??[];this.state.autoAdd=o;const s=await Nn.getInstance(),r=await Promise.all(o.map(async i=>{const[l,a]=i.split(";",2);a!=null&&!s.hasPack(l)&&await s.loadTempPack(a);const u=s.getPack(l);return u.dddg2Path??u.dddg1Path}));await le(async()=>{await N.content.loadContentPacks(r)})}})}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(t){t?(localStorage.setItem("saving","true"),this.creatingDB=et.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=et.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}async loadGameMode(){const e=new URLSearchParams(location.search).get("mode");if(e==="ddlc"||e==="ddlc_plus"){this._gameMode=e;return}await this.loading,await this.creatingDB;let o="";this.isSavingEnabled.value&&(o=await et.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s}async setGameMode(t){this.isSavingEnabled.value&&await et.saveGameMode(t);const e=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${e}?mode=${t}`}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(){throw new Error("Method not implemented.")}openNewWindow(){const t=window.open(void 0,"_blank","left=100,top=100");return!t||t.closed?null:t}async saveToFile(t,e,o="image/png",s=1){const r=document.createElement("a");r.setAttribute("download",e);const i=await this.createObjectURL(t,o,s);return r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),i}localRepoInstall(){return Promise.reject(new Error("This environment does not support a local repository"))}localRepoUninstall(){throw new Error("This environment does not support a local repository")}async autoLoadAdd(t){await this.loading,await this.creatingDB,await et.saveAutoload([...this.state.autoAdd,t]),this.state.autoAdd.push(t)}async autoLoadRemove(t){await this.loading,await this.creatingDB;const e=this.normalizePackId(t);await et.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=e));const o=this.state.autoAdd.indexOf(t);this.state.autoAdd.splice(o,1)}normalizePackId(t){const e=t.split(";");return e.length===1?e[0]:e[e.length-1]}async loadSettings(){await this.loading,await this.creatingDB;const t={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?{...t,...await et.loadSettings()}:t}async saveSettings(t){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&await et.saveSettings(t)}async loadDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return!1;const t=await et.loadTemplate();return t==null?!1:(this.state.hasTemplate=!0,await N.loadSave(t),!0)}async saveDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return;const t=await N.getSave(!0);et.saveTemplate(t),this.state.hasTemplate=!0}async clearDefaultTemplate(){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&(await et.saveTemplate(null),this.state.hasTemplate=!1)}async isInitialized(){await this.loading,await this.creatingDB}prompt(t,e){return new Promise(o=>{o(prompt(t,e))})}onPanelChange(){}createObjectURL(t,e,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(t.toDataURL(e,o));if(t.toBlob!=null)t.toBlob(l=>{if(!l){r();return}s(URL.createObjectURL(l))},e,o);else{const l=t.toDataURL(e,o),a=this.dataURItoBlob(l,e);s(URL.createObjectURL(a))}})}dataURItoBlob(t,e){const o=atob(t.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=o.charCodeAt(i);return new Blob([r],{type:e})}}const et={indexedDB:(()=>{try{return window.indexedDB??window.mozIndexedDB??window.webkitIndexedDB??window.msIndexedDB??null}catch{return null}})(),transaction:(()=>{try{return window.IDBTransaction??window.mozIDBTransaction??window.webkitIDBTransaction??window.msIDBTransaction??null}catch{return null}})(),db:null,canSave(){return!!(et.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return et.db?et.db:et.db=new Promise((n,t)=>{const e=et.indexedDB.open("dddg",3);e.onerror=o=>{t(o)},e.onupgradeneeded=o=>{const s=e.result,r=o.oldVersion??o.version;r<1&&s.createObjectStore("settings"),r===1&&(s.deleteObjectStore("settings"),s.createObjectStore("settings"))},e.onsuccess=()=>{n(e.result)}})},clearDB(){return new Promise((n,t)=>{if(!et.db){n();return}const e=et.indexedDB.deleteDatabase("dddg");et.db=null,e.onerror=o=>{t(o)},e.onsuccess=()=>{n()}})},loadAutoload(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("autoload")))},saveAutoload(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put([...n],"autoload"))})},loadGameMode(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("gameMode")))},saveGameMode(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put(n,"gameMode"))})},saveTemplate(n){return this.objectStorePromise("readwrite",async t=>{n==null?await this.reqPromise(t.delete("template")):await this.reqPromise(t.put(n,"template"))})},loadTemplate(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("template")))},saveSettings(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put({...n},"settings"))})},loadSettings(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("settings")))},async objectStorePromise(n,t){const e=await this.db;if(!e)throw new Error("No database");const s=e.transaction(["settings"],n).objectStore("settings");return await t(s)},reqPromise(n){return new Promise((t,e)=>{n.onerror=o=>{e(o)},n.onsuccess=()=>{t(n.result)}})}};class jw extends Fp{saveToFile(t,e,o="image/png",s=1){let r=t.toDataURL(o,s);const i=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,e),Promise.resolve(r)}}class Rw{constructor(){_(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"",hasTemplate:!1}));_(this,"localRepositoryUrl","/repo/");_(this,"_gameMode",null);_(this,"electron",window);_(this,"bgInvalidation",null);_(this,"loadingContentPacksAllowed");_(this,"loadContentPacks");_(this,"updateProgress",I("wait"));_(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1});_(this,"savingEnabled",!0);this.loadingContentPacksAllowed=new Promise(e=>{this.loadContentPacks=()=>e()}),this.electron.ipcRenderer.on("add-persistent-content-pack",async e=>{await this.loadingContentPacksAllowed,await le(async()=>{await N.content.loadContentPacks(e)})}),this.electron.ipcRenderer.on("add-persistent-background",async e=>{const o="persistentBg-"+e,s=e.split("/");zp(o,e),gd.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()}),this.electron.ipcRenderer.on("push-message",e=>{Me.fire(new $t(e))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",e=>{this.state.downloadLocation=e}),this.electron.ipcRenderer.onConversation("load-packs",async e=>{const o=await Nn.getInstance(),s=await Promise.all(e.map(async r=>{const[i,l]=r.split(";",2);l!=null&&!o.hasPack(i)&&await o.loadTempPack(l);const a=o.getPack(i);return a.dddg2Path||a.dddg1Path}));await le(async()=>{await N.content.loadContentPacks(s)})}),this.electron.ipcRenderer.onConversation("auto-load.changed",e=>{this.state.autoAdd=e}),this.electron.ipcRenderer.onConversation("reload-repo",async()=>{await(await Nn.getInstance()).reloadLocalRepo()}),this.electron.ipcRenderer.onConversation("replace-pack",async e=>{const o={processed:!1,contentPack:e};await le(async()=>{await N.content.replaceContentPack(o)})}),this.electron.ipcRenderer.onConversation("resolvable-error",(e,o)=>new Promise(s=>{Me.fire(new da(e,o.map(r=>({exec:()=>s(r),name:r}))))}));let t=!1;this.electron.ipcRenderer.on("update.progress",e=>{this.updateProgress.value=e,e==="done"?(t=!1,Me.fire(new $t("An update is downloaded and will be installed once DDDG closes."))):t||(t=!0,Me.fire(new $t("An update was found and will download in the background.")))}),this.electron.ipcRenderer.on("update.checkStopped",()=>{this.updateProgress.value="none"}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}loadDefaultTemplate(){throw new Error("Method not implemented.")}saveDefaultTemplate(){throw new Error("Method not implemented.")}clearDefaultTemplate(){throw new Error("Method not implemented.")}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(t){this.electron.ipcRenderer.send("open-folder",t)}onPanelChange(){}async saveSettings(t){await this.electron.ipcRenderer.sendConvo("config.set","nsfw",t.nsfw),await this.electron.ipcRenderer.sendConvo("config.set","darkMode",t.darkMode??void 0),await this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",t.defaultCharacterTalkingZoom)}async loadGameMode(){this._gameMode=await this.electron.ipcRenderer.sendConvo("config.get","gameMode")||"ddlc"}async setGameMode(t){await this.electron.ipcRenderer.sendConvo("config.set","gameMode",t),this.electron.ipcRenderer.send("reload")}async loadSettings(){return{lq:!1,nsfw:await this.electron.ipcRenderer.sendConvo("config.get","nsfw")??!1,darkMode:await this.electron.ipcRenderer.sendConvo("config.get","darkMode")??void 0,defaultCharacterTalkingZoom:await this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom")??void 0}}async localRepoInstall(t,e,o){await this.electron.ipcRenderer.sendConvo("repo.install",t,e,o)}async localRepoUninstall(t){await this.electron.ipcRenderer.sendConvo("repo.uninstall",t)}async autoLoadAdd(t){await this.electron.ipcRenderer.sendConvo("auto-load.add",t)}async autoLoadRemove(t){await this.electron.ipcRenderer.sendConvo("auto-load.remove",t)}saveToFile(t,e,o="image/png",s=1){return new Promise((r,i)=>{t.toBlob(async l=>{if(!l){i();return}const a=await l.arrayBuffer();await this.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(a)),r(URL.createObjectURL(l))},o,s)})}async prompt(t,e){return await this.electron.ipcRenderer.sendConvo("show-prompt",t,e)}openNewWindow(){return window.open(void 0,"_blank","left=100,top=100")}invalidateInstalledBGs(){this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),le(async()=>{await N.content.replaceContentPack({contentPack:gd,processed:!1})})}}const gd={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};function Iw(){return window.isElectron?new Rw:"msSaveOrOpenBlob"in window.navigator?new jw:new Fp}const ge=Iw(),Up="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!--%20Source:%20https://fonts.google.com/icons?selected=Material%2520Icons%2520Round%253Awarning%253A%20--%3e%3csvg%20fill='%23FFFFFF'%20version='1.1'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cfilter%20id='a'%20x='-.07126'%20y='-.079384'%20width='1.1425'%20height='1.1597'%20color-interpolation-filters='sRGB'%3e%3cfeGaussianBlur%20stdDeviation='0.36070242'/%3e%3c/filter%3e%3c/defs%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23fff'%20filter='url(%23a)'%20stroke='%23fff'/%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23000'/%3e%3c/svg%3e";let Hl=null;setTimeout(()=>po(Up).then(n=>{n instanceof co&&(Hl=n)}),0);class as{constructor(){_(this,"width",300);_(this,"height",300)}paintOnto(t,e={}){Hl&&Hl.paintOnto(t,e)}}let hl;function fo(){if(hl)return hl;if(!ge.supports.allowWebP)return Promise.resolve(!1);const n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",t="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return hl=(async()=>{const e=await Promise.all([Wl(n,1,2),Wl(t,720,1280)]);return e[0]&&e[1]})()}function Wl(n,t,e){return new Promise(o=>{const s=document.createElement("img");s.addEventListener("load",()=>{o(s.width===e&&s.height===t)}),s.addEventListener("error",()=>{o(!1)}),s.src=n})}let vl;function Aw(){return vl||(vl=(async()=>await Wl("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2))())}class Mw{constructor(){_(this,"cache",new Map)}get(t){const e=this.cache.get(t);if(e)return e;const o=ar(t);return this.cache.set(t,o),o}remove(t){this.cache.delete(t)}}class Dw{constructor(){_(this,"cache",new Map)}get(t){var s;const e=(s=this.cache.get(t))==null?void 0:s.deref();if(e)return e;const o=Ew(t);return this.cache.set(t,new WeakRef(o)),o}remove(t){this.cache.delete(t)}}let gl=null;function lr(){return gl||(window.assetCache=gl=ge.supports.assetCaching||typeof WeakRef>"u"?new Mw:new Dw)}const Hn={};function qp(n,t=!0){return po(ge.supports.lq&&!t?n.lq:n.hq)}function kn(n,t=!0){const e=ge.supports.lq&&pa&&!t?n.lq:n.hq;return Hn[e]?Hn[e]:e}function po(n){return Hn[n]&&(n=Hn[n]),lr().get(n)}async function us(n,t=!0){const e=`${fa}${n}${ge.supports.lq&&pa&&!t?".lq":""}${await fo()?".webp":".png"}`.replace(/\/+/,"/");return await lr().get(e)}async function Bw(n,t=!0){return`${fa}${n}${ge.supports.lq&&pa&&!t?".lq":""}${await fo()?".webp":".png"}`.replace(/\/+/,"/")}function zp(n,t){Hn[n]=t}async function Ew(n){const t=!!Hn[n];return t&&(n=Hn[n]),await(async()=>{try{return await ar(n)}catch{if(n.endsWith(".webp")&&!t)try{return await ar(n.replace(/\.webp$/,".png"))}catch{return Me.fire(new Zs(n)),lr().remove(n),new as}else return Me.fire(new Zs(n)),lr().remove(n),new as}})()}function ar(n,t=!1){return new Promise(e=>{const o=new Image;o.addEventListener("load",()=>{e(new co(o)),(t||!ge.supports.assetCaching)&&document.body.removeChild(o)}),o.addEventListener("error",()=>{e(new as),(t||!ge.supports.assetCaching)&&document.body.removeChild(o)}),o.crossOrigin="Anonymous",o.src=n,o.style.display="none",document.body.appendChild(o)})}class Xn{}class ho{constructor(t,e,o,s){_(this,"aborted",!1);this.canvas=t,this.fsCtx=e,this.hq=o,this.preview=s}static make(t,e,o){return new ho(t,t.getContext("2d"),e,o)}static makeWithContext(t,e,o,s){return new ho(t,e,o,s)}drawText(t){if(this.aborted)throw new Xn;this.fsCtx.save();const{font:e,align:o,x:s=0,y:r=0,text:i=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(i,s,r)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(i,s,r)),this.fsCtx.restore()}measureText(t){if(this.aborted)throw new Xn;this.fsCtx.save();const{font:e,align:o,text:s=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(t){if(this.aborted)throw new Xn;const{image:e,flip:o,x:s,y:r,w:i,h:l,filters:a,composite:u}={flip:!1,w:t.image.width,h:t.image.height,composite:"source-over",...t};if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=u,a)if("filter"in this.fsCtx){const c=[];for(const f of a)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of a)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(t.shadow){const c=t.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(t.rotation!=null&&t.rotation!==0){const c=t.rotationAnchor?t.rotationAnchor.x:0,f=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+i/2,r+l/2),this.fsCtx.scale(o?-1:1,1),e.paintOnto(this.fsCtx,{x:-i/2,y:-l/2,w:i,h:l}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:t,y:e,w:o,h:s,outline:r,fill:i,composition:l,rotation:a,rotationAnchor:u}){if(this.aborted)throw new Xn;if(this.fsCtx.save(),a!=null&&a!==0){const c=u?u.x:0,f=u?u.y:0;u&&this.fsCtx.translate(c,f),this.fsCtx.rotate(a),u&&this.fsCtx.translate(-c,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(t,e,o,s),l&&(this.fsCtx.globalCompositeOperation=l),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:t,fill:e,path:o}){if(this.aborted)throw new Xn;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),e&&(this.fsCtx.fillStyle=e.style,this.fsCtx.fill()),t&&(this.fsCtx.strokeStyle=t.style,this.fsCtx.lineWidth=t.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(t,e="repeat"){return t instanceof Xp&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}async customTransform(t,e){this.fsCtx.save(),await t(this.fsCtx),await e(this),this.fsCtx.restore()}linearGradient(t,e,o,s){return this.fsCtx.createLinearGradient(t,e,o,s)}applyFilters(t){if(t.length===0)return;this.fsCtx.save();let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of t)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),e!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${e})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}class Xp{constructor(t,e){_(this,"previewCanvas");_(this,"runningContext",null);_(this,"_disposed",!1);const o=de();this.previewCanvas=Ln(),this.previewCanvas.width=t??o.Base.screenWidth,this.previewCanvas.height=e??o.Base.screenHeight}get disposed(){return this._disposed}async render(t,e=!0,o=!0){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=ho.makeWithContext(this.previewCanvas,s,e,o);try{await t(this.runningContext)}catch(i){if(i instanceof Xn)return!1;throw i}finally{r===this.runningContext&&(this.runningContext=null)}return!0}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(t,e){e.w!=null&&e.h!=null?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}async download(t,e){const o=await this.drawToCanvas(t);return await ge.saveToFile(o,e)}async renderToBlob(t){const e=await this.drawToCanvas(t);return await new Promise((o,s)=>{e.toBlob(r=>{r?o(r):s()})})}async drawToCanvas(t){const e=Ln();e.width=this.previewCanvas.width,e.height=this.previewCanvas.height;const o=e.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),await t(ho.makeWithContext(e,o,!0,!1)),e}dispose(){this.runningContext&&this.runningContext.abort(),uo(this.previewCanvas),this._disposed=!0}getDataAt(t,e){return this.previewCanvas.getContext("2d").getImageData(t,e,1,1).data}}class Lw{constructor(t,e,o,s,r,i){this.id=t,this.assets=e,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=i}async render(t){const{screenWidth:e,screenHeight:o}=de().Base,s=await Promise.all(this.assets.map(r=>qp(r,t.hq)));for(const r of s){let i=0,l=0,a=r.width,u=r.height;const c=this.scale;switch(c){case Ns.None:i=e/2-a/2,l=o/2-u/2;break;case Ns.Stretch:a=e,u=o;break;case Ns.Cover:{const f=a/u,m=e/o;f>m?(u=o,a=u*f):(a=e,u=a/f),i=e/2-a/2,l=o/2-u/2;break}default:throw new Kt.UnreachableCaseError(c)}t.drawImage({image:r,x:i,y:l,w:a,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters})}}}const md={id:"buildin.static-color",name:"Static color",color:"#000000",render(n){const{screenWidth:t,screenHeight:e}=de().Base;return n.drawRect({x:0,y:0,w:t,h:e,fill:{style:this.color}}),Promise.resolve()}};class Yp extends Np{constructor(){super(...arguments);_(this,"refTextbox",null);_(this,"lastUploadCount",0);_(this,"lastHq",!1);_(this,"missingAsset",!1);_(this,"_canSkipLocal",!1);_(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareData(e){if(super.prepareData(e),this.missingAsset){const o=Object.keys(N.uploadUrls).length;o!==this.lastUploadCount&&(this.lastHq=null),this.lastUploadCount=o}}prepareRender(e){super.prepareRender(e);let o=!1;if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),o||(o=!!this.assetList.find(s=>!("loadedAssets"in s)||s.hasMissing))),!e!==this.lastHq)for(let s=0;s<this.assetList.length;++s){const r=this.assetList[s];"loadedAssets"in r&&!r.assets.every(i=>i.hq===i.lq)&&(this.assetList[s]={assets:r.assets,offset:r.offset,composite:r.composite},o=!0)}if(this.lastHq=!e,!!o)return this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!e)}getAssetsSize(){let e=0,o=0;for(const s of this.assetList)if("loadedAssets"in s)for(const r of s.loadedAssets)e=Math.max(e,s.offset[0]+r.width),o=Math.max(o,s.offset[1]+r.height);return new DOMPointReadOnly(e,o)}loadAssets(e){const o=[];this.missingAsset=!1;for(const s of this.assetList)"loadedAssets"in s&&!s.hasMissing||o.push((async r=>{const i=await Promise.all(r.assets.map(a=>qp(a,e))),l=r;l.loadedAssets=i,l.hasMissing=i.some(a=>a instanceof as),this.missingAsset||(this.missingAsset=l.hasMissing)})(s));if(o.length!==0)return Promise.all(o)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e){console.log("rerendering local");for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=o.composite??"source-over"),s instanceof as?s.paintOnto(e,{x:o.offset[0],y:o.offset[1],h:this.height,w:this.width}):s.paintOnto(e,{x:o.offset[0],y:o.offset[1]})}}class Nw extends Yp{constructor(e){super(e);_(this,"data");this.data=N.content.characters.get(this.obj.characterType)}prepareData(e){super.prepareData(e)}prepareRender(e){return super.prepareRender(e)}isAssetListOutdated(){return!0}getAssetList(){const e=this.obj.poseData,o=this.obj.headsData,s=[],r=this.assetList??[];for(const i of e.renderCommands){let l=null;switch(i.type){case"head":{if(!o)continue;const a=o.variants[this.obj.posePositions.head||0];if(a==null)continue;l=a;break}case"image":l=i.images;break;case"pose-part":{const a=e.positions[i.part];if(!a||a.length===0)break;const u=a[this.obj.posePositions[i.part]||0];if(!u)break;l=u;break}}if(l){const a=r.find(u=>u.assets===l);a?s.push({...a,offset:i.offset,composite:i.composite}):s.push({assets:l,offset:i.offset,composite:i.composite})}}return s}}class Hw extends Ar{constructor(){super(...arguments);_(this,"_height",0);_(this,"choiceRenderers",[])}get height(){const e=de().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=de().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e){const o=de().Choices,s=this.obj.width,r=o.ChoiceOuterPadding;let i=o.ChoiceOuterPadding;for(const l of this.choiceRenderers){const a=l.getHeight(this.obj.autoWrap?s:0);e.strokeStyle=o.ChoiceButtonBorderColor,e.lineWidth=o.Outline,e.fillStyle=o.ChoiceButtonColor,e.fillRect(r,i,s,a+o.ChoicePadding*2),e.strokeRect(r,i,s,a+o.ChoicePadding*2),l.applyLayout("center",r+o.ChoicePadding,i+o.ChoiceSpacing*1.25,s-o.ChoicePadding*2,this.obj.autoWrap),l.render(e),i+=a+o.ChoicePadding*2+o.ChoiceSpacing}}prepareRender(e){const o=de();this.choiceRenderers=this.obj.choices.map(i=>new At(i.text||" ",o.Choices.ChoiceTextStyle));const s=()=>(this._height=this.choiceRenderers.reduce((i,l)=>i+l.getHeight(this.obj.autoWrap?this.obj.width:0)+o.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e)),r=this.choiceRenderers.map(i=>i.loadFonts()).filter(i=>i!==void 0);if(r.length===0)s();else return Promise.all(r).then(s)}}class Ww extends Ar{constructor(){super(...arguments);_(this,"_height",0);_(this,"_width",0);_(this,"_textRenderer",null);_(this,"_buttonRenderer",null)}get height(){const e=de().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=de().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e){const o=super.prepareRender(e),s=de().Notification,r=this._textRenderer=new At(this.obj.text,s.NotificationTextStyle),i=this._buttonRenderer=new At("OK",s.NotificationOkTextStyle),l=r.loadFonts(),a=i.loadFonts(),u=()=>{const c=this.obj.autoWrap?this.obj.width-s.NotificationPadding*2:0,f=this.obj.autoWrap?c:r.getWidth(),m=r.getHeight(c),b=this.obj.autoWrap?c:i.getWidth(),x=i.getHeight(c);this._width=Math.max(f,b)+s.NotificationPadding*2,this._height=m+s.NotificationPadding*2+s.NotificationSpacing+x};if(o||l||a)return Promise.all([o,l,a]).then(u);u()}render(e,o,s,r,i){return this.obj.backdrop&&wn(e,()=>{const l=de();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,o,s,r,i)}renderLocal(e){const o=de(),s=this._textRenderer,r=this._buttonRenderer,i=this._width,l=this._height,a=o.Choices.ChoiceOuterPadding;e.fillStyle=o.Choices.ChoiceButtonColor,e.strokeStyle=o.Choices.ChoiceButtonBorderColor,e.lineWidth=o.Choices.Outline,e.fillRect(a,a,i,l),e.strokeRect(a,a,i,l),s.applyLayout("center",a+o.Notification.NotificationPadding,a+o.Notification.NotificationPadding*1.5,i-o.Notification.NotificationPadding*2,!1),s.render(e),r.applyLayout("center",a,a+l-o.Notification.NotificationPadding,i+a,!1),r.render(e)}}const Vw=-2,Fw=26,Uw=10,qw=10;class zw extends Ar{constructor(){super(...arguments);_(this,"_paperHeight",null);_(this,"_paperWidth",null);_(this,"_paper",null);_(this,"_lastPaperUrl",null)}get height(){return this._paperHeight??this.obj.height}get width(){return this._paperWidth??this.obj.width}prepareRender(e){const o=super.prepareRender(e),s=de().Poem,r=s.poemBackgrounds[this.obj.background],i=s.poemTextStyles[this.obj.font],a=new At(this.obj.text,i).loadFonts();let u;if(r.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==r.file&&(u=(async()=>{this._paper=await po(`assets/poemBackgrounds/${r.file}`),this._lastPaperUrl=r.file,this._paperHeight=this._paper.height*s.backgroundScale,this._paperWidth=this._paper.width*s.backgroundScale})()),o||a||u)return Promise.all([o,a,u])}renderLocal(e){const o=de().Poem,s=o.poemBackgrounds[this.obj.background],r=this.width,i=this.height;let l=o.poemPadding,a=o.poemTopPadding,u=l*2;if(s.file==="internal:console")e.fillStyle=this.obj.consoleColor||o.consoleBackgroundColor,e.fillRect(0,0,r,i),l=Vw,a=Fw,u=Uw;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:r,h:i}),!this.obj.overflow)){const m=new Path2D;m.rect(0,0,r,i),e.clip(m)}const c=o.poemTextStyles[this.obj.font],f=new At(this.obj.text,c);f.applyLayout("left",qw+l,l+a,this.width-u,this.obj.autoWrap),f.render(e)}}class Xw extends Yp{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}const pr=class pr{constructor(t,e,o,s){_(this,"renderObjectCache",new Map);_(this,"renderer");_(this,"_disposed",!1);this._panelId=t,this.canvasWidth=e,this.canvasHeight=o,this.viewport=s,this.renderer=new Xp(e,o)}get panelId(){return this._panelId}setPanelId(t){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==t&&(this._panelId=t,this.renderObjectCache.forEach(e=>{e.dispose()}),this.renderObjectCache.clear())}render(t,e,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),t,e):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const t=new Date,e=`panel-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),e)}paintOnto(t,e){this.renderer.paintOnto(t,e)}objectsAt(t,e){const o=new DOMPointReadOnly(t,e);return this.getRenderObjects().filter(s=>s.hitTest(o)).map(s=>s.id)}getLastRenderObject(t){return this.renderObjectCache.get(t)??null}async renderCallback(t,e){var u,c,f;if(this._disposed)throw new Error("Disposed scene-renderer called");e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",await((u=this.getBackgroundRenderer())==null?void 0:u.render(e));const o=this.getRenderObjects(),s=o.map(m=>m.prepareRender(!e.hq)).filter(m=>m!==void 0);s.length>0&&await Promise.all(s);const r=((c=this.viewport)==null?void 0:c.selection)??null,i=new Set;r!==null&&a(r,i);const l=(f=document.querySelector(pr.FocusProp))==null?void 0:f.getAttribute("data-obj-id");for(const m of o){const b=r===m.id,x=l===""+m.id;m.render(e.fsCtx,(b?on.Selected:i.has(m.id)?on.Indirectly:on.None)+(x?on.Focused:on.None),e.preview,e.hq,t)}e.applyFilters([...this.panel.filters]),e.preview&&e.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:await us("backgrounds/transparent")});function a(m,b){b.add(m);for(const x of o.filter(k=>k.linkedTo===m))a(x.id,b)}}getRenderObjects(){const t=N.panels.panels[this.panelId],e=[...t.lowerOrder,...t.topOrder],o=t.objects,s=Array.from(this.renderObjectCache.keys()).filter(r=>!e.includes(r));for(const r of s)this.renderObjectCache.get(r).dispose(),this.renderObjectCache.delete(r);return e.map(r=>{let i=this.renderObjectCache.get(r);if(!i){const l=o[r],a=l.type;switch(a){case"sprite":i=new Xw(l);break;case"character":{i=new Nw(l);break}case"textBox":i=new yw(l);break;case"choice":i=new Hw(l);break;case"notification":i=new Ww(l);break;case"poem":i=new zw(l);break;default:throw new Kt.UnreachableCaseError(a)}this.renderObjectCache.set(r,i)}return i})}get panel(){return N.panels.panels[this.panelId]}getBackgroundRenderer(){const t=this.panel;switch(t.background.current){case"buildin.static-color":return md.color=t.background.color,md;default:{const o=N.content.backgrounds.get(t.background.current);if(!o)return null;const s=o.variants[t.background.variant];return new Lw(t.background.current,s,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}drawDebugZoom(t,e,o,s,r,i=7){const l=t.fsCtx.getImageData(e,o,s,r),a=document.createElement("canvas");a.width=s,a.height=r,a.getContext("2d").putImageData(l,0,0),t.fsCtx.imageSmoothingEnabled=!1,t.fsCtx.drawImage(a,0,0,s*i,r*i)}};_(pr,"FocusProp",typeof CSS<"u"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let cs=pr;const Vl=new WeakMap;window.asdwefweg=Vl;function ur(n){let t=Vl.get(n);if(t==null||t.disposed){if(n.currentPanel===-1)return null;const e=de().Base;t=new cs(n.currentPanel,e.screenWidth,e.screenHeight,n),Vl.set(n,t)}return t}function Yw(n){if(n===null)return!1;if(n instanceof HTMLInputElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return n instanceof t.defaultView.HTMLInputElement}return!1}function Gw(n){if(n===null)return!1;if(n instanceof HTMLTextAreaElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLTextAreaElement:!1}return!1}function Kw(n){if(n instanceof HTMLElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLElement:!1}return!1}function Jo(n){if(n instanceof MouseEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.MouseEvent:!1}function Jw(n){if(n instanceof TouchEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.TouchEvent:!1}const Zw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Qw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",e1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e",t1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e";async function vo(n,t){try{await t()}catch(e){n1(n,e)}}function n1(n,t){console.error("Error in promise",n,t),Me.fire(new gs("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+n+'", '+o1(t)))}function o1(n){if(n instanceof Error){if(n.stack!=null){const t=n.stack.split(`
`);return t[0].includes(n.name)&&t[0].includes(n.message)?t[0]+`
<br />`+t[1]:n.name+": "+n.message+`
<br />`+t[0]}return n.name+": "+n.message}return n instanceof Object?JSON.stringify(n):""+n}const hn=window.devicePixelRatio??1;class s1{constructor(t){_(this,"dragData",null);_(this,"grabbies",[new Jp,new Kp]);this.viewport=t}paint(t,e){const o=r1(e),s=this.viewport.value;if(t.save(),this.dragData&&this.dragData.viewport===s)r(e,this.dragData.lastPos),this.dragData.grabby.paint(t,this.dragData),t.translate(this.dragData.lastPos.x,this.dragData.lastPos.y),t.scale(hn,hn),this.dragData.grabby.drawGrabby(t,new DOMPointReadOnly);else{const i=de();t.translate(o.x,o.y),t.scale(hn,hn),e.x>i.Base.screenWidth/2&&t.scale(-1,1),e.y>i.Base.screenHeight/2&&t.scale(1,-1);for(let l=0;l<this.grabbies.length;l++){const a=this.grabbies[l];a.pos||(a.pos=l1(i1*(l+1))),a.drawGrabby(t,a.pos)}}t.restore();function r(i,l){t.save();try{t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(l.x,l.y),t.setLineDash([5*hn,5*hn]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}onDown(t){const e=this.viewport.value,o=de(),s=this.grabbies.find(r=>{const i=r.lastDrawPos;return i?Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))<=o.Base.wheelWidth/2*hn:!1});return s?(this.dragData={lastPos:t,started:!1,grabby:s,center:null,renderObj:null,viewport:e},!0):!1}onMove(t,e){var l;if(!this.dragData)return!1;const o=this.viewport.value,i=N.panels.panels[o.currentPanel].objects[o.selection];if(!this.dragData.started){this.dragData.started=!0;const a=ur(o),u=a.getLastRenderObject(i.id),c=((l=a==null?void 0:a.getLastRenderObject(i.linkedTo))==null?void 0:l.transform)??new DOMMatrixReadOnly;this.dragData.renderObj=u,this.dragData.center=c.transformPoint(new DOMPointReadOnly(i.x,i.y)),this.dragData.grabby.onStartMove(i,this.dragData)}return this.dragData.lastPos=t,this.dragData.grabby.onMove(i,e,this.dragData),!0}onDrop(){return this.dragData?(this.dragData=null,!0):!1}}const Mr=2*Math.PI;class Gp{constructor(){_(this,"pos",null);_(this,"lastDrawPos",null)}drawGrabby(t,e){var i;const o=de();t.save(),t.translate(e.x,e.y),this.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,o.Base.wheelWidth/2,o.Base.wheelWidth/2,0,0,Mr),t.closePath();const s=getComputedStyle(document.body);t.fillStyle=s.getPropertyValue("--accent-background"),t.strokeStyle=s.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const r=document.body.classList.contains("dark-theme")?this.iconDark:this.icon;(i=Fl.get(r))==null||i.paintOnto(t),t.restore()}}class Kp extends Gp{constructor(){super(...arguments);_(this,"icon",e1);_(this,"iconDark",t1);_(this,"pos",null);_(this,"lastDrawPos",null)}paint(e,{lastPos:o,center:s,initialDragAngle:r}){const{angle:i}=Hs(Zo(s,o)),l=de().Base,a=oo(r-i,Mr);e.beginPath(),e.moveTo(s.x,s.y);let u=r-Math.PI,c=u+i-r;if(a<=Math.PI){const f=c;c=u,u=f}e.arc(s.x,s.y,l.wheelInnerRadius,u,c),e.lineTo(s.x,s.y),e.globalCompositeOperation="difference",e.fillStyle="rgba(255, 255, 255, 1)",e.fill(),e.globalCompositeOperation="source-over"}onStartMove(e,o){o.initalObjRotation=e.rotation;const{angle:s}=Hs(Zo(o.center,o.lastPos));o.initialDragAngle=s}onMove(e,o,{center:s,initalObjRotation:r,initialDragAngle:i,lastPos:l}){const{angle:a}=Hs(Zo(s,l));let u=oo(r+(a-i)/Math.PI*180,360);o&&(u=Math.round(u/22.5)*22.5),e.rotation!==u&&le(()=>{N.panels.panels[e.panelId].objects[e.id].rotation=u})}}class Jp extends Gp{constructor(){super(...arguments);_(this,"icon",Zw);_(this,"iconDark",Qw);_(this,"pos",null);_(this,"lastDrawPos",null)}paint(e,{renderObj:o,originalObjTransform:s}){if(s!=null)try{o.transformOverride=s,wn(e,()=>{e.globalAlpha=.5,o.render(e,on.None,!0,!1,!0),e.globalAlpha=1})}finally{o.transformOverride=null}}onStartMove(e,o){o.originalObjTransform=o.renderObj.obj.globalTransform,o.initialScaleX=e.scaleX,o.initialScaleY=e.scaleY,o.initialDelta=Zo(o.center,o.lastPos)}onMove(e,o,{initialScaleX:s,initialScaleY:r,initialDelta:i,center:l,lastPos:a}){const u=de(),c=Zo(l,a);let f=c.x/i.x*s,m=c.y/i.y*r;if(o){let b=c;l.x>u.Base.screenWidth/2&&(b=new DOMPointReadOnly(-b.x,b.y)),l.y>u.Base.screenHeight/2&&(b=new DOMPointReadOnly(b.x,-b.y));const{angle:x}=Hs(b),k=Math.round(x/Mr*11),y=(Math.abs(c.x)/Math.abs(i.x)+Math.abs(c.y)/Math.abs(i.y))/2;k===0||k===11?m=r:k===1?(f=-y*s,m=-y*r):k===2||k===3?f=s:k===4?(f=y*s,m=-y*r):k===5||k===6?m=r:k===7?(f=y*s,m=y*r):k===8||k===9?f=s:k===10&&(f=-y*s,m=y*r)}e.scaleX===f&&e.scaleY===m||le(()=>{N.panels.panels[e.panelId].objects[e.id].scaleX=f,N.panels.panels[e.panelId].objects[e.id].scaleY=m})}}const Fl=new Map;for(const n of[Jp,Kp])vo("Loading grabby icon",async()=>{const t=new n;Fl.set(t.icon,await po(t.icon)),Fl.set(t.iconDark,await po(t.iconDark))});function r1(n){const t=de(),e=t.Base.wheelWidth+t.Base.wheelInnerRadius*hn;return new DOMPointReadOnly(sr(e,n.x,t.Base.screenWidth-e),sr(e,n.y,t.Base.screenHeight-e))}const i1=Math.PI/6;function l1(n){const t=de().Base;return new DOMPointReadOnly(t.wheelInnerRadius*Math.cos(n),t.wheelInnerRadius*Math.sin(n))}function Zo(n,t){return new DOMPointReadOnly(n.x-t.x,n.y-t.y)}function Hs(n){const t=Math.atan2(n.y,n.x);return{angle:oo(t,Mr),distance:Math.sqrt(n.x*n.x+n.y*n.y)}}const a1=["height","width"],u1=Se({__name:"preview-render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean,default:!1}},setup(n,{expose:t}){const e=n,o=I(null),s=I(null),r=I(null),i=I(!1),l=I(!1),a=St(),u=D(()=>N.panels.panels[a.value.currentPanel]),c=new s1(a),f=Nf(),m=D(()=>N.panels.panels[a.value.currentPanel]),b=D(()=>N.ui.lqRendering);function x(){if(e.preLoading)return null;const oe=ur(a.value);return oe==null||oe.setPanelId(a.value.currentPanel),oe}const k=D(()=>(e.preLoading,de().Base.screenHeight)),y=D(()=>(e.preLoading,de().Base.screenWidth));function w(){r.value==null&&(r.value=requestAnimationFrame(h))}async function h(){var oe;if(r.value!=null&&(cancelAnimationFrame(r.value),r.value=null),!e.preLoading&&!N.unsafe){try{await((oe=x())==null?void 0:oe.render(!b.value,!0,!0))}catch(xe){console.log(xe)}p(),Me.fire(new er)}}function v(){const oe=document.createElement("canvas");oe.height=k.value,oe.width=y.value;try{ho.make(oe,!0,!1).drawText({text:"Starting...",x:oe.width/2,y:oe.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),s.value.drawImage(oe,e.canvasWidth,e.canvasHeight)}finally{uo(oe)}}function p(){const oe=x();i.value=!1,oe==null||oe.paintOnto(s.value,{x:0,y:0,w:y.value,h:k.value});const xe=oe==null?void 0:oe.getLastRenderObject(f.value);xe&&c.paint(s.value,xe.transform.transformPoint(new DOMPoint(0,0))),A.value=!1}function O(oe,xe,Z){const H=o.value,ue=oe-H.offsetLeft,C=xe-H.offsetTop;let S=ue/H.offsetWidth*H.width,B=C/H.offsetWidth*H.width;if(Z){const X=Z.transformPoint(new DOMPointReadOnly(S,B));S=X.x,B=X.y}return[S,B]}function M(oe){const[xe,Z]=O(oe.clientX,oe.clientY);if(W(xe,Z))return;if(l.value){l.value=!1;return}const H=x().objectsAt(xe,Z),ue=f.value,C=H.findIndex(B=>B===ue);let S;C===0?S=null:C!==-1?S=H[C-1]:S=H[H.length-1]??null,le(()=>{a.value.selection!==S&&(a.value.selection=S)})}window.redraw=function(){Me.fire(new Qs)},Xe(()=>[e.canvasWidth,e.canvasHeight],()=>p()),Me.subscribe(Qs,w),Me.subscribe(tr,()=>{const oe=x();oe&&oe.setPanelId(-1)}),le.onClear(()=>{w()}),Xe(()=>[f.value,a.value.currentPanel],()=>{w()}),Ht(()=>{s.value=o.value.getContext("2d"),v(),w()}),Sn(()=>{x().dispose()});const A=I(!1);async function g(oe){if(A.value)h(),A.value=!1;else{const xe=await ar(oe,!0);s.value.clearRect(0,0,o.value.width,o.value.height),xe.paintOnto(s.value,{x:0,y:0}),A.value=!0}}const T=D(()=>a.value.pickColor),$=D(()=>T.value?"crosshair":"default");function W(oe,xe){if(T.value){const Z=s.value.getImageData(oe,xe,1,1).data,H=`rgba(${Z[0].toString()},${Z[1].toString()},${Z[2].toString()},${(Z[3]/255).toString()})`;return le(()=>{a.value.pickColor=!1,Me.fire(new nr(H))}),!0}return!1}async function L(){const oe=await x().download(),xe=N.ui.lastDownload;N.ui.lastDownload=oe,xe!=null&&URL.revokeObjectURL(xe)}let E=null,ee=null,U=0,P=0,j=0,q=0;function je(oe){oe.preventDefault(),se(oe.clientX,oe.clientY)}function Y(oe){se(oe.touches[0].clientX,oe.touches[0].clientY)}function se(oe,xe){var C,S;const Z=f.value;if(Z===null)return;E=m.value.objects[Z],ee=((S=(C=ur(a.value).getLastRenderObject(E.linkedTo))==null?void 0:C.transform)==null?void 0:S.inverse())??new DOMMatrixReadOnly;const[H,ue]=O(oe,xe,ee);Z!=null&&c.onDown(new DOMPointReadOnly(...O(oe,xe)))||(U=H-E.x,P=ue-E.y,j=E.x,q=E.y)}function we(oe){oe.stopPropagation(),oe.preventDefault(),oe.dataTransfer.dropEffect="copy"}function Te(oe){if(!E)return;oe.preventDefault();const xe=Jo(oe)?oe.clientX:oe.touches[0].clientX,Z=Jo(oe)?oe.clientY:oe.touches[0].clientY;let[H,ue]=O(xe,Z,ee);if(c.onMove(new DOMPointReadOnly(...O(xe,Z)),oe.shiftKey)){w();return}H-=U,ue-=P;const C=Math.abs(H-j),S=Math.abs(ue-q);C+S>1&&(l.value=!0),oe.shiftKey&&(C>S?ue=q:H=j),le(async()=>{const B=N.panels.panels[E.panelId].objects[E.id];le(()=>{B.x=H,B.y=ue})})}async function Ce(oe){if(oe.stopPropagation(),oe.preventDefault(),!!oe.dataTransfer){for(const xe of oe.dataTransfer.items)if(xe.kind==="file"&&xe.type.match(/image.*/)){const Z=xe.getAsFile(),H=URL.createObjectURL(Z);try{const ue=await N.uploadUrls.add(Z.name,H);await le(async()=>{Ea.create(u.value,[{hq:ue,lq:ue,sourcePack:"dddg.uploaded.sprites"}])})}catch{URL.revokeObjectURL(H)}}}}function ot(oe){if(c.onDrop()){w(),oe.preventDefault(),E=null,l.value=!0;return}E&&("TouchEvent"in window&&Jw(oe)&&(l.value=!1),E=null)}function Ze(oe){oe.buttons!==1&&(E=null,c.onDrop()&&w())}return t({download:L,blendOver:g}),(oe,xe)=>(R(),V("canvas",{id:"scaled_display",ref_key:"sd",ref:o,height:k.value,width:y.value,style:tt({width:oe.canvasWidth+"px",height:oe.canvasHeight+"px",cursor:$.value}),draggable:"true",onClick:M,onTouchstart:Y,onDragstart:je,onTouchmove:Te,onMousemove:Te,onTouchend:ot,onMouseup:ot,onDragover:we,onDrop:Ce,onMouseenter:Ze,onContextmenu:xe[0]||(xe[0]=fe(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,a1))}}),c1=["disabled","title","aria-label"],d1={key:0,class:"material-icons","aria-hidden":"true"},f1={class:"content"},p1={key:1,class:"shortcut-popup"},h1=Se({__name:"d-button",props:{icon:{},iconPos:{default:"left"},disabled:{type:Boolean,default:!1},shortcut:{},title:{}},setup(n){const t=n,e=I(null),o=D(()=>t.shortcut!=null&&!t.shortcut.startsWith("!")),s=D(()=>{const i=t.shortcut;return i==null?"":i.startsWith("!")?i.substring(1):i});function r(i){t.disabled||i.key===t.shortcut&&i.ctrlKey&&!i.altKey&&!i.metaKey&&!i.shiftKey&&(e.value.focus({focusVisible:!1}),e.value.click(),i.preventDefault(),i.stopPropagation())}return Ht(()=>{t.shortcut!=null&&window.addEventListener("keydown",r)}),Sn(()=>{window.removeEventListener("keydown",r)}),(i,l)=>(R(),V("button",{class:Ne([i.iconPos]),disabled:i.disabled,title:i.title,"aria-label":i.title,style:tt(i.icon?"height: auto":""),ref_key:"btn",ref:e},[i.icon?(R(),V("div",d1,Oe(i.icon),1)):he("",!0),d("div",f1,[Xt(i.$slots,"default",{},void 0,!0)]),o.value?(R(),V("div",p1,Oe(s.value),1)):he("",!0)],14,c1))}}),Ie=Be(h1,[["__scopeId","data-v-bbb09c0d"]]),v1={methods:{verticalScrollRedirect:Zp}};function Zp(n){if(n.type!=="wheel"||!n.currentTarget)return;const t=n.currentTarget,e=getComputedStyle(t),o=n;if(o.deltaY===0)return;if(e.overflowY==="auto"){if(o.deltaY>0){if(t.scrollHeight>t.scrollTop+t.clientHeight){n.stopPropagation();return}}else if(t.scrollTop>0){n.stopPropagation();return}}const s=t.scrollLeft;t.scrollLeft+=o.deltaY,t.scrollLeft!==s&&n.stopPropagation()}function Mt(n){const t=Pn();function e(){const s=n.value;return s==null?null:s.$el?s.$el:s}function o(){n.value!=null&&e().classList.toggle("vertical",t.value)}return Xe(()=>t.value,o),Ht(()=>{o(),e().addEventListener("wheel",s=>{t.value||Zp(s)},{passive:!0})}),{vertical:t,getRoot:e}}const g1=["title","onClick","onKeypress"],m1=["src","alt"],b1=Se({__name:"characters-tab",emits:["show-dialog"],setup(n,{emit:t}){const e=t,o=St(),s=D(()=>N.content.current.characters),r=D(()=>N.panels.panels[o.value.currentPanel]);function i(a){return a.chibi?ge.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){le(async()=>{Mp.create(r.value,a)})}return(a,u)=>(R(),V(ce,null,[(R(!0),V(ce,null,ze(s.value,c=>(R(),V("div",{class:"character",tabindex:"0",key:c.id,title:c.label,onClick:fe(f=>l(c.id),["left"]),onKeypress:[rt(fe(f=>l(c.id),["prevent","stop"]),["enter"]),rt(fe(f=>l(c.id),["prevent","stop"]),["space"])]},[d("img",{src:i(c),alt:c.label},null,8,m1)],40,g1))),128)),F(Ie,{class:"custom-sprite",icon:"extension",onClick:u[0]||(u[0]=c=>e("show-dialog","type: Characters"))},{default:ne(()=>u[1]||(u[1]=[Q(" Search in content packs ")])),_:1})],64))}}),y1=Be(b1,[["__scopeId","data-v-13d7a68a"]]),w1=Se({__name:"drop-target",emits:["drop"],setup(n,{expose:t,emit:e}){const o=e,s=I(!1),r=Pn();function i(){s.value=!0}function l(){s.value=!1}function a(u){if(l(),u.stopPropagation(),u.preventDefault(),!!u.dataTransfer){for(const c of u.dataTransfer.items)if(c.kind==="file"&&c.type.match(/image.*/)){const f=c.getAsFile();f!=null&&o("drop",f)}}}return t({show:i,hide:l}),(u,c)=>s.value?(R(),V("div",{key:0,onDragleave:c[0]||(c[0]=f=>s.value=!1),onDrop:a,class:Ne({vertical:J(r)})},[Xt(u.$slots,"default",{},void 0,!0)],34)):he("",!0)}}),Qp=Be(w1,[["__scopeId","data-v-43b59d3a"]]),k1=["title","onClick","onKeypress"],C1=["title","onClick","onKeypress"],_1=Se({__name:"sprites-tab",emits:["show-dialog"],setup(n,{expose:t,emit:e}){const o=e,s=St(),r=D(()=>N.panels.panels[s.value.currentPanel]),i=D(()=>N.content.current.sprites.map(A=>{let g=null;const T=A.variants[0].map($=>{const W=kn($,!1);return W.startsWith("uploads:")?(Object.keys(N.uploadUrls),g=W,Up):W});return{...A,missing:g,urls:T}})),l=D(()=>ge.supports.openableFolders.has("sprites"));function a(A){return A.variants[0].map(g=>`url('${kn(g,!1)}')`).join(",")}async function u(A){await le(async()=>{Ea.create(r.value,A.variants[0])})}function c(){ge.openFolder("sprites")}const f=I(null);async function m(){const A=f.value,g=A.uploadingSprite;if(!A.files)return;if(A.files.length!==1){console.error("More than one file uploaded!");return}const T=A.files[0];await le(async()=>{const $=URL.createObjectURL(T);await N.uploadUrls.add(g,$)})}function b(A){const g=f.value;g.uploadingSprite=kn(A.variants[0][0]).substring(8),g.click()}const x={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},k=I(null);function y(){const A=k.value;if(A.files)for(const g of A.files)h(g)}async function w(){const A=prompt("Enter the URL of the image");if(A==null)return;const g=A.split("/").slice(-1)[0];await v(g,A)}async function h(A){await le(async g=>{const T=URL.createObjectURL(A),$=await N.uploadUrls.add(A.name,T);await v(A.name,$,g)})}async function v(A,g,T=le){const $=N.content.contentPacks.find(L=>L.packId===x.packId)||x,W={...$,sprites:[...$.sprites,{id:g,label:A,variants:[[{lq:g,hq:g,sourcePack:x.packId}]],defaultScale:[1,1],hd:null}]};await T(async()=>{await N.content.replaceContentPack({contentPack:W,processed:!0})})}const p=I(null);function O(A){A.dataTransfer&&(A.dataTransfer.effectAllowed="none",Array.from(A.dataTransfer.items).find(g=>g.type.match(/^image.*$/))&&(A.dataTransfer.effectAllowed="link",p.value.show()))}function M(){p.value.hide()}return t({showDropTarget:O,hideDropTarget:M}),(A,g)=>(R(),V(ce,null,[F(Qp,{ref_key:"spriteDt",ref:p,class:"drop-target",onDrop:h},{default:ne(()=>g[2]||(g[2]=[Q("Drop here to add as a new sprite ")])),_:1},512),(R(!0),V(ce,null,ze(i.value,T=>(R(),V(ce,null,[T.missing!==null?(R(),V("div",{class:"sprite",tabindex:"0",key:`${T.label}_missing`,title:T.label,style:tt({background:a(T)}),onClick:$=>b(T),onKeypress:[rt(fe($=>b(T),["prevent","stop"]),["enter"]),rt(fe($=>b(T),["prevent","stop"]),["space"])]},Oe(T.label),45,k1)):(R(),V("div",{class:"sprite",tabindex:"0",key:T.label,title:T.label,style:tt({background:a(T)}),onClick:$=>u(T),onKeypress:[rt(fe($=>u(T),["prevent","stop"]),["enter"]),rt(fe($=>u(T),["prevent","stop"]),["space"])]},Oe(T.label),45,C1))],64))),256)),F(Ie,{class:"custom-sprite v-w100",icon:"publish",onClick:g[0]||(g[0]=T=>k.value.click())},{default:ne(()=>[g[3]||(g[3]=Q(" Upload new sprite ")),d("input",{type:"file",ref_key:"spriteUpload",ref:k,onChange:y,multiple:""},null,544)]),_:1}),F(Ie,{icon:"insert_link",onClick:w},{default:ne(()=>g[4]||(g[4]=[Q(" New sprite from URL ")])),_:1}),F(Ie,{icon:"extension",onClick:g[1]||(g[1]=T=>o("show-dialog","type: Sprites"))},{default:ne(()=>g[5]||(g[5]=[Q(" Search in content packs ")])),_:1}),l.value?(R(),pe(Ie,{key:0,icon:"folder",onClick:c},{default:ne(()=>g[6]||(g[6]=[Q(" Open sprites folder ")])),_:1})):he("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:f,onChange:m},null,544)],64))}}),x1=Be(_1,[["__scopeId","data-v-67a1b1e0"]]),S1=Se({__name:"ui-tab",setup(n){const t=St(),e=D(()=>N.panels.panels[t.value.currentPanel]);async function o(){le(()=>{bn.create(e.value)})}async function s(){le(()=>{Dp.create(e.value)})}async function r(){le(()=>{Bp.create(e.value)})}async function i(){le(()=>{Bl.createPoem(e.value)})}async function l(){le(()=>{Bl.createConsole(e.value)})}return(a,u)=>(R(),V(ce,null,[d("button",{class:"v-w100",onClick:o},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:i},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:r},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:s},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}}),P1=["innerHTML"],O1=["disabled"],T1=Se({__name:"add-tool",setup(n){const t={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},e=I(null),o=I("characters"),s=I(null),{vertical:r}=Mt(e),i=D(()=>N.ui.clipboard!=null),l=St();function a(){le(async()=>{N.ui.pasteObjects(N.panels.panels[l.value.currentPanel])})}return(u,c)=>(R(),V("div",{class:"panel",ref_key:"root",ref:e,onDragenter:c[2]||(c[2]=(...f)=>{var m,b;return((m=s.value)==null?void 0:m.showDropTarget)&&((b=s.value)==null?void 0:b.showDropTarget(...f))}),onMouseleave:c[3]||(c[3]=(...f)=>{var m,b;return((m=s.value)==null?void 0:m.hideDropTarget)&&((b=s.value)==null?void 0:b.hideDropTarget(...f))})},[c[4]||(c[4]=d("h1",null,"Add",-1)),d("div",{class:Ne({"group-selector":!0,vertical:J(r)})},[(R(),V(ce,null,ze(t,(f,m)=>F(Ie,{key:m,class:Ne({active:o.value===m,"v-bl0":m!=="characters","h-bt0":m!=="characters"}),"icon-pos":"top",icon:f.icon,shortcut:f.shortcut,onClick:b=>o.value=m},{default:ne(()=>[d("span",{innerHTML:f.text},null,8,P1)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:Ne({"item-grid":!0,vertical:J(r)})},[o.value==="characters"?(R(),pe(y1,{key:0,onShowDialog:c[0]||(c[0]=f=>u.$emit("show-dialog",f))})):o.value==="sprites"?(R(),pe(x1,{key:1,ref_key:"sprites",ref:s,onShowDialog:c[1]||(c[1]=f=>u.$emit("show-dialog",f))},null,512)):o.value==="ui"?(R(),pe(S1,{key:2})):he("",!0),d("button",{class:"v-w100",onClick:a,disabled:!i.value}," Paste ",8,O1)],2)],544))}}),$1=Be(T1,[["__scopeId","data-v-ec062df1"]]),j1=["href"],Qe=Se({__name:"external-link",props:{to:{}},setup(n){const t=n,e=I(null),o=D(()=>{let s=t.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,i)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+i.replaceAll(" ","-")),s});return(s,r)=>(R(),V("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[Xt(s.$slots,"default")],8,j1))}}),R1=Se({__name:"app-credits",setup(n){const t=I(null);return Mt(t),(e,o)=>(R(),V("div",{class:"panel",ref_key:"root",ref:t},[o[35]||(o[35]=d("h1",null,"Help and Credits",-1)),F(Qe,{class:"btn",to:"wiki://Dokumentation"},{default:ne(()=>o[0]||(o[0]=[Q("Help")])),_:1}),F(Qe,{class:"btn",to:"github://"},{default:ne(()=>o[1]||(o[1]=[Q("Fork me on GitHub")])),_:1}),F(Qe,{class:"btn",to:"wiki://Privacy Statement"},{default:ne(()=>o[2]||(o[2]=[Q("Privacy Statement")])),_:1}),o[36]||(o[36]=d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),o[37]||(o[37]=d("p",null,[Q(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),Q("Based on gemdude46's DDLC Shitpost generator ")],-1)),d("p",null,[o[4]||(o[4]=Q(" Unused House Background by ")),F(Qe,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:ne(()=>o[3]||(o[3]=[Q(" Fatelogic ")])),_:1})]),d("p",null,[o[6]||(o[6]=Q(" Aller Font by ")),F(Qe,{to:"https://www.daltonmaag.com/library/aller"},{default:ne(()=>o[5]||(o[5]=[Q("Dalton Maag Ltd")])),_:1})]),d("p",null,[o[8]||(o[8]=Q(" Riffic Bold Font by ")),F(Qe,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:ne(()=>o[7]||(o[7]=[Q("InkyType")])),_:1})]),d("p",null,[o[10]||(o[10]=Q(" Verily Serif Mono Font by ")),F(Qe,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:ne(()=>o[9]||(o[9]=[Q("Stephen G. Hartke")])),_:1})]),d("p",null,[o[12]||(o[12]=Q(" F25 Bank Printer Font by ")),F(Qe,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:ne(()=>o[11]||(o[11]=[Q("F25 Digital Typeface Design")])),_:1})]),d("p",null,[o[14]||(o[14]=Q(" Journal Font by ")),F(Qe,{to:"https://www.dafont.com/journal.font"},{default:ne(()=>o[13]||(o[13]=[Q("Fontourist")])),_:1})]),d("p",null,[o[16]||(o[16]=Q(" Hashtag Font by ")),F(Qe,{to:"https://www.dafont.com/hashtag.font"},{default:ne(()=>o[15]||(o[15]=[Q(" TitanVex")])),_:1})]),d("p",null,[o[18]||(o[18]=Q(" JP Hand Slanted Font by ")),F(Qe,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:ne(()=>o[17]||(o[17]=[Q("Jonathan Paterson")])),_:1})]),d("p",null,[o[20]||(o[20]=Q(" As I Lay Dying Font by ")),F(Qe,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:ne(()=>o[19]||(o[19]=[Q("Moises Esqueda")])),_:1})]),d("p",null,[o[22]||(o[22]=Q(" Damagrafik Script Font by ")),F(Qe,{to:"https://www.dafont.com/damagrafik-script.font"},{default:ne(()=>o[21]||(o[21]=[Q("Davide Terenzi")])),_:1})]),d("p",null,[o[24]||(o[24]=Q(" Ammy's Handwriting Font by ")),F(Qe,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:ne(()=>o[23]||(o[23]=[Q("Ammy K.")])),_:1})]),d("p",null,[o[26]||(o[26]=Q(" Halogen Font by ")),F(Qe,{to:"https://www.dafont.com/halogen.font"},{default:ne(()=>o[25]||(o[25]=[Q("JLH Fonts")])),_:1})]),o[38]||(o[38]=d("p",null,[Q(" MC Sprite by Childish-N "),d("br"),Q("MC Casual Sprite by SlightlySimple "),d("br"),Q("MC Chibi by SlightlySimple ")],-1)),d("p",null,[F(Qe,{to:"https://www.reddit.com/r/DDLCMods/comments/1hhmu77/"},{default:ne(()=>o[27]||(o[27]=[Q("Concept MC")])),_:1}),o[29]||(o[29]=Q(" by StormBlazed76, ")),F(Qe,{to:"https://www.reddit.com/ofof3o"},{default:ne(()=>o[28]||(o[28]=[Q("chibi")])),_:1}),o[30]||(o[30]=Q(" by Hadrosaur838 "))]),o[39]||(o[39]=d("p",null,[Q(" MC Chad Sprite by Cylent-Nite "),d("br"),Q("MC Chad Poses and expressions by SlightlySimple "),d("br"),Q("MC Chad Poses and chibi by Meddy-sin ")],-1)),o[40]||(o[40]=d("p",null,[Q(" FeMC Sprite by Meddy-sin "),d("br"),Q("FeMC Casual Sprite by SlightlySimple ")],-1)),d("p",null,[F(Qe,{to:"https://www.reddit.com/oizaow"},{default:ne(()=>o[31]||(o[31]=[Q("Concept FeMC")])),_:1}),o[33]||(o[33]=Q(" by ShidoDraws, ")),F(Qe,{to:"https://www.reddit.com/oosuxu"},{default:ne(()=>o[32]||(o[32]=[Q("additional poses, expressions and chibi")])),_:1}),o[34]||(o[34]=Q(" by SlightlySimple "))]),o[41]||(o[41]=d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),o[42]||(o[42]=d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),o[43]||(o[43]=d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1))],512))}}),I1=Be(R1,[["__scopeId","data-v-deba67a0"]]);let Ul=0;typeof BigInt<"u"&&(Ul=BigInt(0));function Va(){const n=Ul;return Ul++,n+""}const A1={class:"toggle_box"},M1=["id"],D1=["for"],B1=["for"],Ge=Se({__name:"d-toggle",props:Bn({label:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=hs(n,"modelValue"),e=Va(),o=I(null);return(s,r)=>(R(),V("div",A1,[Pe(d("input",{id:J(e),type:"checkbox",ref_key:"checkbox",ref:o,"onUpdate:modelValue":r[0]||(r[0]=i=>t.value=i)},null,8,M1),[[jg,t.value]]),d("label",{for:J(e),class:"switch"},null,8,D1),d("label",{for:J(e),class:"toggle_label"},Oe(s.label),9,B1)]))}}),E1={class:"modal-scroll-area"},L1={class:"modal-scroll-area"},N1={key:0},H1={key:1},W1={key:2},V1={key:3,disabled:""},F1={class:"v-w100"},U1={key:7,class:"downloadTable"},q1=Se({__name:"app-settings",setup(n){const t=I(null),e=ge.updateProgress;Mt(t);function o(){ge.saveSettings({lq:N.ui.lqRendering,nsfw:N.ui.nsfw,darkMode:N.ui.useDarkTheme??void 0,looseTextParsing:ge.state.looseTextParsing,defaultCharacterTalkingZoom:N.ui.defaultCharacterTalkingZoom})}const s=D(()=>ge.supports.optionalSaving),r=I(!1),i=I(!1),l=I(!1),a=D({get(){return ge.savingEnabled},set(L){l.value=!0,ge.savingEnabled=L,o()}});function u(L){r.value=!1,L==="Allow"&&(a.value=!0)}function c(L){i.value=!1,L==="Deny"&&(a.value=!1)}Xe(()=>a.value,()=>l.value=!1);const f=I(!1),m=D(()=>ge.gameMode==="ddlc_plus");function b(L){vo("changing modes",async()=>{L==="Enter Classic Mode"?await ge.setGameMode("ddlc"):L==="Enter Plus mode"?await ge.setGameMode("ddlc_plus"):f.value=!1})}const x=D(()=>ge.supports.lq),k=D({get(){return N.ui.lqRendering},set(L){le(()=>{N.ui.lqRendering=L}),o()}}),y=D({get(){return!!N.ui.nsfw},set(L){le(()=>{N.ui.nsfw=L,o()})}}),w=D({get(){return!!N.ui.defaultCharacterTalkingZoom},set(L){le(()=>{N.ui.defaultCharacterTalkingZoom=L,o()})}}),h=D({get(){return ge.state.looseTextParsing},set(L){ge.state.looseTextParsing=L,o()}}),v=D({get(){return N.ui.useDarkTheme},set(L){le(()=>{N.ui.useDarkTheme=L,o()})}}),p=D(()=>ge.supports.setDownloadFolder),O=D(()=>ge.state.downloadLocation);function M(){ge.updateDownloadFolder()}function A(){ge.openFolder("downloads")}const g=D(()=>ge.state.hasTemplate);function T(){ge.saveDefaultTemplate()}function $(){ge.clearDefaultTemplate()}function W(){const L=ge.openNewWindow();if(!L){Me.fire(new gs("Failed to open new window. You may need to enable popups."));return}const E=L.document.createElement("div");L.document.body.appendChild(E);for(const U of document.head.querySelectorAll("style,link[rel=stylesheet]"))L.document.head.appendChild(U.cloneNode(!0));document.body.classList.contains("dark-theme")&&L.document.body.classList.add("dark-theme");const ee=L.document.createElement("title");L.document.title="DDLC child",L.document.head.appendChild(ee),Bf(eh).mount(E)}return(L,E)=>(R(),V("div",{class:"panel",ref_key:"root",ref:t},[E[26]||(E[26]=d("h1",null,"Settings",-1)),(R(),pe(tf,{to:"#modal-messages"},[r.value?(R(),pe(no,{key:0,options:["Allow","Deny"],onLeave:E[0]||(E[0]=ee=>u("Deny")),onOption:u,"no-base-size":""},{default:ne(()=>[d("div",E1,[E[14]||(E[14]=d("p",null," Do you want to allow DDDG to save settings on your device? ",-1)),E[15]||(E[15]=d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),E[16]||(E[16]=d("p",null,"You can revoke this permission at any time.",-1)),d("p",null,[E[12]||(E[12]=Q(" Our usual ")),F(Qe,{to:"wiki://Privacy Statement"},{default:ne(()=>E[11]||(E[11]=[Q("privacy policy")])),_:1}),E[13]||(E[13]=Q(" still applies. "))])])]),_:1})):he("",!0),i.value?(R(),pe(no,{key:1,options:["Deny","Cancle"],onLeave:E[1]||(E[1]=ee=>c("Cancel")),onOption:c,"no-base-size":""},{default:ne(()=>[d("div",L1,[E[20]||(E[20]=d("p",null," Do you want to deny DDDG from saving settings on your device? ",-1)),E[21]||(E[21]=d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),d("p",null,[E[18]||(E[18]=Q(" Our usual ")),F(Qe,{to:"wiki://Privacy Statement"},{default:ne(()=>E[17]||(E[17]=[Q("privacy policy")])),_:1}),E[19]||(E[19]=Q(" still applies. "))])])]),_:1})):he("",!0),f.value?(R(),pe(no,{key:2,options:[m.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:E[2]||(E[2]=ee=>f.value=!1),onOption:b,"no-base-size":""},{default:ne(()=>E[22]||(E[22]=[d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)])),_:1},8,["options"])):he("",!0)])),J(e)==="done"?(R(),V("p",N1," Update is successfully downloaded. It will be installed once the application is closed. ")):he("",!0),J(e)==="wait"?(R(),V("p",H1,"Checking for updates...")):he("",!0),typeof J(e)=="number"?(R(),V("p",W1," Downloading update ("+Oe(J(e))+"%) ",1)):he("",!0),l.value?(R(),V("button",V1,"Applying...")):!a.value&&s.value?(R(),V("button",{key:4,onClick:E[3]||(E[3]=ee=>r.value=!0)}," Allow saving options ")):a.value&&s.value?(R(),V("button",{key:5,onClick:E[4]||(E[4]=ee=>i.value=!0)}," Deny saving options ")):he("",!0),d("button",{onClick:E[5]||(E[5]=ee=>f.value=!0),class:Ne(s.value?"bt0":"")},[m.value?(R(),V(ce,{key:0},[Q(" Enter Classic Mode ")],64)):(R(),V(ce,{key:1},[Q(" Enter DDLC Plus Mode ")],64))],2),d("button",{class:"bt0",onClick:W,style:{height:"auto"}}," Open additional window "),x.value?(R(),pe(Ge,{key:6,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:k.value,"onUpdate:modelValue":E[6]||(E[6]=ee=>k.value=ee)},null,8,["modelValue"])):he("",!0),F(Ge,{label:"NSFW Mode?",modelValue:y.value,"onUpdate:modelValue":E[7]||(E[7]=ee=>y.value=ee)},null,8,["modelValue"]),F(Ge,{label:"Enlarge talking objects? (Default value)",modelValue:w.value,"onUpdate:modelValue":E[8]||(E[8]=ee=>w.value=ee)},null,8,["modelValue"]),F(Ge,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:h.value,"onUpdate:modelValue":E[9]||(E[9]=ee=>h.value=ee)},null,8,["modelValue"]),d("table",F1,[d("tbody",null,[d("tr",null,[E[24]||(E[24]=d("td",null,[d("label",null,"Theme:")],-1)),d("td",null,[Pe(d("select",{"onUpdate:modelValue":E[10]||(E[10]=ee=>v.value=ee),class:"v-w100"},E[23]||(E[23]=[d("option",{value:null},"System",-1),d("option",{value:!1},"Light",-1),d("option",{value:!0},"Dark",-1)]),512),[[_t,v.value]])])])])]),p.value?(R(),V("table",U1,[d("tbody",null,[d("tr",null,[E[25]||(E[25]=d("td",null,[d("label",null,"Download folder:")],-1)),d("td",null,Oe(O.value),1),d("td",null,[d("button",{onClick:M},"Set"),d("button",{onClick:A},"Open")])])])])):he("",!0),a.value?(R(),V(ce,{key:8},[d("button",{onClick:T},"Save as template"),g.value?(R(),V("button",{key:0,onClick:$}," Clear template ")):he("",!0)],64)):he("",!0)],512))}}),z1=Be(q1,[["__scopeId","data-v-acdd373d"]]),X1=Se({mixins:[v1],inject:["viewport"],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.viewport.isVertical?"vertical":"horizontal":this.direction==="inverted"?this.viewport.isVertical?"horizontal":"vertical":this.direction}},render(){const n=this.noWraping?"no-wraping":"wraping",t=fu("div",{class:["d-flow",this.finalDirection,n],style:{gap:this.gap}},this.$slots.default());if(this.maxSize!==void 0){const e=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return fu("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:e}},[t])}return t},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}}),Rt=Be(X1,[["__scopeId","data-v-592e1a80"]]),Y1=["for"],G1=["id","x1","x2"],K1=["offset"],J1=["fill"],Z1=["d"],Q1=["id","max","value"],Ts=255,ml=8,ek=Se({__name:"color-slider",props:Bn({label:{},gradientStops:{},maxValue:{},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=Va(),s=Pn(),r=I(null),i=D(()=>{const b=e.value/t.maxValue*Ts;return`M${b} 0L${b+14} 0L${b+7} 12Z`}),l=D(()=>!t.shiftGradient||e.value===0?0:e.value/t.maxValue);function a(b){e.value=parseFloat(b.target.value)}const u=I(!1);function c(b){u.value=!0,f(b),Jo(b)&&(window.addEventListener("mousemove",f),window.addEventListener("mouseup",m)),b.preventDefault()}function f(b){if(!u.value)return;const x=r.value;if(Jo(b)&&b.buttons===0){m();return}b.preventDefault();const k=x.getBoundingClientRect(),y=k.width/(ml+Ts+ml),h=((Jo(b)?b.clientX:b.touches[0].clientX)-k.x)/y,v=Math.max(Math.min(h-ml,Ts),0)/Ts*t.maxValue;e.value=v,b.preventDefault()}function m(){u.value=!1,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}return(b,x)=>(R(),V("div",{class:Ne({slider:!0,vertical:J(s)}),onKeydown:x[1]||(x[1]=fe(()=>{},["stop"]))},[b.noInput?he("",!0):(R(),V("label",{key:0,for:J(o)},Oe(b.label),9,Y1)),d("div",null,[(R(),V("svg",{ref_key:"svg",ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:c,onTouchstart:c,onTouchmove:f,onTouchend:m},[d("defs",null,[d("linearGradient",{id:`gradient${J(o)}`,x1:l.value*100+"%",y1:"0%",x2:(l.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(R(!0),V(ce,null,ze(b.gradientStops,(k,y)=>(R(),V("stop",{key:y,offset:y/(b.gradientStops.length-1)*100+"%",style:tt("stop-color:"+k)},null,12,K1))),128))],8,G1)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${J(o)})`},null,8,J1),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,Z1)])],544))]),b.noInput?he("",!0):(R(),V("input",{key:1,id:J(o),class:"sliderInput",min:"0",max:b.maxValue,value:e.value,type:"number",onInput:a,onKeydown:x[0]||(x[0]=fe(()=>{},["stop"]))},null,40,Q1))],34))}}),An=Be(ek,[["__scopeId","data-v-7d9ad553"]]),tk=Se({__name:"slider-group",props:Bn({mode:{default:"hsla"},relative:{type:Boolean,default:!1}},{modelValue:{required:!0,validator:n=>!!n.match(/^#[0-9a-f]{6,8}$/i)},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=I(null),s=I(0),r=I(0),i=I(0),l=I(0),a=y({rgba:{label:"Red",stops(){const w=t.relative?r.value:0,h=t.relative?i.value:0;return[new Le(0,w,h,1),new Le(255,w,h,1)]}},hsla:{label:"Hue",max:360,stops(){const w=t.relative?r.value/100:1,h=t.relative?i.value/100:.5;return k(v=>new Ve(v,w,h,1))}}}),u=y({rgba:{label:"Green",stops(){const w=t.relative?s.value:0,h=t.relative?i.value:0;return[new Le(w,0,h,1),new Le(w,255,h,1)]}},hsla:{label:"Saturation",stops(){const w=t.relative?s.value/360:0,h=t.relative?i.value/100:.5;return k(v=>new Ve(w,v,h,1))}}}),c=y({rgba:{label:"Blue",stops(){const w=t.relative?s.value:0,h=t.relative?r.value:0;return[new Le(w,h,0,1),new Le(w,h,255,1)]}},hsla:{label:"Luminosity",stops(){const w=t.relative?s.value/360:0,h=t.relative?r.value/100:.5;return k(v=>new Ve(w,h,v,1))}}}),f=D(()=>{const w=Le.fromHex(e.value);return[new Le(w.r,w.g,w.b,0).toCss(),new Le(w.r,w.g,w.b,1).toCss()]});function m(){e.value!==o.value&&x()}function b(){let w;t.mode==="rgba"?w=new Le(s.value,r.value,i.value,l.value/255):w=new Ve(s.value/360,r.value/100,i.value/100,l.value/255);const h=w.toRgb().toHex();if(o.value!==h){if(h.length!==9)throw new Error(`Invalid color code: ${h}`);o.value=h,e.value=h}}function x(){const w=Le.fromHex(e.value);if(o.value=w.toHex(),l.value=w.a*255,t.mode==="hsla"){const h=w.toHSL();s.value=h.h*360,r.value=h.s*100,i.value=h.l*100}else s.value=w.r,r.value=w.g,i.value=w.b}function k(w){const h=[];for(let v=0;v<=8;++v)h.push(w(v/8));return h}Xe(()=>e.value,m),Xe(()=>t.mode,x,{immediate:!0}),Xe(()=>[s.value,r.value,i.value,l.value],b);function y({rgba:w,hsla:h}){const v=D(()=>t.mode==="rgba"?255:h.max??100),p=D(()=>t.mode==="rgba"?w.label:h.label),O=D(()=>(t.mode==="rgba"?w.stops():h.stops()).map(A=>A.toRgb().toCss()));return{maxValue:v,label:p,stops:O}}return(w,h)=>(R(),V("div",null,[F(An,{label:J(a).label.value,modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=v=>s.value=v),"max-value":J(a).maxValue.value,"gradient-stops":J(a).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),F(An,{label:J(u).label.value,modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=v=>r.value=v),"max-value":J(u).maxValue.value,"gradient-stops":J(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),F(An,{label:J(c).label.value,modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=v=>i.value=v),"max-value":J(c).maxValue.value,"gradient-stops":J(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),F(An,{label:"Alpha",modelValue:l.value,"onUpdate:modelValue":h[3]||(h[3]=v=>l.value=v),"max-value":255,"gradient-stops":f.value},null,8,["modelValue","gradient-stops"])]))}}),nk=Be(tk,[["__scopeId","data-v-0d496402"]]),ok={class:"v-w100 h-h100"},sk={class:"hex-selector"},rk=["for"],ik=["id","value"],lk=["title","onClick"],bd="dddg.generated.colors",ak=Se({inheritAttrs:!1,__name:"color-picker",props:Bn({title:{default:""},format:{default:"hex"}},{modelValue:{required:!0},modelModifiers:{}}),emits:Bn(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=n,o=hs(n,"modelValue"),s=t,r=Va(),i=I("hsla"),l=Pn(),a=D({get(){return e.format==="rgb"?Le.fromCss(o.value).toHex():o.value},set(k){if(e.format==="rgb"){const y=Le.fromCss(k);o.value=y.toCss()}else o.value=k}});function u(k){const y=k.target.value;Le.validHex(y)&&(y.length===7||y.length===9)&&(a.value=y)}const c=D(()=>N.content.current.colors);function f(){if(c.value.find(w=>w.color===a.value))return;const k=N.content.contentPacks.find(w=>w.packId===bd)||{packId:bd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},y={...k,colors:[...k.colors,{label:a.value,color:a.value}]};le(async()=>{await N.content.replaceContentPack({contentPack:y,processed:!0})})}const m=St();function b(){le(()=>{m.value.pickColor=!0})}function x(k){a.value=Le.fromCss(k.color).toHex()}return Ht(()=>{Me.subscribe(nr,x)}),Sn(()=>{Me.unsubscribe(nr,x)}),(k,y)=>(R(),V("div",{class:Ne([{color:!0,vertical:J(l)},"v-w100 h-h100"])},[d("h2",null,Oe(k.title),1),d("button",{onClick:y[0]||(y[0]=w=>s("leave"))},"OK"),d("table",null,[d("tbody",null,[d("tr",null,[d("td",null,[d("button",{onClick:y[1]||(y[1]=w=>i.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:y[2]||(y[2]=w=>i.value="rgba")},"RGBA")])])])]),d("div",ok,[F(nk,{mode:i.value,modelValue:a.value,"onUpdate:modelValue":y[3]||(y[3]=w=>a.value=w),relative:!0},null,8,["mode","modelValue"]),d("div",sk,[d("label",{class:"hex-label",for:`hex_${J(r)}`},"Hex",8,rk),d("input",{id:`hex_${J(r)}`,value:a.value,onInput:u,onKeydown:y[4]||(y[4]=fe(()=>{},["stop"]))},null,40,ik)]),F(Rt,{direction:"global",class:"color-tools"},{default:ne(()=>[d("button",{onClick:f},"Add as swatch"),F(Ie,{class:"h-bl0 v-bt0",icon:"colorize",onClick:b},{default:ne(()=>y[5]||(y[5]=[Q("Pick color")])),_:1})]),_:1})]),d("div",{id:"color-swatches",class:Ne({vertical:J(l)})},[(R(!0),V(ce,null,ze(c.value,w=>(R(),V("button",{class:"swatch",key:w.color,style:tt({backgroundColor:w.color}),title:w.label,onClick:h=>{a.value=w.color,s("leave")}},null,12,lk))),128))],2)],2))}}),Dr=Be(ak,[["__scopeId","data-v-808c5333"]]),uk={class:"fieldset_wrapper"},ck={key:0},dk={class:"fieldset_contents"},fk=Se({__name:"d-fieldset",props:{title:{}},setup(n){const t=n;return(e,o)=>(R(),V("div",uk,[d("fieldset",null,[e.title>""?(R(),V("legend",ck,Oe(t.title),1)):he("",!0),d("div",dk,[Xt(e.$slots,"default",{},void 0,!0)])])]))}}),xt=Be(fk,[["__scopeId","data-v-bca80d0b"]]),pk={class:"column ok-col"},hk={key:0,class:"column"},vk=["value"],gk=["disabled"],mk=["disabled"],bk=["disabled"],yk=["disabled"],wk=["onClick","onKeydown"],kk={key:0,class:"value-input-table"},Ck=["value","max","min"],_k={key:0},xk={colspan:"2"},Sk=["value","max","min"],Pk={key:0},Ok={colspan:"2"},Tk=Se({__name:"image-options",props:{type:{},id:{},panelId:{},noComposition:{type:Boolean}},emits:["leave"],setup(n,{emit:t}){const e=n,o=t,s=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),r=(()=>{try{const U=Ln();U.width=0,U.height=0;const j="filter"in U.getContext("2d");if(uo(U),j)return Array.from(s.keys()).sort()}catch{}return["opacity"]})(),i=I(null),l=I(0),a=D(()=>{switch(e.type){case"object":return N.panels.panels[e.panelId].objects[e.id];case"background":return N.panels.panels[e.panelId].background;case"panel":return N.panels.panels[e.panelId];default:throw new Kt.UnreachableCaseError(e.type)}}),u=D({get(){return a.value.composite},set(U){le(()=>{a.value.composite=U})}}),c=D(()=>a.value.filters),f=D(()=>c.value[l.value]??null),m=D(()=>{const U=f.value;return U==null?!1:id.has(U.type)}),b=D(()=>{const U=f.value;if(U!=null){if(U.type==="hue-rotate")return 360;if(U.type==="grayscale"||U.type==="sepia"||U.type==="opacity"||U.type==="invert")return 100}}),x=D(()=>{const U=f.value;if(U!=null)switch(U.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function k(U){return s.get(U)}function y(U){return id.has(U.type)?`${s.get(U.type)} ${(U.value*100).toFixed()}%`:U.type==="hue-rotate"?`${s.get(U.type)} ${U.value.toFixed()}`:U.type==="blur"?`${s.get(U.type)} ${U.value.toFixed()}px`:s.get(U.type)}function w(){le(()=>{const U=i.value;U!=null&&a.value.addFilter(U,l.value+1)})}function h(U){l.value=U}function v(){le(()=>{a.value.removeFilter(l.value),l.value>=a.value.filters.length&&(l.value=a.value.filters.length-1)})}function p(U){le(async()=>{a.value.moveFilter(l.value,U),l.value+=U})}function O(U){let P=Number(U.target.value);m.value&&(P=P/100),M(P)}function M(U){const P=a.value.filters[l.value];le(()=>{P.value=U})}const A=D(()=>g(P=>new Ve(P,1,.5,1)).map(P=>P.toRgb().toCss()));function g(U){const P=[];for(let j=0;j<=8;++j)P.push(U(j/8));return P}const T=I(!1),$=ee("color"),W=ee("offsetX"),L=ee("offsetY"),E=ee("blurRadius");function ee(U){return D({get(){const P=f.value;if(P==null||!(U in P))throw new Error("Tried reading shadow prop on a non shadow object");return P[U]},set(P){le(()=>{const j=a.value.filters[l.value];j[U]=P})}})}return(U,P)=>T.value?(R(),pe(Dr,{key:0,modelValue:J($),"onUpdate:modelValue":P[0]||(P[0]=j=>ve($)?$.value=j:null),format:"rgb",onLeave:P[1]||(P[1]=j=>T.value=!1)},null,8,["modelValue"])):(R(),pe(Rt,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:ne(()=>[P[35]||(P[35]=d("h2",null,"Image options",-1)),d("div",pk,[d("button",{onClick:P[2]||(P[2]=j=>o("leave"))},"Back")]),U.noComposition?he("",!0):(R(),V("div",hk,[P[26]||(P[26]=d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),F(Qe,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:ne(()=>P[24]||(P[24]=[Q("[?] ")])),_:1}),Pe(d("select",{id:"compositionSelect","onUpdate:modelValue":P[3]||(P[3]=j=>u.value=j),onKeydown:P[4]||(P[4]=fe(()=>{},["stop"]))},P[25]||(P[25]=[d("option",{value:"source-over"},"Normal",-1),d("option",{value:"source-atop"},"source-atop",-1),d("option",{value:"destination-over"},"destination-over",-1),d("option",{value:"destination-in"},"destination-in",-1),d("option",{value:"destination-in"},"destination-out",-1),d("option",{value:"destination-in"},"destination-atop",-1),d("option",{value:"lighter"},"lighter",-1),d("option",{value:"xor"},"xor",-1),d("option",{value:"multiply"},"multiply",-1),d("option",{value:"screen"},"screen",-1),d("option",{value:"overlay"},"overlay",-1),d("option",{value:"darken"},"darken",-1),d("option",{value:"lighten"},"lighten",-1),d("option",{value:"color-dodge"},"color-dodge",-1),d("option",{value:"color-burn"},"color-burn",-1),d("option",{value:"hard-light"},"hard-light",-1),d("option",{value:"soft-light"},"soft-light",-1),d("option",{value:"difference"},"difference",-1),d("option",{value:"exclusion"},"exclusion",-1),d("option",{value:"hue"},"hue",-1),d("option",{value:"saturation"},"saturation",-1),d("option",{value:"color"},"color",-1),d("option",{value:"luminosity"},"luminosity",-1)]),544),[[_t,u.value]])])),F(xt,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:ne(()=>[F(Rt,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:ne(()=>[F(Rt,{direction:"vertical","no-wraping":""},{default:ne(()=>[P[27]||(P[27]=d("label",{for:"addEffect"},"Add new effect",-1)),Pe(d("select",{id:"addEffect","onUpdate:modelValue":P[5]||(P[5]=j=>i.value=j),onKeydown:P[6]||(P[6]=fe(()=>{},["stop"]))},[(R(!0),V(ce,null,ze(J(r),j=>(R(),V("option",{key:j,value:j},Oe(k(j)),9,vk))),128))],544),[[_t,i.value]]),d("button",{disabled:i.value===null,onClick:w,onKeydown:P[7]||(P[7]=fe(()=>{},["stop"]))}," Add ",40,gk),d("button",{disabled:!f.value,onClick:v,onKeydown:P[8]||(P[8]=fe(()=>{},["stop"]))}," Remove ",40,mk),d("button",{disabled:l.value===0,onClick:P[9]||(P[9]=j=>p(-1)),onKeydown:P[10]||(P[10]=fe(()=>{},["stop"]))}," Move up ",40,bk),d("button",{disabled:l.value===c.value.length-1||c.value.length===0,onClick:P[11]||(P[11]=j=>p(1)),onKeydown:P[12]||(P[12]=fe(()=>{},["stop"]))}," Move down ",40,yk)]),_:1}),F(Rt,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:ne(()=>[(R(!0),V(ce,null,ze(c.value,(j,q)=>(R(),V("div",{key:q,class:Ne({choiceBtn:!0,active:q===l.value}),tabindex:"0",onClick:je=>h(q),onKeydown:[rt(je=>h(q),["enter"]),rt(fe(je=>h(q),["prevent"]),["space"])]},Oe(y(j)),43,wk))),128))]),_:1}),f.value?(R(),V("table",kk,[d("tbody",null,[f.value.type==="drop-shadow"?(R(),V(ce,{key:0},[d("tr",null,[P[28]||(P[28]=d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:tt({background:J($)}),onClick:P[13]||(P[13]=j=>T.value=!0)},"  ",4)])]),d("tr",null,[P[29]||(P[29]=d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),d("td",null,[Pe(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":P[14]||(P[14]=j=>ve(W)?W.value=j:null),onKeydown:P[15]||(P[15]=fe(()=>{},["stop"]))},null,544),[[Ke,J(W),void 0,{number:!0}]])])]),d("tr",null,[P[30]||(P[30]=d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),d("td",null,[Pe(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":P[16]||(P[16]=j=>ve(L)?L.value=j:null),onKeydown:P[17]||(P[17]=fe(()=>{},["stop"]))},null,544),[[Ke,J(L),void 0,{number:!0}]])])]),d("tr",null,[P[31]||(P[31]=d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),d("td",null,[Pe(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":P[18]||(P[18]=j=>ve(E)?E.value=j:null),onKeydown:P[19]||(P[19]=fe(()=>{},["stop"]))},null,544),[[Ke,J(E),void 0,{number:!0}]])])])],64)):m.value?(R(),V(ce,{key:1},[d("tr",null,[P[33]||(P[33]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:(f.value.value*100).toFixed(),type:"number",max:b.value,min:x.value,onInput:O,onKeydown:P[20]||(P[20]=fe(()=>{},["stop"]))},null,40,Ck),P[32]||(P[32]=Q("% "))])]),x.value===0&&b.value!==void 0?(R(),V("tr",_k,[d("td",xk,[F(An,{gradientStops:["#000000","#ffffff"],label:"",maxValue:b.value,modelValue:f.value.value*100,"no-input":"","onUpdate:modelValue":P[21]||(P[21]=j=>M(Math.round(j)/100))},null,8,["maxValue","modelValue"])])])):he("",!0)],64)):(R(),V(ce,{key:2},[d("tr",null,[P[34]||(P[34]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:f.value.value,type:"number",max:b.value,min:x.value,onInput:O,onKeydown:P[22]||(P[22]=fe(()=>{},["stop"]))},null,40,Sk)])]),x.value===0&&b.value!==void 0?(R(),V("tr",Pk,[d("td",Ok,[F(An,{gradientStops:A.value,label:"",maxValue:b.value,modelValue:f.value.value,"no-input":"","onUpdate:modelValue":P[23]||(P[23]=j=>M(Math.round(j)))},null,8,["gradientStops","maxValue","modelValue"]),F(An,{gradientStops:A.value,label:"",maxValue:b.value,modelValue:f.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):he("",!0)],64))])])):he("",!0)]),_:1})]),_:1})]),_:1}))}}),Fa=Be(Tk,[["__scopeId","data-v-05583125"]]),$k=["title"],jk=["title"],Rk=Se({__name:"bg-button",props:{backgroundId:{}},setup(n){const t=n,e=St(),o=D(()=>{const m=e.value.currentPanel;return N.panels.panels[m].background}),s=I(null),r=D(()=>{Object.keys(N.uploadUrls);const m=i.value;if(!m)return null;for(const b of m.variants)for(const x of b){const k=kn(x,!1);if(k.startsWith("uploads:"))return Object.keys(N.uploadUrls),k.substring(8)}return null}),i=D(()=>N.content.backgrounds.get(t.backgroundId)||null),l=D(()=>t.backgroundId===o.value.current),a=D(()=>{switch(t.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return i.value.label??""}),u=D(()=>{var x;switch(t.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let m=!1;const b=(x=i.value)==null?void 0:x.variants[0].map(k=>{const y=kn(k,!1);return y.startsWith("uploads:")&&(m=!0),`url('${y}')`}).join(",");return m&&Object.keys(N.uploadUrls),{backgroundImage:b??""}});function c(){s.value.click()}async function f(){const m=s.value,b=r.value;if(!m.files)return;if(m.files.length!==1){console.error("More than one file uploaded!");return}const x=m.files[0];await le(async()=>{const k=URL.createObjectURL(x);N.uploadUrls.add(b,k)})}return(m,b)=>r.value!==null?(R(),V("div",{key:0,class:Ne({background:!0,active:l.value}),title:a.value,style:tt(u.value),tabindex:"0",onClick:b[0]||(b[0]=x=>c()),onKeypress:[b[1]||(b[1]=rt(fe(x=>c(),["prevent","stop"]),["enter"])),b[2]||(b[2]=rt(fe(x=>c(),["prevent","stop"]),["space"]))]},[Q(Oe(a.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,$k)):(R(),V("div",{key:1,class:Ne({background:!0,active:l.value}),title:a.value,style:tt(u.value),tabindex:"0",onClick:b[3]||(b[3]=x=>m.$emit("input",m.backgroundId)),onKeydown:[b[4]||(b[4]=rt(x=>m.$emit("input",m.backgroundId),["enter"])),b[5]||(b[5]=rt(fe(x=>m.$emit("input",m.backgroundId),["prevent"]),["space"]))]},Oe(a.value),47,jk))}}),Ik=Be(Rk,[["__scopeId","data-v-7d07eaaf"]]),Ak={key:1},Mk={colspan:"3"},Dk={key:0},Bk={class:"arrow-col"},Ek={class:"arrow-col"},Lk={colspan:"3"},Nk={colspan:"3"},Hk=Se({__name:"bg-settings",emits:["open-image-options","change-color"],setup(n,{emit:t}){const e=t,o=St(),s=Pn(),r=D(()=>{const k=o.value.currentPanel;return N.panels.panels[k].background}),i=D({get(){return r.value.flipped},set(k){le(()=>{N.panels.panels[o.value.currentPanel].background.flipped=k})}}),l=D({get(){return r.value.scaling.toString()},set(k){le(()=>{N.panels.panels[o.value.currentPanel].background.scaling=parseInt(k,10)})}}),a=D(()=>r.value.current),u=D(()=>N.content.current.backgrounds.find(k=>k.id===a.value)||null),c=D(()=>a.value==="buildin.static-color"),f=D({get(){return r.value.color},set(k){le(()=>{N.panels.panels[o.value.currentPanel].background.color=k})}}),m=D(()=>!!u.value),b=D(()=>u.value?u.value.variants.length>1:!1);function x(k){le(async()=>{N.panels.panels[o.value.currentPanel].background.seekBackgroundVariant(k)})}return(k,y)=>(R(),pe(xt,{class:Ne({"bg-settings":!0,vertical:J(s)}),title:"Settings:"},{default:ne(()=>[c.value?(R(),V(ce,{key:0},[y[7]||(y[7]=d("label",{for:"bg_color"},"Color:",-1)),d("button",{id:"bg_color",class:"color-button",style:tt({background:f.value}),onClick:y[0]||(y[0]=w=>e("change-color"))},null,4)],64)):he("",!0),m.value?(R(),V("table",Ak,[d("tbody",null,[d("tr",null,[d("td",Mk,[F(Ge,{modelValue:i.value,"onUpdate:modelValue":y[1]||(y[1]=w=>i.value=w),label:"Flipped?"},null,8,["modelValue"])])]),b.value?(R(),V("tr",Dk,[d("td",Bk,[d("button",{class:"small-button",onClick:y[2]||(y[2]=w=>x(-1))}," < ")]),y[8]||(y[8]=d("td",{style:{"text-align":"center"}},"Variant",-1)),d("td",Ek,[d("button",{class:"small-button",onClick:y[3]||(y[3]=w=>x(1))}," > ")])])):he("",!0),d("tr",null,[d("td",Lk,[Pe(d("select",{"onUpdate:modelValue":y[4]||(y[4]=w=>l.value=w),onKeydown:y[5]||(y[5]=fe(()=>{},["stop"]))},y[9]||(y[9]=[d("option",{value:"0"},"None",-1),d("option",{value:"1"},"Stretch",-1),d("option",{value:"2"},"Cover",-1)]),544),[[_t,l.value]])])]),d("tr",null,[d("td",Nk,[d("button",{id:"image_options_button",class:"v-w100",onClick:y[6]||(y[6]=w=>e("open-image-options"))}," Image options ")])])])])):he("",!0)]),_:1},8,["class"]))}}),Wk=Be(Hk,[["__scopeId","data-v-eacb0b71"]]),Vk=Se({__name:"backgrounds-tool",setup(n){const t={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},e=I(null);Mt(e);const o=St(),s=I(!1),r=I(!1),i=D({get(){return N.panels.panels[o.value.currentPanel].background.color},set(h){le(()=>{N.panels.panels[o.value.currentPanel].background.color=h})}}),l=D(()=>[...N.content.current.backgrounds.map(h=>h.id),"buildin.static-color","buildin.transparent"]),a=D(()=>ge.supports.openableFolders.has("backgrounds"));function u(h){le(()=>{N.panels.panels[o.value.currentPanel].background.current=h})}function c(){ge.openFolder("backgrounds")}const f=I(null);function m(){const h=f.value;if(h.files)for(const v of h.files)b(v)}async function b(h){await le(async()=>{const v=URL.createObjectURL(h),p=await N.uploadUrls.add(h.name,v);await k(h.name,h.name,p)})}function x(){const h=prompt("Enter the URL of the image");if(h==null)return;const v=h.split("/").slice(-1)[0];k(v,v,h)}async function k(h,v,p){const O=N.content.contentPacks.find(A=>A.packId===t.packId)||t,M={...O,backgrounds:[...O.backgrounds,{id:h,label:v,variants:[[{hq:p,lq:p,sourcePack:t.packId}]],scaling:"none"}]};await le(async()=>{await N.content.replaceContentPack({contentPack:M,processed:!0}),u(h)})}const y=I(null);function w(h){h.dataTransfer&&(h.dataTransfer.effectAllowed="none",Array.from(h.dataTransfer.items).find(v=>v.type.match(/^image.*$/))&&(h.dataTransfer.effectAllowed="link",y.value.show()))}return(h,v)=>(R(),V("div",{class:"panel",ref_key:"root",ref:e,onDragenter:w,onMouseleave:v[7]||(v[7]=p=>y.value.hide())},[F(Qp,{ref_key:"dt",ref:y,class:"drop-target",onDrop:b},{default:ne(()=>v[8]||(v[8]=[Q("Drop here to add as a new background ")])),_:1},512),v[13]||(v[13]=d("h1",null,"Background",-1)),s.value?(R(),pe(Dr,{key:0,modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=p=>i.value=p),onLeave:v[1]||(v[1]=p=>s.value=!1)},null,8,["modelValue"])):r.value?(R(),pe(Fa,{key:1,type:"background",title:"","panel-id":J(o).currentPanel,"no-composition":"",onLeave:v[2]||(v[2]=p=>r.value=!1)},null,8,["panel-id"])):(R(),V(ce,{key:2},[F(Wk,{onChangeColor:v[3]||(v[3]=p=>s.value=!0),onOpenImageOptions:v[4]||(v[4]=p=>r.value=!0)}),F(Ie,{icon:"upload",class:"upload-background",onClick:v[5]||(v[5]=p=>f.value.click())},{default:ne(()=>[v[9]||(v[9]=Q(" Upload ")),d("input",{type:"file",ref_key:"upload",ref:f,onChange:m,multiple:""},null,544)]),_:1}),F(Ie,{icon:"link",class:"upload-background",onClick:x},{default:ne(()=>v[10]||(v[10]=[Q(" Add by URL ")])),_:1}),F(Ie,{icon:"extension",class:"upload-background",onClick:v[6]||(v[6]=p=>h.$emit("show-dialog","type: Backgrounds"))},{default:ne(()=>v[11]||(v[11]=[Q(" Search in content packs ")])),_:1}),a.value?(R(),pe(Ie,{key:0,icon:"folder",class:"upload-background",onClick:c},{default:ne(()=>v[12]||(v[12]=[Q(" Open backgrounds folder ")])),_:1})):he("",!0),(R(!0),V(ce,null,ze(l.value,p=>(R(),pe(Ik,{key:p,backgroundId:p,onInput:O=>u(p)},null,8,["backgroundId","onInput"]))),128))],64))],544))}}),Fk=Be(Vk,[["__scopeId","data-v-68dabeb4"]]);function Re(n,t){return D({get(){return n.value[t]},set(e){le(()=>{n.value[t]=e})}})}function Qo(n,t){return(...e)=>{le(()=>{n.value[t](...e)})}}const Uk=["onKeydown"],yd=960,qk=Se({__name:"part-button",props:{part:{},size:{default:150}},emits:["click","quick-click"],setup(n,{emit:t}){const e=n,o=t,s=I([]),r=D(()=>e.size/e.part.size[0]),i=D(()=>e.size/e.part.size[1]),l=D(()=>`${Math.floor(yd*r.value)}px ${Math.floor(yd*i.value)}px`),a=D(()=>{let m="";const b=l.value,x=e.part.offset??[0,0],k=e.part.images.length-1;for(let y=0;y<=k;++y){const w=e.part.images[k-y],h=s.value[k-y];if(!h)continue;y>0&&(m+=", ");const v=w.offset??[0,0],p=`${Math.floor((x[0]-v[0])*-r.value)}px ${Math.floor((x[1]-v[1])*-i.value)}px`;m+=`url('${h.replace("'","\\'")}') ${p} / ${b}`}return m}),u=D(()=>({height:e.size+"px",width:e.size+"px",background:a.value}));function c(m){m.preventDefault(),o("quick-click")}async function f(){s.value=await Promise.all(e.part.images.map(m=>typeof m.asset=="string"?Bw(m.asset,!1):kn(m.asset,!1)))}return vo("Initialization of parts button",f),(m,b)=>{var x;return R(),V("div",{class:Ne({part:!0,active:(x=m.part)==null?void 0:x.active}),style:tt(u.value),tabindex:"0",onClick:b[0]||(b[0]=k=>o("click")),onContextmenu:c,onKeydown:[b[1]||(b[1]=rt(fe(k=>o("click"),["prevent"]),["enter"])),rt(fe(c,["prevent"]),["space"])]},null,46,Uk)}}}),wd=Be(qk,[["__scopeId","data-v-a09133e4"]]),zk=Se({__name:"part-selection",props:{character:{},part:{}},emits:["leave","show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=n,o=t,s=I(null),r=I([]),i=D(()=>{switch(e.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),l=D(()=>e.character.charData),a=D(()=>{if(e.part!=="style")return[];const w=l.value.styleGroups[e.character.styleGroupId];return w.styleComponents.map(h=>{const v={};for(const p in h.variants){if(!h.variants.hasOwnProperty(p))continue;const O=h.variants[p];v[p]={size:w.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:O}],active:!1}}return{label:h.label,name:h.id,buttons:v}})}),u=D(()=>{const w={};let h,v,p;const O=l.value,M=e.character.poseData;switch(e.part){case"head":{const g=e.character.posePositions.headType||0,T=e.character.posePositions.head||0;for(let $=0;$<M.compatibleHeads.length;++$){const W=M.compatibleHeads[$],L=O.heads[W];for(let E=0;E<L.variants.length;++E){const ee=L.variants[E];w[`${$}_${E}`]={size:L.previewSize,offset:L.previewOffset,images:ee.map(U=>({asset:U,offset:[0,0]})),active:T===E&&g===$}}}return w}case"pose":const A=O.styleGroups[e.character.styleGroupId].styles[e.character.styleId];for(let g=0;g<A.poses.length;++g){const T=A.poses[g],$=f(T);w[g]=$,$.active=g===e.character.poseId}return w;case"style":for(let g=0;g<O.styleGroups.length;++g){const T=O.styleGroups[g],$=f(T.styles[0].poses[0]);w[T.id]=$,$.active=g===e.character.styleGroupId}return w;default:h=M.positions[e.part],p=M.previewSize,v=M.previewOffset;break}for(let A=0;A<h.length;++A){const g=h[A];w[A]={images:g.map(T=>({offset:[0,0],asset:T})),size:p,offset:v,active:A===(e.character.posePositions[e.part]||0)}}return w});function c(){const w=l.value.styleGroups[e.character.styleGroupId].styles[e.character.styleId];r.value=Object.keys(w.components).map(h=>[h,w.components[h]])}function f(w){const h=l.value;let v=[];for(const p of w.renderCommands)switch(p.type){case"pose-part":const O=w.positions[p.part];if(O==null||O.length===0)break;v=v.concat(O[0].map(M=>({asset:M,offset:p.offset})));break;case"head":{const M=h.heads[w.compatibleHeads[0]];if(w.compatibleHeads.length===0)break;const A=M.variants[0];v=v.concat(A.map(g=>({asset:g,offset:p.offset})));break}case"image":v=v.concat(p.images.map(M=>({asset:M,offset:p.offset})));break}return{images:v,size:w.previewSize,offset:w.previewOffset,active:!1}}function m(w){w==null&&(w=e.character.styleGroupId);const v=l.value.styleGroups[w];let p=v.styles;for(const O of r.value){const M=p.filter(A=>A.components[O[0]]===O[1]);M.length>0&&(p=M)}le(async()=>{e.character.setCharStyle(w,v.styles.indexOf(p[0]))})}function b(w){if(e.part==="style")m(l.value.styleGroups.findIndex(h=>h.id===w));else if(e.part==="head"){const[h,v]=(""+w).split("_",2).map(p=>parseInt(p,10));le(()=>{e.character.setPosePosition({headType:h,head:v})})}else y(e.part,parseInt(""+w,10))}function x(w,h){const v=r.value.findIndex(p=>p[0]===w);r.value.splice(v,1),r.value.unshift([w,""+h]),m()}function k(w){(w.key==="Backspace"||w.key==="Escape")&&(o("leave"),w.preventDefault(),w.stopPropagation())}function y(w,h){le(async()=>{e.character.setPart(w,h)})}return vo("Initializing parts data",async()=>{s.value=await fo()}),Xe(()=>e.character,c,{immediate:!0}),(w,h)=>(R(),pe(Rt,{"no-wraping":"",onKeydown:k},{default:ne(()=>[d("button",{onClick:h[0]||(h[0]=v=>o("leave")),class:"h-h100"},"Back"),F(Rt,{direction:"vertical",class:"parts-fnc-btns"},{default:ne(()=>[F(Ie,{icon:"extension",class:"h-bl0 v-w100 v-bt0",onClick:h[1]||(h[1]=v=>o("show-dialog",`type: ${i.value} character: ${l.value.label}`))},{default:ne(()=>h[3]||(h[3]=[Q(" Search in content packs ")])),_:1}),w.part==="head"?(R(),pe(Ie,{key:0,icon:"extension",class:"h-bl0 h-bt0 v-w100 v-bt0",onClick:h[2]||(h[2]=v=>o("show-expression-dialog",{character:w.character.characterType}))},{default:ne(()=>h[4]||(h[4]=[Q(" Create new expressions ")])),_:1})):he("",!0)]),_:1}),(R(!0),V(ce,null,ze(u.value,(v,p)=>(R(),pe(wd,{key:p,value:p,part:v,onClick:O=>{b(p),o("leave")},onQuickClick:O=>b(p)},null,8,["value","part","onClick","onQuickClick"]))),128)),(R(!0),V(ce,null,ze(a.value,v=>(R(),pe(xt,{key:v.name,title:v.label,class:"h-h100"},{default:ne(()=>[F(Rt,{noWraping:""},{default:ne(()=>[(R(!0),V(ce,null,ze(v.buttons,(p,O)=>(R(),pe(wd,{size:130,key:O,value:O,part:p,onClick:M=>x(v.name,O)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}}),Xk=Be(zk,[["__scopeId","data-v-21ad448a"]]),Yk=Se({__name:"delete-btn",props:{obj:{}},setup(n){const t=n;function e(){le(async()=>{N.panels.panels[t.obj.panelId].removeObject(t.obj)})}return(o,s)=>(R(),V("button",{onClick:e},"Delete"))}}),Gk=Se({__name:"layer-btns",props:{object:{}},setup(n){const t=n,e=D(()=>t.object),o=D(()=>N.panels.panels[t.object.panelId]),s=Re(e,"onTop");function r(i){le(async()=>{o.value.shiftLayer(t.object,i)})}return(i,l)=>(R(),pe(xt,{id:"layerfs",title:"Layer:"},{default:ne(()=>[F(Rt,{class:"layer_flow",direction:"horizontal"},{default:ne(()=>[F(Ie,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>r(-1/0)),title:"Move to back"}),F(Ie,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>r(-1)),title:"Move backwards"}),F(Ie,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>r(1)),title:"Move forwards"}),F(Ie,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>r(1/0)),title:"Move to front"})]),_:1}),F(Ge,{modelValue:J(s),"onUpdate:modelValue":l[4]||(l[4]=a=>ve(s)?s.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}}),Kk=Be(Gk,[["__scopeId","data-v-2b245c52"]]),Jk={class:"v-w100"},Zk={colspan:"2"},Qk={key:0},eC={colspan:"2"},tC={class:"v-w100 button-tbl"},nC={class:"arrow-col"},oC=["disabled"],sC=["value"],rC={class:"arrow-col"},iC=["disabled"],lC={class:"v-w50"},aC={class:"v-w50"},uC={class:"v-w50"},cC={class:"v-w50"},dC=Se({__name:"position-and-size",props:{obj:{}},setup(n){const t=n,e=D(()=>t.obj),o=D({get(){const k=de().TextBox;return t.obj.height-(i.value?k.NameboxHeight:0)},set(k){const y=de().TextBox;le(()=>{t.obj.height=k+(i.value?y.NameboxHeight:0)})}}),s=Re(e,"width"),r=D(()=>{const k=t.obj;if(k.type==="textBox")return Go[k.style].resizable;const y=de().Poem;return k.type==="poem"?y.poemBackgrounds[k.background].file.startsWith("internal:"):!1}),i=D(()=>t.obj.type==="textBox"&&location.search.includes("alex")),l=D(()=>"freeMove"in t.obj&&t.obj.linkedTo==null),a=D(()=>de().Base.positions),u=D(()=>f.value===0),c=D(()=>f.value===de().Base.positions.length-1),f=D({get(){return Ms(t.obj.x)},set(k){le(async()=>{t.obj.x=de().Base.characterPositions[k]})}}),m=D({get(){return!!t.obj.freeMove},set(k){le(()=>{t.obj.freeMove=k})}}),b=Re(e,"x"),x=Re(e,"y");return(k,y)=>(R(),pe(xt,{title:"Position"+(r.value?"/Size":"")},{default:ne(()=>[d("table",Jk,[d("tbody",null,[d("tr",null,[d("td",Zk,[l.value?(R(),pe(Ge,{key:0,modelValue:m.value,"onUpdate:modelValue":y[0]||(y[0]=w=>m.value=w),label:"Move freely?"},null,8,["modelValue"])):he("",!0)])]),l.value&&!m.value?(R(),V("tr",Qk,[d("td",eC,[d("table",tC,[d("tbody",null,[d("tr",null,[d("td",nC,[d("button",{onClick:y[1]||(y[1]=w=>--f.value),disabled:u.value}," < ",8,oC)]),d("td",null,[Pe(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":y[2]||(y[2]=w=>f.value=w)},[(R(!0),V(ce,null,ze(a.value,(w,h)=>(R(),V("option",{key:h,value:h},Oe(w),9,sC))),128))],512),[[_t,f.value,void 0,{number:!0}]])]),d("td",rC,[d("button",{onClick:y[3]||(y[3]=w=>++f.value),disabled:c.value}," > ",8,iC)])])])])])])):(R(),V(ce,{key:1},[d("tr",null,[y[12]||(y[12]=d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),d("td",lC,[Pe(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":y[4]||(y[4]=w=>ve(b)?b.value=w:null),onKeydown:y[5]||(y[5]=fe(()=>{},["stop"]))},null,544),[[Ke,J(b),void 0,{number:!0}]])])]),d("tr",null,[y[13]||(y[13]=d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),d("td",aC,[Pe(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":y[6]||(y[6]=w=>ve(x)?x.value=w:null),onKeydown:y[7]||(y[7]=fe(()=>{},["stop"]))},null,544),[[Ke,J(x),void 0,{number:!0}]])])])],64)),r.value?(R(),V(ce,{key:2},[d("tr",null,[y[14]||(y[14]=d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),d("td",uC,[Pe(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":y[8]||(y[8]=w=>ve(s)?s.value=w:null),onKeydown:y[9]||(y[9]=fe(()=>{},["stop"]))},null,544),[[Ke,J(s),void 0,{number:!0}]])])]),d("tr",null,[y[15]||(y[15]=d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),d("td",cC,[Pe(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":y[10]||(y[10]=w=>o.value=w),onKeydown:y[11]||(y[11]=fe(()=>{},["stop"]))},null,544),[[Ke,o.value,void 0,{number:!0}]])])])],64)):he("",!0)])])]),_:1},8,["title"]))}}),fC=Be(dC,[["__scopeId","data-v-3be3f0bb"]]),pC={class:"column ok-col"},hC={class:"column"},vC=["value"],gC={key:0,class:"column error-col"},mC={class:"column"},bC={class:"column"},yC={class:"column"},wC={class:"column"},kC=Se({inheritAttrs:!1,__name:"text-formatting",props:Bn({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:Bn(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=hs(n,"modelValue"),o=t,s=I(null),r=I(""),i=I(""),l=I("#000000"),a=I(""),u=I(0),c=I(0),f=I(""),m=Pn();Xe(()=>m.value,()=>{const h=s.value;h!=null&&(h.style.height="",h.style.width="")}),Xe(()=>i.value,()=>{i.value!==""&&(w("font",i.value),i.value="")}),Xe(()=>a.value,()=>{if(a.value==="")return;const h=s.value,v=h==null?void 0:h.selectionStart,p=h==null?void 0:h.selectionEnd;h&&(h.selectionEnd=h.selectionStart);const O=`{align=${a.value}}`;y(O),h&&(h.selectionStart=v+O.length,h.selectionEnd=p+O.length),a.value=""});function b(){const h=de(),v=s.value.value;try{new At(v,h.TextBox.NameboxTextStyle),f.value=""}catch(p){f.value=p.message}e.value=v}function x(h){const v=s.value;r.value=h,u.value=v.selectionStart,c.value=v.selectionEnd}function k(){const h=l.value,v=r.value,p=()=>{const O=s.value;if(O==null){yn(p);return}O.selectionStart=u.value,O.selectionEnd=c.value,w(v==="text"?"color":"outlinecolor",h)};yn(p),l.value="#000000",r.value=""}function y(h){const v=s.value,p=v.value,O=v.selectionStart,M=v.selectionEnd;v.value=p.slice(0,O)+h+p.slice(M),v.selectionStart=v.selectionEnd=O+h.length,v.focus(),b()}function w(h,v){const p=s.value,O=p.value,M=p.selectionStart,A=p.selectionEnd,g=O.slice(M,A),T=O.slice(0,M),$=O.slice(A);let W=h;v!=null&&(W+="="+v),p.value=`${T}{${W}}${g}{/${h}}${$}`,p.selectionStart=M+W.length+2,p.selectionEnd=p.selectionStart+g.length,p.focus(),b()}return(h,v)=>r.value?(R(),pe(Dr,{key:0,modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=p=>l.value=p),onLeave:k},null,8,["modelValue"])):(R(),V("div",{key:1,class:Ne({"text-subpanel":!0,vertical:J(m)})},[d("h2",null,Oe(h.title),1),d("div",pC,[d("button",{onClick:v[1]||(v[1]=p=>o("leave"))},"OK")]),d("div",hC,[d("textarea",{class:"v-w100",ref_key:"textArea",ref:s,value:e.value,onInput:b,onKeydown:v[2]||(v[2]=fe(()=>{},["stop"])),onKeypress:v[3]||(v[3]=fe(()=>{},["stop"]))},null,40,vC)]),f.value?(R(),V("div",gC,Oe(f.value),1)):he("",!0),d("div",mC,[d("button",{onClick:v[4]||(v[4]=p=>y("\\\\")),class:"style-button"}," Insert \\ "),d("button",{onClick:v[5]||(v[5]=p=>y("\\{")),class:"style-button"}," Insert { "),d("button",{onClick:v[6]||(v[6]=p=>y("\\}")),class:"style-button"}," Insert } ")]),v[20]||(v[20]=d("p",{class:"hint-col"},"Apply style to selected text:",-1)),d("div",bC,[d("button",{onClick:v[7]||(v[7]=p=>w("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:v[8]||(v[8]=p=>w("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:v[9]||(v[9]=p=>w("plain")),class:"style-button"}," Plain "),d("button",{onClick:v[10]||(v[10]=p=>w("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:v[11]||(v[11]=p=>w("k",2)),class:"style-button",style:{"letter-spacing":"5px","padding-right":"0"}}," Kerning ")]),d("div",yC,[d("button",{onClick:v[12]||(v[12]=p=>w("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",wC,[d("button",{onClick:v[13]||(v[13]=p=>w("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Pe(d("select",{"onUpdate:modelValue":v[14]||(v[14]=p=>i.value=p),class:"style-button"},v[18]||(v[18]=[Uv('<option value data-v-e10386b2>Font</option><option value="aller" style="font-family:aller;" data-v-e10386b2> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-e10386b2> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-e10386b2> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-e10386b2> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-e10386b2> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-e10386b2> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-e10386b2> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-e10386b2> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-e10386b2> Halogen (MC) </option>',10)]),512),[[_t,i.value]]),Pe(d("select",{"onUpdate:modelValue":v[15]||(v[15]=p=>a.value=p),class:"style-button"},v[19]||(v[19]=[d("option",{value:""},"Alignment",-1),d("option",{value:"left",style:{"text-align":"left"}},"Left",-1),d("option",{value:"right",style:{"text-align":"right"}},"Right",-1),d("option",{value:"center",style:{"text-align":"center"}}," Center ",-1)]),512),[[_t,a.value]]),d("button",{onClick:v[16]||(v[16]=p=>x("text")),class:"style-button"}," Text color "),d("button",{onClick:v[17]||(v[17]=p=>x("outline")),class:"style-button"}," Outline color ")])],2))}}),CC=Be(kC,[["__scopeId","data-v-e10386b2"]]),_C={class:"modal-text"},xC=["value"],SC={class:"input-table v-w100"},PC={for:"zoom",class:"v-w100"},OC={key:0},TC={key:0,colspan:"2"},$C={key:0},jC=["placeholder"],RC=Se({__name:"object-tool",props:{object:{},title:{},textHandler:{},colorHandler:{},showAltPanel:{type:Boolean,default:!1}},setup(n){const t=n,e=I(null);Mt(e);const o=D(()=>t.object),s=Re(o,"linkedTo"),r=I(!1),i=I(""),l=I(!1),a=I(null),u=Re(o,"flip"),c=Re(o,"rotation"),f=Re(o,"enlargeWhenTalking"),m=D(()=>Vp(t.object)),b=D(()=>N.panels.panels[t.object.panelId]),x=D(()=>{const U=b.value,P=[];for(const j of[...U.lowerOrder,...U.topOrder]){const q=U.objects[j];q.label===null||q===t.object||P.push([j,q.label])}return P}),k=location.search.includes("alex"),y=Re(o,"preserveRatio"),w=Re(o,"nameboxWidth"),h=D({get(){return t.object.scaleX*100},set(U){le(()=>{o.value.scaleX=U/100})}}),v=D({get(){return t.object.scaleY*100},set(U){le(()=>{o.value.scaleY=U/100})}}),p=Re(o,"skewX"),O=Re(o,"skewY"),M=D(()=>de().TextBox.NameboxWidth),A=D(()=>a.value||t.colorHandler||null),g=D(()=>t.object.label!==null),T=D(()=>t.object.label??t.title??"Object"),$=D({get(){return t.object.textboxColor!==null},set(U){le(()=>{o.value.textboxColor=U?de().TextBoxCustom.textboxDefaultColor:null})}});function W(){le(async()=>{N.ui.copyObjectToClipboard(t.object.panelId,[t.object.id])})}function L(){i.value=t.object.label??"",l.value=!0}function E(U){l.value=!1,U==="Apply"&&le(()=>{o.value.label=i.value})}function ee(){a.value={title:"Textbox color",get:()=>t.object.textboxColor,set:U=>{le(()=>{o.value.textboxColor=U})},leave:()=>{a.value=null}}}return(U,P)=>(R(),V("div",{class:"panel",ref_key:"root",ref:e},[d("h1",{style:tt({fontStyle:g.value?"italic":"normal"}),onClick:L},[Q(Oe(T.value)+" ",1),P[26]||(P[26]=d("span",{class:"icon material-icons"},"edit",-1))],4),(R(),pe(tf,{to:"#modal-messages"},[l.value?(R(),pe(no,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:E,onLeave:P[2]||(P[2]=j=>E("Cancel"))},{default:ne(()=>[P[27]||(P[27]=d("p",{class:"modal-text"},"Enter the new name",-1)),d("p",_C,[Pe(d("input",{"onUpdate:modelValue":P[0]||(P[0]=j=>i.value=j),style:{width:"100%"},onKeydown:P[1]||(P[1]=rt(fe(j=>E("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Ke,i.value]])])]),_:1})):he("",!0)])),U.textHandler?(R(),pe(CC,{key:0,title:U.textHandler.title,modelValue:U.textHandler.get(),"onUpdate:modelValue":P[3]||(P[3]=j=>U.textHandler.set(j)),onLeave:P[4]||(P[4]=j=>U.textHandler.leave())},null,8,["title","modelValue"])):A.value?(R(),pe(Dr,{key:1,title:A.value.title,modelValue:A.value.get(),"onUpdate:modelValue":P[5]||(P[5]=j=>A.value.set(j)),onLeave:P[6]||(P[6]=j=>A.value.leave())},null,8,["title","modelValue"])):r.value?(R(),pe(Fa,{key:2,type:"object","panel-id":o.value.panelId,id:o.value.id,onLeave:P[7]||(P[7]=j=>r.value=!1)},null,8,["panel-id","id"])):U.showAltPanel?Xt(U.$slots,"alt-panel",{key:3},void 0,!0):(R(),V(ce,{key:4},[Xt(U.$slots,"default",{},void 0,!0),F(fC,{obj:o.value},null,8,["obj"]),F(Kk,{object:o.value},null,8,["object"]),F(xt,{title:"Transform",class:"transforms"},{default:ne(()=>[F(Ge,{modelValue:J(u),"onUpdate:modelValue":P[8]||(P[8]=j=>ve(u)?u.value=j:null),label:"Flip?"},null,8,["modelValue"]),P[33]||(P[33]=d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),Pe(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":P[9]||(P[9]=j=>ve(s)?s.value=j:null),onKeydown:P[10]||(P[10]=fe(()=>{},["stop"]))},[P[28]||(P[28]=d("option",{value:""},"None",-1)),(R(!0),V(ce,null,ze(x.value,([j,q])=>(R(),V("option",{key:j,value:j},Oe(q),9,xC))),128))],544),[[_t,J(s)]]),d("table",SC,[d("tbody",null,[d("tr",null,[P[29]||(P[29]=d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation:")],-1)),d("td",null,[Pe(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":P[11]||(P[11]=j=>ve(c)?c.value=j:null),onKeydown:P[12]||(P[12]=fe(()=>{},["stop"]))},null,544),[[Ke,J(c)]])])]),m.value?(R(),V(ce,{key:0},[d("tr",null,[d("td",null,[d("label",PC,Oe(J(k)?"Zoom":"Scale X"),1)]),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":P[13]||(P[13]=j=>h.value=j),onKeydown:P[14]||(P[14]=fe(()=>{},["stop"]))},null,544),[[Ke,h.value]])])]),J(k)?he("",!0):(R(),V("tr",OC,[P[30]||(P[30]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":P[15]||(P[15]=j=>v.value=j),onKeydown:P[16]||(P[16]=fe(()=>{},["stop"]))},null,544),[[Ke,v.value]])])]))],64)):he("",!0),d("tr",null,[P[31]||(P[31]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":P[17]||(P[17]=j=>ve(p)?p.value=j:null),onKeydown:P[18]||(P[18]=fe(()=>{},["stop"]))},null,544),[[Ke,J(p)]])])]),d("tr",null,[P[32]||(P[32]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":P[19]||(P[19]=j=>ve(O)?O.value=j:null),onKeydown:P[20]||(P[20]=fe(()=>{},["stop"]))},null,544),[[Ke,J(O)]])])]),d("tr",null,[J(k)?he("",!0):(R(),V("td",TC,[F(Ge,{modelValue:J(y),"onUpdate:modelValue":P[21]||(P[21]=j=>ve(y)?y.value=j:null),label:"Lock scale ratio?"},null,8,["modelValue"])]))])])]),Xt(U.$slots,"transform",{},void 0,!0)]),_:3}),Xt(U.$slots,"options",{},void 0,!0),g.value?(R(),pe(xt,{key:0,title:"Textbox settings"},{default:ne(()=>[o.value.type==="character"||o.value.type==="sprite"?(R(),pe(Ge,{key:0,label:"Enlarge when talking",modelValue:J(f),"onUpdate:modelValue":P[22]||(P[22]=j=>ve(f)?f.value=j:null)},null,8,["modelValue"])):he("",!0),F(Ge,{label:"Own textbox color",modelValue:$.value,"onUpdate:modelValue":P[23]||(P[23]=j=>$.value=j)},null,8,["modelValue"]),d("table",null,[d("tbody",null,[$.value?(R(),V("tr",$C,[P[34]||(P[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:tt({background:o.value.textboxColor??""}),onClick:ee},null,4)])])):he("",!0),d("tr",null,[P[35]||(P[35]=d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),d("td",null,[Pe(d("input",{id:"namebox_width",type:"number",placeholder:M.value+"","onUpdate:modelValue":P[24]||(P[24]=j=>ve(w)?w.value=j:null)},null,8,jC),[[Ke,J(w),void 0,{lazy:!0}]])])])])])]),_:1})):he("",!0),d("button",{onClick:P[25]||(P[25]=j=>r.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:W},"Copy"),F(Yk,{class:"v-bt0",obj:o.value},null,8,["obj"])],64))],512))}}),Co=Be(RC,[["__scopeId","data-v-38aa3d38"]]),IC={class:"warning"},AC={style:{"word-wrap":"break-word"}},MC={class:"button-tbl"},DC={key:0},BC={class:"arrow-col"},EC={class:"arrow-col"},LC={key:1},NC={class:"arrow-col"},HC={class:"arrow-col"},WC={class:"arrow-col"},VC=["onClick"],FC=["onClick"],UC={class:"arrow-col"},qC=["onClick"],zC=Se({__name:"character-tool",emits:["show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=I(null),s=I(null);Mt(o);const r=I(null),i=Et("viewport"),l=D(()=>N.panels.panels[i.value.currentPanel]),a=D(()=>i.value.selection),u=D(()=>{const A=l.value.objects[a.value];if(A.type==="character")return A}),c=Re(u,"close"),f=Qo(u,"seekStyle"),m=Qo(u,"seekPart"),b=Qo(u,"seekPose"),x=D(()=>{const g=u.value.headsData;if(!g)return null;for(const T of g.variants){const $=kn(T[0],!1);if($.startsWith("uploads:"))return $.substring(8)}return null}),k=D(()=>N.content.characters.get(u.value.characterType)),y=D(()=>k.value.label??""),w=D(()=>u.value.availablePartsKeys),h=D(()=>k.value.styleGroups[u.value.styleGroupId].styles.length>1||k.value.styleGroups.length>1),v=D(()=>k.value.styleGroups[u.value.styleGroupId].styles[u.value.styleId].poses.length>1);function p(){s.value.click()}async function O(){const A=s.value;if(!A.files)return;if(A.files.length!==1){console.error("More than one file uploaded!");return}const g=A.files[0];await le(async()=>{const T=URL.createObjectURL(g);N.uploadUrls.add(x.value,T)})}function M(A){return A.charAt(0).toUpperCase()+A.substring(1)}return Xe(()=>a.value,()=>{r.value=null}),(A,g)=>(R(),pe(Co,{ref_key:"root",ref:o,object:u.value,title:y.value,showAltPanel:!!r.value},{"alt-panel":ne(()=>[r.value?(R(),pe(Xk,{key:0,character:u.value,part:r.value,onLeave:g[0]||(g[0]=T=>r.value=null),onShowDialog:g[1]||(g[1]=T=>e("show-dialog",T)),onShowExpressionDialog:g[2]||(g[2]=T=>e("show-expression-dialog",T))},null,8,["character","part"])):he("",!0)]),default:ne(()=>[x.value?(R(),V(ce,{key:0},[d("p",IC,[g[11]||(g[11]=Q(" MISSING Head sprite! Click below to re-upload ")),d("span",AC,'"'+Oe(x.value)+'"',1),g[12]||(g[12]=Q(". "))]),d("button",{onClick:g[3]||(g[3]=T=>p())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:s,onChange:O},null,544)],64)):he("",!0),v.value||w.value.length>0||h.value?(R(),pe(xt,{key:1,class:"pose-list",title:"Pose:"},{default:ne(()=>[d("table",MC,[d("tbody",null,[h.value?(R(),V("tr",DC,[d("td",BC,[d("button",{onClick:g[4]||(g[4]=T=>J(f)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:g[5]||(g[5]=T=>r.value="style")}," Style ")]),d("td",EC,[d("button",{onClick:g[6]||(g[6]=T=>J(f)(1))},">")])])):he("",!0),v.value?(R(),V("tr",LC,[d("td",NC,[d("button",{onClick:g[7]||(g[7]=T=>J(b)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:g[8]||(g[8]=T=>r.value="pose")}," Pose ")]),d("td",HC,[d("button",{onClick:g[9]||(g[9]=T=>J(b)(1))},">")])])):he("",!0),(R(!0),V(ce,null,ze(w.value,T=>(R(),V("tr",{key:T},[d("td",WC,[d("button",{onClick:$=>J(m)(T,-1)}," < ",8,VC)]),d("td",null,[d("button",{class:"middle-button",onClick:$=>r.value=T},Oe(M(T)),9,FC)]),d("td",UC,[d("button",{onClick:$=>J(m)(T,1)},">",8,qC)])]))),128))])])]),_:1})):he("",!0)]),transform:ne(()=>[F(Ge,{modelValue:J(c),"onUpdate:modelValue":g[10]||(g[10]=T=>ve(c)?c.value=T:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}}),XC=Be(zC,[["__scopeId","data-v-8c562c62"]]),YC=["onClick"],GC=Se({__name:"choice-tool",setup(n){const t=I(null),e=Et("viewport");Mt(t);const o=D(()=>N.panels.panels[e.value.currentPanel]),s=D(()=>{const k=o.value.objects[e.value.selection];if(k.type==="choice")return k}),r=I(0),i=I(!1),l=Re(s,"autoWrap"),a=x("text"),u=D(()=>s.value.choices),c=D(()=>{if(i.value)return{title:"Text",get:()=>a.value,set:k=>{a.value=k},leave:()=>{i.value=!1}}});function f(k){r.value=k}function m(){le(async()=>{s.value.addChoice("")})}function b(){le(async()=>{r.value===s.value.choices.length-1&&r.value>0&&f(r.value-1),s.value.removeChoice(r.value)})}function x(k){return D({get(){return s.value.choices[r.value][k]},set(y){le(()=>{s.value.setChoiceProperty(r.value,k,y)})}})}return(k,y)=>(R(),pe(Co,{ref_key:"root",ref:t,object:s.value,title:"Choice",textHandler:c.value},{default:ne(()=>[F(xt,{class:"buttons",title:"Buttons:"},{default:ne(()=>[F(Rt,{maxSize:"100%",direction:"vertical",noWraping:""},{default:ne(()=>[(R(!0),V(ce,null,ze(u.value,(w,h)=>(R(),V("div",{class:Ne({choiceBtn:!0,active:h===r.value}),key:h,onClick:v=>f(h)},Oe(w.text.trim()===""?"[Empty]":w.text),11,YC))),128))]),_:1})]),_:1}),F(xt,{class:"current_button",title:"Current button:"},{default:ne(()=>[d("table",null,[d("tbody",null,[y[4]||(y[4]=d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),d("tr",null,[d("td",null,[Pe(d("input",{id:"choice-button-input","onUpdate:modelValue":y[0]||(y[0]=w=>ve(a)?a.value=w:null),onKeydown:y[1]||(y[1]=fe(()=>{},["stop"]))},null,544),[[Ke,J(a)]])]),d("td",null,[d("button",{onClick:y[2]||(y[2]=w=>i.value=!0)},"...")])])])])]),_:1}),d("button",{onClick:m},"Add"),d("button",{onClick:b},"Remove"),F(Ge,{label:"Auto line wrap?",modelValue:J(l),"onUpdate:modelValue":y[3]||(y[3]=w=>ve(l)?l.value=w:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),KC=Be(GC,[["__scopeId","data-v-f58a4f6c"]]),JC={id:"notification_text_wrapper"},ZC=Se({__name:"notification-tool",setup(n){const t=I(null);Mt(t);const e=Et("viewport"),o=D(()=>N.panels.panels[e.value.currentPanel]),s=D(()=>{const u=o.value.objects[e.value.selection];if(u.type==="notification")return u}),r=Re(s,"text"),i=Re(s,"backdrop"),l=I(!1),a=D(()=>{if(l.value)return{title:"Text",get:()=>r.value,set:u=>{r.value=u},leave:()=>{l.value=!1}}});return(u,c)=>(R(),pe(Co,{ref_key:"root",ref:t,object:s.value,title:"Notification",textHandler:a.value},{default:ne(()=>[d("div",JC,[c[4]||(c[4]=d("label",{for:"notification_text"},"Text:",-1)),Pe(d("textarea",{"onUpdate:modelValue":c[0]||(c[0]=f=>ve(r)?r.value=f:null),id:"notification_text",onKeydown:c[1]||(c[1]=fe(()=>{},["stop"]))},null,544),[[Ke,J(r)]]),d("button",{onClick:c[2]||(c[2]=f=>l.value=!0)},"Formatting")])]),options:ne(()=>[F(Ge,{modelValue:J(i),"onUpdate:modelValue":c[3]||(c[3]=f=>ve(i)?i.value=f:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),QC=Be(ZC,[["__scopeId","data-v-c6c0f92a"]]),e_=["onClick","onKeydown"],t_={class:"panel_text"},n_={class:"panel_nr"},o_={class:"column"},s_={class:"v-w100"},r_={colspan:"2"},i_={key:0,value:"image/webp"},l_={key:1,value:"image/heif"},a_={key:0},u_={for:"export_ppi"},c_={key:0},d_={for:"export_pages"},f_={key:0},p_={colspan:"2"},h_={class:"column"},v_=100,g_=90,kd=70,Cd=1/4,m_=.5,b_=Se({__name:"panels-tool",setup(n){const t=I(null),{vertical:e,getRoot:o}=Mt(t),s=I(ge.supports.limitedCanvasSpace?10:0),r=I(""),i=I("image/png"),l=I(g_),a=I(!1),u=I(!1),c=I(null),f=de().Base,m=D(()=>N.panels.panels[se.value.currentPanel]),b=D(()=>i.value!=="image/png"),x=D(()=>p.value.length>1);function k(Z){return Z===""}const y=I(!1),w=I(!1);Promise.allSettled([fo(),Aw()]).then(([Z,H])=>{Z.status==="fulfilled"&&(y.value=Z.value),H.status==="fulfilled"&&(w.value=H.value)});const h=D(()=>N.panels.order.indexOf(m.value.id)>0),v=D(()=>{const Z=N.panels.order;return Z.indexOf(m.value.id)<Z.length-1}),p=D(()=>N.panels.order.map(H=>{const ue=N.panels.panels[H],C=[...ue.lowerOrder,...ue.topOrder].map(S=>ue.objects[S]).map(O);return{id:ue.id,image:ue.lastRender,text:C.reduce((S,B)=>S.length>B.length?S:B,"")}}));function O(Z){switch(Z.type){case"textBox":return Z.text;case"notification":return Z.text;case"poem":return Z.text;case"choice":return Z.choices.map(H=>`[${H.text}]`).join(`
`)}return""}function M(){const Z=o().querySelector(".panel_button.active");Z!=null&&A(Z)}function A(Z){const H=Z.parentElement.parentElement;e.value?(H.scrollTop=Z.offsetTop-H.clientHeight/2,H.scrollLeft=0):(H.scrollLeft=Z.offsetLeft-H.clientWidth/2,H.scrollTop=0)}Ht(()=>{M()});function g(){const Z=new Date;return`cd-${[Z.getFullYear(),`${Z.getMonth()+1}`.padStart(2,"0"),`${Z.getDate()}`.padStart(2,"0"),`${Z.getHours()}`.padStart(2,"0"),`${Z.getMinutes()}`.padStart(2,"0"),`${Z.getSeconds()}`.padStart(2,"0")].join("-")}`}async function T(){await vo("export image",async()=>{const Z=L(),H=i.value.split("/")[1],ue=i.value,C=l.value,S=a.value,B=g();await $(Z,!0,S,async(X,z)=>{await ge.saveToFile(z,`${B}_${X}.${H}`,ue,C/v_)})})}async function $(Z,H,ue,C){const S=de().Base,B=[],X=ue?S.screenWidth:0,z=ue?0:S.screenHeight;for(let G=0;G<Z.length;++G){const re=Z[G],te=document.createElement("canvas");te.width=ue?S.screenWidth*re.length:S.screenWidth,te.height=ue?S.screenHeight:S.screenHeight*re.length;try{const ie=te.getContext("2d");for(let K=0;K<re.length;++K){const ye=re[K],ae=new cs(ye,S.screenWidth,S.screenHeight);try{await ae.render(H,!1,!0),ae.paintOnto(ie,{x:X*K,y:z*K,w:S.screenWidth,h:S.screenHeight})}finally{ae.dispose()}}B.push(await C(G,te))}finally{uo(te)}}return B}function W(){const Z=N.panels.order.length-1,H=0,ue=r.value.split(","),C=[];let S=!1;for(const B of ue){const X=B.trim(),z=X.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!z){X!==""&&Me.fire(new $t(`Could not read '${B}' in the page list.`));continue}if(S=!0,z[2])C.push(parseInt(z[2],10)-1);else{const G=Math.max(parseInt(z[3],10)-1,H),re=Math.min(parseInt(z[4],10)-1,Z);if(G==null||re==null||G>re)continue;for(let te=G;te<=re;++te)C.push(te)}}return S?C.sort((B,X)=>B-X).filter((B,X,z)=>z[X-1]!==B).map(B=>N.panels.panels[B].id):N.panels.order}function L(){const Z=W();if(isNaN(s.value)&&(s.value=0),s.value===0)return[Z];const H=[];for(let ue=0;ue<Z.length/s.value;++ue){const C=ue*s.value,S=C+s.value;H.push(Z.slice(C,S))}return H}async function E(){le(async()=>{N.panels.duplicatePanel(N.panels.panels[se.value.currentPanel]),se.value.currentPanel=N.panels.lastPanelId}),await yn(),M()}function ee(Z){le(()=>{se.value.currentPanel=Z}),yn(()=>{M()})}function U(){le(async()=>{N.panels.deletePanel(N.panels.panels[se.value.currentPanel])}),yn(()=>{M()})}function P(){le(()=>{N.panels.movePanel(N.panels.panels[se.value.currentPanel],-1)})}function j(){le(()=>{N.panels.movePanel(N.panels.panels[se.value.currentPanel],1)})}const q=Ln();q.width=f.screenWidth*Cd,q.height=f.screenHeight*Cd;const je=q.getContext("2d"),Y=I(!1),se=St(),we=D(()=>N.panels.order.filter(Z=>N.panels.panels[Z].lastRender==null));async function Te(){const Z=ur(se.value);Z&&await Ce(Z)}async function Ce(Z){await vo("render thumbnail",async()=>{const H=Z.panelId;Z.paintOnto(je,{x:0,y:0,w:je.canvas.width,h:je.canvas.height}),je.canvas.toBlob(ue=>{if(!ue)return;const C=N.panels.panels[H];if(!C)return;const S=URL.createObjectURL(ue);C.lastRender=S},await fo()?"image/webp":"image/jpeg",m_)})}async function ot(){const Z=de().Base;if(!Y.value||ge.supports.limitedCanvasSpace)return;const H=we.value;if(H.length===0)return;const ue=H[0],C=new cs(ue,Z.screenWidth,Z.screenHeight);await C.render(!1,!1,!0),await Ce(C),setTimeout(()=>{ot()},500)}Ht(()=>{Y.value=!0,requestAnimationFrame(()=>Te().catch(()=>{}))}),Sn(()=>{Y.value=!1,uo(je.canvas)}),Me.subscribe(er,()=>requestAnimationFrame(Te));async function Ze(){const Z=await N.getSave(!0),H=new Blob([Z],{type:"text/plain"}),ue=new Date,C=`save-${[ue.getFullYear(),`${ue.getMonth()+1}`.padStart(2,"0"),`${ue.getDate()}`.padStart(2,"0"),`${ue.getHours()}`.padStart(2,"0"),`${ue.getMinutes()}`.padStart(2,"0"),`${ue.getSeconds()}`.padStart(2,"0")].join("-")}`;ge.storeSaveFile(H,`${C}.dddg`)}async function oe(){await le(async()=>{const Z=c.value;if(!Z.files)return;Me.fire(new tr);const H=await xe(Z.files[0]);await N.loadSave(H),ge.supports.limitedCanvasSpace&&Me.fire(new $t("To prevent running out of memory, thumbnails will not be automatically restored in the background."))}),await Te(),setTimeout(()=>{ot()},1e3)}function xe(Z){return new Promise((H,ue)=>{const C=new FileReader;C.onload=function(){H(C.result)},C.onerror=function(S){ue(S)},C.readAsText(Z)})}return Xe(()=>l.value,(Z,H)=>{if(Z===100){Me.fire(new $t("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(H>kd&&Z<=kd){Me.fire(new $t("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),Xe(()=>s.value,(Z,H)=>{if(ge.supports.limitedCanvasSpace&&(H<=10&&Z>10||Z===0&&p.value.length>10)){Me.fire(new $t("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(Z,H)=>(R(),V("div",{class:"panel",ref_key:"root",ref:t},[H[28]||(H[28]=d("h1",null,"Panels",-1)),u.value?(R(),pe(Fa,{key:0,type:"panel",title:"","panel-id":m.value.id,"no-composition":"",onLeave:H[0]||(H[0]=ue=>{u.value=!1,Te()})},null,8,["panel-id"])):(R(),V(ce,{key:1},[F(xt,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:ne(()=>[F(Rt,{"no-wraping":"",maxSize:"350px"},{default:ne(()=>[(R(!0),V(ce,null,ze(p.value,(ue,C)=>(R(),V("div",{key:ue.id,class:Ne({panel_button:!0,active:ue.id===m.value.id}),style:tt(`background-image: url('${ue.image}')`),tabindex:"0",onClick:S=>ee(ue.id),onKeydown:[rt(S=>ee(ue.id),["enter"]),rt(fe(S=>ee(ue.id),["prevent"]),["space"])]},[d("div",t_,[d("p",null,Oe(ue.text),1)]),d("div",n_,Oe(C+1),1)],46,e_))),128))]),_:1})]),_:1}),d("div",o_,[F(Ie,{icon:"add_to_queue",onClick:E},{default:ne(()=>H[11]||(H[11]=[Q(" Add new")])),_:1}),F(Ie,{icon:"remove_from_queue",class:"bt0",onClick:U,disabled:!x.value},{default:ne(()=>H[12]||(H[12]=[Q(" Delete panel ")])),_:1},8,["disabled"]),F(Ie,{icon:"arrow_upward",class:"bt0",onClick:P,disabled:!h.value},{default:ne(()=>H[13]||(H[13]=[Q(" Move ahead ")])),_:1},8,["disabled"]),F(Ie,{icon:"arrow_downward",class:"bt0",onClick:j,disabled:!v.value},{default:ne(()=>H[14]||(H[14]=[Q(" Move behind ")])),_:1},8,["disabled"]),F(Ie,{class:"bt0",icon:"color_lens",onClick:H[1]||(H[1]=ue=>u.value=!0)},{default:ne(()=>H[15]||(H[15]=[Q(" Image options ")])),_:1})]),F(xt,{title:"Export",class:"h-h100 export_settings"},{default:ne(()=>[d("table",s_,[d("tbody",null,[d("tr",null,[d("td",r_,[F(Ie,{icon:"photo_camera",class:"w100",onClick:T},{default:ne(()=>H[16]||(H[16]=[Q(" Download ")])),_:1})])]),d("tr",null,[H[20]||(H[20]=d("td",null,[d("label",{for:"export_format"},"Format")],-1)),d("td",null,[Pe(d("select",{id:"export_format","onUpdate:modelValue":H[2]||(H[2]=ue=>i.value=ue)},[H[17]||(H[17]=d("option",{value:"image/png"}," PNG (lossless) ",-1)),y.value?(R(),V("option",i_," WebP (lossy) ")):he("",!0),w.value?(R(),V("option",l_," HEIF (lossy) ")):he("",!0),H[18]||(H[18]=d("option",{value:"image/jpeg"}," JPEG (lossy) ",-1)),H[19]||(H[19]=d("option",{value:"image/jpeg"}," WebM (lossy, video) ",-1))],512),[[_t,i.value]])])]),b.value?(R(),V("tr",a_,[H[21]||(H[21]=d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),d("td",null,[Pe(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":H[3]||(H[3]=ue=>l.value=ue),onKeydown:H[4]||(H[4]=fe(()=>{},["stop"]))},null,544),[[Ke,l.value,void 0,{number:!0}]])])])):he("",!0),d("tr",null,[d("td",null,[d("label",u_,[H[23]||(H[23]=Q(" Panels per image: ")),!b.value||J(e)?(R(),V("small",c_,H[22]||(H[22]=[d("br",null,null,-1),Q("(0 for one single image)")]))):he("",!0)])]),d("td",null,[Pe(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":H[5]||(H[5]=ue=>s.value=ue),onKeydown:H[6]||(H[6]=fe(()=>{},["stop"])),onBlur:H[7]||(H[7]=ue=>{k(s.value)&&(s.value=0)})},null,544),[[Ke,s.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",d_,[H[25]||(H[25]=Q(" Panels to export: ")),!b.value||J(e)?(R(),V("small",f_,H[24]||(H[24]=[d("br",null,null,-1),Q("(Leave empty for all)")]))):he("",!0)])]),d("td",null,[Pe(d("input",{id:"export_pages","onUpdate:modelValue":H[8]||(H[8]=ue=>r.value=ue),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Ke,r.value]])])]),d("tr",null,[d("td",p_,[F(Ge,{modelValue:a.value,"onUpdate:modelValue":H[9]||(H[9]=ue=>a.value=ue),label:"Horizontal arrangement?",title:"Order panels side by side instead of top to bottom"},null,8,["modelValue"])])])])])]),_:1}),d("div",h_,[F(Ie,{icon:"save",onClick:Ze},{default:ne(()=>H[26]||(H[26]=[Q("Save")])),_:1}),F(Ie,{class:"bt0",icon:"folder_open",onClick:H[10]||(H[10]=ue=>c.value.click())},{default:ne(()=>[H[27]||(H[27]=Q(" Load ")),d("input",{type:"file",ref_key:"loadUpload",ref:c,onChange:oe},null,544)]),_:1})])],64))],512))}}),y_=Be(b_,[["__scopeId","data-v-e36e19ab"]]),w_={id:"poem_text",class:"v-w100"},k_=["value"],C_=["value"],__={key:1},x_={class:"v-w100"},S_=Se({__name:"poem-tool",setup(n){const t=I(null),e=I(null),{vertical:o}=Mt(t),s=I(!1),r=I("");Xe(()=>o.value,()=>{e.value.style.height="",e.value.style.width=""});const i=Et("viewport"),l=D(()=>N.panels.panels[i.value.currentPanel]),a=D(()=>{const y=l.value.objects[i.value.selection];if(y.type==="poem")return y}),u=D(()=>{if(s.value)return{title:"Text",get:()=>f.value,set:y=>{f.value=y},leave:()=>{s.value=!1}}}),c=D(()=>{if(r.value)return{title:"Color",get:()=>{switch(r.value){case"":return"#000000";case"base":const y=de().Poem;return a.value.consoleColor??y.consoleBackgroundColor;default:throw new Kt.UnreachableCaseError(r.value)}},set:y=>{le(()=>{y!==void 0&&(a.value.consoleColor=y)})},leave:()=>{r.value=""}}}),f=Re(a,"text"),m=Re(a,"autoWrap"),b=Re(a,"font"),x=Re(a,"overflow"),k=Re(a,"background");return(y,w)=>(R(),pe(Co,{ref_key:"root",ref:t,object:a.value,title:a.value.subtype==="poem"?"Poem":"Console",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("div",w_,[w[10]||(w[10]=d("label",{for:"poem_text"},"Text:",-1)),Pe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":w[0]||(w[0]=h=>ve(f)?f.value=h:null),onKeydown:w[1]||(w[1]=fe(()=>{},["stop"]))},null,544),[[Ke,J(f)]]),d("button",{class:"w100 bt0",onClick:w[2]||(w[2]=h=>s.value=!0)}," Formatting ")]),F(Ge,{label:"Auto line wrap?",modelValue:J(m),"onUpdate:modelValue":w[3]||(w[3]=h=>ve(m)?m.value=h:null)},null,8,["modelValue"]),F(Ge,{label:"Allow overflow?",modelValue:J(x),"onUpdate:modelValue":w[4]||(w[4]=h=>ve(x)?x.value=h:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),a.value.subtype==="poem"?(R(),V(ce,{key:0},[Pe(d("select",{"onUpdate:modelValue":w[5]||(w[5]=h=>ve(k)?k.value=h:null),onKeydown:w[6]||(w[6]=fe(()=>{},["stop"]))},[(R(!0),V(ce,null,ze(J(sp),(h,v)=>(R(),V("option",{value:v,key:v},Oe(h.name),9,k_))),128))],544),[[_t,J(k)]]),Pe(d("select",{"onUpdate:modelValue":w[7]||(w[7]=h=>ve(b)?b.value=h:null),onKeydown:w[8]||(w[8]=fe(()=>{},["stop"]))},[(R(!0),V(ce,null,ze(J(rp),(h,v)=>(R(),V("option",{value:v,key:v},Oe(h.name),9,C_))),128))],544),[[_t,J(b)]])],64)):(R(),V("table",__,[d("tbody",null,[d("tr",null,[w[11]||(w[11]=d("td",{style:{width:"0"}},"Color:",-1)),d("td",x_,[d("button",{id:"console_color",class:"w100",style:tt([{background:a.value.consoleColor},{"min-width":"64px"}]),onClick:w[9]||(w[9]=h=>r.value="base")},null,4)])])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}}),P_=Be(S_,[["__scopeId","data-v-459fc793"]]),O_={class:"warning"},T_={style:{"word-wrap":"break-word"}},$_=Se({__name:"sprite-tool",setup(n){const t=I(null),e=I(null);Mt(t);const o=Et("viewport"),s=D(()=>{for(const u of i.value.assets){const c=kn(u,!1);if(console.log(c),c.startsWith("uploads:"))return c.substring(8)}return null}),r=D(()=>N.panels.panels[o.value.currentPanel]),i=D(()=>{const u=r.value.objects[o.value.selection];if(u.type==="sprite")return u});function l(){e.value.click()}async function a(){const u=e.value;if(!u.files)return;if(u.files.length!==1){console.error("More than one file uploaded!");return}const c=u.files[0];le(()=>{const f=URL.createObjectURL(c);N.uploadUrls.add(s.value,f)})}return(u,c)=>(R(),pe(Co,{ref_key:"root",ref:t,object:i.value,title:"Custom Sprite"},{default:ne(()=>[s.value?(R(),V(ce,{key:0},[d("p",O_,[c[1]||(c[1]=Q(" MISSING SPRITE! Click below to re-upload ")),d("span",T_,'"'+Oe(s.value)+'"',1),c[2]||(c[2]=Q(". "))]),d("button",{onClick:c[0]||(c[0]=f=>l())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:e,onChange:a},null,544)],64)):he("",!0)]),_:1},8,["object"]))}}),j_=Be($_,[["__scopeId","data-v-e15e7e5e"]]),R_={class:"upper-combos"},I_={colspan:"2"},A_=["value"],M_=["disabled"],D_={id:"dialog_text_wrapper",class:"v-w100"},B_={key:0},E_=["placeholder"],L_={colspan:"2"},N_={key:0},H_={key:1},W_={colspan:"2"},V_=Se({__name:"textbox-tool",setup(n){const t=I(null),e=I(null),{vertical:o}=Mt(t),s=I(""),r=I("");Xe(()=>o.value,()=>{const P=e.value;P!=null&&(P.style.height="",P.style.width="")});const i=Et("viewport"),l=D(()=>N.panels.panels[i.value.currentPanel]),a=D(()=>{const P=l.value.objects[i.value.selection];if(P.type==="textBox")return P}),u=D(()=>{if(s.value)return{title:x.value,get(){return s.value==="name"?a.value.talkingOther:s.value==="body"?v.value:""},set(P){s.value==="name"?m.value=P:s.value==="body"&&(v.value=P)},leave(){s.value=""}}}),c=D(()=>{if(r.value)return{title:k.value,get:()=>{switch(r.value){case"":return"#000000";case"base":return a.value.customColor;case"controls":return a.value.customControlsColor;case"namebox":return a.value.customNameboxColor;case"nameboxStroke":return a.value.customNameboxStroke;default:throw new Kt.UnreachableCaseError(r.value)}},set:P=>{le(()=>{const j={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[r.value];P!==void 0&&le(()=>{a.value[j]=P})})},leave:()=>{r.value=""}}}),f=D({get(){return a.value.talkingObjId??"$null$"},set(P){le(()=>{a.value.talkingObjId=P==="$null$"?null:P})}}),m=Re(a,"talkingOther"),b=D(()=>{const P=l.value,j=[];for(const q of[...P.lowerOrder,...P.topOrder]){const je=P.objects[q];je.label!==null&&j.push([q,je.label])}return j}),x=D(()=>s.value==="name"?"Name":s.value==="body"?"Dialog":""),k=D(()=>{switch(r.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Kt.UnreachableCaseError(r.value)}}),y=Re(a,"autoQuoting"),w=Re(a,"autoWrap"),h=Re(a,"overflow"),v=Re(a,"text"),p=D(()=>O.value.startsWith("custom")),O=Re(a,"style"),M=Re(a,"controls"),A=Re(a,"skip"),g=Re(a,"continue"),T=Re(a,"overrideColor"),$=Re(a,"deriveCustomColors"),W=Re(a,"customNameboxWidth"),L=D(()=>de().TextBox.NameboxWidth),E=Qo(a,"splitTextbox"),ee=Qo(a,"applyResetBounds");function U(){le(()=>{const P=f.value;i.value.selection=P==="$other$"||P==="$null$"?null:P})}return(P,j)=>(R(),pe(Co,{ref_key:"root",ref:t,object:a.value,title:"Textbox",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("table",R_,[d("tbody",null,[d("tr",null,[j[27]||(j[27]=d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),d("td",I_,[Pe(d("select",{id:"text_style","onUpdate:modelValue":j[0]||(j[0]=q=>ve(O)?O.value=q:null),onKeydown:j[1]||(j[1]=fe(()=>{},["stop"]))},j[26]||(j[26]=[d("option",{value:"normal"},"Normal",-1),d("option",{value:"corrupt"},"Corrupt",-1),d("option",{value:"custom"},"Custom",-1),d("option",{value:"custom_plus"}," Custom (Plus) ",-1),d("option",{value:"none"},"None",-1)]),544),[[_t,J(O)]])])]),d("tr",null,[j[30]||(j[30]=d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),d("td",null,[Pe(d("select",{id:"current_talking","onUpdate:modelValue":j[2]||(j[2]=q=>f.value=q),onKeydown:j[3]||(j[3]=fe(()=>{},["stop"]))},[j[28]||(j[28]=d("option",{value:"$null$"},"No-one",-1)),(R(!0),V(ce,null,ze(b.value,([q,je])=>(R(),V("option",{key:q,value:q},Oe(je),9,A_))),128)),j[29]||(j[29]=d("option",{value:"$other$"},"Other",-1))],544),[[_t,f.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:U,disabled:f.value==="$null$"||f.value==="$other$"}," > ",8,M_)])]),d("tr",null,[j[31]||(j[31]=d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),d("td",null,[Pe(d("input",{id:"custom_name","onUpdate:modelValue":j[4]||(j[4]=q=>ve(m)?m.value=q:null),onKeydown:j[5]||(j[5]=fe(()=>{},["stop"]))},null,544),[[Ke,J(m)]])]),d("td",null,[d("button",{onClick:j[6]||(j[6]=q=>s.value="name")},"...")])])])]),F(Ge,{label:"Auto quoting?",modelValue:J(y),"onUpdate:modelValue":j[7]||(j[7]=q=>ve(y)?y.value=q:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),F(Ge,{label:"Auto line wrap?",modelValue:J(w),"onUpdate:modelValue":j[8]||(j[8]=q=>ve(w)?w.value=q:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),F(Ge,{label:"Allow overflow?",modelValue:J(h),"onUpdate:modelValue":j[9]||(j[9]=q=>ve(h)?h.value=q:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",D_,[j[32]||(j[32]=d("label",{for:"dialog_text"},"Dialog:",-1)),Pe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":j[10]||(j[10]=q=>ve(v)?v.value=q:null),id:"dialog_text",onKeydown:j[11]||(j[11]=fe(()=>{},["stop"]))},null,544),[[Ke,J(v)]]),d("button",{class:"w100 bt0",onClick:j[12]||(j[12]=q=>s.value="body")}," Formatting ")])]),options:ne(()=>[F(xt,{title:"Customization:",class:Ne(p.value?"customization-set":"")},{default:ne(()=>[F(Rt,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:ne(()=>[F(Ge,{label:"Controls visible?",modelValue:J(M),"onUpdate:modelValue":j[13]||(j[13]=q=>ve(M)?M.value=q:null)},null,8,["modelValue"]),F(Ge,{label:"Able to skip?",modelValue:J(A),"onUpdate:modelValue":j[14]||(j[14]=q=>ve(A)?A.value=q:null)},null,8,["modelValue"]),F(Ge,{label:"Continue arrow?",modelValue:J(g),"onUpdate:modelValue":j[15]||(j[15]=q=>ve(g)?g.value=q:null)},null,8,["modelValue"]),p.value?(R(),V("table",B_,[d("tbody",null,[d("tr",null,[j[33]||(j[33]=d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),d("td",null,[Pe(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:L.value+"","onUpdate:modelValue":j[16]||(j[16]=q=>ve(W)?W.value=q:null),onKeydown:j[17]||(j[17]=fe(()=>{},["stop"]))},null,40,E_),[[Ke,J(W),void 0,{number:!0}]])])]),d("tr",null,[d("td",L_,[F(Ge,{modelValue:J(T),"onUpdate:modelValue":j[18]||(j[18]=q=>ve(T)?T.value=q:null),label:"Override color"},null,8,["modelValue"])])]),J(T)?(R(),V("tr",N_,[j[34]||(j[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:tt({background:a.value.customColor}),onClick:j[19]||(j[19]=q=>r.value="base")},null,4)])])):he("",!0),J(T)?(R(),V("tr",H_,[d("td",W_,[F(Ge,{id:"derive_custom_colors",modelValue:J($),"onUpdate:modelValue":j[20]||(j[20]=q=>ve($)?$.value=q:null),label:"Derive other colors"},null,8,["modelValue"])])])):he("",!0),J(T)&&!J($)?(R(),V(ce,{key:2},[d("tr",null,[j[35]||(j[35]=d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:tt({background:a.value.customControlsColor}),onClick:j[21]||(j[21]=q=>r.value="controls")},null,4)])]),d("tr",null,[j[36]||(j[36]=d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:tt({background:a.value.customNameboxColor}),onClick:j[22]||(j[22]=q=>r.value="namebox")},null,4)])]),d("tr",null,[j[37]||(j[37]=d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:tt({background:a.value.customNameboxStroke}),onClick:j[23]||(j[23]=q=>r.value="nameboxStroke")},null,4)])])],64)):he("",!0)])])):he("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:j[24]||(j[24]=(...q)=>J(ee)&&J(ee)(...q))},"Reset position"),d("button",{class:"bt0",onClick:j[25]||(j[25]=(...q)=>J(E)&&J(E)(...q))},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}}),F_=Be(V_,[["__scopeId","data-v-3720aae2"]]),U_={id:"toolbar"},q_={id:"toolbar-end"},z_=Se({__name:"tool-box",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=I(null),s=I("add"),r=D(()=>N.panels.panels[i.value.currentPanel]),i=St(),l=Pn(),a=Nf(),u=D(()=>{if(s.value==="selection")if(a.value===null)s.value="add";else return r.value.objects[a.value].type;return s.value}),c=D(()=>N.ui.lastDownload!==null);function f(b){b===s.value&&(b="add"),s.value=b,a.value!==null&&(i.value.selection=null)}function m(){Kw(o.value)&&(o.value.scrollTop=0,o.value.scrollLeft=0)}return Xe(()=>a.value,b=>{if(console.log("selection changed",b),b!=null){s.value="selection";return}s.value==="selection"&&(s.value="add")}),ge.onPanelChange(b=>{s.value=b}),(b,x)=>(R(),V("div",{id:"panels",class:Ne({vertical:J(l)}),onScroll:m,ref_key:"panels",ref:o},[d("div",U_,[F(Ie,{icon:"add_box","icon-pos":"top",class:Ne({active:u.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:x[0]||(x[0]=k=>f("add"))},null,8,["class"]),F(Ie,{icon:"panorama","icon-pos":"top",class:Ne({active:u.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:x[1]||(x[1]=k=>f("backgrounds"))},null,8,["class"]),F(Ie,{icon:"view_module","icon-pos":"top",class:Ne({active:u.value==="panels"}),title:"Panels",shortcut:"d",onClick:x[2]||(x[2]=k=>f("panels"))},null,8,["class"]),F(Ie,{icon:"settings_applications","icon-pos":"top",class:Ne({active:u.value==="settings"}),title:"Settings",shortcut:"f",onClick:x[3]||(x[3]=k=>f("settings"))},null,8,["class"])]),u.value==="settings"?(R(),pe(z1,{key:0})):u.value==="backgrounds"?(R(),pe(Fk,{key:1,onShowDialog:x[4]||(x[4]=k=>e("show-dialog",k))})):u.value==="help_credits"?(R(),pe(I1,{key:2})):u.value==="character"?(R(),pe(XC,{key:3,onShowDialog:x[5]||(x[5]=k=>e("show-dialog",k)),onShowExpressionDialog:x[6]||(x[6]=k=>e("show-expression-dialog",k))})):u.value==="sprite"?(R(),pe(j_,{key:4})):u.value==="textBox"?(R(),pe(F_,{key:5})):u.value==="choice"?(R(),pe(KC,{key:6})):u.value==="panels"?(R(),pe(y_,{key:7})):u.value==="notification"?(R(),pe(QC,{key:8})):u.value==="poem"?(R(),pe(P_,{key:9})):(R(),pe($1,{key:10,onShowDialog:x[7]||(x[7]=k=>e("show-dialog",k))})),d("div",q_,[F(Ie,{icon:"help","icon-pos":"top",class:Ne({active:u.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:x[8]||(x[8]=k=>f("help_credits"))},null,8,["class"]),F(Ie,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:x[9]||(x[9]=k=>e("show-dialog"))}),F(Ie,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:x[10]||(x[10]=k=>e("show-prev-render")),disabled:!c.value},null,8,["disabled"]),F(Ie,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:x[11]||(x[11]=k=>e("download"))})])],34))}}),X_={class:"hidden-selectors"},Y_=["data-obj-id","onKeydown"],G_=20,K_=50,eh=Se({__name:"app",setup(n){const t=tv("app"),e=tu(()=>Il(()=>import("./single-box-CNnlws6h.js"),__vite__mapDeps([0,1]),import.meta.url)),o=tu(()=>Il(()=>import("./expression-builder-ChUyMMB2.js"),__vite__mapDeps([2,3]),import.meta.url)),s=I(!0),r=I(null);function i(){const Y=N.ui.lastDownload;Y!=null&&r.value.blendOver(Y)}const l=I(N.viewports.setUpViewport(document));ff("viewport",l),Xe(()=>{var Y;return(Y=t.value)==null?void 0:Y.ownerDocument},(Y,se)=>{Y!=null&&(Y!==document&&(l.value=N.viewports.setUpViewport(Y)),se!=null&&x(se),b(Y))},{immediate:!0});const a=Symbol("capturing"),u=new Map;function c(Y,se,we=!1){if(we){const ot=se;se=Ze=>ot(Ze),se[a]=!0}const Te=u.get(Y);Te==null?u.set(Y,[se]):Te.push(se);const Ce=t.value;Ce!=null&&Ce.ownerDocument.addEventListener(Y,se,we)}const f=new Map;function m(Y,se,we=!1){if(we){const ot=se;se=Ze=>ot(Ze),se[a]=!0}const Te=f.get(Y);Te==null?f.set(Y,[se]):Te.push(se);const Ce=t.value;Ce!=null&&Ce.ownerDocument.defaultView.addEventListener(Y,se)}function b(Y){var se;for(const[we,Te]of u)for(const Ce of Te)Y.addEventListener(we,Ce);for(const[we,Te]of f)for(const Ce of Te)(se=Y.defaultView)==null||se.addEventListener(we,Ce)}function x(Y){var se;for(const[we,Te]of u)for(const Ce of Te)Y.removeEventListener(we,Ce);for(const[we,Te]of f)for(const Ce of Te)(se=Y.defaultView)==null||se.removeEventListener(we,Ce)}Sn(()=>{const Y=l.value.doc;x(Y)});const k=D(()=>{const se=N.panels.panels[l.value.currentPanel];return se==null?[]:[...se.lowerOrder,...se.topOrder]});function y(Y){Y.preventDefault()}c("drop",y,!0),c("dragover",y,!0);const w=I(!1),h=D(()=>N.ui.useDarkTheme);if(Xe(()=>h.value??w.value,Y=>{l.value.doc.body.classList.toggle("dark-theme",Y)},{immediate:!0}),window.matchMedia!=null){const Y=window.matchMedia("(prefers-color-scheme: dark)");w.value=Y.matches;const se=we=>w.value=we.matches;Y.addEventListener?Y.addEventListener("change",se):Y.addListener(se)}const v=I(!1),p=I(""),O=I(void 0);function M(Y){v.value=!0,p.value=Y.character,O.value=Y.headGroup}const A=I(null),g=I(!1);function T(Y){if(g.value=!0,Y==null)return;const se=()=>{A.value?A.value.setSearch(Y):setTimeout(se,K_)};yn(se)}const $=D(()=>N.ui.nsfw);Xe(()=>$.value,async Y=>{Y?N.content.loadContentPacks(em):N.content.removeContentPacks(Qg)});let W=null;function L(){W==null&&(W=requestAnimationFrame(()=>{W=null,Me.fire(new Qs)}))}function E(Y){if(Yw(Y.target)||Gw(Y.target)){console.log("skip keydown on potential target");return}le(async()=>{const se=(Y.ctrlKey||Y.metaKey)&&!Y.altKey&&!Y.shiftKey,we=!Y.ctrlKey&&!Y.altKey&&!Y.metaKey&&!Y.shiftKey;if(se&&Y.key==="v"){await N.ui.pasteObjects(N.panels.panels[l.value.currentPanel]),Y.preventDefault();return}if(we&&Y.key==="Escape"){if(l.value.selection===null)return;l.value.selection=null;return}const Te=N.panels.panels[l.value.currentPanel],Ce=Te.objects[l.value.selection];if(Ce!=null){if(se){if(Y.key==="c"||Y.key==="x"){N.ui.copyObjectToClipboard(Te.id,[Ce.id]),Y.key==="x"&&Te.removeObject(Ce),Y.preventDefault();return}}else if(we){if(Y.key==="Delete"){N.panels.panels[l.value.currentPanel].removeObject(Ce);return}if(Y.key==="/"||Y.key==="*"){let Ze=Y.key==="/"?-10:10;Y.shiftKey&&(Ze/=Math.abs(Ze)),Ce.rotation+=Ze,Y.stopPropagation(),Y.preventDefault();return}if(Ce.type==="character"&&!Ce.freeMove){if(Y.key==="ArrowLeft"){Ce.shiftCharacterSlot(-1);return}if(Y.key==="ArrowRight"){Ce.shiftCharacterSlot(1);return}}const ot=Y.shiftKey?1:G_;switch(Y.key){case"ArrowLeft":Ce.x-=ot;break;case"ArrowRight":Ce.x+=ot;break;case"ArrowUp":Ce.y-=ot;break;case"ArrowDown":Ce.y+=ot;break;default:return}}}})}m("keydown",E);let ee=null,U=!1;function P(Y){Y.ctrlKey?!U&&ee===null&&(ee=setTimeout(j)):q()}function j(){document.body.classList.add("ctrl-key"),U=!0}function q(){ee!==null&&(clearTimeout(ee),ee=null),document.body.classList.remove("ctrl-key"),U=!1}m("keydown",P,!0),m("keyup",P,!0),m("mousemove",P,!0),m("blur",q);function je(Y){le(()=>{l.value.selection!==Y&&(l.value.selection=Y)})}return Xe(()=>l.value.selection,Y=>{var se,we;((se=document.activeElement)==null?void 0:se.getAttribute("data-obj-id"))!==""+Y&&((we=document.querySelector(`*[data-obj-id='${Y}']`))==null||we.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),window.store=N,window.env=ge,Ht(async()=>{await ge.loadGameMode(),s.value=!1;const Y=await ge.loadSettings();N.panels.lastPanelId===-1&&await le(async()=>{if(ge.state.looseTextParsing=Y.looseTextParsing||!0,N.ui.lqRendering=Y.lq??!1,N.ui.useDarkTheme=Y.darkMode??null,N.ui.defaultCharacterTalkingZoom=Y.defaultCharacterTalkingZoom??!0,await N.content.loadContentPacks([`${pt}buildin.base.backgrounds.json`,`${pt}buildin.base.monika.json`,`${pt}buildin.base.sayori.json`,`${pt}buildin.base.natsuki.json`,`${pt}buildin.base.yuri.json`,`${pt}buildin.extra.mc.json`,`${pt}buildin.extra.concept_mc_v2.json`,`${pt}buildin.extra.mc_chad.json`,`${pt}buildin.extra.femc.json`,`${pt}buildin.extra.concept_femc.json`,`${pt}buildin.extra.amy.json`]),!await ge.loadDefaultTemplate()){ge.loadContentPacks();const se=N.panels.createPanel();l.value.currentPanel=se.id,Object.keys(se.objects).length===0&&bn.create(se,`Hi! Click here to edit this textbox! ${l.value.isVertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`),se.background.current="dddg.buildin.backgrounds:ddlc.clubroom",N.ui.nsfw=Y.nsfw??!1}})}),(Y,se)=>(R(),V(ce,null,[d("div",{id:"app",ref_key:"app",ref:t},[d("div",X_,[(R(!0),V(ce,null,ze(k.value,we=>(R(),V("div",{key:we,tabindex:"0","data-obj-id":we,onFocus:se[0]||(se[0]=Te=>L()),onBlur:se[1]||(se[1]=Te=>L()),onKeydown:[rt(fe(Te=>je(we),["prevent"]),["enter"]),rt(fe(Te=>je(we),["prevent"]),["space"])]},null,40,Y_))),128))]),F(u1,{ref_key:"renderer",ref:r,canvasWidth:l.value.canvasWidth,canvasHeight:l.value.canvasHeight,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),F(zg),F(z_,{onShowPrevRender:i,onDownload:se[2]||(se[2]=we=>r.value.download()),onShowDialog:T,onShowExpressionDialog:M}),(R(),pe(sv,null,[g.value?(R(),pe(no,{key:0,ref:"dialog",onLeave:se[4]||(se[4]=we=>g.value=!1)},{default:ne(()=>[F(J(e),{ref_key:"packDialog",ref:A,onLeave:se[3]||(se[3]=we=>g.value=!1)},null,512)]),_:1},512)):he("",!0)],1024)),v.value?(R(),pe(no,{key:0,ref:"dialog",onLeave:se[6]||(se[6]=we=>v.value=!1)},{default:ne(()=>[F(J(o),{character:p.value,initHeadGroup:O.value,onLeave:se[5]||(se[5]=we=>v.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):he("",!0)],512),se[7]||(se[7]=d("div",{id:"modal-messages"},null,-1))],64))}});Bf(eh).mount("#main_wrapper");export{le as $,Ht as A,Sn as B,Pe as C,Ke as D,Uv as E,ce as F,sf as G,vo as H,Me as I,Jt as J,Xt as K,kn as L,po as M,Xp as N,Mp as O,Ko as P,Qp as Q,Nn as R,Zp as S,Z_ as T,_t as U,Lf as V,xt as W,Nw as X,Yp as Y,on as Z,Qe as _,V as a,d as b,D as c,Se as d,ge as e,he as f,Q as g,F as h,ne as i,pe as j,Ge as k,ze as l,n1 as m,tt as n,R as o,Be as p,Xe as q,I as r,N as s,Oe as t,J as u,Ne as v,fe as w,yn as x,Bn as y,hs as z};
