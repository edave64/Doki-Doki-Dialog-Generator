const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./single-box-CH9YQoN4.js","./single-box-CW0iiWtQ.css","./index-DGcPycZX.js","./index-CQ61Lu8u.css"])))=>i.map(i=>d[i]);
var za=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Vi(t,e){const n=new Set(t.split(","));return o=>n.has(o)}const Ge={},Po=[],Et=()=>{},Kv=()=>!1,Xr=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Hi=t=>t.startsWith("onUpdate:"),ot=Object.assign,Ui=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Jv=Object.prototype.hasOwnProperty,Ie=(t,e)=>Jv.call(t,e),he=Array.isArray,Co=t=>Uo(t)==="[object Map]",Ho=t=>Uo(t)==="[object Set]",Ga=t=>Uo(t)==="[object Date]",Zv=t=>Uo(t)==="[object RegExp]",Pe=t=>typeof t=="function",et=t=>typeof t=="string",tn=t=>typeof t=="symbol",He=t=>t!==null&&typeof t=="object",Td=t=>(He(t)||Pe(t))&&Pe(t.then)&&Pe(t.catch),Ad=Object.prototype.toString,Uo=t=>Ad.call(t),Qv=t=>Uo(t).slice(8,-1),Ed=t=>Uo(t)==="[object Object]",Wi=t=>et(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ds=Vi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Yr=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},eg=/-(\w)/g,$o=Yr(t=>t.replace(eg,(e,n)=>n?n.toUpperCase():"")),tg=/\B([A-Z])/g,lo=Yr(t=>t.replace(tg,"-$1").toLowerCase()),Rd=Yr(t=>t.charAt(0).toUpperCase()+t.slice(1)),kl=Yr(t=>t?`on${Rd(t)}`:""),Nn=(t,e)=>!Object.is(t,e),xo=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},Bd=(t,e,n,o=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:o,value:n})},Cr=t=>{const e=parseFloat(t);return isNaN(e)?t:e},ng=t=>{const e=et(t)?Number(t):NaN;return isNaN(e)?t:e};let Xa;const Md=()=>Xa||(Xa=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Qe(t){if(he(t)){const e={};for(let n=0;n<t.length;n++){const o=t[n],s=et(o)?lg(o):Qe(o);if(s)for(const r in s)e[r]=s[r]}return e}else if(et(t)||He(t))return t}const og=/;(?![^(]*\))/g,sg=/:([^]+)/,rg=/\/\*[^]*?\*\//g;function lg(t){const e={};return t.replace(rg,"").split(og).forEach(n=>{if(n){const o=n.split(sg);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function Le(t){let e="";if(et(t))e=t;else if(he(t))for(let n=0;n<t.length;n++){const o=Le(t[n]);o&&(e+=o+" ")}else if(He(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const ig="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ag=Vi(ig);function Dd(t){return!!t||t===""}function ug(t,e){if(t.length!==e.length)return!1;let n=!0;for(let o=0;n&&o<t.length;o++)n=Bs(t[o],e[o]);return n}function Bs(t,e){if(t===e)return!0;let n=Ga(t),o=Ga(e);if(n||o)return n&&o?t.getTime()===e.getTime():!1;if(n=tn(t),o=tn(e),n||o)return t===e;if(n=he(t),o=he(e),n||o)return n&&o?ug(t,e):!1;if(n=He(t),o=He(e),n||o){if(!n||!o)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const l in t){const a=t.hasOwnProperty(l),i=e.hasOwnProperty(l);if(a&&!i||!a&&i||!Bs(t[l],e[l]))return!1}}return String(t)===String(e)}function zi(t,e){return t.findIndex(n=>Bs(n,e))}const Ld=t=>!!(t&&t.__v_isRef===!0),$e=t=>et(t)?t:t==null?"":he(t)||He(t)&&(t.toString===Ad||!Pe(t.toString))?Ld(t)?$e(t.value):JSON.stringify(t,Nd,2):String(t),Nd=(t,e)=>Ld(e)?Nd(t,e.value):Co(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[o,s],r)=>(n[Ol(o,r)+" =>"]=s,n),{})}:Ho(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Ol(n))}:tn(e)?Ol(e):He(e)&&!he(e)&&!Ed(e)?String(e):e,Ol=(t,e="")=>{var n;return tn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ut;class Fd{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ut,!e&&Ut&&(this.index=(Ut.scopes||(Ut.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Ut;try{return Ut=this,e()}finally{Ut=n}}}on(){Ut=this}off(){Ut=this.parent}stop(e){if(this._active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function cg(t){return new Fd(t)}function dg(t,e=Ut){e&&e.active&&e.effects.push(t)}function fg(){return Ut}let eo;class Gi{constructor(e,n,o,s){this.fn=e,this.trigger=n,this.scheduler=o,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,dg(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Wn();for(let e=0;e<this._depsLength;e++){const n=this.deps[e];if(n.computed&&(pg(n.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),zn()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=En,n=eo;try{return En=!0,eo=this,this._runnings++,Ya(this),this.fn()}finally{qa(this),this._runnings--,eo=n,En=e}}stop(){this.active&&(Ya(this),qa(this),this.onStop&&this.onStop(),this.active=!1)}}function pg(t){return t.value}function Ya(t){t._trackId++,t._depsLength=0}function qa(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)Vd(t.deps[e],t);t.deps.length=t._depsLength}}function Vd(t,e){const n=t.get(e);n!==void 0&&e._trackId!==n&&(t.delete(e),t.size===0&&t.cleanup())}let En=!0,Ql=0;const Hd=[];function Wn(){Hd.push(En),En=!1}function zn(){const t=Hd.pop();En=t===void 0?!0:t}function Xi(){Ql++}function Yi(){for(Ql--;!Ql&&ei.length;)ei.shift()()}function Ud(t,e,n){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const o=t.deps[t._depsLength];o!==e?(o&&Vd(o,t),t.deps[t._depsLength++]=e):t._depsLength++}}const ei=[];function Wd(t,e,n){Xi();for(const o of t.keys()){let s;o._dirtyLevel<e&&(s!=null?s:s=t.get(o)===o._trackId)&&(o._shouldSchedule||(o._shouldSchedule=o._dirtyLevel===0),o._dirtyLevel=e),o._shouldSchedule&&(s!=null?s:s=t.get(o)===o._trackId)&&(o.trigger(),(!o._runnings||o.allowRecurse)&&o._dirtyLevel!==2&&(o._shouldSchedule=!1,o.scheduler&&ei.push(o.scheduler)))}Yi()}const zd=(t,e)=>{const n=new Map;return n.cleanup=t,n.computed=e,n},ti=new WeakMap,to=Symbol(""),ni=Symbol("");function yt(t,e,n){if(En&&eo){let o=ti.get(t);o||ti.set(t,o=new Map);let s=o.get(n);s||o.set(n,s=zd(()=>o.delete(n))),Ud(eo,s)}}function un(t,e,n,o,s,r){const l=ti.get(t);if(!l)return;let a=[];if(e==="clear")a=[...l.values()];else if(n==="length"&&he(t)){const i=Number(o);l.forEach((u,c)=>{(c==="length"||!tn(c)&&c>=i)&&a.push(u)})}else switch(n!==void 0&&a.push(l.get(n)),e){case"add":he(t)?Wi(n)&&a.push(l.get("length")):(a.push(l.get(to)),Co(t)&&a.push(l.get(ni)));break;case"delete":he(t)||(a.push(l.get(to)),Co(t)&&a.push(l.get(ni)));break;case"set":Co(t)&&a.push(l.get(to));break}Xi();for(const i of a)i&&Wd(i,4);Yi()}const hg=Vi("__proto__,__v_isRef,__isVue"),Gd=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(tn)),Ka=vg();function vg(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const o=Be(this);for(let r=0,l=this.length;r<l;r++)yt(o,"get",r+"");const s=o[e](...n);return s===-1||s===!1?o[e](...n.map(Be)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Wn(),Xi();const o=Be(this)[e].apply(this,n);return Yi(),zn(),o}}),t}function gg(t){tn(t)||(t=String(t));const e=Be(this);return yt(e,"has",t),e.hasOwnProperty(t)}class Xd{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,o){const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return o===(s?r?Ig:Jd:r?Kd:qd).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(o)?e:void 0;const l=he(e);if(!s){if(l&&Ie(Ka,n))return Reflect.get(Ka,n,o);if(n==="hasOwnProperty")return gg}const a=Reflect.get(e,n,o);return(tn(n)?Gd.has(n):hg(n))||(s||yt(e,"get",n),r)?a:_e(a)?l&&Wi(n)?a:a.value:He(a)?s?Zd(a):Fn(a):a}}class Yd extends Xd{constructor(e=!1){super(!1,e)}set(e,n,o,s){let r=e[n];if(!this._isShallow){const i=Ps(r);if(!xr(o)&&!Ps(o)&&(r=Be(r),o=Be(o)),!he(e)&&_e(r)&&!_e(o))return i?!1:(r.value=o,!0)}const l=he(e)&&Wi(n)?Number(n)<e.length:Ie(e,n),a=Reflect.set(e,n,o,s);return e===Be(s)&&(l?Nn(o,r)&&un(e,"set",n,o):un(e,"add",n,o)),a}deleteProperty(e,n){const o=Ie(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&o&&un(e,"delete",n,void 0),s}has(e,n){const o=Reflect.has(e,n);return(!tn(n)||!Gd.has(n))&&yt(e,"has",n),o}ownKeys(e){return yt(e,"iterate",he(e)?"length":to),Reflect.ownKeys(e)}}class mg extends Xd{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const bg=new Yd,yg=new mg,_g=new Yd(!0);const qi=t=>t,qr=t=>Reflect.getPrototypeOf(t);function Ys(t,e,n=!1,o=!1){t=t.__v_raw;const s=Be(t),r=Be(e);n||(Nn(e,r)&&yt(s,"get",e),yt(s,"get",r));const{has:l}=qr(s),a=o?qi:n?Zi:Cs;if(l.call(s,e))return a(t.get(e));if(l.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function qs(t,e=!1){const n=this.__v_raw,o=Be(n),s=Be(t);return e||(Nn(t,s)&&yt(o,"has",t),yt(o,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Ks(t,e=!1){return t=t.__v_raw,!e&&yt(Be(t),"iterate",to),Reflect.get(t,"size",t)}function Ja(t){t=Be(t);const e=Be(this);return qr(e).has.call(e,t)||(e.add(t),un(e,"add",t,t)),this}function Za(t,e){e=Be(e);const n=Be(this),{has:o,get:s}=qr(n);let r=o.call(n,t);r||(t=Be(t),r=o.call(n,t));const l=s.call(n,t);return n.set(t,e),r?Nn(e,l)&&un(n,"set",t,e):un(n,"add",t,e),this}function Qa(t){const e=Be(this),{has:n,get:o}=qr(e);let s=n.call(e,t);s||(t=Be(t),s=n.call(e,t)),o&&o.call(e,t);const r=e.delete(t);return s&&un(e,"delete",t,void 0),r}function eu(){const t=Be(this),e=t.size!==0,n=t.clear();return e&&un(t,"clear",void 0,void 0),n}function Js(t,e){return function(o,s){const r=this,l=r.__v_raw,a=Be(l),i=e?qi:t?Zi:Cs;return!t&&yt(a,"iterate",to),l.forEach((u,c)=>o.call(s,i(u),i(c),r))}}function Zs(t,e,n){return function(...o){const s=this.__v_raw,r=Be(s),l=Co(r),a=t==="entries"||t===Symbol.iterator&&l,i=t==="keys"&&l,u=s[t](...o),c=n?qi:e?Zi:Cs;return!e&&yt(r,"iterate",i?ni:to),{next(){const{value:f,done:p}=u.next();return p?{value:f,done:p}:{value:a?[c(f[0]),c(f[1])]:c(f),done:p}},[Symbol.iterator](){return this}}}}function hn(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function wg(){const t={get(r){return Ys(this,r)},get size(){return Ks(this)},has:qs,add:Ja,set:Za,delete:Qa,clear:eu,forEach:Js(!1,!1)},e={get(r){return Ys(this,r,!1,!0)},get size(){return Ks(this)},has:qs,add:Ja,set:Za,delete:Qa,clear:eu,forEach:Js(!1,!0)},n={get(r){return Ys(this,r,!0)},get size(){return Ks(this,!0)},has(r){return qs.call(this,r,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:Js(!0,!1)},o={get(r){return Ys(this,r,!0,!0)},get size(){return Ks(this,!0)},has(r){return qs.call(this,r,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:Js(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Zs(r,!1,!1),n[r]=Zs(r,!0,!1),e[r]=Zs(r,!1,!0),o[r]=Zs(r,!0,!0)}),[t,n,e,o]}const[Pg,Cg,xg,kg]=wg();function Ki(t,e){const n=e?t?kg:xg:t?Cg:Pg;return(o,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?o:Reflect.get(Ie(n,s)&&s in o?n:o,s,r)}const Og={get:Ki(!1,!1)},Sg={get:Ki(!1,!0)},$g={get:Ki(!0,!1)};const qd=new WeakMap,Kd=new WeakMap,Jd=new WeakMap,Ig=new WeakMap;function jg(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Tg(t){return t.__v_skip||!Object.isExtensible(t)?0:jg(Qv(t))}function Fn(t){return Ps(t)?t:Ji(t,!1,bg,Og,qd)}function Ag(t){return Ji(t,!1,_g,Sg,Kd)}function Zd(t){return Ji(t,!0,yg,$g,Jd)}function Ji(t,e,n,o,s){if(!He(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const l=Tg(t);if(l===0)return t;const a=new Proxy(t,l===2?o:n);return s.set(t,a),a}function fs(t){return Ps(t)?fs(t.__v_raw):!!(t&&t.__v_isReactive)}function Ps(t){return!!(t&&t.__v_isReadonly)}function xr(t){return!!(t&&t.__v_isShallow)}function Qd(t){return t?!!t.__v_raw:!1}function Be(t){const e=t&&t.__v_raw;return e?Be(e):t}function Eg(t){return Object.isExtensible(t)&&Bd(t,"__v_skip",!0),t}const Cs=t=>He(t)?Fn(t):t,Zi=t=>He(t)?Zd(t):t;class ef{constructor(e,n,o,s){this.getter=e,this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Gi(()=>e(this._value),()=>vr(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const e=Be(this);return(!e._cacheable||e.effect.dirty)&&Nn(e._value,e._value=e.effect.run())&&vr(e,4),tf(e),e.effect._dirtyLevel>=2&&vr(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Rg(t,e,n=!1){let o,s;const r=Pe(t);return r?(o=t,s=Et):(o=t.get,s=t.set),new ef(o,s,r||!s,n)}function tf(t){var e;En&&eo&&(t=Be(t),Ud(eo,(e=t.dep)!=null?e:t.dep=zd(()=>t.dep=void 0,t instanceof ef?t:void 0)))}function vr(t,e=4,n,o){t=Be(t);const s=t.dep;s&&Wd(s,e)}function _e(t){return!!(t&&t.__v_isRef===!0)}function L(t){return Bg(t,!1)}function Bg(t,e){return _e(t)?t:new Mg(t,e)}class Mg{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Be(e),this._value=n?e:Cs(e)}get value(){return tf(this),this._value}set value(e){const n=this.__v_isShallow||xr(e)||Ps(e);e=n?e:Be(e),Nn(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=n?e:Cs(e),vr(this,4))}}function oe(t){return _e(t)?t.value:t}const Dg={get:(t,e,n)=>oe(Reflect.get(t,e,n)),set:(t,e,n,o)=>{const s=t[e];return _e(s)&&!_e(n)?(s.value=n,!0):Reflect.set(t,e,n,o)}};function nf(t){return fs(t)?t:new Proxy(t,Dg)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Rn(t,e,n,o){try{return o?t(...o):t()}catch(s){Ms(s,e,n)}}function Bt(t,e,n,o){if(Pe(t)){const s=Rn(t,e,n,o);return s&&Td(s)&&s.catch(r=>{Ms(r,e,n)}),s}if(he(t)){const s=[];for(let r=0;r<t.length;r++)s.push(Bt(t[r],e,n,o));return s}}function Ms(t,e,n,o=!0){const s=e?e.vnode:null;if(e){let r=e.parent;const l=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${n}`;for(;r;){const u=r.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](t,l,a)===!1)return}r=r.parent}const i=e.appContext.config.errorHandler;if(i){Wn(),Rn(i,null,10,[t,l,a]),zn();return}}Lg(t,n,s,o)}function Lg(t,e,n,o=!0){console.error(t)}let xs=!1,oi=!1;const ft=[];let Zt=0;const ko=[];let xn=null,Jn=0;const of=Promise.resolve();let Qi=null;function Bn(t){const e=Qi||of;return t?e.then(this?t.bind(this):t):e}function Ng(t){let e=Zt+1,n=ft.length;for(;e<n;){const o=e+n>>>1,s=ft[o],r=ks(s);r<t||r===t&&s.pre?e=o+1:n=o}return e}function Kr(t){(!ft.length||!ft.includes(t,xs&&t.allowRecurse?Zt+1:Zt))&&(t.id==null?ft.push(t):ft.splice(Ng(t.id),0,t),sf())}function sf(){!xs&&!oi&&(oi=!0,Qi=of.then(lf))}function Fg(t){const e=ft.indexOf(t);e>Zt&&ft.splice(e,1)}function Vg(t){he(t)?ko.push(...t):(!xn||!xn.includes(t,t.allowRecurse?Jn+1:Jn))&&ko.push(t),sf()}function tu(t,e,n=xs?Zt+1:0){for(;n<ft.length;n++){const o=ft[n];if(o&&o.pre){if(t&&o.id!==t.uid)continue;ft.splice(n,1),n--,o()}}}function rf(t){if(ko.length){const e=[...new Set(ko)].sort((n,o)=>ks(n)-ks(o));if(ko.length=0,xn){xn.push(...e);return}for(xn=e,Jn=0;Jn<xn.length;Jn++){const n=xn[Jn];n.active!==!1&&n()}xn=null,Jn=0}}const ks=t=>t.id==null?1/0:t.id,Hg=(t,e)=>{const n=ks(t)-ks(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function lf(t){oi=!1,xs=!0,ft.sort(Hg);try{for(Zt=0;Zt<ft.length;Zt++){const e=ft[Zt];e&&e.active!==!1&&Rn(e,null,14)}}finally{Zt=0,ft.length=0,rf(),xs=!1,Qi=null,(ft.length||ko.length)&&lf()}}function Ug(t,e,...n){if(t.isUnmounted)return;const o=t.vnode.props||Ge;let s=n;const r=e.startsWith("update:"),l=r&&e.slice(7);if(l&&l in o){const c=`${l==="modelValue"?"model":l}Modifiers`,{number:f,trim:p}=o[c]||Ge;p&&(s=n.map(g=>et(g)?g.trim():g)),f&&(s=n.map(Cr))}let a,i=o[a=kl(e)]||o[a=kl($o(e))];!i&&r&&(i=o[a=kl(lo(e))]),i&&Bt(i,t,6,s);const u=o[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Bt(u,t,6,s)}}function af(t,e,n=!1){const o=e.emitsCache,s=o.get(t);if(s!==void 0)return s;const r=t.emits;let l={},a=!1;if(!Pe(t)){const i=u=>{const c=af(u,e,!0);c&&(a=!0,ot(l,c))};!n&&e.mixins.length&&e.mixins.forEach(i),t.extends&&i(t.extends),t.mixins&&t.mixins.forEach(i)}return!r&&!a?(He(t)&&o.set(t,null),null):(he(r)?r.forEach(i=>l[i]=null):ot(l,r),He(t)&&o.set(t,l),l)}function Jr(t,e){return!t||!Xr(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ie(t,e[0].toLowerCase()+e.slice(1))||Ie(t,lo(e))||Ie(t,e))}let ct=null,Zr=null;function kr(t){const e=ct;return ct=t,Zr=t&&t.type.__scopeId||null,e}function _t(t){Zr=t}function wt(){Zr=null}function X(t,e=ct,n){if(!e||t._n)return t;const o=(...s)=>{o._d&&hu(-1);const r=kr(e);let l;try{l=t(...s)}finally{kr(r),o._d&&hu(1)}return l};return o._n=!0,o._c=!0,o._d=!0,o}function Sl(t){const{type:e,vnode:n,proxy:o,withProxy:s,propsOptions:[r],slots:l,attrs:a,emit:i,render:u,renderCache:c,props:f,data:p,setupState:g,ctx:b,inheritAttrs:_}=t,w=kr(t);let k,v;try{if(n.shapeFlag&4){const m=s||o,j=m;k=Jt(u.call(j,m,c,f,g,p,b)),v=a}else{const m=e;k=Jt(m.length>1?m(f,{attrs:a,slots:l,emit:i}):m(f,null)),v=e.props?a:Wg(a)}}catch(m){ms.length=0,Ms(m,t,1),k=B(dn)}let h=k;if(v&&_!==!1){const m=Object.keys(v),{shapeFlag:j}=h;m.length&&j&7&&(r&&m.some(Hi)&&(v=zg(v,r)),h=Vn(h,v,!1,!0))}return n.dirs&&(h=Vn(h,null,!1,!0),h.dirs=h.dirs?h.dirs.concat(n.dirs):n.dirs),n.transition&&(h.transition=n.transition),k=h,kr(w),k}const Wg=t=>{let e;for(const n in t)(n==="class"||n==="style"||Xr(n))&&((e||(e={}))[n]=t[n]);return e},zg=(t,e)=>{const n={};for(const o in t)(!Hi(o)||!(o.slice(9)in e))&&(n[o]=t[o]);return n};function Gg(t,e,n){const{props:o,children:s,component:r}=t,{props:l,children:a,patchFlag:i}=e,u=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&i>=0){if(i&1024)return!0;if(i&16)return o?nu(o,l,u):!!l;if(i&8){const c=e.dynamicProps;for(let f=0;f<c.length;f++){const p=c[f];if(l[p]!==o[p]&&!Jr(u,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===l?!1:o?l?nu(o,l,u):!0:!!l;return!1}function nu(t,e,n){const o=Object.keys(e);if(o.length!==Object.keys(t).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(e[r]!==t[r]&&!Jr(n,r))return!0}return!1}function Xg({vnode:t,parent:e},n){for(;e;){const o=e.subTree;if(o.suspense&&o.suspense.activeBranch===t&&(o.el=t.el),o===t)(t=e.vnode).el=n,e=e.parent;else break}}const Yg=Symbol.for("v-ndc"),si=t=>t.__isSuspense;function qg(t,e){e&&e.pendingBranch?he(t)?e.effects.push(...t):e.effects.push(t):Vg(t)}function Qr(t,e,n=ut,o=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...l)=>{Wn();const a=Ds(n),i=Bt(e,n,t,l);return a(),zn(),i});return o?s.unshift(r):s.push(r),r}}const fn=t=>(e,n=ut)=>{(!Ls||t==="sp")&&Qr(t,(...o)=>e(...o),n)},Kg=fn("bm"),mt=fn("m"),Jg=fn("bu"),ea=fn("u"),ta=fn("bum"),Wt=fn("um"),Zg=fn("sp"),Qg=fn("rtg"),em=fn("rtc");function tm(t,e=ut){Qr("ec",t,e)}function Oe(t,e){if(ct===null)return t;const n=tl(ct),o=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,l,a,i=Ge]=e[s];r&&(Pe(r)&&(r={mounted:r,updated:r}),r.deep&&Sn(l),o.push({dir:r,instance:n,value:l,oldValue:void 0,arg:a,modifiers:i}))}return t}function Gn(t,e,n,o){const s=t.dirs,r=e&&e.dirs;for(let l=0;l<s.length;l++){const a=s[l];r&&(a.oldValue=r[l].value);let i=a.dir[o];i&&(Wn(),Bt(i,n,8,[t.el,a,t,e]),zn())}}function Ue(t,e,n,o){let s;const r=n;if(he(t)||et(t)){s=new Array(t.length);for(let l=0,a=t.length;l<a;l++)s[l]=e(t[l],l,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let l=0;l<t;l++)s[l]=e(l+1,l,void 0,r)}else if(He(t))if(t[Symbol.iterator])s=Array.from(t,(l,a)=>e(l,a,void 0,r));else{const l=Object.keys(t);s=new Array(l.length);for(let a=0,i=l.length;a<i;a++){const u=l[a];s[a]=e(t[u],u,a,r)}}else s=[];return s}/*! #__NO_SIDE_EFFECTS__ */function Ce(t,e){return Pe(t)?ot({name:t.name},e,{setup:t}):t}const Oo=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function ou(t){Pe(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:o,delay:s=200,timeout:r,suspensible:l=!0,onError:a}=t;let i=null,u,c=0;const f=()=>(c++,i=null,p()),p=()=>{let g;return i||(g=i=e().catch(b=>{if(b=b instanceof Error?b:new Error(String(b)),a)return new Promise((_,w)=>{a(b,()=>_(f()),()=>w(b),c+1)});throw b}).then(b=>g!==i&&i?i:(b&&(b.__esModule||b[Symbol.toStringTag]==="Module")&&(b=b.default),u=b,b)))};return Ce({name:"AsyncComponentWrapper",__asyncLoader:p,get __asyncResolved(){return u},setup(){const g=ut;if(u)return()=>$l(u,g);const b=v=>{i=null,Ms(v,g,13,!o)};if(l&&g.suspense||Ls)return p().then(v=>()=>$l(v,g)).catch(v=>(b(v),()=>o?B(o,{error:v}):null));const _=L(!1),w=L(),k=L(!!s);return s&&setTimeout(()=>{k.value=!1},s),r!=null&&setTimeout(()=>{if(!_.value&&!w.value){const v=new Error(`Async component timed out after ${r}ms.`);b(v),w.value=v}},r),p().then(()=>{_.value=!0,g.parent&&ra(g.parent.vnode)&&(g.parent.effect.dirty=!0,Kr(g.parent.update))}).catch(v=>{b(v),w.value=v}),()=>{if(_.value&&u)return $l(u,g);if(w.value&&o)return B(o,{error:w.value});if(n&&!k.value)return B(n)}}})}function $l(t,e){const{ref:n,props:o,children:s,ce:r}=e.vnode,l=B(t,o,s);return l.ref=n,l.ce=r,delete e.vnode.ce,l}function Qt(t,e,n={},o,s){if(ct.isCE||ct.parent&&Oo(ct.parent)&&ct.parent.isCE)return e!=="default"&&(n.name=e),B("slot",n,o);let r=t[e];r&&r._c&&(r._d=!1),x();const l=r&&uf(r(n)),a=fe(ae,{key:n.key||l&&l.key||`_${e}`},l||[],l&&t._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function uf(t){return t.some(e=>$s(e)?!(e.type===dn||e.type===ae&&!uf(e.children)):!0)?t:null}const ri=t=>t?Af(t)?tl(t):ri(t.parent):null,ps=ot(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ri(t.parent),$root:t=>ri(t.root),$emit:t=>t.emit,$options:t=>na(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,Kr(t.update)}),$nextTick:t=>t.n||(t.n=Bn.bind(t.proxy)),$watch:t=>Pm.bind(t)}),Il=(t,e)=>t!==Ge&&!t.__isScriptSetup&&Ie(t,e),nm={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:o,data:s,props:r,accessCache:l,type:a,appContext:i}=t;let u;if(e[0]!=="$"){const g=l[e];if(g!==void 0)switch(g){case 1:return o[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(Il(o,e))return l[e]=1,o[e];if(s!==Ge&&Ie(s,e))return l[e]=2,s[e];if((u=t.propsOptions[0])&&Ie(u,e))return l[e]=3,r[e];if(n!==Ge&&Ie(n,e))return l[e]=4,n[e];li&&(l[e]=0)}}const c=ps[e];let f,p;if(c)return e==="$attrs"&&yt(t.attrs,"get",""),c(t);if((f=a.__cssModules)&&(f=f[e]))return f;if(n!==Ge&&Ie(n,e))return l[e]=4,n[e];if(p=i.config.globalProperties,Ie(p,e))return p[e]},set({_:t},e,n){const{data:o,setupState:s,ctx:r}=t;return Il(s,e)?(s[e]=n,!0):o!==Ge&&Ie(o,e)?(o[e]=n,!0):Ie(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:o,appContext:s,propsOptions:r}},l){let a;return!!n[l]||t!==Ge&&Ie(t,l)||Il(e,l)||(a=r[0])&&Ie(a,l)||Ie(o,l)||Ie(ps,l)||Ie(s.config.globalProperties,l)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ie(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function su(t){return he(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let li=!0;function om(t){const e=na(t),n=t.proxy,o=t.ctx;li=!1,e.beforeCreate&&ru(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:l,watch:a,provide:i,inject:u,created:c,beforeMount:f,mounted:p,beforeUpdate:g,updated:b,activated:_,deactivated:w,beforeDestroy:k,beforeUnmount:v,destroyed:h,unmounted:m,render:j,renderTracked:P,renderTriggered:A,errorCaptured:D,serverPrefetch:M,expose:Y,inheritAttrs:z,components:F,directives:ne,filters:le}=e;if(u&&sm(u,o,null),l)for(const O in l){const T=l[O];Pe(T)&&(o[O]=T.bind(n))}if(s){const O=s.call(n,n);He(O)&&(t.data=Fn(O))}if(li=!0,r)for(const O in r){const T=r[O],$=Pe(T)?T.bind(n,n):Pe(T.get)?T.get.bind(n,n):Et,re=!Pe(T)&&Pe(T.set)?T.set.bind(n):Et,me=S({get:$,set:re});Object.defineProperty(o,O,{enumerable:!0,configurable:!0,get:()=>me.value,set:xe=>me.value=xe})}if(a)for(const O in a)cf(a[O],o,n,O);if(i){const O=Pe(i)?i.call(n):i;Reflect.ownKeys(O).forEach(T=>{cm(T,O[T])})}c&&ru(c,t,"c");function I(O,T){he(T)?T.forEach($=>O($.bind(n))):T&&O(T.bind(n))}if(I(Kg,f),I(mt,p),I(Jg,g),I(ea,b),I(Cf,_),I(xf,w),I(tm,D),I(em,P),I(Qg,A),I(ta,v),I(Wt,m),I(Zg,M),he(Y))if(Y.length){const O=t.exposed||(t.exposed={});Y.forEach(T=>{Object.defineProperty(O,T,{get:()=>n[T],set:$=>n[T]=$})})}else t.exposed||(t.exposed={});j&&t.render===Et&&(t.render=j),z!=null&&(t.inheritAttrs=z),F&&(t.components=F),ne&&(t.directives=ne)}function sm(t,e,n=Et){he(t)&&(t=ii(t));for(const o in t){const s=t[o];let r;He(s)?"default"in s?r=vs(s.from||o,s.default,!0):r=vs(s.from||o):r=vs(s),_e(r)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:l=>r.value=l}):e[o]=r}}function ru(t,e,n){Bt(he(t)?t.map(o=>o.bind(e.proxy)):t.bind(e.proxy),e,n)}function cf(t,e,n,o){const s=o.includes(".")?Pf(n,o):()=>n[o];if(et(t)){const r=e[t];Pe(r)&&We(s,r)}else if(Pe(t))We(s,t.bind(n));else if(He(t))if(he(t))t.forEach(r=>cf(r,e,n,o));else{const r=Pe(t.handler)?t.handler.bind(n):e[t.handler];Pe(r)&&We(s,r,t)}}function na(t){const e=t.type,{mixins:n,extends:o}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:l}}=t.appContext,a=r.get(e);let i;return a?i=a:!s.length&&!n&&!o?i=e:(i={},s.length&&s.forEach(u=>Or(i,u,l,!0)),Or(i,e,l)),He(e)&&r.set(e,i),i}function Or(t,e,n,o=!1){const{mixins:s,extends:r}=e;r&&Or(t,r,n,!0),s&&s.forEach(l=>Or(t,l,n,!0));for(const l in e)if(!(o&&l==="expose")){const a=rm[l]||n&&n[l];t[l]=a?a(t[l],e[l]):e[l]}return t}const rm={data:lu,props:iu,emits:iu,methods:as,computed:as,beforeCreate:ht,created:ht,beforeMount:ht,mounted:ht,beforeUpdate:ht,updated:ht,beforeDestroy:ht,beforeUnmount:ht,destroyed:ht,unmounted:ht,activated:ht,deactivated:ht,errorCaptured:ht,serverPrefetch:ht,components:as,directives:as,watch:im,provide:lu,inject:lm};function lu(t,e){return e?t?function(){return ot(Pe(t)?t.call(this,this):t,Pe(e)?e.call(this,this):e)}:e:t}function lm(t,e){return as(ii(t),ii(e))}function ii(t){if(he(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ht(t,e){return t?[...new Set([].concat(t,e))]:e}function as(t,e){return t?ot(Object.create(null),t,e):e}function iu(t,e){return t?he(t)&&he(e)?[...new Set([...t,...e])]:ot(Object.create(null),su(t),su(e!=null?e:{})):e}function im(t,e){if(!t)return e;if(!e)return t;const n=ot(Object.create(null),t);for(const o in e)n[o]=ht(t[o],e[o]);return n}function df(){return{app:null,config:{isNativeTag:Kv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let am=0;function um(t,e){return function(o,s=null){Pe(o)||(o=ot({},o)),s!=null&&!He(s)&&(s=null);const r=df(),l=new WeakSet;let a=!1;const i=r.app={_uid:am++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:zm,get config(){return r.config},set config(u){},use(u,...c){return l.has(u)||(u&&Pe(u.install)?(l.add(u),u.install(i,...c)):Pe(u)&&(l.add(u),u(i,...c))),i},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),i},component(u,c){return c?(r.components[u]=c,i):r.components[u]},directive(u,c){return c?(r.directives[u]=c,i):r.directives[u]},mount(u,c,f){if(!a){const p=B(o,s);return p.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),c&&e?e(p,u):t(p,u,f),a=!0,i._container=u,u.__vue_app__=i,tl(p.component)}},unmount(){a&&(t(null,i._container),delete i._container.__vue_app__)},provide(u,c){return r.provides[u]=c,i},runWithContext(u){const c=hs;hs=i;try{return u()}finally{hs=c}}};return i}}let hs=null;function cm(t,e){if(ut){let n=ut.provides;const o=ut.parent&&ut.parent.provides;o===n&&(n=ut.provides=Object.create(o)),n[t]=e}}function vs(t,e,n=!1){const o=ut||ct;if(o||hs){const s=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:hs._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&Pe(e)?e.call(o&&o.proxy):e}}const ff={},pf=()=>Object.create(ff),hf=t=>Object.getPrototypeOf(t)===ff;function dm(t,e,n,o=!1){const s={},r=pf();t.propsDefaults=Object.create(null),vf(t,e,s,r);for(const l in t.propsOptions[0])l in s||(s[l]=void 0);n?t.props=o?s:Ag(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function fm(t,e,n,o){const{props:s,attrs:r,vnode:{patchFlag:l}}=t,a=Be(s),[i]=t.propsOptions;let u=!1;if((o||l>0)&&!(l&16)){if(l&8){const c=t.vnode.dynamicProps;for(let f=0;f<c.length;f++){let p=c[f];if(Jr(t.emitsOptions,p))continue;const g=e[p];if(i)if(Ie(r,p))g!==r[p]&&(r[p]=g,u=!0);else{const b=$o(p);s[b]=ai(i,a,b,g,t,!1)}else g!==r[p]&&(r[p]=g,u=!0)}}}else{vf(t,e,s,r)&&(u=!0);let c;for(const f in a)(!e||!Ie(e,f)&&((c=lo(f))===f||!Ie(e,c)))&&(i?n&&(n[f]!==void 0||n[c]!==void 0)&&(s[f]=ai(i,a,f,void 0,t,!0)):delete s[f]);if(r!==a)for(const f in r)(!e||!Ie(e,f))&&(delete r[f],u=!0)}u&&un(t.attrs,"set","")}function vf(t,e,n,o){const[s,r]=t.propsOptions;let l=!1,a;if(e)for(let i in e){if(ds(i))continue;const u=e[i];let c;s&&Ie(s,c=$o(i))?!r||!r.includes(c)?n[c]=u:(a||(a={}))[c]=u:Jr(t.emitsOptions,i)||(!(i in o)||u!==o[i])&&(o[i]=u,l=!0)}if(r){const i=Be(n),u=a||Ge;for(let c=0;c<r.length;c++){const f=r[c];n[f]=ai(s,i,f,u[f],t,!Ie(u,f))}}return l}function ai(t,e,n,o,s,r){const l=t[n];if(l!=null){const a=Ie(l,"default");if(a&&o===void 0){const i=l.default;if(l.type!==Function&&!l.skipFactory&&Pe(i)){const{propsDefaults:u}=s;if(n in u)o=u[n];else{const c=Ds(s);o=u[n]=i.call(null,e),c()}}else o=i}l[0]&&(r&&!a?o=!1:l[1]&&(o===""||o===lo(n))&&(o=!0))}return o}function gf(t,e,n=!1){const o=e.propsCache,s=o.get(t);if(s)return s;const r=t.props,l={},a=[];let i=!1;if(!Pe(t)){const c=f=>{i=!0;const[p,g]=gf(f,e,!0);ot(l,p),g&&a.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!r&&!i)return He(t)&&o.set(t,Po),Po;if(he(r))for(let c=0;c<r.length;c++){const f=$o(r[c]);au(f)&&(l[f]=Ge)}else if(r)for(const c in r){const f=$o(c);if(au(f)){const p=r[c],g=l[f]=he(p)||Pe(p)?{type:p}:ot({},p);if(g){const b=du(Boolean,g.type),_=du(String,g.type);g[0]=b>-1,g[1]=_<0||b<_,(b>-1||Ie(g,"default"))&&a.push(f)}}}const u=[l,a];return He(t)&&o.set(t,u),u}function au(t){return t[0]!=="$"&&!ds(t)}function uu(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function cu(t,e){return uu(t)===uu(e)}function du(t,e){return he(e)?e.findIndex(n=>cu(n,t)):Pe(e)&&cu(e,t)?0:-1}const mf=t=>t[0]==="_"||t==="$stable",oa=t=>he(t)?t.map(Jt):[Jt(t)],pm=(t,e,n)=>{if(e._n)return e;const o=X((...s)=>oa(e(...s)),n);return o._c=!1,o},bf=(t,e,n)=>{const o=t._ctx;for(const s in t){if(mf(s))continue;const r=t[s];if(Pe(r))e[s]=pm(s,r,o);else if(r!=null){const l=oa(r);e[s]=()=>l}}},yf=(t,e)=>{const n=oa(e);t.slots.default=()=>n},hm=(t,e)=>{const n=t.slots=pf();if(t.vnode.shapeFlag&32){const o=e._;o?(ot(n,e),Bd(n,"_",o,!0)):bf(e,n)}else e&&yf(t,e)},vm=(t,e,n)=>{const{vnode:o,slots:s}=t;let r=!0,l=Ge;if(o.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(ot(s,e),!n&&a===1&&delete s._):(r=!e.$stable,bf(e,s)),l=e}else e&&(yf(t,e),l={default:1});if(r)for(const a in s)!mf(a)&&l[a]==null&&delete s[a]};function ui(t,e,n,o,s=!1){if(he(t)){t.forEach((p,g)=>ui(p,e&&(he(e)?e[g]:e),n,o,s));return}if(Oo(o)&&!s)return;const r=o.shapeFlag&4?tl(o.component):o.el,l=s?null:r,{i:a,r:i}=t,u=e&&e.r,c=a.refs===Ge?a.refs={}:a.refs,f=a.setupState;if(u!=null&&u!==i&&(et(u)?(c[u]=null,Ie(f,u)&&(f[u]=null)):_e(u)&&(u.value=null)),Pe(i))Rn(i,a,12,[l,c]);else{const p=et(i),g=_e(i);if(p||g){const b=()=>{if(t.f){const _=p?Ie(f,i)?f[i]:c[i]:i.value;s?he(_)&&Ui(_,r):he(_)?_.includes(r)||_.push(r):p?(c[i]=[r],Ie(f,i)&&(f[i]=c[i])):(i.value=[r],t.k&&(c[t.k]=i.value))}else p?(c[i]=l,Ie(f,i)&&(f[i]=l)):g&&(i.value=l,t.k&&(c[t.k]=l))};l?(b.id=-1,at(b,n)):b()}}}const at=qg;function gm(t){return mm(t)}function mm(t,e){const n=Md();n.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:l,createText:a,createComment:i,setText:u,setElementText:c,parentNode:f,nextSibling:p,setScopeId:g=Et,insertStaticContent:b}=t,_=(y,C,E,V=null,N=null,G=null,te=void 0,J=null,ee=!!C.dynamicChildren)=>{if(y===C)return;y&&!Zn(y,C)&&(V=Se(y),xe(y,N,G,!0),y=null),C.patchFlag===-2&&(ee=!1,C.dynamicChildren=null);const{type:H,ref:se,shapeFlag:ge}=C;switch(H){case el:w(y,C,E,V);break;case dn:k(y,C,E,V);break;case gr:y==null&&v(C,E,V,te);break;case ae:F(y,C,E,V,N,G,te,J,ee);break;default:ge&1?j(y,C,E,V,N,G,te,J,ee):ge&6?ne(y,C,E,V,N,G,te,J,ee):(ge&64||ge&128)&&H.process(y,C,E,V,N,G,te,J,ee,ie)}se!=null&&N&&ui(se,y&&y.ref,G,C||y,!C)},w=(y,C,E,V)=>{if(y==null)o(C.el=a(C.children),E,V);else{const N=C.el=y.el;C.children!==y.children&&u(N,C.children)}},k=(y,C,E,V)=>{y==null?o(C.el=i(C.children||""),E,V):C.el=y.el},v=(y,C,E,V)=>{[y.el,y.anchor]=b(y.children,C,E,V,y.el,y.anchor)},h=({el:y,anchor:C},E,V)=>{let N;for(;y&&y!==C;)N=p(y),o(y,E,V),y=N;o(C,E,V)},m=({el:y,anchor:C})=>{let E;for(;y&&y!==C;)E=p(y),s(y),y=E;s(C)},j=(y,C,E,V,N,G,te,J,ee)=>{C.type==="svg"?te="svg":C.type==="math"&&(te="mathml"),y==null?P(C,E,V,N,G,te,J,ee):M(y,C,N,G,te,J,ee)},P=(y,C,E,V,N,G,te,J)=>{let ee,H;const{props:se,shapeFlag:ge,transition:ve,dirs:we}=y;if(ee=y.el=l(y.type,G,se&&se.is,se),ge&8?c(ee,y.children):ge&16&&D(y.children,ee,null,V,N,jl(y,G),te,J),we&&Gn(y,null,V,"created"),A(ee,y,y.scopeId,te,V),se){for(const ze in se)ze!=="value"&&!ds(ze)&&r(ee,ze,null,se[ze],G,y.children,V,N,ye);"value"in se&&r(ee,"value",null,se.value,G),(H=se.onVnodeBeforeMount)&&Tt(H,V,y)}we&&Gn(y,null,V,"beforeMount");const ke=bm(N,ve);ke&&ve.beforeEnter(ee),o(ee,C,E),((H=se&&se.onVnodeMounted)||ke||we)&&at(()=>{H&&Tt(H,V,y),ke&&ve.enter(ee),we&&Gn(y,null,V,"mounted")},N)},A=(y,C,E,V,N)=>{if(E&&g(y,E),V)for(let G=0;G<V.length;G++)g(y,V[G]);if(N){let G=N.subTree;if(C===G){const te=N.vnode;A(y,te,te.scopeId,te.slotScopeIds,N.parent)}}},D=(y,C,E,V,N,G,te,J,ee=0)=>{for(let H=ee;H<y.length;H++){const se=y[H]=J?kn(y[H]):Jt(y[H]);_(null,se,C,E,V,N,G,te,J)}},M=(y,C,E,V,N,G,te)=>{const J=C.el=y.el;let{patchFlag:ee,dynamicChildren:H,dirs:se}=C;ee|=y.patchFlag&16;const ge=y.props||Ge,ve=C.props||Ge;let we;if(E&&Xn(E,!1),(we=ve.onVnodeBeforeUpdate)&&Tt(we,E,C,y),se&&Gn(C,y,E,"beforeUpdate"),E&&Xn(E,!0),H?Y(y.dynamicChildren,H,J,E,V,jl(C,N),G):te||T(y,C,J,null,E,V,jl(C,N),G,!1),ee>0){if(ee&16)z(J,C,ge,ve,E,V,N);else if(ee&2&&ge.class!==ve.class&&r(J,"class",null,ve.class,N),ee&4&&r(J,"style",ge.style,ve.style,N),ee&8){const ke=C.dynamicProps;for(let ze=0;ze<ke.length;ze++){const De=ke[ze],it=ge[De],Ft=ve[De];(Ft!==it||De==="value")&&r(J,De,it,Ft,N,y.children,E,V,ye)}}ee&1&&y.children!==C.children&&c(J,C.children)}else!te&&H==null&&z(J,C,ge,ve,E,V,N);((we=ve.onVnodeUpdated)||se)&&at(()=>{we&&Tt(we,E,C,y),se&&Gn(C,y,E,"updated")},V)},Y=(y,C,E,V,N,G,te)=>{for(let J=0;J<C.length;J++){const ee=y[J],H=C[J],se=ee.el&&(ee.type===ae||!Zn(ee,H)||ee.shapeFlag&70)?f(ee.el):E;_(ee,H,se,null,V,N,G,te,!0)}},z=(y,C,E,V,N,G,te)=>{if(E!==V){if(E!==Ge)for(const J in E)!ds(J)&&!(J in V)&&r(y,J,E[J],null,te,C.children,N,G,ye);for(const J in V){if(ds(J))continue;const ee=V[J],H=E[J];ee!==H&&J!=="value"&&r(y,J,H,ee,te,C.children,N,G,ye)}"value"in V&&r(y,"value",E.value,V.value,te)}},F=(y,C,E,V,N,G,te,J,ee)=>{const H=C.el=y?y.el:a(""),se=C.anchor=y?y.anchor:a("");let{patchFlag:ge,dynamicChildren:ve,slotScopeIds:we}=C;we&&(J=J?J.concat(we):we),y==null?(o(H,E,V),o(se,E,V),D(C.children||[],E,se,N,G,te,J,ee)):ge>0&&ge&64&&ve&&y.dynamicChildren?(Y(y.dynamicChildren,ve,E,N,G,te,J),(C.key!=null||N&&C===N.subTree)&&sa(y,C,!0)):T(y,C,E,se,N,G,te,J,ee)},ne=(y,C,E,V,N,G,te,J,ee)=>{C.slotScopeIds=J,y==null?C.shapeFlag&512?N.ctx.activate(C,E,V,te,ee):le(C,E,V,N,G,te,ee):q(y,C,ee)},le=(y,C,E,V,N,G,te)=>{const J=y.component=Nm(y,V,N);if(ra(y)&&(J.ctx.renderer=ie),Fm(J),J.asyncDep){if(N&&N.registerDep(J,I,te),!y.el){const ee=J.subTree=B(dn);k(null,ee,C,E)}}else I(J,y,C,E,N,G,te)},q=(y,C,E)=>{const V=C.component=y.component;if(Gg(y,C,E))if(V.asyncDep&&!V.asyncResolved){O(V,C,E);return}else V.next=C,Fg(V.update),V.effect.dirty=!0,V.update();else C.el=y.el,V.vnode=C},I=(y,C,E,V,N,G,te)=>{const J=()=>{if(y.isMounted){let{next:se,bu:ge,u:ve,parent:we,vnode:ke}=y;{const uo=_f(y);if(uo){se&&(se.el=ke.el,O(y,se,te)),uo.asyncDep.then(()=>{y.isUnmounted||J()});return}}let ze=se,De;Xn(y,!1),se?(se.el=ke.el,O(y,se,te)):se=ke,ge&&xo(ge),(De=se.props&&se.props.onVnodeBeforeUpdate)&&Tt(De,we,se,ke),Xn(y,!0);const it=Sl(y),Ft=y.subTree;y.subTree=it,_(Ft,it,f(Ft.el),Se(Ft),y,N,G),se.el=it.el,ze===null&&Xg(y,it.el),ve&&at(ve,N),(De=se.props&&se.props.onVnodeUpdated)&&at(()=>Tt(De,we,se,ke),N)}else{let se;const{el:ge,props:ve}=C,{bm:we,m:ke,parent:ze}=y,De=Oo(C);if(Xn(y,!1),we&&xo(we),!De&&(se=ve&&ve.onVnodeBeforeMount)&&Tt(se,ze,C),Xn(y,!0),ge&&Re){const it=()=>{y.subTree=Sl(y),Re(ge,y.subTree,y,N,null)};De?C.type.__asyncLoader().then(()=>!y.isUnmounted&&it()):it()}else{const it=y.subTree=Sl(y);_(null,it,E,V,y,N,G),C.el=it.el}if(ke&&at(ke,N),!De&&(se=ve&&ve.onVnodeMounted)){const it=C;at(()=>Tt(se,ze,it),N)}(C.shapeFlag&256||ze&&Oo(ze.vnode)&&ze.vnode.shapeFlag&256)&&y.a&&at(y.a,N),y.isMounted=!0,C=E=V=null}},ee=y.effect=new Gi(J,Et,()=>Kr(H),y.scope),H=y.update=()=>{ee.dirty&&ee.run()};H.id=y.uid,Xn(y,!0),H()},O=(y,C,E)=>{C.component=y;const V=y.vnode.props;y.vnode=C,y.next=null,fm(y,C.props,V,E),vm(y,C.children,E),Wn(),tu(y),zn()},T=(y,C,E,V,N,G,te,J,ee=!1)=>{const H=y&&y.children,se=y?y.shapeFlag:0,ge=C.children,{patchFlag:ve,shapeFlag:we}=C;if(ve>0){if(ve&128){re(H,ge,E,V,N,G,te,J,ee);return}else if(ve&256){$(H,ge,E,V,N,G,te,J,ee);return}}we&8?(se&16&&ye(H,N,G),ge!==H&&c(E,ge)):se&16?we&16?re(H,ge,E,V,N,G,te,J,ee):ye(H,N,G,!0):(se&8&&c(E,""),we&16&&D(ge,E,V,N,G,te,J,ee))},$=(y,C,E,V,N,G,te,J,ee)=>{y=y||Po,C=C||Po;const H=y.length,se=C.length,ge=Math.min(H,se);let ve;for(ve=0;ve<ge;ve++){const we=C[ve]=ee?kn(C[ve]):Jt(C[ve]);_(y[ve],we,E,null,N,G,te,J,ee)}H>se?ye(y,N,G,!0,!1,ge):D(C,E,V,N,G,te,J,ee,ge)},re=(y,C,E,V,N,G,te,J,ee)=>{let H=0;const se=C.length;let ge=y.length-1,ve=se-1;for(;H<=ge&&H<=ve;){const we=y[H],ke=C[H]=ee?kn(C[H]):Jt(C[H]);if(Zn(we,ke))_(we,ke,E,null,N,G,te,J,ee);else break;H++}for(;H<=ge&&H<=ve;){const we=y[ge],ke=C[ve]=ee?kn(C[ve]):Jt(C[ve]);if(Zn(we,ke))_(we,ke,E,null,N,G,te,J,ee);else break;ge--,ve--}if(H>ge){if(H<=ve){const we=ve+1,ke=we<se?C[we].el:V;for(;H<=ve;)_(null,C[H]=ee?kn(C[H]):Jt(C[H]),E,ke,N,G,te,J,ee),H++}}else if(H>ve)for(;H<=ge;)xe(y[H],N,G,!0),H++;else{const we=H,ke=H,ze=new Map;for(H=ke;H<=ve;H++){const xt=C[H]=ee?kn(C[H]):Jt(C[H]);xt.key!=null&&ze.set(xt.key,H)}let De,it=0;const Ft=ve-ke+1;let uo=!1,Ha=0;const Zo=new Array(Ft);for(H=0;H<Ft;H++)Zo[H]=0;for(H=we;H<=ge;H++){const xt=y[H];if(it>=Ft){xe(xt,N,G,!0);continue}let Yt;if(xt.key!=null)Yt=ze.get(xt.key);else for(De=ke;De<=ve;De++)if(Zo[De-ke]===0&&Zn(xt,C[De])){Yt=De;break}Yt===void 0?xe(xt,N,G,!0):(Zo[Yt-ke]=H+1,Yt>=Ha?Ha=Yt:uo=!0,_(xt,C[Yt],E,null,N,G,te,J,ee),it++)}const Ua=uo?ym(Zo):Po;for(De=Ua.length-1,H=Ft-1;H>=0;H--){const xt=ke+H,Yt=C[xt],Wa=xt+1<se?C[xt+1].el:V;Zo[H]===0?_(null,Yt,E,Wa,N,G,te,J,ee):uo&&(De<0||H!==Ua[De]?me(Yt,E,Wa,2):De--)}}},me=(y,C,E,V,N=null)=>{const{el:G,type:te,transition:J,children:ee,shapeFlag:H}=y;if(H&6){me(y.component.subTree,C,E,V);return}if(H&128){y.suspense.move(C,E,V);return}if(H&64){te.move(y,C,E,ie);return}if(te===ae){o(G,C,E);for(let ge=0;ge<ee.length;ge++)me(ee[ge],C,E,V);o(y.anchor,C,E);return}if(te===gr){h(y,C,E);return}if(V!==2&&H&1&&J)if(V===0)J.beforeEnter(G),o(G,C,E),at(()=>J.enter(G),N);else{const{leave:ge,delayLeave:ve,afterLeave:we}=J,ke=()=>o(G,C,E),ze=()=>{ge(G,()=>{ke(),we&&we()})};ve?ve(G,ke,ze):ze()}else o(G,C,E)},xe=(y,C,E,V=!1,N=!1)=>{const{type:G,props:te,ref:J,children:ee,dynamicChildren:H,shapeFlag:se,patchFlag:ge,dirs:ve,memoIndex:we}=y;if(ge===-2&&(N=!1),J!=null&&ui(J,null,E,y,!0),we!=null&&(C.renderCache[we]=void 0),se&256){C.ctx.deactivate(y);return}const ke=se&1&&ve,ze=!Oo(y);let De;if(ze&&(De=te&&te.onVnodeBeforeUnmount)&&Tt(De,C,y),se&6)Q(y.component,E,V);else{if(se&128){y.suspense.unmount(E,V);return}ke&&Gn(y,null,C,"beforeUnmount"),se&64?y.type.remove(y,C,E,ie,V):H&&(G!==ae||ge>0&&ge&64)?ye(H,C,E,!1,!0):(G===ae&&ge&384||!N&&se&16)&&ye(ee,C,E),V&&Ee(y)}(ze&&(De=te&&te.onVnodeUnmounted)||ke)&&at(()=>{De&&Tt(De,C,y),ke&&Gn(y,null,C,"unmounted")},E)},Ee=y=>{const{type:C,el:E,anchor:V,transition:N}=y;if(C===ae){Ct(E,V);return}if(C===gr){m(y);return}const G=()=>{s(E),N&&!N.persisted&&N.afterLeave&&N.afterLeave()};if(y.shapeFlag&1&&N&&!N.persisted){const{leave:te,delayLeave:J}=N,ee=()=>te(E,G);J?J(y.el,G,ee):ee()}else G()},Ct=(y,C)=>{let E;for(;y!==C;)E=p(y),s(y),y=E;s(C)},Q=(y,C,E)=>{const{bum:V,scope:N,update:G,subTree:te,um:J,m:ee,a:H}=y;Sr(ee),Sr(H),V&&xo(V),N.stop(),G&&(G.active=!1,xe(te,y,C,E)),J&&at(J,C),at(()=>{y.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},ye=(y,C,E,V=!1,N=!1,G=0)=>{for(let te=G;te<y.length;te++)xe(y[te],C,E,V,N)},Se=y=>y.shapeFlag&6?Se(y.component.subTree):y.shapeFlag&128?y.suspense.next():p(y.anchor||y.el);let W=!1;const K=(y,C,E)=>{y==null?C._vnode&&xe(C._vnode,null,null,!0):_(C._vnode||null,y,C,null,null,null,E),W||(W=!0,tu(),rf(),W=!1),C._vnode=y},ie={p:_,um:xe,m:me,r:Ee,mt:le,mc:D,pc:T,pbc:Y,n:Se,o:t};let be,Re;return{render:K,hydrate:be,createApp:um(K,be)}}function jl({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Xn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function bm(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function sa(t,e,n=!1){const o=t.children,s=e.children;if(he(o)&&he(s))for(let r=0;r<o.length;r++){const l=o[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=kn(s[r]),a.el=l.el),!n&&a.patchFlag!==-2&&sa(l,a)),a.type===el&&(a.el=l.el)}}function ym(t){const e=t.slice(),n=[0];let o,s,r,l,a;const i=t.length;for(o=0;o<i;o++){const u=t[o];if(u!==0){if(s=n[n.length-1],t[s]<u){e[o]=s,n.push(o);continue}for(r=0,l=n.length-1;r<l;)a=r+l>>1,t[n[a]]<u?r=a+1:l=a;u<t[n[r]]&&(r>0&&(e[o]=n[r-1]),n[r]=o)}}for(r=n.length,l=n[r-1];r-- >0;)n[r]=l,l=e[l];return n}function _f(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:_f(e)}function Sr(t){if(t)for(let e=0;e<t.length;e++)t[e].active=!1}const _m=Symbol.for("v-scx"),wm=()=>vs(_m),Qs={};function We(t,e,n){return wf(t,e,n)}function wf(t,e,{immediate:n,deep:o,flush:s,once:r,onTrack:l,onTrigger:a}=Ge){if(e&&r){const P=e;e=(...A)=>{P(...A),j()}}const i=ut,u=P=>o===!0?P:Sn(P,o===!1?1:void 0);let c,f=!1,p=!1;if(_e(t)?(c=()=>t.value,f=xr(t)):fs(t)?(c=()=>u(t),f=!0):he(t)?(p=!0,f=t.some(P=>fs(P)||xr(P)),c=()=>t.map(P=>{if(_e(P))return P.value;if(fs(P))return u(P);if(Pe(P))return Rn(P,i,2)})):Pe(t)?e?c=()=>Rn(t,i,2):c=()=>(g&&g(),Bt(t,i,3,[b])):c=Et,e&&o){const P=c;c=()=>Sn(P())}let g,b=P=>{g=h.onStop=()=>{Rn(P,i,4),g=h.onStop=void 0}},_;if(Ls)if(b=Et,e?n&&Bt(e,i,3,[c(),p?[]:void 0,b]):c(),s==="sync"){const P=wm();_=P.__watcherHandles||(P.__watcherHandles=[])}else return Et;let w=p?new Array(t.length).fill(Qs):Qs;const k=()=>{if(!(!h.active||!h.dirty))if(e){const P=h.run();(o||f||(p?P.some((A,D)=>Nn(A,w[D])):Nn(P,w)))&&(g&&g(),Bt(e,i,3,[P,w===Qs?void 0:p&&w[0]===Qs?[]:w,b]),w=P)}else h.run()};k.allowRecurse=!!e;let v;s==="sync"?v=k:s==="post"?v=()=>at(k,i&&i.suspense):(k.pre=!0,i&&(k.id=i.uid),v=()=>Kr(k));const h=new Gi(c,Et,v),m=fg(),j=()=>{h.stop(),m&&Ui(m.effects,h)};return e?n?k():w=h.run():s==="post"?at(h.run.bind(h),i&&i.suspense):h.run(),_&&_.push(j),j}function Pm(t,e,n){const o=this.proxy,s=et(t)?t.includes(".")?Pf(o,t):()=>o[t]:t.bind(o,o);let r;Pe(e)?r=e:(r=e.handler,n=e);const l=Ds(this),a=wf(s,r.bind(o),n);return l(),a}function Pf(t,e){const n=e.split(".");return()=>{let o=t;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}function Sn(t,e=1/0,n){if(e<=0||!He(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,_e(t))Sn(t.value,e,n);else if(he(t))for(let o=0;o<t.length;o++)Sn(t[o],e,n);else if(Ho(t)||Co(t))t.forEach(o=>{Sn(o,e,n)});else if(Ed(t)){for(const o in t)Sn(t[o],e,n);for(const o of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,o)&&Sn(t[o],e,n)}return t}const ra=t=>t.type.__isKeepAlive,Cm={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=Tf(),o=n.ctx;if(!o.renderer)return()=>{const v=e.default&&e.default();return v&&v.length===1?v[0]:v};const s=new Map,r=new Set;let l=null;const a=n.suspense,{renderer:{p:i,m:u,um:c,o:{createElement:f}}}=o,p=f("div");o.activate=(v,h,m,j,P)=>{const A=v.component;u(v,h,m,0,a),i(A.vnode,v,h,m,A,a,j,v.slotScopeIds,P),at(()=>{A.isDeactivated=!1,A.a&&xo(A.a);const D=v.props&&v.props.onVnodeMounted;D&&Tt(D,A.parent,v)},a)},o.deactivate=v=>{const h=v.component;Sr(h.m),Sr(h.a),u(v,p,null,1,a),at(()=>{h.da&&xo(h.da);const m=v.props&&v.props.onVnodeUnmounted;m&&Tt(m,h.parent,v),h.isDeactivated=!0},a)};function g(v){Tl(v),c(v,n,a,!0)}function b(v){s.forEach((h,m)=>{const j=bu(h.type);j&&(!v||!v(j))&&_(m)})}function _(v){const h=s.get(v);!l||!Zn(h,l)?g(h):l&&Tl(l),s.delete(v),r.delete(v)}We(()=>[t.include,t.exclude],([v,h])=>{v&&b(m=>us(v,m)),h&&b(m=>!us(h,m))},{flush:"post",deep:!0});let w=null;const k=()=>{w!=null&&(si(n.subTree.type)?at(()=>{s.set(w,er(n.subTree))},n.subTree.suspense):s.set(w,er(n.subTree)))};return mt(k),ea(k),ta(()=>{s.forEach(v=>{const{subTree:h,suspense:m}=n,j=er(h);if(v.type===j.type&&v.key===j.key){Tl(j);const P=j.component.da;P&&at(P,m);return}g(v)})}),()=>{if(w=null,!e.default)return null;const v=e.default(),h=v[0];if(v.length>1)return l=null,v;if(!$s(h)||!(h.shapeFlag&4)&&!(h.shapeFlag&128))return l=null,h;let m=er(h);const j=m.type,P=bu(Oo(m)?m.type.__asyncResolved||{}:j),{include:A,exclude:D,max:M}=t;if(A&&(!P||!us(A,P))||D&&P&&us(D,P))return l=m,h;const Y=m.key==null?j:m.key,z=s.get(Y);return m.el&&(m=Vn(m),h.shapeFlag&128&&(h.ssContent=m)),w=Y,z?(m.el=z.el,m.component=z.component,m.transition&&Os(m,m.transition),m.shapeFlag|=512,r.delete(Y),r.add(Y)):(r.add(Y),M&&r.size>parseInt(M,10)&&_(r.values().next().value)),m.shapeFlag|=256,l=m,si(h.type)?h:m}}},xm=Cm;function us(t,e){return he(t)?t.some(n=>us(n,e)):et(t)?t.split(",").includes(e):Zv(t)?t.test(e):!1}function Cf(t,e){kf(t,"a",e)}function xf(t,e){kf(t,"da",e)}function kf(t,e,n=ut){const o=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Qr(e,o,n),n){let s=n.parent;for(;s&&s.parent;)ra(s.parent.vnode)&&km(o,e,n,s),s=s.parent}}function km(t,e,n,o){const s=Qr(e,t,o,!0);Wt(()=>{Ui(o[e],s)},n)}function Tl(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function er(t){return t.shapeFlag&128?t.ssContent:t}const co=Symbol("_leaveCb"),tr=Symbol("_enterCb");function Om(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mt(()=>{t.isMounted=!0}),ta(()=>{t.isUnmounting=!0}),t}const jt=[Function,Array],Sm={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:jt,onEnter:jt,onAfterEnter:jt,onEnterCancelled:jt,onBeforeLeave:jt,onLeave:jt,onAfterLeave:jt,onLeaveCancelled:jt,onBeforeAppear:jt,onAppear:jt,onAfterAppear:jt,onAppearCancelled:jt};function $m(t,e){const{leavingVNodes:n}=t;let o=n.get(e.type);return o||(o=Object.create(null),n.set(e.type,o)),o}function ci(t,e,n,o,s){const{appear:r,mode:l,persisted:a=!1,onBeforeEnter:i,onEnter:u,onAfterEnter:c,onEnterCancelled:f,onBeforeLeave:p,onLeave:g,onAfterLeave:b,onLeaveCancelled:_,onBeforeAppear:w,onAppear:k,onAfterAppear:v,onAppearCancelled:h}=e,m=String(t.key),j=$m(n,t),P=(M,Y)=>{M&&Bt(M,o,9,Y)},A=(M,Y)=>{const z=Y[1];P(M,Y),he(M)?M.every(F=>F.length<=1)&&z():M.length<=1&&z()},D={mode:l,persisted:a,beforeEnter(M){let Y=i;if(!n.isMounted)if(r)Y=w||i;else return;M[co]&&M[co](!0);const z=j[m];z&&Zn(t,z)&&z.el[co]&&z.el[co](),P(Y,[M])},enter(M){let Y=u,z=c,F=f;if(!n.isMounted)if(r)Y=k||u,z=v||c,F=h||f;else return;let ne=!1;const le=M[tr]=q=>{ne||(ne=!0,q?P(F,[M]):P(z,[M]),D.delayedLeave&&D.delayedLeave(),M[tr]=void 0)};Y?A(Y,[M,le]):le()},leave(M,Y){const z=String(t.key);if(M[tr]&&M[tr](!0),n.isUnmounting)return Y();P(p,[M]);let F=!1;const ne=M[co]=le=>{F||(F=!0,Y(),le?P(_,[M]):P(b,[M]),M[co]=void 0,j[z]===t&&delete j[z])};j[z]=t,g?A(g,[M,ne]):ne()},clone(M){return ci(M,e,n,o)}};return D}function Os(t,e){t.shapeFlag&6&&t.component?Os(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Of(t,e=!1,n){let o=[],s=0;for(let r=0;r<t.length;r++){let l=t[r];const a=n==null?l.key:String(n)+String(l.key!=null?l.key:r);l.type===ae?(l.patchFlag&128&&s++,o=o.concat(Of(l.children,e,a))):(e||l.type!==dn)&&o.push(a!=null?Vn(l,{key:a}):l)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}const Im=t=>t.__isTeleport,gs=t=>t&&(t.disabled||t.disabled===""),fu=t=>typeof SVGElement!="undefined"&&t instanceof SVGElement,pu=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,di=(t,e)=>{const n=t&&t.to;return et(n)?e?e(n):null:n},jm={name:"Teleport",__isTeleport:!0,process(t,e,n,o,s,r,l,a,i,u){const{mc:c,pc:f,pbc:p,o:{insert:g,querySelector:b,createText:_,createComment:w}}=u,k=gs(e.props);let{shapeFlag:v,children:h,dynamicChildren:m}=e;if(t==null){const j=e.el=_(""),P=e.anchor=_("");g(j,n,o),g(P,n,o);const A=e.target=di(e.props,b),D=e.targetAnchor=_("");A&&(g(D,A),l==="svg"||fu(A)?l="svg":(l==="mathml"||pu(A))&&(l="mathml"));const M=(Y,z)=>{v&16&&c(h,Y,z,s,r,l,a,i)};k?M(n,P):A&&M(A,D)}else{e.el=t.el;const j=e.anchor=t.anchor,P=e.target=t.target,A=e.targetAnchor=t.targetAnchor,D=gs(t.props),M=D?n:P,Y=D?j:A;if(l==="svg"||fu(P)?l="svg":(l==="mathml"||pu(P))&&(l="mathml"),m?(p(t.dynamicChildren,m,M,s,r,l,a),sa(t,e,!0)):i||f(t,e,M,Y,s,r,l,a,!1),k)D?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):nr(e,n,j,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const z=e.target=di(e.props,b);z&&nr(e,z,null,u,0)}else D&&nr(e,P,A,u,1)}$f(e)},remove(t,e,n,{um:o,o:{remove:s}},r){const{shapeFlag:l,children:a,anchor:i,targetAnchor:u,target:c,props:f}=t;if(c&&s(u),r&&s(i),l&16){const p=r||!gs(f);for(let g=0;g<a.length;g++){const b=a[g];o(b,e,n,p,!!b.dynamicChildren)}}},move:nr,hydrate:Tm};function nr(t,e,n,{o:{insert:o},m:s},r=2){r===0&&o(t.targetAnchor,e,n);const{el:l,anchor:a,shapeFlag:i,children:u,props:c}=t,f=r===2;if(f&&o(l,e,n),(!f||gs(c))&&i&16)for(let p=0;p<u.length;p++)s(u[p],e,n,2);f&&o(a,e,n)}function Tm(t,e,n,o,s,r,{o:{nextSibling:l,parentNode:a,querySelector:i}},u){const c=e.target=di(e.props,i);if(c){const f=c._lpa||c.firstChild;if(e.shapeFlag&16)if(gs(e.props))e.anchor=u(l(t),e,a(t),n,o,s,r),e.targetAnchor=f;else{e.anchor=l(t);let p=f;for(;p;)if(p=l(p),p&&p.nodeType===8&&p.data==="teleport anchor"){e.targetAnchor=p,c._lpa=e.targetAnchor&&l(e.targetAnchor);break}u(f,e,c,n,o,s,r)}$f(e)}return e.anchor&&l(e.anchor)}const Sf=jm;function $f(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n&&n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const ae=Symbol.for("v-fgt"),el=Symbol.for("v-txt"),dn=Symbol.for("v-cmt"),gr=Symbol.for("v-stc"),ms=[];let zt=null;function x(t=!1){ms.push(zt=t?null:[])}function Am(){ms.pop(),zt=ms[ms.length-1]||null}let Ss=1;function hu(t){Ss+=t}function If(t){return t.dynamicChildren=Ss>0?zt||Po:null,Am(),Ss>0&&zt&&zt.push(t),t}function R(t,e,n,o,s,r){return If(d(t,e,n,o,s,r,!0))}function fe(t,e,n,o,s){return If(B(t,e,n,o,s,!0))}function $s(t){return t?t.__v_isVNode===!0:!1}function Zn(t,e){return t.type===e.type&&t.key===e.key}const jf=({key:t})=>t!=null?t:null,mr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?et(t)||_e(t)||Pe(t)?{i:ct,r:t,k:e,f:!!n}:t:null);function d(t,e=null,n=null,o=0,s=null,r=t===ae?0:1,l=!1,a=!1){const i={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&jf(e),ref:e&&mr(e),scopeId:Zr,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ct};return a?(la(i,n),r&128&&t.normalize(i)):n&&(i.shapeFlag|=et(n)?8:16),Ss>0&&!l&&zt&&(i.patchFlag>0||r&6)&&i.patchFlag!==32&&zt.push(i),i}const B=Em;function Em(t,e=null,n=null,o=0,s=null,r=!1){if((!t||t===Yg)&&(t=dn),$s(t)){const a=Vn(t,e,!0);return n&&la(a,n),Ss>0&&!r&&zt&&(a.shapeFlag&6?zt[zt.indexOf(t)]=a:zt.push(a)),a.patchFlag=-2,a}if(Wm(t)&&(t=t.__vccOpts),e){e=Rm(e);let{class:a,style:i}=e;a&&!et(a)&&(e.class=Le(a)),He(i)&&(Qd(i)&&!he(i)&&(i=ot({},i)),e.style=Qe(i))}const l=et(t)?1:si(t)?128:Im(t)?64:He(t)?4:Pe(t)?2:0;return d(t,e,n,o,s,l,r,!0)}function Rm(t){return t?Qd(t)||hf(t)?ot({},t):t:null}function Vn(t,e,n=!1,o=!1){const{props:s,ref:r,patchFlag:l,children:a,transition:i}=t,u=e?Mm(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&jf(u),ref:e&&e.ref?n&&r?he(r)?r.concat(mr(e)):[r,mr(e)]:mr(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ae?l===-1?16:l|16:l,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:i,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Vn(t.ssContent),ssFallback:t.ssFallback&&Vn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return i&&o&&Os(c,i.clone(c)),c}function U(t=" ",e=0){return B(el,null,t,e)}function Bm(t,e){const n=B(gr,null,t);return n.staticCount=e,n}function de(t="",e=!1){return e?(x(),fe(dn,null,t)):B(dn,null,t)}function Jt(t){return t==null||typeof t=="boolean"?B(dn):he(t)?B(ae,null,t.slice()):typeof t=="object"?kn(t):B(el,null,String(t))}function kn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Vn(t)}function la(t,e){let n=0;const{shapeFlag:o}=t;if(e==null)e=null;else if(he(e))n=16;else if(typeof e=="object")if(o&65){const s=e.default;s&&(s._c&&(s._d=!1),la(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!hf(e)?e._ctx=ct:s===3&&ct&&(ct.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Pe(e)?(e={default:e,_ctx:ct},n=32):(e=String(e),o&64?(n=16,e=[U(e)]):n=8);t.children=e,t.shapeFlag|=n}function Mm(...t){const e={};for(let n=0;n<t.length;n++){const o=t[n];for(const s in o)if(s==="class")e.class!==o.class&&(e.class=Le([e.class,o.class]));else if(s==="style")e.style=Qe([e.style,o.style]);else if(Xr(s)){const r=e[s],l=o[s];l&&r!==l&&!(he(r)&&r.includes(l))&&(e[s]=r?[].concat(r,l):l)}else s!==""&&(e[s]=o[s])}return e}function Tt(t,e,n,o=null){Bt(t,e,7,[n,o])}const Dm=df();let Lm=0;function Nm(t,e,n){const o=t.type,s=(e?e.appContext:t.appContext)||Dm,r={uid:Lm++,vnode:t,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Fd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:gf(o,s),emitsOptions:af(o,s),emit:null,emitted:null,propsDefaults:Ge,inheritAttrs:o.inheritAttrs,ctx:Ge,data:Ge,props:Ge,attrs:Ge,slots:Ge,refs:Ge,setupState:Ge,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Ug.bind(null,r),t.ce&&t.ce(r),r}let ut=null;const Tf=()=>ut||ct;let $r,fi;{const t=Md(),e=(n,o)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(o),r=>{s.length>1?s.forEach(l=>l(r)):s[0](r)}};$r=e("__VUE_INSTANCE_SETTERS__",n=>ut=n),fi=e("__VUE_SSR_SETTERS__",n=>Ls=n)}const Ds=t=>{const e=ut;return $r(t),t.scope.on(),()=>{t.scope.off(),$r(e)}},vu=()=>{ut&&ut.scope.off(),$r(null)};function Af(t){return t.vnode.shapeFlag&4}let Ls=!1;function Fm(t,e=!1){e&&fi(e);const{props:n,children:o}=t.vnode,s=Af(t);dm(t,n,s,e),hm(t,o);const r=s?Vm(t,e):void 0;return e&&fi(!1),r}function Vm(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,nm);const{setup:o}=n;if(o){const s=t.setupContext=o.length>1?Um(t):null,r=Ds(t);Wn();const l=Rn(o,t,0,[t.props,s]);if(zn(),r(),Td(l)){if(l.then(vu,vu),e)return l.then(a=>{gu(t,a,e)}).catch(a=>{Ms(a,t,0)});t.asyncDep=l}else gu(t,l,e)}else Ef(t,e)}function gu(t,e,n){Pe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:He(e)&&(t.setupState=nf(e)),Ef(t,n)}let mu;function Ef(t,e,n){const o=t.type;if(!t.render){if(!e&&mu&&!o.render){const s=o.template||na(t).template;if(s){const{isCustomElement:r,compilerOptions:l}=t.appContext.config,{delimiters:a,compilerOptions:i}=o,u=ot(ot({isCustomElement:r,delimiters:a},l),i);o.render=mu(s,u)}}t.render=o.render||Et}{const s=Ds(t);Wn();try{om(t)}finally{zn(),s()}}}const Hm={get(t,e){return yt(t,"get",""),t[e]}};function Um(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Hm),slots:t.slots,emit:t.emit,expose:e}}function tl(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(nf(Eg(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ps)return ps[n](t)},has(e,n){return n in e||n in ps}})):t.proxy}function bu(t,e=!0){return Pe(t)?t.displayName||t.name:t.name||e&&t.__name}function Wm(t){return Pe(t)&&"__vccOpts"in t}const S=(t,e)=>Rg(t,e,Ls);function yu(t,e,n){const o=arguments.length;return o===2?He(e)&&!he(e)?$s(e)?B(t,null,[e]):B(t,e):B(t,null,e):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&$s(n)&&(n=[n]),B(t,e,n))}const zm="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const Gm="http://www.w3.org/2000/svg",Xm="http://www.w3.org/1998/Math/MathML",ln=typeof document!="undefined"?document:null,_u=ln&&ln.createElement("template"),Ym={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,o)=>{const s=e==="svg"?ln.createElementNS(Gm,t):e==="mathml"?ln.createElementNS(Xm,t):n?ln.createElement(t,{is:n}):ln.createElement(t);return t==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:t=>ln.createTextNode(t),createComment:t=>ln.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ln.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,o,s,r){const l=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{_u.innerHTML=o==="svg"?`<svg>${t}</svg>`:o==="mathml"?`<math>${t}</math>`:t;const a=_u.content;if(o==="svg"||o==="mathml"){const i=a.firstChild;for(;i.firstChild;)a.appendChild(i.firstChild);a.removeChild(i)}e.insertBefore(a,n)}return[l?l.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},vn="transition",Qo="animation",Io=Symbol("_vtc"),Rf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},qm=ot({},Sm,Rf),Yn=(t,e=[])=>{he(t)?t.forEach(n=>n(...e)):t&&t(...e)},wu=t=>t?he(t)?t.some(e=>e.length>1):t.length>1:!1;function Km(t){const e={};for(const F in t)F in Rf||(e[F]=t[F]);if(t.css===!1)return e;const{name:n="v",type:o,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:i=r,appearActiveClass:u=l,appearToClass:c=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,b=Jm(s),_=b&&b[0],w=b&&b[1],{onBeforeEnter:k,onEnter:v,onEnterCancelled:h,onLeave:m,onLeaveCancelled:j,onBeforeAppear:P=k,onAppear:A=v,onAppearCancelled:D=h}=e,M=(F,ne,le)=>{Cn(F,ne?c:a),Cn(F,ne?u:l),le&&le()},Y=(F,ne)=>{F._isLeaving=!1,Cn(F,f),Cn(F,g),Cn(F,p),ne&&ne()},z=F=>(ne,le)=>{const q=F?A:v,I=()=>M(ne,F,le);Yn(q,[ne,I]),Pu(()=>{Cn(ne,F?i:r),rn(ne,F?c:a),wu(q)||Cu(ne,o,_,I)})};return ot(e,{onBeforeEnter(F){Yn(k,[F]),rn(F,r),rn(F,l)},onBeforeAppear(F){Yn(P,[F]),rn(F,i),rn(F,u)},onEnter:z(!1),onAppear:z(!0),onLeave(F,ne){F._isLeaving=!0;const le=()=>Y(F,ne);rn(F,f),rn(F,p),Mf(),Pu(()=>{F._isLeaving&&(Cn(F,f),rn(F,g),wu(m)||Cu(F,o,w,le))}),Yn(m,[F,le])},onEnterCancelled(F){M(F,!1),Yn(h,[F])},onAppearCancelled(F){M(F,!0),Yn(D,[F])},onLeaveCancelled(F){Y(F),Yn(j,[F])}})}function Jm(t){if(t==null)return null;if(He(t))return[Al(t.enter),Al(t.leave)];{const e=Al(t);return[e,e]}}function Al(t){return ng(t)}function rn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Io]||(t[Io]=new Set)).add(e)}function Cn(t,e){e.split(/\s+/).forEach(o=>o&&t.classList.remove(o));const n=t[Io];n&&(n.delete(e),n.size||(t[Io]=void 0))}function Pu(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Zm=0;function Cu(t,e,n,o){const s=t._endId=++Zm,r=()=>{s===t._endId&&o()};if(n)return setTimeout(r,n);const{type:l,timeout:a,propCount:i}=Bf(t,e);if(!l)return o();const u=l+"end";let c=0;const f=()=>{t.removeEventListener(u,p),r()},p=g=>{g.target===t&&++c>=i&&f()};setTimeout(()=>{c<i&&f()},a+1),t.addEventListener(u,p)}function Bf(t,e){const n=window.getComputedStyle(t),o=b=>(n[b]||"").split(", "),s=o(`${vn}Delay`),r=o(`${vn}Duration`),l=xu(s,r),a=o(`${Qo}Delay`),i=o(`${Qo}Duration`),u=xu(a,i);let c=null,f=0,p=0;e===vn?l>0&&(c=vn,f=l,p=r.length):e===Qo?u>0&&(c=Qo,f=u,p=i.length):(f=Math.max(l,u),c=f>0?l>u?vn:Qo:null,p=c?c===vn?r.length:i.length:0);const g=c===vn&&/\b(transform|all)(,|$)/.test(o(`${vn}Property`).toString());return{type:c,timeout:f,propCount:p,hasTransform:g}}function xu(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,o)=>ku(n)+ku(t[o])))}function ku(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Mf(){return document.body.offsetHeight}function Qm(t,e,n){const o=t[Io];o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Ou=Symbol("_vod"),eb=Symbol("_vsh"),tb=Symbol(""),nb=/(^|;)\s*display\s*:/;function ob(t,e,n){const o=t.style,s=et(n);let r=!1;if(n&&!s){if(e)if(et(e))for(const l of e.split(";")){const a=l.slice(0,l.indexOf(":")).trim();n[a]==null&&br(o,a,"")}else for(const l in e)n[l]==null&&br(o,l,"");for(const l in n)l==="display"&&(r=!0),br(o,l,n[l])}else if(s){if(e!==n){const l=o[tb];l&&(n+=";"+l),o.cssText=n,r=nb.test(n)}}else e&&t.removeAttribute("style");Ou in t&&(t[Ou]=r?o.display:"",t[eb]&&(o.display="none"))}const Su=/\s*!important$/;function br(t,e,n){if(he(n))n.forEach(o=>br(t,e,o));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const o=sb(t,e);Su.test(n)?t.setProperty(lo(o),n.replace(Su,""),"important"):t[o]=n}}const $u=["Webkit","Moz","ms"],El={};function sb(t,e){const n=El[e];if(n)return n;let o=$o(e);if(o!=="filter"&&o in t)return El[e]=o;o=Rd(o);for(let s=0;s<$u.length;s++){const r=$u[s]+o;if(r in t)return El[e]=r}return e}const Iu="http://www.w3.org/1999/xlink";function ju(t,e,n,o,s,r=ag(e)){o&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Iu,e.slice(6,e.length)):t.setAttributeNS(Iu,e,n):n==null||r&&!Dd(n)?t.removeAttribute(e):t.setAttribute(e,r?"":tn(n)?String(n):n)}function rb(t,e,n,o,s,r,l){if(e==="innerHTML"||e==="textContent"){o&&l(o,s,r),t[e]=n==null?"":n;return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const u=a==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?"":String(n);(u!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let i=!1;if(n===""||n==null){const u=typeof t[e];u==="boolean"?n=Dd(n):n==null&&u==="string"?(n="",i=!0):u==="number"&&(n=0,i=!0)}try{t[e]=n}catch(u){}i&&t.removeAttribute(e)}function $n(t,e,n,o){t.addEventListener(e,n,o)}function lb(t,e,n,o){t.removeEventListener(e,n,o)}const Tu=Symbol("_vei");function ib(t,e,n,o,s=null){const r=t[Tu]||(t[Tu]={}),l=r[e];if(o&&l)l.value=o;else{const[a,i]=ab(e);if(o){const u=r[e]=db(o,s);$n(t,a,u,i)}else l&&(lb(t,a,l,i),r[e]=void 0)}}const Au=/(?:Once|Passive|Capture)$/;function ab(t){let e;if(Au.test(t)){e={};let o;for(;o=t.match(Au);)t=t.slice(0,t.length-o[0].length),e[o[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):lo(t.slice(2)),e]}let Rl=0;const ub=Promise.resolve(),cb=()=>Rl||(ub.then(()=>Rl=0),Rl=Date.now());function db(t,e){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;Bt(fb(o,n.value),e,5,[o])};return n.value=t,n.attached=cb(),n}function fb(t,e){if(he(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(o=>s=>!s._stopped&&o&&o(s))}else return e}const Eu=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,pb=(t,e,n,o,s,r,l,a,i)=>{const u=s==="svg";e==="class"?Qm(t,o,u):e==="style"?ob(t,n,o):Xr(e)?Hi(e)||ib(t,e,n,o,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):hb(t,e,o,u))?(rb(t,e,o,r,l,a,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ju(t,e,o,u,l,e!=="value")):(e==="true-value"?t._trueValue=o:e==="false-value"&&(t._falseValue=o),ju(t,e,o,u))};function hb(t,e,n,o){if(o)return!!(e==="innerHTML"||e==="textContent"||e in t&&Eu(e)&&Pe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Eu(e)&&et(n)?!1:e in t}const Df=new WeakMap,Lf=new WeakMap,Ir=Symbol("_moveCb"),Ru=Symbol("_enterCb"),Nf={name:"TransitionGroup",props:ot({},qm,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Tf(),o=Om();let s,r;return ea(()=>{if(!s.length)return;const l=t.moveClass||`${t.name||"v"}-move`;if(!yb(s[0].el,n.vnode.el,l))return;s.forEach(gb),s.forEach(mb);const a=s.filter(bb);Mf(),a.forEach(i=>{const u=i.el,c=u.style;rn(u,l),c.transform=c.webkitTransform=c.transitionDuration="";const f=u[Ir]=p=>{p&&p.target!==u||(!p||/transform$/.test(p.propertyName))&&(u.removeEventListener("transitionend",f),u[Ir]=null,Cn(u,l))};u.addEventListener("transitionend",f)})}),()=>{const l=Be(t),a=Km(l);let i=l.tag||ae;if(s=[],r)for(let u=0;u<r.length;u++){const c=r[u];c.el&&c.el instanceof Element&&(s.push(c),Os(c,ci(c,a,o,n)),Df.set(c,c.el.getBoundingClientRect()))}r=e.default?Of(e.default()):[];for(let u=0;u<r.length;u++){const c=r[u];c.key!=null&&Os(c,ci(c,a,o,n))}return B(i,null,r)}}},vb=t=>delete t.mode;Nf.props;const HT=Nf;function gb(t){const e=t.el;e[Ir]&&e[Ir](),e[Ru]&&e[Ru]()}function mb(t){Lf.set(t,t.el.getBoundingClientRect())}function bb(t){const e=Df.get(t),n=Lf.get(t),o=e.left-n.left,s=e.top-n.top;if(o||s){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",t}}function yb(t,e,n){const o=t.cloneNode(),s=t[Io];s&&s.forEach(a=>{a.split(/\s+/).forEach(i=>i&&o.classList.remove(i))}),n.split(/\s+/).forEach(a=>a&&o.classList.add(a)),o.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(o);const{hasTransform:l}=Bf(o);return r.removeChild(o),l}const jo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return he(e)?n=>xo(e,n):e};function _b(t){t.target.composing=!0}function Bu(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const cn=Symbol("_assign"),Ke={created(t,{modifiers:{lazy:e,trim:n,number:o}},s){t[cn]=jo(s);const r=o||s.props&&s.props.type==="number";$n(t,e?"change":"input",l=>{if(l.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Cr(a)),t[cn](a)}),n&&$n(t,"change",()=>{t.value=t.value.trim()}),e||($n(t,"compositionstart",_b),$n(t,"compositionend",Bu),$n(t,"change",Bu))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:o,trim:s,number:r}},l){if(t[cn]=jo(l),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Cr(t.value):t.value,i=e==null?"":e;a!==i&&(document.activeElement===t&&t.type!=="range"&&(o&&e===n||s&&t.value.trim()===i)||(t.value=i))}},wb={deep:!0,created(t,e,n){t[cn]=jo(n),$n(t,"change",()=>{const o=t._modelValue,s=Is(t),r=t.checked,l=t[cn];if(he(o)){const a=zi(o,s),i=a!==-1;if(r&&!i)l(o.concat(s));else if(!r&&i){const u=[...o];u.splice(a,1),l(u)}}else if(Ho(o)){const a=new Set(o);r?a.add(s):a.delete(s),l(a)}else l(Ff(t,r))})},mounted:Mu,beforeUpdate(t,e,n){t[cn]=jo(n),Mu(t,e,n)}};function Mu(t,{value:e,oldValue:n},o){t._modelValue=e,he(e)?t.checked=zi(e,o.props.value)>-1:Ho(e)?t.checked=e.has(o.props.value):e!==n&&(t.checked=Bs(e,Ff(t,!0)))}const $t={deep:!0,created(t,{value:e,modifiers:{number:n}},o){const s=Ho(e);$n(t,"change",()=>{const r=Array.prototype.filter.call(t.options,l=>l.selected).map(l=>n?Cr(Is(l)):Is(l));t[cn](t.multiple?s?new Set(r):r:r[0]),t._assigning=!0,Bn(()=>{t._assigning=!1})}),t[cn]=jo(o)},mounted(t,{value:e,modifiers:{number:n}}){Du(t,e)},beforeUpdate(t,e,n){t[cn]=jo(n)},updated(t,{value:e,modifiers:{number:n}}){t._assigning||Du(t,e)}};function Du(t,e,n){const o=t.multiple,s=he(e);if(!(o&&!s&&!Ho(e))){for(let r=0,l=t.options.length;r<l;r++){const a=t.options[r],i=Is(a);if(o)if(s){const u=typeof i;u==="string"||u==="number"?a.selected=e.some(c=>String(c)===String(i)):a.selected=zi(e,i)>-1}else a.selected=e.has(i);else if(Bs(Is(a),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!o&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Is(t){return"_value"in t?t._value:t.value}function Ff(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const Pb=["ctrl","shift","alt","meta"],Cb={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Pb.some(n=>t[`${n}Key`]&&!e.includes(n))},ce=(t,e)=>{const n=t._withMods||(t._withMods={}),o=e.join(".");return n[o]||(n[o]=(s,...r)=>{for(let l=0;l<e.length;l++){const a=Cb[e[l]];if(a&&a(s,e))return}return t(s,...r)})},xb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},lt=(t,e)=>{const n=t._withKeys||(t._withKeys={}),o=e.join(".");return n[o]||(n[o]=s=>{if(!("key"in s))return;const r=lo(s.key);if(e.some(l=>l===r||xb[l]===r))return t(s)})},kb=ot({patchProp:pb},Ym);let Lu;function Ob(){return Lu||(Lu=gm(kb))}const Sb=(...t)=>{const e=Ob().createApp(...t),{mount:n}=e;return e.mount=o=>{const s=Ib(o);if(!s)return;const r=e._component;!Pe(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";const l=n(s,!1,$b(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},e};function $b(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Ib(t){return et(t)?document.querySelector(t):t}const jb="modulepreload",Tb=function(t,e){return new URL(t,e).href},Nu={},Fu=function(e,n,o){let s=Promise.resolve();if(n&&n.length>0){const r=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),a=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.all(n.map(i=>{if(i=Tb(i,o),i in Nu)return;Nu[i]=!0;const u=i.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!o)for(let g=r.length-1;g>=0;g--){const b=r[g];if(b.href===i&&(!u||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${c}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":jb,u||(p.as="script",p.crossOrigin=""),p.href=i,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((g,b)=>{p.addEventListener("load",g),p.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${i}`)))})}))}return s.then(()=>e()).catch(r=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r})};function Ab(t){return{all:t=t||new Map,on:function(e,n){var o=t.get(e);o?o.push(n):t.set(e,[n])},off:function(e,n){var o=t.get(e);o&&(n?o.splice(o.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var o=t.get(e);o&&o.slice().map(function(s){s(n)}),(o=t.get("*"))&&o.slice().map(function(s){s(e,n)})}}}var Eb=Object.defineProperty,Rb=(t,e,n)=>e in t?Eb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rt=(t,e,n)=>Rb(t,e+"",n);const Bl=Ab(),Te={fire(t){Bl.emit(t.kind,t)},subscribe(t,e){Bl.on(t.kind,e)},unsubscribe(t,e){Bl.off(t.kind,e)}};class jr{constructor(e){this.path=e,rt(this,"kind","AssetFailureEvent")}}rt(jr,"kind","AssetFailureEvent");class js{constructor(e){this.message=e,rt(this,"kind","FailureEvent")}}rt(js,"kind","FailureEvent");class Vf{constructor(e){this.error=e,rt(this,"kind","CustomAssetFailureEvent")}}rt(Vf,"kind","CustomAssetFailureEvent");class nl{constructor(){rt(this,"kind","InvalidateRenderEvent")}}rt(nl,"kind","InvalidateRenderEvent");const Hf=class Uf{constructor(){rt(this,"kind",Uf.kind)}};rt(Hf,"kind","RenderUpdatedEvent");let Wf=Hf;const zf=class Gf{constructor(){rt(this,"kind",Gf.kind)}};rt(zf,"kind","StateLoadingEvent");let Xf=zf;class At{constructor(e){this.message=e,rt(this,"kind","ShowMessageEvent")}}rt(At,"kind","ShowMessageEvent");class ia{constructor(e,n){this.message=e,this.actions=n,rt(this,"kind","ResolvableErrorEvent")}}rt(ia,"kind","ResolvableErrorEvent");class Tr{constructor(e){this.color=e,rt(this,"kind","ColorPickedEvent")}}rt(Tr,"kind","ColorPickedEvent");class Yf{constructor(e,n){this.error=e,this.info=n,rt(this,"kind","VueErrorEvent")}}rt(Yf,"kind","VueErrorEvent");const Bb="./",aa="/dddg-assets/v2/assets/",vt=`${Bb}packs/`,Mb=!0,ua=!0,ca={"dddg.buildin.backgrounds.nsfw":`${vt}buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${vt}buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${vt}buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${vt}buildin.base.yuri.nsfw.json`},Db=new Set(Object.keys(ca)),Lb=Object.values(ca);function Nb(){return qf().__VUE_DEVTOOLS_GLOBAL_HOOK__}function qf(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const Fb=typeof Proxy=="function",Vb="devtools-plugin:setup",Hb="plugin:settings:set";let fo,pi;function Ub(){var t;return fo!==void 0||(typeof window!="undefined"&&window.performance?(fo=!0,pi=window.performance):typeof global!="undefined"&&(!((t=global.perf_hooks)===null||t===void 0)&&t.performance)?(fo=!0,pi=global.perf_hooks.performance):fo=!1),fo}function Wb(){return Ub()?pi.now():Date.now()}class zb{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const o={};if(e.settings)for(const l in e.settings){const a=e.settings[l];o[l]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${e.id}`;let r=Object.assign({},o);try{const l=localStorage.getItem(s),a=JSON.parse(l);Object.assign(r,a)}catch(l){}this.fallbacks={getSettings(){return r},setSettings(l){try{localStorage.setItem(s,JSON.stringify(l))}catch(a){}r=l},now(){return Wb()}},n&&n.on(Hb,(l,a)=>{l===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(l,a)=>this.target?this.target.on[a]:(...i)=>{this.onQueue.push({method:a,args:i})}}),this.proxiedTarget=new Proxy({},{get:(l,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...i)=>(this.targetQueue.push({method:a,args:i,resolve:()=>{}}),this.fallbacks[a](...i)):(...i)=>new Promise(u=>{this.targetQueue.push({method:a,args:i,resolve:u})})})}setRealTarget(e){return za(this,null,function*(){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(yield this.target[n.method](...n.args))})}}function Gb(t,e){const n=t,o=qf(),s=Nb(),r=Fb&&n.enableEarlyProxy;if(s&&(o.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!r))s.emit(Vb,t,e);else{const l=r?new zb(n,s):null;(o.__VUE_DEVTOOLS_PLUGINS__=o.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:l}),l&&e(l.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var Kf="store";function Xb(t){return t===void 0&&(t=null),vs(t!==null?t:Kf)}function Wo(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function Yb(t){return t!==null&&typeof t=="object"}function qb(t){return t&&typeof t.then=="function"}function Kb(t,e){return function(){return t(e)}}function Jf(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var o=e.indexOf(t);o>-1&&e.splice(o,1)}}function Zf(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;ol(t,n,[],t._modules.root,!0),da(t,n,e)}function da(t,e,n){var o=t._state,s=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var r=t._wrappedGetters,l={},a={},i=cg(!0);i.run(function(){Wo(r,function(u,c){l[c]=Kb(u,t),a[c]=S(function(){return l[c]()}),Object.defineProperty(t.getters,c,{get:function(){return a[c].value},enumerable:!0})})}),t._state=Fn({data:e}),t._scope=i,t.strict&&ty(t),o&&n&&t._withCommit(function(){o.data=null}),s&&s.stop()}function ol(t,e,n,o,s){var r=!n.length,l=t._modules.getNamespace(n);if(o.namespaced&&(t._modulesNamespaceMap[l],t._modulesNamespaceMap[l]=o),!r&&!s){var a=fa(e,n.slice(0,-1)),i=n[n.length-1];t._withCommit(function(){a[i]=o.state})}var u=o.context=Jb(t,l,n);o.forEachMutation(function(c,f){var p=l+f;Zb(t,p,c,u)}),o.forEachAction(function(c,f){var p=c.root?f:l+f,g=c.handler||c;Qb(t,p,g,u)}),o.forEachGetter(function(c,f){var p=l+f;ey(t,p,c,u)}),o.forEachChild(function(c,f){ol(t,e,n.concat(f),c,s)})}function Jb(t,e,n){var o=e==="",s={dispatch:o?t.dispatch:function(r,l,a){var i=Ar(r,l,a),u=i.payload,c=i.options,f=i.type;return(!c||!c.root)&&(f=e+f),t.dispatch(f,u)},commit:o?t.commit:function(r,l,a){var i=Ar(r,l,a),u=i.payload,c=i.options,f=i.type;(!c||!c.root)&&(f=e+f),t.commit(f,u,c)}};return Object.defineProperties(s,{getters:{get:o?function(){return t.getters}:function(){return Qf(t,e)}},state:{get:function(){return fa(t.state,n)}}}),s}function Qf(t,e){if(!t._makeLocalGettersCache[e]){var n={},o=e.length;Object.keys(t.getters).forEach(function(s){if(s.slice(0,o)===e){var r=s.slice(o);Object.defineProperty(n,r,{get:function(){return t.getters[s]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function Zb(t,e,n,o){var s=t._mutations[e]||(t._mutations[e]=[]);s.push(function(l){n.call(t,o.state,l)})}function Qb(t,e,n,o){var s=t._actions[e]||(t._actions[e]=[]);s.push(function(l){var a=n.call(t,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:t.getters,rootState:t.state},l);return qb(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(i){throw t._devtoolHook.emit("vuex:error",i),i}):a})}function ey(t,e,n,o){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(r){return n(o.state,o.getters,r.state,r.getters)})}function ty(t){We(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function fa(t,e){return e.reduce(function(n,o){return n[o]},t)}function Ar(t,e,n){return Yb(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var ny="vuex bindings",Vu="vuex:mutations",Ml="vuex:actions",po="vuex",oy=0;function sy(t,e){Gb({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[ny]},function(n){n.addTimelineLayer({id:Vu,label:"Vuex Mutations",color:Hu}),n.addTimelineLayer({id:Ml,label:"Vuex Actions",color:Hu}),n.addInspector({id:po,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(o){if(o.app===t&&o.inspectorId===po)if(o.filter){var s=[];op(s,e._modules.root,o.filter,""),o.rootNodes=s}else o.rootNodes=[np(e._modules.root,"")]}),n.on.getInspectorState(function(o){if(o.app===t&&o.inspectorId===po){var s=o.nodeId;Qf(e,s),o.state=iy(uy(e._modules,s),s==="root"?e.getters:e._makeLocalGettersCache,s)}}),n.on.editInspectorState(function(o){if(o.app===t&&o.inspectorId===po){var s=o.nodeId,r=o.path;s!=="root"&&(r=s.split("/").filter(Boolean).concat(r)),e._withCommit(function(){o.set(e._state.data,r,o.state.value)})}}),e.subscribe(function(o,s){var r={};o.payload&&(r.payload=o.payload),r.state=s,n.notifyComponentUpdate(),n.sendInspectorTree(po),n.sendInspectorState(po),n.addTimelineEvent({layerId:Vu,event:{time:Date.now(),title:o.type,data:r}})}),e.subscribeAction({before:function(o,s){var r={};o.payload&&(r.payload=o.payload),o._id=oy++,o._time=Date.now(),r.state=s,n.addTimelineEvent({layerId:Ml,event:{time:o._time,title:o.type,groupId:o._id,subtitle:"start",data:r}})},after:function(o,s){var r={},l=Date.now()-o._time;r.duration={_custom:{type:"duration",display:l+"ms",tooltip:"Action duration",value:l}},o.payload&&(r.payload=o.payload),r.state=s,n.addTimelineEvent({layerId:Ml,event:{time:Date.now(),title:o.type,groupId:o._id,subtitle:"end",data:r}})}})})}var Hu=8702998,ry=6710886,ly=16777215,ep={label:"namespaced",textColor:ly,backgroundColor:ry};function tp(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function np(t,e){return{id:e||"root",label:tp(e),tags:t.namespaced?[ep]:[],children:Object.keys(t._children).map(function(n){return np(t._children[n],e+n+"/")})}}function op(t,e,n,o){o.includes(n)&&t.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:e.namespaced?[ep]:[]}),Object.keys(e._children).forEach(function(s){op(t,e._children[s],n,o+s+"/")})}function iy(t,e,n){e=n==="root"?e:e[n];var o=Object.keys(e),s={state:Object.keys(t.state).map(function(l){return{key:l,editable:!0,value:t.state[l]}})};if(o.length){var r=ay(e);s.getters=Object.keys(r).map(function(l){return{key:l.endsWith("/")?tp(l):l,editable:!1,value:hi(function(){return r[l]})}})}return s}function ay(t){var e={};return Object.keys(t).forEach(function(n){var o=n.split("/");if(o.length>1){var s=e,r=o.pop();o.forEach(function(l){s[l]||(s[l]={_custom:{value:{},display:l,tooltip:"Module",abstract:!0}}),s=s[l]._custom.value}),s[r]=hi(function(){return t[n]})}else e[n]=hi(function(){return t[n]})}),e}function uy(t,e){var n=e.split("/").filter(function(o){return o});return n.reduce(function(o,s,r){var l=o[s];if(!l)throw new Error('Missing module "'+s+'" for path "'+e+'".');return r===n.length-1?l:l._children},e==="root"?t:t.root._children)}function hi(t){try{return t()}catch(e){return e}}var Xt=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var o=e.state;this.state=(typeof o=="function"?o():o)||{}},sp={namespaced:{configurable:!0}};sp.namespaced.get=function(){return!!this._rawModule.namespaced};Xt.prototype.addChild=function(e,n){this._children[e]=n};Xt.prototype.removeChild=function(e){delete this._children[e]};Xt.prototype.getChild=function(e){return this._children[e]};Xt.prototype.hasChild=function(e){return e in this._children};Xt.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};Xt.prototype.forEachChild=function(e){Wo(this._children,e)};Xt.prototype.forEachGetter=function(e){this._rawModule.getters&&Wo(this._rawModule.getters,e)};Xt.prototype.forEachAction=function(e){this._rawModule.actions&&Wo(this._rawModule.actions,e)};Xt.prototype.forEachMutation=function(e){this._rawModule.mutations&&Wo(this._rawModule.mutations,e)};Object.defineProperties(Xt.prototype,sp);var io=function(e){this.register([],e,!1)};io.prototype.get=function(e){return e.reduce(function(n,o){return n.getChild(o)},this.root)};io.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(o,s){return n=n.getChild(s),o+(n.namespaced?s+"/":"")},"")};io.prototype.update=function(e){rp([],this.root,e)};io.prototype.register=function(e,n,o){var s=this;o===void 0&&(o=!0);var r=new Xt(n,o);if(e.length===0)this.root=r;else{var l=this.get(e.slice(0,-1));l.addChild(e[e.length-1],r)}n.modules&&Wo(n.modules,function(a,i){s.register(e.concat(i),a,o)})};io.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1],s=n.getChild(o);s&&s.runtime&&n.removeChild(o)};io.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1];return n?n.hasChild(o):!1};function rp(t,e,n){if(e.update(n),n.modules)for(var o in n.modules){if(!e.getChild(o))return;rp(t.concat(o),e.getChild(o),n.modules[o])}}function cy(t){return new Pt(t)}var Pt=function(e){var n=this;e===void 0&&(e={});var o=e.plugins;o===void 0&&(o=[]);var s=e.strict;s===void 0&&(s=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new io(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=r;var l=this,a=this,i=a.dispatch,u=a.commit;this.dispatch=function(p,g){return i.call(l,p,g)},this.commit=function(p,g,b){return u.call(l,p,g,b)},this.strict=s;var c=this._modules.root.state;ol(this,c,[],this._modules.root),da(this,c),o.forEach(function(f){return f(n)})},pa={state:{configurable:!0}};Pt.prototype.install=function(e,n){e.provide(n||Kf,this),e.config.globalProperties.$store=this;var o=this._devtools!==void 0?this._devtools:!1;o&&sy(e,this)};pa.state.get=function(){return this._state.data};pa.state.set=function(t){};Pt.prototype.commit=function(e,n,o){var s=this,r=Ar(e,n,o),l=r.type,a=r.payload,i={type:l,payload:a},u=this._mutations[l];u&&(this._withCommit(function(){u.forEach(function(f){f(a)})}),this._subscribers.slice().forEach(function(c){return c(i,s.state)}))};Pt.prototype.dispatch=function(e,n){var o=this,s=Ar(e,n),r=s.type,l=s.payload,a={type:r,payload:l},i=this._actions[r];if(i){try{this._actionSubscribers.slice().filter(function(c){return c.before}).forEach(function(c){return c.before(a,o.state)})}catch(c){}var u=i.length>1?Promise.all(i.map(function(c){return c(l)})):i[0](l);return new Promise(function(c,f){u.then(function(p){try{o._actionSubscribers.filter(function(g){return g.after}).forEach(function(g){return g.after(a,o.state)})}catch(g){}c(p)},function(p){try{o._actionSubscribers.filter(function(g){return g.error}).forEach(function(g){return g.error(a,o.state,p)})}catch(g){}f(p)})})}};Pt.prototype.subscribe=function(e,n){return Jf(e,this._subscribers,n)};Pt.prototype.subscribeAction=function(e,n){var o=typeof e=="function"?{before:e}:e;return Jf(o,this._actionSubscribers,n)};Pt.prototype.watch=function(e,n,o){var s=this;return We(function(){return e(s.state,s.getters)},n,Object.assign({},o))};Pt.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};Pt.prototype.registerModule=function(e,n,o){o===void 0&&(o={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),ol(this,this.state,e,this._modules.get(e),o.preserveState),da(this,this.state)};Pt.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var o=fa(n.state,e.slice(0,-1));delete o[e[e.length-1]]}),Zf(this)};Pt.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Pt.prototype.hotUpdate=function(e){this._modules.update(e),Zf(this,!0)};Pt.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(Pt.prototype,pa);var dy=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Z=lp();function lp(){const t=[];let e=!1;return function(o){return new Promise(s=>{const r=()=>dy(this,null,function*(){try{o.length>0?yield o(lp()):yield o()}catch(l){console.log("Error during transaction!: ",l)}finally{e=!1}t.length>0&&t.shift()(),s()});e?t.push(r):r()})}}var fy=Object.defineProperty,Uu=Object.getOwnPropertySymbols,py=Object.prototype.hasOwnProperty,hy=Object.prototype.propertyIsEnumerable,vi=(t,e,n)=>e in t?fy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gi=(t,e)=>{for(var n in e||(e={}))py.call(e,n)&&vi(t,n,e[n]);if(Uu)for(var n of Uu(e))hy.call(e,n)&&vi(t,n,e[n]);return t},Vt=(t,e,n)=>vi(t,typeof e!="symbol"?e+"":e,n),Ye=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Er=navigator.userAgent,vy=!!Er.match(/iPad/i)||!!Er.match(/iPhone/i),gy=!!Er.match(/WebKit/i),Wu=vy&&gy&&!Er.match(/CriOS/i);class ip{constructor(){Vt(this,"state",Fn({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder",hasTemplate:!1})),Vt(this,"supports"),Vt(this,"_gameMode",null),Vt(this,"$store",null),Vt(this,"isSavingEnabled",L(!1)),Vt(this,"localRepositoryUrl",""),Vt(this,"loading"),Vt(this,"creatingDB"),Vt(this,"loadingContentPacksAllowed"),Vt(this,"loadContentPacks"),Vt(this,"updateProgress",null);const e=this,n=Je.canSave();window.addEventListener("beforeunload",function(o){o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise(o=>{this.loadContentPacks=()=>o()}),this.supports=Fn({optionalSaving:n,get autoLoading(){return n&&e.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!Wu,allowWebP:!0,limitedCanvasSpace:Wu}),n?this.loading=Ye(this,null,function*(){this.savingEnabled=yield Je.doesDbExists()}):this.loading=Promise.resolve(),this.loading.then(()=>Ye(this,null,function*(){var o;if(yield this.loadingContentPacksAllowed,this.creatingDB&&(yield this.creatingDB),this.savingEnabled){const s=(o=yield Je.loadAutoload())!=null?o:[];this.state.autoAdd=s;const r=yield Ro.getInstance(),l=yield Promise.all(s.map(a=>Ye(this,null,function*(){var i;const[u,c]=a.split(";",2);c!=null&&!r.hasPack(u)&&(yield r.loadTempPack(c));const f=r.getPack(u);return(i=f.dddg2Path)!=null?i:f.dddg1Path})));yield Z(()=>Ye(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",l)}))}}))}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(e){e?(localStorage.setItem("saving","true"),this.creatingDB=Je.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=Je.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}loadGameMode(){return Ye(this,null,function*(){const n=new URLSearchParams(location.search).get("mode");if(n==="ddlc"||n==="ddlc_plus"){this._gameMode=n;return}yield this.loading,yield this.creatingDB;let o="";this.isSavingEnabled.value&&(o=yield Je.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s})}setGameMode(e){return Ye(this,null,function*(){this.isSavingEnabled.value&&(yield Je.saveGameMode(e));const n=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${n}?mode=${e}`})}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(){throw new Error("Method not implemented.")}connectToStore(e){this.$store=e}saveToFile(e,n,o="image/png",s=1){return Ye(this,null,function*(){const r=document.createElement("a");r.setAttribute("download",n);const l=yield this.createObjectURL(e,o,s);return r.setAttribute("href",l),document.body.appendChild(r),r.click(),document.body.removeChild(r),l})}localRepoInstall(){return Promise.reject(new Error("This environment does not support a local repository"))}localRepoUninstall(){throw new Error("This environment does not support a local repository")}autoLoadAdd(e){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB,yield Je.saveAutoload([...this.state.autoAdd,e]),this.state.autoAdd.push(e)})}autoLoadRemove(e){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB;const n=this.normalizePackId(e);yield Je.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=n));const o=this.state.autoAdd.indexOf(e);this.state.autoAdd.splice(o,1)})}normalizePackId(e){const n=e.split(";");return n.length===1?n[0]:n[n.length-1]}loadSettings(){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB;const e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?gi(gi({},e),yield Je.loadSettings()):e})}saveSettings(e){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield Je.saveSettings(e))})}loadDefaultTemplate(){return Ye(this,null,function*(){var e;if(yield this.loading,yield this.creatingDB,!this.isSavingEnabled.value)return!1;const n=yield Je.loadTemplate();return n==null?!1:(this.state.hasTemplate=!0,yield(e=this.$store)==null?void 0:e.dispatch("loadSave",n),!0)})}saveDefaultTemplate(){return Ye(this,null,function*(){var e;if(yield this.loading,yield this.creatingDB,!this.isSavingEnabled.value)return;const n=yield(e=this.$store)==null?void 0:e.dispatch("getSave",!0);Je.saveTemplate(n),this.state.hasTemplate=!0})}clearDefaultTemplate(){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield Je.saveTemplate(null),this.state.hasTemplate=!1)})}isInitialized(){return Ye(this,null,function*(){yield this.loading,yield this.creatingDB})}prompt(e,n){return new Promise(o=>{o(prompt(e,n))})}onPanelChange(){}createObjectURL(e,n,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(e.toDataURL(n,o));if(e.toBlob!=null)e.toBlob(a=>{if(!a){r();return}s(URL.createObjectURL(a))},n,o);else{const a=e.toDataURL(n,o),i=this.dataURItoBlob(a,n);s(URL.createObjectURL(i))}})}dataURItoBlob(e,n){const o=atob(e.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let l=0;l<s;l++)r[l]=o.charCodeAt(l);return new Blob([r],{type:n})}}const Je={indexedDB:(()=>{var t,e,n,o;try{return(o=(n=(e=(t=window.indexedDB)!=null?t:window.mozIndexedDB)!=null?e:window.webkitIndexedDB)!=null?n:window.msIndexedDB)!=null?o:null}catch(s){return null}})(),transaction:(()=>{var t,e,n,o;try{return(o=(n=(e=(t=window.IDBTransaction)!=null?t:window.mozIDBTransaction)!=null?e:window.webkitIDBTransaction)!=null?n:window.msIDBTransaction)!=null?o:null}catch(s){return null}})(),db:null,canSave(){return!!(Je.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return Je.db?Je.db:Je.db=new Promise((t,e)=>{const n=Je.indexedDB.open("dddg",3);n.onerror=o=>{e(o)},n.onupgradeneeded=o=>{var s;const r=n.result,l=(s=o.oldVersion)!=null?s:o.version;l<1&&r.createObjectStore("settings"),l===1&&(r.deleteObjectStore("settings"),r.createObjectStore("settings"))},n.onsuccess=()=>{t(n.result)}})},clearDB(){return new Promise((t,e)=>{if(!Je.db){t();return}const n=Je.indexedDB.deleteDatabase("dddg");Je.db=null,n.onerror=o=>{e(o)},n.onsuccess=()=>{t()}})},loadAutoload(){return this.objectStorePromise("readonly",t=>Ye(this,null,function*(){return yield this.reqPromise(t.get("autoload"))}))},saveAutoload(t){return this.objectStorePromise("readwrite",e=>Ye(this,null,function*(){yield this.reqPromise(e.put([...t],"autoload"))}))},loadGameMode(){return this.objectStorePromise("readonly",t=>Ye(this,null,function*(){return yield this.reqPromise(t.get("gameMode"))}))},saveGameMode(t){return this.objectStorePromise("readwrite",e=>Ye(this,null,function*(){yield this.reqPromise(e.put(t,"gameMode"))}))},saveTemplate(t){return this.objectStorePromise("readwrite",e=>Ye(this,null,function*(){t==null?yield this.reqPromise(e.delete("template")):yield this.reqPromise(e.put(t,"template"))}))},loadTemplate(){return this.objectStorePromise("readonly",t=>Ye(this,null,function*(){return yield this.reqPromise(t.get("template"))}))},saveSettings(t){return this.objectStorePromise("readwrite",e=>Ye(this,null,function*(){yield this.reqPromise(e.put(gi({},t),"settings"))}))},loadSettings(){return this.objectStorePromise("readonly",t=>Ye(this,null,function*(){return yield this.reqPromise(t.get("settings"))}))},objectStorePromise(t,e){return Ye(this,null,function*(){const n=yield this.db;if(!n)throw new Error("No database");const s=n.transaction(["settings"],t).objectStore("settings");return yield e(s)})},reqPromise(t){return new Promise((e,n)=>{t.onerror=o=>{n(o)},t.onsuccess=()=>{e(t.result)}})}};class my extends ip{saveToFile(e,n,o="image/png",s=1){let r=e.toDataURL(o,s);const l=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(l)),window.navigator.msSaveBlob(l,n),Promise.resolve(r)}}const ap="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!--%20Source:%20https://fonts.google.com/icons?selected=Material%2520Icons%2520Round%253Awarning%253A%20--%3e%3csvg%20fill='%23FFFFFF'%20version='1.1'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cfilter%20id='a'%20x='-.07126'%20y='-.079384'%20width='1.1425'%20height='1.1597'%20color-interpolation-filters='sRGB'%3e%3cfeGaussianBlur%20stdDeviation='0.36070242'/%3e%3c/filter%3e%3c/defs%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23fff'%20filter='url(%23a)'%20stroke='%23fff'/%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23000'/%3e%3c/svg%3e";var by=Object.defineProperty,zu=Object.getOwnPropertySymbols,yy=Object.prototype.hasOwnProperty,_y=Object.prototype.propertyIsEnumerable,mi=(t,e,n)=>e in t?by(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gu=(t,e)=>{for(var n in e||(e={}))yy.call(e,n)&&mi(t,n,e[n]);if(zu)for(var n of zu(e))_y.call(e,n)&&mi(t,n,e[n]);return t},Xu=(t,e,n)=>mi(t,typeof e!="symbol"?e+"":e,n);class no{constructor(e){this.html=e,Xu(this,"width"),Xu(this,"height"),this.width=e.width,this.height=e.height}paintOnto(e,n={}){const{w:o,h:s}=Gu({w:this.width,h:this.height},n),{x:r,y:l}=Gu({x:-o/2,y:-s/2},n);e.drawImage(this.html,r,l,o,s)}}var wy=Object.defineProperty,Py=(t,e,n)=>e in t?wy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yu=(t,e,n)=>Py(t,typeof e!="symbol"?e+"":e,n);let bi=null;setTimeout(()=>Eo(ap).then(t=>{t instanceof no&&(bi=t)}),0);class Ts{constructor(){Yu(this,"width",300),Yu(this,"height",300)}paintOnto(e,n={}){bi&&bi.paintOnto(e,n)}}var Cy=Object.defineProperty,xy=(t,e,n)=>e in t?Cy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,up=(t,e,n)=>xy(t,e+"",n),To=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});let Dl;function Ao(){if(Dl)return Dl;if(!pe.supports.allowWebP||!Mb)return Promise.resolve(!1);const t="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",e="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return Dl=To(this,null,function*(){const n=yield Promise.all([yi(t,1,2),yi(e,720,1280)]);return n[0]&&n[1]})}function yi(t,e,n){return new Promise(o=>{const s=document.createElement("img");s.addEventListener("load",()=>{o(s.width===n&&s.height===e)}),s.addEventListener("error",()=>{o(!1)}),s.src=t})}let Ll;function ky(){return Ll||(Ll=To(this,null,function*(){return yield yi("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2)}))}class Oy{constructor(){up(this,"cache",new Map)}get(e){const n=this.cache.get(e);if(n)return n;const o=Br(e);return this.cache.set(e,o),o}remove(e){this.cache.delete(e)}}class Sy{constructor(){up(this,"cache",new Map)}get(e){var n;const o=(n=this.cache.get(e))==null?void 0:n.deref();if(o)return o;const s=Iy(e);return this.cache.set(e,new WeakRef(s)),s}remove(e){this.cache.delete(e)}}let Nl=null;function Rr(){return Nl||(window.assetCache=Nl=pe.supports.assetCaching||typeof WeakRef=="undefined"?new Oy:new Sy)}const oo={};function ha(t,e=!0){return Eo(pe.supports.lq&&!e?t.lq:t.hq)}function Mn(t,e=!0){const n=pe.supports.lq&&ua&&!e?t.lq:t.hq;return oo[n]?oo[n]:n}function Eo(t){return oo[t]&&(t=oo[t]),Rr().get(t)}function As(t,e=!0){return To(this,null,function*(){const n=`${aa}${t}${pe.supports.lq&&ua&&!e?".lq":""}${(yield Ao())?".webp":".png"}`.replace(/\/+/,"/");return yield Rr().get(n)})}function $y(t,e=!0){return To(this,null,function*(){return`${aa}${t}${pe.supports.lq&&ua&&!e?".lq":""}${(yield Ao())?".webp":".png"}`.replace(/\/+/,"/")})}function cp(t,e){oo[t]=e}function Iy(t){return To(this,null,function*(){const e=!!oo[t];return e&&(t=oo[t]),yield To(this,null,function*(){try{return yield Br(t)}catch(n){if(t.endsWith(".webp")&&!e)try{return yield Br(t.replace(/\.webp$/,".png"))}catch(o){return Te.fire(new jr(t)),Rr().remove(t),new Ts}else return Te.fire(new jr(t)),Rr().remove(t),new Ts}})})}function Br(t,e=!1){return new Promise(n=>{const o=new Image;o.addEventListener("load",()=>{n(new no(o)),(e||!pe.supports.assetCaching)&&document.body.removeChild(o)}),o.addEventListener("error",()=>{n(new Ts),(e||!pe.supports.assetCaching)&&document.body.removeChild(o)}),o.crossOrigin="Anonymous",o.src=t,o.style.display="none",document.body.appendChild(o)})}var jy=Object.defineProperty,Ty=(t,e,n)=>e in t?jy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kt=(t,e,n)=>Ty(t,typeof e!="symbol"?e+"":e,n),tt=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Ay{constructor(){kt(this,"state",Fn({looseTextParsing:!0,autoAdd:[],downloadLocation:""})),kt(this,"localRepositoryUrl","/repo/"),kt(this,"_gameMode",null),kt(this,"electron",window),kt(this,"$store",null),kt(this,"bgInvalidation",null),kt(this,"pendingContentPacks",[]),kt(this,"pendingContentPacksReplace",[]),kt(this,"loadingContentPacksAllowed"),kt(this,"loadContentPacks"),kt(this,"updateProgress",L("wait")),kt(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1}),kt(this,"savingEnabled",!0),this.loadingContentPacksAllowed=new Promise(n=>{this.loadContentPacks=()=>n()}),this.electron.ipcRenderer.on("add-persistent-content-pack",n=>tt(this,null,function*(){if(yield this.loadingContentPacksAllowed,!this.$store){this.pendingContentPacks.push(n);return}yield Z(()=>tt(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",n)}))})),this.electron.ipcRenderer.on("add-persistent-background",n=>tt(this,null,function*(){const o="persistentBg-"+n,s=n.split("/");cp(o,n),qu.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()})),this.electron.ipcRenderer.on("push-message",n=>{Te.fire(new At(n))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",n=>{this.state.downloadLocation=n}),this.electron.ipcRenderer.onConversation("load-packs",n=>tt(this,null,function*(){const o=yield Ro.getInstance(),s=yield Promise.all(n.map(r=>tt(this,null,function*(){const[l,a]=r.split(";",2);a!=null&&!o.hasPack(l)&&(yield o.loadTempPack(a));const i=o.getPack(l);return i.dddg2Path||i.dddg1Path})));if(!this.$store){s.forEach(r=>this.pendingContentPacks.push(r));return}yield Z(()=>tt(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",s)}))})),this.electron.ipcRenderer.onConversation("auto-load.changed",n=>{this.state.autoAdd=n}),this.electron.ipcRenderer.onConversation("reload-repo",()=>tt(this,null,function*(){yield(yield Ro.getInstance()).reloadLocalRepo()})),this.electron.ipcRenderer.onConversation("replace-pack",n=>tt(this,null,function*(){const o={processed:!1,contentPack:n};this.$store?yield Z(()=>tt(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",o)})):this.pendingContentPacksReplace.push(o)})),this.electron.ipcRenderer.onConversation("resolvable-error",(n,o)=>new Promise(s=>{Te.fire(new ia(n,o.map(r=>({exec:()=>s(r),name:r}))))}));let e=!1;this.electron.ipcRenderer.on("update.progress",n=>{this.updateProgress.value=n,n==="done"?(e=!1,Te.fire(new At("An update is downloaded and will be installed once DDDG closes."))):e||(e=!0,Te.fire(new At("An update was found and will download in the background.")))}),this.electron.ipcRenderer.on("update.checkStopped",()=>{this.updateProgress.value="none"}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(e){this.electron.ipcRenderer.send("open-folder",e)}onPanelChange(){}saveSettings(e){return tt(this,null,function*(){var n;yield this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw),yield this.electron.ipcRenderer.sendConvo("config.set","darkMode",(n=e.darkMode)!=null?n:void 0),yield this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom)})}loadGameMode(){return tt(this,null,function*(){this._gameMode=(yield this.electron.ipcRenderer.sendConvo("config.get","gameMode"))||"ddlc"})}setGameMode(e){return tt(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("config.set","gameMode",e),this.electron.ipcRenderer.send("reload")})}loadSettings(){return tt(this,null,function*(){var e,n,o;return{lq:!1,nsfw:(e=yield this.electron.ipcRenderer.sendConvo("config.get","nsfw"))!=null?e:!1,darkMode:(n=yield this.electron.ipcRenderer.sendConvo("config.get","darkMode"))!=null?n:void 0,defaultCharacterTalkingZoom:(o=yield this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom"))!=null?o:void 0}})}localRepoInstall(e,n,o){return tt(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.install",e,n,o)})}localRepoUninstall(e){return tt(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.uninstall",e)})}autoLoadAdd(e){return tt(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.add",e)})}autoLoadRemove(e){return tt(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.remove",e)})}saveToFile(e,n,o="image/png",s=1){return new Promise((r,l)=>{e.toBlob(a=>tt(this,null,function*(){if(!a){l();return}const i=yield a.arrayBuffer();yield this.electron.ipcRenderer.sendConvo("save-file",n,new Uint8Array(i)),r(URL.createObjectURL(a))}),o,s)})}prompt(e,n){return tt(this,null,function*(){return yield this.electron.ipcRenderer.sendConvo("show-prompt",e,n)})}connectToStore(e){this.$store=e,this.invalidateInstalledBGs(),Z(()=>tt(this,null,function*(){if(this.pendingContentPacks.length>0&&(yield this.$store.dispatch("content/loadContentPacks",this.pendingContentPacks)),this.pendingContentPacksReplace.length>0)for(const n of this.pendingContentPacksReplace)yield this.$store.dispatch("content/replaceContentPack",n)}))}invalidateInstalledBGs(){this.$store&&this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.$store&&Z(()=>tt(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",{contentPack:qu})}))}}const qu={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};function Ey(){return window.isElectron?new Ay:"msSaveOrOpenBlob"in window.navigator?new my:new ip}const pe=Ey();var Ry=Object.defineProperty,By=Object.defineProperties,My=Object.getOwnPropertyDescriptors,Ku=Object.getOwnPropertySymbols,Dy=Object.prototype.hasOwnProperty,Ly=Object.prototype.propertyIsEnumerable,_i=(t,e,n)=>e in t?Ry(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,es=(t,e)=>{for(var n in e||(e={}))Dy.call(e,n)&&_i(t,n,e[n]);if(Ku)for(var n of Ku(e))Ly.call(e,n)&&_i(t,n,e[n]);return t},Ny=(t,e)=>By(t,My(e)),In=(t,e,n)=>_i(t,typeof e!="symbol"?e+"":e,n),ts=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Fy="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",Es=class Ht{constructor(e,n,o){this.$store=o,In(this,"onlineRepo"),In(this,"localRepo"),In(this,"tempRepo",Fn({authors:{},packs:[]})),In(this,"combinedList"),In(this,"authors"),window.repo=this,e||(e={authors:{},packs:[]},Te.fire(new At("Couldn't load remote repository."))),n||(n={authors:{},packs:[]},pe.supports.localRepo&&Te.fire(new At("Couldn't load local repository."))),this.onlineRepo=L(e),this.localRepo=L(n),this.combinedList=S(()=>{var s,r;const l=this.onlineRepo.value,a=(s=l==null?void 0:l.packs)!=null?s:[],i=new Map(a.map(h=>[h.id,h])),u=this.localRepo.value,c=(r=u==null?void 0:u.packs)!=null?r:[],f=new Map(c.map(h=>[h.id,h])),g=this.tempRepo.packs,b=new Map(g.map(h=>[h.id,h])),_=new Set(pe.state.autoAdd),w=this.$store.state.content.contentPacks.map(h=>h.packId).filter(h=>h!=null),k=new Set(w),v=new Set;return[...w,...c.map(h=>h.id),...a.map(h=>h.id),...g.map(h=>h.id)].filter(h=>h.startsWith("dddg.buildin.")||h.startsWith("dddg.uploads.")||h.startsWith("dddg.desktop.")||h==="concept_femc.shido_draws.edave64"||v.has(h)?!1:(v.add(h),!0)).map(h=>{var m,j,P;return Ny(es(es(es({},(m=i.get(h))!=null?m:{characters:[],kind:[],authors:[]}),(j=f.get(h))!=null?j:{}),(P=b.get(h))!=null?P:{}),{autoloading:_.has(h),installed:f.has(h),online:i.has(h)||b.has(h),loaded:k.has(h)})})}),this.authors=S(()=>{var s,r;const l=this.onlineRepo.value,a=(s=l==null?void 0:l.authors)!=null?s:{},i=this.localRepo.value,u=(r=i==null?void 0:i.authors)!=null?r:{};return es(es({},a),u)}),Object.freeze(this)}static getInstance(){return Ht.instance||(Ht.instance=this.createInstance()),Ht.instance}static createInstance(){return ts(this,null,function*(){const e=Ht.loadRepo(Fy),n=pe.supports.localRepo?yield Ht.loadRepo(pe.localRepositoryUrl):null,[o,s,r]=yield Promise.all([e,n,Ht.$store]);return new Ht(o,s,r)})}static loadRepo(e){return ts(this,null,function*(){try{const[n,o]=yield Promise.all([Ht.fetchJSON(e+"repo.json"),Ht.fetchJSON(e+"people.json")]);return{packs:n,authors:o}}catch(n){return null}})}static fetchJSON(e){return ts(this,null,function*(){const n=yield fetch(e);if(!n.ok)throw new Error("Could not load json");return yield n.json()})}reloadLocalRepo(){return ts(this,null,function*(){this.localRepo.value=pe.supports.localRepo?yield Ht.loadRepo(pe.localRepositoryUrl):null})}getPacks(){return this.combinedList.value}hasPack(e,n=!1){var o;return n?!!((o=this.onlineRepo.value)!=null&&o.packs.find(s=>s.id===e)):!!this.getPacks().find(s=>s.id===e)}getPack(e){var n;return(n=this.getPacks().find(o=>o.id===e))!=null?n:null}getAuthor(e){return this.authors.value[e]||null}getAuthors(){return this.authors.value}loadTempPack(e){return ts(this,null,function*(){const n=fetch(e);let o;try{o=yield n}catch(l){throw new Error(`Failed to load '${e}'`)}let s;try{s=yield o.json()}catch(l){throw new Error(`The contents of '${e}' is not a valid JSON: ${l.message}`)}if(!s.pack&&(!s.packs||s.packs.length===0))throw new Error(`The json file '${e}' does not contain any packages`);if(s.authors)for(const l in s.authors)this.tempRepo.authors[l]&&(this.tempRepo.authors[l]=s.authors[l]);let r=null;if(s.pack&&(this.addTempPack(s.pack,e),r=s.pack.id),s.packs)for(const l of s.packs)this.addTempPack(l,e),r===null&&(r=l.id);return r})}addTempPack(e,n){if(e.repoUrl=n,e.dddg1Path&&(e.dddg1Path=new URL(e.dddg1Path,n).toString()),e.dddg2Path&&(e.dddg2Path=new URL(e.dddg2Path,n).toString()),e.preview)for(let o=0;o<e.preview.length;++o)e.preview[o]=new URL(e.preview[o],n).toString();this.tempRepo.packs.find(o=>o.id===e.id)||this.tempRepo.packs.push(e)}};In(Es,"instance");In(Es,"setStore");In(Es,"$store",new Promise(t=>{Es.setStore=t}));let Ro=Es;var Vy=Object.defineProperty,Hy=Object.defineProperties,Uy=Object.getOwnPropertyDescriptors,Ju=Object.getOwnPropertySymbols,Wy=Object.prototype.hasOwnProperty,zy=Object.prototype.propertyIsEnumerable,Zu=(t,e,n)=>e in t?Vy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sl=(t,e)=>{for(var n in e||(e={}))Wy.call(e,n)&&Zu(t,n,e[n]);if(Ju)for(var n of Ju(e))zy.call(e,n)&&Zu(t,n,e[n]);return t},Gy=(t,e)=>Hy(t,Uy(e));function yr(t,e){return{backgrounds:Xy(t.backgrounds,e.backgrounds),characters:qy(t.characters,e.characters),dependencies:wi(t.dependencies,e.dependencies),fonts:en(t.fonts,e.fonts,n=>n.id,(n,o)=>Gy(sl({},n),{files:wi(n.files,o.files)})),poemStyles:en(t.poemStyles,e.poemStyles,n=>n.label,()=>{throw new Error}),poemBackgrounds:[...t.poemBackgrounds,...e.poemBackgrounds],sprites:en(t.sprites,e.sprites,n=>n.id,(n,o)=>{var s;return{id:n.id,label:n.label,variants:[...n.variants,...o.variants],defaultScale:n.defaultScale,hd:n.hd,sdVersion:(s=n.sdVersion)!=null?s:o.sdVersion}}),colors:en(t.colors,e.colors,n=>n.color,n=>n)}}function Xy(t,e){return en(t,e,n=>n.id,Yy)}function Yy(t,e){var n;return{id:t.id,label:t.label,variants:[...t.variants,...e.variants],scaling:t.scaling,sdVersion:(n=t.sdVersion)!=null?n:e.sdVersion}}function qy(t,e){return en(t,e,n=>n.id,Ky)}function Ky(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:Qy(t.heads,e.heads),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion,styleGroups:en(t.styleGroups,e.styleGroups,n=>n.id,(n,o)=>({id:n.id,styleComponents:en(n.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:Jy(s.variants,r.variants)})),styles:en(n.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:en(s.poses,r.poses,l=>l.id,Zy)}))}))}}function Jy(t,e){const n=sl({},t);for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(Object.prototype.hasOwnProperty.call(n,o)||(n[o]=e[o]));return n}function Zy(t,e){const n=sl({},t.positions);for(const o in e.positions)n[o]?n[o]=[...n[o],...e.positions[o]]:n[o]=e.positions[o];return{id:t.id,compatibleHeads:wi(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function Qy(t,e){const n=sl({},t);for(const o in e){if(!Object.prototype.hasOwnProperty.call(e,o))continue;const s=e[o];if(n[o]){const r=n[o];n[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else n[o]=s}return n}function wi(t,e){const n=[...t];for(const o of e)n.includes(o)||n.push(o);return n}function en(t,e,n,o){const s=[...t],r=new Map(t.map((l,a)=>[n(l),a]));for(const l of e){const a=n(l);if(r.has(a)){const i=r.get(a),u=s[i];s.splice(i,1,o(u,l))}else r.set(a,s.length),s.push(l)}return s}var st=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Rs={},Ze={},Dn={},Mr=st&&st.__assign||function(){return Mr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Mr.apply(this,arguments)},dp=st&&st.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},e_=st&&st.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},t_=st&&st.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(e_(arguments[e]));return t};Object.defineProperty(Dn,"__esModule",{value:!0});Dn.mapObject=fp=Dn.assetWalker=Pi=Dn.normalizePath=void 0;var n_=10;function o_(t,e,n,o){for(var s,r,l="",a=0,i=new Map(Array.from(e.entries()).map(function(p){return[new RegExp("{"+p[0]+"}","g"),p[1]]}));l!==t;){if(l=t,++a>n_)throw new Error("Maximum replacement recursion exceeded!");try{for(var u=(s=void 0,dp(i.entries())),c=u.next();!c.done;c=u.next()){var f=c.value;t=t.replace(f[0],f[1])}}catch(p){s={error:p}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(s)throw s.error}}t=t.replace(/{format(:.*?:.*?)+}/gi,function(p){p=p.slice(8,-1);for(var g=p.split(":"),b=0;b<g.length;b+=2)if(n.has(g[b]))return g[b+1];return""}),t=t.replace(/{lq:(.*?):(.*?)}/gi,function(p){return p.slice(4,-1).split(":")[o?0:1]})}return t}var Pi=Dn.normalizePath=o_;function s_(t,e){return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies,characters:t.characters.map(function(n){return r_(n,e)}),backgrounds:t.backgrounds.map(function(n){return p_(n,e)}),fonts:t.fonts.map(function(n){return h_(n,e)}),poemStyles:t_(t.poemStyles),poemBackgrounds:t.poemBackgrounds.map(function(n){return v_(n,e)}),sprites:t.sprites.map(function(n){return g_(n,e)}),colors:t.colors}}var fp=Dn.assetWalker=s_;function r_(t,e){return{id:t.id,label:t.label,chibi:t.chibi?e(t.chibi,"image"):void 0,heads:d_(t.heads,e),styleGroups:t.styleGroups.map(function(n){return l_(n,e)}),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion}}function l_(t,e){return{id:t.id,styleComponents:t.styleComponents.map(function(n){return a_(n,e)}),styles:t.styles.map(function(n){return i_(n,e)})}}function i_(t,e){return{components:t.components,poses:t.poses.map(function(n){return c_(n,e)})}}function a_(t,e){return Mr(Mr({},t),{variants:u_(t.variants,e)})}function u_(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],"image"));return n}function c_(t,e){var n,o,s={};try{for(var r=dp(Object.keys(t.positions)),l=r.next();!l.done;l=r.next()){var a=l.value,i=t.positions[a];s[a]=i.map(function(u){return u.map(function(c){return e(c,"image")})})}}catch(u){n={error:u}}finally{try{l&&!l.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return{compatibleHeads:t.compatibleHeads,id:t.id,previewOffset:t.previewOffset,previewSize:t.previewSize,renderCommands:t.renderCommands.map(function(u){return u.type==="image"?{type:"image",offset:u.offset,images:u.images.map(function(c){return e(c,"image")})}:u}),size:t.size,scale:t.scale,positions:s}}function d_(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=f_(t[o],e));return n}function f_(t,e){return{previewOffset:t.previewOffset,previewSize:t.previewSize,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})})}}function p_(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),scaling:t.scaling,sdVersion:t.sdVersion}}function h_(t,e){return{id:t.id,label:t.label,files:t.files.map(function(n){return e(n,"font")})}}function v_(t,e){return{id:t.id,fontColor:t.fontColor,label:t.label,images:t.images.map(function(n){return e(n,"image")}),sdVersion:t.sdVersion}}function g_(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),defaultScale:t.defaultScale,hd:t.hd,sdVersion:t.sdVersion}}function m_(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],o));return n}Dn.mapObject=m_;var Dr=st&&st.__assign||function(){return Dr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Dr.apply(this,arguments)};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.expandId=Ze.normalizeStyleComponent=Ze.normalizeColor=Ze.normalizeBackground=Ze.normalizeFont=Ze.normalizePoemBackground=Ze.normalizePoemStyles=Ze.normalizeSprite=Ze.mapNormalize=pp=Ze.normalizeContentPack=void 0;var b_=Dn;function y_(t,e){var n={paths:e,packId:t.packId},o=bt("",t.folder||"/",n);return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies||[],characters:Kt(__,t.characters,o,n),backgrounds:Kt(bp,t.backgrounds,o,n),fonts:Kt(mp,t.fonts,o,n),poemStyles:Kt(vp,t.poemStyles,o,n),poemBackgrounds:Kt(gp,t.poemBackgrounds,o,n),sprites:Kt(hp,t.sprites,o,n),colors:Kt(yp,t.colors,o,n)}}var pp=Ze.normalizeContentPack=y_;function Kt(t,e,n,o){return e?e.map(function(s){return t(s,n,o)}):[]}Ze.mapNormalize=Kt;function hp(t,e,n){var o,s=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label||t.variants[0][0],variants:t.variants.map(function(r){return rl(r,s,n)}),defaultScale:t.defaultScale||[1,1],sdVersion:t.sdVersion,hd:(o=t.hd)!==null&&o!==void 0?o:null}}Ze.normalizeSprite=hp;function vp(t){return{label:t.label,defaultFont:t.defaultFont||"Aller",fontSize:t.fontSize!==void 0?t.fontSize:30,letterSpacing:t.letterSpacing!==void 0?t.letterSpacing:1,lineSpacing:t.lineSpacing!==void 0?t.lineSpacing:1.2}}Ze.normalizePoemStyles=vp;function gp(t,e,n){var o=bt(e,t.folder,n);return{id:t.id,label:t.label,images:rl(t.images,o,n),fontColor:t.fontColor||"black",sdVersion:t.sdVersion}}Ze.normalizePoemBackground=gp;function mp(t,e,n){var o=bt(e,t.folder,n);return{id:Gt(n.packId,t.id?t.id:t.label?t.label:t.files[0]),label:t.label?t.label:t.id?t.id:t.files[0],files:rl(t.files,o,n)}}Ze.normalizeFont=mp;function bp(t,e,n){var o,s=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label?t.label:t.variants[0][0],variants:t.variants.map(function(r){return rl(r,s,n)}),scaling:["none","strech","cover"].includes((o=t.scaling)===null||o===void 0?void 0:o.toLowerCase())?t.scaling.toLowerCase():"cover",sdVersion:t.sdVersion}}Ze.normalizeBackground=bp;function yp(t){return{label:t.label||t.color,color:t.color}}Ze.normalizeColor=yp;function rl(t,e,n){return t.map(function(o){return bt(e,o,n)})}function __(t,e,n){var o,s,r,l=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label,chibi:t.chibi?bt(l,t.chibi,n):void 0,heads:x_(t.heads,l,n),defaultScale:(o=t.defaultScale)!==null&&o!==void 0?o:[.8,.8],size:(s=t.size)!==null&&s!==void 0?s:[960,960],hd:(r=t.hd)!==null&&r!==void 0?r:!1,sdVersion:t.sdVersion,styleGroups:Kt(w_,t.styleGroups,l,n)}}function w_(t,e,n){var o=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),styleComponents:Kt(_p,t.styleComponents,o,n),styles:t.styles.map(function(s){return P_(s,o,n)})}}function P_(t,e,n){var o=bt(e,t.folder,n),s={};if(t.components)for(var r in t.components)t.components.hasOwnProperty(r)&&(s[Gt(n.packId,r)]=t.components[r]);return{components:s,poses:t.poses.map(function(l){return k_(l,o,n)})}}function _p(t,e,n){return{id:Gt(n.packId,t.id),label:t.label,variants:C_(t.variants,e,n)}}Ze.normalizeStyleComponent=_p;function C_(t,e,n){if(!t)return{};var o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=bt(e,t[s],n));return o}function x_(t,e,n){var o={};if(!t)return o;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={variants:Ci(r,e,n),previewOffset:[290,70],previewSize:[380,380]};else{var a=bt(e,r.folder,n);l={variants:Ci(r.variants,a,n),previewOffset:r.previewOffset||[290,70],previewSize:r.previewSize||[380,380]}}o[Gt(n.packId,s)]=l}return o}function k_(t,e,n){var o,s,r=bt(e,t.folder,n);return{compatibleHeads:((o=t.compatibleHeads)===null||o===void 0?void 0:o.map(function(l){return Gt(n.packId,l)}))||[],id:Gt(n.packId,t.id),previewOffset:t.previewOffset||[0,0],previewSize:t.previewSize||[960,960],size:t.size||[960,960],scale:t.scale||.8,positions:b_.mapObject(t.positions||{},function(l){return Ci(l,r,n)}),renderCommands:((s=t.renderCommands)===null||s===void 0?void 0:s.map(function(l){return O_(l,e,n)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function O_(t,e,n){if(t.type==="image"){var o=bt(e,t.folder,n);return{type:"image",composite:t.composite,offset:t.offset||[0,0],images:wp(t.images,o,n)}}else return Dr(Dr({},t),{offset:t.offset||[0,0]})}function Ci(t,e,n){return t.map(function(o){return wp(o,e,n)})}function wp(t,e,n){return t.map(function(o){return bt(e,o,n)})}function S_(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function bt(t,e,n){if(!e)return t;for(var o in n.paths)if(e.startsWith(o))return n.paths[o]+e.slice(o.length);return S_(e)?e:t+e}function Gt(t,e){return e.indexOf(":")!==-1?e:t+":"+e}Ze.expandId=Gt;var _r=st&&st.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$_=st&&st.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},Fl=st&&st.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat($_(arguments[e]));return t};Object.defineProperty(Rs,"__esModule",{value:!0});Rs.expandOrTranslateId=Pp=Rs.convert=void 0;var xi=Ze;function I_(t,e,n){if(!t.packId)throw new Error("");return{packId:t.packId,packCredits:t.packCredits?[t.packCredits]:[],dependencies:j_(t.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[T_(t,e,n)],colors:[]}}var Pp=Rs.convert=I_,Cp={"ddlc.monika":qt("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":qt("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":qt("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":qt("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":qt("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":qt("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":qt("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":qt("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":qt("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":qt("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function j_(t){return[]}function T_(t,e,n){var o={characterId:t.id,packId:t.packId,paths:e};return{id:Hn("character",t.id,o),chibi:t.chibi,label:t.name,heads:M_(t.heads,o,n),styleGroups:A_(t,o,n),defaultScale:[.8,.8],size:[960,960],hd:!1}}function A_(t,e,n){var o,s,r=Cp[e.characterId],l=[],a=new Map,i=D_(t,e),u=i.length===0?r&&r.defaultStyleComponents?E_(r.defaultStyleComponents,e):[]:i,c=t.poses.map(function(w){return w.style}).filter(function(w,k,v){return v.indexOf(w)===k}),f=new Map(t.styles.map(function(w){return[w.name,w]})),p=function(w){var k,v,h,m,j=f.get(w);if(j&&j.nsfw&&!n)return"continue";var P=w,A={};try{for(var D=(k=void 0,_r(u)),M=D.next();!M.done;M=D.next()){var Y=M.value;try{for(var z=(h=void 0,_r(Object.keys(Y.variants))),F=z.next();!F.done;F=z.next()){var ne=F.value,le=new RegExp("-"+ne+"\\b");if(P.match(le)){A[Y.id]=ne,P=P.replace(le,"");break}}}catch(I){h={error:I}}finally{try{F&&!F.done&&(m=z.return)&&m.call(z)}finally{if(h)throw h.error}}}}catch(I){k={error:I}}finally{try{M&&!M.done&&(v=D.return)&&v.call(D)}finally{if(k)throw k.error}}P=Hn("styleGroups",P,e);var q=a.get(P);q||(q={id:P,styleComponents:u,styles:[]},a.set(P,q),l.push(P)),q.styles.push({components:A,poses:B_(t.poses.filter(function(I){return I.style===w}),e,n)})};try{for(var g=_r(c),b=g.next();!b.done;b=g.next()){var _=b.value;p(_)}}catch(w){o={error:w}}finally{try{b&&!b.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}return l.map(function(w){return a.get(w)})}function E_(t,e){return xi.mapNormalize(xi.normalizeStyleComponent,t,"",{packId:e.packId,paths:e.paths})}function R_(t,e){return t?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:e}]:[{type:"head",offset:e},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function B_(t,e,n){return t.map(function(o){return{compatibleHeads:o.compatibleHeads.map(function(s){return Hn("heads",s.toString(),e)}),id:Hn("poses",o.name,e),renderCommands:R_(o.headInForeground,o.headAnchor),previewOffset:o.offset,previewSize:o.size,size:[960,960],scale:.8,positions:{Static:"static"in o?[[o.static]]:[],Left:"left"in o?Vl(o.left,n):[],Right:"right"in o?Vl(o.right,n):[],Variant:"variant"in o?Vl(o.variant,n):[]}}})}function Vl(t,e){return t.filter(function(n){return!n.nsfw||e}).map(function(n){return[n.img]})}function M_(t,e,n){var o,s,r={};try{for(var l=_r(Object.keys(t)),a=l.next();!a.done;a=l.next()){var i=a.value,u=t[i];u.nsfw&&!n||(r[Hn("heads",i,e)]={previewOffset:u.offset,previewSize:u.size,variants:u.all.filter(function(c){return!c.nsfw||n}).map(function(c){return[c.img]})})}}catch(c){o={error:c}}finally{try{a&&!a.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}return r}function D_(t,e){var n=[],o=[];return Object.keys(t.eyes).length>0&&(Object.keys(t.eyes).forEach(function(s){return o.push(s)}),n.push({label:"Eyes",id:Hn("eyes","eyes",e),variants:t.eyes})),Object.keys(t.hairs).length>0&&(Object.keys(t.hairs).forEach(function(s){return o.push(s)}),n.push({label:"Hairs",id:Hn("hairs","hairs",e),variants:t.hairs})),n}function Hl(t,e){return new Map(e.map(function(n){return[n,t+":"+n]}))}function qt(t,e,n){return n.extraHeadAssoc?n.extraHeadAssoc=n.extraHeadAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraHeadAssoc=[],n.extraPoseAssoc?n.extraPoseAssoc=n.extraPoseAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraPoseAssoc=[],n.extraStyleGroupAssoc?n.extraStyleGroupAssoc=n.extraStyleGroupAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraStyleGroupAssoc=[],{character:t+":"+e,eyes:t+":eyes",hairs:t+":hair",defaultStyleComponents:n.defaultStyleComponents||[],heads:new Map(Fl(Hl(t,n.heads),n.extraHeadAssoc)),poses:new Map(Fl(Hl(t,n.poses),n.extraPoseAssoc)),styleGroups:new Map(Fl(Hl(t,n.styleGroups),n.extraStyleGroupAssoc))}}function Hn(t,e,n){var o=Cp[n.characterId];if(o){if(t==="character"||t==="hairs"||t==="eyes")return o[t];var s=o[t].get(e);if(s)return s}return xi.expandId(n.packId,e)}Rs.expandOrTranslateId=Hn;var va={};Object.defineProperty(va,"__esModule",{value:!0});var xp=va.normalizeCharacter=void 0;function L_(t,e){var n=Un("",t.folder||"/",e),o=void 0;return t.chibi&&(o=Un(n,t.chibi,e)),o===void 0&&t.internalId&&(o=(e["/"]||"")+"chibis/"+t.internalId),{id:t.id,packId:t.packId,packCredits:t.packCredits,name:t.name,nsfw:!!t.nsfw,chibi:o,eyes:Qu(t.eyes,n,e),hairs:Qu(t.hairs,n,e),styles:V_(t.styles),heads:N_(t.heads,n,e),poses:F_(t.poses,n,e)}}xp=va.normalizeCharacter=L_;function Qu(t,e,n){if(!t)return{};var o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=Un(e,t[s],n));return o}function N_(t,e,n){var o={};if(!t)return o;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={all:bs(r,e,n),nsfw:!1,offset:[290,70],size:[380,380]};else{var a=Un(e,r.folder,n);l={all:bs(r.all,a,n),nsfw:!!r.nsfw,offset:r.offset||[290,70],size:r.size||[380,380]}}o[s]=l}return o}function F_(t,e,n){return t?t.map(function(o){var s=Un(e,o.folder,n),r={compatibleHeads:o.compatibleHeads||[],headAnchor:o.headAnchor||[0,0],headInForeground:!!o.headInForeground,name:o.name,nsfw:!!o.nsfw,style:o.style,offset:[0,0],size:[960,960]};if("static"in o)r.static=Un(s,o.static,n);else if("variant"in o)r.variant=bs(o.variant,s,n);else if("left"in o)r.left=bs(o.left,s,n),r.right=bs(o.right,s,n);else throw new Error("Invalid pose");return r}):[]}function bs(t,e,n){return t.map(function(o){return typeof o=="string"?{img:Un(e,o,n),nsfw:!1}:{img:Un(e,o.img,n),nsfw:o.nsfw||!1}})}function V_(t){return t?t.map(function(e){return{name:e.name,label:e.label,nsfw:e.nsfw||!1}}):[]}function H_(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function Un(t,e,n){if(!e)return t;for(var o in n)if(e.startsWith(o))return n[o]+e.slice(o.length);return H_(e)?e:t+e}var ys=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function U_(t){return t.split("/").slice(0,-1).join("/")+"/"}const ec=new Set(["png","gif","bmp","svg"]);function kp(){return{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}}}const W_={namespaced:!0,state:kp(),mutations:{setContentPacks(t,e){t.contentPacks=e},setCurrentContent(t,e){t.current=e}},actions:{removeContentPacks({commit:t,state:e,dispatch:n},o){const s=JSON.parse(JSON.stringify(e.current)),r=e.contentPacks.filter(l=>!o.has(l.packId));t("setContentPacks",r),t("setCurrentContent",r.reduce((l,a)=>yr(l,a))),n("panels/fixContentPackRemoval",s,{root:!0})},replaceContentPack(t,e){return ys(this,arguments,function*({commit:n,state:o},s){const r=s.processed?s.contentPack:yield Lr(s.contentPack);let l=o.contentPacks;const a=l.findIndex(i=>i.packId===s.contentPack.packId);a===-1?l.push(r):l.splice(a,1,r),l=l,n("setContentPacks",l),n("setCurrentContent",l.reduce((i,u)=>yr(i,u)))})},loadContentPacks(t,e){return ys(this,arguments,function*({commit:n,state:o},s){typeof s=="string"&&(s=[s]);const r=yield Promise.all(s.map(u=>ys(this,null,function*(){return yield ki(u)}))),l=yield Promise.all(r.map(u=>Lr(u))),a=new Set(o.contentPacks.map(u=>u.packId));let i=o.current;for(const u of l){for(const c of u.dependencies)if(!a.has(c))throw new Error(`Missing dependency '${c}'. Refusing to install ${u.packId}`);i=yr(i,u)}return n("setContentPacks",[...o.contentPacks,...l]),n("setCurrentContent",i),r.map(u=>u.packId)})}},getters:{getCharacters({current:t}){const e=new Map;for(const n of t.characters)e.set(n.id,n);return e},getBackgrounds({current:t}){const e=new Map;for(const n of t.backgrounds)e.set(n.id,n);return e}}};function ki(t){return ys(this,null,function*(){const e=yield fetch(t);if(!e.ok)throw new Error(`Could not load content pack. Server responded with: ${e.statusText}`);let n;try{n=yield e.json()}catch(o){throw new Error("Content pack is not valid json!")}try{const o={"./":U_(t),"/":aa};return n.version==="2.0"?pp(n,o):Pp(xp(n,o),o,!1)}catch(o){throw new Error("Content pack is not in a valid format!")}})}function Lr(t){return ys(this,null,function*(){const e=new Set((yield Ao())?["webp",...ec]:ec),n=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return fp(t,o=>{var s;const r=Pi(o,n,e,!1),l=Pi(o,n,e,!0);return{hq:r,lq:l,sourcePack:(s=t.packId)!=null?s:"buildIn"}})})}var z_=Object.defineProperty,G_=(t,e,n)=>e in t?z_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ll=(t,e,n)=>G_(t,typeof e!="symbol"?e+"":e,n);const Ns=class bo{constructor(e,n,o,s){this.r=e,this.g=n,this.b=o,this.a=s,Object.freeze(this)}static validCss(e){return this.validCssRgb(e)||this.validHex(e)}static fromCss(e){if(this.validCssRgb(e))return this.fromCssRgb(e);if(this.validHex(e))return this.fromHex(e);throw new Error("Invalid RGB color format")}static validCssRgb(e){return this.rgbEx.test(e)||this.rgbaEx.test(e)}static fromCssRgb(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");const n=e.slice(0,-1),o=n.indexOf("("),r=n.slice(o+1).split(",").map(l=>parseFloat(l.trim()));return new bo(r[0],r[1],r[2],r.length===4?r[3]:1)}static validHex(e){return this.hexShortEx.test(e)||this.hexLongEx.test(e)}static fromHex(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");const n=e.slice(1);if(n.length===3)return new bo(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(n.length===4)return new bo(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(n.length===6)return new bo(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(n.length===8)return new bo(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:e,g:n,b:o}=this;const{a:s}=this;e/=255,n/=255,o/=255;const r=Math.max(e,n,o),l=Math.min(e,n,o);let a,i;const u=(r+l)/2;if(r===l)a=i=0;else{const c=r-l;switch(i=u>.5?c/(2-r-l):c/(r+l),r){case e:a=(n-o)/c+(n<o?6:0);break;case n:a=(o-e)/c+2;break;case o:a=(e-n)/c+4;break}a/=6}return new Ve(a,i,u,s)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};ll(Ns,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i);ll(Ns,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i);ll(Ns,"hexShortEx",/^#[0-9A-F]{3,4}$/i);ll(Ns,"hexLongEx",/^#[0-9A-F]{6,8}$/i);let Fe=Ns;class Ve{constructor(e,n,o,s){this.h=e,this.s=n,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(e){let{h:n,s:o,l:s,a:r}=this;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),o+e.s>1?o-=e.s:(o+=e.s,o<0&&(o=0)),s+e.l>1||s+e.l<0?s-=e.l:s+=e.l,r+e.a>1||r+e.a<0?r-=e.a:r+=e.a,new Ve(n,o,s,r)}toRgb(){const{h:e,s:n,l:o,a:s}=this;let r,l,a;if(n===0)r=l=a=o;else{const i=o<.5?o*(1+n):o+n-o*n,u=2*o-i;r=Ve.hue2rgb(u,i,e+1/3),l=Ve.hue2rgb(u,i,e),a=Ve.hue2rgb(u,i,e-1/3)}return new Fe(Math.round(r*255),Math.round(l*255),Math.round(a*255),s)}toHSL(){return this}static hue2rgb(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}}const il=1280,ga=720,X_=128,Y_=32,q_="rgba(60,60,60,0.8)",K_=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Op=1,J_=1/1.5,Z_=-74,Q_=358,e0=[200,240,400,493,640,786,880,1040,1080],t0=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:Q_,CloseUpYOffset:Z_,WheelBackground:q_,characterPositions:e0,hdCharacterScaleFactor:J_,positions:K_,screenHeight:ga,screenWidth:il,sdCharacterScaleFactor:Op,wheelInnerRadius:X_,wheelWidth:Y_},Symbol.toStringTag,{value:"Module"})),n0=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),o0="#ffe6f4",s0="#ffbde1",r0=420,l0=22,i0=640,Sp=270,a0=7,$p=3,u0=Math.ceil($p/2),c0=(ga-Sp)/2,d0={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},f0=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:s0,ChoiceButtonColor:o0,ChoiceButtonWidth:r0,ChoiceOuterPadding:u0,ChoicePadding:a0,ChoiceSpacing:l0,ChoiceTextStyle:d0,ChoiceX:i0,ChoiceY:c0,ChoiceYOffset:Sp,Outline:$p,nameboxTextOutlineDelta:n0},Symbol.toStringTag,{value:"Module"})),Ip="#ffa8d2",p0="#552222",h0="#ffeef6",ma="#bb5599",jp=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Tp=new Ve(.002028397565922768,0,.13725490196078438,0),Ap=.82,Ep=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Rp=12,Bp=12,v0=.6,g0=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),m0=new Ve(0,-.14285714285714296,.3,0),b0=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),y0=9.5,_0=47,Mp=new Ve(.0023347701149424305,0,.10784313725490202,0),yo=3,Dp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:g0,controlDisableColorDelta:m0,controlsDefaultColor:p0,dotColorDelta:b0,dotPatternSize:_0,dotRadius:y0,nameColorThreshold:v0,nameboxBackgroundDelta:Tp,nameboxDefaultColor:h0,nameboxGradientEndDelta:Ep,nameboxGradientMiddleStopPosition:Ap,nameboxRounding:Rp,nameboxStrokeDefaultColor:ma,nameboxTextOutlineDelta:jp,textboxDefaultColor:Ip,textboxOutlineColorDelta:Mp,textboxOutlineWidth:yo,textboxRounding:Bp},Symbol.toStringTag,{value:"Module"}));var w0=Object.defineProperty,P0=Object.defineProperties,C0=Object.getOwnPropertyDescriptors,tc=Object.getOwnPropertySymbols,x0=Object.prototype.hasOwnProperty,k0=Object.prototype.propertyIsEnumerable,nc=(t,e,n)=>e in t?w0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lp=(t,e)=>{for(var n in e||(e={}))x0.call(e,n)&&nc(t,n,e[n]);if(tc)for(var n of tc(e))k0.call(e,n)&&nc(t,n,e[n]);return t},Np=(t,e)=>P0(t,C0(e));const zo=816,ba=900,al=146,O0=0,S0=29,$0=8,Fs=38,ul=44,I0=6,j0=93,T0=404,A0=9,E0=9,so=39,Vs=168,Hs=34,cl=29,ya=12,_a=-126,wa=-72,Pa=-38,Ca=30.75,xa=26,Fp=426,Oi=58,ka={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},dl=Np(Lp({},ka),{fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:6,color:"white",letterSpacing:1}),Oa={align:"left",font:"13px aller",fill:{style:"#522"}},Vp=Np(Lp({},Oa),{fill:{style:"#a66"}}),R0={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Sa={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},Go=il/2-zo/2,B0=il/2-ba/2,M0=Go+Fs,Hp=Go+Hs,D0=Hp+Vs/2,L0=Go+_a,N0=Go+wa,F0=Go+Pa,V0="normal",H0=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:Ca,ArrowYBottomOffset:xa,BaseTextStyle:ka,ControlsTextDisabledStyle:Vp,ControlsTextStyle:Oa,ControlsXHistory:L0,ControlsXHistoryOffset:_a,ControlsXSkip:N0,ControlsXSkipOffset:wa,ControlsXStuff:F0,ControlsXStuffOffset:Pa,ControlsYBottomOffset:ya,DefaultTextboxStyle:V0,GlowRX:Fp,GlowRY:Oi,HdSideMargin:T0,HdSpacing:j0,NameboxHeight:so,NameboxTextStyle:dl,NameboxTextX:D0,NameboxTextYOffset:cl,NameboxWidth:Vs,NameboxX:Hp,NameboxXOffset:Hs,TextBoxBottomSpacing:I0,TextBoxCorruptedKerning:$0,TextBoxCorruptedStyle:R0,TextBoxCorruptedWidth:ba,TextBoxCorruptedX:B0,TextBoxHeight:al,TextBoxKerning:O0,TextBoxLineHeight:S0,TextBoxStyle:Sa,TextBoxTextCorruptedXOffset:A0,TextBoxTextCorruptedYOffset:E0,TextBoxTextX:M0,TextBoxTextXOffset:Fs,TextBoxTextYOffset:ul,TextBoxWidth:zo,TextBoxX:Go},Symbol.toStringTag,{value:"Module"}));var U0=Object.defineProperty,W0=Object.defineProperties,z0=Object.getOwnPropertyDescriptors,oc=Object.getOwnPropertySymbols,G0=Object.prototype.hasOwnProperty,X0=Object.prototype.propertyIsEnumerable,sc=(t,e,n)=>e in t?U0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y0=(t,e)=>{for(var n in e||(e={}))G0.call(e,n)&&sc(t,n,e[n]);if(oc)for(var n of oc(e))X0.call(e,n)&&sc(t,n,e[n]);return t},q0=(t,e)=>W0(t,z0(e));const K0="#ffe6f4",J0="#ffbde1",Z0="rgba(255,255,255,0.6)",Q0=40,ew=30,tw=q0(Y0({},ka),{fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:8,letterSpacing:1,color:"white"}),nw={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},ow=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:Z0,NotificationBackgroundColor:K0,NotificationBorderColor:J0,NotificationOkTextStyle:tw,NotificationPadding:Q0,NotificationSpacing:ew,NotificationTextStyle:nw},Symbol.toStringTag,{value:"Module"}));var sw=Object.defineProperty,rw=Object.defineProperties,lw=Object.getOwnPropertyDescriptors,rc=Object.getOwnPropertySymbols,iw=Object.prototype.hasOwnProperty,aw=Object.prototype.propertyIsEnumerable,lc=(t,e,n)=>e in t?sw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gn=(t,e)=>{for(var n in e||(e={}))iw.call(e,n)&&lc(t,n,e[n]);if(rc)for(var n of rc(e))aw.call(e,n)&&lc(t,n,e[n]);return t},mn=(t,e)=>rw(t,lw(e));const Up=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],uw=0,cw=0,dw=il/2,fw=ga/2,pw=33,hw=100,vw=30,gw=800,mw=720,bw=Op,yw="#333333bf",_w=480,ww=180,Pw=3,Cw=7,bn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Wp=[mn(gn({},bn),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),mn(gn({},bn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),mn(gn({},bn),{name:"Monika",fontName:"journal",fontSize:34}),mn(gn({},bn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),mn(gn({},bn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),mn(gn({},bn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),mn(gn({},bn),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),mn(gn({},bn),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],xw=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:bw,consoleBackgroundColor:yw,consoleHeight:ww,consoleWidth:_w,defaultConsoleBackground:Pw,defaultConsoleStyle:Cw,defaultPoemBackground:uw,defaultPoemHeight:mw,defaultPoemStyle:cw,defaultPoemWidth:gw,defaultX:dw,defaultY:fw,poemBackgrounds:Up,poemBottomPadding:hw,poemPadding:vw,poemTextStyles:Wp,poemTopPadding:pw},Symbol.toStringTag,{value:"Module"})),kw={Base:t0,Choices:f0,Notification:ow,Poem:xw,TextBox:H0,TextBoxCustom:Dp},fl=1920,$a=1080,Ow=128,Sw=32,$w="rgba(60,60,60,0.8)",Iw=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],zp=1.5,jw=1,Tw=-111,Aw=537,Ew=[300,360,600,740,960,1180,1320,1560,1620],Rw=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:Aw,CloseUpYOffset:Tw,WheelBackground:$w,characterPositions:Ew,hdCharacterScaleFactor:jw,positions:Iw,screenHeight:$a,screenWidth:fl,sdCharacterScaleFactor:zp,wheelInnerRadius:Ow,wheelWidth:Sw},Symbol.toStringTag,{value:"Module"})),Bw=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Mw="#ffe6f4",Dw="#ffbde1",Lw=630,Nw=33,Fw=960,Gp=405,Vw=10.5,Xp=4.5,Hw=Math.ceil(Xp/2),Uw=($a-Gp)/2,Ww={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},zw=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Dw,ChoiceButtonColor:Mw,ChoiceButtonWidth:Lw,ChoiceOuterPadding:Hw,ChoicePadding:Vw,ChoiceSpacing:Nw,ChoiceTextStyle:Ww,ChoiceX:Fw,ChoiceY:Uw,ChoiceYOffset:Gp,Outline:Xp,nameboxTextOutlineDelta:Bw},Symbol.toStringTag,{value:"Module"})),Yp="#ffa8d2",Gw="#552222",Xw="#ffeef6",Ia="#bb5599",qp=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Kp=new Ve(.002028397565922768,0,.13725490196078438,0),Jp=.82,Zp=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Qp=15,eh=19,Yw=.6,qw=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Kw=new Ve(0,-.14285714285714296,.3,0),Jw=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Zw=9.5*1.5,Qw=47*1.5,th=new Ve(.0023347701149424305,0,.10784313725490202,0),_o=5,nh=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:qw,controlDisableColorDelta:Kw,controlsDefaultColor:Gw,dotColorDelta:Jw,dotPatternSize:Qw,dotRadius:Zw,nameColorThreshold:Yw,nameboxBackgroundDelta:Kp,nameboxDefaultColor:Xw,nameboxGradientEndDelta:Zp,nameboxGradientMiddleStopPosition:Jp,nameboxRounding:Qp,nameboxStrokeDefaultColor:Ia,nameboxTextOutlineDelta:qp,textboxDefaultColor:Yp,textboxOutlineColorDelta:th,textboxOutlineWidth:_o,textboxRounding:eh},Symbol.toStringTag,{value:"Module"}));var e1=Object.defineProperty,t1=Object.defineProperties,n1=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,o1=Object.prototype.hasOwnProperty,s1=Object.prototype.propertyIsEnumerable,ac=(t,e,n)=>e in t?e1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oh=(t,e)=>{for(var n in e||(e={}))o1.call(e,n)&&ac(t,n,e[n]);if(ic)for(var n of ic(e))s1.call(e,n)&&ac(t,n,e[n]);return t},sh=(t,e)=>t1(t,n1(e));const ja=1220,rh=900,lh=219,r1=0,l1=29,i1=8,Ta=57,ih=68,a1=54,u1=9,c1=9,Aa=59,Ea=252,Ra=49,ah=43,uh=12*1.5,ch=-126*1.5,dh=-72*1.5,fh=-38*1.5,ph=30.75*1.5,hh=26*1.5,vh=426*1.5,Si=58*1.5,Ba={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},gh=sh(oh({},Ba),{fontName:"riffic",fontSize:36,strokeColor:Ia,strokeWidth:9,color:"white",letterSpacing:2}),Nr={align:"left",font:"24px aller",fill:{style:"#522"}},mh=sh(oh({},Nr),{fill:{style:"#a66"}}),bh={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},d1={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Xo=fl/2-ja/2,f1=fl/2-rh/2,p1=Xo+Ta,yh=Xo+Ra,h1=yh+Ea/2,v1=Xo+ch,g1=Xo+dh,m1=Xo+fh,b1="custom_plus",y1=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:ph,ArrowYBottomOffset:hh,BaseTextStyle:Ba,ControlsTextDisabledStyle:mh,ControlsTextStyle:Nr,ControlsXHistory:v1,ControlsXHistoryOffset:ch,ControlsXSkip:g1,ControlsXSkipOffset:dh,ControlsXStuff:m1,ControlsXStuffOffset:fh,ControlsYBottomOffset:uh,DefaultTextboxStyle:b1,GlowRX:vh,GlowRY:Si,NameboxHeight:Aa,NameboxTextStyle:gh,NameboxTextX:h1,NameboxTextYOffset:ah,NameboxWidth:Ea,NameboxX:yh,NameboxXOffset:Ra,TextBoxBottomSpacing:a1,TextBoxCorruptedKerning:i1,TextBoxCorruptedStyle:d1,TextBoxCorruptedWidth:rh,TextBoxCorruptedX:f1,TextBoxHeight:lh,TextBoxKerning:r1,TextBoxLineHeight:l1,TextBoxStyle:bh,TextBoxTextCorruptedXOffset:u1,TextBoxTextCorruptedYOffset:c1,TextBoxTextX:p1,TextBoxTextXOffset:Ta,TextBoxTextYOffset:ih,TextBoxWidth:ja,TextBoxX:Xo},Symbol.toStringTag,{value:"Module"}));var _1=Object.defineProperty,w1=Object.defineProperties,P1=Object.getOwnPropertyDescriptors,uc=Object.getOwnPropertySymbols,C1=Object.prototype.hasOwnProperty,x1=Object.prototype.propertyIsEnumerable,cc=(t,e,n)=>e in t?_1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k1=(t,e)=>{for(var n in e||(e={}))C1.call(e,n)&&cc(t,n,e[n]);if(uc)for(var n of uc(e))x1.call(e,n)&&cc(t,n,e[n]);return t},O1=(t,e)=>w1(t,P1(e));const S1="#ffe6f4",$1="#ffbde1",I1="rgba(255,255,255,0.6)",j1=60,T1=45,A1=O1(k1({},Ba),{fontName:"riffic",fontSize:36,strokeColor:Ia,strokeWidth:12,letterSpacing:1,color:"white"}),E1={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},R1=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:I1,NotificationBackgroundColor:S1,NotificationBorderColor:$1,NotificationOkTextStyle:A1,NotificationPadding:j1,NotificationSpacing:T1,NotificationTextStyle:E1},Symbol.toStringTag,{value:"Module"}));var B1=Object.defineProperty,M1=Object.defineProperties,D1=Object.getOwnPropertyDescriptors,dc=Object.getOwnPropertySymbols,L1=Object.prototype.hasOwnProperty,N1=Object.prototype.propertyIsEnumerable,fc=(t,e,n)=>e in t?B1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yn=(t,e)=>{for(var n in e||(e={}))L1.call(e,n)&&fc(t,n,e[n]);if(dc)for(var n of dc(e))N1.call(e,n)&&fc(t,n,e[n]);return t},_n=(t,e)=>M1(t,D1(e));const F1=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],V1=0,H1=0,U1=fl/2,W1=$a/2,z1=26,G1=150,X1=61,Y1=1200,q1=1080,K1=zp,J1="#333333bf",Z1=720,Q1=270,eP=3,tP=7,wn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},nP=[_n(yn({},wn),{name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1}),_n(yn({},wn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5}),_n(yn({},wn),{name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5}),_n(yn({},wn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48}),_n(yn({},wn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12}),_n(yn({},wn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60}),_n(yn({},wn),{name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53}),_n(yn({},wn),{name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1})],oP=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:K1,consoleBackgroundColor:J1,consoleHeight:Q1,consoleWidth:Z1,defaultConsoleBackground:eP,defaultConsoleStyle:tP,defaultPoemBackground:V1,defaultPoemHeight:q1,defaultPoemStyle:H1,defaultPoemWidth:Y1,defaultX:U1,defaultY:W1,poemBackgrounds:F1,poemBottomPadding:G1,poemPadding:X1,poemTextStyles:nP,poemTopPadding:z1},Symbol.toStringTag,{value:"Module"})),sP={Base:Rw,Choices:zw,Notification:R1,Poem:oP,TextBox:y1,TextBoxCustom:nh};function ue(){return pe.gameMode==="ddlc_plus"?sP:kw}function Fr(t,e,n){return t>e?t:e>n?n:e}function $i(t,e){return(t%e+e)%e}function rP(t,e){return t===null&&e===null?!0:t===null||e===null?!1:t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.e===e.e&&t.f===e.f}function Vr(t){const{a:e,b:n,c:o,d:s,e:r,f:l}=t,a=e*s-n*o,i={x:r,y:l,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){const u=Math.sqrt(e*e+n*n);i.rotation=(n>0?Math.acos(e/u):-Math.acos(e/u))/Math.PI*180,i.scaleX=u,i.scaleY=a/u,i.skewX=Math.atan((e*o+n*s)/(u*u))/Math.PI*180,i.skewY=0}else if(o!=0||s!=0){const u=Math.sqrt(o*o+s*s);i.rotation=(Math.PI/2-(s>0?Math.acos(-o/u):-Math.acos(o/u)))/Math.PI*180,i.scaleX=a/u,i.scaleY=u,i.skewX=0,i.skewY=Math.atan((e*o+n*s)/(u*u))/Math.PI*180}return i}var lP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function iP(t){var e,n,o,s,r,l,a;const i=Object.values(t.panels.panels);if(!i.find(u=>Object.values(u.objects).find(c=>"scaleX"in c)))for(const u of i)for(const c of Object.values(u.objects)){c.scaleX=(e=c.zoom)!=null?e:1,c.scaleY=(n=c.zoom)!=null?n:1,c.skewX=0,c.skewY=0,c.linkedTo=null;const f=ue();if(c.type==="character"){const p=c,g=t.content.current.characters.find(_=>_.id===p.characterType),b=(l=(r=(s=(o=g==null?void 0:g.styleGroups[p.styleGroupId])==null?void 0:o.styles[p.styleId])==null?void 0:s.poses[p.poseId])==null?void 0:r.size)!=null?l:[960,960];_h(p,(a=c.zoom)!=null?a:1,b)}if(c.type==="textBox"){const p=c;p.height+=f.TextBox.NameboxHeight,p.y+=p.height/2}c.type==="sprite"&&(c.requireFixing25=!0,t.requireFixing25=!0),delete c.zoom}}function _h(t,e,n){let o=new DOMMatrixReadOnly().translate(t.x,t.y+t.height/2);o=o.translate(0,-t.height/2).scale(t.width/n[0],t.height/n[1]).translate(0,n[1]/2),o=o.rotate(t.flip?-t.rotation:t.rotation),o=o.translate(0,n[1]/2).scale(e).translate(0,-n[1]/2);const s=t.rotation;Object.assign(t,Vr(o)),t.rotation=t.flip?360-s:s,t.skewX=0,t.skewY=0,t.width=n[0],t.height=n[1]}const aP={fixSprites2_5(t,e){for(const n of Object.values(t.panels.panels))for(const o of Object.values(n.objects)){if(o.type!=="sprite"||!o.requireFixing25||o.scaleX!==o.scaleY)continue;const s=o;s.assets.length===1&&s.assets[0].hq===e.url&&(_h(s,o.scaleX,e.size),delete o.requireFixing25)}}};function uP(t,e,n){return lP(this,null,function*(){if("requireFixing25"in t){const o=yield Eo(n);e("fixSprites2_5",{url:n,size:[o.width,o.height]},{root:!0})}})}function cP(t){return!t.requireFixing25}function cs(t,e,n){let o=e+n;const s=t.length;return o<0&&(o+=s),o>=s&&(o-=s),o}var an=(t=>(t[t.None=0]="None",t[t.Selected=1]="Selected",t[t.Focused=2]="Focused",t[t.Indirectly=4]="Indirectly",t))(an||{});const dP={0:void 0,1:"#f00",2:"#00f",3:"#f0f",4:"#f66",6:"#f6f"};function Bo(t){t.width=0,t.height=0,Ma.delete(t.disposalId||0)}function ro(){const t=document.createElement("canvas");return pP(t),t}const Ma=new Map;let fP=0;function pP(t){t.disposalId=fP++,typeof WeakRef!="undefined"&&Ma.set(t.disposalId,new WeakRef(t))}window.addEventListener("unload",()=>{Ma.forEach(t=>{const e=t.deref();e&&Bo(e)})});class wo{}var hP=Object.defineProperty,pc=Object.getOwnPropertySymbols,vP=Object.prototype.hasOwnProperty,gP=Object.prototype.propertyIsEnumerable,Ii=(t,e,n)=>e in t?hP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ns=(t,e)=>{for(var n in e||(e={}))vP.call(e,n)&&Ii(t,n,e[n]);if(pc)for(var n of pc(e))gP.call(e,n)&&Ii(t,n,e[n]);return t},mP=(t,e,n)=>Ii(t,e+"",n),bP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Mo{constructor(e,n,o,s){this.canvas=e,this.fsCtx=n,this.hq=o,this.preview=s,mP(this,"aborted",!1)}static make(e,n,o){return new Mo(e,e.getContext("2d"),n,o)}static makeWithContext(e,n,o,s){return new Mo(e,n,o,s)}drawText(e){if(this.aborted)throw new wo;this.fsCtx.save();const{font:n,align:o,x:s=0,y:r=0,text:l=""}=ns(ns({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width,this.fsCtx.strokeText(l,s,r)),e.fill&&(this.fsCtx.fillStyle=e.fill.style,this.fsCtx.fillText(l,s,r)),this.fsCtx.restore()}measureText(e){if(this.aborted)throw new wo;this.fsCtx.save();const{font:n,align:o,text:s=""}=ns(ns({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width),e.fill&&(this.fsCtx.fillStyle=e.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(e){if(this.aborted)throw new wo;const{image:n,flip:o,x:s,y:r,w:l,h:a,filters:i,composite:u}=ns({flip:!1,w:e.image.width,h:e.image.height,composite:"source-over"},e);if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=u,i)if("filter"in this.fsCtx){const c=[];for(const f of i)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of i)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(e.shadow){const c=e.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(e.rotation!=null&&e.rotation!==0){const c=e.rotationAnchor?e.rotationAnchor.x:0,f=e.rotationAnchor?e.rotationAnchor.y:0;e.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(e.rotation),e.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+l/2,r+a/2),this.fsCtx.scale(o?-1:1,1),n.paintOnto(this.fsCtx,{x:-l/2,y:-a/2,w:l,h:a}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:e,y:n,w:o,h:s,outline:r,fill:l,composition:a,rotation:i,rotationAnchor:u}){if(this.aborted)throw new wo;if(this.fsCtx.save(),i!=null&&i!==0){const c=u?u.x:0,f=u?u.y:0;u&&this.fsCtx.translate(c,f),this.fsCtx.rotate(i),u&&this.fsCtx.translate(-c,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(e,n,o,s),a&&(this.fsCtx.globalCompositeOperation=a),l&&(this.fsCtx.fillStyle=l.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:e,fill:n,path:o}){if(this.aborted)throw new wo;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(e,n="repeat"){return e instanceof wh&&(e=e.previewCanvas),this.fsCtx.createPattern(e,n)}customTransform(e,n){return bP(this,null,function*(){this.fsCtx.save(),yield e(this.fsCtx),yield n(this),this.fsCtx.restore()})}linearGradient(e,n,o,s){return this.fsCtx.createLinearGradient(e,n,o,s)}applyFilters(e){if(e.length===0)return;this.fsCtx.save();let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of e)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),n!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${n})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}var yP=Object.defineProperty,_P=(t,e,n)=>e in t?yP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ul=(t,e,n)=>_P(t,typeof e!="symbol"?e+"":e,n),or=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class wh{constructor(e,n){Ul(this,"previewCanvas"),Ul(this,"runningContext",null),Ul(this,"_disposed",!1);const o=ue();this.previewCanvas=ro(),this.previewCanvas.width=e!=null?e:o.Base.screenWidth,this.previewCanvas.height=n!=null?n:o.Base.screenHeight}get disposed(){return this._disposed}render(e,n=!0,o=!0){return or(this,null,function*(){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=Mo.makeWithContext(this.previewCanvas,s,n,o);try{yield e(this.runningContext)}catch(l){if(l instanceof wo)return!1;throw l}finally{r===this.runningContext&&(this.runningContext=null)}return!0})}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(e,n){n.w!=null&&n.h!=null?e.drawImage(this.previewCanvas,n.x,n.y,n.w,n.h):e.drawImage(this.previewCanvas,n.x,n.y)}download(e,n){return or(this,null,function*(){const o=yield this.drawToCanvas(e);return yield pe.saveToFile(o,n)})}renderToBlob(e){return or(this,null,function*(){const n=yield this.drawToCanvas(e);return yield new Promise((o,s)=>{n.toBlob(r=>{r?o(r):s()})})})}drawToCanvas(e){return or(this,null,function*(){const n=ro();n.width=this.previewCanvas.width,n.height=this.previewCanvas.height;const o=n.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),yield e(Mo.makeWithContext(n,o,!0,!1)),n})}dispose(){this.runningContext&&this.runningContext.abort(),Bo(this.previewCanvas),this._disposed=!0}getDataAt(e,n){return this.previewCanvas.getContext("2d").getImageData(e,n,1,1).data}}function Yo(){return{flip:!1,rotation:0,version:0,opacity:100,x:ue().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,scaleX:1,scaleY:1,ratio:1,preserveRatio:!0,skewX:0,skewY:0,linkedTo:null}}var wP=Object.defineProperty,PP=Object.defineProperties,CP=Object.getOwnPropertyDescriptors,hc=Object.getOwnPropertySymbols,xP=Object.prototype.hasOwnProperty,kP=Object.prototype.propertyIsEnumerable,vc=(t,e,n)=>e in t?wP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hr=(t,e)=>{for(var n in e||(e={}))xP.call(e,n)&&vc(t,n,e[n]);if(hc)for(var n of hc(e))kP.call(e,n)&&vc(t,n,e[n]);return t},OP=(t,e)=>PP(t,CP(e)),SP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const $P={setPose(t,e){const n=t.panels[e.panelId].objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup(t,{id:e,panelId:n,styleGroupId:o}){const s=t.panels[n].objects[e];s.styleGroupId=o,++s.version},setCharStyle(t,{id:e,panelId:n,styleId:o}){const s=t.panels[n].objects[e];s.styleId=o,++s.version},setClose(t,e){const n=t.panels[e.panelId].objects[e.id];n.close=e.close,++n.version},setPosePosition(t,e){const n=t.panels[e.panelId].objects[e.id];n.posePositions=Hr(Hr({},n.posePositions),e.posePositions),++n.version},setFreeMove(t,e){const n=t.panels[e.panelId].objects[e.id];if(n.freeMove=e.freeMove,!n.freeMove){const o=ue();n.x=o.Base.characterPositions[Wr(n.x)],n.y=o.Base.BaseCharacterYPos}}};function pl(t,e){return t.getters["content/getCharacters"].get(e.characterType)}function qn(t,e){return t["content/getCharacters"].get(e)}function Do(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function IP(t,e){const n=Do(t,e),o=[...Object.keys(n.positions).filter(s=>n.positions[s].length>1)];return n.compatibleHeads.length>0&&o.unshift("head"),o}function Ur(t,e,n=e.posePositions.headType||0){const o=Do(t,e).compatibleHeads;return o.length===0?null:t.heads[o[n]]}function Wr(t){return ue().Base.characterPositions.map((o,s)=>({pos:Math.abs(t-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}const jP={createCharacters({rootState:t,rootGetters:e,commit:n,state:o},s){var r;const l=o.panels[s.panelId].lastObjId+1,a=ue(),i=qn(e,s.characterType),u=i.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;return n("create",{object:OP(Hr({},Yo()),{id:l,panelId:t.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,width:i.size[0],height:i.size[1],scaleX:i.defaultScale[0]*u,scaleY:i.defaultScale[1]*u,characterType:s.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:(r=i.label)!=null?r:i.id,enlargeWhenTalking:t.ui.defaultCharacterTalkingZoom,linkedTo:null})}),l},seekPart({state:t,commit:e,dispatch:n,rootGetters:o},{delta:s,id:r,panelId:l,part:a}){if(a==="head"){n("seekHead",{id:r,panelId:l,delta:s});return}const i=t.panels[l].objects[r],u=Do(qn(o,i.characterType),i);u.positions[a]&&e("setPosePosition",{id:r,panelId:l,posePositions:{[a]:cs(u.positions[a],i.posePositions[a]||0,s)}})},seekPose({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=qn(n,l.characterType),i=a.styleGroups[l.styleGroupId].styles[l.styleId].poses;ho(e,l,a,u=>{u.poseId=cs(i,u.poseId,r)})},seekStyle({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=qn(n,l.characterType),i=a.styleGroups.flatMap((c,f)=>c.styles.map((p,g)=>({styleGroupIdx:f,styleIdx:g,styleGroupJson:JSON.stringify(p.components)}))).sort((c,f)=>c.styleGroupJson.localeCompare(f.styleGroupJson)),u=i.findIndex(c=>c.styleGroupIdx===l.styleGroupId&&c.styleIdx===l.styleId);ho(e,l,a,c=>{const f=cs(i,u,r),p=i[f];c.styleGroupId=p.styleGroupIdx,c.styleId=p.styleIdx})},seekHead({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=qn(n,l.characterType),i=Do(a,l);let u=Ur(a,l);if(!u)return;let c=(l.posePositions.head||0)+r,f=l.posePositions.headType||0;(c<0||c>=u.variants.length)&&(f=cs(i.compatibleHeads.map(p=>a.heads[p]),f,r),u=Ur(a,l,f),c=r===1?0:u.variants.length-1),e("setPosePosition",{id:o,panelId:s,posePositions:{head:c,headType:f}})},setPart({state:t,commit:e,rootGetters:n},{panelId:o,id:s,part:r,val:l}){const a=t.panels[o].objects[s],i=qn(n,a.characterType);r==="pose"?ho(e,a,i,u=>{u.poseId=l}):r==="style"?ho(e,a,i,u=>{u.styleId=l}):ho(e,a,i,u=>{u.posePositions[r]=l})},setCharStyle({state:t,commit:e,rootGetters:n},{panelId:o,id:s,styleGroupId:r,styleId:l}){const a=t.panels[o].objects[s],i=qn(n,a.characterType);ho(e,a,i,u=>{u.styleGroupId=r,u.styleId=l})},setCharacterPosition({state:t,commit:e},{panelId:n,id:o,x:s,y:r}){const l=t.panels[n].objects[o];if(!l.freeMove){const a=ue();s=a.Base.characterPositions[Wr(s)],r=a.Base.BaseCharacterYPos}l.x===s&&l.y===r||e("setPosition",{panelId:n,id:o,x:s,y:r})},shiftCharacterSlot({state:t,commit:e},{panelId:n,id:o,delta:s}){const r=t.panels[n].objects[o],l=ue();let i=Wr(r.x)+s;i<0&&(i=0),i>=l.Base.characterPositions.length&&(i=l.Base.characterPositions.length-1),e("setPosition",{panelId:n,id:o,x:l.Base.characterPositions[i],y:r.y})}};function TP(t,e,n,o){return SP(this,null,function*(){const s=t.state.panels[e].objects[n],r=o.characters.find(m=>m.id===s.characterType);if(!r){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const l=Ph(s),a=r.styleGroups[s.styleGroupId],i=a.styles[l.styleId],u=i.poses[l.poseId],c=t.rootState.content.current.characters.find(m=>m.id===r.id);if(!c){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const f=c.styleGroups.findIndex(m=>m.id===a.id);l.styleGroupId=f===-1?0:f;const p=c.styleGroups[l.styleGroupId],g=JSON.stringify(i.components),b=p.styles.findIndex(m=>JSON.stringify(m.components)===g);l.styleId=b===-1?0:b;const _=p.styles[l.styleId],w=_.poses.findIndex(m=>m.id===u.id);l.poseId=w===-1?0:w;const k=_.poses[l.poseId];for(const m in k.positions){if(!Object.prototype.hasOwnProperty.call(k.positions,m))continue;const j=k.positions[m];if(u.positions[m]){const P=l.posePositions[m];P>=0&&P<j.length}}const v=u.compatibleHeads[s.posePositions.headType],h=k.compatibleHeads.indexOf(v);if(h===-1)l.posePositions.headType=0,l.posePositions.head=0;else{h!==s.posePositions.headType&&(l.posePositions.headType=h);const m=JSON.stringify(r.heads[v].variants[s.posePositions.head]),j=c.heads[v].variants.findIndex(P=>JSON.stringify(P)===m);j===-1?l.posePositions.head=0:l.posePositions.head=j}Ch(t.commit,s,l)})}function Ph(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Hr({},t.posePositions)}}function Ch(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,panelId:e.panelId,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log(`Setting style of ${e.id} to ${n.styleId}`),t("setCharStyle",{id:e.id,panelId:e.panelId,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,panelId:e.panelId,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,panelId:e.panelId,posePositions:n.posePositions})}function ho(t,e,n,o){const s=Ph(e);o(s),n.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=n.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const l=r.styles[s.styleId];l.poses[s.poseId]||(s.poseId=0);const a=l.poses[s.poseId];for(const f in a.positions)a.positions[f]&&(a.positions[f][s.posePositions[f]]||(s.posePositions[f]=0));const u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId].compatibleHeads[e.posePositions.headType||0],c=a.compatibleHeads.indexOf(u);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),Ch(t,e,s)}var Mt={},xh={};Object.defineProperty(xh,"__esModule",{value:!0});var kh={};Object.defineProperty(kh,"__esModule",{value:!0});var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});var Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});var $h={};Object.defineProperty($h,"__esModule",{value:!0});var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});var jh={};Object.defineProperty(jh,"__esModule",{value:!0});var Th={};Object.defineProperty(Th,"__esModule",{value:!0});var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});var Fh={};Object.defineProperty(Fh,"__esModule",{value:!0});var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});var qh={};Object.defineProperty(qh,"__esModule",{value:!0});var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});var ev={};Object.defineProperty(ev,"__esModule",{value:!0});var tv={};Object.defineProperty(tv,"__esModule",{value:!0});var nv={};Object.defineProperty(nv,"__esModule",{value:!0});var ov={};Object.defineProperty(ov,"__esModule",{value:!0});var sv={};Object.defineProperty(sv,"__esModule",{value:!0});var rv={};Object.defineProperty(rv,"__esModule",{value:!0});var lv={};Object.defineProperty(lv,"__esModule",{value:!0});var iv={};Object.defineProperty(iv,"__esModule",{value:!0});var av={};Object.defineProperty(av,"__esModule",{value:!0});var uv={};Object.defineProperty(uv,"__esModule",{value:!0});var cv={};Object.defineProperty(cv,"__esModule",{value:!0});var dv={};Object.defineProperty(dv,"__esModule",{value:!0});var fv={};Object.defineProperty(fv,"__esModule",{value:!0});var pv={};Object.defineProperty(pv,"__esModule",{value:!0});var hv={};Object.defineProperty(hv,"__esModule",{value:!0});var vv={};Object.defineProperty(vv,"__esModule",{value:!0});var gv={};Object.defineProperty(gv,"__esModule",{value:!0});var mv={};Object.defineProperty(mv,"__esModule",{value:!0});var bv={};Object.defineProperty(bv,"__esModule",{value:!0});var yv={};Object.defineProperty(yv,"__esModule",{value:!0});var _v={};Object.defineProperty(_v,"__esModule",{value:!0});var wv={};Object.defineProperty(wv,"__esModule",{value:!0});var Pv={};Object.defineProperty(Pv,"__esModule",{value:!0});var Cv={};Object.defineProperty(Cv,"__esModule",{value:!0});var xv={};Object.defineProperty(xv,"__esModule",{value:!0});var kv={};Object.defineProperty(kv,"__esModule",{value:!0});var Ov={};Object.defineProperty(Ov,"__esModule",{value:!0});var Sv={};Object.defineProperty(Sv,"__esModule",{value:!0});var $v={};Object.defineProperty($v,"__esModule",{value:!0});var Iv={};Object.defineProperty(Iv,"__esModule",{value:!0});var jv={};Object.defineProperty(jv,"__esModule",{value:!0});var Tv={};Object.defineProperty(Tv,"__esModule",{value:!0});var Av={};Object.defineProperty(Av,"__esModule",{value:!0});var Ev={};Object.defineProperty(Ev,"__esModule",{value:!0});var Rv={};Object.defineProperty(Rv,"__esModule",{value:!0});var hl={};Object.defineProperty(hl,"__esModule",{value:!0});hl.UnreachableCaseError=void 0;class AP extends Error{constructor(e){super(`Unreachable case: ${e}`)}}hl.UnreachableCaseError=AP;var vl={};Object.defineProperty(vl,"__esModule",{value:!0});vl.assert=void 0;function EP(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}vl.assert=EP;var gl={};Object.defineProperty(gl,"__esModule",{value:!0});gl.createFactoryWithConstraint=void 0;const RP=()=>t=>t;gl.createFactoryWithConstraint=RP;var ml={};Object.defineProperty(ml,"__esModule",{value:!0});ml.isExact=void 0;const BP=()=>t=>t;ml.isExact=BP;var bl={};Object.defineProperty(bl,"__esModule",{value:!0});bl.noop=void 0;function MP(...t){}bl.noop=MP;var Bv={};Object.defineProperty(Bv,"__esModule",{value:!0});(function(t){var e=st&&st.__createBinding||(Object.create?function(o,s,r,l){l===void 0&&(l=r);var a=Object.getOwnPropertyDescriptor(s,r);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,l,a)}:function(o,s,r,l){l===void 0&&(l=r),o[l]=s[r]}),n=st&&st.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&e(s,o,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(xh,t),n(kh,t),n(Oh,t),n(Sh,t),n($h,t),n(Ih,t),n(jh,t),n(Th,t),n(Ah,t),n(Eh,t),n(Rh,t),n(Bh,t),n(Mh,t),n(Dh,t),n(Lh,t),n(Nh,t),n(Fh,t),n(Vh,t),n(Hh,t),n(Uh,t),n(Wh,t),n(zh,t),n(Gh,t),n(Xh,t),n(Yh,t),n(qh,t),n(Kh,t),n(Jh,t),n(Zh,t),n(Qh,t),n(ev,t),n(tv,t),n(nv,t),n(ov,t),n(sv,t),n(rv,t),n(lv,t),n(iv,t),n(av,t),n(uv,t),n(cv,t),n(dv,t),n(fv,t),n(pv,t),n(hv,t),n(vv,t),n(gv,t),n(mv,t),n(bv,t),n(yv,t),n(_v,t),n(wv,t),n(Pv,t),n(Cv,t),n(xv,t),n(kv,t),n(Ov,t),n(Sv,t),n($v,t),n(Iv,t),n(jv,t),n(Tv,t),n(Av,t),n(Ev,t),n(Rv,t),n(hl,t),n(vl,t),n(gl,t),n(ml,t),n(bl,t),n(Bv,t)})(Mt);var DP=Object.defineProperty,gc=Object.getOwnPropertySymbols,LP=Object.prototype.hasOwnProperty,NP=Object.prototype.propertyIsEnumerable,mc=(t,e,n)=>e in t?DP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,FP=(t,e)=>{for(var n in e||(e={}))LP.call(e,n)&&mc(t,n,e[n]);if(gc)for(var n of gc(e))NP.call(e,n)&&mc(t,n,e[n]);return t};const bc=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function ji(t,e,n){const s=[...e().filters];let r;switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:throw new Mt.UnreachableCaseError(t.type)}s.splice(t.idx,0,r),n({panelId:t.panelId,id:t.id,filters:s})}function Ti(t,e,n){const s=[...e().filters];s.splice(t.idx,1),n({id:t.id,panelId:t.panelId,filters:s})}function Ai(t,e,n){const s=[...e().filters],r=s[t.idx];s.splice(t.idx,1),s.splice(t.idx+t.moveBy,0,r),n({id:t.id,panelId:t.panelId,filters:s})}function Ei(t,e,n){const s=[...e().filters],r=FP({},s[t.idx]);s[t.idx]=r,r.type==="drop-shadow"?(t.blurRadius!==void 0&&(r.blurRadius=t.blurRadius),t.color!==void 0&&(r.color=t.color),t.offsetX!==void 0&&(r.offsetX=t.offsetX),t.offsetY!==void 0&&(r.offsetY=t.offsetY)):r.value=t.value,n({id:t.id,panelId:t.panelId,filters:s})}var VP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class HP{constructor(e,n,o,s,r,l){this.id=e,this.assets=n,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=l}render(e){return VP(this,null,function*(){const{screenWidth:n,screenHeight:o}=ue().Base,s=yield Promise.all(this.assets.map(r=>ha(r,e.hq)));for(const r of s){let l=0,a=0,i=r.width,u=r.height;const c=this.scale;switch(c){case Pr.None:l=n/2-i/2,a=o/2-u/2;break;case Pr.Stretch:i=n,u=o;break;case Pr.Cover:{const f=i/u,p=n/o;f>p?(u=o,i=u*f):(i=n,u=i/f),l=n/2-i/2,a=o/2-u/2;break}default:throw new Mt.UnreachableCaseError(c)}e.drawImage({image:r,x:l,y:a,w:i,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters})}})}}const yc={id:"buildin.static-color",name:"Static color",color:"#000000",render(t){const{screenWidth:e,screenHeight:n}=ue().Base;return t.drawRect({x:0,y:0,w:e,h:n,fill:{style:this.color}}),Promise.resolve()}};function Mv(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.arcTo(e+o,n+s,e,n+s,r),t.arcTo(e,n+s,e,n,r),t.arcTo(e,n,e+o,n,r),t.closePath()}function Dv(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.lineTo(e+o,n+s),t.lineTo(e,n+s),t.arcTo(e,n,e+o,n,r),t.closePath()}function Ln(t,e){t.save();try{e()}finally{t.restore()}}function _s(t,e){e.align&&(t.textAlign=e.align),e.font!=null&&(t.font=e.font),e.fill&&(t.fillStyle=e.fill.style),e.outline&&(t.strokeStyle=e.outline.style,t.lineWidth=e.outline.width)}function UP(t,e){if("filter"in t){let n="";for(const o of e)o.type==="drop-shadow"?n+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?n+=` hue-rotate(${o.value}deg)`:o.type==="blur"?n+=` blur(${o.value}px)`:n+=` ${o.type}(${o.value*100}%)`;t.filter=(t.filter==="none"?"":t.filter)+n.trimStart()}else{let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);t.globalAlpha*=n}}var WP=Object.defineProperty,zP=(t,e,n)=>e in t?WP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pn=(t,e,n)=>zP(t,typeof e!="symbol"?e+"":e,n);class Lv{constructor(e){this.obj=e,Pn(this,"lastVersion",null),Pn(this,"localCanvasInvalid",!0),Pn(this,"lastHit",null),Pn(this,"lastLocalTransform",null),Pn(this,"refTextbox",null),Pn(this,"preparedTransform"),Pn(this,"hitDetectionFallback",!1),Pn(this,"localCanvas",null)}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let e=new DOMMatrix;const n=this.obj;e=e.translate(this.x,this.y);const o=this.height/2*n.scaleX;return"close"in n&&n.close&&(e=e.translate(0,ue().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&n.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),(n.flip||n.rotation!==0||n.scaleX!==1||n.scaleY!==1||n.skewX!==0||n.skewY!==0)&&(n.rotation!==0&&(e=e.rotate(0,0,n.rotation)),n.skewX!==0&&(e=e.skewX(n.skewX)),n.skewY!==0&&(e=e.skewY(n.skewY)),n.flip&&(e=e.flipX()),(n.scaleX!==1||n.scaleY!==1)&&(e=e.scale(n.scaleX,n.scaleY))),e}getLocalSize(){if(this.transformIsLocal){const e=ue();return new DOMPointReadOnly(e.Base.screenWidth,e.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.refTextbox!==null}get linkedTo(){return this.obj.linkedTo}prepareData(e,n){this.refTextbox=null;const o=[...e.order,...e.onTopOrder];for(const s of o){const r=e.objects[s];if(r.type==="textBox"&&r.talkingObjId===this.obj.id){this.refTextbox=r;return}}}prepareTransform(e){return this.preparedTransform=e.multiply(this.getTransfrom()),this.preparedTransform}prepareRender(e){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const n=this.preparedTransform;rP(n,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=n)}else this.lastLocalTransform=null}render(e,n,o,s,r){o||(n=an.None),(!this.canSkipLocal||n!==an.None)&&(r=!1);const l=this.getLocalSize(),a=this.preparedTransform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==l.x||this.localCanvas.height!==l.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=ro()),this.localCanvas.width=l.x,this.localCanvas.height=l.y;const u=this.localCanvas.getContext("2d");if(!u)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&u.setTransform(a),this.renderLocal(u,s),this.localCanvasInvalid=!1,u.resetTransform()}const i=dP[n];Ln(e,()=>{var u;i!=null&&(e.shadowColor=i,e.shadowBlur=20),(!this.transformIsLocal||r)&&e.setTransform(a),e.globalCompositeOperation=(u=this.obj.composite)!=null?u:"source-over",UP(e,this.obj.filters),r?this.renderLocal(e,s):e.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(e){const n=e.matrixTransform(this.preparedTransform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(n.x<0||n.y<0||n.x>o.x||n.y>o.y)return console.log("Hitbox text",n),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?e:n;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}var GP=Object.defineProperty,XP=(t,e,n)=>e in t?GP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vo=(t,e,n)=>XP(t,typeof e!="symbol"?e+"":e,n),YP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Nv extends Lv{constructor(){super(...arguments),vo(this,"refTextbox",null),vo(this,"lastUploadCount",0),vo(this,"lastHq",!1),vo(this,"missingAsset",!1),vo(this,"_canSkipLocal",!1),vo(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareData(e,n){if(super.prepareData(e,n),this.missingAsset){const o=Object.keys(n.state.uploadUrls).length;o!==this.lastUploadCount&&(this.lastHq=null),this.lastUploadCount=o}}prepareRender(e){super.prepareRender(e);let n=!1;if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),n||(n=!!this.assetList.find(o=>!("loadedAssets"in o)||o.hasMissing))),!e!==this.lastHq)for(let o=0;o<this.assetList.length;++o){const s=this.assetList[o];"loadedAssets"in s&&!s.assets.every(r=>r.hq===r.lq)&&(this.assetList[o]={assets:s.assets,offset:s.offset,composite:s.composite},n=!0)}if(this.lastHq=!e,!!n)return this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!e)}getAssetsSize(){let e=0,n=0;for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)e=Math.max(e,o.offset[0]+s.width),n=Math.max(n,o.offset[1]+s.height);return new DOMPointReadOnly(e,n)}loadAssets(e){const n=[];this.missingAsset=!1;for(const o of this.assetList)"loadedAssets"in o&&!o.hasMissing||n.push((s=>YP(this,null,function*(){const r=yield Promise.all(s.assets.map(a=>ha(a,e))),l=s;l.loadedAssets=r,l.hasMissing=r.some(a=>a instanceof Ts),this.missingAsset||(this.missingAsset=l.hasMissing)}))(o));if(n.length!==0)return Promise.all(n)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e){var n;console.log("rerendering local");for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=(n=o.composite)!=null?n:"source-over"),s instanceof Ts?s.paintOnto(e,{x:o.offset[0],y:o.offset[1],h:this.height,w:this.width}):s.paintOnto(e,{x:o.offset[0],y:o.offset[1]})}}var qP=Object.defineProperty,KP=Object.defineProperties,JP=Object.getOwnPropertyDescriptors,_c=Object.getOwnPropertySymbols,ZP=Object.prototype.hasOwnProperty,QP=Object.prototype.propertyIsEnumerable,wc=(t,e,n)=>e in t?qP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,eC=(t,e)=>{for(var n in e||(e={}))ZP.call(e,n)&&wc(t,n,e[n]);if(_c)for(var n of _c(e))QP.call(e,n)&&wc(t,n,e[n]);return t},tC=(t,e)=>KP(t,JP(e));class nC extends Nv{constructor(e,n){super(e),this.data=n}prepareData(e,n){super.prepareData(e,n),this.data=pl(n,this.obj)}prepareRender(e){return super.prepareRender(e)}isAssetListOutdated(){return!0}getAssetList(){var e;const n=Do(this.data,this.obj),o=Ur(this.data,this.obj),s=[],r=(e=this.assetList)!=null?e:[];for(const l of n.renderCommands){let a=null;switch(l.type){case"head":{if(!o)continue;const i=o.variants[this.obj.posePositions.head||0];if(i==null)continue;a=i;break}case"image":a=l.images;break;case"pose-part":{const i=n.positions[l.part];if(!i||i.length===0)break;const u=i[this.obj.posePositions[l.part]||0];if(!u)break;a=u;break}}if(a){const i=r.find(u=>u.assets===a);i?s.push(tC(eC({},i),{offset:l.offset,composite:l.composite})):s.push({assets:a,offset:l.offset,composite:l.composite})}}return s}}var oC=Object.defineProperty,sC=(t,e,n)=>e in t?oC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rC=(t,e,n)=>sC(t,e+"",n);const Pc=5;class lC{constructor(e){this.str=e,rC(this,"pos",0)}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-Pc),this.pos+Pc)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function Cc(t,e=!0){const n=[],o=new lC(t);let s=yl;for(;s!==_l;){const r=o.pos;try{s=s(n,o)}catch(l){if(e&&s!==Ri)o.pos=r,s=(a,i)=>Ri(a,i,!0);else throw l}}return n}function yl(t,e){return e.current()===void 0?_l:e.current()==="{"?iC:e.current()===`
`?aC:Ri}function _l(){return _l}function Ri(t,e,n=!1){const{pos:o}=e;let s="",r=n,l;for(;;){if(e.current()===void 0){l=_l;break}else if(r)s+=e.current(),r=!1;else if(e.current()==="\\")r=!0;else if(e.current()==="{"||e.current()===`
`){l=yl;break}else s+=e.current();e.next()}return t.push({type:"text",pos:o,content:s}),l}function Wl(t,e){throw new Error(`Error when parsing text at position ${t.pos}: (around: "${t.around}") ${e}`)}function iC(t,e){const{pos:n}=e;if(e.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=e.next()==="/";o&&e.next();let s="",r="",l=!1;for(;e.current()===void 0&&Wl(e,"Unexpected end of text inside a command"),e.current()!=="}";)l?r+=e.current():e.current().match(/[a-z]/i)?s+=e.current():e.current()==="="?(o&&Wl(e,"Closing commands may not contain arguments"),l=!0):Wl(e,`Unexpected character '${e.current()}' in command name.`),e.next();return e.next(),o?t.push({type:"commandClose",commandName:s,pos:n}):t.push({type:"command",pos:n,argument:r,commandName:s}),yl}function aC(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),yl}var uC=Object.defineProperty,cC=Object.defineProperties,dC=Object.getOwnPropertyDescriptors,xc=Object.getOwnPropertySymbols,fC=Object.prototype.hasOwnProperty,pC=Object.prototype.propertyIsEnumerable,kc=(t,e,n)=>e in t?uC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ot=(t,e)=>{for(var n in e||(e={}))fC.call(e,n)&&kc(t,n,e[n]);if(xc)for(var n of xc(e))pC.call(e,n)&&kc(t,n,e[n]);return t},St=(t,e)=>cC(t,dC(e));const Oc=new Map([go("i",t=>St(Ot({},t),{isItalic:!0})),go("b",t=>St(Ot({},t),{isBold:!0})),go("u",t=>St(Ot({},t),{isUnderlined:!0})),go("s",t=>St(Ot({},t),{isStrikethrough:!0})),go("plain",t=>St(Ot({},t),{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),go("edited",t=>St(Ot({},t),{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),sr("k",(t,e,n)=>St(Ot({},t),{letterSpacing:e?t.letterSpacing+n:n})),sr("size",(t,e,n)=>St(Ot({},t),{fontSize:e?t.fontSize+n:n})),sr("alpha",(t,e,n)=>St(Ot({},t),{alpha:e?t.alpha+n:n})),sr("stroke",(t,e,n)=>St(Ot({},t),{strokeWidth:e?t.strokeWidth+n:n})),["font",(t,e)=>St(Ot({},t),{fontName:e})],["color",(t,e)=>St(Ot({},t),{color:e})],["outlinecolor",(t,e)=>St(Ot({},t),{strokeColor:e})]]);function go(t,e){return[t,(n,o)=>{if(o!=="")throw new Error(`Operator '${t}' does not take any arguments.`);return e(n)}]}function sr(t,e){return[t,(n,o)=>{if(o=="")throw new Error(`Operator '${t}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${t}' needs a numeric argument.`);return e(n,s,r)}]}var hC=Object.defineProperty,vC=(t,e,n)=>e in t?hC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,os=(t,e,n)=>vC(t,typeof e!="symbol"?e+"":e,n);class Dt{constructor(e,n){this.str=e,this.baseStyle=n,os(this,"renderParts"),os(this,"tokens"),os(this,"loose"),os(this,"lastLayoutHeight",null),os(this,"lastLayoutWidth",null),this.loose=pe.state.looseTextParsing;try{this.tokens=Cc(e,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=Dt.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const e=new Set;let n=null;for(const s of this.renderParts)"style"in s&&s.style!==n&&(n=s.style,n.fontName&&e.add(n.fontName));const o=[];for(const s of e){const r=document,l=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(l)||o.push(r.fonts.load(l))}if(o.length!==0)return Promise.all(o).then(()=>{const s=Cc(this.str);this.renderParts=Dt.getRenderParts(s,this.baseStyle,this.loose)})}render(e){e.save();let n=null;for(const o of this.renderParts)o.type==="character"&&(o.style!==n&&(n=o.style,Bi(n,e)),n.strokeWidth>0&&n.strokeColor>""&&e.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type==="character"&&(o.style!==n&&(n=o.style,Bi(n,e)),e.fillText(o.character,o.x,o.y));e.restore()}quote(){let e;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(e||(e={}));let n=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const l=this.renderParts[r];if(l.type==="character")switch(o){case 0:if(l.character.match(/\s/))continue;l.character==='"'?(o=1,n=r):l.character==="*"?(o=3,n=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:ss(l.style,'"')}),r++,n=r,o=2);break;case 1:n=r,l.character==='"'&&(o=0);break;case 2:if(l.character.match(/\s/))continue;l.character==="*"&&(this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:ss(l.style,'"')}),o=3,r++),n=r;break;case 3:l.character==="*"&&(o=0),n=r;break;default:throw new Mt.UnreachableCaseError(o)}}const s=this.renderParts[n];s&&o===3&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:ss(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:ss(s.style,'"')})}applyLayout(e,n,o,s,r){const l=this.renderParts,a=[];let i=null,u=0,c=0;const f=()=>{i={type:"group",renderParts:[],height:0,width:0},u=s,c=-1,a.push(i)};f();for(const m of l)if(m.type==="newline"||m.type==="alignment")if(a.push(m),m.type==="alignment"&&r){const j=u;f(),u=j}else f();else{if(u<m.width&&r){const j={type:"newline",height:m.height,width:m.height,x:0,y:0};if(m.character===" "){a.push(j),f();continue}else if(c!==-1){const P=i.renderParts.splice(c).slice(1),A=P.reduce((M,Y)=>M+Y.width,0),D=P.reduce((M,Y)=>M>Y.height?M:Y.height,0);i.width-=A,i.height===D&&(i.height=i.renderParts.reduce((M,Y)=>M>Y.height?M:Y.height,0)),a.push(j),f(),i.renderParts=P,i.width=A,i.height=D,u-=A}}else m.character===" "&&(c=i.renderParts.length);i.renderParts.push(m),i.height=Math.max(i.height,m.height),i.width+=m.width,u-=m.width}const p=[];let g=0;for(const m of a)g=Math.max(g,m.height),m.type==="newline"&&(p.push(g),g=0);p.push(g);let b=0,_=e,w=o,k=0,v=s;for(const m of a){if(m.type==="newline"){w+=p[++b]||0,k=0,v=s;continue}if(m.type==="alignment"){_=m.alignment;continue}switch(_){case"left":h(m,k,w),k+=m.width;break;case"center":h(m,k+(v-k)/2-m.width/2,w);break;case"right":h(m,v-m.width,w),v-=m.width;break}}this.lastLayoutHeight=w,this.lastLayoutWidth=s;function h(m,j,P){let A=j;for(const D of m.renderParts)D.y=P,D.x=n+A,A+=D.width}}getHeight(e){let n=0,o=0;const s=e===0?this.renderParts:Dt.applyLineWrapping(this.renderParts.slice(0),e);for(const r of s)n=Math.max(n,r.height),r.type==="newline"&&(o+=n,n=0);return o+=n,o}getWidth(){let e=0,n=0;for(const o of this.renderParts)e+=o.width,o.type==="newline"&&(n=Math.max(n,e),e=0);return n=Math.max(n,e),n}static getRenderParts(e,n,o){const s=[],r=[],l=[];let a=Ic(n),i=n,u=null;function c(f){for(const p of f)s.push({type:"character",character:p,height:a,width:ss(i,p),style:i,x:0,y:0})}for(const f of e){const p=f.type;switch(p){case"command":if(f.commandName==="align"){const g=f.argument.toLowerCase();if(g!=="left"&&g!=="center"&&g!=="right")if(o){c("{align="+f.argument+"}");continue}else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);s.push({type:"alignment",alignment:g,height:a,width:0,x:0,y:0})}else if(Oc.has(f.commandName)){r.push(i),l.push(u);try{i=Oc.get(f.commandName)(i,f.argument),a=Ic(i),u=f}catch(g){if(o){r.pop(),l.pop(),c("{"+f.commandName+(f.argument?"="+f.argument:"")+"}"),console.error("Parsing error",g);continue}else throw g}}else if(o)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!u)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==u.commandName)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${u}' first. (Opened at position ${u.pos})`);u=l.pop(),i=r.pop();break;case"newline":s.push({height:a,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new Mt.UnreachableCaseError(p)}}return s}static applyLineWrapping(e,n){let o=-1,s=0,r=0;const l=[];for(const a of e)if(a.type==="newline")o=-1,s=0,r=0,l.push(a);else if(a.type==="alignment")console.error("Alignment in context where it's not supported.");else if(a.type==="character")a.character===" "?s>n?(o=-1,s=0,r=0,l.push({type:"newline",height:a.height,width:0,x:0,y:0})):(s+=a.width,r=s,o=l.length,l.push(a)):(s+=a.width,s>n&&o!==-1&&(s-=r,l.splice(o,1,{type:"newline",height:a.height,width:0,x:0,y:0}),o=-1,r=0),l.push(a));else throw new Mt.UnreachableCaseError(a);return l}}const Da=ro();Da.width=0;Da.height=0;const Sc=Da.getContext("2d");let $c=null;function ss(t,e){t!==$c&&(Bi(t,Sc),$c=t);let n=t.letterSpacing;return(typeof n!="number"||isNaN(n)||!isFinite(n))&&(n=0),Sc.measureText(e).width+n}const zl=new Map;function Ic(t){const e=t.fontSize+" "+t.fontName;if(zl.has(e))return zl.get(e)*t.lineSpacing;const n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize=`${t.fontSize}px`,n.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=t.fontName,o.style.fontSize=`${t.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(n),document.body.appendChild(o);try{const s=o.offsetHeight;return zl.set(e,s),s*t.lineSpacing}finally{o.remove()}}function Bi(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}class wl extends Lv{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const e=this.preparedTransform;return this.obj.overflow?!0:pe.supports.limitedCanvasSpace?!1:!(e.a===1&&e.b===0&&e.c===0&&e.d===1)}}var gC=Object.defineProperty,mC=(t,e,n)=>e in t?gC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jc=(t,e,n)=>mC(t,typeof e!="symbol"?e+"":e,n);class bC extends wl{constructor(){super(...arguments),jc(this,"_height",0),jc(this,"choiceRenderers",[])}get height(){const e=ue().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=ue().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e){const n=ue().Choices,o=this.obj.width,s=n.ChoiceOuterPadding;let r=n.ChoiceOuterPadding;for(const l of this.choiceRenderers){const a=l.getHeight(this.obj.autoWrap?o:0);e.strokeStyle=n.ChoiceButtonBorderColor,e.lineWidth=n.Outline,e.fillStyle=n.ChoiceButtonColor,e.fillRect(s,r,o,a+n.ChoicePadding*2),e.strokeRect(s,r,o,a+n.ChoicePadding*2),l.applyLayout("center",s+n.ChoicePadding,r+n.ChoiceSpacing*1.25,o-n.ChoicePadding*2,this.obj.autoWrap?o:0),l.render(e),r+=a+n.ChoicePadding*2+n.ChoiceSpacing}}prepareRender(e){const n=ue();this.choiceRenderers=this.obj.choices.map(r=>new Dt(r.text||" ",n.Choices.ChoiceTextStyle));const o=()=>(this._height=this.choiceRenderers.reduce((r,l)=>r+l.getHeight(this.obj.autoWrap?this.obj.width:0)+n.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e)),s=this.choiceRenderers.map(r=>r.loadFonts()).filter(r=>r!==void 0);if(s.length===0)o();else return Promise.all(s).then(o)}}var yC=Object.defineProperty,_C=(t,e,n)=>e in t?yC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rr=(t,e,n)=>_C(t,typeof e!="symbol"?e+"":e,n);class wC extends wl{constructor(){super(...arguments),rr(this,"_height",0),rr(this,"_width",0),rr(this,"_textRenderer",null),rr(this,"_buttonRenderer",null)}get height(){const e=ue().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=ue().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e){const n=super.prepareRender(e),o=ue().Notification,s=this._textRenderer=new Dt(this.obj.text,o.NotificationTextStyle),r=this._buttonRenderer=new Dt("OK",o.NotificationOkTextStyle),l=s.loadFonts(),a=r.loadFonts(),i=()=>{const u=this.obj.autoWrap?this.obj.width-o.NotificationPadding*2:0,c=this.obj.autoWrap?u:s.getWidth(),f=s.getHeight(u),p=this.obj.autoWrap?u:r.getWidth(),g=r.getHeight(u);this._width=Math.max(c,p)+o.NotificationPadding*2,this._height=f+o.NotificationPadding*2+o.NotificationSpacing+g};if(n||l||a)return Promise.all([n,l,a]).then(i);i()}render(e,n,o,s,r){return this.obj.backdrop&&Ln(e,()=>{const l=ue();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,n,o,s,r)}renderLocal(e){const n=ue();this.obj.autoWrap&&this.obj.width-n.Notification.NotificationPadding*2;const o=this._textRenderer,s=this._buttonRenderer,r=this._width,l=this._height,a=n.Choices.ChoiceOuterPadding;e.fillStyle=n.Choices.ChoiceButtonColor,e.strokeStyle=n.Choices.ChoiceButtonBorderColor,e.lineWidth=n.Choices.Outline,e.fillRect(a,a,r,l),e.strokeRect(a,a,r,l),o.applyLayout("center",a+n.Notification.NotificationPadding,a+n.Notification.NotificationPadding*1.5,r-n.Notification.NotificationPadding*2,!1),o.render(e),s.applyLayout("center",a,a+l-n.Notification.NotificationPadding,r+a,!1),s.render(e)}}var PC=Object.defineProperty,CC=(t,e,n)=>e in t?PC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lr=(t,e,n)=>CC(t,typeof e!="symbol"?e+"":e,n),xC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const kC=-2,OC=26,SC=10,$C=10;class IC extends wl{constructor(){super(...arguments),lr(this,"_paperHeight",null),lr(this,"_paperWidth",null),lr(this,"_paper",null),lr(this,"_lastPaperUrl",null)}get height(){var e;return(e=this._paperHeight)!=null?e:this.obj.height}get width(){var e;return(e=this._paperWidth)!=null?e:this.obj.width}prepareRender(e){const n=super.prepareRender(e),o=ue().Poem,s=o.poemBackgrounds[this.obj.background],r=o.poemTextStyles[this.obj.font],a=new Dt(this.obj.text,r).loadFonts();let i;if(s.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==s.file&&(i=xC(this,null,function*(){this._paper=yield Eo(`assets/poemBackgrounds/${s.file}`),this._lastPaperUrl=s.file,this._paperHeight=this._paper.height*o.backgroundScale,this._paperWidth=this._paper.width*o.backgroundScale})),n||a||i)return Promise.all([n,a,i])}renderLocal(e){const n=ue().Poem,o=n.poemBackgrounds[this.obj.background],s=this.width,r=this.height;let l=n.poemPadding,a=n.poemTopPadding,i=l*2;if(o.file==="internal:console")e.fillStyle=this.obj.consoleColor||n.consoleBackgroundColor,e.fillRect(0,0,s,r),l=kC,a=OC,i=SC;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:s,h:r}),!this.obj.overflow)){const f=new Path2D;f.rect(0,0,s,r),e.clip(f)}const u=n.poemTextStyles[this.obj.font],c=new Dt(this.obj.text,u);c.applyLayout("left",$C+l,l+a,this.width-i,this.obj.autoWrap),c.render(e)}}class jC extends Nv{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}var TC=Object.defineProperty,AC=(t,e,n)=>e in t?TC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,EC=(t,e,n)=>AC(t,e+"",n),RC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class La{constructor(e){this.base=e,EC(this,"nextArrow",null)}static get defaultWidth(){return zo}static get defaultHeight(){return al+so}static get defaultX(){return ue().Base.screenWidth/2}static get defaultY(){return ue().Base.screenHeight-this.defaultHeight/2-ue().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Oa}getControlsDisabledStyle(){return Vp}get textboxStyle(){return Sa}renderControls(e,n){const s=this.width/2,r=this.getControlsStyle();_s(e,r),e.fillText("History",s+_a,n),_s(e,this.base.obj.skip?r:this.getControlsDisabledStyle()),e.fillText("Skip",s+wa,n),_s(e,r),e.fillText("Auto   Save   Load   Settings",s+Pa,n)}prepare(){if(!(this.nextArrow instanceof no))return RC(this,null,function*(){this.nextArrow=yield As("next")})}}var BC=Object.defineProperty,MC=(t,e,n)=>e in t?BC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jn=(t,e,n)=>MC(t,typeof e!="symbol"?e+"":e,n),Tc=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class qo extends La{constructor(){super(...arguments),jn(this,"backgroundImage","textbox"),jn(this,"xOffset",0),jn(this,"nameBoxAsset",null),jn(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return al+so}get width(){return zo}get nameboxWidth(){return Vs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return dl}get textOffsetX(){return Fs}get textOffsetY(){return ul}renderNamebox(e,n,o){var s;(s=this.nameBoxAsset)==null||s.paintOnto(e,{x:n,y:o})}renderBackdrop(e,n,o){var s;n+=this.xOffset,(s=this.backdropAsset)==null||s.paintOnto(e,{x:n,y:o})}render(e){var n;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,l=r-ya;this.obj.controls&&this.renderControls(e,l),this.obj.continue&&((n=this.nextArrow)==null||n.paintOnto(e,{x:o-Ca,y:r-xa}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof no?void 0:Tc(this,null,function*(){this.backdropAsset=yield As(this.backgroundImage)}),this.nameBoxAsset instanceof no?void 0:Tc(this,null,function*(){this.nameBoxAsset=yield As("namebox")})])}}jn(qo,"id","normal");jn(qo,"label","Normal");jn(qo,"priority",0);jn(qo,"gameMode","ddlc");var DC=Object.defineProperty,LC=(t,e,n)=>e in t?DC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lo=(t,e,n)=>LC(t,typeof e!="symbol"?e+"":e,n);class Us extends qo{constructor(){super(...arguments),Lo(this,"backgroundImage","textbox_monika"),Lo(this,"xOffset",(zo-ba)/2)}}Lo(Us,"id","corrupt");Lo(Us,"label","Corrupted");Lo(Us,"priority",1);Lo(Us,"gameMode","ddlc");var NC=Object.defineProperty,FC=Object.defineProperties,VC=Object.getOwnPropertyDescriptors,Ac=Object.getOwnPropertySymbols,HC=Object.prototype.hasOwnProperty,UC=Object.prototype.propertyIsEnumerable,Mi=(t,e,n)=>e in t?NC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WC=(t,e)=>{for(var n in e||(e={}))HC.call(e,n)&&Mi(t,n,e[n]);if(Ac)for(var n of Ac(e))UC.call(e,n)&&Mi(t,n,e[n]);return t},zC=(t,e)=>FC(t,VC(e)),Tn=(t,e,n)=>Mi(t,typeof e!="symbol"?e+"":e,n);class Ko extends La{constructor(){super(...arguments),Tn(this,"_dotPattern",null),Tn(this,"_lastColor",null),Tn(this,"backgroundImage","textbox"),Tn(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){var e;return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:(e=this.obj.customNameboxWidth)!=null?e:Vs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return zC(WC({},dl),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return Fs}get textOffsetY(){return ul}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:Ip}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Fe.fromCss(this.customColor).toHSL().shift(jp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Fe.fromCss(this.customColor).toHSL().shift(Tp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Ln(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),Dv(e,n,o,s,r,Rp),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Fe.fromCss(this.nameboxBackgroundColor),i=new Fe(a.r,a.g,a.b,.95),u=i.toHSL().shift(Ep).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(Ap,i.toCss()),l.addColorStop(1,u.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=Fe.fromCss(this.customColor),s=o.toHSL(),r=this.obj.height-n,l=this.obj.width,a=()=>Mv(e,yo/2,n+yo/2,l-yo,r-yo,Bp);Ln(e,()=>{e.beginPath(),a(),e.clip();const u=e.createLinearGradient(0,n,0,r);u.addColorStop(0,o.toCss()),u.addColorStop(1,`rgba(${o.r},${o.g},${o.b},0.6667)`),e.fillStyle=u,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,l,r),Ln(e,()=>{e.translate(0,n),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,0,l,r)});const c=e.createLinearGradient(0,n+r-Oi,0,n+r);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=c,e.beginPath(),e.ellipse(l/2,n+r,Fp,Oi,0,0,2*Math.PI),e.closePath(),e.fill()});const i=s.shift(Mp).toRgb().toCss();e.strokeStyle=i,e.lineWidth=yo,e.beginPath(),a(),e.stroke()}render(e){const n=this.obj.height,o=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-ya;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-Ca,y:s-xa})}getDotPattern(e=Dp){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;this._lastColor=this.customColor;const{dotPatternSize:n,dotColorDelta:o,dotRadius:s}=e,r=Fe.fromCss(this.customColor).toHSL(),l=ro();l.height=n,l.width=n;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=r.shift(o).toRgb().toCss();function i(c,f){a.beginPath(),a.ellipse(c,f,s,s,0,0,2*Math.PI),a.closePath(),a.fill()}i(0,0),i(n,0),i(0,n),i(n,n),i(n/2,n/2);const u=a.createPattern(l,"repeat");if(!u)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=u,u}}Tn(Ko,"id","custom");Tn(Ko,"label","Custom");Tn(Ko,"priority",0);Tn(Ko,"gameMode","ddlc");var GC=Object.defineProperty,XC=(t,e,n)=>e in t?GC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fv=(t,e,n)=>XC(t,typeof e!="symbol"?e+"":e,n),YC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Vv=class Hv{constructor(e){this.base=e,Fv(this,"nextArrow",null)}static get resizable(){return!1}static get defaultWidth(){return ja}static get defaultHeight(){return lh+Aa}static get defaultX(){return ue().Base.screenWidth/2}static get defaultY(){return ue().Base.screenHeight-this.defaultHeight/2-ue().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Nr}getControlsDisabledStyle(){return mh}renderControls(e,n){const o=this.width,s=o/2,l=s-s,a=this.getControlsStyle(),i=["History","Skip","Auto","Save","Load","Settings"],u=[];let c=0;for(const g of i){const b=Hv.controlWidth(e,g);u.push(b),c+=b}const f=Math.min((o-c)/(i.length+2),78);let p=l+(o-c-f*(i.length-1))/2;for(let g=0;g<i.length;++g){const b=i[g],_=u[g],w=b==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():a;_s(e,w),e.fillText(b,p,n),p+=_+f}}static controlWidth(e,n){if(this.widthCache[n])return this.widthCache[n];_s(e,Nr);const o=e.measureText(n).width;return this.widthCache[n]=o,o}prepare(){if(!(this.nextArrow instanceof no))return YC(this,null,function*(){this.nextArrow=yield As("next_plus")})}};Fv(Vv,"widthCache",{});let qC=Vv;var KC=Object.defineProperty,JC=Object.defineProperties,ZC=Object.getOwnPropertyDescriptors,Ec=Object.getOwnPropertySymbols,QC=Object.prototype.hasOwnProperty,ex=Object.prototype.propertyIsEnumerable,Di=(t,e,n)=>e in t?KC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,tx=(t,e)=>{for(var n in e||(e={}))QC.call(e,n)&&Di(t,n,e[n]);if(Ec)for(var n of Ec(e))ex.call(e,n)&&Di(t,n,e[n]);return t},nx=(t,e)=>JC(t,ZC(e)),An=(t,e,n)=>Di(t,typeof e!="symbol"?e+"":e,n);class Ws extends qC{constructor(){super(...arguments),An(this,"_lastColor",null),An(this,"_dotPattern",null),An(this,"backgroundImage","textbox"),An(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ea}get nameboxHeight(){return Aa}get nameboxOffsetX(){return Ra}get nameboxOffsetY(){return ah}get nameboxStyle(){return nx(tx({},gh),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return Ta}get textOffsetY(){return ih}get textboxStyle(){return bh}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:Yp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Fe.fromCss(this.customColor).toHSL().shift(qp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Fe.fromCss(this.customColor).toHSL().shift(Kp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Ln(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),Dv(e,n,o,s,r,Qp),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Fe.fromCss(this.nameboxBackgroundColor),i=new Fe(a.r,a.g,a.b,.95),u=i.toHSL().shift(Zp).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(Jp,i.toCss()),l.addColorStop(1,u.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=this.obj.height-n,s=this.obj.width,r=Fe.fromCss(this.customColor).toHSL(),l=()=>Mv(e,_o/2,n+_o/2,s-_o,o-_o,eh);Ln(e,()=>{e.beginPath(),l(),e.clip();const i=e.createLinearGradient(0,n,0,n+o),u=Fe.fromHex(this.customColor);i.addColorStop(0,u.toCss()),i.addColorStop(1,`rgba(${u.r},${u.g},${u.b},0.6667)`),e.fillStyle=i,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,s,o),e.strokeRect(0,n,s,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,n,s,o);const c=e.createLinearGradient(0,n+o-Si,0,n+o);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=c,e.beginPath(),e.ellipse(s/2,n+o,vh,Si,0,0,2*Math.PI),e.closePath(),e.fill()});const a=r.shift(th).toRgb().toCss();e.strokeStyle=a,e.lineWidth=_o,e.beginPath(),l(),e.stroke()}render(e){const n=this.obj.height,o=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-uh;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-ph,y:s-hh})}getDotPattern(){return Ko.prototype.getDotPattern.call(this,nh)}}An(Ws,"id","custom_plus");An(Ws,"label","Custom (Plus)");An(Ws,"priority",0);An(Ws,"gameMode","ddlc_plus");var ox=Object.defineProperty,sx=(t,e,n)=>e in t?ox(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pl=(t,e,n)=>sx(t,typeof e!="symbol"?e+"":e,n),rx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class zs extends La{static get resizable(){return!0}get height(){return al+so}get width(){return zo}get nameboxWidth(){return Vs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return dl}get textOffsetX(){return Fs}get textOffsetY(){return ul}get textboxStyle(){return Sa}render(){return rx(this,null,function*(){})}}Pl(zs,"id","none");Pl(zs,"label","None");Pl(zs,"priority",0);Pl(zs,"gameMode","ddlc");var lx=Object.defineProperty,ix=(t,e,n)=>e in t?lx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rs=(t,e,n)=>ix(t,typeof e!="symbol"?e+"":e,n);const ax=[qo,Us,Ko,zs,Ws],ws=(()=>{const t={};for(const e of ax)t[e.id]=e;return t})();class ux extends wl{constructor(){super(...arguments),rs(this,"nbTextRenderer",null),rs(this,"textRenderer",null),rs(this,"_lastRefVars",null),rs(this,"refObject",null),rs(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e,n;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:(n=(e=this.refObject)==null?void 0:e.label)!=null?n:"Missing name"}get canSkipLocal(){var e,n;return super.canSkipLocal&&((n=(e=this._lastRenderer)==null?void 0:e.allowSkippingLocal)!=null?n:!0)}prepareData(e,n){var o;super.prepareData(e,n),typeof this.obj.talkingObjId=="number"&&(this.refObject=(o=e.objects[this.obj.talkingObjId])!=null?o:null)}prepareRender(e){const n=super.prepareRender(e),o=this.textboxRenderer.prepare(),s=this.getRefVars();s!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=s),this.nbTextRenderer=new Dt(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new Dt(this.obj.text,this.textboxRenderer.textboxStyle);const r=this.nbTextRenderer.loadFonts(),l=this.textRenderer.loadFonts();if(!(!n&&!o&&!r&&!l))return Promise.all([n,o,r,l])}renderLocal(e){const n=this.textboxRenderer,o=n.width;if(!this.obj.overflow){const s=new Path2D;s.rect(0,0,n.width,this.height),e.clip(s)}n.render(e),this.obj.talkingObjId!==null&&this.renderName(e),this.renderText(e,0,0,o)}renderName(e){const n=this.textboxRenderer,o=n.nameboxWidth,s=n.nameboxOffsetX,r=n.nameboxOffsetX/2;console.log("rendering name",e.getTransform()),this.nbTextRenderer.applyLayout("center",s+r,n.nameboxOffsetY,o-r*2,!1),this.nbTextRenderer.render(e)}renderText(e,n,o,s){const r=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.applyLayout("left",n+r.textOffsetX,o+r.nameboxHeight+r.textOffsetY,s-r.textOffsetX*2,this.obj.autoWrap),l.render(e)}get forcedStyle(){const e=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,n=ws[e];if(this._lastRenderer&&this._lastRenderer.constructor===n)return this._lastRenderer;const o=new n(this);return this._lastRenderer=o,o}}var cx=Object.defineProperty,dx=(t,e,n)=>e in t?cx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wr=(t,e,n)=>dx(t,typeof e!="symbol"?e+"":e,n),fx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Uv=class Wv{constructor(e,n,o,s){this.store=e,this._panelId=n,this.canvasWidth=o,this.canvasHeight=s,wr(this,"renderObjectCache",new Map),wr(this,"renderer"),wr(this,"_disposed",!1),this.renderer=new wh(o,s)}get panelId(){return this._panelId}setPanelId(e){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==e&&(this._panelId=e,this.renderObjectCache.forEach(n=>{n.dispose()}),this.renderObjectCache.clear())}render(e,n,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),e,n):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const e=new Date,n=`panel-${[e.getFullYear(),`${e.getMonth()+1}`.padStart(2,"0"),`${e.getDate()}`.padStart(2,"0"),`${e.getHours()}`.padStart(2,"0"),`${e.getMinutes()}`.padStart(2,"0"),`${e.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),n)}paintOnto(e,n){this.renderer.paintOnto(e,n)}objectsAt(e,n){const o=new DOMPointReadOnly(e,n);return this.getRenderObjects().filter(s=>s.hitTest(o)).map(s=>s.id)}getLastRenderObject(e){var n;return(n=this.renderObjectCache.get(e))!=null?n:null}renderCallback(e,n){return fx(this,null,function*(){var o,s;if(this._disposed)throw new Error("Disposed scene-renderer called");n.fsCtx.imageSmoothingEnabled=!0,n.fsCtx.imageSmoothingQuality=n.hq?"high":"low",yield(o=this.getBackgroundRenderer())==null?void 0:o.render(n);const r=this.getRenderObjects(),l=new Map,a=new Map;for(const b of r){b.prepareData(this.panel,this.store);const _=b.linkedTo;let w=new DOMMatrixReadOnly;if(_!=null){const k=a.get(_);if(k)w=k;else{const v=l.get(_);v?v.push(b):l.set(_,[b]);continue}}g(b,w)}l.size>0&&console.warn("Not all renderables processed. Infinite loop?");const i=r.map(b=>b.prepareRender(!n.hq)).filter(b=>b!==void 0);i.length>0&&(yield Promise.all(i));const u=this.store.state.ui.selection,c=new Set;u!==null&&p(u,c);const f=(s=document.querySelector(Wv.FocusProp))==null?void 0:s.getAttribute("data-obj-id");for(const b of r){const _=u===b.id,w=f===""+b.id;b.render(n.fsCtx,(_?an.Selected:c.has(b.id)?an.Indirectly:an.None)+(w?an.Focused:an.None),n.preview,n.hq,e)}n.applyFilters([...this.panel.filters]),n.preview&&n.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:yield As("backgrounds/transparent")});function p(b,_){_.add(b);for(const w of r.filter(k=>k.linkedTo===b))p(w.id,_)}function g(b,_){const w=b.prepareTransform(_);a.set(b.id,w);const k=l.get(b.id);if(k){for(const v of k)g(v,w);l.delete(b.id)}}})}getRenderObjects(){const e=this.store.state.panels.panels[this.panelId],n=[...e.order,...e.onTopOrder],o=e.objects,s=Array.from(this.renderObjectCache.keys()).filter(r=>!n.includes(r));for(const r of s)this.renderObjectCache.get(r).dispose(),this.renderObjectCache.delete(r);return n.map(r=>{let l=this.renderObjectCache.get(r);if(!l){const a=o[r],i=a.type;switch(i){case"sprite":l=new jC(a);break;case"character":{const u=a;l=new nC(u,pl(this.store,u));break}case"textBox":l=new ux(a);break;case"choice":l=new bC(a);break;case"notification":l=new wC(a);break;case"poem":l=new IC(a);break;default:throw new Mt.UnreachableCaseError(i)}this.renderObjectCache.set(r,l)}return l})}get panel(){return this.store.state.panels.panels[this.panelId]}getBackgroundRenderer(){const e=this.panel;switch(e.background.current){case"buildin.static-color":return yc.color=e.background.color,yc;default:{const o=this.store.getters["content/getBackgrounds"].get(e.background.current);if(!o)return null;const s=o.variants[e.background.variant];return new HP(e.background.current,s,e.background.flipped,e.background.scaling,e.background.composite,e.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}drawDebugZoom(e,n,o,s,r,l=7){const a=e.fsCtx.getImageData(n,o,s,r),i=document.createElement("canvas");i.width=s,i.height=r,i.getContext("2d").putImageData(a,0,0),e.fsCtx.imageSmoothingEnabled=!1,e.fsCtx.drawImage(i,0,0,s*l,r*l)}};wr(Uv,"FocusProp",typeof CSS!="undefined"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let Li=Uv,ir=null;function No(t){if(ir===null||ir.disposed){if(t.state.panels.currentPanel===-1)return null;const e=ue().Base;ir=new Li(t,t.state.panels.currentPanel,e.screenWidth,e.screenHeight)}return ir}var px=Object.defineProperty,hx=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,Rc=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,mx=Object.prototype.propertyIsEnumerable,Bc=(t,e,n)=>e in t?px(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bx=(t,e)=>{for(var n in e||(e={}))gx.call(e,n)&&Bc(t,n,e[n]);if(Rc)for(var n of Rc(e))mx.call(e,n)&&Bc(t,n,e[n]);return t},yx=(t,e)=>hx(t,vx(e));const _x={setChoicesProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version},setChoiceProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices[e.choiceIdx][e.key]=e.value,++n.version},setChoices(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices=e.choices,++n.version}},wx={createChoice({commit:t,rootState:e,state:n},o){const s=ue(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:yx(bx({},Yo()),{y:s.Choices.ChoiceY,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,id:r,onTop:!0,autoWrap:!0,type:"choice",choiceDistance:s.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:s.Choices.ChoiceButtonColor})}),r},addChoice({state:t,commit:e},n){const o=t.panels[n.panelId].objects[n.id];e("setChoices",{id:n.id,panelId:n.panelId,choices:[...o.choices,{selected:!1,text:n.text}]})},removeChoice({state:t,commit:e},n){const s=[...t.panels[n.panelId].objects[n.id].choices];s.splice(n.choiceIdx,1),s.length===0&&s.push({selected:!1,text:""}),e("setChoices",{id:n.id,panelId:n.panelId,choices:s})}};var Px=Object.defineProperty,Cx=Object.defineProperties,xx=Object.getOwnPropertyDescriptors,Mc=Object.getOwnPropertySymbols,kx=Object.prototype.hasOwnProperty,Ox=Object.prototype.propertyIsEnumerable,Dc=(t,e,n)=>e in t?Px(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sx=(t,e)=>{for(var n in e||(e={}))kx.call(e,n)&&Dc(t,n,e[n]);if(Mc)for(var n of Mc(e))Ox.call(e,n)&&Dc(t,n,e[n]);return t},$x=(t,e)=>Cx(t,xx(e));const Ix={setNotificationProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},jx={createNotification({commit:t,rootState:e,state:n},o){const s=ue(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:$x(Sx({},Yo()),{y:s.Base.screenHeight/2,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,autoWrap:!1,id:r,onTop:!0,type:"notification",customColor:s.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),r}};var Tx=Object.defineProperty,Ax=Object.defineProperties,Ex=Object.getOwnPropertyDescriptors,Lc=Object.getOwnPropertySymbols,Rx=Object.prototype.hasOwnProperty,Bx=Object.prototype.propertyIsEnumerable,Nc=(t,e,n)=>e in t?Tx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mx=(t,e)=>{for(var n in e||(e={}))Rx.call(e,n)&&Nc(t,n,e[n]);if(Lc)for(var n of Lc(e))Bx.call(e,n)&&Nc(t,n,e[n]);return t},Dx=(t,e)=>Ax(t,Ex(e));const Lx={setPoemProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},Nx={createPoem({commit:t,rootState:e,state:n},o){const s=ue(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:{subType:"poem",x:s.Poem.defaultX,y:s.Poem.defaultY,width:s.Poem.defaultPoemWidth,height:s.Poem.defaultPoemHeight,panelId:e.panels.currentPanel,flip:!1,rotation:0,id:r,onTop:!0,opacity:100,type:"poem",version:0,autoWrap:!0,background:s.Poem.defaultPoemBackground,font:s.Poem.defaultPoemStyle,text:`New poem

Click here to edit poem`,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,scaleX:1,scaleY:1,skewX:0,skewY:0,ratio:1,preserveRatio:!0,consoleColor:s.Poem.consoleBackgroundColor,overflow:!1,linkedTo:null}}),r},createConsole({commit:t,rootState:e,state:n},o){const s=ue(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:Dx(Mx({},Yo()),{subType:"console",x:s.Poem.consoleWidth/2,y:s.Poem.consoleHeight/2,width:s.Poem.consoleWidth,height:s.Poem.consoleHeight,panelId:e.panels.currentPanel,id:r,onTop:!0,type:"poem",background:s.Poem.defaultConsoleBackground,font:s.Poem.defaultConsoleStyle,text:`> _
  
  Console command
  Click here to edit`,autoWrap:!0,consoleColor:s.Poem.consoleBackgroundColor})}),r}};var Fx=Object.defineProperty,Vx=Object.defineProperties,Hx=Object.getOwnPropertyDescriptors,Fc=Object.getOwnPropertySymbols,Ux=Object.prototype.hasOwnProperty,Wx=Object.prototype.propertyIsEnumerable,Vc=(t,e,n)=>e in t?Fx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zx=(t,e)=>{for(var n in e||(e={}))Ux.call(e,n)&&Vc(t,n,e[n]);if(Fc)for(var n of Fc(e))Wx.call(e,n)&&Vc(t,n,e[n]);return t},Gx=(t,e)=>Vx(t,Hx(e)),Xx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Yx={},qx={createSprite(t,e){return Xx(this,arguments,function*({commit:n,rootState:o,state:s},r){const l=yield ha(r.assets[0],!1);if(!(l instanceof no))return;const a=s.panels[r.panelId].lastObjId+1;return n("create",{object:Gx(zx({},Yo()),{assets:r.assets,height:l.height,width:l.width,id:a,panelId:o.panels.currentPanel,onTop:!1,type:"sprite",y:ue().Base.screenHeight/2,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})}),a})}};var Kx=Object.defineProperty,Jx=Object.defineProperties,Zx=Object.getOwnPropertyDescriptors,Hc=Object.getOwnPropertySymbols,Qx=Object.prototype.hasOwnProperty,ek=Object.prototype.propertyIsEnumerable,Uc=(t,e,n)=>e in t?Kx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gl=(t,e)=>{for(var n in e||(e={}))Qx.call(e,n)&&Uc(t,n,e[n]);if(Hc)for(var n of Hc(e))ek.call(e,n)&&Uc(t,n,e[n]);return t},Wc=(t,e)=>Jx(t,Zx(e)),tk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const zc=4,nk={setTalkingObject(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setResetBounds(t,e){const n=t.panels[e.panelId].objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,n.skewX=e.resetBounds.skewX,n.skewY=e.resetBounds.skewY,n.scaleX=e.resetBounds.scaleX,n.scaleY=e.resetBounds.scaleY,++n.version},setTextBoxProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},ok={createTextBox({commit:t,state:e,rootState:n},o){var s;const r=ue(),l=e.panels[o.panelId].lastObjId+1,a=r.TextBox.DefaultTextboxStyle,i=ws[a],u=o.resetBounds||{x:i.defaultX,y:i.defaultY,width:i.defaultWidth,height:i.defaultHeight,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0};return t("create",{object:Wc(Gl(Gl({},Yo()),u),{panelId:n.panels.currentPanel,id:l,onTop:!0,type:"textBox",continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:a,overrideColor:!1,customColor:r.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:r.TextBoxCustom.controlsDefaultColor,customNameboxColor:r.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:r.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:(s=o.text)!=null?s:"Click here to edit the textbox",resetBounds:u,overflow:!1})}),l},setStyle({state:t,commit:e},n){const o=ue(),s=t.panels[n.panelId].objects[n.id],r=ws[s.style],l=ws[n.style],a=10;let i=!1;const u={panelId:n.panelId,id:n.id,x:s.x,y:s.y};let c=!1;const f={panelId:n.panelId,id:n.id,width:s.width,height:s.height};l.resizable?(r.defaultWidth!==l.defaultWidth&&(c=!0,f.width=Math.max(f.width+l.defaultWidth-r.defaultWidth,a)),r.defaultHeight!==l.defaultHeight&&(c=!0,f.height=Math.max(f.height+l.defaultHeight-r.defaultHeight,a))):(c=!0,f.width=l.defaultWidth,f.height=l.defaultHeight),r.defaultX!==l.defaultX&&(i=!0,u.x=Fr(-f.width+a,u.x+l.defaultX-r.defaultX,o.Base.screenWidth-a)),r.defaultY!==l.defaultY&&(i=!0,u.y=Fr(-f.height+a,u.y+l.defaultY-r.defaultY,o.Base.screenHeight-a)),i&&e("setPosition",u),c&&e("setSize",f),e("setTextBoxProperty",zv(n.panelId,n.id,"style",n.style))},resetTextboxBounds({commit:t,state:e},n){const o=e.panels[n.panelId].objects[n.id];t("setPosition",{panelId:n.panelId,id:n.id,x:o.resetBounds.x,y:o.resetBounds.y}),t("setSize",{panelId:n.panelId,id:n.id,height:o.resetBounds.height,width:o.resetBounds.width}),t("setRotation",{panelId:n.panelId,id:n.id,rotation:o.resetBounds.rotation}),t("setObjectScale",{panelId:n.panelId,id:n.id,scaleX:o.resetBounds.scaleX,scaleY:o.resetBounds.scaleY}),t("setObjectSkew",{panelId:n.panelId,id:n.id,skewX:o.resetBounds.skewX,skewY:o.resetBounds.skewY})},splitTextbox(t,e){return tk(this,arguments,function*({commit:n,state:o,dispatch:s},r){const l=o.panels[r.panelId].objects[r.id];if(l.type!=="textBox")return;const a=(l.width-zc)/2,i=a/2+zc/2;let u=new DOMMatrixReadOnly().translate(l.x,l.y);l.rotation!==0&&(u=u.rotate(0,0,l.rotation)),l.skewX!==0&&(u=u.skewX(l.skewX)),l.skewY!==0&&(u=u.skewY(l.skewY)),l.flip&&(u=u.flipX()),u=u.scale(l.scaleX,l.scaleY);const c=u.transformPoint(new DOMPointReadOnly(-i,0)),f=u.transformPoint(new DOMPointReadOnly(i,0));n("setResetBounds",{id:r.id,panelId:r.panelId,resetBounds:{x:c.x,y:c.y,width:a,height:l.height,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY}});const p=l.style==="custom_plus"?"custom_plus":"custom";l.style!==p&&(yield s("setStyle",Wc(Gl({},r),{style:p})));const g=yield s("createTextBox",{panelId:r.panelId,resetBounds:{x:f.x,y:f.y,width:a,height:l.height,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY}});yield s("setStyle",{panelId:r.panelId,id:g,style:p}),l.flip&&n("setFlip",{id:g,panelId:r.panelId,flip:l.flip}),n("setLink",{id:g,panelId:r.panelId,link:l.linkedTo,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,x:f.x,y:f.y})})}};function zv(t,e,n,o){return{id:e,panelId:t,key:n,value:o}}var sk=Object.defineProperty,rk=Object.defineProperties,lk=Object.getOwnPropertyDescriptors,Gc=Object.getOwnPropertySymbols,ik=Object.prototype.hasOwnProperty,ak=Object.prototype.propertyIsEnumerable,Xc=(t,e,n)=>e in t?sk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gt=(t,e)=>{for(var n in e||(e={}))ik.call(e,n)&&Xc(t,n,e[n]);if(Gc)for(var n of Gc(e))ak.call(e,n)&&Xc(t,n,e[n]);return t},Yc=(t,e)=>rk(t,lk(e));const uk=gt(gt(gt(gt(gt(gt({create(t,{object:e}){const n=t.panels[e.panelId];e.id>n.lastObjId&&(n.lastObjId=e.id),n.objects[e.id]=e,(e.onTop?n.onTopOrder:n.order).push(e.id)},removeFromList(t,e){const n=t.panels[e.panelId],o=e.onTop?n.onTopOrder:n.order,s=o.indexOf(e.id);o.splice(s,1)},addToList(t,e){const n=t.panels[e.panelId];(e.onTop?n.onTopOrder:n.order).splice(e.position,0,e.id)},setOnTop(t,e){const o=t.panels[e.panelId].objects[e.id];o.onTop=e.onTop},setPosition(t,e){const o=t.panels[e.panelId].objects[e.id];o.x=on(e.x),o.y=on(e.y)},setLink(t,e){const n=t.panels[e.panelId],o=n.objects[e.id];let s=n.objects[e.link];if(!s&&e.link)throw new Error("Linked object does not exist.");if(s===o)throw new Error("Object cannot link to itself.");for(;s;)if(s=n.objects[s.linkedTo],s===o)throw new Error("Objects cannot be linked recursively.");o.linkedTo=e.link,o.x=on(e.x),o.y=on(e.y),o.rotation=on(e.rotation),o.scaleX=on(e.scaleX),o.scaleY=on(e.scaleY),o.skewX=on(e.skewX),o.skewY=on(e.skewY)},setFlip(t,e){const o=t.panels[e.panelId].objects[e.id];o.flip=e.flip},setSize(t,e){const o=t.panels[e.panelId].objects[e.id];o.width=Math.round(e.width*100)/100,o.height=Math.round(e.height*100)/100,++o.version},setRatio(t,e){const o=t.panels[e.panelId].objects[e.id];o.preserveRatio=e.preserveRatio,o.ratio=e.ratio},setRotation(t,e){const o=t.panels[e.panelId].objects[e.id];o.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject(t,e){const n=t.panels[e.panelId];delete n.objects[e.id]},setComposition(t,e){const o=t.panels[e.panelId].objects[e.id];o.composite=e.composite},object_setFilters(t,e){const o=t.panels[e.panelId].objects[e.id];o.filters=e.filters},setLabel(t,e){const o=t.panels[e.panelId].objects[e.id];o.label=e.label,++o.version},setTextboxColor(t,e){const o=t.panels[e.panelId].objects[e.id];o.textboxColor=e.textboxColor,++o.version},setEnlargeWhenTalking(t,e){const o=t.panels[e.panelId].objects[e.id];o.enlargeWhenTalking=e.enlargeWhenTalking,++o.version},setObjectNameboxWidth(t,e){const o=t.panels[e.panelId].objects[e.id];o.nameboxWidth=e.nameboxWidth,++o.version},setObjectScale(t,e){const o=t.panels[e.panelId].objects[e.id];o.scaleX=e.scaleX,o.scaleY=e.scaleY,++o.version},setObjectSkew(t,e){const o=t.panels[e.panelId].objects[e.id];o.skewX=e.skewX<0?180-Math.abs(e.skewX)%180:e.skewX%180,o.skewY=e.skewY<0?180-Math.abs(e.skewY)%180:e.skewY%180,++o.version},setOverflow(t,e){const o=t.panels[e.panelId].objects[e.id];"overflow"in o&&(o.overflow=e.overflow,++o.version)}},Yx),$P),nk),_x),Ix),Lx),ck=gt(gt(gt(gt(gt(gt({removeObject({state:t,commit:e,rootState:n},o){var s;const r=t.panels[o.panelId],l=r.objects[o.id];n.ui.selection===o.id&&e("ui/setSelection",null,{root:!0});for(const a of[...r.onTopOrder,...r.order]){if(l.id===a)continue;const i=r.objects[a];if(i.linkedTo===l.id){const u=No(null),c=u==null?void 0:u.getLastRenderObject(i.id);c?e("setLink",gt({panelId:o.panelId,id:i.id,link:null},Vr(c.preparedTransform))):e("setLink",{panelId:o.panelId,id:i.id,link:null,rotation:i.rotation,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,x:i.x,y:i.y})}i.type==="textBox"&&i.talkingObjId===l.id&&e("setTalkingOther",{id:i.id,talkingOther:(s=l.label)!=null?s:"",panelId:o.panelId})}e("removeFromList",{id:o.id,panelId:o.panelId,onTop:l.onTop}),e("removeObject",{id:o.id,panelId:o.panelId})},setPosition({state:t,commit:e,dispatch:n},o){t.panels[o.panelId].objects[o.id].type==="character"?n("setCharacterPosition",o):e("setPosition",o)},setOnTop({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id];s.onTop!==n.onTop&&(e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{id:n.id,panelId:n.panelId,position:(n.onTop?o.onTopOrder:o.order).length,onTop:n.onTop}),e("setOnTop",{panelId:n.panelId,id:n.id,onTop:n.onTop}))},shiftLayer({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id],r=s.onTop?o.onTopOrder:o.order;let a=r.indexOf(s.id)+n.delta;a<0&&(a=0),a>r.length&&(a=r.length),e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{panelId:n.panelId,id:n.id,position:a,onTop:s.onTop})},setPreserveRatio({commit:t,state:e},n){const s=e.panels[n.panelId].objects[n.id],r=n.preserveRatio?s.width/s.height:0;t("setRatio",{panelId:n.panelId,id:n.id,preserveRatio:n.preserveRatio,ratio:r})},copyObjects({commit:t,state:e},{sourcePanelId:n,targetPanelId:o}){const s=e.panels[n],r=e.panels[o],l=[...s.onTopOrder,...s.order],a=new Map;let i=r.lastObjId;for(const u of l){const c=++i;a.set(u,c)}for(const u of l){const c=s.objects[u],f=JSON.parse(JSON.stringify(c));if("talkingObjId"in f){const p=f;p.talkingObjId!==null&&p.talkingObjId!=="$other$"&&a.has(p.talkingObjId)&&(p.talkingObjId=a.get(p.talkingObjId))}t("create",{object:Yc(gt({},f),{id:a.get(u),panelId:o})})}},copyObjectToClipboard({commit:t,state:e},{id:n,panelId:o}){const s=e.panels[o],r=s.objects[n],l=Object.values(s.objects),a=[r];i(r);function i(u,c=!0){if(!c&&u===r)throw new Error("Recursively linked object");for(const f of l)f.linkedTo===u.id&&(a.push(f),i(f,!1))}t("ui/setClipboard",JSON.stringify(a),{root:!0})},pasteObjectFromClipboard({commit:t,state:e,rootState:n}){var o;if(n.ui.clipboard==null)return;const s=JSON.parse(n.ui.clipboard),r=e.panels[e.currentPanel],l=new Map;let a=r.lastObjId;for(const i of s){const u=++a;l.set(i.id,u),i.id=u}for(const i of s)i.linkedTo!=null&&(i.linkedTo=(o=l.get(i.linkedTo))!=null?o:null),t("create",{object:Yc(gt({},i),{panelId:e.currentPanel})})},object_addFilter({state:t,commit:e},n){ji(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_removeFilter({state:t,commit:e},n){Ti(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_moveFilter({state:t,commit:e},n){Ai(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_setFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))}},qx),jP),ok),wx),jx),Nx);function dk(t,e){const n=t.state.panels;for(const o in n){const s=n[o];for(const r in s.objects){const l=s.objects[r];l.type==="character"&&TP(t,l.panelId,l.id,e)}}}function on(t){return Math.round(t*100)/100}var fk=Object.defineProperty,pk=Object.defineProperties,hk=Object.getOwnPropertyDescriptors,qc=Object.getOwnPropertySymbols,vk=Object.prototype.hasOwnProperty,gk=Object.prototype.propertyIsEnumerable,Kc=(t,e,n)=>e in t?fk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xl=(t,e)=>{for(var n in e||(e={}))vk.call(e,n)&&Kc(t,n,e[n]);if(qc)for(var n of qc(e))gk.call(e,n)&&Kc(t,n,e[n]);return t},mk=(t,e)=>pk(t,hk(e)),Pr=(t=>(t[t.None=0]="None",t[t.Stretch=1]="Stretch",t[t.Cover=2]="Cover",t))(Pr||{});const bk="buildin.transparent",ar={panelToUrl:new Map,urlToPanel:new Map,register(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister(t,e){if(this.urlToPanel.has(e)){const n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),n.length===0&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},yk={namespaced:!0,state:{lastPanelId:-1,panels:{},panelOrder:[],currentPanel:null},mutations:Xl({setCurrentPanel(t,{panelId:e}){t.currentPanel=e},setPanelPreview(t,{panelId:e,url:n}){t.panels[e].lastRender=n,ar.register(e,n)},createPanel(t,{panel:e}){t.lastPanelId=e.id,t.panels[e.id]=e},setPanelOrder(t,{panelOrder:e}){t.panelOrder=[...e]},setCurrentBackground(t,{current:e,panelId:n}){const o=t.panels[n];o.background.current=e,o.background.variant=0},setBackgroundColor(t,{color:e,panelId:n}){const o=t.panels[n];o.background.color=e},setBackgroundFlipped(t,{flipped:e,panelId:n}){const o=t.panels[n];o.background.flipped=e},setBackgroundVariant(t,{variant:e,panelId:n}){const o=t.panels[n];o.background.variant=e},setBackgroundScaling(t,{scaling:e,panelId:n}){const o=t.panels[n];o.background.scaling=e},deletePanel(t,{panelId:e}){ar.unregister(e,ar.panelToUrl.get(e)),delete t.panels[e]},setComposition(t,e){const n=t.panels[e.panelId];n.composite=e.composite},setFilters(t,e){const n=t.panels[e.panelId];n.filters=e.filters},backgroundSetComposition(t,e){const n=t.panels[e.panelId];n.background.composite=e.composite},backgroundSetFilters(t,e){const n=t.panels[e.panelId];n.background.filters=e.filters}},uk),actions:Xl({createPanel({state:t,commit:e}){const n=t.lastPanelId+1;return e("createPanel",{panel:{id:n,background:{color:"#000000",current:bk,flipped:!1,scaling:2,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[],objects:{},onTopOrder:[],order:[],lastObjId:-1}}),e("setPanelOrder",{panelOrder:[...t.panelOrder,n]}),e("setCurrentPanel",{panelId:n}),n},duplicatePanel({state:t,commit:e},{panelId:n}){const o=t.panels[n],s=t.lastPanelId+1;ar.register(s,o.lastRender);const r=JSON.parse(JSON.stringify(o));let l=-1;const a=new Map,i={};for(const c in r.objects)a.set(+c,++l);for(const c in r.objects){const f=r.objects[c],p=a.get(+c);if(i[p]=f,f.panelId=s,f.id=p,"talkingObjId"in f){const g=f;g.talkingObjId!==null&&g.talkingObjId!=="$other$"&&a.has(g.talkingObjId)&&(g.talkingObjId=a.get(g.talkingObjId))}f.linkedTo!=null&&(f.linkedTo=a.get(f.linkedTo))}e("createPanel",{panel:mk(Xl({},r),{id:s,lastObjId:l,objects:i,order:r.order.map(c=>a.get(c)),onTopOrder:r.onTopOrder.map(c=>a.get(c))})});const u=t.panelOrder.indexOf(n);e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,u+1),s,...t.panelOrder.slice(u+1)]}),e("setCurrentPanel",{panelId:s})},seekBackgroundVariant({state:t,rootGetters:e,commit:n},{delta:o}){const s=t.panels[t.currentPanel],l=e["content/getBackgrounds"].get(s.background.current);l&&n("setBackgroundVariant",{panelId:t.currentPanel,variant:cs(l.variants,s.background.variant,o)})},delete({state:t,commit:e},{panelId:n}){if(t.panelOrder.length<=1)return;const o=t.panelOrder.indexOf(n);let s;o===t.panelOrder.length-1?s=o-1:s=o+1,e("setCurrentPanel",{panelId:t.panelOrder[s]}),e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,o),...t.panelOrder.slice(o+1)]}),e("deletePanel",{panelId:n})},fixContentPackRemoval(t,e){const{state:n,rootGetters:o,commit:s,rootState:r}=t;for(const l of Object.values(n.panels)){const a=e.backgrounds.find(f=>f.id===l.background.current);if(!a)return;const i=o["content/getBackgrounds"].get(l.background.current);if(!i){r.content.current.backgrounds.length>0?s("setCurrentBackground",{current:r.content.current.backgrounds[0].id,panelId:l.id}):s("setCurrentBackground",{current:"buildin.transparent",panelId:l.id});return}const u=JSON.stringify(a.variants[l.background.variant]),c=i.variants.findIndex(f=>JSON.stringify(f)===u);c!==l.background.variant&&s("setBackgroundVariant",{variant:c===-1?0:c,panelId:l.id})}dk(t,e)},move({state:t,commit:e},{panelId:n,delta:o}){const s=[...t.panelOrder],r=s.indexOf(n);s.splice(r,1);const l=Math.max(r+o,0);s.splice(l,0,n),e("setPanelOrder",{panelOrder:s})},addFilter({state:t,commit:e},n){ji(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},removeFilter({state:t,commit:e},n){Ti(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},moveFilter({state:t,commit:e},n){Ai(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},setFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},backgroundAddFilter({state:t,commit:e},n){ji(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundRemoveFilter({state:t,commit:e},n){Ti(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundMoveFilter({state:t,commit:e},n){Ai(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundSetFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))}},ck)};function Gv(){return{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1}}const _k={namespaced:!0,state:Gv(),mutations:{setVertical(t,e){t.vertical=e},setNsfw(t,e){t.nsfw=e},setLqRendering(t,e){t.lqRendering=e},setSelection(t,e){t.selection=e},setLastDownload(t,e){t.lastDownload=e},setClipboard(t,e){t.clipboard=e},setDarkTheme(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom(t,e){t.defaultCharacterTalkingZoom=e},setColorPicker(t,e){t.pickColor=e}}};var wk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Pk={namespaced:!0,state:{},mutations:{add(t,{name:e,url:n}){t[e]=n}},actions:{add(t,e){return wk(this,arguments,function*({state:n,commit:o,rootState:s},{name:r,url:l}){if(n[r])throw new Error(`There is already an uploaded file called "${r}"`);const a="uploads:"+r;return o("add",{name:a,url:l}),cp(a,l),yield uP(s,o,a),a})}}};var Ck=Object.defineProperty,xk=Object.defineProperties,kk=Object.getOwnPropertyDescriptors,Jc=Object.getOwnPropertySymbols,Ok=Object.prototype.hasOwnProperty,Sk=Object.prototype.propertyIsEnumerable,Zc=(t,e,n)=>e in t?Ck(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yl=(t,e)=>{for(var n in e||(e={}))Ok.call(e,n)&&Zc(t,n,e[n]);if(Jc)for(var n of Jc(e))Sk.call(e,n)&&Zc(t,n,e[n]);return t},Qc=(t,e)=>xk(t,kk(e)),ur=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function Ne(){return Xb()}const $k=cy({state:{unsafe:!1},mutations:Yl({setUnsafe(t,e){t.unsafe=e}},aP),actions:{removePacks(t,e){return ur(this,arguments,function*({dispatch:n,commit:o},{packs:s}){o("setUnsafe",!0),yield n("content/removeContentPacks",s),o("setUnsafe",!1)})},getSave(t,e){return ur(this,arguments,function*({state:n},o){const s=yield Ro.getInstance();return JSON.stringify(Qc(Yl({},n),{version:2.5}),(r,l)=>{if(r!=="ui"&&r!=="lastRender")return r==="uploadUrls"?Object.keys(l):r==="content"&&o?l.contentPacks.filter(a=>{var i,u;return!((i=a.packId)!=null&&i.startsWith("dddg.buildin."))||((u=a.packId)==null?void 0:u.endsWith(".nsfw"))}).map(a=>{var i;let u=(i=a.packId)!=null&&i.startsWith("dddg.uploads.")?a:a.packId;if(a.packId!=null){const c=s.getPack(a.packId);c&&c.repoUrl!=null&&(u+=`;${c.repoUrl}`)}return u}):l},2)})},loadSave(t,e){return ur(this,arguments,function*({state:n},o){const s=JSON.parse(o),r=s.content;s.ui=Qc(Yl({},Gv()),{vertical:n.ui.vertical,lqRendering:n.ui.lqRendering,nsfw:r.find(i=>typeof i=="string"&&i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw"))!==void 0,clipboard:n.ui.clipboard,useDarkTheme:n.ui.useDarkTheme,defaultCharacterTalkingZoom:n.ui.defaultCharacterTalkingZoom}),s.uploadUrls={},s.content=kp();const l=yield Ro.getInstance();s.content.contentPacks=[...n.content.contentPacks.filter(i=>{var u;return(u=i.packId)==null?void 0:u.startsWith("dddg.buildin.")}),...(yield Promise.all(r.map(i=>ur(this,null,function*(){if(typeof i!="string")return i;let u=null,c;i.indexOf(";")>=0?[c,u]=i.split(";"):c=i;const f=n.content.contentPacks.find(b=>b.packId===c);if(f)return f;if(i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw")){const b=yield ki(ca[i]);return yield Lr(b)}u!=null&&!l.hasPack(c)&&(yield l.loadTempPack(u));const p=l.getPack(c);if(!p)return console.warn(`Pack Id ${i} not found!`),null;const g=yield ki(p.dddg2Path||p.dddg1Path);return yield Lr(g)})))).filter(i=>i!==null)];let a=s.content.current;for(const i of s.content.contentPacks)a=yr(a,i);s.content.current=a,(s.version==null||s.version<2.5)&&iP(s),this.replaceState(s),Te.fire(new nl)})}},modules:{ui:_k,panels:yk,content:W_,uploadUrls:Pk}});var Ik=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const jk={key:0},Tk=["onClick"],Ak=["onClick"],Ek=5e3,ql=2e4,ed=100,Rk=Ce({__name:"message-console",props:{loading:{default:!1,type:Boolean}},setup(t){const e=Ne(),n=t,o=L([]),s=L([]),r=L([]),l=L(!1),a=L(0),i=L(0),u=S(()=>e.state.ui.vertical);c(n.loading),Te.subscribe(jr,g=>{o.value.push(`Failed to load asset '${g.path}'`),setTimeout(()=>{o.value.shift()},Ek)}),Te.subscribe(Vf,()=>{o.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{o.value.shift()},ql)}),Te.subscribe(js,g=>{s.value.push(g.message)}),Te.subscribe(ia,g=>{r.value.push(g)}),Te.subscribe(At,g=>{o.value.push(g.message),setTimeout(()=>{o.value.shift()},ql)}),Te.subscribe(Yf,g=>{o.value.push(g.error.name),o.value.push(JSON.stringify(g.error.stack)),o.value.push(g.info),setTimeout(()=>{o.value.shift(),o.value.shift(),o.value.shift()},ql)});function c(g){g?(i.value&&(clearTimeout(i.value),i.value=0),!l.value&&!a.value&&(a.value=setTimeout(()=>{l.value=!0,a.value=0},ed))):(a.value&&(clearTimeout(a.value),a.value=0),l.value&&!i.value&&(i.value=setTimeout(()=>{l.value=!1,i.value=0},ed)))}function f(g){s.value.splice(g,1)}function p(g,b){return Ik(this,null,function*(){const _=r.value[g];r.value.splice(g,1),yield _.actions.find(k=>k.name===b).exec()})}return We(()=>n.loading,g=>{c(g)}),(g,b)=>(x(),R("div",{id:"messageConsole",class:Le({vertical:u.value})},[l.value?(x(),R("p",jk,"Loading...")):de("",!0),(x(!0),R(ae,null,Ue(o.value,(_,w)=>(x(),R("p",{key:_+"_"+w},$e(_),1))),128)),(x(!0),R(ae,null,Ue(r.value,(_,w)=>(x(),R("p",{class:"error",key:"resolvableError_"+w},[U($e(_.message)+" ",1),(x(!0),R(ae,null,Ue(_.actions,k=>(x(),R("a",{href:"#",key:"resolvableError_"+w+k.name,onClick:v=>p(w,k.name)},"["+$e(k.name)+"]",9,Tk))),128))]))),128)),(x(!0),R(ae,null,Ue(s.value,(_,w)=>(x(),R("p",{class:"error",key:"error_"+w},[U($e(_)+" ",1),d("a",{href:"#",onClick:k=>f(w)},"[Dismiss]",8,Ak)]))),128))],2))}}),Me=(t,e)=>{const n=t.__vccOpts||t;for(const[o,s]of e)n[o]=s;return n},Bk=Me(Rk,[["__scopeId","data-v-963b4a0c"]]),Mk={key:0,id:"submit-options"},Dk=["onClick"],Lk={key:0,id:"submit-options"},Nk=["onClick"],Fk=Ce({__name:"modal-dialog",props:{noBaseSize:Boolean,options:{type:Array,default:[]}},emits:["leave","option"],setup(t,{emit:e}){const n=typeof HTMLDialogElement!="undefined",o=t,s=L(null),r=e;function l(){if(n){const u=s.value;u!=null&&!u.open&&u.showModal()}window.addEventListener("click",i)}function a(){if(n){const u=s.value;u!=null&&u.open&&u.close(),r("leave")}window.removeEventListener("click",i)}function i(u){const c=s.value;c!=null&&c.open?u.target===c&&(a(),u.preventDefault(),u.stopPropagation()):window.removeEventListener("click",i)}return mt(l),Cf(l),xf(a),Wt(a),(u,c)=>n?(x(),R("dialog",{key:0,ref_key:"dialog",ref:s,class:Le(["native",{"base-size":!o.noBaseSize}]),onCancel:a},[Qt(u.$slots,"default",{},void 0,!0),t.options.length>0?(x(),R("div",Mk,[(x(!0),R(ae,null,Ue(t.options,f=>(x(),R("button",{key:f,class:"option",onClick:p=>r("option",f)},$e(f),9,Dk))),128))])):de("",!0)],34)):(x(),R("div",{key:1,class:"dialog-wrapper",onClick:c[1]||(c[1]=f=>u.$emit("leave"))},[d("dialog",{ref_key:"dialog",ref:s,open:"",class:Le({"base-size":!o.noBaseSize}),onClick:c[0]||(c[0]=ce(()=>{},["stop"]))},[Qt(u.$slots,"default",{},void 0,!0),t.options.length>0?(x(),R("div",Lk,[(x(!0),R(ae,null,Ue(o.options,f=>(x(),R("button",{key:f,class:"option",onClick:p=>r("option",f)},$e(f),9,Nk))),128))])):de("",!0)],2)]))}}),So=Me(Fk,[["__scopeId","data-v-c2160713"]]),Vk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Hk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Uk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e",Wk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e";var zk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function Fo(t,e){return zk(this,null,function*(){try{yield e()}catch(n){Gk(t,n)}})}function Gk(t,e){console.error("Error in promise",t,e),Te.fire(new js("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+t+'", '+Xk(e)))}function Xk(t){if(t instanceof Error){if(t.stack!=null){const e=t.stack.split(`
`);return e[0].includes(t.name)&&e[0].includes(t.message)?e[0]+`
<br />`+e[1]:t.name+": "+t.message+`
<br />`+e[0]}return t.name+": "+t.message}return t instanceof Object?JSON.stringify(t):""+t}var Yk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())}),td;const On=(td=window.devicePixelRatio)!=null?td:1;function qk(t,e){const n=Zk(e);if(t.save(),nt)o(e,nt.lastPos),nt.grabby.paint(t,nt),t.translate(nt.lastPos.x,nt.lastPos.y),t.scale(On,On),od(t,nt.grabby,new DOMPointReadOnly);else{const s=ue();t.translate(n.x,n.y),t.scale(On,On),e.x>s.Base.screenWidth/2&&t.scale(-1,1),e.y>s.Base.screenHeight/2&&t.scale(1,-1);for(let r=0;r<Gr.length;r++){const l=Gr[r];l.pos||(l.pos=eO(Qk*(r+1))),od(t,l,l.pos)}}t.restore();function o(s,r){t.save();try{t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(r.x,r.y),t.setLineDash([5*On,5*On]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}const zr=2*Math.PI,Gr=[{icon:Uk,iconDark:Wk,paint(t,{lastPos:e,center:n,initialDragAngle:o}){const{angle:s}=cr(ls(n,e)),r=ue().Base,l=$i(o-s,zr);t.beginPath(),t.moveTo(n.x,n.y);let a=o-Math.PI,i=a+s-o;if(l<=Math.PI){const u=i;i=a,a=u}t.arc(n.x,n.y,r.wheelInnerRadius,a,i),t.lineTo(n.x,n.y),t.globalCompositeOperation="difference",t.fillStyle="rgba(255, 255, 255, 1)",t.fill(),t.globalCompositeOperation="source-over"},onStartMove(t,e,n){n.initalObjRotation=e.rotation;const{angle:o}=cr(ls(n.center,n.lastPos));n.initialDragAngle=o},onMove(t,e,n,{center:o,initalObjRotation:s,initialDragAngle:r}){const{angle:l}=cr(ls(o,nt.lastPos));let a=$i(s+(l-r)/Math.PI*180,360);n&&(a=Math.round(a/22.5)*22.5),e.rotation!==a&&t.commit("panels/setRotation",{panelId:e.panelId,id:e.id,rotation:a})}},{icon:Vk,iconDark:Hk,paint(t,{renderObj:e,originalObjTransform:n}){if(n==null)return;const o=e.preparedTransform;try{e.preparedTransform=n,Ln(t,()=>{t.globalAlpha=.5,e.render(t,an.None,!0,!1,!0),t.globalAlpha=1})}finally{e.preparedTransform=o}},onStartMove(t,e,n){n.originalObjTransform=n.renderObj.preparedTransform,n.initialScaleX=e.scaleX,n.initialScaleY=e.scaleY,n.initialDelta=ls(n.center,n.lastPos)},onMove(t,e,n,{initialScaleX:o,initialScaleY:s,initialDelta:r,center:l,lastPos:a}){const i=ue(),u=ls(l,a);let c=u.x/r.x*o,f=u.y/r.y*s;if(n){let p=u;l.x>i.Base.screenWidth/2&&(p=new DOMPointReadOnly(-p.x,p.y)),l.y>i.Base.screenHeight/2&&(p=new DOMPointReadOnly(p.x,-p.y));const{angle:g}=cr(p),b=Math.round(g/zr*11),_=(Math.abs(u.x)/Math.abs(r.x)+Math.abs(u.y)/Math.abs(r.y))/2;b===0||b===11?f=s:b===1?(c=-_*o,f=-_*s):b===2||b===3?c=o:b===4?(c=_*o,f=-_*s):b===5||b===6?f=s:b===7?(c=_*o,f=_*s):b===8||b===9?c=o:b===10&&(c=-_*o,f=_*s)}e.scaleX===c&&e.scaleY===f||t.commit("panels/setObjectScale",{panelId:e.panelId,id:e.id,scaleX:c,scaleY:f})}}];let nt=null;function Kk(t){const e=ue(),n=Gr.find(o=>{const s=o.lastDrawPos;return s?Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))<=e.Base.wheelWidth/2*On:!1});return n?(nt={lastPos:t,started:!1,grabby:n,center:null,renderObj:null},!0):!1}function Jk(t,e,n){var o,s;if(!nt)return!1;const r=t.state.panels,a=r.panels[r.currentPanel].objects[t.state.ui.selection];if(!nt.started){nt.started=!0;const i=No(t),u=i.getLastRenderObject(a.id),c=(s=(o=i==null?void 0:i.getLastRenderObject(a.linkedTo))==null?void 0:o.preparedTransform)!=null?s:new DOMMatrixReadOnly;nt.renderObj=u,nt.center=c.transformPoint(new DOMPointReadOnly(a.x,a.y)),nt.grabby.onStartMove(t,a,nt)}return nt.lastPos=e,nt.grabby.onMove(t,a,n,nt),!0}function nd(){return nt?(nt=null,!0):!1}const Ni=new Map;for(const t of Gr)Fo("Loading grabby icon",(e=>Yk(void 0,null,function*(){Ni.set(e.icon,yield Eo(e.icon)),Ni.set(e.iconDark,yield Eo(e.iconDark))})).bind(void 0,t));function od(t,e,n){var o;const s=ue();t.save(),t.translate(n.x,n.y),e.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,s.Base.wheelWidth/2,s.Base.wheelWidth/2,0,0,zr),t.closePath();const r=getComputedStyle(document.body);t.fillStyle=r.getPropertyValue("--accent-background"),t.strokeStyle=r.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const l=document.body.classList.contains("dark-theme")?e.iconDark:e.icon;(o=Ni.get(l))==null||o.paintOnto(t),t.restore()}function Zk(t){const e=ue(),n=e.Base.wheelWidth+e.Base.wheelInnerRadius*On;return new DOMPointReadOnly(Fr(n,t.x,e.Base.screenWidth-n),Fr(n,t.y,e.Base.screenHeight-n))}const Qk=Math.PI/6;function eO(t){const e=ue().Base;return new DOMPointReadOnly(e.wheelInnerRadius*Math.cos(t),e.wheelInnerRadius*Math.sin(t))}function ls(t,e){return new DOMPointReadOnly(t.x-e.x,t.y-e.y)}function cr(t){const e=Math.atan2(t.y,t.x);return{angle:$i(e,zr),distance:Math.sqrt(t.x*t.x+t.y*t.y)}}var mo=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const tO=["height","width"],nO=Ce({__name:"render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},setup(t,{expose:e}){const n=Ne(),o=t,s=L(null),r=L(null),l=L(null),a=L(!1),i=L(!1),u=S(()=>{var Q;return(Q=n.state.ui.selection)!=null?Q:null}),c=S(()=>n.state.panels.panels[n.state.panels.currentPanel]),f=S(()=>n.state.ui.lqRendering);function p(){if(o.preLoading)return null;const Q=No(n);return Q==null||Q.setPanelId(n.state.panels.currentPanel),Q}const g=S(()=>(o.preLoading,ue().Base.screenHeight)),b=S(()=>(o.preLoading,ue().Base.screenWidth));function _(){l.value==null&&(l.value=requestAnimationFrame(w))}function w(){return mo(this,null,function*(){var Q;if(l.value!=null&&(cancelAnimationFrame(l.value),l.value=null),!o.preLoading&&!n.state.unsafe){try{yield(Q=p())==null?void 0:Q.render(!f.value,!0,!0)}catch(ye){console.log(ye)}v(),Te.fire(new Wf)}})}function k(){const Q=document.createElement("canvas");Q.height=g.value,Q.width=b.value;try{Mo.make(Q,!0,!1).drawText({text:"Starting...",x:Q.width/2,y:Q.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),r.value.drawImage(Q,o.canvasWidth,o.canvasHeight)}finally{Bo(Q)}}function v(){const Q=p();a.value=!1,Q==null||Q.paintOnto(r.value,{x:0,y:0,w:b.value,h:g.value});const ye=Q==null?void 0:Q.getLastRenderObject(u.value);ye&&qk(r.value,ye.preparedTransform.transformPoint(new DOMPoint(0,0))),j.value=!1}function h(Q,ye,Se){const W=s.value,K=Q-W.offsetLeft,ie=ye-W.offsetTop;let be=K/W.offsetWidth*W.width,Re=ie/W.offsetWidth*W.width;if(Se){const y=Se.transformPoint(new DOMPointReadOnly(be,Re));be=y.x,Re=y.y}return[be,Re]}function m(Q){var ye;const[Se,W]=h(Q.clientX,Q.clientY);if(M(Se,W))return;if(i.value){i.value=!1;return}const K=p().objectsAt(Se,W),ie=u.value,be=K.findIndex(y=>y===ie);let Re;be===0?Re=null:be!==-1?Re=K[be-1]:Re=(ye=K[K.length-1])!=null?ye:null,Z(()=>{n.state.ui.selection!==Re&&n.commit("ui/setSelection",Re)})}We(()=>[o.canvasWidth,o.canvasHeight],()=>v()),Te.subscribe(nl,_),Te.subscribe(Xf,()=>{const Q=p();Q&&Q.setPanelId(-1)}),n.subscribe(Q=>{Q.type!=="panels/setPanelPreview"&&Q.type!=="panels/currentPanel"&&_()}),mt(()=>{r.value=s.value.getContext("2d"),k(),_()}),Wt(()=>{p().dispose()});const j=L(!1);function P(Q){return mo(this,null,function*(){if(j.value)w(),j.value=!1;else{const ye=yield Br(Q,!0);r.value.clearRect(0,0,s.value.width,s.value.height),ye.paintOnto(r.value,{x:0,y:0}),j.value=!0}r.value})}const A=S(()=>n.state.ui.pickColor),D=S(()=>A.value?"crosshair":"default");function M(Q,ye){if(A.value){const Se=r.value.getImageData(Q,ye,1,1).data,W=`rgba(${Se[0].toString()},${Se[1].toString()},${Se[2].toString()},${(Se[3]/255).toString()})`;return Z(()=>{n.commit("ui/setColorPicker",!1),Te.fire(new Tr(W))}),!0}return!1}function Y(){return mo(this,null,function*(){const Q=yield p().download();yield Z(()=>{const ye=n.state.ui.lastDownload;n.commit("ui/setLastDownload",Q),ye!=null&&URL.revokeObjectURL(ye)})})}let z=null,F=null,ne=0,le=0,q=0,I=0;function O(Q){Q.preventDefault(),$(Q.clientX,Q.clientY)}function T(Q){$(Q.touches[0].clientX,Q.touches[0].clientY)}function $(Q,ye){var Se,W,K;const ie=u.value;if(ie===null)return;z=c.value.objects[ie],F=(K=(W=(Se=No(n).getLastRenderObject(z.linkedTo))==null?void 0:Se.preparedTransform)==null?void 0:W.inverse())!=null?K:new DOMMatrixReadOnly;const[be,Re]=h(Q,ye,F);ie!=null&&Kk(new DOMPointReadOnly(...h(Q,ye)))||(ne=be-z.x,le=Re-z.y,q=z.x,I=z.y)}function re(Q){Q.stopPropagation(),Q.preventDefault(),Q.dataTransfer.dropEffect="copy"}function me(Q){if(!z)return;Q.preventDefault();const ye=Q instanceof MouseEvent?Q.clientX:Q.touches[0].clientX,Se=Q instanceof MouseEvent?Q.clientY:Q.touches[0].clientY;let[W,K]=h(ye,Se,F);if(Jk(n,new DOMPointReadOnly(...h(ye,Se)),Q.shiftKey)){_();return}W-=ne,K-=le;const ie=Math.abs(W-q),be=Math.abs(K-I);ie+be>1&&(i.value=!0),Q.shiftKey&&(ie>be?K=I:W=q),Z(()=>mo(this,null,function*(){yield n.dispatch("panels/setPosition",{panelId:z.panelId,id:z.id,x:W,y:K})}))}function xe(Q){return mo(this,null,function*(){if(Q.stopPropagation(),Q.preventDefault(),!!Q.dataTransfer){for(const ye of Q.dataTransfer.items)if(ye.kind==="file"&&ye.type.match(/image.*/)){const Se=ye.getAsFile(),W=URL.createObjectURL(Se);try{const K=yield n.dispatch("uploadUrls/add",{name:Se.name,url:W});yield Z(()=>mo(this,null,function*(){yield n.dispatch("panels/createSprite",{panelId:n.state.panels.currentPanel,assets:[{hq:K,lq:K,sourcePack:"dddg.uploaded.sprites"}]})}))}catch(K){URL.revokeObjectURL(W)}}}})}function Ee(Q){if(nd()){_(),Q.preventDefault(),z=null,i.value=!0;return}z&&("TouchEvent"in window&&Q instanceof TouchEvent&&(i.value=!1),z=null)}function Ct(Q){Q.buttons!==1&&(z=null,nd()&&_())}return e({download:Y,blendOver:P}),(Q,ye)=>(x(),R("canvas",{id:"scaled_display",ref_key:"sd",ref:s,height:g.value,width:b.value,style:Qe({width:t.canvasWidth+"px",height:t.canvasHeight+"px",cursor:D.value}),draggable:"true",onClick:m,onTouchstart:T,onDragstart:O,onTouchmove:me,onMousemove:me,onTouchend:Ee,onMouseup:Ee,onDragover:re,onDrop:xe,onMouseenter:Ct,onContextmenu:ye[0]||(ye[0]=ce(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,tO))}}),oO=["disabled","title","aria-label"],sO={key:0,class:"material-icons","aria-hidden":"true"},rO={class:"content"},lO={key:1,class:"shortcut-popup"},iO=Ce({__name:"d-button",props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},shortcut:{type:String,default:null},title:{type:String,default:null}},setup(t){const e=t,n=L(null),o=S(()=>e.shortcut!=null&&!e.shortcut.startsWith("!")),s=S(()=>{const l=e.shortcut;return l==null?"":l.startsWith("!")?l.substring(1):l});function r(l){e.disabled||l.key===e.shortcut&&l.ctrlKey&&!l.altKey&&!l.metaKey&&!l.shiftKey&&(n.value.focus({focusVisible:!1}),n.value.click(),l.preventDefault(),l.stopPropagation())}return mt(()=>{e.shortcut!=null&&window.addEventListener("keydown",r)}),Wt(()=>{window.removeEventListener("keydown",r)}),(l,a)=>{var i,u;return x(),R("button",{class:Le([t.iconPos]),disabled:t.disabled,title:(i=t.title)!=null?i:void 0,"aria-label":(u=t.title)!=null?u:void 0,style:Qe(t.icon?"height: auto":""),ref_key:"btn",ref:n},[t.icon?(x(),R("div",sO,$e(t.icon),1)):de("",!0),d("div",rO,[Qt(l.$slots,"default",{},void 0,!0)]),o.value?(x(),R("div",lO,$e(s.value),1)):de("",!0)],14,oO)}}}),je=Me(iO,[["__scopeId","data-v-f30bce90"]]),aO={methods:{verticalScrollRedirect:Xv}};function Xv(t){if(t.type!=="wheel"||!t.currentTarget)return;const e=t.currentTarget,n=getComputedStyle(e),o=t;if(o.deltaY===0)return;if(n.overflowY==="auto"){if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight){t.stopPropagation();return}}else if(e.scrollTop>0){t.stopPropagation();return}}const s=e.scrollLeft;e.scrollLeft+=o.deltaY,e.scrollLeft!==s&&t.stopPropagation()}function Lt(t){const e=Ne(),n=S(()=>e.state.ui.vertical);function o(){const r=t.value;return r==null?null:r.$el?r.$el:r}function s(){t.value!=null&&o().classList.toggle("vertical",n.value)}return We(()=>n.value,s),mt(()=>{s(),o().addEventListener("wheel",r=>{n.value||Xv(r)},{passive:!0})}),{vertical:n,getRoot:o}}var uO=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const cO=["title","onClick","onKeypress"],dO=["src","alt"],fO=Ce({__name:"character",emits:["show-dialog"],setup(t,{emit:e}){const n=Ne(),o=e,s=S(()=>n.state.content.current.characters);function r(a){return a.chibi?pe.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){Z(()=>uO(this,null,function*(){yield n.dispatch("panels/createCharacters",{characterType:a,panelId:n.state.panels.currentPanel})}))}return(a,i)=>(x(),R(ae,null,[(x(!0),R(ae,null,Ue(s.value,u=>(x(),R("div",{class:"character",tabindex:"0",key:u.id,title:u.label,onClick:ce(c=>l(u.id),["left"]),onKeypress:[lt(ce(c=>l(u.id),["prevent","stop"]),["enter"]),lt(ce(c=>l(u.id),["prevent","stop"]),["space"])]},[d("img",{src:r(u),alt:u.label},null,8,dO)],40,cO))),128)),B(je,{class:"custom-sprite",icon:"extension",onClick:i[0]||(i[0]=u=>o("show-dialog","type: Characters"))},{default:X(()=>[U(" Search in content packs ")]),_:1})],64))}}),pO=Me(fO,[["__scopeId","data-v-86bad64f"]]),hO=Ce({__name:"drop-target",emits:["drop"],setup(t,{expose:e,emit:n}){const o=n,s=Ne(),r=L(!1),l=S(()=>s.state.ui.vertical);function a(){r.value=!0}function i(){r.value=!1}function u(c){if(i(),c.stopPropagation(),c.preventDefault(),!!c.dataTransfer)for(const f of c.dataTransfer.items)f.kind==="file"&&f.type.match(/image.*/)&&o("drop",f.getAsFile())}return e({show:a,hide:i}),(c,f)=>r.value?(x(),R("div",{key:0,onDragleave:f[0]||(f[0]=p=>r.value=!1),onDrop:u,class:Le({vertical:l.value})},[Qt(c.$slots,"default",{},void 0,!0)],34)):de("",!0)}}),Yv=Me(hO,[["__scopeId","data-v-66942715"]]);var vO=Object.defineProperty,gO=Object.defineProperties,mO=Object.getOwnPropertyDescriptors,sd=Object.getOwnPropertySymbols,bO=Object.prototype.hasOwnProperty,yO=Object.prototype.propertyIsEnumerable,rd=(t,e,n)=>e in t?vO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ld=(t,e)=>{for(var n in e||(e={}))bO.call(e,n)&&rd(t,n,e[n]);if(sd)for(var n of sd(e))yO.call(e,n)&&rd(t,n,e[n]);return t},id=(t,e)=>gO(t,mO(e)),sn=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const _O=["title","onClick","onKeypress"],wO=["title","onClick","onKeypress"],PO=Ce({__name:"sprite",emits:["show-dialog"],setup(t,{expose:e,emit:n}){const o=Ne(),s=n,r=S(()=>o.state.content.current.sprites.map(P=>{let A=null;const D=P.variants[0].map(M=>{const Y=Mn(M,!1);return Y.startsWith("uploads:")?(Object.keys(o.state.uploadUrls),A=Y,ap):Y});return id(ld({},P),{missing:A,urls:D})})),l=S(()=>pe.supports.openableFolders.has("sprites"));function a(P){return P.variants[0].map(A=>`url('${Mn(A,!1)}')`).join(",")}function i(P){return sn(this,null,function*(){yield Z(()=>sn(this,null,function*(){yield o.dispatch("panels/createSprite",{panelId:o.state.panels.currentPanel,assets:P.variants[0]})}))})}function u(){pe.openFolder("sprites")}const c=L(null);function f(){return sn(this,null,function*(){const P=c.value,A=P.uploadingSprite;if(!P.files)return;if(P.files.length!==1){console.error("More than one file uploaded!");return}const D=P.files[0];yield Z(()=>sn(this,null,function*(){const M=URL.createObjectURL(D);yield o.dispatch("uploadUrls/add",{name:A,url:M})}))})}function p(P){const A=c.value;A.uploadingSprite=Mn(P.variants[0][0]).substring(8),A.click()}const g={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},b=L(null);function _(){const P=b.value;if(P.files)for(const A of P.files)k(A)}function w(){return sn(this,null,function*(){const P=prompt("Enter the URL of the image");if(P==null)return;const A=P.split("/").slice(-1)[0];yield v(A,P)})}function k(P){return sn(this,null,function*(){yield Z(A=>sn(this,null,function*(){const D=URL.createObjectURL(P),M=yield o.dispatch("uploadUrls/add",{name:P.name,url:D});yield v(P.name,M,A)}))})}function v(P,A){return sn(this,arguments,function*(D,M,Y=Z){const z=o.state.content.contentPacks.find(ne=>ne.packId===g.packId)||g,F=id(ld({},z),{sprites:[...z.sprites,{id:M,label:D,variants:[[{lq:M,hq:M}]],defaultScale:[1,1],hd:null}]});yield Y(()=>sn(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:F,processed:!0})}))})}const h=L(null);function m(P){P.dataTransfer&&(P.dataTransfer.effectAllowed="none",Array.from(P.dataTransfer.items).find(A=>A.type.match(/^image.*$/))&&(P.dataTransfer.effectAllowed="link",h.value.show()))}function j(){h.value.hide()}return e({showDropTarget:m,hideDropTarget:j}),(P,A)=>(x(),R(ae,null,[B(Yv,{ref_key:"spriteDt",ref:h,class:"drop-target",onDrop:k},{default:X(()=>[U("Drop here to add as a new sprite ")]),_:1},512),(x(!0),R(ae,null,Ue(r.value,D=>(x(),R(ae,null,[D.missing!==null?(x(),R("div",{class:"sprite",tabindex:"0",key:`${D.label}_missing`,title:D.label,style:Qe({background:a(D)}),onClick:M=>p(D),onKeypress:[lt(ce(M=>p(D),["prevent","stop"]),["enter"]),lt(ce(M=>p(D),["prevent","stop"]),["space"])]},$e(D.label),45,_O)):(x(),R("div",{class:"sprite",tabindex:"0",key:D.label,title:D.label,style:Qe({background:a(D)}),onClick:M=>i(D),onKeypress:[lt(ce(M=>i(D),["prevent","stop"]),["enter"]),lt(ce(M=>i(D),["prevent","stop"]),["space"])]},$e(D.label),45,wO))],64))),256)),B(je,{class:"custom-sprite v-w100",icon:"publish",onClick:A[0]||(A[0]=D=>b.value.click())},{default:X(()=>[U(" Upload new sprite "),d("input",{type:"file",ref_key:"spriteUpload",ref:b,onChange:_,multiple:""},null,544)]),_:1}),B(je,{icon:"insert_link",onClick:w},{default:X(()=>[U(" New sprite from URL ")]),_:1}),B(je,{icon:"extension",onClick:A[1]||(A[1]=D=>s("show-dialog","type: Sprites"))},{default:X(()=>[U(" Search in content packs ")]),_:1}),l.value?(x(),fe(je,{key:0,icon:"folder",onClick:u},{default:X(()=>[U(" Open sprites folder ")]),_:1})):de("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:c,onChange:f},null,544)],64))}}),CO=Me(PO,[["__scopeId","data-v-2d9f9dd9"]]);var Kn=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const xO=Ce({__name:"ui",setup(t){const e=Ne();function n(){return Kn(this,null,function*(){return yield a("createTextBox")})}function o(){return Kn(this,null,function*(){return yield a("createChoice")})}function s(){return Kn(this,null,function*(){return yield a("createNotification")})}function r(){return Kn(this,null,function*(){return yield a("createPoem")})}function l(){return Kn(this,null,function*(){return yield a("createConsole")})}function a(i){return Kn(this,null,function*(){yield Z(()=>Kn(this,null,function*(){yield e.dispatch(`panels/${i}`,{panelId:e.state.panels.currentPanel})}))})}return(i,u)=>(x(),R(ae,null,[d("button",{class:"v-w100",onClick:n},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:r},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:s},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:o},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}});var kO=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const OO=t=>(_t("data-v-c565e3c1"),t=t(),wt(),t),SO=OO(()=>d("h1",null,"Add",-1)),$O=["innerHTML"],IO=["disabled"],jO=Ce({__name:"add",setup(t){const e={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},n=L(null),o=L("characters"),s=L(null),r=Ne(),{vertical:l}=Lt(n),a=S(()=>r.state.panels.panels[r.state.panels.currentPanel]),i=S(()=>r.state.ui.clipboard!=null);function u(){Z(()=>kO(this,null,function*(){yield r.dispatch("panels/pasteObjectFromClipboard",{panelId:a.value.id})}))}return(c,f)=>(x(),R("div",{class:"panel",ref_key:"root",ref:n,onDragenter:f[2]||(f[2]=(...p)=>{var g,b;return((g=s.value)==null?void 0:g.showDropTarget)&&((b=s.value)==null?void 0:b.showDropTarget(...p))}),onMouseleave:f[3]||(f[3]=(...p)=>{var g,b;return((g=s.value)==null?void 0:g.hideDropTarget)&&((b=s.value)==null?void 0:b.hideDropTarget(...p))})},[SO,d("div",{class:Le({"group-selector":!0,vertical:oe(l)})},[(x(),R(ae,null,Ue(e,(p,g)=>B(je,{key:g,class:Le({active:o.value===g,"v-bl0":g!=="characters","h-bt0":g!=="characters"}),"icon-pos":"top",icon:p.icon,shortcut:p.shortcut,onClick:b=>o.value=g},{default:X(()=>[d("span",{innerHTML:p.text},null,8,$O)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:Le({"item-grid":!0,vertical:oe(l)})},[o.value==="characters"?(x(),fe(pO,{key:0,onShowDialog:f[0]||(f[0]=p=>c.$emit("show-dialog",p))})):o.value==="sprites"?(x(),fe(CO,{key:1,ref_key:"sprites",ref:s,onShowDialog:f[1]||(f[1]=p=>c.$emit("show-dialog",p))},null,512)):o.value==="ui"?(x(),fe(xO,{key:2})):de("",!0),d("button",{class:"v-w100",onClick:u,disabled:!i.value}," Paste ",8,IO)],2)],544))}}),TO=Me(jO,[["__scopeId","data-v-c565e3c1"]]),AO=Ce({mixins:[aO],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.$store.state.ui.vertical?"vertical":"horizontal":this.direction==="inverted"?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render(){const t=this.noWraping?"no-wraping":"wraping",e=yu("div",{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}},this.$slots.default());if(this.maxSize!==void 0){const n=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return yu("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:n}},[e])}return e},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}}),Rt=Me(AO,[["__scopeId","data-v-a60045d3"]]);let Fi=0;typeof BigInt!="undefined"&&(Fi=BigInt(0));function Na(){const t=Fi;return Fi++,t+""}const EO=["for"],RO=["id","x1","x2"],BO=["offset"],MO=["fill"],DO=["d"],LO=["id","max","value"],dr=255,Kl=8,NO=Ce({__name:"slider",props:{label:{type:String,required:!0},gradientStops:{required:!0,type:Array},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{default:!1},noInput:{default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=Na(),o=t,s=Ne(),r=e,l=S(()=>s.state.ui.vertical),a=L(null),i=S(()=>{const _=o.modelValue/o.maxValue*dr;return`M${_} 0L${_+14} 0L${_+7} 12Z`}),u=S(()=>!o.shiftGradient||o.modelValue===0?0:o.modelValue/o.maxValue);function c(_){r("update:modelValue",parseFloat(_.target.value))}const f=L(!1);function p(_){f.value=!0,g(_),_ instanceof MouseEvent&&(window.addEventListener("mousemove",g),window.addEventListener("mouseup",b)),_.preventDefault()}function g(_){if(!f.value)return;const w=a.value;if(_ instanceof MouseEvent&&_.buttons===0){b();return}_.preventDefault();const k=w.getBoundingClientRect(),v=k.width/(Kl+dr+Kl),m=((_ instanceof MouseEvent?_.clientX:_.touches[0].clientX)-k.x)/v,j=Math.max(Math.min(m-Kl,dr),0)/dr*o.maxValue;r("update:modelValue",j),_.preventDefault()}function b(){f.value=!1,window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",b)}return(_,w)=>(x(),R("div",{class:Le({slider:!0,vertical:l.value}),onKeydown:w[1]||(w[1]=ce(()=>{},["stop"]))},[t.noInput?de("",!0):(x(),R("label",{key:0,for:oe(n)},$e(t.label),9,EO)),d("div",null,[(x(),R("svg",{ref_key:"svg",ref:a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:p,onTouchstart:p,onTouchmove:g,onTouchend:b},[d("defs",null,[d("linearGradient",{id:`gradient${oe(n)}`,x1:u.value*100+"%",y1:"0%",x2:(u.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(x(!0),R(ae,null,Ue(t.gradientStops,(k,v)=>(x(),R("stop",{key:v,offset:v/(t.gradientStops.length-1)*100+"%",style:Qe("stop-color:"+k)},null,12,BO))),128))],8,RO)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${oe(n)})`},null,8,MO),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,DO)])],544))]),t.noInput?de("",!0):(x(),R("input",{key:1,id:oe(n),class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:c,onKeydown:w[0]||(w[0]=ce(()=>{},["stop"]))},null,40,LO))],34))}}),Qn=Me(NO,[["__scopeId","data-v-16bd7e31"]]),FO=Ce({__name:"slider-group",props:{modelValue:{type:String,validator:t=>!!t.match(/^#[0-9a-f]{6,8}$/i)},mode:{type:String},relative:Boolean},emits:["update:modelValue"],setup(t,{emit:e}){const n=e,o=t,s=L(null),r=L(0),l=L(0),a=L(0),i=L(0),u=k({rgba:{label:"Red",stops(){const v=o.relative?l.value:0,h=o.relative?a.value:0;return[new Fe(0,v,h,1),new Fe(255,v,h,1)]}},hsla:{label:"Hue",max:360,stops(){const v=o.relative?l.value/100:1,h=o.relative?a.value/100:.5;return w(m=>new Ve(m,v,h,1))}}}),c=k({rgba:{label:"Green",stops(){const v=o.relative?r.value:0,h=o.relative?a.value:0;return[new Fe(v,0,h,1),new Fe(v,255,h,1)]}},hsla:{label:"Saturation",stops(){const v=o.relative?r.value/360:0,h=o.relative?a.value/100:.5;return w(m=>new Ve(v,m,h,1))}}}),f=k({rgba:{label:"Blue",stops(){const v=o.relative?r.value:0,h=o.relative?l.value:0;return[new Fe(v,h,0,1),new Fe(v,h,255,1)]}},hsla:{label:"Luminosity",stops(){const v=o.relative?r.value/360:0,h=o.relative?l.value/100:.5;return w(m=>new Ve(v,h,m,1))}}}),p=S(()=>{const v=Fe.fromHex(o.modelValue);return[new Fe(v.r,v.g,v.b,0).toCss(),new Fe(v.r,v.g,v.b,1).toCss()]});function g(){o.modelValue!==s.value&&_()}function b(){let v;o.mode==="rgba"?v=new Fe(r.value,l.value,a.value,i.value/255):v=new Ve(r.value/360,l.value/100,a.value/100,i.value/255);const h=v.toRgb().toHex();if(s.value!==h){if(h.length!==9)throw new Error(`Invalid color code: ${h}`);s.value=h,n("update:modelValue",h)}}function _(){const v=Fe.fromHex(o.modelValue);if(s.value=v.toHex(),i.value=v.a*255,o.mode==="hsla"){const h=v.toHSL();r.value=h.h*360,l.value=h.s*100,a.value=h.l*100}else r.value=v.r,l.value=v.g,a.value=v.b}function w(v){const h=[];for(let m=0;m<=8;++m)h.push(v(m/8));return h}We(()=>o.modelValue,g),We(()=>o.mode,_,{immediate:!0}),We(()=>[r.value,l.value,a.value,i.value],b);function k({rgba:v,hsla:h}){const m=S(()=>{var A;return o.mode==="rgba"?255:(A=h.max)!=null?A:100}),j=S(()=>o.mode==="rgba"?v.label:h.label),P=S(()=>(o.mode==="rgba"?v.stops():h.stops()).map(D=>D.toRgb().toCss()));return{maxValue:m,label:j,stops:P}}return(v,h)=>(x(),R("div",null,[B(Qn,{label:oe(u).label.value,modelValue:r.value,"onUpdate:modelValue":h[0]||(h[0]=m=>r.value=m),"max-value":oe(u).maxValue.value,"gradient-stops":oe(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),B(Qn,{label:oe(c).label.value,modelValue:l.value,"onUpdate:modelValue":h[1]||(h[1]=m=>l.value=m),"max-value":oe(c).maxValue.value,"gradient-stops":oe(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),B(Qn,{label:oe(f).label.value,modelValue:a.value,"onUpdate:modelValue":h[2]||(h[2]=m=>a.value=m),"max-value":oe(f).maxValue.value,"gradient-stops":oe(f).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),B(Qn,{label:"Alpha",modelValue:i.value,"onUpdate:modelValue":h[3]||(h[3]=m=>i.value=m),"max-value":255,"gradient-stops":p.value},null,8,["modelValue","gradient-stops"])]))}}),VO=Me(FO,[["__scopeId","data-v-58431e03"]]);var HO=Object.defineProperty,UO=Object.defineProperties,WO=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,zO=Object.prototype.hasOwnProperty,GO=Object.prototype.propertyIsEnumerable,ud=(t,e,n)=>e in t?HO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cd=(t,e)=>{for(var n in e||(e={}))zO.call(e,n)&&ud(t,n,e[n]);if(ad)for(var n of ad(e))GO.call(e,n)&&ud(t,n,e[n]);return t},dd=(t,e)=>UO(t,WO(e)),XO=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const YO={class:"v-w100 h-h100"},qO={class:"hex-selector"},KO=["for"],JO=["id","value"],ZO=["title","onClick"],fd="dddg.generated.colors",QO=Ce(dd(cd({},{inheritAttrs:!1}),{__name:"color",props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},emits:["leave","update:modelValue"],setup(t,{emit:e}){const n=Na(),o=Ne(),s=e,r=t,l=L("hsla"),a=S(()=>o.state.ui.vertical),i=S({get(){return r.format==="rgb"?Fe.fromCss(r.modelValue).toHex():r.modelValue},set(b){if(r.format==="rgb"){const _=Fe.fromCss(b);s("update:modelValue",_.toCss())}else s("update:modelValue",b)}});function u(b){const _=b.target.value;Fe.validHex(_)&&(_.length===7||_.length===9)&&(i.value=_)}const c=S(()=>o.state.content.current.colors);function f(){if(c.value.find(w=>w.color===i.value))return;const b=o.state.content.contentPacks.find(w=>w.packId===fd)||{packId:fd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},_=dd(cd({},b),{colors:[...b.colors,{label:i.value,color:i.value}]});Z(()=>XO(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:_,processed:!0})}))}function p(){Z(()=>{o.commit("ui/setColorPicker",!0)})}function g(b){i.value=Fe.fromCss(b.color).toHex()}return mt(()=>{Te.subscribe(Tr,g)}),Wt(()=>{Te.unsubscribe(Tr,g)}),(b,_)=>(x(),R("div",{class:Le([{color:!0,vertical:a.value},"v-w100 h-h100"])},[d("h2",null,$e(t.title),1),d("button",{onClick:_[0]||(_[0]=w=>b.$emit("leave"))},"OK"),d("table",null,[d("tr",null,[d("td",null,[d("button",{onClick:_[1]||(_[1]=w=>l.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:_[2]||(_[2]=w=>l.value="rgba")},"RGBA")])])]),d("div",YO,[B(VO,{mode:l.value,modelValue:i.value,"onUpdate:modelValue":_[3]||(_[3]=w=>i.value=w),relative:!0},null,8,["mode","modelValue"]),d("div",qO,[d("label",{class:"hex-label",for:`hex_${oe(n)}`},"Hex",8,KO),d("input",{id:`hex_${oe(n)}`,value:i.value,onInput:u,onKeydown:_[4]||(_[4]=ce(()=>{},["stop"]))},null,40,JO)]),B(Rt,{direction:"global",class:"color-tools"},{default:X(()=>[d("button",{onClick:f},"Add as swatch"),B(je,{class:"h-bl0 v-bt0",icon:"colorize",onClick:p},{default:X(()=>[U("Pick color")]),_:1})]),_:1})]),d("div",{id:"color-swatches",class:Le({vertical:a.value})},[(x(!0),R(ae,null,Ue(c.value,w=>(x(),R("button",{class:"swatch",key:w.color,style:Qe({backgroundColor:w.color}),title:w.label,onClick:k=>{i.value=w.color,s("leave")}},null,12,ZO))),128))],2)],2))}})),Cl=Me(QO,[["__scopeId","data-v-8900a5a5"]]),eS={class:"fieldset_wrapper"},tS={key:0},nS={class:"fieldset_contents"},oS=Ce({__name:"d-fieldset",props:{title:{required:!0,type:String}},setup(t){const e=t;return(n,o)=>(x(),R("div",eS,[d("fieldset",null,[t.title>""?(x(),R("legend",tS,$e(e.title),1)):de("",!0),d("div",nS,[Qt(n.$slots,"default",{},void 0,!0)])])]))}}),It=Me(oS,[["__scopeId","data-v-60e241fa"]]),sS=["href"],Xe=Ce({__name:"link",props:{to:{type:String,required:!0}},setup(t){const e=L(null),n=t,o=S(()=>{let s=n.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,l)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+l.replaceAll(" ","-")),s});return(s,r)=>(x(),R("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[Qt(s.$slots,"default")],8,sS))}});var rS=Object.defineProperty,pd=Object.getOwnPropertySymbols,lS=Object.prototype.hasOwnProperty,iS=Object.prototype.propertyIsEnumerable,hd=(t,e,n)=>e in t?rS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,aS=(t,e)=>{for(var n in e||(e={}))lS.call(e,n)&&hd(t,n,e[n]);if(pd)for(var n of pd(e))iS.call(e,n)&&hd(t,n,e[n]);return t},fr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ae=t=>(_t("data-v-4d8871ce"),t=t(),wt(),t),uS=Ae(()=>d("h2",null,"Image options",-1)),cS={class:"column ok-col"},dS={key:0,class:"column"},fS=Ae(()=>d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),pS=Ae(()=>d("option",{value:"source-over"},"Normal",-1)),hS=Ae(()=>d("option",{value:"source-atop"},"source-atop",-1)),vS=Ae(()=>d("option",{value:"destination-over"},"destination-over",-1)),gS=Ae(()=>d("option",{value:"destination-in"},"destination-in",-1)),mS=Ae(()=>d("option",{value:"destination-in"},"destination-out",-1)),bS=Ae(()=>d("option",{value:"destination-in"},"destination-atop",-1)),yS=Ae(()=>d("option",{value:"lighter"},"lighter",-1)),_S=Ae(()=>d("option",{value:"xor"},"xor",-1)),wS=Ae(()=>d("option",{value:"multiply"},"multiply",-1)),PS=Ae(()=>d("option",{value:"screen"},"screen",-1)),CS=Ae(()=>d("option",{value:"overlay"},"overlay",-1)),xS=Ae(()=>d("option",{value:"darken"},"darken",-1)),kS=Ae(()=>d("option",{value:"lighten"},"lighten",-1)),OS=Ae(()=>d("option",{value:"color-dodge"},"color-dodge",-1)),SS=Ae(()=>d("option",{value:"color-burn"},"color-burn",-1)),$S=Ae(()=>d("option",{value:"hard-light"},"hard-light",-1)),IS=Ae(()=>d("option",{value:"soft-light"},"soft-light",-1)),jS=Ae(()=>d("option",{value:"difference"},"difference",-1)),TS=Ae(()=>d("option",{value:"exclusion"},"exclusion",-1)),AS=Ae(()=>d("option",{value:"hue"},"hue",-1)),ES=Ae(()=>d("option",{value:"saturation"},"saturation",-1)),RS=Ae(()=>d("option",{value:"color"},"color",-1)),BS=Ae(()=>d("option",{value:"luminosity"},"luminosity",-1)),MS=[pS,hS,vS,gS,mS,bS,yS,_S,wS,PS,CS,xS,kS,OS,SS,$S,IS,jS,TS,AS,ES,RS,BS],DS=Ae(()=>d("label",{for:"addEffect"},"Add new effect",-1)),LS=["value"],NS=["disabled"],FS=["disabled"],VS=["disabled"],HS=["disabled"],US=["onClick","onKeydown"],WS={key:0,class:"value-input-table"},zS=Ae(()=>d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),GS=Ae(()=>d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),XS=Ae(()=>d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),YS=Ae(()=>d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),qS=Ae(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),KS=["value","max","min"],JS={key:0},ZS={colspan:"2"},QS=Ae(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),e$=["value","max","min"],t$={key:0},n$={colspan:"2"},o$=Ce({__name:"image-options",props:{type:{type:String,required:!0},title:{type:String},id:{},panelId:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],setup(t){const e=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),n=(()=>{try{const q=ro();q.width=0,q.height=0;const O="filter"in q.getContext("2d");if(Bo(q),O)return Array.from(e.keys()).sort()}catch(q){}return["opacity"]})(),o=t,s=Ne(),r=L(""),l=L(0),a=S(()=>{switch(o.type){case"object":return s.state.panels.panels[o.panelId].objects[o.id];case"background":return s.state.panels.panels[o.panelId].background;case"panel":return s.state.panels.panels[o.panelId];default:throw new Mt.UnreachableCaseError(o.type)}}),i=S({get(){return a.value.composite},set(q){Z(()=>{switch(o.type){case"object":s.commit("panels/setComposition",{id:o.id,panelId:o.panelId,composite:q});break;case"background":break;case"panel":break;default:throw new Mt.UnreachableCaseError(o.type)}})}}),u=S(()=>a.value.filters),c=S(()=>{var q;return(q=u.value[l.value])!=null?q:null}),f=S(()=>{const q=c.value;return q==null?!1:bc.has(q.type)}),p=S(()=>{const q=c.value;if(q!=null){if(q.type==="hue-rotate")return 360;if(q.type==="grayscale"||q.type==="sepia"||q.type==="opacity"||q.type==="invert")return 100}}),g=S(()=>{const q=c.value;if(q!=null)switch(q.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function b(q){return e.get(q)}function _(q){return bc.has(q.type)?`${e.get(q.type)} ${(q.value*100).toFixed()}%`:q.type==="hue-rotate"?`${e.get(q.type)} ${q.value.toFixed()}`:q.type==="blur"?`${e.get(q.type)} ${q.value.toFixed()}px`:e.get(q.type)}function w(q){switch(o.type){case"object":return"panels/object_"+q;case"background":return"panels/background"+q[0].toUpperCase()+q.slice(1);case"panel":return"panels/"+q}}function k(){Z(()=>fr(this,null,function*(){yield s.dispatch(w("addFilter"),{id:o.id,panelId:o.panelId,type:r.value,idx:l.value+1})}))}function v(q){l.value=q}function h(){Z(()=>fr(this,null,function*(){yield s.dispatch(w("removeFilter"),{id:o.id,panelId:o.panelId,idx:l.value}),l.value>=a.value.filters.length&&(l.value=a.value.filters.length-1)}))}function m(q){Z(()=>fr(this,null,function*(){yield s.dispatch(w("moveFilter"),{id:o.id,panelId:o.panelId,idx:l.value,moveBy:q}),l.value+=q}))}function j(q){let I=Number(q.target.value);f.value&&(I=I/100),P({value:I})}function P(q){Z(()=>fr(this,null,function*(){yield s.dispatch(w("setFilter"),aS({id:o.id,panelId:o.panelId,idx:l.value},q))}))}const A=S(()=>D(I=>new Ve(I,1,.5,1)).map(I=>I.toRgb().toCss()));function D(q){const I=[];for(let O=0;O<=8;++O)I.push(q(O/8));return I}const M=L(!1),Y=le("color"),z=le("offsetX"),F=le("offsetY"),ne=le("blurRadius");function le(q){return S({get(){const I=c.value;if(I==null||!(q in I))throw new Error("Tried reading shadow prop on a non shadow object");return I[q]},set(I){P({[q]:I})}})}return(q,I)=>M.value?(x(),fe(Cl,{key:0,modelValue:oe(Y),"onUpdate:modelValue":I[0]||(I[0]=O=>_e(Y)?Y.value=O:null),format:"rgb",onLeave:I[1]||(I[1]=O=>M.value=!1)},null,8,["modelValue"])):(x(),fe(Rt,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:X(()=>[uS,d("div",cS,[d("button",{onClick:I[2]||(I[2]=O=>q.$emit("leave"))},"Back")]),t.noComposition?de("",!0):(x(),R("div",dS,[fS,B(Xe,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:X(()=>[U("[?] ")]),_:1}),Oe(d("select",{id:"compositionSelect","onUpdate:modelValue":I[3]||(I[3]=O=>i.value=O),onKeydown:I[4]||(I[4]=ce(()=>{},["stop"]))},MS,544),[[$t,i.value]])])),B(It,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:X(()=>[B(Rt,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:X(()=>[B(Rt,{direction:"vertical","no-wraping":""},{default:X(()=>[DS,Oe(d("select",{id:"addEffect","onUpdate:modelValue":I[5]||(I[5]=O=>r.value=O),onKeydown:I[6]||(I[6]=ce(()=>{},["stop"]))},[(x(!0),R(ae,null,Ue(oe(n),O=>(x(),R("option",{key:O,value:O},$e(b(O)),9,LS))),128))],544),[[$t,r.value]]),d("button",{disabled:r.value==="",onClick:k,onKeydown:I[7]||(I[7]=ce(()=>{},["stop"]))}," Add ",40,NS),d("button",{disabled:!c.value,onClick:h,onKeydown:I[8]||(I[8]=ce(()=>{},["stop"]))}," Remove ",40,FS),d("button",{disabled:l.value===0,onClick:I[9]||(I[9]=O=>m(-1)),onKeydown:I[10]||(I[10]=ce(()=>{},["stop"]))}," Move up ",40,VS),d("button",{disabled:l.value===u.value.length-1||u.value.length===0,onClick:I[11]||(I[11]=O=>m(1)),onKeydown:I[12]||(I[12]=ce(()=>{},["stop"]))}," Move down ",40,HS)]),_:1}),B(Rt,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:X(()=>[(x(!0),R(ae,null,Ue(u.value,(O,T)=>(x(),R("div",{key:T,class:Le({choiceBtn:!0,active:T===l.value}),tabindex:"0",onClick:$=>v(T),onKeydown:[lt($=>v(T),["enter"]),lt(ce($=>v(T),["prevent"]),["space"])]},$e(_(O)),43,US))),128))]),_:1}),c.value?(x(),R("table",WS,[c.value.type==="drop-shadow"?(x(),R(ae,{key:0},[d("tr",null,[zS,d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:Qe({background:oe(Y)}),onClick:I[13]||(I[13]=O=>M.value=!0)},"  ",4)])]),d("tr",null,[GS,d("td",null,[Oe(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":I[14]||(I[14]=O=>_e(z)?z.value=O:null),onKeydown:I[15]||(I[15]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(z),void 0,{number:!0}]])])]),d("tr",null,[XS,d("td",null,[Oe(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":I[16]||(I[16]=O=>_e(F)?F.value=O:null),onKeydown:I[17]||(I[17]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(F),void 0,{number:!0}]])])]),d("tr",null,[YS,d("td",null,[Oe(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":I[18]||(I[18]=O=>_e(ne)?ne.value=O:null),onKeydown:I[19]||(I[19]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(ne),void 0,{number:!0}]])])])],64)):f.value?(x(),R(ae,{key:1},[d("tr",null,[qS,d("td",null,[d("input",{id:"filter_value",value:(c.value.value*100).toFixed(),type:"number",max:p.value,min:g.value,onInput:j,onKeydown:I[20]||(I[20]=ce(()=>{},["stop"]))},null,40,KS),U("% ")])]),g.value===0&&p.value!==void 0?(x(),R("tr",JS,[d("td",ZS,[B(Qn,{gradientStops:["#000000","#ffffff"],label:"",maxValue:p.value,modelValue:c.value.value*100,"no-input":"","onUpdate:modelValue":I[21]||(I[21]=O=>P({value:Math.round(O)/100}))},null,8,["maxValue","modelValue"])])])):de("",!0)],64)):(x(),R(ae,{key:2},[d("tr",null,[QS,d("td",null,[d("input",{id:"filter_value",value:c.value.value,type:"number",max:p.value,min:g.value,onInput:j,onKeydown:I[22]||(I[22]=ce(()=>{},["stop"]))},null,40,e$)])]),g.value===0&&p.value!==void 0?(x(),R("tr",t$,[d("td",n$,[B(Qn,{gradientStops:A.value,label:"",maxValue:p.value,modelValue:c.value.value,"no-input":"","onUpdate:modelValue":I[23]||(I[23]=O=>P({value:Math.round(O)}))},null,8,["gradientStops","maxValue","modelValue"]),B(Qn,{gradientStops:A.value,label:"",maxValue:p.value,modelValue:c.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):de("",!0)],64))])):de("",!0)]),_:1})]),_:1})]),_:1}))}}),Fa=Me(o$,[["__scopeId","data-v-4d8871ce"]]);var vd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const s$=["title"],r$=["title"],l$=Ce({__name:"button",props:{backgroundId:{type:String,required:!0}},setup(t){const e=Ne(),n=t,o=S(()=>{const p=e.state.panels.currentPanel;return e.state.panels.panels[p].background}),s=L(null),r=S(()=>{Object.keys(e.state.uploadUrls);const p=l.value;if(!p)return null;for(const g of p.variants)for(const b of g){const _=Mn(b,!1);if(_.startsWith("uploads:"))return Object.keys(e.state.uploadUrls),_.substring(8)}return null}),l=S(()=>e.getters["content/getBackgrounds"].get(n.backgroundId)||null),a=S(()=>n.backgroundId===o.value.current),i=S(()=>{var p;switch(n.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return(p=l.value.label)!=null?p:""}),u=S(()=>{var p;switch(n.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let g=!1;const b=(p=l.value)==null?void 0:p.variants[0].map(_=>{const w=Mn(_,!1);return w.startsWith("uploads:")&&(g=!0),`url('${w}')`}).join(",");return g&&Object.keys(e.state.uploadUrls),{backgroundImage:b!=null?b:""}});function c(){s.value.click()}function f(){return vd(this,null,function*(){const p=s.value,g=r.value;if(!p.files)return;if(p.files.length!==1){console.error("More than one file uploaded!");return}const b=p.files[0];yield Z(()=>vd(this,null,function*(){const _=URL.createObjectURL(b);yield e.dispatch("uploadUrls/add",{name:g,url:_})}))})}return(p,g)=>r.value!==null?(x(),R("div",{key:0,class:Le({background:!0,active:a.value}),title:i.value,style:Qe(u.value),tabindex:"0",onClick:g[0]||(g[0]=b=>c()),onKeypress:[g[1]||(g[1]=lt(ce(b=>c(),["prevent","stop"]),["enter"])),g[2]||(g[2]=lt(ce(b=>c(),["prevent","stop"]),["space"]))]},[U($e(i.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,s$)):(x(),R("div",{key:1,class:Le({background:!0,active:a.value}),title:i.value,style:Qe(u.value),tabindex:"0",onClick:g[3]||(g[3]=b=>p.$emit("input",t.backgroundId)),onKeydown:[g[4]||(g[4]=lt(b=>p.$emit("input",t.backgroundId),["enter"])),g[5]||(g[5]=lt(ce(b=>p.$emit("input",t.backgroundId),["prevent"]),["space"]))]},$e(i.value),47,r$))}}),i$=Me(l$,[["__scopeId","data-v-b765c132"]]),a$={class:"toggle_box"},u$=["id"],c$=["for"],d$=["for"],qe=Ce({__name:"toggle",props:{label:String,modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,o=Na(),s=e,r=S({get(){return n.modelValue},set(a){s("update:modelValue",a)}}),l=L(null);return(a,i)=>(x(),R("div",a$,[Oe(d("input",{id:oe(o),type:"checkbox",ref_key:"checkbox",ref:l,"onUpdate:modelValue":i[0]||(i[0]=u=>r.value=u)},null,8,u$),[[wb,r.value]]),d("label",{for:oe(o),class:"switch"},null,8,c$),d("label",{for:oe(o),class:"toggle_label"},$e(t.label),9,d$)]))}});var f$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Gs=t=>(_t("data-v-4112b6ee"),t=t(),wt(),t),p$=Gs(()=>d("label",{for:"bg_color"},"Color:",-1)),h$={key:1},v$={colspan:"3"},g$={key:0},m$={class:"arrow-col"},b$=Gs(()=>d("td",{style:{"text-align":"center"}},"Variant",-1)),y$={class:"arrow-col"},_$={colspan:"3"},w$=Gs(()=>d("option",{value:"0"},"None",-1)),P$=Gs(()=>d("option",{value:"1"},"Stretch",-1)),C$=Gs(()=>d("option",{value:"2"},"Cover",-1)),x$=[w$,P$,C$],k$={colspan:"3"},O$=Ce({__name:"settings",emits:["open-image-options","change-color"],setup(t,{emit:e}){const n=Ne(),o=e,s=S(()=>n.state.ui.vertical),r=S(()=>{const _=n.state.panels.currentPanel;return n.state.panels.panels[_].background}),l=S({get(){return r.value.flipped},set(_){Z(()=>{n.commit("panels/setBackgroundFlipped",{flipped:_,panelId:n.state.panels.currentPanel})})}}),a=S({get(){return r.value.scaling.toString()},set(_){Z(()=>{n.commit("panels/setBackgroundScaling",{scaling:parseInt(_,10),panelId:n.state.panels.currentPanel})})}}),i=S(()=>r.value.current),u=S(()=>n.state.content.current.backgrounds.find(_=>_.id===i.value)||null),c=S(()=>i.value==="buildin.static-color"),f=S({get(){return r.value.color},set(_){Z(()=>{n.commit("panels/setBackgroundColor",{color:_,panelId:n.state.panels.currentPanel})})}}),p=S(()=>!!u.value),g=S(()=>u.value?u.value.variants.length>1:!1);function b(_){Z(()=>f$(this,null,function*(){yield n.dispatch("panels/seekBackgroundVariant",{delta:_,panelId:n.state.panels.currentPanel})}))}return(_,w)=>(x(),fe(It,{class:Le({"bg-settings":!0,vertical:s.value}),title:"Settings:"},{default:X(()=>[c.value?(x(),R(ae,{key:0},[p$,d("button",{id:"bg_color",class:"color-button",style:Qe({background:f.value}),onClick:w[0]||(w[0]=k=>o("change-color"))},null,4)],64)):de("",!0),p.value?(x(),R("table",h$,[d("tr",null,[d("td",v$,[B(qe,{modelValue:l.value,"onUpdate:modelValue":w[1]||(w[1]=k=>l.value=k),label:"Flipped?"},null,8,["modelValue"])])]),g.value?(x(),R("tr",g$,[d("td",m$,[d("button",{class:"small-button",onClick:w[2]||(w[2]=k=>b(-1))},"<")]),b$,d("td",y$,[d("button",{class:"small-button",onClick:w[3]||(w[3]=k=>b(1))},">")])])):de("",!0),d("tr",null,[d("td",_$,[Oe(d("select",{"onUpdate:modelValue":w[4]||(w[4]=k=>a.value=k),onKeydown:w[5]||(w[5]=ce(()=>{},["stop"]))},x$,544),[[$t,a.value]])])]),d("tr",null,[d("td",k$,[d("button",{id:"image_options_button",class:"v-w100",onClick:w[6]||(w[6]=k=>o("open-image-options"))}," Image options ")])])])):de("",!0)]),_:1},8,["class"]))}}),S$=Me(O$,[["__scopeId","data-v-4112b6ee"]]);var $$=Object.defineProperty,I$=Object.defineProperties,j$=Object.getOwnPropertyDescriptors,gd=Object.getOwnPropertySymbols,T$=Object.prototype.hasOwnProperty,A$=Object.prototype.propertyIsEnumerable,md=(t,e,n)=>e in t?$$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E$=(t,e)=>{for(var n in e||(e={}))T$.call(e,n)&&md(t,n,e[n]);if(gd)for(var n of gd(e))A$.call(e,n)&&md(t,n,e[n]);return t},R$=(t,e)=>I$(t,j$(e)),pr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const B$=t=>(_t("data-v-7cf90dff"),t=t(),wt(),t),M$=B$(()=>d("h1",null,"Background",-1)),D$=Ce({__name:"backgrounds",setup(t){const e={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},n=Ne(),o=L(null);Lt(o);const s=L(!1),r=L(!1),l=S({get(){return n.state.panels.panels[n.state.panels.currentPanel].background.color},set(v){Z(()=>{n.commit("panels/setBackgroundColor",{color:v,panelId:n.state.panels.currentPanel})})}}),a=S(()=>[...n.state.content.current.backgrounds.map(v=>v.id),"buildin.static-color","buildin.transparent"]),i=S(()=>pe.supports.openableFolders.has("backgrounds"));function u(v){n.commit("panels/setCurrentBackground",{current:v,panelId:n.state.panels.currentPanel})}function c(){pe.openFolder("backgrounds")}const f=L(null);function p(){const v=f.value;if(v.files)for(const h of v.files)g(h)}function g(v){return pr(this,null,function*(){yield Z(()=>pr(this,null,function*(){const h=URL.createObjectURL(v),m=yield n.dispatch("uploadUrls/add",{name:v.name,url:h});yield _(v.name,v.name,m)}))})}function b(){const v=prompt("Enter the URL of the image");if(v==null)return;const h=v.split("/").slice(-1)[0];_(h,h,v)}function _(v,h,m){return pr(this,null,function*(){const j=n.state.content.contentPacks.find(A=>A.packId===e.packId)||e,P=R$(E$({},j),{backgrounds:[...j.backgrounds,{id:v,label:h,variants:[[{hq:m,lq:m,sourcePack:e.packId}]],scaling:"none"}]});yield Z(()=>pr(this,null,function*(){yield n.dispatch("content/replaceContentPack",{contentPack:P,processed:!0}),u(v)}))})}const w=L(null);function k(v){v.dataTransfer&&(v.dataTransfer.effectAllowed="none",Array.from(v.dataTransfer.items).find(h=>h.type.match(/^image.*$/))&&(v.dataTransfer.effectAllowed="link",w.value.show()))}return(v,h)=>(x(),R("div",{class:"panel",ref_key:"root",ref:o,onDragenter:k,onMouseleave:h[7]||(h[7]=m=>w.value.hide())},[B(Yv,{ref_key:"dt",ref:w,class:"drop-target",onDrop:g},{default:X(()=>[U("Drop here to add as a new background ")]),_:1},512),M$,s.value?(x(),fe(Cl,{key:0,modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=m=>l.value=m),onLeave:h[1]||(h[1]=m=>s.value=!1)},null,8,["modelValue"])):r.value?(x(),fe(Fa,{key:1,type:"background",title:"","panel-id":oe(n).state.panels.currentPanel,"no-composition":"",onLeave:h[2]||(h[2]=m=>r.value=!1)},null,8,["panel-id"])):(x(),R(ae,{key:2},[B(S$,{onChangeColor:h[3]||(h[3]=m=>s.value=!0),onOpenImageOptions:h[4]||(h[4]=m=>r.value=!0)}),B(je,{icon:"upload",class:"upload-background",onClick:h[5]||(h[5]=m=>f.value.click())},{default:X(()=>[U(" Upload "),d("input",{type:"file",ref_key:"upload",ref:f,onChange:p,multiple:""},null,544)]),_:1}),B(je,{icon:"link",class:"upload-background",onClick:b},{default:X(()=>[U(" Add by URL ")]),_:1}),B(je,{icon:"extension",class:"upload-background",onClick:h[6]||(h[6]=m=>v.$emit("show-dialog","type: Backgrounds"))},{default:X(()=>[U(" Search in content packs ")]),_:1}),i.value?(x(),fe(je,{key:0,icon:"folder",class:"upload-background",onClick:c},{default:X(()=>[U(" Open backgrounds folder ")]),_:1})):de("",!0),(x(!0),R(ae,null,Ue(a.value,m=>(x(),fe(i$,{key:m,backgroundId:m,onInput:j=>u(m)},null,8,["backgroundId","onInput"]))),128))],64))],544))}}),L$=Me(D$,[["__scopeId","data-v-7cf90dff"]]);function Va(t,e,n,o,s){return S({get(){return e.value[s]},set(r){Z(()=>{t.commit(n,{panelId:e.value.panelId,id:e.value.id,key:s,value:r})})}})}function Vo(t,e,n,o,s){return S({get(){return e.value[s]},set(r){Z(()=>{t[o?"dispatch":"commit"](n,{panelId:e.value.panelId,id:e.value.id,[s]:r})})}})}var N$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const F$=["onKeydown"],bd=960,V$=Ce({__name:"part-button",props:{part:{required:!0,type:Object},value:{required:!0},size:{type:Number,default:150}},emits:["quick-click","click"],setup(t,{emit:e}){const n=t,o=e,s=L([]),r=S(()=>n.size/n.part.size[0]),l=S(()=>n.size/n.part.size[1]),a=S(()=>`${Math.floor(bd*r.value)}px ${Math.floor(bd*l.value)}px`),i=S(()=>{var p,g;let b="";const _=a.value,w=(p=n.part.offset)!=null?p:[0,0],k=n.part.images.length-1;for(let v=0;v<=k;++v){const h=n.part.images[k-v],m=s.value[k-v];if(!m)continue;v>0&&(b+=", ");const j=(g=h.offset)!=null?g:[0,0],P=`${Math.floor((w[0]-j[0])*-r.value)}px ${Math.floor((w[1]-j[1])*-l.value)}px`;b+=`url('${m.replace("'","\\'")}') ${P} / ${_}`}return b}),u=S(()=>({height:n.size+"px",width:n.size+"px",background:i.value}));function c(p){p.preventDefault(),o("quick-click")}function f(){return N$(this,null,function*(){s.value=yield Promise.all(n.part.images.map(p=>typeof p.asset=="string"?$y(p.asset,!1):Mn(p.asset,!1)))})}return Fo("Initialization of parts button",f),(p,g)=>{var b;return x(),R("div",{class:Le({part:!0,active:(b=t.part)==null?void 0:b.active}),style:Qe(u.value),tabindex:"0",onClick:g[0]||(g[0]=_=>o("click")),onContextmenu:c,onKeydown:[g[1]||(g[1]=lt(ce(_=>o("click"),["prevent"]),["enter"])),lt(ce(c,["prevent"]),["space"])]},null,46,F$)}}}),yd=Me(V$,[["__scopeId","data-v-69d94456"]]);var Jl=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const H$=Ce({__name:"parts",props:{character:{type:Object,required:!0},part:{required:!0,type:String}},emits:["leave","show-dialog","show-expression-dialog"],setup(t,{emit:e}){const n=t,o=Ne(),s=e,r=L(null),l=L([]),a=S(()=>{switch(n.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),i=S(()=>pl(o,n.character)),u=S(()=>{if(n.part!=="style")return[];const v=i.value.styleGroups[n.character.styleGroupId];return v.styleComponents.map(h=>{const m={};for(const j in h.variants){if(!h.variants.hasOwnProperty(j))continue;const P=h.variants[j];m[j]={size:v.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:P}],active:!1}}return{label:h.label,name:h.id,buttons:m}})}),c=S(()=>{const v={};let h,m,j;const P=i.value,A=Do(P,n.character);switch(n.part){case"head":{const M=n.character.posePositions.headType||0,Y=n.character.posePositions.head||0;for(let z=0;z<A.compatibleHeads.length;++z){const F=A.compatibleHeads[z],ne=P.heads[F];for(let le=0;le<ne.variants.length;++le){const q=ne.variants[le];v[`${z}_${le}`]={size:ne.previewSize,offset:ne.previewOffset,images:q.map(I=>({asset:I,offset:[0,0]})),active:Y===le&&M===z}}}return v}case"pose":const D=P.styleGroups[n.character.styleGroupId].styles[n.character.styleId];for(let M=0;M<D.poses.length;++M){const Y=D.poses[M],z=p(Y);v[M]=z,z.active=M===n.character.poseId}return v;case"style":for(let M=0;M<P.styleGroups.length;++M){const Y=P.styleGroups[M],z=p(Y.styles[0].poses[0]);v[Y.id]=z,z.active=M===n.character.styleGroupId}return v;default:h=A.positions[n.part],j=A.previewSize,m=A.previewOffset;break}for(let D=0;D<h.length;++D){const M=h[D];v[D]={images:M.map(Y=>({offset:[0,0],asset:Y})),size:j,offset:m,active:D===(n.character.posePositions[n.part]||0)}}return v});function f(){const v=i.value.styleGroups[n.character.styleGroupId].styles[n.character.styleId];l.value=Object.keys(v.components).map(h=>[h,v.components[h]])}function p(v){const h=i.value;let m=[];for(const j of v.renderCommands)switch(j.type){case"pose-part":const P=v.positions[j.part];if(P==null||P.length===0)break;m=m.concat(P[0].map(A=>({asset:A,offset:j.offset})));break;case"head":{const A=h.heads[v.compatibleHeads[0]];if(v.compatibleHeads.length===0)break;const D=A.variants[0];m=m.concat(D.map(M=>({asset:M,offset:j.offset})));break}case"image":m=m.concat(j.images.map(A=>({asset:A,offset:j.offset})));break}return{images:m,size:v.previewSize,offset:v.previewOffset,active:!1}}function g(v){v==null&&(v=n.character.styleGroupId);const m=i.value.styleGroups[v];let j=m.styles;for(const P of l.value){const A=j.filter(D=>D.components[P[0]]===P[1]);A.length>0&&(j=A)}Z(()=>Jl(this,null,function*(){yield o.dispatch("panels/setCharStyle",{id:n.character.id,panelId:n.character.panelId,styleGroupId:v,styleId:m.styles.indexOf(j[0])})}))}function b(v){if(n.part==="style")g(i.value.styleGroups.findIndex(h=>h.id===v));else if(n.part==="head"){const[h,m]=(""+v).split("_",2).map(j=>parseInt(j,10));o.commit("panels/setPosePosition",{id:n.character.id,panelId:n.character.panelId,posePositions:{headType:h,head:m}})}else k(n.part,parseInt(""+v,10))}function _(v,h){const m=l.value.findIndex(j=>j[0]===v);l.value.splice(m,1),l.value.unshift([v,""+h]),g()}function w(v){(v.key==="Backspace"||v.key==="Escape")&&(s("leave"),v.preventDefault(),v.stopPropagation())}function k(v,h){Z(()=>Jl(this,null,function*(){yield o.dispatch("panels/setPart",{id:n.character.id,panelId:n.character.panelId,part:v,val:h})}))}return Fo("Initializing parts data",()=>Jl(this,null,function*(){r.value=yield Ao()})),We(()=>n.character,f,{immediate:!0}),(v,h)=>(x(),fe(Rt,{"no-wraping":"",onKeydown:w},{default:X(()=>[d("button",{onClick:h[0]||(h[0]=m=>s("leave")),class:"h-h100"},"Back"),B(Rt,{direction:"vertical",class:"parts-fnc-btns"},{default:X(()=>[B(je,{icon:"extension",class:"h-bl0 v-w100 v-bt0",onClick:h[1]||(h[1]=m=>s("show-dialog",`type: ${a.value} character: ${i.value.label}`))},{default:X(()=>[U(" Search in content packs ")]),_:1}),t.part==="head"?(x(),fe(je,{key:0,icon:"extension",class:"h-bl0 h-bt0 v-w100 v-bt0",onClick:h[2]||(h[2]=m=>s("show-expression-dialog",{character:t.character.characterType}))},{default:X(()=>[U(" Create new expressions ")]),_:1})):de("",!0)]),_:1}),(x(!0),R(ae,null,Ue(c.value,(m,j)=>(x(),fe(yd,{key:j,value:j,part:m,onClick:P=>{b(j),s("leave")},onQuickClick:P=>b(j)},null,8,["value","part","onClick","onQuickClick"]))),128)),(x(!0),R(ae,null,Ue(u.value,m=>(x(),fe(It,{key:m.name,title:m.label,class:"h-h100"},{default:X(()=>[B(Rt,{noWraping:""},{default:X(()=>[(x(!0),R(ae,null,Ue(m.buttons,(j,P)=>(x(),fe(yd,{size:130,key:P,value:P,part:j,onClick:A=>_(m.name,P)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}}),U$=Me(H$,[["__scopeId","data-v-53ecb7fc"]]);var W$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const z$=Ce({__name:"delete",props:{obj:{required:!0,type:Object}},setup(t){const e=Ne(),n=t;function o(){Z(()=>W$(this,null,function*(){yield e.dispatch("panels/removeObject",{panelId:n.obj.panelId,id:n.obj.id})}))}return(s,r)=>(x(),R("button",{onClick:o},"Delete"))}});var G$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const X$=Ce({__name:"layers",props:{object:{required:!0,type:Object}},setup(t){const e=Ne(),n=t,o=Vo(e,S(()=>n.object),"panels/setOnTop",!0,"onTop");function s(r){Z(()=>G$(this,null,function*(){yield e.dispatch("panels/shiftLayer",{id:n.object.id,panelId:n.object.panelId,delta:r})}))}return(r,l)=>(x(),fe(It,{id:"layerfs",title:"Layer:"},{default:X(()=>[B(Rt,{class:"layer_flow",direction:"horizontal"},{default:X(()=>[B(je,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>s(-1/0)),title:"Move to back"}),B(je,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>s(-1)),title:"Move backwards"}),B(je,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>s(1)),title:"Move forwards"}),B(je,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>s(1/0)),title:"Move to front"})]),_:1}),B(qe,{modelValue:oe(o),"onUpdate:modelValue":l[4]||(l[4]=a=>_e(o)?o.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}}),Y$=Me(X$,[["__scopeId","data-v-5a47d945"]]);var q$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const xl=t=>(_t("data-v-86d8c3fd"),t=t(),wt(),t),K$={class:"v-w100"},J$={colspan:"2"},Z$={key:0},Q$={colspan:"2"},e2={class:"v-w100 button-tbl"},t2={class:"arrow-col"},n2=["disabled"],o2=["value"],s2={class:"arrow-col"},r2=["disabled"],l2=xl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),i2={class:"v-w50"},a2=xl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),u2={class:"v-w50"},c2=xl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),d2={class:"v-w50"},f2=xl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),p2={class:"v-w50"},h2=Ce({__name:"position-and-size",props:{obj:{required:!0,type:Object}},setup(t){const e=Ne(),n=t,o=S({get(){const _=ue().TextBox;return n.obj.height-(l.value?_.NameboxHeight:0)},set(_){const w=ue().TextBox;Z(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:_+(l.value?w.NameboxHeight:0),width:n.obj.width})})}}),s=S({get(){return n.obj.width},set(_){Z(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:n.obj.height,width:_})})}}),r=S(()=>{const _=n.obj;if(_.type==="textBox")return ws[_.style].resizable;const w=ue().Poem;return _.type==="poem"?w.poemBackgrounds[_.background].file.startsWith("internal:"):!1}),l=S(()=>n.obj.type==="textBox"&&location.search.includes("alex")),a=S(()=>"freeMove"in n.obj),i=S(()=>ue().Base.positions),u=S(()=>f.value===0),c=S(()=>f.value===ue().Base.positions.length-1),f=S({get(){return Wr(n.obj.x)},set(_){Z(()=>q$(this,null,function*(){yield e.dispatch("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:ue().Base.characterPositions[_],y:n.obj.y})}))}}),p=S({get(){return!!n.obj.freeMove},set(_){Z(()=>{e.commit("panels/setFreeMove",{id:n.obj.id,panelId:n.obj.panelId,freeMove:_})})}}),g=S({get(){return n.obj.x},set(_){Z(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:_,y:b.value})})}}),b=S({get(){return n.obj.y},set(_){Z(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:g.value,y:_})})}});return(_,w)=>(x(),fe(It,{title:"Position"+(r.value?"/Size":"")},{default:X(()=>[d("table",K$,[d("tr",null,[d("td",J$,[a.value?(x(),fe(qe,{key:0,modelValue:p.value,"onUpdate:modelValue":w[0]||(w[0]=k=>p.value=k),label:"Move freely?"},null,8,["modelValue"])):de("",!0)])]),a.value&&!p.value?(x(),R("tr",Z$,[d("td",Q$,[d("table",e2,[d("tr",null,[d("td",t2,[d("button",{onClick:w[1]||(w[1]=k=>--f.value),disabled:u.value},"<",8,n2)]),d("td",null,[Oe(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":w[2]||(w[2]=k=>f.value=k)},[(x(!0),R(ae,null,Ue(i.value,(k,v)=>(x(),R("option",{key:v,value:v},$e(k),9,o2))),128))],512),[[$t,f.value,void 0,{number:!0}]])]),d("td",s2,[d("button",{onClick:w[3]||(w[3]=k=>++f.value),disabled:c.value},">",8,r2)])])])])])):(x(),R(ae,{key:1},[d("tr",null,[l2,d("td",i2,[Oe(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":w[4]||(w[4]=k=>g.value=k),onKeydown:w[5]||(w[5]=ce(()=>{},["stop"]))},null,544),[[Ke,g.value,void 0,{number:!0}]])])]),d("tr",null,[a2,d("td",u2,[Oe(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":w[6]||(w[6]=k=>b.value=k),onKeydown:w[7]||(w[7]=ce(()=>{},["stop"]))},null,544),[[Ke,b.value,void 0,{number:!0}]])])])],64)),r.value?(x(),R(ae,{key:2},[d("tr",null,[c2,d("td",d2,[Oe(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":w[8]||(w[8]=k=>s.value=k),onKeydown:w[9]||(w[9]=ce(()=>{},["stop"]))},null,544),[[Ke,s.value,void 0,{number:!0}]])])]),d("tr",null,[f2,d("td",p2,[Oe(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":w[10]||(w[10]=k=>o.value=k),onKeydown:w[11]||(w[11]=ce(()=>{},["stop"]))},null,544),[[Ke,o.value,void 0,{number:!0}]])])])],64)):de("",!0)])]),_:1},8,["title"]))}}),v2=Me(h2,[["__scopeId","data-v-86d8c3fd"]]);var g2=Object.defineProperty,m2=Object.defineProperties,b2=Object.getOwnPropertyDescriptors,_d=Object.getOwnPropertySymbols,y2=Object.prototype.hasOwnProperty,_2=Object.prototype.propertyIsEnumerable,wd=(t,e,n)=>e in t?g2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,w2=(t,e)=>{for(var n in e||(e={}))y2.call(e,n)&&wd(t,n,e[n]);if(_d)for(var n of _d(e))_2.call(e,n)&&wd(t,n,e[n]);return t},P2=(t,e)=>m2(t,b2(e));const Xs=t=>(_t("data-v-a012b412"),t=t(),wt(),t),C2={class:"column ok-col"},x2={class:"column"},k2=["value"],O2={key:0,class:"column error-col"},S2={class:"column"},$2=Xs(()=>d("p",{class:"hint-col"},"Apply style to selected text:",-1)),I2={class:"column"},j2={class:"column"},T2={class:"column"},A2=Bm('<option value data-v-a012b412>Font</option><option value="aller" style="font-family:aller;" data-v-a012b412> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-a012b412> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-a012b412> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-a012b412> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-a012b412> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-a012b412> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-a012b412> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-a012b412> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-a012b412> Halogen (MC) </option>',10),E2=[A2],R2=Xs(()=>d("option",{value:""},"Alignment",-1)),B2=Xs(()=>d("option",{value:"left",style:{"text-align":"left"}},"Left",-1)),M2=Xs(()=>d("option",{value:"right",style:{"text-align":"right"}},"Right",-1)),D2=Xs(()=>d("option",{value:"center",style:{"text-align":"center"}},"Center",-1)),L2=[R2,B2,M2,D2],N2=Ce(P2(w2({},{inheritAttrs:!1}),{__name:"text",props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},emits:["update:modelValue","leave"],setup(t,{emit:e}){const n=Ne(),o=e,s=L(null),r=L(""),l=L(""),a=L("#000000"),i=L(""),u=L(0),c=L(0),f=L(""),p=S(()=>n.state.ui.vertical);We(()=>p.value,()=>{const v=s.value;v!=null&&(v.style.height="",v.style.width="")}),We(()=>l.value,()=>{l.value!==""&&(k("font",l.value),l.value="")}),We(()=>i.value,()=>{i.value!==""&&(w(`{align=${i.value}}`),i.value="")});function g(){const v=ue(),h=s.value.value;try{new Dt(h,v.TextBox.NameboxTextStyle),f.value=""}catch(m){f.value=m.message}o("update:modelValue",h)}function b(v){const h=s.value;r.value=v,u.value=h.selectionStart,c.value=h.selectionEnd}function _(){const v=a.value,h=r.value,m=()=>{const j=s.value;if(j==null){Bn(m);return}j.selectionStart=u.value,j.selectionEnd=c.value,k(h==="text"?"color":"outlinecolor",v)};Bn(m),a.value="#000000",r.value=""}function w(v){const h=s.value,m=h.value,j=h.selectionStart,P=h.selectionEnd;h.value=m.slice(0,j)+v+m.slice(P),h.selectionStart=h.selectionEnd=j+v.length,h.focus(),g()}function k(v,h){const m=s.value,j=m.value,P=m.selectionStart,A=m.selectionEnd,D=j.slice(P,A),M=j.slice(0,P),Y=j.slice(A);let z=v;h!=null&&(z+="="+h),m.value=`${M}{${z}}${D}{/${v}}${Y}`,m.selectionStart=P+z.length+2,m.selectionEnd=m.selectionStart+D.length,m.focus(),g()}return(v,h)=>r.value?(x(),fe(Cl,{key:0,modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=m=>a.value=m),onLeave:_},null,8,["modelValue"])):(x(),R("div",{key:1,class:Le({"text-subpanel":!0,vertical:p.value})},[d("h2",null,$e(t.title),1),d("div",C2,[d("button",{onClick:h[1]||(h[1]=m=>o("leave"))},"OK")]),d("div",x2,[d("textarea",{class:"v-w100",ref_key:"textArea",ref:s,value:t.modelValue,onInput:g,onKeydown:h[2]||(h[2]=ce(()=>{},["stop"])),onKeypress:h[3]||(h[3]=ce(()=>{},["stop"]))},null,40,k2)]),f.value?(x(),R("div",O2,$e(f.value),1)):de("",!0),d("div",S2,[d("button",{onClick:h[4]||(h[4]=m=>w("\\\\")),class:"style-button"},"Insert \\"),d("button",{onClick:h[5]||(h[5]=m=>w("\\{")),class:"style-button"},"Insert {"),d("button",{onClick:h[6]||(h[6]=m=>w("\\}")),class:"style-button"},"Insert }")]),$2,d("div",I2,[d("button",{onClick:h[7]||(h[7]=m=>k("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:h[8]||(h[8]=m=>k("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:h[9]||(h[9]=m=>k("plain")),class:"style-button"}," Plain "),d("button",{onClick:h[10]||(h[10]=m=>k("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:h[11]||(h[11]=m=>k("k",2)),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),d("div",j2,[d("button",{onClick:h[12]||(h[12]=m=>k("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",T2,[d("button",{onClick:h[13]||(h[13]=m=>k("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Oe(d("select",{"onUpdate:modelValue":h[14]||(h[14]=m=>l.value=m),class:"style-button"},E2,512),[[$t,l.value]]),Oe(d("select",{"onUpdate:modelValue":h[15]||(h[15]=m=>i.value=m),class:"style-button"},L2,512),[[$t,i.value]]),d("button",{onClick:h[16]||(h[16]=m=>b("text")),class:"style-button"}," Text color "),d("button",{onClick:h[17]||(h[17]=m=>b("outline")),class:"style-button"}," Outline color ")])],2))}})),F2=Me(N2,[["__scopeId","data-v-a012b412"]]);var V2=Object.defineProperty,Pd=Object.getOwnPropertySymbols,H2=Object.prototype.hasOwnProperty,U2=Object.prototype.propertyIsEnumerable,Cd=(t,e,n)=>e in t?V2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xd=(t,e)=>{for(var n in e||(e={}))H2.call(e,n)&&Cd(t,n,e[n]);if(Pd)for(var n of Pd(e))U2.call(e,n)&&Cd(t,n,e[n]);return t},Zl=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const nn=t=>(_t("data-v-d6b22891"),t=t(),wt(),t),W2=nn(()=>d("span",{class:"icon material-icons"},"edit",-1)),z2=nn(()=>d("p",{class:"modal-text"},"Enter the new name",-1)),G2={class:"modal-text"},X2=nn(()=>d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),Y2=nn(()=>d("option",{value:""},"None",-1)),q2=["value"],K2={class:"input-table v-w100"},J2=nn(()=>d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation:")],-1)),Z2={for:"zoom",class:"v-w100"},Q2={key:0},eI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),tI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),nI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),oI={key:0,colspan:"2"},sI={key:0},rI=nn(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),lI=nn(()=>d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),iI=["placeholder"],aI=Ce({__name:"object-tool",props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},setup(t){const e=Ne(),n=L(null),o=t,s=(I,O)=>Vo(e,S(()=>o.object),O,!1,I);Lt(n);const r=S({get(){var I;return(I=o.object.linkedTo)!=null?I:""},set(I){const O=o.object,T=I===""?null:I,$=No(e),re=$==null?void 0:$.getLastRenderObject(O.id),me=T===null?$==null?void 0:$.getLastRenderObject(O.linkedTo):$==null?void 0:$.getLastRenderObject(T);try{if(!re||!me)e.commit("panels/setLink",{panelId:b.value.id,id:O.id,link:T,x:O.x,y:O.y,scaleX:O.scaleX,scaleY:O.scaleY,skewX:O.skewX,skewY:O.skewY,rotation:O.rotation});else if(T==null)e.commit("panels/setLink",xd({panelId:b.value.id,id:O.id,link:T},Vr(re.preparedTransform)));else{const Ee=me.preparedTransform.inverse().multiply(re.preparedTransform);console.log(re.preparedTransform),console.log(me.preparedTransform.multiply(Ee)),console.log(Ee),e.commit("panels/setLink",xd({panelId:b.value.id,id:O.id,link:T},Vr(Ee)))}}catch(xe){xe instanceof Error?Te.fire(new js(xe.message)):Te.fire(new js(""+xe))}}}),l=L(!1),a=L(""),i=L(!1),u=L(null),c=s("flip","panels/setFlip"),f=s("rotation","panels/setRotation"),p=s("enlargeWhenTalking","panels/setEnlargeWhenTalking");S(()=>"overflow"in o.object);const g=S(()=>cP(o.object)),b=S(()=>e.state.panels.panels[o.object.panelId]),_=S(()=>{const I=b.value,O=[];for(const T of[...I.order,...I.onTopOrder]){const $=I.objects[T];$.label===null||$===o.object||O.push([T,$.label])}return O}),w=location.search.includes("alex");S({get(){var I;return(I=o.object.overflow)!=null?I:!1},set(I){Z(()=>Zl(this,null,function*(){yield e.commit("panels/setOverflow",{id:o.object.id,panelId:o.object.panelId,overflow:I})}))}});const k=S({get(){return o.object.preserveRatio},set(I){Z(()=>Zl(this,null,function*(){yield e.dispatch("panels/setPreserveRatio",{id:o.object.id,panelId:o.object.panelId,preserveRatio:I})}))}}),v=S({get(){const I=o.object.nameboxWidth;return I===null?"":I},set(I){const O=typeof I=="string"&&I.trim()===""?null:parseInt(I+"");Z(()=>{e.commit("panels/setObjectNameboxWidth",{id:o.object.id,panelId:o.object.panelId,nameboxWidth:O})})}}),h=S({get(){return o.object.scaleX*100},set(I){Z(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:I/100,scaleY:o.object.preserveRatio?I/100*o.object.ratio:o.object.scaleY})})}}),m=S({get(){return o.object.scaleY*100},set(I){Z(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:o.object.preserveRatio?I/100/o.object.ratio:o.object.scaleX,scaleY:I/100})})}}),j=S({get(){return o.object.skewX},set(I){Z(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:I,skewY:o.object.skewY})})}}),P=S({get(){return o.object.skewY},set(I){Z(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:o.object.skewX,skewY:I})})}}),A=S(()=>ue().TextBox.NameboxWidth),D=S(()=>u.value||o.colorHandler||null),M=S(()=>o.object.label!==null),Y=S(()=>{var I,O;return(O=(I=o.object.label)!=null?I:o.title)!=null?O:"Object"}),z=S({get(){return o.object.textboxColor!==null},set(I){Z(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:I?ue().TextBoxCustom.textboxDefaultColor:null})})}});function F(){Z(()=>Zl(this,null,function*(){yield e.dispatch("panels/copyObjectToClipboard",{panelId:o.object.panelId,id:o.object.id})}))}function ne(){var I;a.value=(I=o.object.label)!=null?I:"",i.value=!0}function le(I){i.value=!1,I==="Apply"&&Z(()=>{e.commit("panels/setLabel",{panelId:o.object.panelId,id:o.object.id,label:a.value})})}function q(){u.value={title:"Textbox color",get:()=>o.object.textboxColor,set:I=>{Z(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:I})})},leave:()=>{u.value=null}}}return(I,O)=>(x(),R("div",{class:"panel",ref_key:"root",ref:n},[d("h1",{style:Qe({fontStyle:M.value?"italic":"normal"}),onClick:ne},[U($e(Y.value)+" ",1),W2],4),(x(),fe(Sf,{to:"#modal-messages"},[i.value?(x(),fe(So,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:le,onLeave:O[2]||(O[2]=T=>le("Cancel"))},{default:X(()=>[z2,d("p",G2,[Oe(d("input",{"onUpdate:modelValue":O[0]||(O[0]=T=>a.value=T),style:{width:"100%"},onKeydown:O[1]||(O[1]=lt(ce(T=>le("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Ke,a.value]])])]),_:1})):de("",!0)])),t.textHandler?(x(),fe(F2,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":O[3]||(O[3]=T=>t.textHandler.set(T)),onLeave:O[4]||(O[4]=T=>t.textHandler.leave())},null,8,["title","modelValue"])):D.value?(x(),fe(Cl,{key:1,title:D.value.title,modelValue:D.value.get(),"onUpdate:modelValue":O[5]||(O[5]=T=>D.value.set(T)),onLeave:O[6]||(O[6]=T=>D.value.leave())},null,8,["title","modelValue"])):l.value?(x(),fe(Fa,{key:2,type:"object","panel-id":t.object.panelId,id:t.object.id,onLeave:O[7]||(O[7]=T=>l.value=!1)},null,8,["panel-id","id"])):t.showAltPanel?Qt(I.$slots,"alt-panel",{key:3},void 0,!0):(x(),R(ae,{key:4},[Qt(I.$slots,"default",{},void 0,!0),B(v2,{obj:t.object},null,8,["obj"]),B(Y$,{object:t.object},null,8,["object"]),B(It,{title:"Transform",class:"transforms"},{default:X(()=>[B(qe,{modelValue:oe(c),"onUpdate:modelValue":O[8]||(O[8]=T=>_e(c)?c.value=T:null),label:"Flip?"},null,8,["modelValue"]),X2,Oe(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":O[9]||(O[9]=T=>r.value=T),onKeydown:O[10]||(O[10]=ce(()=>{},["stop"]))},[Y2,(x(!0),R(ae,null,Ue(_.value,([T,$])=>(x(),R("option",{key:T,value:T},$e($),9,q2))),128))],544),[[$t,r.value]]),d("table",K2,[d("tr",null,[J2,d("td",null,[Oe(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":O[11]||(O[11]=T=>_e(f)?f.value=T:null),onKeydown:O[12]||(O[12]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(f)]])])]),g.value?(x(),R(ae,{key:0},[d("tr",null,[d("td",null,[d("label",Z2,$e(oe(w)?"Zoom":"Scale X"),1)]),d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":O[13]||(O[13]=T=>h.value=T),onKeydown:O[14]||(O[14]=ce(()=>{},["stop"]))},null,544),[[Ke,h.value]])])]),oe(w)?de("",!0):(x(),R("tr",Q2,[eI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":O[15]||(O[15]=T=>m.value=T),onKeydown:O[16]||(O[16]=ce(()=>{},["stop"]))},null,544),[[Ke,m.value]])])]))],64)):de("",!0),d("tr",null,[tI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":O[17]||(O[17]=T=>j.value=T),onKeydown:O[18]||(O[18]=ce(()=>{},["stop"]))},null,544),[[Ke,j.value]])])]),d("tr",null,[nI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":O[19]||(O[19]=T=>P.value=T),onKeydown:O[20]||(O[20]=ce(()=>{},["stop"]))},null,544),[[Ke,P.value]])])]),d("tr",null,[oe(w)?de("",!0):(x(),R("td",oI,[B(qe,{modelValue:k.value,"onUpdate:modelValue":O[21]||(O[21]=T=>k.value=T),label:"Lock scale ratio?"},null,8,["modelValue"])]))])]),Qt(I.$slots,"transform",{},void 0,!0)]),_:3}),Qt(I.$slots,"options",{},void 0,!0),M.value?(x(),fe(It,{key:0,title:"Textbox settings"},{default:X(()=>{var T;return[t.object.type==="character"||t.object.type==="sprite"?(x(),fe(qe,{key:0,label:"Enlarge when talking",modelValue:oe(p),"onUpdate:modelValue":O[22]||(O[22]=$=>_e(p)?p.value=$:null)},null,8,["modelValue"])):de("",!0),B(qe,{label:"Own textbox color",modelValue:z.value,"onUpdate:modelValue":O[23]||(O[23]=$=>z.value=$)},null,8,["modelValue"]),d("table",null,[z.value?(x(),R("tr",sI,[rI,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Qe({background:(T=t.object.textboxColor)!=null?T:""}),onClick:q},null,4)])])):de("",!0),d("tr",null,[lI,d("td",null,[Oe(d("input",{id:"namebox_width",type:"number",placeholder:A.value+"","onUpdate:modelValue":O[24]||(O[24]=$=>v.value=$)},null,8,iI),[[Ke,v.value,void 0,{lazy:!0}]])])])])]}),_:1})):de("",!0),d("button",{onClick:O[25]||(O[25]=T=>l.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:F},"Copy"),B(z$,{class:"v-bt0",obj:t.object},null,8,["obj"])],64))],512))}}),Jo=Me(aI,[["__scopeId","data-v-d6b22891"]]);var is=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const uI={class:"warning"},cI={style:{"word-wrap":"break-word"}},dI={class:"button-tbl"},fI={key:0},pI={class:"arrow-col"},hI={class:"arrow-col"},vI={key:1},gI={class:"arrow-col"},mI={class:"arrow-col"},bI={class:"arrow-col"},yI=["onClick"],_I=["onClick"],wI={class:"arrow-col"},PI=["onClick"],CI=Ce({__name:"character",setup(t){const e=Ne(),n=L(null),o=L(null);Lt(n);const s=L(null),r=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=S(()=>e.state.ui.selection),a=S(()=>{const j=r.value.objects[l.value];if(j.type==="character")return j}),i=Vo(e,a,"panels/setClose",!1,"close"),u=S(()=>{const j=a.value,P=Ur(c.value,j);if(!P)return null;for(const A of P.variants){const D=Mn(A[0],!1);if(D.startsWith("uploads:"))return D.substring(8)}return null}),c=S(()=>pl(e,a.value)),f=S(()=>{var j;return(j=c.value.label)!=null?j:""}),p=S(()=>IP(c.value,a.value)),g=S(()=>c.value.styleGroups[a.value.styleGroupId].styles.length>1||c.value.styleGroups.length>1),b=S(()=>c.value.styleGroups[a.value.styleGroupId].styles[a.value.styleId].poses.length>1);function _(){o.value.click()}function w(){return is(this,null,function*(){const j=o.value;if(!j.files)return;if(j.files.length!==1){console.error("More than one file uploaded!");return}const P=j.files[0];yield Z(()=>is(this,null,function*(){const A=URL.createObjectURL(P);yield e.dispatch("uploadUrls/add",{name:u.value,url:A})}))})}function k(j){Z(()=>is(this,null,function*(){yield e.dispatch("panels/seekPose",{id:a.value.id,panelId:a.value.panelId,delta:j})}))}function v(j){Z(()=>is(this,null,function*(){yield e.dispatch("panels/seekStyle",{id:a.value.id,panelId:a.value.panelId,delta:j})}))}function h(j,P){Z(()=>is(this,null,function*(){yield e.dispatch("panels/seekPart",{id:a.value.id,panelId:a.value.panelId,delta:P,part:j})}))}function m(j){return j.charAt(0).toUpperCase()+j.substring(1)}return We(()=>l.value,()=>{s.value=null}),(j,P)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:a.value,title:f.value,showAltPanel:!!s.value},{"alt-panel":X(()=>[s.value?(x(),fe(U$,{key:0,character:a.value,part:s.value,onLeave:P[0]||(P[0]=A=>s.value=null),onShowDialog:P[1]||(P[1]=A=>j.$emit("show-dialog",A)),onShowExpressionDialog:P[2]||(P[2]=A=>j.$emit("show-expression-dialog",A))},null,8,["character","part"])):de("",!0)]),default:X(()=>[u.value?(x(),R(ae,{key:0},[d("p",uI,[U(" MISSING Head sprite! Click below to re-upload "),d("span",cI,'"'+$e(u.value)+'"',1),U(". ")]),d("button",{onClick:P[3]||(P[3]=A=>_())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:o,onChange:w},null,544)],64)):de("",!0),b.value||p.value.length>0||g.value?(x(),fe(It,{key:1,class:"pose-list",title:"Pose:"},{default:X(()=>[d("table",dI,[d("tbody",null,[g.value?(x(),R("tr",fI,[d("td",pI,[d("button",{onClick:P[4]||(P[4]=A=>v(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:P[5]||(P[5]=A=>s.value="style")}," Style ")]),d("td",hI,[d("button",{onClick:P[6]||(P[6]=A=>v(1))},">")])])):de("",!0),b.value?(x(),R("tr",vI,[d("td",gI,[d("button",{onClick:P[7]||(P[7]=A=>k(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:P[8]||(P[8]=A=>s.value="pose")}," Pose ")]),d("td",mI,[d("button",{onClick:P[9]||(P[9]=A=>k(1))},">")])])):de("",!0),(x(!0),R(ae,null,Ue(p.value,A=>(x(),R("tr",{key:A},[d("td",bI,[d("button",{onClick:D=>h(A,-1)},"<",8,yI)]),d("td",null,[d("button",{class:"middle-button",onClick:D=>s.value=A},$e(m(A)),9,_I)]),d("td",wI,[d("button",{onClick:D=>h(A,1)},">",8,PI)])]))),128))])])]),_:1})):de("",!0)]),transform:X(()=>[B(qe,{modelValue:oe(i),"onUpdate:modelValue":P[10]||(P[10]=A=>_e(i)?i.value=A:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}}),xI=Me(CI,[["__scopeId","data-v-3e5fb1c2"]]);var kd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const kI=t=>(_t("data-v-271f7003"),t=t(),wt(),t),OI=["onClick"],SI=kI(()=>d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),$I=Ce({__name:"choice",setup(t){const e=Ne(),n=L(null);Lt(n);const o=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=S(()=>{const w=o.value.objects[e.state.ui.selection];if(w.type==="choice")return w}),r=(w,k)=>Vo(e,s,k,!1,w),l=L(0),a=L(!1),i=r("autoWrap","panels/setAutoWrapping"),u=_("text"),c=S(()=>s.value.choices),f=S(()=>{if(a.value)return{title:"Text",get:()=>u.value,set:w=>{u.value=w},leave:()=>{a.value=!1}}});function p(w){l.value=w}function g(){Z(()=>kd(this,null,function*(){yield e.dispatch("panels/addChoice",{id:s.value.id,panelId:s.value.panelId,text:""})}))}function b(){Z(()=>kd(this,null,function*(){l.value===s.value.choices.length-1&&l.value>0&&p(l.value-1),yield e.dispatch("panels/removeChoice",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value})}))}function _(w){return S({get(){return s.value.choices[l.value][w]},set(k){Z(()=>{e.commit("panels/setChoiceProperty",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value,key:w,value:k})})}})}return(w,k)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:s.value,title:"Choice",textHandler:f.value},{default:X(()=>[B(It,{class:"buttons",title:"Buttons:"},{default:X(()=>[B(Rt,{maxSize:"100%",direction:"vertical",noWraping:""},{default:X(()=>[(x(!0),R(ae,null,Ue(c.value,(v,h)=>(x(),R("div",{class:Le({choiceBtn:!0,active:h===l.value}),key:h,onClick:m=>p(h)},$e(v.text.trim()===""?"[Empty]":v.text),11,OI))),128))]),_:1})]),_:1}),B(It,{class:"current_button",title:"Current button:"},{default:X(()=>[d("table",null,[SI,d("tr",null,[d("td",null,[Oe(d("input",{id:"choice-button-input","onUpdate:modelValue":k[0]||(k[0]=v=>_e(u)?u.value=v:null),onKeydown:k[1]||(k[1]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(u)]])]),d("td",null,[d("button",{onClick:k[2]||(k[2]=v=>a.value=!0)},"...")])])])]),_:1}),d("button",{onClick:g},"Add"),d("button",{onClick:b},"Remove"),B(qe,{label:"Auto line wrap?",modelValue:oe(i),"onUpdate:modelValue":k[3]||(k[3]=v=>_e(i)?i.value=v:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),II=Me($I,[["__scopeId","data-v-271f7003"]]),pn=t=>(_t("data-v-e852d4f2"),t=t(),wt(),t),jI=pn(()=>d("h1",null,"Help and Credits",-1)),TI=pn(()=>d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),AI=pn(()=>d("p",null,[U(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),U("Based on gemdude46's DDLC Shitpost generator ")],-1)),EI=pn(()=>d("p",null,[U(" MC Sprite by Childish-N "),d("br"),U("MC Casual Sprite by SlightlySimple "),d("br"),U("MC Chibi by SlightlySimple ")],-1)),RI=pn(()=>d("p",null,[U(" MC Chad Sprite by Cylent-Nite "),d("br"),U("MC Chad Poses and expressions by SlightlySimple "),d("br"),U("MC Chad Poses and chibi by Meddy-sin ")],-1)),BI=pn(()=>d("p",null,[U(" FeMC Sprite by Meddy-sin "),d("br"),U("FeMC Casual Sprite by SlightlySimple ")],-1)),MI=pn(()=>d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),DI=pn(()=>d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),LI=pn(()=>d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1)),NI=Ce({__name:"credits",setup(t){const e=L(null);return Lt(e),(n,o)=>(x(),R("div",{class:"panel",ref_key:"root",ref:e},[jI,B(Xe,{class:"btn",to:"wiki://Dokumentation"},{default:X(()=>[U("Help")]),_:1}),B(Xe,{class:"btn",to:"github://"},{default:X(()=>[U("Fork me on GitHub")]),_:1}),B(Xe,{class:"btn",to:"wiki://Privacy Statement"},{default:X(()=>[U("Privacy Statement")]),_:1}),TI,AI,d("p",null,[U(" Unused House Background by "),B(Xe,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:X(()=>[U(" Fatelogic ")]),_:1})]),d("p",null,[U(" Aller Font by "),B(Xe,{to:"https://www.daltonmaag.com/library/aller"},{default:X(()=>[U("Dalton Maag Ltd")]),_:1})]),d("p",null,[U(" Riffic Bold Font by "),B(Xe,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:X(()=>[U("InkyType")]),_:1})]),d("p",null,[U(" Verily Serif Mono Font by "),B(Xe,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:X(()=>[U("Stephen G. Hartke")]),_:1})]),d("p",null,[U(" F25 Bank Printer Font by "),B(Xe,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:X(()=>[U("F25 Digital Typeface Design")]),_:1})]),d("p",null,[U(" Journal Font by "),B(Xe,{to:"https://www.dafont.com/journal.font"},{default:X(()=>[U("Fontourist")]),_:1})]),d("p",null,[U(" Hashtag Font by "),B(Xe,{to:"https://www.dafont.com/hashtag.font"},{default:X(()=>[U(" TitanVex")]),_:1})]),d("p",null,[U(" JP Hand Slanted Font by "),B(Xe,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:X(()=>[U("Jonathan Paterson")]),_:1})]),d("p",null,[U(" As I Lay Dying Font by "),B(Xe,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:X(()=>[U("Moises Esqueda")]),_:1})]),d("p",null,[U(" Damagrafik Script Font by "),B(Xe,{to:"https://www.dafont.com/damagrafik-script.font"},{default:X(()=>[U("Davide Terenzi")]),_:1})]),d("p",null,[U(" Ammy's Handwriting Font by "),B(Xe,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:X(()=>[U("Ammy K.")]),_:1})]),d("p",null,[U(" Halogen Font by "),B(Xe,{to:"https://www.dafont.com/halogen.font"},{default:X(()=>[U("JLH Fonts")]),_:1})]),EI,d("p",null,[B(Xe,{to:"https://www.reddit.com/ofkg59"},{default:X(()=>[U("Concept MC")]),_:1}),U(" by StormBlazed76, "),B(Xe,{to:"https://www.reddit.com/og6shh"},{default:X(()=>[U("red")]),_:1}),U(" and "),B(Xe,{to:"https://www.reddit.com/oft3vb"},{default:X(()=>[U("yellow")]),_:1}),U(" eyes by YinuS_WinneR, "),B(Xe,{to:"https://www.reddit.com/ofof3o"},{default:X(()=>[U("chibi")]),_:1}),U(" by Hadrosaur838 ")]),RI,BI,d("p",null,[B(Xe,{to:"https://www.reddit.com/oizaow"},{default:X(()=>[U("Concept FeMC")]),_:1}),U(" by ShidoDraws, "),B(Xe,{to:"https://www.reddit.com/oosuxu"},{default:X(()=>[U("additional poses, expressions and chibi")]),_:1}),U(" by SlightlySimple ")]),MI,DI,LI],512))}}),FI=Me(NI,[["__scopeId","data-v-e852d4f2"]]),VI=t=>(_t("data-v-04159db4"),t=t(),wt(),t),HI={id:"notification_text_wrapper"},UI=VI(()=>d("label",{for:"notification_text"},"Text:",-1)),WI=Ce({__name:"notification",setup(t){const e=Ne(),n=L(null);Lt(n);const o=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=S(()=>{const c=o.value.objects[e.state.ui.selection];if(c.type==="notification")return c}),r=c=>Va(e,s,"panels/setNotificationProperty",!1,c),l=r("text"),a=r("backdrop"),i=L(!1),u=S(()=>{if(i.value)return{title:"Text",get:()=>l.value,set:c=>{l.value=c},leave:()=>{i.value=!1}}});return(c,f)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:s.value,title:"Notification",textHandler:u.value},{default:X(()=>[d("div",HI,[UI,Oe(d("textarea",{"onUpdate:modelValue":f[0]||(f[0]=p=>_e(l)?l.value=p:null),id:"notification_text",onKeydown:f[1]||(f[1]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(l)]]),d("button",{onClick:f[2]||(f[2]=p=>i.value=!0)},"Formatting")])]),options:X(()=>[B(qe,{modelValue:oe(a),"onUpdate:modelValue":f[3]||(f[3]=p=>_e(a)?a.value=p:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),zI=Me(WI,[["__scopeId","data-v-04159db4"]]);var dt=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const ao=t=>(_t("data-v-ee0e5abb"),t=t(),wt(),t),GI=ao(()=>d("h1",null,"Panels",-1)),XI=["onClick","onKeydown"],YI={class:"panel_text"},qI={class:"panel_nr"},KI={class:"column"},JI={class:"v-w100"},ZI=ao(()=>d("td",null,[d("label",{for:"export_format"},"Format")],-1)),QI=ao(()=>d("option",{value:"image/png"},"PNG (lossless)",-1)),ej={key:0,value:"image/webp"},tj={key:1,value:"image/heif"},nj=ao(()=>d("option",{value:"image/jpeg"},"JPEG (lossy)",-1)),oj={key:0},sj=ao(()=>d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),rj={for:"export_ppi"},lj={key:0},ij=ao(()=>d("br",null,null,-1)),aj={for:"export_pages"},uj={key:0},cj=ao(()=>d("br",null,null,-1)),dj={colspan:"2"},fj={class:"column"},pj=100,hj=90,Od=70,Sd=1/4,vj=.5,gj=Ce({__name:"panels",setup(t){const e=Ne(),n=L(null),{vertical:o,getRoot:s}=Lt(n),r=L(pe.supports.limitedCanvasSpace?10:0),l=L(""),a=L("image/png"),i=L(hj),u=L(!1),c=L(null),f=ue().Base,p=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),g=S(()=>a.value!=="image/png"),b=S(()=>m.value.length>1);function _(W){return W===""}const w=L(!1),k=L(!1);Promise.allSettled([Ao(),ky()]).then(([W,K])=>{W.status==="fulfilled"&&(w.value=W.value),K.status==="fulfilled"&&(k.value=K.value)});const v=S(()=>e.state.panels.panelOrder.indexOf(p.value.id)>0),h=S(()=>{const W=e.state.panels.panelOrder;return W.indexOf(p.value.id)<W.length-1}),m=S(()=>e.state.panels.panelOrder.map(K=>{const ie=e.state.panels.panels[K],be=e.state.panels.panels[K],Re=[...be.order,...be.onTopOrder].map(y=>e.state.panels.panels[K].objects[y]).map(j);return{id:K,image:ie.lastRender,text:Re.reduce((y,C)=>y.length>C.length?y:C,"")}}));function j(W){switch(W.type){case"textBox":return W.text;case"notification":return W.text;case"poem":return W.text;case"choice":return W.choices.map(K=>`[${K.text}]`).join(`
`)}return""}function P(){const W=s().querySelector(".panel_button.active");W!=null&&A(W)}function A(W){const K=W.parentElement.parentElement;e.state.ui.vertical?(K.scrollTop=W.offsetTop-K.clientHeight/2,K.scrollLeft=0):(K.scrollLeft=W.offsetLeft-K.clientWidth/2,K.scrollTop=0)}mt(()=>{P()});function D(){const W=new Date;return`cd-${[W.getFullYear(),`${W.getMonth()+1}`.padStart(2,"0"),`${W.getDate()}`.padStart(2,"0"),`${W.getHours()}`.padStart(2,"0"),`${W.getMinutes()}`.padStart(2,"0"),`${W.getSeconds()}`.padStart(2,"0")].join("-")}`}function M(){return dt(this,null,function*(){yield Fo("export image",()=>dt(this,null,function*(){const W=F(),K=a.value.split("/")[1],ie=a.value,be=i.value,Re=D();yield Y(W,!0,(y,C)=>dt(this,null,function*(){yield pe.saveToFile(C,`${Re}_${y}.${K}`,ie,be/pj)}))}))})}function Y(W,K,ie){return dt(this,null,function*(){const be=ue().Base,Re=[];for(let y=0;y<W.length;++y){const C=W[y],E=document.createElement("canvas");E.width=be.screenWidth,E.height=be.screenHeight*C.length;try{const V=E.getContext("2d");for(let N=0;N<C.length;++N){const G=C[N],te=new Li(e,G,be.screenWidth,be.screenHeight);try{yield te.render(K,!1,!0),te.paintOnto(V,{x:0,y:be.screenHeight*N,w:be.screenWidth,h:be.screenHeight})}finally{te.dispose()}}Re.push(yield ie(y,E))}finally{Bo(E)}}return Re})}function z(){const W=e.state.panels.panelOrder.length-1,K=0,ie=l.value.split(","),be=[];let Re=!1;for(const y of ie){const C=y.trim(),E=C.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!E){C!==""&&Te.fire(new At(`Could not read '${y}' in the page list.`));continue}if(Re=!0,E[2])be.push(parseInt(E[2],10)-1);else{const V=Math.max(parseInt(E[3],10)-1,K),N=Math.min(parseInt(E[4],10)-1,W);if(V==null||N==null||V>N)continue;for(let G=V;G<=N;++G)be.push(G)}}return Re?be.sort((y,C)=>y-C).filter((y,C,E)=>E[C-1]!==y).map(y=>e.state.panels.panelOrder[y]):e.state.panels.panelOrder}function F(){const W=z();if(isNaN(r.value)&&(r.value=0),r.value===0)return[W];const K=[];for(let ie=0;ie<W.length/r.value;++ie){const be=ie*r.value,Re=be+r.value;K.push([...W.slice(be,Re)])}return K}function ne(){return dt(this,null,function*(){yield Z(()=>dt(this,null,function*(){yield e.dispatch("panels/duplicatePanel",{panelId:e.state.panels.currentPanel})})),yield Bn(),P()})}function le(W){Z(()=>{e.commit("panels/setCurrentPanel",{panelId:W})}),Bn(()=>{P()})}function q(){Z(()=>dt(this,null,function*(){yield e.dispatch("panels/delete",{panelId:e.state.panels.currentPanel})})),Bn(()=>{P()})}function I(){Z(()=>dt(this,null,function*(){yield e.dispatch("panels/move",{panelId:p.value.id,delta:-1})}))}function O(){Z(()=>dt(this,null,function*(){yield e.dispatch("panels/move",{panelId:p.value.id,delta:1})}))}const T=ro();T.width=f.screenWidth*Sd,T.height=f.screenHeight*Sd;const $=T.getContext("2d"),re=L(!1),me=S(()=>e.state.panels.panelOrder.filter(K=>e.state.panels.panels[K].lastRender==null));function xe(){return dt(this,null,function*(){const W=No(e);W&&(yield Ee(W))})}function Ee(W){return dt(this,null,function*(){yield Fo("render thumbnail",()=>dt(this,null,function*(){const K=W.panelId;W.paintOnto($,{x:0,y:0,w:$.canvas.width,h:$.canvas.height}),$.canvas.toBlob(ie=>{if(!ie)return;const be=URL.createObjectURL(ie);Z(()=>{e.commit("panels/setPanelPreview",{panelId:K,url:be})})},(yield Ao())?"image/webp":"image/jpeg",vj)}))})}function Ct(){return dt(this,null,function*(){const W=ue().Base;if(!re.value||pe.supports.limitedCanvasSpace)return;const K=me.value;if(K.length===0)return;const ie=K[0],be=new Li(e,ie,W.screenWidth,W.screenHeight);yield be.render(!1,!1,!0),yield Ee(be),setTimeout(()=>{Ct()},500)})}mt(()=>{re.value=!0,requestAnimationFrame(()=>xe().catch(()=>{}))}),Wt(()=>{re.value=!1,Bo($.canvas)}),Te.subscribe(Wf,()=>requestAnimationFrame(xe));function Q(){return dt(this,null,function*(){const W=yield e.dispatch("getSave",!0),K=new Blob([W],{type:"text/plain"}),ie=new Date,be=`save-${[ie.getFullYear(),`${ie.getMonth()+1}`.padStart(2,"0"),`${ie.getDate()}`.padStart(2,"0"),`${ie.getHours()}`.padStart(2,"0"),`${ie.getMinutes()}`.padStart(2,"0"),`${ie.getSeconds()}`.padStart(2,"0")].join("-")}`;pe.storeSaveFile(K,`${be}.dddg`)})}function ye(){return dt(this,null,function*(){yield Z(()=>dt(this,null,function*(){const W=c.value;if(!W.files)return;Te.fire(new Xf);const K=yield Se(W.files[0]);yield e.dispatch("loadSave",K),pe.supports.limitedCanvasSpace&&Te.fire(new At("To prevent running out of memory, thumbnails will not be automatically restored in the background."))})),yield xe(),setTimeout(()=>{Ct()},1e3)})}function Se(W){return new Promise((K,ie)=>{const be=new FileReader;be.onload=function(){K(be.result)},be.onerror=function(Re){ie(Re)},be.readAsText(W)})}return We(()=>i.value,(W,K)=>{if(W===100){Te.fire(new At("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(K>Od&&W<=Od){Te.fire(new At("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),We(()=>r.value,(W,K)=>{if(pe.supports.limitedCanvasSpace&&(K<=10&&W>10||W===0&&m.value.length>10)){Te.fire(new At("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(W,K)=>(x(),R("div",{class:"panel",ref_key:"root",ref:n},[GI,u.value?(x(),fe(Fa,{key:0,type:"panel",title:"","panel-id":p.value.id,"no-composition":"",onLeave:K[0]||(K[0]=ie=>{u.value=!1,xe()})},null,8,["panel-id"])):(x(),R(ae,{key:1},[B(It,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:X(()=>[B(Rt,{"no-wraping":"",maxSize:"350px"},{default:X(()=>[(x(!0),R(ae,null,Ue(m.value,(ie,be)=>(x(),R("div",{key:ie.id,class:Le({panel_button:!0,active:ie.id===p.value.id}),style:Qe(`background-image: url('${ie.image}')`),tabindex:"0",onClick:Re=>le(ie.id),onKeydown:[lt(Re=>le(ie.id),["enter"]),lt(ce(Re=>le(ie.id),["prevent"]),["space"])]},[d("div",YI,[d("p",null,$e(ie.text),1)]),d("div",qI,$e(be+1),1)],46,XI))),128))]),_:1})]),_:1}),d("div",KI,[B(je,{icon:"add_to_queue",onClick:ne},{default:X(()=>[U(" Add new")]),_:1}),B(je,{icon:"remove_from_queue",class:"bt0",onClick:q,disabled:!b.value},{default:X(()=>[U(" Delete panel ")]),_:1},8,["disabled"]),B(je,{icon:"arrow_upward",class:"bt0",onClick:I,disabled:!v.value},{default:X(()=>[U(" Move ahead ")]),_:1},8,["disabled"]),B(je,{icon:"arrow_downward",class:"bt0",onClick:O,disabled:!h.value},{default:X(()=>[U(" Move behind ")]),_:1},8,["disabled"]),B(je,{class:"bt0",icon:"color_lens",onClick:K[1]||(K[1]=ie=>u.value=!0)},{default:X(()=>[U(" Image options ")]),_:1})]),B(It,{title:"Export",class:"h-h100"},{default:X(()=>[d("table",JI,[d("tr",null,[ZI,d("td",null,[Oe(d("select",{id:"export_format","onUpdate:modelValue":K[2]||(K[2]=ie=>a.value=ie)},[QI,w.value?(x(),R("option",ej," WebP (lossy) ")):de("",!0),k.value?(x(),R("option",tj," HEIF (lossy) ")):de("",!0),nj],512),[[$t,a.value]])])]),g.value?(x(),R("tr",oj,[sj,d("td",null,[Oe(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":K[3]||(K[3]=ie=>i.value=ie),onKeydown:K[4]||(K[4]=ce(()=>{},["stop"]))},null,544),[[Ke,i.value,void 0,{number:!0}]])])])):de("",!0),d("tr",null,[d("td",null,[d("label",rj,[U(" Panels per image: "),!g.value||oe(o)?(x(),R("small",lj,[ij,U("(0 for one single image)")])):de("",!0)])]),d("td",null,[Oe(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":K[5]||(K[5]=ie=>r.value=ie),onKeydown:K[6]||(K[6]=ce(()=>{},["stop"])),onBlur:K[7]||(K[7]=ie=>{_(r.value)&&(r.value=0)})},null,544),[[Ke,r.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",aj,[U(" Panels to export: "),!g.value||oe(o)?(x(),R("small",uj,[cj,U("(Leave empty for all)")])):de("",!0)])]),d("td",null,[Oe(d("input",{id:"export_pages","onUpdate:modelValue":K[8]||(K[8]=ie=>l.value=ie),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Ke,l.value]])])]),d("tr",null,[d("td",dj,[B(je,{icon:"photo_camera",class:"w100",onClick:M},{default:X(()=>[U(" Download ")]),_:1})])])])]),_:1}),d("div",fj,[B(je,{icon:"save",onClick:Q},{default:X(()=>[U("Save")]),_:1}),B(je,{class:"bt0",icon:"folder_open",onClick:K[9]||(K[9]=ie=>c.value.click())},{default:X(()=>[U(" Load "),d("input",{type:"file",ref_key:"loadUpload",ref:c,onChange:ye},null,544)]),_:1})])],64))],512))}}),mj=Me(gj,[["__scopeId","data-v-ee0e5abb"]]),qv=t=>(_t("data-v-b41fcf74"),t=t(),wt(),t),bj={id:"poem_text",class:"v-w100"},yj=qv(()=>d("label",{for:"poem_text"},"Text:",-1)),_j=["value"],wj=["value"],Pj={key:1},Cj=qv(()=>d("td",{style:{width:"0"}},"Color:",-1)),xj={class:"v-w100"},kj=Ce({__name:"poem",setup(t){const e=Ne(),n=L(null),o=L(null),{vertical:s}=Lt(n),r=L(!1),l=L("");We(()=>s.value,()=>{o.value.style.height="",o.value.style.width=""});const a=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=S(()=>{const k=a.value.objects[e.state.ui.selection];if(k.type==="poem")return k}),u=k=>Va(e,i,"panels/setPoemProperty",!1,k),c=S(()=>{if(r.value)return{title:"Text",get:()=>p.value,set:k=>{p.value=k},leave:()=>{r.value=!1}}}),f=S(()=>{if(l.value)return{title:"Color",get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.consoleColor;default:throw new Mt.UnreachableCaseError(l.value)}},set:k=>{Z(()=>{const v=a.value.id,h=i.value.id;k!==void 0&&e.commit("panels/setPoemProperty",{key:"consoleColor",panelId:v,id:h,value:k})})},leave:()=>{l.value=""}}}),p=u("text"),g=u("autoWrap"),b=u("font"),_=u("overflow"),w=u("background");return(k,v)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:i.value,title:i.value.subType==="poem"?"Poem":"Console",textHandler:c.value,colorHandler:f.value},{default:X(()=>[d("div",bj,[yj,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":v[0]||(v[0]=h=>_e(p)?p.value=h:null),onKeydown:v[1]||(v[1]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(p)]]),d("button",{class:"w100 bt0",onClick:v[2]||(v[2]=h=>r.value=!0)},"Formatting")]),B(qe,{label:"Auto line wrap?",modelValue:oe(g),"onUpdate:modelValue":v[3]||(v[3]=h=>_e(g)?g.value=h:null)},null,8,["modelValue"]),B(qe,{label:"Allow overflow?",modelValue:oe(_),"onUpdate:modelValue":v[4]||(v[4]=h=>_e(_)?_.value=h:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),i.value.subType==="poem"?(x(),R(ae,{key:0},[Oe(d("select",{"onUpdate:modelValue":v[5]||(v[5]=h=>_e(w)?w.value=h:null),onKeydown:v[6]||(v[6]=ce(()=>{},["stop"]))},[(x(!0),R(ae,null,Ue(oe(Up),(h,m)=>(x(),R("option",{value:m,key:m},$e(h.name),9,_j))),128))],544),[[$t,oe(w)]]),Oe(d("select",{"onUpdate:modelValue":v[7]||(v[7]=h=>_e(b)?b.value=h:null),onKeydown:v[8]||(v[8]=ce(()=>{},["stop"]))},[(x(!0),R(ae,null,Ue(oe(Wp),(h,m)=>(x(),R("option",{value:m,key:m},$e(h.name),9,wj))),128))],544),[[$t,oe(b)]])],64)):(x(),R("table",Pj,[d("tr",null,[Cj,d("td",xj,[d("button",{id:"console_color",class:"w100",style:Qe([{background:i.value.consoleColor},{"min-width":"64px"}]),onClick:v[9]||(v[9]=h=>l.value="base")},null,4)])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}}),Oj=Me(kj,[["__scopeId","data-v-b41fcf74"]]);var Sj=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Nt=t=>(_t("data-v-4455b8f1"),t=t(),wt(),t),$j=Nt(()=>d("h1",null,"Settings",-1)),Ij={class:"modal-scroll-area"},jj=Nt(()=>d("p",null,"Do you want to allow DDDG to save settings on your device?",-1)),Tj=Nt(()=>d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),Aj=Nt(()=>d("p",null,"You can revoke this permission at any time.",-1)),Ej={class:"modal-scroll-area"},Rj=Nt(()=>d("p",null,"Do you want to deny DDDG from saving settings on your device?",-1)),Bj=Nt(()=>d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),Mj=Nt(()=>d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)),Dj={key:0},Lj={key:1},Nj={key:2},Fj={key:3,disabled:""},Vj={class:"v-w100"},Hj=Nt(()=>d("td",null,[d("label",null,"Theme:")],-1)),Uj=Nt(()=>d("option",{value:null},"System",-1)),Wj=Nt(()=>d("option",{value:!1},"Light",-1)),zj=Nt(()=>d("option",{value:!0},"Dark",-1)),Gj=[Uj,Wj,zj],Xj={key:7,class:"downloadTable"},Yj=Nt(()=>d("td",null,[d("label",null,"Download folder:")],-1)),qj=Ce({__name:"settings",setup(t){const e=Ne(),n=L(null),o=pe.updateProgress;Lt(n);function s(){var F;pe.saveSettings({lq:e.state.ui.lqRendering,nsfw:e.state.ui.nsfw,darkMode:(F=e.state.ui.useDarkTheme)!=null?F:void 0,looseTextParsing:pe.state.looseTextParsing,defaultCharacterTalkingZoom:e.state.ui.defaultCharacterTalkingZoom})}const r=S(()=>pe.supports.optionalSaving),l=L(!1),a=L(!1),i=L(!1),u=S({get(){return pe.savingEnabled},set(F){i.value=!0,pe.savingEnabled=F,s()}});function c(F){l.value=!1,F==="Allow"&&(u.value=!0)}function f(F){a.value=!1,F==="Deny"&&(u.value=!1)}We(()=>u.value,()=>i.value=!1);const p=L(!1),g=S(()=>pe.gameMode==="ddlc_plus");function b(F){Fo("changing modes",()=>Sj(this,null,function*(){F==="Enter Classic Mode"?yield pe.setGameMode("ddlc"):F==="Enter Plus mode"?yield pe.setGameMode("ddlc_plus"):p.value=!1}))}const _=S(()=>pe.supports.lq),w=S({get(){return e.state.ui.lqRendering},set(F){Z(()=>{e.commit("ui/setLqRendering",F)}),s()}}),k=S({get(){return!!e.state.ui.nsfw},set(F){Z(()=>{e.commit("ui/setNsfw",F),s()})}}),v=S({get(){return!!e.state.ui.defaultCharacterTalkingZoom},set(F){Z(()=>{e.commit("ui/setDefaultCharacterTalkingZoom",F),s()})}}),h=S({get(){return pe.state.looseTextParsing},set(F){pe.state.looseTextParsing=F,s()}}),m=S({get(){return e.state.ui.useDarkTheme},set(F){Z(()=>{e.commit("ui/setDarkTheme",F),s()})}}),j=S(()=>pe.supports.setDownloadFolder),P=S(()=>pe.state.downloadLocation);function A(){pe.updateDownloadFolder()}function D(){pe.openFolder("downloads")}const M=S(()=>pe.state.hasTemplate);function Y(){pe.saveDefaultTemplate()}function z(){pe.clearDefaultTemplate()}return(F,ne)=>(x(),R("div",{class:"panel",ref_key:"root",ref:n},[$j,(x(),fe(Sf,{to:"#modal-messages"},[l.value?(x(),fe(So,{key:0,options:["Allow","Deny"],onLeave:ne[0]||(ne[0]=le=>c("Deny")),onOption:c,"no-base-size":""},{default:X(()=>[d("div",Ij,[jj,Tj,Aj,d("p",null,[U(" Our usual "),B(Xe,{to:"wiki://Privacy Statement"},{default:X(()=>[U("privacy policy")]),_:1}),U(" still applies. ")])])]),_:1})):de("",!0),a.value?(x(),fe(So,{key:1,options:["Deny","Cancle"],onLeave:ne[1]||(ne[1]=le=>f("Cancel")),onOption:f,"no-base-size":""},{default:X(()=>[d("div",Ej,[Rj,Bj,d("p",null,[U(" Our usual "),B(Xe,{to:"wiki://Privacy Statement"},{default:X(()=>[U("privacy policy")]),_:1}),U(" still applies. ")])])]),_:1})):de("",!0),p.value?(x(),fe(So,{key:2,options:[g.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:ne[2]||(ne[2]=le=>p.value=!1),onOption:b,"no-base-size":""},{default:X(()=>[Mj]),_:1},8,["options"])):de("",!0)])),oe(o)==="done"?(x(),R("p",Dj," Update is successfully downloaded. It will be installed once the application is closed. ")):de("",!0),oe(o)==="wait"?(x(),R("p",Lj,"Checking for updates...")):de("",!0),typeof oe(o)=="number"?(x(),R("p",Nj," Downloading update ("+$e(oe(o))+"%) ",1)):de("",!0),i.value?(x(),R("button",Fj,"Applying...")):!u.value&&r.value?(x(),R("button",{key:4,onClick:ne[3]||(ne[3]=le=>l.value=!0)}," Allow saving options ")):u.value&&r.value?(x(),R("button",{key:5,onClick:ne[4]||(ne[4]=le=>a.value=!0)}," Deny saving options ")):de("",!0),d("button",{onClick:ne[5]||(ne[5]=le=>p.value=!0),class:Le(r.value?"bt0":"")},[g.value?(x(),R(ae,{key:0},[U(" Enter Classic Mode ")],64)):(x(),R(ae,{key:1},[U(" Enter DDLC Plus Mode ")],64))],2),_.value?(x(),fe(qe,{key:6,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:w.value,"onUpdate:modelValue":ne[6]||(ne[6]=le=>w.value=le)},null,8,["modelValue"])):de("",!0),B(qe,{label:"NSFW Mode?",modelValue:k.value,"onUpdate:modelValue":ne[7]||(ne[7]=le=>k.value=le)},null,8,["modelValue"]),B(qe,{label:"Enlarge talking objects? (Default value)",modelValue:v.value,"onUpdate:modelValue":ne[8]||(ne[8]=le=>v.value=le)},null,8,["modelValue"]),B(qe,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:h.value,"onUpdate:modelValue":ne[9]||(ne[9]=le=>h.value=le)},null,8,["modelValue"]),d("table",Vj,[d("tr",null,[Hj,d("td",null,[Oe(d("select",{"onUpdate:modelValue":ne[10]||(ne[10]=le=>m.value=le),class:"v-w100"},Gj,512),[[$t,m.value]])])])]),j.value?(x(),R("table",Xj,[d("tr",null,[Yj,d("td",null,$e(P.value),1),d("td",null,[d("button",{onClick:A},"Set"),d("button",{onClick:D},"Open")])])])):de("",!0),u.value?(x(),R(ae,{key:8},[d("button",{onClick:Y},"Save as template"),M.value?(x(),R("button",{key:0,onClick:z}," Clear template ")):de("",!0)],64)):de("",!0)],512))}}),Kj=Me(qj,[["__scopeId","data-v-4455b8f1"]]);var $d=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Jj={class:"warning"},Zj={style:{"word-wrap":"break-word"}},Qj=Ce({__name:"sprite",setup(t){const e=Ne(),n=L(null),o=L(null);Lt(n);const s=S(()=>{for(const u of l.value.assets){const c=Mn(u,!1);if(console.log(c),c.startsWith("uploads:"))return c.substring(8)}return null}),r=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=S(()=>{const u=r.value.objects[e.state.ui.selection];if(u.type==="sprite")return u});function a(){o.value.click()}function i(){return $d(this,null,function*(){const u=o.value;if(!u.files)return;if(u.files.length!==1){console.error("More than one file uploaded!");return}const c=u.files[0];yield Z(()=>$d(this,null,function*(){const f=URL.createObjectURL(c);yield e.dispatch("uploadUrls/add",{name:s.value,url:f})}))})}return(u,c)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:l.value,title:"Custom Sprite"},{default:X(()=>[s.value?(x(),R(ae,{key:0},[d("p",Jj,[U(" MISSING SPRITE! Click below to re-upload "),d("span",Zj,'"'+$e(s.value)+'"',1),U(". ")]),d("button",{onClick:c[0]||(c[0]=f=>a())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:o,onChange:i},null,544)],64)):de("",!0)]),_:1},8,["object"]))}}),eT=Me(Qj,[["__scopeId","data-v-204ff14d"]]);var Id=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const pt=t=>(_t("data-v-8eebfc80"),t=t(),wt(),t),tT={class:"upper-combos"},nT=pt(()=>d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),oT={colspan:"2"},sT=pt(()=>d("option",{value:"normal"},"Normal",-1)),rT=pt(()=>d("option",{value:"corrupt"},"Corrupt",-1)),lT=pt(()=>d("option",{value:"custom"},"Custom",-1)),iT=pt(()=>d("option",{value:"custom_plus"},"Custom (Plus)",-1)),aT=pt(()=>d("option",{value:"none"},"None",-1)),uT=[sT,rT,lT,iT,aT],cT=pt(()=>d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),dT=pt(()=>d("option",{value:"$null$"},"No-one",-1)),fT=["value"],pT=pt(()=>d("option",{value:"$other$"},"Other",-1)),hT=["disabled"],vT=pt(()=>d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),gT={id:"dialog_text_wrapper",class:"v-w100"},mT=pt(()=>d("label",{for:"dialog_text"},"Dialog:",-1)),bT={key:0},yT=pt(()=>d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),_T=["placeholder"],wT={colspan:"2"},PT={key:0},CT=pt(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),xT={key:1},kT={colspan:"2"},OT=pt(()=>d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),ST=pt(()=>d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),$T=pt(()=>d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),IT=Ce({__name:"textbox",setup(t){const e=Ne(),n=L(null),o=L(null),{vertical:s}=Lt(n),r=L(""),l=L("");We(()=>s.value,()=>{const O=o.value;O!=null&&(O.style.height="",O.style.width="")});const a=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=S(()=>{const O=a.value.objects[e.state.ui.selection];if(O.type==="textBox")return O}),u=O=>Va(e,i,"panels/setTextBoxProperty",!1,O),c=S(()=>{if(r.value)return{title:_.value,get(){return r.value==="name"?i.value.talkingOther:r.value==="body"?m.value:""},set(O){r.value==="name"?g.value=O:r.value==="body"&&(m.value=O)},leave(){r.value=""}}}),f=S(()=>{if(l.value)return{title:w.value,get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.customColor;case"controls":return i.value.customControlsColor;case"namebox":return i.value.customNameboxColor;case"nameboxStroke":return i.value.customNameboxStroke;default:throw new Mt.UnreachableCaseError(l.value)}},set:O=>{Z(()=>{const T=a.value.id,$=i.value.id;let re={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[l.value];O!==void 0&&e.commit("panels/setTextBoxProperty",zv(T,$,re,O))})},leave:()=>{l.value=""}}}),p=S({get(){var O;return(O=i.value.talkingObjId)!=null?O:"$null$"},set(O){Z(()=>{e.commit("panels/setTalkingObject",{id:i.value.id,panelId:i.value.panelId,talkingObjId:O==="$null$"?null:O})})}}),g=Vo(e,i,"panels/setTalkingOther",!1,"talkingOther"),b=S(()=>{const O=a.value,T=[];for(const $ of[...O.order,...O.onTopOrder]){const re=O.objects[$];re.label!==null&&T.push([$,re.label])}return T}),_=S(()=>r.value==="name"?"Name":r.value==="body"?"Dialog":""),w=S(()=>{switch(l.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Mt.UnreachableCaseError(l.value)}}),k=u("autoQuoting"),v=u("autoWrap"),h=u("overflow"),m=u("text"),j=S(()=>P.value.startsWith("custom")),P=Vo(e,i,"panels/setStyle",!0,"style"),A=u("controls"),D=u("skip"),M=u("continue"),Y=u("overrideColor"),z=u("deriveCustomColors"),F=u("customNameboxWidth"),ne=S(()=>ue().TextBox.NameboxWidth);function le(){Z(()=>Id(this,null,function*(){yield e.dispatch("panels/splitTextbox",{id:i.value.id,panelId:i.value.panelId})}))}function q(){Z(()=>Id(this,null,function*(){yield e.dispatch("panels/resetTextboxBounds",{id:i.value.id,panelId:i.value.panelId})}))}function I(){Z(()=>{e.commit("ui/setSelection",p.value)})}return(O,T)=>(x(),fe(Jo,{ref_key:"root",ref:n,object:i.value,title:"Textbox",textHandler:c.value,colorHandler:f.value},{default:X(()=>[d("table",tT,[d("tr",null,[nT,d("td",oT,[Oe(d("select",{id:"text_style","onUpdate:modelValue":T[0]||(T[0]=$=>_e(P)?P.value=$:null),onKeydown:T[1]||(T[1]=ce(()=>{},["stop"]))},uT,544),[[$t,oe(P)]])])]),d("tr",null,[cT,d("td",null,[Oe(d("select",{id:"current_talking","onUpdate:modelValue":T[2]||(T[2]=$=>p.value=$),onKeydown:T[3]||(T[3]=ce(()=>{},["stop"]))},[dT,(x(!0),R(ae,null,Ue(b.value,([$,re])=>(x(),R("option",{key:$,value:$},$e(re),9,fT))),128)),pT],544),[[$t,p.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:I,disabled:p.value==="$null$"||p.value==="$other$"}," > ",8,hT)])]),d("tr",null,[vT,d("td",null,[Oe(d("input",{id:"custom_name","onUpdate:modelValue":T[4]||(T[4]=$=>_e(g)?g.value=$:null),onKeydown:T[5]||(T[5]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(g)]])]),d("td",null,[d("button",{onClick:T[6]||(T[6]=$=>r.value="name")},"...")])])]),B(qe,{label:"Auto quoting?",modelValue:oe(k),"onUpdate:modelValue":T[7]||(T[7]=$=>_e(k)?k.value=$:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),B(qe,{label:"Auto line wrap?",modelValue:oe(v),"onUpdate:modelValue":T[8]||(T[8]=$=>_e(v)?v.value=$:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),B(qe,{label:"Allow overflow?",modelValue:oe(h),"onUpdate:modelValue":T[9]||(T[9]=$=>_e(h)?h.value=$:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",gT,[mT,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":T[10]||(T[10]=$=>_e(m)?m.value=$:null),id:"dialog_text",onKeydown:T[11]||(T[11]=ce(()=>{},["stop"]))},null,544),[[Ke,oe(m)]]),d("button",{class:"w100 bt0",onClick:T[12]||(T[12]=$=>r.value="body")}," Formatting ")])]),options:X(()=>[B(It,{title:"Customization:",class:Le(j.value?"customization-set":"")},{default:X(()=>[B(Rt,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:X(()=>[B(qe,{label:"Controls visible?",modelValue:oe(A),"onUpdate:modelValue":T[13]||(T[13]=$=>_e(A)?A.value=$:null)},null,8,["modelValue"]),B(qe,{label:"Able to skip?",modelValue:oe(D),"onUpdate:modelValue":T[14]||(T[14]=$=>_e(D)?D.value=$:null)},null,8,["modelValue"]),B(qe,{label:"Continue arrow?",modelValue:oe(M),"onUpdate:modelValue":T[15]||(T[15]=$=>_e(M)?M.value=$:null)},null,8,["modelValue"]),j.value?(x(),R("table",bT,[d("tr",null,[yT,d("td",null,[Oe(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:ne.value+"","onUpdate:modelValue":T[16]||(T[16]=$=>_e(F)?F.value=$:null),onKeydown:T[17]||(T[17]=ce(()=>{},["stop"]))},null,40,_T),[[Ke,oe(F),void 0,{number:!0}]])])]),d("tr",null,[d("td",wT,[B(qe,{modelValue:oe(Y),"onUpdate:modelValue":T[18]||(T[18]=$=>_e(Y)?Y.value=$:null),label:"Override color"},null,8,["modelValue"])])]),oe(Y)?(x(),R("tr",PT,[CT,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Qe({background:i.value.customColor}),onClick:T[19]||(T[19]=$=>l.value="base")},null,4)])])):de("",!0),oe(Y)?(x(),R("tr",xT,[d("td",kT,[B(qe,{id:"derive_custom_colors",modelValue:oe(z),"onUpdate:modelValue":T[20]||(T[20]=$=>_e(z)?z.value=$:null),label:"Derive other colors"},null,8,["modelValue"])])])):de("",!0),oe(Y)&&!oe(z)?(x(),R(ae,{key:2},[d("tr",null,[OT,d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:Qe({background:i.value.customControlsColor}),onClick:T[21]||(T[21]=$=>l.value="controls")},null,4)])]),d("tr",null,[ST,d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:Qe({background:i.value.customNameboxColor}),onClick:T[22]||(T[22]=$=>l.value="namebox")},null,4)])]),d("tr",null,[$T,d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:Qe({background:i.value.customNameboxStroke}),onClick:T[23]||(T[23]=$=>l.value="nameboxStroke")},null,4)])])],64)):de("",!0)])):de("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:q},"Reset position"),d("button",{class:"bt0",onClick:le},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}}),jT=Me(IT,[["__scopeId","data-v-8eebfc80"]]),TT={id:"toolbar"},AT={id:"toolbar-end"},ET=Ce({__name:"toolbox",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(t,{emit:e}){const n=Ne(),o=e,s=L(null),r=L("add"),l=S(()=>n.state.panels.panels[n.state.panels.currentPanel]),a=S(()=>n.state.ui.vertical),i=S(()=>n.state.ui.selection),u=S(()=>{if(r.value==="selection")if(i.value===null)r.value="add";else return l.value.objects[i.value].type;return r.value}),c=S(()=>n.state.ui.lastDownload!==null);function f(g){g===r.value&&(g="add"),r.value=g,i.value!==null&&n.commit("ui/setSelection",null)}function p(){s.value instanceof HTMLElement&&(s.value.scrollTop=0,s.value.scrollLeft=0)}return We(()=>i.value,g=>{if(g!=null){r.value="selection";return}r.value==="selection"&&(r.value="add")}),pe.onPanelChange(g=>{r.value=g}),(g,b)=>(x(),R("div",{id:"panels",class:Le({vertical:a.value}),onScroll:p,ref_key:"panels",ref:s},[d("div",TT,[B(je,{icon:"add_box","icon-pos":"top",class:Le({active:u.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:b[0]||(b[0]=_=>f("add"))},null,8,["class"]),B(je,{icon:"panorama","icon-pos":"top",class:Le({active:u.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:b[1]||(b[1]=_=>f("backgrounds"))},null,8,["class"]),B(je,{icon:"view_module","icon-pos":"top",class:Le({active:u.value==="panels"}),title:"Panels",shortcut:"d",onClick:b[2]||(b[2]=_=>f("panels"))},null,8,["class"]),B(je,{icon:"settings_applications","icon-pos":"top",class:Le({active:u.value==="settings"}),title:"Settings",shortcut:"f",onClick:b[3]||(b[3]=_=>f("settings"))},null,8,["class"])]),u.value==="settings"?(x(),fe(Kj,{key:0})):u.value==="backgrounds"?(x(),fe(L$,{key:1,onShowDialog:b[4]||(b[4]=_=>o("show-dialog",_))})):u.value==="help_credits"?(x(),fe(FI,{key:2})):u.value==="character"?(x(),fe(xI,{key:3,onShowDialog:b[5]||(b[5]=_=>o("show-dialog",_)),onShowExpressionDialog:b[6]||(b[6]=_=>o("show-expression-dialog",_))})):u.value==="sprite"?(x(),fe(eT,{key:4})):u.value==="textBox"?(x(),fe(jT,{key:5})):u.value==="choice"?(x(),fe(II,{key:6})):u.value==="panels"?(x(),fe(mj,{key:7})):u.value==="notification"?(x(),fe(zI,{key:8})):u.value==="poem"?(x(),fe(Oj,{key:9})):(x(),fe(TO,{key:10,onShowDialog:b[7]||(b[7]=_=>o("show-dialog",_))})),d("div",AT,[B(je,{icon:"help","icon-pos":"top",class:Le({active:u.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:b[8]||(b[8]=_=>f("help_credits"))},null,8,["class"]),B(je,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:b[9]||(b[9]=_=>o("show-dialog"))}),B(je,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:b[10]||(b[10]=_=>o("show-prev-render")),disabled:!c.value},null,8,["disabled"]),B(je,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:b[11]||(b[11]=_=>o("download"))})])],34))}});var hr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const RT={id:"app"},BT={class:"hidden-selectors"},MT=["data-obj-id","onKeydown"],DT=d("div",{id:"modal-messages"},null,-1),LT=20,jd=16/9,NT=50,FT=Ce({__name:"app",setup(t){const e=ou(()=>Fu(()=>import("./single-box-CH9YQoN4.js"),__vite__mapDeps([0,1]),import.meta.url)),n=ou(()=>Fu(()=>import("./index-DGcPycZX.js"),__vite__mapDeps([2,3]),import.meta.url)),o=Ne(),s=L(!0),r=L(null),l=S(()=>{const $=o.state.panels,re=$.panels[$.currentPanel];return re==null?[]:[...re.order,...re.onTopOrder]});function a(){const $=o.state.ui.lastDownload;$!=null&&r.value.blendOver($)}function i($){$.preventDefault()}mt(()=>{document.body.addEventListener("drop",i,!0),document.body.addEventListener("dragover",i,!0)}),Wt(()=>{document.body.removeEventListener("drop",i,!0),document.body.removeEventListener("dragover",i,!0)});const u=L(0),c=L(0),f=L(192);function p($,re){let me=$/jd,xe=re*jd;return me>re?me=re:xe=$,[xe,me]}function g($,re){const me=p($,re-f.value),xe=p($-f.value,re);return me[0]*me[1]>xe[0]*xe[1]?[me[0],me[1],!1]:[xe[0],xe[1],!0]}function b(){const[$,re,me]=g(document.documentElement.clientWidth,document.documentElement.clientHeight);u.value=$,c.value=re,o.state.ui.vertical!==me&&o.commit("ui/setVertical",me)}b(),mt(()=>{window.addEventListener("resize",b)}),Wt(()=>{window.removeEventListener("resize",b)});const _=L(!1),w=S(()=>o.state.ui.useDarkTheme),k=S(()=>{var $;return($=w.value)!=null?$:_.value});if(We(()=>k.value,$=>{document.body.classList.toggle("dark-theme",$)},{immediate:!0}),window.matchMedia!=null){const $=window.matchMedia("(prefers-color-scheme: dark)");_.value=$.matches;const re=me=>_.value=me.matches;$.addEventListener?$.addEventListener("change",re):$.addListener(re)}const v=L(!1),h=L(""),m=L(void 0);function j($){v.value=!0,h.value=$.character,m.value=$.headGroup}const P=L(null),A=L(!1);function D($){if(A.value=!0,$==null)return;const re=()=>{P.value?P.value.setSearch($):setTimeout(re,NT)};Bn(re)}const M=S(()=>o.state.ui.nsfw);We(()=>M.value,$=>hr(this,null,function*(){$?yield o.dispatch("content/loadContentPacks",Lb):yield o.dispatch("removePacks",{packs:Db})}));let Y=null;function z(){Y==null&&(Y=requestAnimationFrame(()=>{Y=null,Te.fire(new nl)}))}function F($){if($.target instanceof HTMLInputElement||$.target instanceof HTMLTextAreaElement){console.log("skip keydown on potential target");return}Z(()=>hr(this,null,function*(){const re=$.ctrlKey&&!$.altKey&&!$.metaKey&&!$.shiftKey,me=!$.ctrlKey&&!$.altKey&&!$.metaKey&&!$.shiftKey;if(re&&$.key==="v"){yield o.dispatch("panels/pasteObjectFromClipboard",{}),$.preventDefault();return}if(me&&$.key==="Escape"){if(o.state.ui.selection===null)return;o.commit("ui/setSelection",null);return}const Ee=o.state.panels.panels[o.state.panels.currentPanel].objects[o.state.ui.selection];if(Ee!=null){if(re){if($.key==="c"||$.key==="x"){yield o.dispatch("panels/copyObjectToClipboard",{id:Ee.id,panelId:Ee.panelId}),$.key==="x"&&(yield o.dispatch("panels/removeObject",{id:Ee.id,panelId:Ee.panelId})),$.preventDefault();return}}else if(me){if($.key==="Delete"){yield o.dispatch("panels/removeObject",{id:Ee.id,panelId:Ee.panelId});return}if($.key==="/"||$.key==="*"){let Se=$.key==="/"?-10:10;$.shiftKey&&(Se/=Math.abs(Se)),o.commit("panels/setRotation",{id:Ee.id,panelId:Ee.panelId,rotation:Ee.rotation+Se}),$.stopPropagation(),$.preventDefault();return}if(Ee.type==="character"){const Se=Ee;if(!Se.freeMove){if($.key==="ArrowLeft"){yield o.dispatch("panels/shiftCharacterSlot",{id:Se.id,panelId:Se.panelId,delta:-1});return}if($.key==="ArrowRight"){yield o.dispatch("panels/shiftCharacterSlot",{id:Se.id,panelId:Se.panelId,delta:1});return}}}let{x:Ct,y:Q}=Ee;const ye=$.shiftKey?1:LT;switch($.key){case"ArrowLeft":Ct-=ye;break;case"ArrowRight":Ct+=ye;break;case"ArrowUp":Q-=ye;break;case"ArrowDown":Q+=ye;break;default:return}yield o.dispatch("panels/setPosition",{id:Ee.id,panelId:Ee.panelId,x:Ct,y:Q})}}}))}mt(()=>{window.addEventListener("keydown",F)}),Wt(()=>{window.removeEventListener("keydown",F)});let ne=null,le=!1;function q($){$.ctrlKey?!le&&ne===null&&(ne=setTimeout(I)):O()}function I(){document.body.classList.add("ctrl-key"),le=!0}function O(){ne!==null&&(clearTimeout(ne),ne=null),document.body.classList.remove("ctrl-key"),le=!1}mt(()=>{for(const $ of["keydown","keyup","mousemove"])window.addEventListener($,q,!0);window.addEventListener("blur",O)}),Wt(()=>{for(const $ of["keydown","keyup","mousemove"])window.removeEventListener($,q,!0);window.removeEventListener("blur",O)});function T($){Z(()=>{o.state.ui.selection!==$&&o.commit("ui/setSelection",$)})}return We(()=>o.state.ui.selection,$=>{var re,me;((re=document.activeElement)==null?void 0:re.getAttribute("data-obj-id"))!==""+$&&((me=document.querySelector(`*[data-obj-id='${$}']`))==null||me.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),Ro.setStore(o),window.store=o,window.env=pe,mt(()=>hr(this,null,function*(){yield pe.loadGameMode(),pe.connectToStore(o),s.value=!1;const $=yield pe.loadSettings();yield Z(()=>hr(this,null,function*(){var re,me,xe,Ee;if(pe.state.looseTextParsing=$.looseTextParsing||!0,o.commit("ui/setLqRendering",(re=$.lq)!=null?re:!1),o.commit("ui/setDarkTheme",(me=$.darkMode)!=null?me:null),o.commit("ui/setDefaultCharacterTalkingZoom",(xe=$.defaultCharacterTalkingZoom)!=null?xe:!0),yield o.dispatch("content/loadContentPacks",[`${vt}buildin.base.backgrounds.json`,`${vt}buildin.base.monika.json`,`${vt}buildin.base.sayori.json`,`${vt}buildin.base.natsuki.json`,`${vt}buildin.base.yuri.json`,`${vt}buildin.extra.mc.json`,`${vt}buildin.extra.concept_mc_v2.json`,`${vt}buildin.extra.mc_chad.json`,`${vt}buildin.extra.femc.json`,`${vt}buildin.extra.concept_femc.json`,`${vt}buildin.extra.amy.json`]),!(yield pe.loadDefaultTemplate())){yield pe.loadContentPacks();const Ct=yield o.dispatch("panels/createPanel");Object.keys(o.state.panels.panels[Ct].objects).length===0&&(yield o.dispatch("panels/createTextBox",{panelId:Ct,text:`Hi! Click here to edit this textbox! ${o.state.ui.vertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`})),o.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:o.state.panels.currentPanel}),o.commit("ui/setNsfw",(Ee=$.nsfw)!=null?Ee:!1)}}))})),($,re)=>(x(),R(ae,null,[d("div",RT,[d("div",BT,[(x(!0),R(ae,null,Ue(l.value,me=>(x(),R("div",{key:me,tabindex:"0","data-obj-id":me,onFocus:re[0]||(re[0]=xe=>z()),onBlur:re[1]||(re[1]=xe=>z()),onKeydown:[lt(ce(xe=>T(me),["prevent"]),["enter"]),lt(ce(xe=>T(me),["prevent"]),["space"])]},null,40,MT))),128))]),B(nO,{ref_key:"renderer",ref:r,canvasWidth:u.value,canvasHeight:c.value,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),B(Bk),B(ET,{onShowPrevRender:a,onDownload:re[2]||(re[2]=me=>r.value.download()),onShowDialog:D,onShowExpressionDialog:j}),(x(),fe(xm,null,[A.value?(x(),fe(So,{key:0,ref:"dialog",onLeave:re[4]||(re[4]=me=>A.value=!1)},{default:X(()=>[B(oe(e),{ref_key:"packDialog",ref:P,onLeave:re[3]||(re[3]=me=>A.value=!1)},null,512)]),_:1},512)):de("",!0)],1024)),v.value?(x(),fe(So,{key:0,ref:"dialog",onLeave:re[6]||(re[6]=me=>v.value=!1)},{default:X(()=>[B(oe(n),{character:h.value,initHeadGroup:m.value,onLeave:re[5]||(re[5]=me=>v.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):de("",!0)]),DT],64))}});Sb(FT).use($k).mount("#main_wrapper");export{mt as A,Wt as B,Oe as C,Ke as D,Bm as E,ae as F,Cf as G,Fo as H,Te as I,Fn as J,Qt as K,Mn as L,Yv as M,Xv as N,$t as O,It as P,nC as Q,Ro as R,wh as S,HT as T,Pr as U,Yf as V,Nv as W,an as X,Eo as Y,Z,Me as _,R as a,d as b,S as c,Ce as d,Ue as e,de as f,B as g,X as h,Bn as i,pe as j,U as k,oe as l,Xe as m,Le as n,x as o,fe as p,qe as q,L as r,Qe as s,$e as t,Ne as u,ce as v,We as w,_t as x,wt as y,Gk as z};
