var Yt=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();function pl(e,t){const o=Object.create(null),n=e.split(",");for(let s=0;s<n.length;s++)o[n[s]]=!0;return t?s=>!!o[s.toLowerCase()]:s=>!!o[s]}const Qp="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",eh=pl(Qp);function cu(e){return!!e||e===""}function Re(e){if(z(e)){const t={};for(let o=0;o<e.length;o++){const n=e[o],s=Ae(n)?nh(n):Re(n);if(s)for(const r in s)t[r]=s[r]}return t}else{if(Ae(e))return e;if(Oe(e))return e}}const th=/;(?![^(]*\))/g,oh=/:(.+)/;function nh(e){const t={};return e.split(th).forEach(o=>{if(o){const n=o.split(oh);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function le(e){let t="";if(Ae(e))t=e;else if(z(e))for(let o=0;o<e.length;o++){const n=le(e[o]);n&&(t+=n+" ")}else if(Oe(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}function sh(e,t){if(e.length!==t.length)return!1;let o=!0;for(let n=0;o&&n<e.length;n++)o=is(e[n],t[n]);return o}function is(e,t){if(e===t)return!0;let o=Ea(e),n=Ea(t);if(o||n)return o&&n?e.getTime()===t.getTime():!1;if(o=z(e),n=z(t),o||n)return o&&n?sh(e,t):!1;if(o=Oe(e),n=Oe(t),o||n){if(!o||!n)return!1;const s=Object.keys(e).length,r=Object.keys(t).length;if(s!==r)return!1;for(const i in e){const a=e.hasOwnProperty(i),l=t.hasOwnProperty(i);if(a&&!l||!a&&l||!is(e[i],t[i]))return!1}}return String(e)===String(t)}function hl(e,t){return e.findIndex(o=>is(o,t))}const pe=e=>e==null?"":z(e)||Oe(e)&&(e.toString===pu||!Q(e.toString))?JSON.stringify(e,uu,2):String(e),uu=(e,t)=>t&&t.__v_isRef?uu(e,t.value):tn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[n,s])=>(o[`${n} =>`]=s,o),{})}:bn(t)?{[`Set(${t.size})`]:[...t.values()]}:Oe(t)&&!z(t)&&!hu(t)?String(t):t,me={},en=[],bt=()=>{},rh=()=>!1,ih=/^on[^a-z]/,ur=e=>ih.test(e),gl=e=>e.startsWith("onUpdate:"),He=Object.assign,ml=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},lh=Object.prototype.hasOwnProperty,re=(e,t)=>lh.call(e,t),z=Array.isArray,tn=e=>fr(e)==="[object Map]",bn=e=>fr(e)==="[object Set]",Ea=e=>e instanceof Date,Q=e=>typeof e=="function",Ae=e=>typeof e=="string",bl=e=>typeof e=="symbol",Oe=e=>e!==null&&typeof e=="object",fu=e=>Oe(e)&&Q(e.then)&&Q(e.catch),pu=Object.prototype.toString,fr=e=>pu.call(e),ah=e=>fr(e).slice(8,-1),hu=e=>fr(e)==="[object Object]",vl=e=>Ae(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Rs=pl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),pr=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},dh=/-(\w)/g,Tt=pr(e=>e.replace(dh,(t,o)=>o?o.toUpperCase():"")),ch=/\B([A-Z])/g,Do=pr(e=>e.replace(ch,"-$1").toLowerCase()),hr=pr(e=>e.charAt(0).toUpperCase()+e.slice(1)),Wr=pr(e=>e?`on${hr(e)}`:""),Kn=(e,t)=>!Object.is(e,t),on=(e,t)=>{for(let o=0;o<e.length;o++)e[o](t)},zs=(e,t,o)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:o})},Yn=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ba;const uh=()=>Ba||(Ba=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let $o;const ws=[];class fh{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&$o&&(this.parent=$o,this.index=($o.scopes||($o.scopes=[])).push(this)-1)}run(t){if(this.active)try{return this.on(),t()}finally{this.off()}}on(){this.active&&(ws.push(this),$o=this)}off(){this.active&&(ws.pop(),$o=ws[ws.length-1])}stop(t){if(this.active){if(this.effects.forEach(o=>o.stop()),this.cleanups.forEach(o=>o()),this.scopes&&this.scopes.forEach(o=>o.stop(!0)),this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.active=!1}}}function ph(e,t){t=t||$o,t&&t.active&&t.effects.push(e)}const yl=e=>{const t=new Set(e);return t.w=0,t.n=0,t},gu=e=>(e.w&po)>0,mu=e=>(e.n&po)>0,hh=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=po},gh=e=>{const{deps:t}=e;if(t.length){let o=0;for(let n=0;n<t.length;n++){const s=t[n];gu(s)&&!mu(s)?s.delete(e):t[o++]=s,s.w&=~po,s.n&=~po}t.length=o}},wi=new WeakMap;let Hn=0,po=1;const $i=30,In=[];let Oo;const xo=Symbol(""),Ci=Symbol("");class _l{constructor(t,o=null,n){this.fn=t,this.scheduler=o,this.active=!0,this.deps=[],ph(this,n)}run(){if(!this.active)return this.fn();if(!In.includes(this))try{return In.push(Oo=this),mh(),po=1<<++Hn,Hn<=$i?hh(this):Aa(this),this.fn()}finally{Hn<=$i&&gh(this),po=1<<--Hn,Ro(),In.pop();const t=In.length;Oo=t>0?In[t-1]:void 0}}stop(){this.active&&(Aa(this),this.onStop&&this.onStop(),this.active=!1)}}function Aa(e){const{deps:t}=e;if(t.length){for(let o=0;o<t.length;o++)t[o].delete(e);t.length=0}}let ln=!0;const wl=[];function vn(){wl.push(ln),ln=!1}function mh(){wl.push(ln),ln=!0}function Ro(){const e=wl.pop();ln=e===void 0?!0:e}function nt(e,t,o){if(!bu())return;let n=wi.get(e);n||wi.set(e,n=new Map);let s=n.get(o);s||n.set(o,s=yl()),vu(s)}function bu(){return ln&&Oo!==void 0}function vu(e,t){let o=!1;Hn<=$i?mu(e)||(e.n|=po,o=!gu(e)):o=!e.has(Oo),o&&(e.add(Oo),Oo.deps.push(e))}function zt(e,t,o,n,s,r){const i=wi.get(e);if(!i)return;let a=[];if(t==="clear")a=[...i.values()];else if(o==="length"&&z(e))i.forEach((l,d)=>{(d==="length"||d>=n)&&a.push(l)});else switch(o!==void 0&&a.push(i.get(o)),t){case"add":z(e)?vl(o)&&a.push(i.get("length")):(a.push(i.get(xo)),tn(e)&&a.push(i.get(Ci)));break;case"delete":z(e)||(a.push(i.get(xo)),tn(e)&&a.push(i.get(Ci)));break;case"set":tn(e)&&a.push(i.get(xo));break}if(a.length===1)a[0]&&Pi(a[0]);else{const l=[];for(const d of a)d&&l.push(...d);Pi(yl(l))}}function Pi(e,t){for(const o of z(e)?e:[...e])(o!==Oo||o.allowRecurse)&&(o.scheduler?o.scheduler():o.run())}const bh=pl("__proto__,__v_isRef,__isVue"),yu=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(bl)),vh=$l(),yh=$l(!1,!0),_h=$l(!0),Da=wh();function wh(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...o){const n=de(this);for(let r=0,i=this.length;r<i;r++)nt(n,"get",r+"");const s=n[t](...o);return s===-1||s===!1?n[t](...o.map(de)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...o){vn();const n=de(this)[t].apply(this,o);return Ro(),n}}),e}function $l(e=!1,t=!1){return function(n,s,r){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_raw"&&r===(e?t?Hh:Pu:t?Cu:$u).get(n))return n;const i=z(n);if(!e&&i&&re(Da,s))return Reflect.get(Da,s,r);const a=Reflect.get(n,s,r);return(bl(s)?yu.has(s):bh(s))||(e||nt(n,"get",s),t)?a:Ge(a)?!i||!vl(s)?a.value:a:Oe(a)?e?ku(a):Ut(a):a}}const $h=_u(),Ch=_u(!0);function _u(e=!1){return function(o,n,s,r){let i=o[n];if(!e&&!Sl(s)&&(s=de(s),i=de(i),!z(o)&&Ge(i)&&!Ge(s)))return i.value=s,!0;const a=z(o)&&vl(n)?Number(n)<o.length:re(o,n),l=Reflect.set(o,n,s,r);return o===de(r)&&(a?Kn(s,i)&&zt(o,"set",n,s):zt(o,"add",n,s)),l}}function Ph(e,t){const o=re(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&o&&zt(e,"delete",t,void 0),n}function kh(e,t){const o=Reflect.has(e,t);return(!bl(t)||!yu.has(t))&&nt(e,"has",t),o}function Sh(e){return nt(e,"iterate",z(e)?"length":xo),Reflect.ownKeys(e)}const wu={get:vh,set:$h,deleteProperty:Ph,has:kh,ownKeys:Sh},Oh={get:_h,set(e,t){return!0},deleteProperty(e,t){return!0}},xh=He({},wu,{get:yh,set:Ch}),Cl=e=>e,gr=e=>Reflect.getPrototypeOf(e);function $s(e,t,o=!1,n=!1){e=e.__v_raw;const s=de(e),r=de(t);t!==r&&!o&&nt(s,"get",t),!o&&nt(s,"get",r);const{has:i}=gr(s),a=n?Cl:o?Ol:Jn;if(i.call(s,t))return a(e.get(t));if(i.call(s,r))return a(e.get(r));e!==s&&e.get(t)}function Cs(e,t=!1){const o=this.__v_raw,n=de(o),s=de(e);return e!==s&&!t&&nt(n,"has",e),!t&&nt(n,"has",s),e===s?o.has(e):o.has(e)||o.has(s)}function Ps(e,t=!1){return e=e.__v_raw,!t&&nt(de(e),"iterate",xo),Reflect.get(e,"size",e)}function Ra(e){e=de(e);const t=de(this);return gr(t).has.call(t,e)||(t.add(e),zt(t,"add",e,e)),this}function Ha(e,t){t=de(t);const o=de(this),{has:n,get:s}=gr(o);let r=n.call(o,e);r||(e=de(e),r=n.call(o,e));const i=s.call(o,e);return o.set(e,t),r?Kn(t,i)&&zt(o,"set",e,t):zt(o,"add",e,t),this}function Ma(e){const t=de(this),{has:o,get:n}=gr(t);let s=o.call(t,e);s||(e=de(e),s=o.call(t,e)),n&&n.call(t,e);const r=t.delete(e);return s&&zt(t,"delete",e,void 0),r}function Fa(){const e=de(this),t=e.size!==0,o=e.clear();return t&&zt(e,"clear",void 0,void 0),o}function ks(e,t){return function(n,s){const r=this,i=r.__v_raw,a=de(i),l=t?Cl:e?Ol:Jn;return!e&&nt(a,"iterate",xo),i.forEach((d,c)=>n.call(s,l(d),l(c),r))}}function Ss(e,t,o){return function(...n){const s=this.__v_raw,r=de(s),i=tn(r),a=e==="entries"||e===Symbol.iterator&&i,l=e==="keys"&&i,d=s[e](...n),c=o?Cl:t?Ol:Jn;return!t&&nt(r,"iterate",l?Ci:xo),{next(){const{value:f,done:p}=d.next();return p?{value:f,done:p}:{value:a?[c(f[0]),c(f[1])]:c(f),done:p}},[Symbol.iterator](){return this}}}}function Jt(e){return function(...t){return e==="delete"?!1:this}}function jh(){const e={get(r){return $s(this,r)},get size(){return Ps(this)},has:Cs,add:Ra,set:Ha,delete:Ma,clear:Fa,forEach:ks(!1,!1)},t={get(r){return $s(this,r,!1,!0)},get size(){return Ps(this)},has:Cs,add:Ra,set:Ha,delete:Ma,clear:Fa,forEach:ks(!1,!0)},o={get(r){return $s(this,r,!0)},get size(){return Ps(this,!0)},has(r){return Cs.call(this,r,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:ks(!0,!1)},n={get(r){return $s(this,r,!0,!0)},get size(){return Ps(this,!0)},has(r){return Cs.call(this,r,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:ks(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=Ss(r,!1,!1),o[r]=Ss(r,!0,!1),t[r]=Ss(r,!1,!0),n[r]=Ss(r,!0,!0)}),[e,o,t,n]}const[Ih,Th,Eh,Bh]=jh();function Pl(e,t){const o=t?e?Bh:Eh:e?Th:Ih;return(n,s,r)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(re(o,s)&&s in n?o:n,s,r)}const Ah={get:Pl(!1,!1)},Dh={get:Pl(!1,!0)},Rh={get:Pl(!0,!1)},$u=new WeakMap,Cu=new WeakMap,Pu=new WeakMap,Hh=new WeakMap;function Mh(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fh(e){return e.__v_skip||!Object.isExtensible(e)?0:Mh(ah(e))}function Ut(e){return e&&e.__v_isReadonly?e:kl(e,!1,wu,Ah,$u)}function Nh(e){return kl(e,!1,xh,Dh,Cu)}function ku(e){return kl(e,!0,Oh,Rh,Pu)}function kl(e,t,o,n,s){if(!Oe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=s.get(e);if(r)return r;const i=Fh(e);if(i===0)return e;const a=new Proxy(e,i===2?n:o);return s.set(e,a),a}function nn(e){return Sl(e)?nn(e.__v_raw):!!(e&&e.__v_isReactive)}function Sl(e){return!!(e&&e.__v_isReadonly)}function Su(e){return nn(e)||Sl(e)}function de(e){const t=e&&e.__v_raw;return t?de(t):e}function mr(e){return zs(e,"__v_skip",!0),e}const Jn=e=>Oe(e)?Ut(e):e,Ol=e=>Oe(e)?ku(e):e;function Ou(e){bu()&&(e=de(e),e.dep||(e.dep=yl()),vu(e.dep))}function xu(e,t){e=de(e),e.dep&&Pi(e.dep)}function Ge(e){return Boolean(e&&e.__v_isRef===!0)}function sn(e){return Lh(e,!1)}function Lh(e,t){return Ge(e)?e:new Vh(e,t)}class Vh{constructor(t,o){this._shallow=o,this.dep=void 0,this.__v_isRef=!0,this._rawValue=o?t:de(t),this._value=o?t:Jn(t)}get value(){return Ou(this),this._value}set value(t){t=this._shallow?t:de(t),Kn(t,this._rawValue)&&(this._rawValue=t,this._value=this._shallow?t:Jn(t),xu(this))}}function Wh(e){return Ge(e)?e.value:e}const zh={get:(e,t,o)=>Wh(Reflect.get(e,t,o)),set:(e,t,o,n)=>{const s=e[t];return Ge(s)&&!Ge(o)?(s.value=o,!0):Reflect.set(e,t,o,n)}};function ju(e){return nn(e)?e:new Proxy(e,zh)}class Uh{constructor(t,o,n){this._setter=o,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new _l(t,()=>{this._dirty||(this._dirty=!0,xu(this))}),this.__v_isReadonly=n}get value(){const t=de(this);return Ou(t),t._dirty&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function ki(e,t){let o,n;const s=Q(e);return s?(o=e,n=bt):(o=e.get,n=e.set),new Uh(o,n,s||!n)}Promise.resolve();function Gh(e,t,...o){const n=e.vnode.props||me;let s=o;const r=t.startsWith("update:"),i=r&&t.slice(7);if(i&&i in n){const c=`${i==="modelValue"?"model":i}Modifiers`,{number:f,trim:p}=n[c]||me;p?s=o.map(b=>b.trim()):f&&(s=o.map(Yn))}let a,l=n[a=Wr(t)]||n[a=Wr(Tt(t))];!l&&r&&(l=n[a=Wr(Do(t))]),l&&ct(l,e,6,s);const d=n[a+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,ct(d,e,6,s)}}function Iu(e,t,o=!1){const n=t.emitsCache,s=n.get(e);if(s!==void 0)return s;const r=e.emits;let i={},a=!1;if(!Q(e)){const l=d=>{const c=Iu(d,t,!0);c&&(a=!0,He(i,c))};!o&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!r&&!a?(n.set(e,null),null):(z(r)?r.forEach(l=>i[l]=null):He(i,r),n.set(e,i),i)}function xl(e,t){return!e||!ur(t)?!1:(t=t.slice(2).replace(/Once$/,""),re(e,t[0].toLowerCase()+t.slice(1))||re(e,Do(t))||re(e,t))}let ot=null,br=null;function Us(e){const t=ot;return ot=e,br=e&&e.type.__scopeId||null,t}function Ne(e){br=e}function Le(){br=null}function T(e,t=ot,o){if(!t||e._n)return e;const n=(...s)=>{n._d&&Ja(-1);const r=Us(t),i=e(...s);return Us(r),n._d&&Ja(1),i};return n._n=!0,n._c=!0,n._d=!0,n}function zr(e){const{type:t,vnode:o,proxy:n,withProxy:s,props:r,propsOptions:[i],slots:a,attrs:l,emit:d,render:c,renderCache:f,data:p,setupState:b,ctx:v,inheritAttrs:C}=e;let B,D;const $=Us(e);try{if(o.shapeFlag&4){const j=s||n;B=Ot(c.call(j,j,f,r,b,p,v)),D=l}else{const j=t;B=Ot(j.length>1?j(r,{attrs:l,slots:a,emit:d}):j(r,null)),D=t.props?l:qh(l)}}catch(j){Wn.length=0,as(j,e,1),B=w(vt)}let H=B;if(D&&C!==!1){const j=Object.keys(D),{shapeFlag:J}=H;j.length&&J&7&&(i&&j.some(gl)&&(D=Xh(D,i)),H=Eo(H,D))}return o.dirs&&(H.dirs=H.dirs?H.dirs.concat(o.dirs):o.dirs),o.transition&&(H.transition=o.transition),B=H,Us($),B}const qh=e=>{let t;for(const o in e)(o==="class"||o==="style"||ur(o))&&((t||(t={}))[o]=e[o]);return t},Xh=(e,t)=>{const o={};for(const n in e)(!gl(n)||!(n.slice(9)in t))&&(o[n]=e[n]);return o};function Kh(e,t,o){const{props:n,children:s,component:r}=e,{props:i,children:a,patchFlag:l}=t,d=r.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&l>=0){if(l&1024)return!0;if(l&16)return n?Na(n,i,d):!!i;if(l&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const p=c[f];if(i[p]!==n[p]&&!xl(d,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===i?!1:n?i?Na(n,i,d):!0:!!i;return!1}function Na(e,t,o){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(t[r]!==e[r]&&!xl(o,r))return!0}return!1}function Yh({vnode:e,parent:t},o){for(;t&&t.subTree===e;)(e=t.vnode).el=o,t=t.parent}const Jh=e=>e.__isSuspense;function Zh(e,t){t&&t.pendingBranch?z(e)?t.effects.push(...e):t.effects.push(e):Zg(e)}function Qh(e,t){if(Be){let o=Be.provides;const n=Be.parent&&Be.parent.provides;n===o&&(o=Be.provides=Object.create(n)),o[e]=t}}function Ur(e,t,o=!1){const n=Be||ot;if(n){const s=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return o&&Q(t)?t.call(n.proxy):t}}function Tu(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Il(()=>{e.isMounted=!0}),El(()=>{e.isUnmounting=!0}),e}const st=[Function,Array],eg={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:st,onEnter:st,onAfterEnter:st,onEnterCancelled:st,onBeforeLeave:st,onLeave:st,onAfterLeave:st,onLeaveCancelled:st,onBeforeAppear:st,onAppear:st,onAfterAppear:st,onAppearCancelled:st},setup(e,{slots:t}){const o=Hl(),n=Tu();let s;return()=>{const r=t.default&&jl(t.default(),!0);if(!r||!r.length)return;const i=de(e),{mode:a}=i,l=r[0];if(n.isLeaving)return Gr(l);const d=La(l);if(!d)return Gr(l);const c=Zn(d,i,n,o);an(d,c);const f=o.subTree,p=f&&La(f);let b=!1;const{getTransitionKey:v}=d.type;if(v){const C=v();s===void 0?s=C:C!==s&&(s=C,b=!0)}if(p&&p.type!==vt&&(!ko(d,p)||b)){const C=Zn(p,i,n,o);if(an(p,C),a==="out-in")return n.isLeaving=!0,C.afterLeave=()=>{n.isLeaving=!1,o.update()},Gr(l);a==="in-out"&&d.type!==vt&&(C.delayLeave=(B,D,$)=>{const H=Eu(n,p);H[String(p.key)]=p,B._leaveCb=()=>{D(),B._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=$})}return l}}},tg=eg;function Eu(e,t){const{leavingVNodes:o}=e;let n=o.get(t.type);return n||(n=Object.create(null),o.set(t.type,n)),n}function Zn(e,t,o,n){const{appear:s,mode:r,persisted:i=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:d,onEnterCancelled:c,onBeforeLeave:f,onLeave:p,onAfterLeave:b,onLeaveCancelled:v,onBeforeAppear:C,onAppear:B,onAfterAppear:D,onAppearCancelled:$}=t,H=String(e.key),j=Eu(o,e),J=(U,ee)=>{U&&ct(U,n,9,ee)},Z={mode:r,persisted:i,beforeEnter(U){let ee=a;if(!o.isMounted)if(s)ee=C||a;else return;U._leaveCb&&U._leaveCb(!0);const te=j[H];te&&ko(e,te)&&te.el._leaveCb&&te.el._leaveCb(),J(ee,[U])},enter(U){let ee=l,te=d,he=c;if(!o.isMounted)if(s)ee=B||l,te=D||d,he=$||c;else return;let ue=!1;const F=U._enterCb=Ce=>{ue||(ue=!0,Ce?J(he,[U]):J(te,[U]),Z.delayedLeave&&Z.delayedLeave(),U._enterCb=void 0)};ee?(ee(U,F),ee.length<=1&&F()):F()},leave(U,ee){const te=String(e.key);if(U._enterCb&&U._enterCb(!0),o.isUnmounting)return ee();J(f,[U]);let he=!1;const ue=U._leaveCb=F=>{he||(he=!0,ee(),F?J(v,[U]):J(b,[U]),U._leaveCb=void 0,j[te]===e&&delete j[te])};j[te]=e,p?(p(U,ue),p.length<=1&&ue()):ue()},clone(U){return Zn(U,t,o,n)}};return Z}function Gr(e){if(ls(e))return e=Eo(e),e.children=null,e}function La(e){return ls(e)?e.children?e.children[0]:void 0:e}function an(e,t){e.shapeFlag&6&&e.component?an(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function jl(e,t=!1){let o=[],n=0;for(let s=0;s<e.length;s++){const r=e[s];r.type===N?(r.patchFlag&128&&n++,o=o.concat(jl(r.children,t))):(t||r.type!==vt)&&o.push(r)}if(n>1)for(let s=0;s<o.length;s++)o[s].patchFlag=-2;return o}function oe(e){return Q(e)?{setup:e,name:e.name}:e}const Gs=e=>!!e.type.__asyncLoader;function Va(e){Q(e)&&(e={loader:e});const{loader:t,loadingComponent:o,errorComponent:n,delay:s=200,timeout:r,suspensible:i=!0,onError:a}=e;let l=null,d,c=0;const f=()=>(c++,l=null,p()),p=()=>{let b;return l||(b=l=t().catch(v=>{if(v=v instanceof Error?v:new Error(String(v)),a)return new Promise((C,B)=>{a(v,()=>C(f()),()=>B(v),c+1)});throw v}).then(v=>b!==l&&l?l:(v&&(v.__esModule||v[Symbol.toStringTag]==="Module")&&(v=v.default),d=v,v)))};return oe({name:"AsyncComponentWrapper",__asyncLoader:p,get __asyncResolved(){return d},setup(){const b=Be;if(d)return()=>qr(d,b);const v=$=>{l=null,as($,b,13,!n)};if(i&&b.suspense||es)return p().then($=>()=>qr($,b)).catch($=>(v($),()=>n?w(n,{error:$}):null));const C=sn(!1),B=sn(),D=sn(!!s);return s&&setTimeout(()=>{D.value=!1},s),r!=null&&setTimeout(()=>{if(!C.value&&!B.value){const $=new Error(`Async component timed out after ${r}ms.`);v($),B.value=$}},r),p().then(()=>{C.value=!0,b.parent&&ls(b.parent.vnode)&&Nl(b.parent.update)}).catch($=>{v($),B.value=$}),()=>{if(C.value&&d)return qr(d,b);if(B.value&&n)return w(n,{error:B.value});if(o&&!D.value)return w(o)}}})}function qr(e,{vnode:{ref:t,props:o,children:n}}){const s=w(e,o,n);return s.ref=t,s}const ls=e=>e.type.__isKeepAlive,og={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const o=Hl(),n=o.ctx;if(!n.renderer)return t.default;const s=new Map,r=new Set;let i=null;const a=o.suspense,{renderer:{p:l,m:d,um:c,o:{createElement:f}}}=n,p=f("div");n.activate=($,H,j,J,Z)=>{const U=$.component;d($,H,j,0,a),l(U.vnode,$,H,j,U,a,J,$.slotScopeIds,Z),Me(()=>{U.isDeactivated=!1,U.a&&on(U.a);const ee=$.props&&$.props.onVnodeMounted;ee&&rt(ee,U.parent,$)},a)},n.deactivate=$=>{const H=$.component;d($,p,null,1,a),Me(()=>{H.da&&on(H.da);const j=$.props&&$.props.onVnodeUnmounted;j&&rt(j,H.parent,$),H.isDeactivated=!0},a)};function b($){Xr($),c($,o,a)}function v($){s.forEach((H,j)=>{const J=Ei(H.type);J&&(!$||!$(J))&&C(j)})}function C($){const H=s.get($);!i||H.type!==i.type?b(H):i&&Xr(i),s.delete($),r.delete($)}To(()=>[e.include,e.exclude],([$,H])=>{$&&v(j=>Mn($,j)),H&&v(j=>!Mn(H,j))},{flush:"post",deep:!0});let B=null;const D=()=>{B!=null&&s.set(B,Kr(o.subTree))};return Il(D),Tl(D),El(()=>{s.forEach($=>{const{subTree:H,suspense:j}=o,J=Kr(H);if($.type===J.type){Xr(J);const Z=J.component.da;Z&&Me(Z,j);return}b($)})}),()=>{if(B=null,!t.default)return null;const $=t.default(),H=$[0];if($.length>1)return i=null,$;if(!Qn(H)||!(H.shapeFlag&4)&&!(H.shapeFlag&128))return i=null,H;let j=Kr(H);const J=j.type,Z=Ei(Gs(j)?j.type.__asyncResolved||{}:J),{include:U,exclude:ee,max:te}=e;if(U&&(!Z||!Mn(U,Z))||ee&&Z&&Mn(ee,Z))return i=j,H;const he=j.key==null?J:j.key,ue=s.get(he);return j.el&&(j=Eo(j),H.shapeFlag&128&&(H.ssContent=j)),B=he,ue?(j.el=ue.el,j.component=ue.component,j.transition&&an(j,j.transition),j.shapeFlag|=512,r.delete(he),r.add(he)):(r.add(he),te&&r.size>parseInt(te,10)&&C(r.values().next().value)),j.shapeFlag|=256,i=j,H}}},ng=og;function Mn(e,t){return z(e)?e.some(o=>Mn(o,t)):Ae(e)?e.split(",").indexOf(t)>-1:e.test?e.test(t):!1}function sg(e,t){Bu(e,"a",t)}function rg(e,t){Bu(e,"da",t)}function Bu(e,t,o=Be){const n=e.__wdc||(e.__wdc=()=>{let s=o;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(vr(t,n,o),o){let s=o.parent;for(;s&&s.parent;)ls(s.parent.vnode)&&ig(n,t,o,s),s=s.parent}}function ig(e,t,o,n){const s=vr(t,e,n,!0);Au(()=>{ml(n[t],s)},o)}function Xr(e){let t=e.shapeFlag;t&256&&(t-=256),t&512&&(t-=512),e.shapeFlag=t}function Kr(e){return e.shapeFlag&128?e.ssContent:e}function vr(e,t,o=Be,n=!1){if(o){const s=o[e]||(o[e]=[]),r=t.__weh||(t.__weh=(...i)=>{if(o.isUnmounted)return;vn(),dn(o);const a=ct(t,o,e,i);return Io(),Ro(),a});return n?s.unshift(r):s.push(r),r}}const qt=e=>(t,o=Be)=>(!es||e==="sp")&&vr(e,t,o),lg=qt("bm"),Il=qt("m"),ag=qt("bu"),Tl=qt("u"),El=qt("bum"),Au=qt("um"),dg=qt("sp"),cg=qt("rtg"),ug=qt("rtc");function fg(e,t=Be){vr("ec",e,t)}let Si=!0;function pg(e){const t=Ru(e),o=e.proxy,n=e.ctx;Si=!1,t.beforeCreate&&Wa(t.beforeCreate,e,"bc");const{data:s,computed:r,methods:i,watch:a,provide:l,inject:d,created:c,beforeMount:f,mounted:p,beforeUpdate:b,updated:v,activated:C,deactivated:B,beforeDestroy:D,beforeUnmount:$,destroyed:H,unmounted:j,render:J,renderTracked:Z,renderTriggered:U,errorCaptured:ee,serverPrefetch:te,expose:he,inheritAttrs:ue,components:F,directives:Ce,filters:Ye}=t;if(d&&hg(d,n,null,e.appContext.config.unwrapInjectedRef),i)for(const ke in i){const ve=i[ke];Q(ve)&&(n[ke]=ve.bind(o))}if(s){const ke=s.call(o,o);Oe(ke)&&(e.data=Ut(ke))}if(Si=!0,r)for(const ke in r){const ve=r[ke],At=Q(ve)?ve.bind(o,o):Q(ve.get)?ve.get.bind(o,o):bt,Nr=!Q(ve)&&Q(ve.set)?ve.set.bind(o):bt,xn=ki({get:At,set:Nr});Object.defineProperty(n,ke,{enumerable:!0,configurable:!0,get:()=>xn.value,set:Fo=>xn.value=Fo})}if(a)for(const ke in a)Du(a[ke],n,o,ke);if(l){const ke=Q(l)?l.call(o):l;Reflect.ownKeys(ke).forEach(ve=>{Qh(ve,ke[ve])})}c&&Wa(c,e,"c");function Pe(ke,ve){z(ve)?ve.forEach(At=>ke(At.bind(o))):ve&&ke(ve.bind(o))}if(Pe(lg,f),Pe(Il,p),Pe(ag,b),Pe(Tl,v),Pe(sg,C),Pe(rg,B),Pe(fg,ee),Pe(ug,Z),Pe(cg,U),Pe(El,$),Pe(Au,j),Pe(dg,te),z(he))if(he.length){const ke=e.exposed||(e.exposed={});he.forEach(ve=>{Object.defineProperty(ke,ve,{get:()=>o[ve],set:At=>o[ve]=At})})}else e.exposed||(e.exposed={});J&&e.render===bt&&(e.render=J),ue!=null&&(e.inheritAttrs=ue),F&&(e.components=F),Ce&&(e.directives=Ce)}function hg(e,t,o=bt,n=!1){z(e)&&(e=Oi(e));for(const s in e){const r=e[s];let i;Oe(r)?"default"in r?i=Ur(r.from||s,r.default,!0):i=Ur(r.from||s):i=Ur(r),Ge(i)&&n?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[s]=i}}function Wa(e,t,o){ct(z(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,o)}function Du(e,t,o,n){const s=n.includes(".")?of(o,n):()=>o[n];if(Ae(e)){const r=t[e];Q(r)&&To(s,r)}else if(Q(e))To(s,e.bind(o));else if(Oe(e))if(z(e))e.forEach(r=>Du(r,t,o,n));else{const r=Q(e.handler)?e.handler.bind(o):t[e.handler];Q(r)&&To(s,r,e)}}function Ru(e){const t=e.type,{mixins:o,extends:n}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=e.appContext,a=r.get(t);let l;return a?l=a:!s.length&&!o&&!n?l=t:(l={},s.length&&s.forEach(d=>qs(l,d,i,!0)),qs(l,t,i)),r.set(t,l),l}function qs(e,t,o,n=!1){const{mixins:s,extends:r}=t;r&&qs(e,r,o,!0),s&&s.forEach(i=>qs(e,i,o,!0));for(const i in t)if(!(n&&i==="expose")){const a=gg[i]||o&&o[i];e[i]=a?a(e[i],t[i]):t[i]}return e}const gg={data:za,props:Co,emits:Co,methods:Co,computed:Co,beforeCreate:ze,created:ze,beforeMount:ze,mounted:ze,beforeUpdate:ze,updated:ze,beforeDestroy:ze,beforeUnmount:ze,destroyed:ze,unmounted:ze,activated:ze,deactivated:ze,errorCaptured:ze,serverPrefetch:ze,components:Co,directives:Co,watch:bg,provide:za,inject:mg};function za(e,t){return t?e?function(){return He(Q(e)?e.call(this,this):e,Q(t)?t.call(this,this):t)}:t:e}function mg(e,t){return Co(Oi(e),Oi(t))}function Oi(e){if(z(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function ze(e,t){return e?[...new Set([].concat(e,t))]:t}function Co(e,t){return e?He(He(Object.create(null),e),t):t}function bg(e,t){if(!e)return t;if(!t)return e;const o=He(Object.create(null),e);for(const n in t)o[n]=ze(e[n],t[n]);return o}function vg(e,t,o,n=!1){const s={},r={};zs(r,yr,1),e.propsDefaults=Object.create(null),Hu(e,t,s,r);for(const i in e.propsOptions[0])i in s||(s[i]=void 0);o?e.props=n?s:Nh(s):e.type.props?e.props=s:e.props=r,e.attrs=r}function yg(e,t,o,n){const{props:s,attrs:r,vnode:{patchFlag:i}}=e,a=de(s),[l]=e.propsOptions;let d=!1;if((n||i>0)&&!(i&16)){if(i&8){const c=e.vnode.dynamicProps;for(let f=0;f<c.length;f++){let p=c[f];const b=t[p];if(l)if(re(r,p))b!==r[p]&&(r[p]=b,d=!0);else{const v=Tt(p);s[v]=xi(l,a,v,b,e,!1)}else b!==r[p]&&(r[p]=b,d=!0)}}}else{Hu(e,t,s,r)&&(d=!0);let c;for(const f in a)(!t||!re(t,f)&&((c=Do(f))===f||!re(t,c)))&&(l?o&&(o[f]!==void 0||o[c]!==void 0)&&(s[f]=xi(l,a,f,void 0,e,!0)):delete s[f]);if(r!==a)for(const f in r)(!t||!re(t,f))&&(delete r[f],d=!0)}d&&zt(e,"set","$attrs")}function Hu(e,t,o,n){const[s,r]=e.propsOptions;let i=!1,a;if(t)for(let l in t){if(Rs(l))continue;const d=t[l];let c;s&&re(s,c=Tt(l))?!r||!r.includes(c)?o[c]=d:(a||(a={}))[c]=d:xl(e.emitsOptions,l)||(!(l in n)||d!==n[l])&&(n[l]=d,i=!0)}if(r){const l=de(o),d=a||me;for(let c=0;c<r.length;c++){const f=r[c];o[f]=xi(s,l,f,d[f],e,!re(d,f))}}return i}function xi(e,t,o,n,s,r){const i=e[o];if(i!=null){const a=re(i,"default");if(a&&n===void 0){const l=i.default;if(i.type!==Function&&Q(l)){const{propsDefaults:d}=s;o in d?n=d[o]:(dn(s),n=d[o]=l.call(null,t),Io())}else n=l}i[0]&&(r&&!a?n=!1:i[1]&&(n===""||n===Do(o))&&(n=!0))}return n}function Mu(e,t,o=!1){const n=t.propsCache,s=n.get(e);if(s)return s;const r=e.props,i={},a=[];let l=!1;if(!Q(e)){const c=f=>{l=!0;const[p,b]=Mu(f,t,!0);He(i,p),b&&a.push(...b)};!o&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!r&&!l)return n.set(e,en),en;if(z(r))for(let c=0;c<r.length;c++){const f=Tt(r[c]);Ua(f)&&(i[f]=me)}else if(r)for(const c in r){const f=Tt(c);if(Ua(f)){const p=r[c],b=i[f]=z(p)||Q(p)?{type:p}:p;if(b){const v=Xa(Boolean,b.type),C=Xa(String,b.type);b[0]=v>-1,b[1]=C<0||v<C,(v>-1||re(b,"default"))&&a.push(f)}}}const d=[i,a];return n.set(e,d),d}function Ua(e){return e[0]!=="$"}function Ga(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function qa(e,t){return Ga(e)===Ga(t)}function Xa(e,t){return z(t)?t.findIndex(o=>qa(o,e)):Q(t)&&qa(t,e)?0:-1}const Fu=e=>e[0]==="_"||e==="$stable",Bl=e=>z(e)?e.map(Ot):[Ot(e)],_g=(e,t,o)=>{const n=T((...s)=>Bl(t(...s)),o);return n._c=!1,n},Nu=(e,t,o)=>{const n=e._ctx;for(const s in e){if(Fu(s))continue;const r=e[s];if(Q(r))t[s]=_g(s,r,n);else if(r!=null){const i=Bl(r);t[s]=()=>i}}},Lu=(e,t)=>{const o=Bl(t);e.slots.default=()=>o},wg=(e,t)=>{if(e.vnode.shapeFlag&32){const o=t._;o?(e.slots=de(t),zs(t,"_",o)):Nu(t,e.slots={})}else e.slots={},t&&Lu(e,t);zs(e.slots,yr,1)},$g=(e,t,o)=>{const{vnode:n,slots:s}=e;let r=!0,i=me;if(n.shapeFlag&32){const a=t._;a?o&&a===1?r=!1:(He(s,t),!o&&a===1&&delete s._):(r=!t.$stable,Nu(t,s)),i=t}else t&&(Lu(e,t),i={default:1});if(r)for(const a in s)!Fu(a)&&!(a in i)&&delete s[a]};function ae(e,t){const o=ot;if(o===null)return e;const n=o.proxy,s=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[i,a,l,d=me]=t[r];Q(i)&&(i={mounted:i,updated:i}),i.deep&&So(a),s.push({dir:i,instance:n,value:a,oldValue:void 0,arg:l,modifiers:d})}return e}function bo(e,t,o,n){const s=e.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){const a=s[i];r&&(a.oldValue=r[i].value);let l=a.dir[n];l&&(vn(),ct(l,o,8,[e.el,a,e,t]),Ro())}}function Vu(){return{app:null,config:{isNativeTag:rh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Cg=0;function Pg(e,t){return function(n,s=null){s!=null&&!Oe(s)&&(s=null);const r=Vu(),i=new Set;let a=!1;const l=r.app={_uid:Cg++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:em,get config(){return r.config},set config(d){},use(d,...c){return i.has(d)||(d&&Q(d.install)?(i.add(d),d.install(l,...c)):Q(d)&&(i.add(d),d(l,...c))),l},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),l},component(d,c){return c?(r.components[d]=c,l):r.components[d]},directive(d,c){return c?(r.directives[d]=c,l):r.directives[d]},mount(d,c,f){if(!a){const p=w(n,s);return p.appContext=r,c&&t?t(p,d):e(p,d,f),a=!0,l._container=d,d.__vue_app__=l,Ml(p.component)||p.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(d,c){return r.provides[d]=c,l}};return l}}function ji(e,t,o,n,s=!1){if(z(e)){e.forEach((p,b)=>ji(p,t&&(z(t)?t[b]:t),o,n,s));return}if(Gs(n)&&!s)return;const r=n.shapeFlag&4?Ml(n.component)||n.component.proxy:n.el,i=s?null:r,{i:a,r:l}=e,d=t&&t.r,c=a.refs===me?a.refs={}:a.refs,f=a.setupState;if(d!=null&&d!==l&&(Ae(d)?(c[d]=null,re(f,d)&&(f[d]=null)):Ge(d)&&(d.value=null)),Q(l))co(l,a,12,[i,c]);else{const p=Ae(l),b=Ge(l);if(p||b){const v=()=>{if(e.f){const C=p?c[l]:l.value;s?z(C)&&ml(C,r):z(C)?C.includes(r)||C.push(r):p?c[l]=[r]:(l.value=[r],e.k&&(c[e.k]=l.value))}else p?(c[l]=i,re(f,l)&&(f[l]=i)):Ge(l)&&(l.value=i,e.k&&(c[e.k]=i))};i?(v.id=-1,Me(v,o)):v()}}}const Me=Zh;function kg(e){return Sg(e)}function Sg(e,t){const o=uh();o.__VUE__=!0;const{insert:n,remove:s,patchProp:r,createElement:i,createText:a,createComment:l,setText:d,setElementText:c,parentNode:f,nextSibling:p,setScopeId:b=bt,cloneNode:v,insertStaticContent:C}=e,B=(h,g,y,k=null,P=null,I=null,R=!1,x=null,E=!!g.dynamicChildren)=>{if(h===g)return;h&&!ko(h,g)&&(k=_s(h),Kt(h,P,I,!0),h=null),g.patchFlag===-2&&(E=!1,g.dynamicChildren=null);const{type:S,ref:L,shapeFlag:M}=g;switch(S){case Dl:D(h,g,y,k);break;case vt:$(h,g,y,k);break;case Hs:h==null&&H(g,y,k,R);break;case N:Ce(h,g,y,k,P,I,R,x,E);break;default:M&1?Z(h,g,y,k,P,I,R,x,E):M&6?Ye(h,g,y,k,P,I,R,x,E):(M&64||M&128)&&S.process(h,g,y,k,P,I,R,x,E,No)}L!=null&&P&&ji(L,h&&h.ref,I,g||h,!g)},D=(h,g,y,k)=>{if(h==null)n(g.el=a(g.children),y,k);else{const P=g.el=h.el;g.children!==h.children&&d(P,g.children)}},$=(h,g,y,k)=>{h==null?n(g.el=l(g.children||""),y,k):g.el=h.el},H=(h,g,y,k)=>{[h.el,h.anchor]=C(h.children,g,y,k)},j=({el:h,anchor:g},y,k)=>{let P;for(;h&&h!==g;)P=p(h),n(h,y,k),h=P;n(g,y,k)},J=({el:h,anchor:g})=>{let y;for(;h&&h!==g;)y=p(h),s(h),h=y;s(g)},Z=(h,g,y,k,P,I,R,x,E)=>{R=R||g.type==="svg",h==null?U(g,y,k,P,I,R,x,E):he(h,g,P,I,R,x,E)},U=(h,g,y,k,P,I,R,x)=>{let E,S;const{type:L,props:M,shapeFlag:V,transition:Y,patchFlag:se,dirs:_e}=h;if(h.el&&v!==void 0&&se===-1)E=h.el=v(h.el);else{if(E=h.el=i(h.type,I,M&&M.is,M),V&8?c(E,h.children):V&16&&te(h.children,E,null,k,P,I&&L!=="foreignObject",R,x),_e&&bo(h,null,k,"created"),M){for(const ye in M)ye!=="value"&&!Rs(ye)&&r(E,ye,null,M[ye],I,h.children,k,P,Dt);"value"in M&&r(E,"value",null,M.value),(S=M.onVnodeBeforeMount)&&rt(S,k,h)}ee(E,h,h.scopeId,R,k)}_e&&bo(h,null,k,"beforeMount");const ge=(!P||P&&!P.pendingBranch)&&Y&&!Y.persisted;ge&&Y.beforeEnter(E),n(E,g,y),((S=M&&M.onVnodeMounted)||ge||_e)&&Me(()=>{S&&rt(S,k,h),ge&&Y.enter(E),_e&&bo(h,null,k,"mounted")},P)},ee=(h,g,y,k,P)=>{if(y&&b(h,y),k)for(let I=0;I<k.length;I++)b(h,k[I]);if(P){let I=P.subTree;if(g===I){const R=P.vnode;ee(h,R,R.scopeId,R.slotScopeIds,P.parent)}}},te=(h,g,y,k,P,I,R,x,E=0)=>{for(let S=E;S<h.length;S++){const L=h[S]=x?io(h[S]):Ot(h[S]);B(null,L,g,y,k,P,I,R,x)}},he=(h,g,y,k,P,I,R)=>{const x=g.el=h.el;let{patchFlag:E,dynamicChildren:S,dirs:L}=g;E|=h.patchFlag&16;const M=h.props||me,V=g.props||me;let Y;y&&vo(y,!1),(Y=V.onVnodeBeforeUpdate)&&rt(Y,y,g,h),L&&bo(g,h,y,"beforeUpdate"),y&&vo(y,!0);const se=P&&g.type!=="foreignObject";if(S?ue(h.dynamicChildren,S,x,y,k,se,I):R||At(h,g,x,null,y,k,se,I,!1),E>0){if(E&16)F(x,g,M,V,y,k,P);else if(E&2&&M.class!==V.class&&r(x,"class",null,V.class,P),E&4&&r(x,"style",M.style,V.style,P),E&8){const _e=g.dynamicProps;for(let ge=0;ge<_e.length;ge++){const ye=_e[ge],ht=M[ye],Lo=V[ye];(Lo!==ht||ye==="value")&&r(x,ye,ht,Lo,P,h.children,y,k,Dt)}}E&1&&h.children!==g.children&&c(x,g.children)}else!R&&S==null&&F(x,g,M,V,y,k,P);((Y=V.onVnodeUpdated)||L)&&Me(()=>{Y&&rt(Y,y,g,h),L&&bo(g,h,y,"updated")},k)},ue=(h,g,y,k,P,I,R)=>{for(let x=0;x<g.length;x++){const E=h[x],S=g[x],L=E.el&&(E.type===N||!ko(E,S)||E.shapeFlag&70)?f(E.el):y;B(E,S,L,null,k,P,I,R,!0)}},F=(h,g,y,k,P,I,R)=>{if(y!==k){for(const x in k){if(Rs(x))continue;const E=k[x],S=y[x];E!==S&&x!=="value"&&r(h,x,S,E,R,g.children,P,I,Dt)}if(y!==me)for(const x in y)!Rs(x)&&!(x in k)&&r(h,x,y[x],null,R,g.children,P,I,Dt);"value"in k&&r(h,"value",y.value,k.value)}},Ce=(h,g,y,k,P,I,R,x,E)=>{const S=g.el=h?h.el:a(""),L=g.anchor=h?h.anchor:a("");let{patchFlag:M,dynamicChildren:V,slotScopeIds:Y}=g;Y&&(x=x?x.concat(Y):Y),h==null?(n(S,y,k),n(L,y,k),te(g.children,y,L,P,I,R,x,E)):M>0&&M&64&&V&&h.dynamicChildren?(ue(h.dynamicChildren,V,y,P,I,R,x),(g.key!=null||P&&g===P.subTree)&&Al(h,g,!0)):At(h,g,y,L,P,I,R,x,E)},Ye=(h,g,y,k,P,I,R,x,E)=>{g.slotScopeIds=x,h==null?g.shapeFlag&512?P.ctx.activate(g,y,k,R,E):pt(g,y,k,P,I,R,E):Pe(h,g,E)},pt=(h,g,y,k,P,I,R)=>{const x=h.component=Lg(h,k,P);if(ls(h)&&(x.ctx.renderer=No),Vg(x),x.asyncDep){if(P&&P.registerDep(x,ke),!h.el){const E=x.subTree=w(vt);$(null,E,g,y)}return}ke(x,h,g,y,P,I,R)},Pe=(h,g,y)=>{const k=g.component=h.component;if(Kh(h,g,y))if(k.asyncDep&&!k.asyncResolved){ve(k,g,y);return}else k.next=g,Yg(k.update),k.update();else g.component=h.component,g.el=h.el,k.vnode=g},ke=(h,g,y,k,P,I,R)=>{const x=()=>{if(h.isMounted){let{next:L,bu:M,u:V,parent:Y,vnode:se}=h,_e=L,ge;vo(h,!1),L?(L.el=se.el,ve(h,L,R)):L=se,M&&on(M),(ge=L.props&&L.props.onVnodeBeforeUpdate)&&rt(ge,Y,L,se),vo(h,!0);const ye=zr(h),ht=h.subTree;h.subTree=ye,B(ht,ye,f(ht.el),_s(ht),h,P,I),L.el=ye.el,_e===null&&Yh(h,ye.el),V&&Me(V,P),(ge=L.props&&L.props.onVnodeUpdated)&&Me(()=>rt(ge,Y,L,se),P)}else{let L;const{el:M,props:V}=g,{bm:Y,m:se,parent:_e}=h,ge=Gs(g);if(vo(h,!1),Y&&on(Y),!ge&&(L=V&&V.onVnodeBeforeMount)&&rt(L,_e,g),vo(h,!0),M&&Vr){const ye=()=>{h.subTree=zr(h),Vr(M,h.subTree,h,P,null)};ge?g.type.__asyncLoader().then(()=>!h.isUnmounted&&ye()):ye()}else{const ye=h.subTree=zr(h);B(null,ye,y,k,h,P,I),g.el=ye.el}if(se&&Me(se,P),!ge&&(L=V&&V.onVnodeMounted)){const ye=g;Me(()=>rt(L,_e,ye),P)}g.shapeFlag&256&&h.a&&Me(h.a,P),h.isMounted=!0,g=y=k=null}},E=h.effect=new _l(x,()=>Nl(h.update),h.scope),S=h.update=E.run.bind(E);S.id=h.uid,vo(h,!0),S()},ve=(h,g,y)=>{g.component=h;const k=h.vnode.props;h.vnode=g,h.next=null,yg(h,g.props,k,y),$g(h,g.children,y),vn(),Ll(void 0,h.update),Ro()},At=(h,g,y,k,P,I,R,x,E=!1)=>{const S=h&&h.children,L=h?h.shapeFlag:0,M=g.children,{patchFlag:V,shapeFlag:Y}=g;if(V>0){if(V&128){xn(S,M,y,k,P,I,R,x,E);return}else if(V&256){Nr(S,M,y,k,P,I,R,x,E);return}}Y&8?(L&16&&Dt(S,P,I),M!==S&&c(y,M)):L&16?Y&16?xn(S,M,y,k,P,I,R,x,E):Dt(S,P,I,!0):(L&8&&c(y,""),Y&16&&te(M,y,k,P,I,R,x,E))},Nr=(h,g,y,k,P,I,R,x,E)=>{h=h||en,g=g||en;const S=h.length,L=g.length,M=Math.min(S,L);let V;for(V=0;V<M;V++){const Y=g[V]=E?io(g[V]):Ot(g[V]);B(h[V],Y,y,null,P,I,R,x,E)}S>L?Dt(h,P,I,!0,!1,M):te(g,y,k,P,I,R,x,E,M)},xn=(h,g,y,k,P,I,R,x,E)=>{let S=0;const L=g.length;let M=h.length-1,V=L-1;for(;S<=M&&S<=V;){const Y=h[S],se=g[S]=E?io(g[S]):Ot(g[S]);if(ko(Y,se))B(Y,se,y,null,P,I,R,x,E);else break;S++}for(;S<=M&&S<=V;){const Y=h[M],se=g[V]=E?io(g[V]):Ot(g[V]);if(ko(Y,se))B(Y,se,y,null,P,I,R,x,E);else break;M--,V--}if(S>M){if(S<=V){const Y=V+1,se=Y<L?g[Y].el:k;for(;S<=V;)B(null,g[S]=E?io(g[S]):Ot(g[S]),y,se,P,I,R,x,E),S++}}else if(S>V)for(;S<=M;)Kt(h[S],P,I,!0),S++;else{const Y=S,se=S,_e=new Map;for(S=se;S<=V;S++){const Je=g[S]=E?io(g[S]):Ot(g[S]);Je.key!=null&&_e.set(Je.key,S)}let ge,ye=0;const ht=V-se+1;let Lo=!1,ja=0;const jn=new Array(ht);for(S=0;S<ht;S++)jn[S]=0;for(S=Y;S<=M;S++){const Je=h[S];if(ye>=ht){Kt(Je,P,I,!0);continue}let $t;if(Je.key!=null)$t=_e.get(Je.key);else for(ge=se;ge<=V;ge++)if(jn[ge-se]===0&&ko(Je,g[ge])){$t=ge;break}$t===void 0?Kt(Je,P,I,!0):(jn[$t-se]=S+1,$t>=ja?ja=$t:Lo=!0,B(Je,g[$t],y,null,P,I,R,x,E),ye++)}const Ia=Lo?Og(jn):en;for(ge=Ia.length-1,S=ht-1;S>=0;S--){const Je=se+S,$t=g[Je],Ta=Je+1<L?g[Je+1].el:k;jn[S]===0?B(null,$t,y,Ta,P,I,R,x,E):Lo&&(ge<0||S!==Ia[ge]?Fo($t,y,Ta,2):ge--)}}},Fo=(h,g,y,k,P=null)=>{const{el:I,type:R,transition:x,children:E,shapeFlag:S}=h;if(S&6){Fo(h.component.subTree,g,y,k);return}if(S&128){h.suspense.move(g,y,k);return}if(S&64){R.move(h,g,y,No);return}if(R===N){n(I,g,y);for(let M=0;M<E.length;M++)Fo(E[M],g,y,k);n(h.anchor,g,y);return}if(R===Hs){j(h,g,y);return}if(k!==2&&S&1&&x)if(k===0)x.beforeEnter(I),n(I,g,y),Me(()=>x.enter(I),P);else{const{leave:M,delayLeave:V,afterLeave:Y}=x,se=()=>n(I,g,y),_e=()=>{M(I,()=>{se(),Y&&Y()})};V?V(I,se,_e):_e()}else n(I,g,y)},Kt=(h,g,y,k=!1,P=!1)=>{const{type:I,props:R,ref:x,children:E,dynamicChildren:S,shapeFlag:L,patchFlag:M,dirs:V}=h;if(x!=null&&ji(x,null,y,h,!0),L&256){g.ctx.deactivate(h);return}const Y=L&1&&V,se=!Gs(h);let _e;if(se&&(_e=R&&R.onVnodeBeforeUnmount)&&rt(_e,g,h),L&6)Zp(h.component,y,k);else{if(L&128){h.suspense.unmount(y,k);return}Y&&bo(h,null,g,"beforeUnmount"),L&64?h.type.remove(h,g,y,P,No,k):S&&(I!==N||M>0&&M&64)?Dt(S,g,y,!1,!0):(I===N&&M&384||!P&&L&16)&&Dt(E,g,y),k&&Oa(h)}(se&&(_e=R&&R.onVnodeUnmounted)||Y)&&Me(()=>{_e&&rt(_e,g,h),Y&&bo(h,null,g,"unmounted")},y)},Oa=h=>{const{type:g,el:y,anchor:k,transition:P}=h;if(g===N){Jp(y,k);return}if(g===Hs){J(h);return}const I=()=>{s(y),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(h.shapeFlag&1&&P&&!P.persisted){const{leave:R,delayLeave:x}=P,E=()=>R(y,I);x?x(h.el,I,E):E()}else I()},Jp=(h,g)=>{let y;for(;h!==g;)y=p(h),s(h),h=y;s(g)},Zp=(h,g,y)=>{const{bum:k,scope:P,update:I,subTree:R,um:x}=h;k&&on(k),P.stop(),I&&(I.active=!1,Kt(R,h,g,y)),x&&Me(x,g),Me(()=>{h.isUnmounted=!0},g),g&&g.pendingBranch&&!g.isUnmounted&&h.asyncDep&&!h.asyncResolved&&h.suspenseId===g.pendingId&&(g.deps--,g.deps===0&&g.resolve())},Dt=(h,g,y,k=!1,P=!1,I=0)=>{for(let R=I;R<h.length;R++)Kt(h[R],g,y,k,P)},_s=h=>h.shapeFlag&6?_s(h.component.subTree):h.shapeFlag&128?h.suspense.next():p(h.anchor||h.el),xa=(h,g,y)=>{h==null?g._vnode&&Kt(g._vnode,null,null,!0):B(g._vnode||null,h,g,null,null,null,y),Qu(),g._vnode=h},No={p:B,um:Kt,m:Fo,r:Oa,mt:pt,mc:te,pc:At,pbc:ue,n:_s,o:e};let Lr,Vr;return t&&([Lr,Vr]=t(No)),{render:xa,hydrate:Lr,createApp:Pg(xa,Lr)}}function vo({effect:e,update:t},o){e.allowRecurse=t.allowRecurse=o}function Al(e,t,o=!1){const n=e.children,s=t.children;if(z(n)&&z(s))for(let r=0;r<n.length;r++){const i=n[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=io(s[r]),a.el=i.el),o||Al(i,a))}}function Og(e){const t=e.slice(),o=[0];let n,s,r,i,a;const l=e.length;for(n=0;n<l;n++){const d=e[n];if(d!==0){if(s=o[o.length-1],e[s]<d){t[n]=s,o.push(n);continue}for(r=0,i=o.length-1;r<i;)a=r+i>>1,e[o[a]]<d?r=a+1:i=a;d<e[o[r]]&&(r>0&&(t[n]=o[r-1]),o[r]=n)}}for(r=o.length,i=o[r-1];r-- >0;)o[r]=i,i=t[i];return o}const xg=e=>e.__isTeleport,Vn=e=>e&&(e.disabled||e.disabled===""),Ka=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,Ii=(e,t)=>{const o=e&&e.to;return Ae(o)?t?t(o):null:o},jg={__isTeleport:!0,process(e,t,o,n,s,r,i,a,l,d){const{mc:c,pc:f,pbc:p,o:{insert:b,querySelector:v,createText:C,createComment:B}}=d,D=Vn(t.props);let{shapeFlag:$,children:H,dynamicChildren:j}=t;if(e==null){const J=t.el=C(""),Z=t.anchor=C("");b(J,o,n),b(Z,o,n);const U=t.target=Ii(t.props,v),ee=t.targetAnchor=C("");U&&(b(ee,U),i=i||Ka(U));const te=(he,ue)=>{$&16&&c(H,he,ue,s,r,i,a,l)};D?te(o,Z):U&&te(U,ee)}else{t.el=e.el;const J=t.anchor=e.anchor,Z=t.target=e.target,U=t.targetAnchor=e.targetAnchor,ee=Vn(e.props),te=ee?o:Z,he=ee?J:U;if(i=i||Ka(Z),j?(p(e.dynamicChildren,j,te,s,r,i,a),Al(e,t,!0)):l||f(e,t,te,he,s,r,i,a,!1),D)ee||Os(t,o,J,d,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ue=t.target=Ii(t.props,v);ue&&Os(t,ue,null,d,0)}else ee&&Os(t,Z,U,d,1)}},remove(e,t,o,n,{um:s,o:{remove:r}},i){const{shapeFlag:a,children:l,anchor:d,targetAnchor:c,target:f,props:p}=e;if(f&&r(c),(i||!Vn(p))&&(r(d),a&16))for(let b=0;b<l.length;b++){const v=l[b];s(v,t,o,!0,!!v.dynamicChildren)}},move:Os,hydrate:Ig};function Os(e,t,o,{o:{insert:n},m:s},r=2){r===0&&n(e.targetAnchor,t,o);const{el:i,anchor:a,shapeFlag:l,children:d,props:c}=e,f=r===2;if(f&&n(i,t,o),(!f||Vn(c))&&l&16)for(let p=0;p<d.length;p++)s(d[p],t,o,2);f&&n(a,t,o)}function Ig(e,t,o,n,s,r,{o:{nextSibling:i,parentNode:a,querySelector:l}},d){const c=t.target=Ii(t.props,l);if(c){const f=c._lpa||c.firstChild;t.shapeFlag&16&&(Vn(t.props)?(t.anchor=d(i(e),t,a(e),o,n,s,r),t.targetAnchor=f):(t.anchor=i(e),t.targetAnchor=d(f,t,c,o,n,s,r)),c._lpa=t.targetAnchor&&i(t.targetAnchor))}return t.anchor&&i(t.anchor)}const Wu=jg,zu="components";function A(e,t){return Eg(zu,e,!0,t)||e}const Tg=Symbol();function Eg(e,t,o=!0,n=!1){const s=ot||Be;if(s){const r=s.type;if(e===zu){const a=Ei(r);if(a&&(a===t||a===Tt(t)||a===hr(Tt(t))))return r}const i=Ya(s[e]||r[e],t)||Ya(s.appContext[e],t);return!i&&n?r:i}}function Ya(e,t){return e&&(e[t]||e[Tt(t)]||e[hr(Tt(t))])}const N=Symbol(void 0),Dl=Symbol(void 0),vt=Symbol(void 0),Hs=Symbol(void 0),Wn=[];let jo=null;function m(e=!1){Wn.push(jo=e?null:[])}function Bg(){Wn.pop(),jo=Wn[Wn.length-1]||null}let Xs=1;function Ja(e){Xs+=e}function Uu(e){return e.dynamicChildren=Xs>0?jo||en:null,Bg(),Xs>0&&jo&&jo.push(e),e}function _(e,t,o,n,s,r){return Uu(u(e,t,o,n,s,r,!0))}function W(e,t,o,n,s){return Uu(w(e,t,o,n,s,!0))}function Qn(e){return e?e.__v_isVNode===!0:!1}function ko(e,t){return e.type===t.type&&e.key===t.key}const yr="__vInternal",Gu=({key:e})=>e!=null?e:null,Ms=({ref:e,ref_key:t,ref_for:o})=>e!=null?Ae(e)||Ge(e)||Q(e)?{i:ot,r:e,k:t,f:!!o}:e:null;function u(e,t=null,o=null,n=0,s=null,r=e===N?0:1,i=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Gu(t),ref:t&&Ms(t),scopeId:br,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null};return a?(Rl(l,o),r&128&&e.normalize(l)):o&&(l.shapeFlag|=Ae(o)?8:16),Xs>0&&!i&&jo&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&jo.push(l),l}const w=Ag;function Ag(e,t=null,o=null,n=0,s=null,r=!1){if((!e||e===Tg)&&(e=vt),Qn(e)){const a=Eo(e,t,!0);return o&&Rl(a,o),a}if(Gg(e)&&(e=e.__vccOpts),t){t=Dg(t);let{class:a,style:l}=t;a&&!Ae(a)&&(t.class=le(a)),Oe(l)&&(Su(l)&&!z(l)&&(l=He({},l)),t.style=Re(l))}const i=Ae(e)?1:Jh(e)?128:xg(e)?64:Oe(e)?4:Q(e)?2:0;return u(e,t,o,n,s,i,r,!0)}function Dg(e){return e?Su(e)||yr in e?He({},e):e:null}function Eo(e,t,o=!1){const{props:n,ref:s,patchFlag:r,children:i}=e,a=t?Hg(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&Gu(a),ref:t&&t.ref?o&&s?z(s)?s.concat(Ms(t)):[s,Ms(t)]:Ms(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==N?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Eo(e.ssContent),ssFallback:e.ssFallback&&Eo(e.ssFallback),el:e.el,anchor:e.anchor}}function O(e=" ",t=0){return w(Dl,null,e,t)}function Rg(e,t){const o=w(Hs,null,e);return o.staticCount=t,o}function q(e="",t=!1){return t?(m(),W(vt,null,e)):w(vt,null,e)}function Ot(e){return e==null||typeof e=="boolean"?w(vt):z(e)?w(N,null,e.slice()):typeof e=="object"?io(e):w(Dl,null,String(e))}function io(e){return e.el===null||e.memo?e:Eo(e)}function Rl(e,t){let o=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(z(t))o=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),Rl(e,s()),s._c&&(s._d=!0));return}else{o=32;const s=t._;!s&&!(yr in t)?t._ctx=ot:s===3&&ot&&(ot.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Q(t)?(t={default:t,_ctx:ot},o=32):(t=String(t),n&64?(o=16,t=[O(t)]):o=8);e.children=t,e.shapeFlag|=o}function Hg(...e){const t={};for(let o=0;o<e.length;o++){const n=e[o];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=le([t.class,n.class]));else if(s==="style")t.style=Re([t.style,n.style]);else if(ur(s)){const r=t[s],i=n[s];r!==i&&!(z(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=n[s])}return t}function rt(e,t,o,n=null){ct(e,t,7,[o,n])}function $e(e,t,o,n){let s;const r=o&&o[n];if(z(e)||Ae(e)){s=new Array(e.length);for(let i=0,a=e.length;i<a;i++)s[i]=t(e[i],i,void 0,r&&r[i])}else if(typeof e=="number"){s=new Array(e);for(let i=0;i<e;i++)s[i]=t(i+1,i,void 0,r&&r[i])}else if(Oe(e))if(e[Symbol.iterator])s=Array.from(e,(i,a)=>t(i,a,void 0,r&&r[a]));else{const i=Object.keys(e);s=new Array(i.length);for(let a=0,l=i.length;a<l;a++){const d=i[a];s[a]=t(e[d],d,a,r&&r[a])}}else s=[];return o&&(o[n]=s),s}function Wt(e,t,o={},n,s){if(ot.isCE)return w("slot",t==="default"?null:{name:t},n&&n());let r=e[t];r&&r._c&&(r._d=!1),m();const i=r&&qu(r(o)),a=W(N,{key:o.key||`_${t}`},i||(n?n():[]),i&&e._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function qu(e){return e.some(t=>Qn(t)?!(t.type===vt||t.type===N&&!qu(t.children)):!0)?e:null}const Ti=e=>e?Xu(e)?Ml(e)||e.proxy:Ti(e.parent):null,Ks=He(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ti(e.parent),$root:e=>Ti(e.root),$emit:e=>e.emit,$options:e=>Ru(e),$forceUpdate:e=>()=>Nl(e.update),$nextTick:e=>Xg.bind(e.proxy),$watch:e=>Qg.bind(e)}),Mg={get({_:e},t){const{ctx:o,setupState:n,data:s,props:r,accessCache:i,type:a,appContext:l}=e;let d;if(t[0]!=="$"){const b=i[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return s[t];case 4:return o[t];case 3:return r[t]}else{if(n!==me&&re(n,t))return i[t]=1,n[t];if(s!==me&&re(s,t))return i[t]=2,s[t];if((d=e.propsOptions[0])&&re(d,t))return i[t]=3,r[t];if(o!==me&&re(o,t))return i[t]=4,o[t];Si&&(i[t]=0)}}const c=Ks[t];let f,p;if(c)return t==="$attrs"&&nt(e,"get",t),c(e);if((f=a.__cssModules)&&(f=f[t]))return f;if(o!==me&&re(o,t))return i[t]=4,o[t];if(p=l.config.globalProperties,re(p,t))return p[t]},set({_:e},t,o){const{data:n,setupState:s,ctx:r}=e;if(s!==me&&re(s,t))s[t]=o;else if(n!==me&&re(n,t))n[t]=o;else if(re(e.props,t))return!1;return t[0]==="$"&&t.slice(1)in e?!1:(r[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:n,appContext:s,propsOptions:r}},i){let a;return!!o[i]||e!==me&&re(e,i)||t!==me&&re(t,i)||(a=r[0])&&re(a,i)||re(n,i)||re(Ks,i)||re(s.config.globalProperties,i)}},Fg=Vu();let Ng=0;function Lg(e,t,o){const n=e.type,s=(t?t.appContext:e.appContext)||Fg,r={uid:Ng++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new fh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Mu(n,s),emitsOptions:Iu(n,s),emit:null,emitted:null,propsDefaults:me,inheritAttrs:n.inheritAttrs,ctx:me,data:me,props:me,attrs:me,slots:me,refs:me,setupState:me,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Gh.bind(null,r),e.ce&&e.ce(r),r}let Be=null;const Hl=()=>Be||ot,dn=e=>{Be=e,e.scope.on()},Io=()=>{Be&&Be.scope.off(),Be=null};function Xu(e){return e.vnode.shapeFlag&4}let es=!1;function Vg(e,t=!1){es=t;const{props:o,children:n}=e.vnode,s=Xu(e);vg(e,o,s,t),wg(e,n);const r=s?Wg(e,t):void 0;return es=!1,r}function Wg(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=mr(new Proxy(e.ctx,Mg));const{setup:n}=o;if(n){const s=e.setupContext=n.length>1?Ug(e):null;dn(e),vn();const r=co(n,e,0,[e.props,s]);if(Ro(),Io(),fu(r)){if(r.then(Io,Io),t)return r.then(i=>{Za(e,i,t)}).catch(i=>{as(i,e,0)});e.asyncDep=r}else Za(e,r,t)}else Ku(e,t)}function Za(e,t,o){Q(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Oe(t)&&(e.setupState=ju(t)),Ku(e,o)}let Qa;function Ku(e,t,o){const n=e.type;if(!e.render){if(!t&&Qa&&!n.render){const s=n.template;if(s){const{isCustomElement:r,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:l}=n,d=He(He({isCustomElement:r,delimiters:a},i),l);n.render=Qa(s,d)}}e.render=n.render||bt}dn(e),vn(),pg(e),Ro(),Io()}function zg(e){return new Proxy(e.attrs,{get(t,o){return nt(e,"get","$attrs"),t[o]}})}function Ug(e){const t=n=>{e.exposed=n||{}};let o;return{get attrs(){return o||(o=zg(e))},slots:e.slots,emit:e.emit,expose:t}}function Ml(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(ju(mr(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in Ks)return Ks[o](e)}}))}function Ei(e){return Q(e)&&e.displayName||e.name}function Gg(e){return Q(e)&&"__vccOpts"in e}function co(e,t,o,n){let s;try{s=n?e(...n):e()}catch(r){as(r,t,o)}return s}function ct(e,t,o,n){if(Q(e)){const r=co(e,t,o,n);return r&&fu(r)&&r.catch(i=>{as(i,t,o)}),r}const s=[];for(let r=0;r<e.length;r++)s.push(ct(e[r],t,o,n));return s}function as(e,t,o,n=!0){const s=t?t.vnode:null;if(t){let r=t.parent;const i=t.proxy,a=o;for(;r;){const d=r.ec;if(d){for(let c=0;c<d.length;c++)if(d[c](e,i,a)===!1)return}r=r.parent}const l=t.appContext.config.errorHandler;if(l){co(l,null,10,[e,i,a]);return}}qg(e,o,s,n)}function qg(e,t,o,n=!0){console.error(e)}let Ys=!1,Bi=!1;const tt=[];let Vt=0;const zn=[];let Fn=null,Xo=0;const Un=[];let ro=null,Ko=0;const Yu=Promise.resolve();let Fl=null,Ai=null;function Xg(e){const t=Fl||Yu;return e?t.then(this?e.bind(this):e):t}function Kg(e){let t=Vt+1,o=tt.length;for(;t<o;){const n=t+o>>>1;ts(tt[n])<e?t=n+1:o=n}return t}function Nl(e){(!tt.length||!tt.includes(e,Ys&&e.allowRecurse?Vt+1:Vt))&&e!==Ai&&(e.id==null?tt.push(e):tt.splice(Kg(e.id),0,e),Ju())}function Ju(){!Ys&&!Bi&&(Bi=!0,Fl=Yu.then(ef))}function Yg(e){const t=tt.indexOf(e);t>Vt&&tt.splice(t,1)}function Zu(e,t,o,n){z(e)?o.push(...e):(!t||!t.includes(e,e.allowRecurse?n+1:n))&&o.push(e),Ju()}function Jg(e){Zu(e,Fn,zn,Xo)}function Zg(e){Zu(e,ro,Un,Ko)}function Ll(e,t=null){if(zn.length){for(Ai=t,Fn=[...new Set(zn)],zn.length=0,Xo=0;Xo<Fn.length;Xo++)Fn[Xo]();Fn=null,Xo=0,Ai=null,Ll(e,t)}}function Qu(e){if(Un.length){const t=[...new Set(Un)];if(Un.length=0,ro){ro.push(...t);return}for(ro=t,ro.sort((o,n)=>ts(o)-ts(n)),Ko=0;Ko<ro.length;Ko++)ro[Ko]();ro=null,Ko=0}}const ts=e=>e.id==null?1/0:e.id;function ef(e){Bi=!1,Ys=!0,Ll(e),tt.sort((o,n)=>ts(o)-ts(n));const t=bt;try{for(Vt=0;Vt<tt.length;Vt++){const o=tt[Vt];o&&o.active!==!1&&co(o,null,14)}}finally{Vt=0,tt.length=0,Qu(),Ys=!1,Fl=null,(tt.length||zn.length||Un.length)&&ef(e)}}const ed={};function To(e,t,o){return tf(e,t,o)}function tf(e,t,{immediate:o,deep:n,flush:s,onTrack:r,onTrigger:i}=me){const a=Be;let l,d=!1,c=!1;if(Ge(e)?(l=()=>e.value,d=!!e._shallow):nn(e)?(l=()=>e,n=!0):z(e)?(c=!0,d=e.some(nn),l=()=>e.map(D=>{if(Ge(D))return D.value;if(nn(D))return So(D);if(Q(D))return co(D,a,2)})):Q(e)?t?l=()=>co(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return f&&f(),ct(e,a,3,[p])}:l=bt,t&&n){const D=l;l=()=>So(D())}let f,p=D=>{f=B.onStop=()=>{co(D,a,4)}};if(es)return p=bt,t?o&&ct(t,a,3,[l(),c?[]:void 0,p]):l(),bt;let b=c?[]:ed;const v=()=>{if(!!B.active)if(t){const D=B.run();(n||d||(c?D.some(($,H)=>Kn($,b[H])):Kn(D,b)))&&(f&&f(),ct(t,a,3,[D,b===ed?void 0:b,p]),b=D)}else B.run()};v.allowRecurse=!!t;let C;s==="sync"?C=v:s==="post"?C=()=>Me(v,a&&a.suspense):C=()=>{!a||a.isMounted?Jg(v):v()};const B=new _l(l,C);return t?o?v():b=B.run():s==="post"?Me(B.run.bind(B),a&&a.suspense):B.run(),()=>{B.stop(),a&&a.scope&&ml(a.scope.effects,B)}}function Qg(e,t,o){const n=this.proxy,s=Ae(e)?e.includes(".")?of(n,e):()=>n[e]:e.bind(n,n);let r;Q(t)?r=t:(r=t.handler,o=t);const i=Be;dn(this);const a=tf(s,r.bind(n),o);return i?dn(i):Io(),a}function of(e,t){const o=t.split(".");return()=>{let n=e;for(let s=0;s<o.length&&n;s++)n=n[o[s]];return n}}function So(e,t){if(!Oe(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Ge(e))So(e.value,t);else if(z(e))for(let o=0;o<e.length;o++)So(e[o],t);else if(bn(e)||tn(e))e.forEach(o=>{So(o,t)});else if(hu(e))for(const o in e)So(e[o],t);return e}function td(e,t,o){const n=arguments.length;return n===2?Oe(t)&&!z(t)?Qn(t)?w(e,null,[t]):w(e,t):w(e,null,t):(n>3?o=Array.prototype.slice.call(arguments,2):n===3&&Qn(o)&&(o=[o]),w(e,t,o))}const em="3.2.26",tm="http://www.w3.org/2000/svg",Vo=typeof document!="undefined"?document:null,od=new Map,om={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,n)=>{const s=t?Vo.createElementNS(tm,e):Vo.createElement(e,o?{is:o}:void 0);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>Vo.createTextNode(e),createComment:e=>Vo.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Vo.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,o,n){const s=o?o.previousSibling:t.lastChild;let r=od.get(e);if(!r){const i=Vo.createElement("template");if(i.innerHTML=n?`<svg>${e}</svg>`:e,r=i.content,n){const a=r.firstChild;for(;a.firstChild;)r.appendChild(a.firstChild);r.removeChild(a)}od.set(e,r)}return t.insertBefore(r.cloneNode(!0),o),[s?s.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}};function nm(e,t,o){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}function sm(e,t,o){const n=e.style,s=Ae(o);if(o&&!s){for(const r in o)Di(n,r,o[r]);if(t&&!Ae(t))for(const r in t)o[r]==null&&Di(n,r,"")}else{const r=n.display;s?t!==o&&(n.cssText=o):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=r)}}const nd=/\s*!important$/;function Di(e,t,o){if(z(o))o.forEach(n=>Di(e,t,n));else if(t.startsWith("--"))e.setProperty(t,o);else{const n=rm(e,t);nd.test(o)?e.setProperty(Do(n),o.replace(nd,""),"important"):e[n]=o}}const sd=["Webkit","Moz","ms"],Yr={};function rm(e,t){const o=Yr[t];if(o)return o;let n=Tt(t);if(n!=="filter"&&n in e)return Yr[t]=n;n=hr(n);for(let s=0;s<sd.length;s++){const r=sd[s]+n;if(r in e)return Yr[t]=r}return t}const rd="http://www.w3.org/1999/xlink";function im(e,t,o,n,s){if(n&&t.startsWith("xlink:"))o==null?e.removeAttributeNS(rd,t.slice(6,t.length)):e.setAttributeNS(rd,t,o);else{const r=eh(t);o==null||r&&!cu(o)?e.removeAttribute(t):e.setAttribute(t,r?"":o)}}function lm(e,t,o,n,s,r,i){if(t==="innerHTML"||t==="textContent"){n&&i(n,s,r),e[t]=o==null?"":o;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=o;const a=o==null?"":o;(e.value!==a||e.tagName==="OPTION")&&(e.value=a),o==null&&e.removeAttribute(t);return}if(o===""||o==null){const a=typeof e[t];if(a==="boolean"){e[t]=cu(o);return}else if(o==null&&a==="string"){e[t]="",e.removeAttribute(t);return}else if(a==="number"){try{e[t]=0}catch(l){}e.removeAttribute(t);return}}try{e[t]=o}catch(a){}}let Js=Date.now,nf=!1;if(typeof window!="undefined"){Js()>document.createEvent("Event").timeStamp&&(Js=()=>performance.now());const e=navigator.userAgent.match(/firefox\/(\d+)/i);nf=!!(e&&Number(e[1])<=53)}let Ri=0;const am=Promise.resolve(),dm=()=>{Ri=0},cm=()=>Ri||(am.then(dm),Ri=Js());function lo(e,t,o,n){e.addEventListener(t,o,n)}function um(e,t,o,n){e.removeEventListener(t,o,n)}function fm(e,t,o,n,s=null){const r=e._vei||(e._vei={}),i=r[t];if(n&&i)i.value=n;else{const[a,l]=pm(t);if(n){const d=r[t]=hm(n,s);lo(e,a,d,l)}else i&&(um(e,a,i,l),r[t]=void 0)}}const id=/(?:Once|Passive|Capture)$/;function pm(e){let t;if(id.test(e)){t={};let o;for(;o=e.match(id);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[Do(e.slice(2)),t]}function hm(e,t){const o=n=>{const s=n.timeStamp||Js();(nf||s>=o.attached-1)&&ct(gm(n,o.value),t,5,[n])};return o.value=e,o.attached=cm(),o}function gm(e,t){if(z(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n(s))}else return t}const ld=/^on[a-z]/,mm=(e,t,o,n,s=!1,r,i,a,l)=>{t==="class"?nm(e,n,s):t==="style"?sm(e,o,n):ur(t)?gl(t)||fm(e,t,o,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):bm(e,t,n,s))?lm(e,t,n,r,i,a,l):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),im(e,t,n,s))};function bm(e,t,o,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&ld.test(t)&&Q(o)):t==="spellcheck"||t==="draggable"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||ld.test(t)&&Ae(o)?!1:t in e}const Zt="transition",Tn="animation",sf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},vm=He({},tg.props,sf),yo=(e,t=[])=>{z(e)?e.forEach(o=>o(...t)):e&&e(...t)},ad=e=>e?z(e)?e.some(t=>t.length>1):e.length>1:!1;function ym(e){const t={};for(const F in e)F in sf||(t[F]=e[F]);if(e.css===!1)return t;const{name:o="v",type:n,duration:s,enterFromClass:r=`${o}-enter-from`,enterActiveClass:i=`${o}-enter-active`,enterToClass:a=`${o}-enter-to`,appearFromClass:l=r,appearActiveClass:d=i,appearToClass:c=a,leaveFromClass:f=`${o}-leave-from`,leaveActiveClass:p=`${o}-leave-active`,leaveToClass:b=`${o}-leave-to`}=e,v=_m(s),C=v&&v[0],B=v&&v[1],{onBeforeEnter:D,onEnter:$,onEnterCancelled:H,onLeave:j,onLeaveCancelled:J,onBeforeAppear:Z=D,onAppear:U=$,onAppearCancelled:ee=H}=t,te=(F,Ce,Ye)=>{Po(F,Ce?c:a),Po(F,Ce?d:i),Ye&&Ye()},he=(F,Ce)=>{Po(F,b),Po(F,p),Ce&&Ce()},ue=F=>(Ce,Ye)=>{const pt=F?U:$,Pe=()=>te(Ce,F,Ye);yo(pt,[Ce,Pe]),dd(()=>{Po(Ce,F?l:r),Ht(Ce,F?c:a),ad(pt)||cd(Ce,n,C,Pe)})};return He(t,{onBeforeEnter(F){yo(D,[F]),Ht(F,r),Ht(F,i)},onBeforeAppear(F){yo(Z,[F]),Ht(F,l),Ht(F,d)},onEnter:ue(!1),onAppear:ue(!0),onLeave(F,Ce){const Ye=()=>he(F,Ce);Ht(F,f),lf(),Ht(F,p),dd(()=>{Po(F,f),Ht(F,b),ad(j)||cd(F,n,B,Ye)}),yo(j,[F,Ye])},onEnterCancelled(F){te(F,!1),yo(H,[F])},onAppearCancelled(F){te(F,!0),yo(ee,[F])},onLeaveCancelled(F){he(F),yo(J,[F])}})}function _m(e){if(e==null)return null;if(Oe(e))return[Jr(e.enter),Jr(e.leave)];{const t=Jr(e);return[t,t]}}function Jr(e){return Yn(e)}function Ht(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e._vtc||(e._vtc=new Set)).add(t)}function Po(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const{_vtc:o}=e;o&&(o.delete(t),o.size||(e._vtc=void 0))}function dd(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let wm=0;function cd(e,t,o,n){const s=e._endId=++wm,r=()=>{s===e._endId&&n()};if(o)return setTimeout(r,o);const{type:i,timeout:a,propCount:l}=rf(e,t);if(!i)return n();const d=i+"end";let c=0;const f=()=>{e.removeEventListener(d,p),r()},p=b=>{b.target===e&&++c>=l&&f()};setTimeout(()=>{c<l&&f()},a+1),e.addEventListener(d,p)}function rf(e,t){const o=window.getComputedStyle(e),n=v=>(o[v]||"").split(", "),s=n(Zt+"Delay"),r=n(Zt+"Duration"),i=ud(s,r),a=n(Tn+"Delay"),l=n(Tn+"Duration"),d=ud(a,l);let c=null,f=0,p=0;t===Zt?i>0&&(c=Zt,f=i,p=r.length):t===Tn?d>0&&(c=Tn,f=d,p=l.length):(f=Math.max(i,d),c=f>0?i>d?Zt:Tn:null,p=c?c===Zt?r.length:l.length:0);const b=c===Zt&&/\b(transform|all)(,|$)/.test(o[Zt+"Property"]);return{type:c,timeout:f,propCount:p,hasTransform:b}}function ud(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,n)=>fd(o)+fd(e[n])))}function fd(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function lf(){return document.body.offsetHeight}const af=new WeakMap,df=new WeakMap,$m={name:"TransitionGroup",props:He({},vm,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=Hl(),n=Tu();let s,r;return Tl(()=>{if(!s.length)return;const i=e.moveClass||`${e.name||"v"}-move`;if(!Sm(s[0].el,o.vnode.el,i))return;s.forEach(Cm),s.forEach(Pm);const a=s.filter(km);lf(),a.forEach(l=>{const d=l.el,c=d.style;Ht(d,i),c.transform=c.webkitTransform=c.transitionDuration="";const f=d._moveCb=p=>{p&&p.target!==d||(!p||/transform$/.test(p.propertyName))&&(d.removeEventListener("transitionend",f),d._moveCb=null,Po(d,i))};d.addEventListener("transitionend",f)})}),()=>{const i=de(e),a=ym(i);let l=i.tag||N;s=r,r=t.default?jl(t.default()):[];for(let d=0;d<r.length;d++){const c=r[d];c.key!=null&&an(c,Zn(c,a,n,o))}if(s)for(let d=0;d<s.length;d++){const c=s[d];an(c,Zn(c,a,n,o)),af.set(c,c.el.getBoundingClientRect())}return w(l,null,r)}}},T2=$m;function Cm(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Pm(e){df.set(e,e.el.getBoundingClientRect())}function km(e){const t=af.get(e),o=df.get(e),n=t.left-o.left,s=t.top-o.top;if(n||s){const r=e.el.style;return r.transform=r.webkitTransform=`translate(${n}px,${s}px)`,r.transitionDuration="0s",e}}function Sm(e,t,o){const n=e.cloneNode();e._vtc&&e._vtc.forEach(i=>{i.split(/\s+/).forEach(a=>a&&n.classList.remove(a))}),o.split(/\s+/).forEach(i=>i&&n.classList.add(i)),n.style.display="none";const s=t.nodeType===1?t:t.parentNode;s.appendChild(n);const{hasTransform:r}=rf(n);return s.removeChild(n),r}const cn=e=>{const t=e.props["onUpdate:modelValue"];return z(t)?o=>on(t,o):t};function Om(e){e.target.composing=!0}function pd(e){const t=e.target;t.composing&&(t.composing=!1,xm(t,"input"))}function xm(e,t){const o=document.createEvent("HTMLEvents");o.initEvent(t,!0,!0),e.dispatchEvent(o)}const xe={created(e,{modifiers:{lazy:t,trim:o,number:n}},s){e._assign=cn(s);const r=n||s.props&&s.props.type==="number";lo(e,t?"change":"input",i=>{if(i.target.composing)return;let a=e.value;o?a=a.trim():r&&(a=Yn(a)),e._assign(a)}),o&&lo(e,"change",()=>{e.value=e.value.trim()}),t||(lo(e,"compositionstart",Om),lo(e,"compositionend",pd),lo(e,"change",pd))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:o,trim:n,number:s}},r){if(e._assign=cn(r),e.composing||document.activeElement===e&&(o||n&&e.value.trim()===t||(s||e.type==="number")&&Yn(e.value)===t))return;const i=t==null?"":t;e.value!==i&&(e.value=i)}},jm={deep:!0,created(e,t,o){e._assign=cn(o),lo(e,"change",()=>{const n=e._modelValue,s=os(e),r=e.checked,i=e._assign;if(z(n)){const a=hl(n,s),l=a!==-1;if(r&&!l)i(n.concat(s));else if(!r&&l){const d=[...n];d.splice(a,1),i(d)}}else if(bn(n)){const a=new Set(n);r?a.add(s):a.delete(s),i(a)}else i(cf(e,r))})},mounted:hd,beforeUpdate(e,t,o){e._assign=cn(o),hd(e,t,o)}};function hd(e,{value:t,oldValue:o},n){e._modelValue=t,z(t)?e.checked=hl(t,n.props.value)>-1:bn(t)?e.checked=t.has(n.props.value):t!==o&&(e.checked=is(t,cf(e,!0)))}const yt={deep:!0,created(e,{value:t,modifiers:{number:o}},n){const s=bn(t);lo(e,"change",()=>{const r=Array.prototype.filter.call(e.options,i=>i.selected).map(i=>o?Yn(os(i)):os(i));e._assign(e.multiple?s?new Set(r):r:r[0])}),e._assign=cn(n)},mounted(e,{value:t}){gd(e,t)},beforeUpdate(e,t,o){e._assign=cn(o)},updated(e,{value:t}){gd(e,t)}};function gd(e,t){const o=e.multiple;if(!(o&&!z(t)&&!bn(t))){for(let n=0,s=e.options.length;n<s;n++){const r=e.options[n],i=os(r);if(o)z(t)?r.selected=hl(t,i)>-1:r.selected=t.has(i);else if(is(os(r),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!o&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function os(e){return"_value"in e?e._value:e.value}function cf(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const Im=["ctrl","shift","alt","meta"],Tm={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Im.some(o=>e[`${o}Key`]&&!t.includes(o))},G=(e,t)=>(o,...n)=>{for(let s=0;s<t.length;s++){const r=Tm[t[s]];if(r&&r(o,t))return}return e(o,...n)},Em={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ue=(e,t)=>o=>{if(!("key"in o))return;const n=Do(o.key);if(t.some(s=>s===n||Em[s]===n))return e(o)},Bm=He({patchProp:mm},om);let md;function Am(){return md||(md=kg(Bm))}const Dm=(...e)=>{const t=Am().createApp(...e),{mount:o}=t;return t.mount=n=>{const s=Rm(n);if(!s)return;const r=t._component;!Q(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";const i=o(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function Rm(e){return Ae(e)?document.querySelector(e):e}const Hm="modulepreload",Mm=function(e,t){return new URL(e,t).href},bd={},vd=function(t,o,n){return!o||o.length===0?t():Promise.all(o.map(s=>{if(s=Mm(s,n),s in bd)return;bd[s]=!0;const r=s.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${i}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":Hm,r||(a.as="script",a.crossOrigin=""),a.href=s,document.head.appendChild(a),r)return new Promise((l,d)=>{a.addEventListener("load",l),a.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())};function Fm(e){return{all:e=e||new Map,on:function(t,o){var n=e.get(t);n?n.push(o):e.set(t,[o])},off:function(t,o){var n=e.get(t);n&&(o?n.splice(n.indexOf(o)>>>0,1):e.set(t,[]))},emit:function(t,o){var n=e.get(t);n&&n.slice().map(function(s){s(o)}),(n=e.get("*"))&&n.slice().map(function(s){s(t,o)})}}}var Nm=Object.defineProperty,Lm=(e,t,o)=>t in e?Nm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ie=(e,t,o)=>(Lm(e,typeof t!="symbol"?t+"":t,o),o);const Zr=Fm(),fe={fire(e){Zr.emit(e.kind,e)},subscribe(e,t){Zr.on(e.kind,t)},unsubscribe(e,t){Zr.off(e.kind,t)}};class Zs{constructor(t){this.path=t,Ie(this,"kind","AssetFailureEvent")}}Ie(Zs,"kind","AssetFailureEvent");class Vl{constructor(t){this.message=t,Ie(this,"kind","FailureEvent")}}Ie(Vl,"kind","FailureEvent");class uf{constructor(t){this.error=t,Ie(this,"kind","CustomAssetFailureEvent")}}Ie(uf,"kind","CustomAssetFailureEvent");class _r{constructor(){Ie(this,"kind","InvalidateRenderEvent")}}Ie(_r,"kind","InvalidateRenderEvent");const ff=class{constructor(){Ie(this,"kind",ff.kind)}};let Wl=ff;Ie(Wl,"kind","RenderUpdatedEvent");const pf=class{constructor(){Ie(this,"kind",pf.kind)}};let zl=pf;Ie(zl,"kind","StateLoadingEvent");class lt{constructor(t){this.message=t,Ie(this,"kind","ShowMessageEvent")}}Ie(lt,"kind","ShowMessageEvent");class Ul{constructor(t,o){this.message=t,this.actions=o,Ie(this,"kind","ResolvableErrorEvent")}}Ie(Ul,"kind","ResolvableErrorEvent");class Qs{constructor(t){this.color=t,Ie(this,"kind","ColorPickedEvent")}}Ie(Qs,"kind","ColorPickedEvent");class hf{constructor(t,o){this.error=t,this.info=o,Ie(this,"kind","VueErrorEvent")}}Ie(hf,"kind","VueErrorEvent");var Vm=Object.defineProperty,Wm=(e,t,o)=>t in e?Vm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,yd=(e,t,o)=>(Wm(e,typeof t!="symbol"?t+"":t,o),o);class Hi{constructor(){yd(this,"width",0),yd(this,"height",0)}paintOnto(t){}}var zm=Object.defineProperty,Um=Object.defineProperties,Gm=Object.getOwnPropertyDescriptors,_d=Object.getOwnPropertySymbols,qm=Object.prototype.hasOwnProperty,Xm=Object.prototype.propertyIsEnumerable,Mi=(e,t,o)=>t in e?zm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,En=(e,t)=>{for(var o in t||(t={}))qm.call(t,o)&&Mi(e,o,t[o]);if(_d)for(var o of _d(t))Xm.call(t,o)&&Mi(e,o,t[o]);return e},Km=(e,t)=>Um(e,Gm(t)),ao=(e,t,o)=>(Mi(e,typeof t!="symbol"?t+"":t,o),o),Bn=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Ym="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",it=class{constructor(e,t,o){this.$store=o,ao(this,"onlineRepo"),ao(this,"localRepo"),ao(this,"tempRepo",Ut({authors:{},packs:[]})),ao(this,"combinedList"),ao(this,"authors"),window.repo=this,e||(e={authors:{},packs:[]},fe.fire(new lt("Couldn't load remote repository."))),t||(t={authors:{},packs:[]},X.supports.localRepo&&fe.fire(new lt("Couldn't load local repository."))),this.onlineRepo=sn(e),this.localRepo=sn(t),this.combinedList=ki(()=>{var n,s;const r=this.onlineRepo.value,i=(n=r==null?void 0:r.packs)!=null?n:[],a=new Map(i.map($=>[$.id,$])),l=this.localRepo.value,d=(s=l==null?void 0:l.packs)!=null?s:[],c=new Map(d.map($=>[$.id,$])),p=this.tempRepo.packs,b=new Map(p.map($=>[$.id,$])),v=new Set(X.state.autoAdd),C=this.$store.state.content.contentPacks.map($=>$.packId).filter($=>$!=null),B=new Set(C),D=new Set;return[...C,...d.map($=>$.id),...i.map($=>$.id),...p.map($=>$.id)].filter($=>$.startsWith("dddg.buildin.")||$.startsWith("dddg.uploads.")||$.startsWith("dddg.desktop.")||$==="concept_femc.shido_draws.edave64"||$==="mc.storm_blaze.edave64"||D.has($)?!1:(D.add($),!0)).map($=>{var H,j,J;return Km(En(En(En({},(H=a.get($))!=null?H:{characters:[],kind:[],authors:[]}),(j=c.get($))!=null?j:{}),(J=b.get($))!=null?J:{}),{autoloading:v.has($),installed:c.has($),online:a.has($)||b.has($),loaded:B.has($)})})}),this.authors=ki(()=>{var n,s;const r=this.onlineRepo.value,i=(n=r==null?void 0:r.authors)!=null?n:{},a=this.localRepo.value,l=(s=a==null?void 0:a.authors)!=null?s:{};return En(En({},i),l)}),Object.freeze(this)}static getInstance(){return it.instance||(it.instance=this.createInstance()),it.instance}static createInstance(){return Bn(this,null,function*(){const e=it.loadRepo(Ym),t=X.supports.localRepo?yield it.loadRepo(X.localRepositoryUrl):null,[o,n,s]=yield Promise.all([e,t,it.$store]);return new it(o,n,s)})}static loadRepo(e){return Bn(this,null,function*(){try{const[t,o]=yield Promise.all([it.fetchJSON(e+"repo.json"),it.fetchJSON(e+"people.json")]);return{packs:t,authors:o}}catch(t){return null}})}static fetchJSON(e){return Bn(this,null,function*(){const t=yield fetch(e);if(!t.ok)throw new Error("Could not load json");return yield t.json()})}reloadLocalRepo(){return Bn(this,null,function*(){this.localRepo.value=X.supports.localRepo?yield it.loadRepo(X.localRepositoryUrl):null})}getPacks(){return this.combinedList.value}hasPack(e,t=!1){var o;return t?!!((o=this.onlineRepo.value)!=null&&o.packs.find(n=>n.id===e)):!!this.getPacks().find(n=>n.id===e)}getPack(e){var t;return(t=this.getPacks().find(o=>o.id===e))!=null?t:null}getAuthor(e){return this.authors.value[e]||null}getAuthors(){return this.authors.value}loadTempPack(e){return Bn(this,null,function*(){const t=fetch(e);let o;try{o=yield t}catch(r){throw new Error(`Failed to load '${e}'`)}let n;try{n=yield o.json()}catch(r){throw new Error(`The contents of '${e}' is not a valid JSON: ${r.message}`)}if(!n.pack)throw new Error(`The json file '${e}' does not contain any packages`);if(n.authors)for(const r in n.authors)this.tempRepo.authors[r]&&(this.tempRepo.authors[r]=n.authors[r]);const s=n.pack;return s.repoUrl=e,this.tempRepo.packs.find(r=>r.id===s.id)||this.tempRepo.packs.push(s),s.id})}};let Gt=it;ao(Gt,"instance");ao(Gt,"setStore");ao(Gt,"$store",new Promise((e,t)=>{it.setStore=e}));var Jm=Object.defineProperty,wd=Object.getOwnPropertySymbols,Zm=Object.prototype.hasOwnProperty,Qm=Object.prototype.propertyIsEnumerable,Fi=(e,t,o)=>t in e?Jm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ni=(e,t)=>{for(var o in t||(t={}))Zm.call(t,o)&&Fi(e,o,t[o]);if(wd)for(var o of wd(t))Qm.call(t,o)&&Fi(e,o,t[o]);return e},gt=(e,t,o)=>(Fi(e,typeof t!="symbol"?t+"":t,o),o),Te=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const er=navigator.userAgent,eb=!!er.match(/iPad/i)||!!er.match(/iPhone/i),tb=!!er.match(/WebKit/i),$d=eb&&tb&&!er.match(/CriOS/i);class gf{constructor(){gt(this,"state",Ut({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder"})),gt(this,"supports"),gt(this,"_gameMode",null),gt(this,"vuexHistory",null),gt(this,"$store",null),gt(this,"isSavingEnabled",sn(!1)),gt(this,"localRepositoryUrl",""),gt(this,"loading"),gt(this,"creatingDB"),gt(this,"loadingContentPacksAllowed"),gt(this,"loadContentPacks");const t=this,o=Ee.canSave();window.addEventListener("beforeunload",function(n){n.preventDefault(),n.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise((n,s)=>{this.loadContentPacks=()=>n()}),this.supports=Ut({optionalSaving:o,get autoLoading(){return o&&t.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!$d,allowWebP:!0,limitedCanvasSpace:$d}),o?this.loading=(()=>Te(this,null,function*(){this.savingEnabled=yield Ee.doesDbExists()}))():this.loading=Promise.resolve(),this.loading.then(()=>Te(this,null,function*(){var n;if(yield this.loadingContentPacksAllowed,this.creatingDB&&(yield this.creatingDB),this.savingEnabled){const s=(n=yield Ee.loadAutoload())!=null?n:[];this.state.autoAdd=s;const r=yield Gt.getInstance(),i=yield Promise.all(s.map(a=>Te(this,null,function*(){var l;const[d,c]=a.split(";",2);c!=null&&!r.hasPack(d)&&(yield r.loadTempPack(c));const f=r.getPack(d);return(l=f.dddg2Path)!=null?l:f.dddg1Path})));yield this.vuexHistory.transaction(()=>Te(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",i)}))}}))}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(t){t?(localStorage.setItem("saving","true"),this.creatingDB=Ee.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=Ee.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}loadGameMode(){return Te(this,null,function*(){const o=new URLSearchParams(location.search).get("mode");if(o==="ddlc"||o==="ddlc_plus"){this._gameMode=o;return}yield this.loading,yield this.creatingDB;let n="";this.isSavingEnabled.value&&(n=yield Ee.loadGameMode());let s="ddlc";(n==="ddlc"||n==="ddlc_plus")&&(s=n),this._gameMode=s})}setGameMode(t){return Te(this,null,function*(){this.isSavingEnabled.value&&(yield Ee.saveGameMode(t));const o=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${o}?mode=${t}`})}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(t){throw new Error("Method not implemented.")}connectToStore(t,o){this.vuexHistory=t,this.$store=o}saveToFile(t,o,n="image/png",s=1){return Te(this,null,function*(){const r=document.createElement("a");r.setAttribute("download",o);const i=yield this.createObjectURL(t,n,s);return r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),i})}localRepoInstall(t,o,n){throw new Error("This environment does not support a local repository")}localRepoUninstall(t){throw new Error("This environment does not support a local repository")}autoLoadAdd(t){return Te(this,null,function*(){yield this.loading,yield this.creatingDB,yield Ee.saveAutoload([...this.state.autoAdd,t]),this.state.autoAdd.push(t)})}autoLoadRemove(t){return Te(this,null,function*(){yield this.loading,yield this.creatingDB;const o=this.normalizePackId(t);yield Ee.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=o));const n=this.state.autoAdd.indexOf(t);this.state.autoAdd.splice(n,1)})}normalizePackId(t){const o=t.split(";");return o.length===1?o[0]:o[o.length-1]}loadSettings(){return Te(this,null,function*(){yield this.loading,yield this.creatingDB;const t={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?Ni(Ni({},t),yield Ee.loadSettings()):t})}saveSettings(t){return Te(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield Ee.saveSettings(t))})}isInitialized(){return Te(this,null,function*(){yield this.loading,yield this.creatingDB})}prompt(t,o){return new Promise((n,s)=>{n(prompt(t,o))})}onPanelChange(t){}createObjectURL(t,o,n){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(t.toDataURL(o,n));if(t.toBlob!=null)t.toBlob(a=>{if(!a){r();return}s(URL.createObjectURL(a))},o,n);else{const a=t.toDataURL(o,n),l=this.dataURItoBlob(a,o);s(URL.createObjectURL(l))}})}dataURItoBlob(t,o){const n=atob(t.split(",")[1]),s=n.length,r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=n.charCodeAt(i);return new Blob([r],{type:o})}}const Ee={indexedDB:(()=>{var e,t,o;try{return(o=(t=(e=window.indexedDB)!=null?e:window.mozIndexedDB)!=null?t:window.webkitIndexedDB)!=null?o:window.msIndexedDB}catch(n){return null}})(),transaction:(()=>{try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(e){return null}})(),db:null,canSave(){return!!(Ee.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return Ee.db?Ee.db:Ee.db=new Promise((e,t)=>{const o=Ee.indexedDB.open("dddg",3);o.onerror=n=>{t(n)},o.onupgradeneeded=n=>{var s;const r=n.target.result,i=(s=n.oldVersion)!=null?s:n.version;i<1&&r.createObjectStore("settings"),i===1&&(r.deleteObjectStore("settings"),r.createObjectStore("settings"))},o.onsuccess=n=>{e(o.result)}})},clearDB(){return new Promise((e,t)=>{if(!Ee.db){e();return}const o=Ee.indexedDB.deleteDatabase("dddg");Ee.db=null,o.onerror=n=>{t(n)},o.onsuccess=n=>{e()}})},loadAutoload(){return this.objectStorePromise("readonly",e=>Te(this,null,function*(){return yield this.reqPromise(e.get("autoload"))}))},saveAutoload(e){return this.objectStorePromise("readwrite",t=>Te(this,null,function*(){yield this.reqPromise(t.put([...e],"autoload"))}))},loadGameMode(){return this.objectStorePromise("readonly",e=>Te(this,null,function*(){return yield this.reqPromise(e.get("gameMode"))}))},saveGameMode(e){return this.objectStorePromise("readwrite",t=>Te(this,null,function*(){yield this.reqPromise(t.put(e,"gameMode"))}))},saveSettings(e){return this.objectStorePromise("readwrite",t=>Te(this,null,function*(){yield this.reqPromise(t.put(Ni({},e),"settings"))}))},loadSettings(){return this.objectStorePromise("readonly",e=>Te(this,null,function*(){return yield this.reqPromise(e.get("settings"))}))},objectStorePromise(e,t){return this.db?new Promise((o,n)=>Te(this,null,function*(){const r=(yield this.db).transaction(["settings"],e).objectStore("settings");try{o(yield t(r))}catch(i){n(i)}})):Promise.reject(new Error("No database"))},reqPromise(e){return new Promise((t,o)=>{e.onerror=n=>{o(n)},e.onsuccess=n=>{t(e.result)}})}};var ob=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class nb extends gf{saveToFile(t,o,n="image/png",s=1){return ob(this,null,function*(){let r=t.toDataURL(n,s);const i=this.dataURItoBlob(r,n);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,o),r})}}var sb=Object.defineProperty,rb=(e,t,o)=>t in e?sb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ze=(e,t,o)=>(rb(e,typeof t!="symbol"?t+"":t,o),o),we=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Cd={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};class ib{constructor(){Ze(this,"state",Ut({looseTextParsing:!0,autoAdd:[],downloadLocation:""})),Ze(this,"localRepositoryUrl","/repo/"),Ze(this,"_gameMode",null),Ze(this,"electron",window),Ze(this,"vuexHistory",null),Ze(this,"$store",null),Ze(this,"bgInvalidation",null),Ze(this,"pendingContentPacks",[]),Ze(this,"pendingContentPacksReplace",[]),Ze(this,"loadingContentPacksAllowed"),Ze(this,"loadContentPacks"),Ze(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1}),Ze(this,"savingEnabled",!0),this.loadingContentPacksAllowed=new Promise((o,n)=>{this.loadContentPacks=()=>o()}),this.electron.ipcRenderer.on("add-persistent-content-pack",o=>we(this,null,function*(){if(yield this.loadingContentPacksAllowed,!this.$store||!this.vuexHistory){this.pendingContentPacks.push(o);return}yield this.vuexHistory.transaction(()=>we(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",o)}))})),this.electron.ipcRenderer.on("add-persistent-background",o=>we(this,null,function*(){const n="persistentBg-"+o,s=o.split("/");yield yf(n,o),Cd.backgrounds.push({id:n,variants:[[n]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()})),this.electron.ipcRenderer.on("push-message",o=>we(this,null,function*(){fe.fire(new lt(o))})),this.electron.ipcRenderer.on("config.downloadFolderUpdate",o=>we(this,null,function*(){this.state.downloadLocation=o})),this.electron.ipcRenderer.onConversation("load-packs",o=>we(this,null,function*(){const n=yield Gt.getInstance(),s=yield Promise.all(o.map(r=>we(this,null,function*(){const[i,a]=r.split(";",2);a!=null&&!n.hasPack(i)&&(yield n.loadTempPack(a));const l=n.getPack(i);return l.dddg2Path||l.dddg1Path})));if(!this.$store||!this.vuexHistory){s.forEach(r=>this.pendingContentPacks.push(r));return}yield this.vuexHistory.transaction(()=>we(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",s)}))})),this.electron.ipcRenderer.onConversation("auto-load.changed",o=>we(this,null,function*(){this.state.autoAdd=o})),this.electron.ipcRenderer.onConversation("reload-repo",()=>we(this,null,function*(){yield(yield Gt.getInstance()).reloadLocalRepo()})),this.electron.ipcRenderer.onConversation("replace-pack",o=>we(this,null,function*(){const n={processed:!1,contentPack:o};!this.$store||!this.vuexHistory?this.pendingContentPacksReplace.push(n):yield this.vuexHistory.transaction(()=>we(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",n)}))})),this.electron.ipcRenderer.onConversation("resolvable-error",(o,n)=>new Promise((s,r)=>{fe.fire(new Ul(o,n.map(i=>({exec:()=>s(i),name:i}))))}));let t=!1;this.electron.ipcRenderer.on("update.progress",o=>{o==="done"?(t=!1,fe.fire(new lt("An update is ready and will be installed once DDDG closes."))):t||(t=!0,fe.fire(new lt("An update is ready and will be installed once DDDG closes.")))}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(t){this.electron.ipcRenderer.send("open-folder",t)}onPanelChange(t){}saveSettings(t){return we(this,null,function*(){var o;yield this.electron.ipcRenderer.sendConvo("config.set","nsfw",t.nsfw),yield this.electron.ipcRenderer.sendConvo("config.set","darkMode",(o=t.darkMode)!=null?o:void 0),yield this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",t.defaultCharacterTalkingZoom)})}loadGameMode(){return we(this,null,function*(){this._gameMode=(yield this.electron.ipcRenderer.sendConvo("config.get","gameMode"))||"ddlc"})}setGameMode(t){return we(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("config.set","gameMode",t),this.electron.ipcRenderer.send("reload")})}loadSettings(){return we(this,null,function*(){var t,o,n;return{lq:!1,nsfw:(t=yield this.electron.ipcRenderer.sendConvo("config.get","nsfw"))!=null?t:!1,darkMode:(o=yield this.electron.ipcRenderer.sendConvo("config.get","darkMode"))!=null?o:void 0,defaultCharacterTalkingZoom:(n=yield this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom"))!=null?n:void 0}})}localRepoInstall(t,o,n){return we(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.install",t,o,n)})}localRepoUninstall(t){return we(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.uninstall",t)})}autoLoadAdd(t){return we(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.add",t)})}autoLoadRemove(t){return we(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.remove",t)})}saveToFile(t,o,n="image/png",s=1){return new Promise((r,i)=>{t.toBlob(a=>we(this,null,function*(){if(!a){i();return}const l=yield a.arrayBuffer();yield this.electron.ipcRenderer.sendConvo("save-file",o,new Uint8Array(l)),r(URL.createObjectURL(a))}),n,s)})}prompt(t,o){return we(this,null,function*(){return yield this.electron.ipcRenderer.sendConvo("show-prompt",t,o)})}connectToStore(t,o){this.vuexHistory=t,this.$store=o,this.invalidateInstalledBGs(),this.vuexHistory.transaction(()=>we(this,null,function*(){if(this.pendingContentPacks.length>0&&(yield this.$store.dispatch("content/loadContentPacks",this.pendingContentPacks)),this.pendingContentPacksReplace.length>0)for(const n of this.pendingContentPacksReplace)yield this.$store.dispatch("content/replaceContentPack",n)}))}invalidateInstalledBGs(){!this.vuexHistory||!this.$store||this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),!(!this.vuexHistory||!this.$store)&&this.vuexHistory.transaction(()=>we(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",{contentPack:Cd})}))}}function lb(){return window.isElectron?new ib:"msSaveOrOpenBlob"in window.navigator?new nb:new gf}const X=lb();window.toast=X;var ab=Object.defineProperty,Pd=Object.getOwnPropertySymbols,db=Object.prototype.hasOwnProperty,cb=Object.prototype.propertyIsEnumerable,Li=(e,t,o)=>t in e?ab(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,kd=(e,t)=>{for(var o in t||(t={}))db.call(t,o)&&Li(e,o,t[o]);if(Pd)for(var o of Pd(t))cb.call(t,o)&&Li(e,o,t[o]);return e},Sd=(e,t,o)=>(Li(e,typeof t!="symbol"?t+"":t,o),o);class mf{constructor(t){this.html=t,Sd(this,"width"),Sd(this,"height"),this.width=t.width,this.height=t.height}paintOnto(t,o={}){const{w:n,h:s}=kd({w:this.width,h:this.height},o),{x:r,y:i}=kd({x:-n/2,y:-s/2},o);t.drawImage(this.html,r,i,n,s)}}var ub=Object.defineProperty,fb=(e,t,o)=>t in e?ub(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,bf=(e,t,o)=>(fb(e,typeof t!="symbol"?t+"":t,o),o),ns=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});let Qr;function Bo(){if(Qr)return Qr;if(!X.supports.allowWebP)return Promise.resolve(!1);const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",t="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return Qr=(()=>ns(this,null,function*(){const o=yield Promise.all([Od(e,1,2),Od(t,720,1280)]);return o[0]&&o[1]}))()}function Od(e,t,o){return new Promise((n,s)=>{const r=document.createElement("img");r.addEventListener("load",()=>{n(r.width===o&&r.height===t)}),r.addEventListener("error",()=>{n(!1)}),r.src=e})}let ei;function pb(){return ei||(ei=new Promise((e,t)=>{const o="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",n=document.createElement("img");n.addEventListener("load",()=>{console.log("Heif no error. "+(n.width===2&&n.height===1)),e(n.width===2&&n.height===1)}),n.addEventListener("error",()=>{console.log("Heif not supported"),e(!1)}),n.src=o}))}class hb{constructor(){bf(this,"cache",new Map)}get(t){const o=this.cache.get(t);if(o)return o;const n=Vi(t);return this.cache.set(t,n),n}remove(t){this.cache.delete(t)}}class gb{constructor(){bf(this,"cache",new Map)}get(t){var o;const n=(o=this.cache.get(t))==null?void 0:o.deref();if(n)return n;const s=bb(t);return this.cache.set(t,new WeakRef(s)),s}remove(t){this.cache.delete(t)}}let ti=null;function tr(){return ti||(window.assetCache=ti=X.supports.assetCaching||typeof WeakRef=="undefined"?new hb:new gb)}const Ao={};function wr(e,t=!0){return vf(X.supports.lq&&!t?e.lq:e.hq)}function Gl(e,t=!0){const o=X.supports.lq&&!t?e.lq:e.hq;return Ao[o]?Ao[o]:o}function vf(e){return Ao[e]&&(e=Ao[e]),tr().get(e)}const Fe="./";function rn(e,t=!0){return ns(this,null,function*(){const o=`${Fe}assets/${e}${t?"":".lq"}${(yield Bo())?".webp":".png"}`.replace(/\/+/,"/");return yield tr().get(o)})}function mb(e,t=!0){return ns(this,null,function*(){return`${Fe}assets/${e}${X.supports.lq&&!t?".lq":""}${(yield Bo())?".webp":".png"}`.replace(/\/+/,"/")})}function yf(e,t){Ao[e]=t}function bb(e){return ns(this,null,function*(){const t=!!Ao[e];return t&&(e=Ao[e]),(()=>ns(this,null,function*(){try{return yield Vi(e)}catch(o){if(e.endsWith(".webp")&&!t)try{return yield Vi(e.replace(/\.webp$/,".png"))}catch(n){return fe.fire(new Zs(e)),tr().remove(e),new Hi}else return fe.fire(new Zs(e)),tr().remove(e),new Hi}}))()})}function Vi(e){return new Promise((t,o)=>{const n=new Image;n.addEventListener("load",()=>{t(new mf(n)),X.supports.assetCaching||document.body.removeChild(n)}),n.addEventListener("error",s=>{o(new Error(`Failed to load image ${e}`)),X.supports.assetCaching||document.body.removeChild(n)}),n.crossOrigin="Anonymous",n.src=e,n.style.display="none",document.body.appendChild(n)})}const vb=oe({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},checkbox(){return this.$refs.checkbox}}});const ne=(e,t)=>{const o=e.__vccOpts||e;for(const[n,s]of t)o[n]=s;return o},yb={class:"toggle_box"},_b=["id"],wb=["for"],$b=["for"];function Cb(e,t,o,n,s,r){return m(),_("div",yb,[ae(u("input",{id:e._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":t[0]||(t[0]=i=>e.value=i)},null,8,_b),[[jm,e.value]]),u("label",{for:e._.uid,class:"switch"},null,8,wb),u("label",{for:e._.uid,class:"toggle_label"},pe(e.label),9,$b)])}const Et=ne(vb,[["render",Cb]]),ql={methods:{verticalScrollRedirect(e){if(e.type!=="wheel"||!e.currentTarget)return;const t=e.currentTarget,o=getComputedStyle(t),n=e;if(n.deltaY===0)return;if(o.overflowY==="auto"){if(n.deltaY>0){if(t.scrollHeight>t.scrollTop+t.clientHeight){e.stopPropagation();return}}else if(t.scrollTop>0){e.stopPropagation();return}}const s=t.scrollLeft;t.scrollLeft+=n.deltaY,t.scrollLeft!==s&&e.stopPropagation()}}},ut={mixins:[ql],computed:{vertical(){return this.$store.state.ui.vertical}},mounted(){this.updateVertical(),this.$el.addEventListener("wheel",e=>{this.vertical||this.verticalScrollRedirect(e)},{passive:!0})},methods:{updateVertical(){!this.$el||(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical(){this.updateVertical()}}},Pb=window.HTMLDialogElement!=null,kb=oe({props:{noBaseSize:Boolean,options:{type:Array,default:[]}},computed:{nativeDialogs(){return Pb}},methods:{open(){if(this.nativeDialogs){const e=this.$refs.dialog;e&&!e.open&&e.showModal()}window.addEventListener("click",this.clickSomewhere)},close(){if(this.nativeDialogs){const e=this.$refs.dialog;e&&e.open&&e.close(),this.$emit("leave")}window.removeEventListener("click",this.clickSomewhere)},clickSomewhere(e){const t=this.$refs.dialog;t&&t.open?e.target===t&&(this.close(),e.preventDefault(),e.stopPropagation()):window.removeEventListener("click",this.clickSomewhere)}},mounted(){this.open()},activated(){this.open()},deactivated(){this.close()},unmounted(){this.close()}});const Sb={key:0,id:"submit-options"},Ob=["onClick"],xb={key:0,id:"submit-options"},jb=["onClick"];function Ib(e,t,o,n,s,r){return e.nativeDialogs?(m(),_("dialog",{key:0,ref:"dialog",class:le(["native",{"base-size":!e.noBaseSize}]),onCancel:t[0]||(t[0]=(...i)=>e.close&&e.close(...i))},[Wt(e.$slots,"default",{},void 0,!0),e.options.length>0?(m(),_("div",Sb,[(m(!0),_(N,null,$e(e.options,i=>(m(),_("button",{key:i,class:"option",onClick:a=>e.$emit("option",i)},pe(i),9,Ob))),128))])):q("",!0)],34)):(m(),_("div",{key:1,class:"dialog-wrapper",onClick:t[2]||(t[2]=i=>e.$emit("leave"))},[u("dialog",{ref:"dialog",open:"",class:le({"base-size":!e.noBaseSize}),onClick:t[1]||(t[1]=G(()=>{},["stop"]))},[Wt(e.$slots,"default",{},void 0,!0),e.options.length>0?(m(),_("div",xb,[(m(!0),_(N,null,$e(e.options,i=>(m(),_("button",{key:i,class:"option",onClick:a=>e.$emit("option",i)},pe(i),9,jb))),128))])):q("",!0)],2)]))}const Xl=ne(kb,[["render",Ib],["__scopeId","data-v-08c9e0d0"]]),Tb=oe({mixins:[ql],props:{to:{type:String,required:!0}},computed:{href(){let e=this.to;return e=e.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),e=e.replace(/^wiki:\/\/(.*)/,(t,o)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+o.replaceAll(" ","-")),e}}}),Eb=["href"];function Bb(e,t,o,n,s,r){return m(),_("a",{target:"_blank",rel:"noopener noreferrer",href:e.href},[Wt(e.$slots,"default")],8,Eb)}const Kl=ne(Tb,[["render",Bb]]);var Ab=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});function Wi(e,t){return Ab(this,null,function*(){try{yield t()}catch(o){console.error("Error in promise",e,o),fe.fire(new Vl("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+e+'", '+Db(o)))}})}function Db(e){if(e instanceof Error){if(e.stack!=null){const t=e.stack.split(`
`);return t[0].includes(e.name)&&t[0].includes(e.message)?t[0]+`
<br />`+t[1]:e.name+": "+e.message+`
<br />`+t[0]}return e.name+": "+e.message}return e instanceof Object?JSON.stringify(e):""+e}var An=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Rb=oe({mixins:[ut],components:{Toggle:Et,ModalDialog:Xl,L:Kl},data:()=>({allowSavesModal:!1,denySavesModal:!1,waitOnSaveChange:!1,showModeDialog:!1}),computed:{savesAllowed:{get(){return X.savingEnabled},set(e){this.waitOnSaveChange=!0,X.savingEnabled=e,this.saveSettings()}},inPlusMode(){return X.gameMode==="ddlc_plus"},savesEnabledInEnv(){return X.supports.optionalSaving},lqAllowed(){return X.supports.lq},looseTextParsing:{get(){return X.state.looseTextParsing},set(e){X.state.looseTextParsing=e,this.saveSettings()}},lqRendering:{get(){return this.$store.state.ui.lqRendering},set(e){this.vuexHistory.transaction(()=>An(this,null,function*(){yield this.$store.commit("ui/setLqRendering",e)})),this.saveSettings()}},nsfw:{get(){return!!this.$store.state.ui.nsfw},set(e){this.vuexHistory.transaction(()=>An(this,null,function*(){yield this.$store.commit("ui/setNsfw",e),this.saveSettings()}))}},defaultCharacterTalkingZoom:{get(){return!!this.$store.state.ui.defaultCharacterTalkingZoom},set(e){this.vuexHistory.transaction(()=>An(this,null,function*(){yield this.$store.commit("ui/setDefaultCharacterTalkingZoom",e),this.saveSettings()}))}},theme:{get(){return this.$store.state.ui.useDarkTheme},set(e){this.vuexHistory.transaction(()=>An(this,null,function*(){yield this.$store.commit("ui/setDarkTheme",e),this.saveSettings()}))}},showDownloadFolder(){return X.supports.setDownloadFolder},downloadFolder(){return X.state.downloadLocation}},watch:{savesAllowed(){this.waitOnSaveChange=!1}},methods:{allowSaves(e){this.allowSavesModal=!1,e==="Allow"&&(this.savesAllowed=!0)},denySaves(e){this.denySavesModal=!1,e==="Deny"&&(this.savesAllowed=!1)},modeChange(e){Wi("changing modes",()=>An(this,null,function*(){e==="Enter Classic Mode"?yield X.setGameMode("ddlc"):e==="Enter Plus mode"?yield X.setGameMode("ddlc_plus"):this.showModeDialog=!1}))},saveSettings(){var e;X.saveSettings({lq:this.$store.state.ui.lqRendering,nsfw:this.$store.state.ui.nsfw,darkMode:(e=this.$store.state.ui.useDarkTheme)!=null?e:void 0,looseTextParsing:X.state.looseTextParsing,defaultCharacterTalkingZoom:this.$store.state.ui.defaultCharacterTalkingZoom})},setDownloadFolder(){X.updateDownloadFolder()},openDownloadFolder(){X.openFolder("downloads")}}});const ft=e=>(Ne("data-v-b2e4e2eb"),e=e(),Le(),e),Hb={class:"panel"},Mb=ft(()=>u("h1",null,"Settings",-1)),Fb={class:"modal-scroll-area"},Nb=ft(()=>u("p",null,"Do you want to allow DDDG to save settings on your device?",-1)),Lb=ft(()=>u("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),Vb=ft(()=>u("p",null,"You can revoke this permission at any time.",-1)),Wb=O(" Our usual "),zb=O("privacy policy"),Ub=O(" still applies. "),Gb={class:"modal-scroll-area"},qb=ft(()=>u("p",null,"Do you want to deny DDDG from saving settings on your device?",-1)),Xb=ft(()=>u("p",null," This will cause all your settings to reset when leaving the page. ",-1)),Kb=O(" Our usual "),Yb=O("privacy policy"),Jb=O(" still applies. "),Zb=ft(()=>u("div",{class:"modal-scroll-area"},[u("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)),Qb={key:0,disabled:""},ev=O(" Enter Classic Mode "),tv=O(" Enter DDLC Plus Mode "),ov=ft(()=>u("td",null,[u("label",null,"Theme:")],-1)),nv=ft(()=>u("option",{value:null},"System",-1)),sv=ft(()=>u("option",{value:!1},"Light",-1)),rv=ft(()=>u("option",{value:!0},"Dark",-1)),iv=[nv,sv,rv],lv={key:4,class:"downloadTable"},av=ft(()=>u("td",null,[u("label",null,"Download folder:")],-1));function dv(e,t,o,n,s,r){const i=A("l"),a=A("modal-dialog"),l=A("toggle");return m(),_("div",Hb,[Mb,(m(),W(Wu,{to:"#modal-messages"},[e.allowSavesModal?(m(),W(a,{key:0,options:["Allow","Deny"],onLeave:t[0]||(t[0]=d=>e.allowSaves("Deny")),onOption:e.allowSaves,"no-base-size":""},{default:T(()=>[u("div",Fb,[Nb,Lb,Vb,u("p",null,[Wb,w(i,{to:"wiki://Privacy Statement"},{default:T(()=>[zb]),_:1}),Ub])])]),_:1},8,["onOption"])):q("",!0),e.denySavesModal?(m(),W(a,{key:1,options:["Deny","Cancle"],onLeave:t[1]||(t[1]=d=>e.denySaves("Cancle")),onOption:e.denySaves,"no-base-size":""},{default:T(()=>[u("div",Gb,[qb,Xb,u("p",null,[Kb,w(i,{to:"wiki://Privacy Statement"},{default:T(()=>[Yb]),_:1}),Jb])])]),_:1},8,["onOption"])):q("",!0),e.showModeDialog?(m(),W(a,{key:2,options:[e.inPlusMode?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:t[2]||(t[2]=d=>e.showModeDialog=!1),onOption:e.modeChange,"no-base-size":""},{default:T(()=>[Zb]),_:1},8,["options","onOption"])):q("",!0)])),e.waitOnSaveChange?(m(),_("button",Qb,"Applying...")):!e.savesAllowed&&e.savesEnabledInEnv?(m(),_("button",{key:1,onClick:t[3]||(t[3]=d=>e.allowSavesModal=!0)}," Allow saving options ")):e.savesAllowed&&e.savesEnabledInEnv?(m(),_("button",{key:2,onClick:t[4]||(t[4]=d=>e.denySavesModal=!0)}," Deny saving options ")):q("",!0),u("button",{onClick:t[5]||(t[5]=d=>e.showModeDialog=!0)},[e.inPlusMode?(m(),_(N,{key:0},[ev],64)):(m(),_(N,{key:1},[tv],64))]),e.lqAllowed?(m(),W(l,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:e.lqRendering,"onUpdate:modelValue":t[6]||(t[6]=d=>e.lqRendering=d)},null,8,["modelValue"])):q("",!0),w(l,{label:"NSFW Mode?",modelValue:e.nsfw,"onUpdate:modelValue":t[7]||(t[7]=d=>e.nsfw=d)},null,8,["modelValue"]),w(l,{label:"Enlarge talking objects? (Default value)",modelValue:e.defaultCharacterTalkingZoom,"onUpdate:modelValue":t[8]||(t[8]=d=>e.defaultCharacterTalkingZoom=d)},null,8,["modelValue"]),w(l,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:e.looseTextParsing,"onUpdate:modelValue":t[9]||(t[9]=d=>e.looseTextParsing=d)},null,8,["modelValue"]),u("table",null,[u("tr",null,[ov,u("td",null,[ae(u("select",{"onUpdate:modelValue":t[10]||(t[10]=d=>e.theme=d)},iv,512),[[yt,e.theme]])])])]),e.showDownloadFolder?(m(),_("table",lv,[u("tr",null,[av,u("td",null,pe(e.downloadFolder),1),u("td",null,[u("button",{onClick:t[11]||(t[11]=(...d)=>e.setDownloadFolder&&e.setDownloadFolder(...d))},"Set"),u("button",{onClick:t[12]||(t[12]=(...d)=>e.openDownloadFolder&&e.openDownloadFolder(...d))},"Open")])])])):q("",!0)])}const cv=ne(Rb,[["render",dv],["__scopeId","data-v-b2e4e2eb"]]),uv=oe({computed:{vertical(){return this.$store.state.ui.vertical}},data:()=>({visible:!1}),methods:{show(){this.visible=!0},hide(){this.visible=!1},drop(e){if(this.hide(),e.stopPropagation(),e.preventDefault(),!!e.dataTransfer)for(const t of e.dataTransfer.items)t.kind==="file"&&t.type.match(/image.*/)&&this.$emit("drop",t.getAsFile())}}});function fv(e,t,o,n,s,r){return e.visible?(m(),_("div",{key:0,onDragleave:t[0]||(t[0]=i=>e.visible=!1),onDrop:t[1]||(t[1]=(...i)=>e.drop&&e.drop(...i)),class:le({vertical:e.vertical})},[Wt(e.$slots,"default",{},void 0,!0)],34)):q("",!0)}const _f=ne(uv,[["render",fv],["__scopeId","data-v-5791e53c"]]),pv=oe({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},shortcut:{type:String,default:null}},computed:{showPopup(){return this.shortcut!=null&&!this.shortcut.startsWith("!")},popupText(){const e=this.shortcut;return e==null?"":e.startsWith("!")?e.substring(1):e}}});const hv=["disabled"],gv={class:"material-icons","aria-hidden":"true"},mv={class:"content"},bv={key:0,class:"shortcut-popup"};function vv(e,t,o,n,s,r){return m(),_("button",{class:le([e.iconPos]),disabled:e.disabled},[u("div",gv,pe(e.icon),1),u("div",mv,[Wt(e.$slots,"default",{},void 0,!0)]),e.showPopup?(m(),_("div",bv,pe(e.popupText),1)):q("",!0)],10,hv)}const $r=ne(pv,[["render",vv],["__scopeId","data-v-69c1c73b"]]);var yv=Object.defineProperty,_v=Object.defineProperties,wv=Object.getOwnPropertyDescriptors,xd=Object.getOwnPropertySymbols,$v=Object.prototype.hasOwnProperty,Cv=Object.prototype.propertyIsEnumerable,jd=(e,t,o)=>t in e?yv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Pv=(e,t)=>{for(var o in t||(t={}))$v.call(t,o)&&jd(e,o,t[o]);if(xd)for(var o of xd(t))Cv.call(t,o)&&jd(e,o,t[o]);return e},kv=(e,t)=>_v(e,wv(t)),We=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Id={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},Sv=oe({mixins:[ut],components:{DropTarget:_f,DButton:$r},data:()=>({isWebPSupported:null,customAssetCount:0,group:"characters"}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},characters(){return this.$store.state.content.current.characters},sprites(){return this.$store.state.content.current.sprites},hasClipboardContent(){return this.$store.state.ui.clipboard!=null},showSpritesFolder(){return X.supports.openableFolders.has("sprites")}},methods:{assetSpriteBackground(e){return e.variants[0].map(t=>`url('${Gl(t,!1)}')`).join(",")},assetPath(e){return e.chibi?X.supports.lq?e.chibi.lq:e.chibi.hq:""},showDropTarget(e){!e.dataTransfer||(e.dataTransfer.effectAllowed="none",Array.from(e.dataTransfer.items).find(t=>t.type.match(/^image.*$/))&&(e.dataTransfer.effectAllowed="link",this.group==="sprites"&&this.$refs.spriteDt.show()))},hideDropTarget(){this.group==="sprites"&&this.$refs.spriteDt.hide()},onSpriteFileUpload(){const e=this.$refs.spriteUpload;if(!!e.files)for(const t of e.files)this.addCustomSpriteFile(t)},uploadFromURL(){return We(this,null,function*(){const e=prompt("Enter the URL of the image");if(e==null)return;const t=e.split("/").slice(-1)[0];yield this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.addNewCustomSprite(t,e)}))})},addSpriteToScene(e){return We(this,null,function*(){yield this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createSprite",{panelId:this.currentPanel.id,assets:e.variants[0]})}))})},addTextBox(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createTextBox",{panelId:this.currentPanel.id})}))},addChoice(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createChoice",{panelId:this.currentPanel.id})}))},addDialog(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createNotification",{panelId:this.currentPanel.id})}))},addPoem(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createPoem",{panelId:this.currentPanel.id})}))},addConsole(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createConsole",{panelId:this.currentPanel.id})}))},paste(){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/pasteObjectFromClipboard",{panelId:this.currentPanel.id})}))},onChosen(e){this.vuexHistory.transaction(()=>We(this,null,function*(){yield this.$store.dispatch("panels/createCharacters",{characterType:e,panelId:this.currentPanel.id})}))},addCustomSpriteFile(e){return We(this,null,function*(){yield this.vuexHistory.transaction(()=>We(this,null,function*(){const t=URL.createObjectURL(e),o=yield this.$store.dispatch("uploadUrls/add",{name:e.name,url:t});yield this.addNewCustomSprite(e.name,o)}))})},addNewCustomSprite(e,t){return We(this,null,function*(){const o=this.$store.state.content.contentPacks.find(s=>s.packId===Id.packId)||Id,n=kv(Pv({},o),{sprites:[...o.sprites,{id:t,label:e,variants:[[t]],defaultScale:[1,1],hd:null}]});yield this.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!1})})},openSpritesFolder(){X.openFolder("sprites")}},created(){return We(this,null,function*(){this.isWebPSupported=yield Bo()})}});const Ov=e=>(Ne("data-v-24e67e76"),e=e(),Le(),e),xv=O("Drop here to add as a new sprite "),jv=Ov(()=>u("h1",null,"Add",-1)),Iv=O(" Char\xADacters "),Tv=O(" Sprites "),Ev=O(" UI "),Bv=["title","onClick","onKeypress"],Av=["src","alt"],Dv=O(" Search in content packs "),Rv=["title","onClick","onKeypress"],Hv=O(" Upload new sprite "),Mv=O(" New sprite from URL "),Fv=O(" Search in content packs "),Nv=O(" Open sprites folder "),Lv=["disabled"];function Vv(e,t,o,n,s,r){const i=A("drop-target"),a=A("d-button");return e.isWebPSupported!==void 0?(m(),_("div",{key:0,class:"panel",onDragenter:t[13]||(t[13]=(...l)=>e.showDropTarget&&e.showDropTarget(...l)),onMouseleave:t[14]||(t[14]=(...l)=>e.hideDropTarget&&e.hideDropTarget(...l))},[w(i,{ref:"spriteDt",class:"drop-target",onDrop:e.addCustomSpriteFile},{default:T(()=>[xv]),_:1},8,["onDrop"]),jv,u("div",{class:le({"group-selector":!0,vertical:e.vertical})},[w(a,{class:le({active:e.group==="characters"}),"icon-pos":"top",icon:"emoji_people",onClick:t[0]||(t[0]=l=>e.group="characters")},{default:T(()=>[Iv]),_:1},8,["class"]),w(a,{class:le({active:e.group==="sprites"}),"icon-pos":"top",icon:"change_history",onClick:t[1]||(t[1]=l=>e.group="sprites")},{default:T(()=>[Tv]),_:1},8,["class"]),w(a,{class:le({active:e.group==="ui"}),"icon-pos":"top",icon:"view_quilt",onClick:t[2]||(t[2]=l=>e.group="ui")},{default:T(()=>[Ev]),_:1},8,["class"])],2),u("div",{class:le({"item-grid":!0,vertical:e.vertical})},[e.group==="characters"?(m(),_(N,{key:0},[(m(!0),_(N,null,$e(e.characters,l=>(m(),_("div",{class:"character",tabindex:"0",key:l.id,title:l.label,onClick:G(d=>e.onChosen(l.id.toLowerCase()),["left"]),onKeypress:[Ue(G(d=>e.onChosen(l.id.toLowerCase()),["prevent","stop"]),["enter"]),Ue(G(d=>e.onChosen(l.id.toLowerCase()),["prevent","stop"]),["space"])]},[u("img",{src:e.assetPath(l),alt:l.label},null,8,Av)],40,Bv))),128)),w(a,{class:"custom-sprite",icon:"extension",onClick:t[3]||(t[3]=l=>e.$emit("show-dialog","type: Characters"))},{default:T(()=>[Dv]),_:1})],64)):q("",!0),e.group==="sprites"?(m(),_(N,{key:1},[(m(!0),_(N,null,$e(e.sprites,l=>(m(),_("div",{class:"sprite",tabindex:"0",key:l.label,title:l.label,style:Re({background:e.assetSpriteBackground(l)}),onClick:d=>e.addSpriteToScene(l),onKeypress:[Ue(G(d=>e.addSpriteToScene(l),["prevent","stop"]),["enter"]),Ue(G(d=>e.addSpriteToScene(l),["prevent","stop"]),["space"])]},pe(l.label),45,Rv))),128)),w(a,{class:"custom-sprite",icon:"publish",onClick:t[5]||(t[5]=l=>e.$refs.spriteUpload.click())},{default:T(()=>[Hv,u("input",{type:"file",ref:"spriteUpload",onChange:t[4]||(t[4]=(...l)=>e.onSpriteFileUpload&&e.onSpriteFileUpload(...l))},null,544)]),_:1}),w(a,{icon:"insert_link",onClick:e.uploadFromURL},{default:T(()=>[Mv]),_:1},8,["onClick"]),w(a,{icon:"extension",onClick:t[6]||(t[6]=l=>e.$emit("show-dialog","type: Sprites"))},{default:T(()=>[Fv]),_:1}),e.showSpritesFolder?(m(),W(a,{key:0,icon:"folder",onClick:e.openSpritesFolder},{default:T(()=>[Nv]),_:1},8,["onClick"])):q("",!0)],64)):q("",!0),e.group==="ui"?(m(),_(N,{key:2},[u("button",{onClick:t[7]||(t[7]=(...l)=>e.addTextBox&&e.addTextBox(...l))},"Textbox"),u("button",{onClick:t[8]||(t[8]=(...l)=>e.addPoem&&e.addPoem(...l))},"Poem"),u("button",{onClick:t[9]||(t[9]=(...l)=>e.addDialog&&e.addDialog(...l))},"Notification"),u("button",{onClick:t[10]||(t[10]=(...l)=>e.addChoice&&e.addChoice(...l))},"Choice"),u("button",{onClick:t[11]||(t[11]=(...l)=>e.addConsole&&e.addConsole(...l))},"Console")],64)):q("",!0),u("button",{onClick:t[12]||(t[12]=(...l)=>e.paste&&e.paste(...l)),disabled:!e.hasClipboardContent},"Paste",8,Lv)],2)],32)):q("",!0)}const Wv=ne(Sv,[["render",Vv],["__scopeId","data-v-24e67e76"]]);function Nn(e,t,o){let n=t+o;const s=e.length;return n<0&&(n+=s),n>=s&&(n-=s),n}const Cr=1280,Yl=720,zv=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Uv=1,Gv=1/1.5,qv=-74,Xv=-26,Kv=[200,240,400,493,640,786,880,1040,1080],Yv=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:Cr,screenHeight:Yl,positions:zv,sdCharacterScaleFactor:Uv,hdCharacterScaleFactor:Gv,CloseUpYOffset:qv,BaseCharacterYPos:Xv,characterPositions:Kv},Symbol.toStringTag,{value:"Module"}));var Jv=Object.defineProperty,Zv=(e,t,o)=>t in e?Jv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Pr=(e,t,o)=>(Zv(e,typeof t!="symbol"?t+"":t,o),o);const Yo=class{constructor(e,t,o,n){this.r=e,this.g=t,this.b=o,this.a=n}static validCss(e){return this.validCssRgb(e)||this.validHex(e)}static fromCss(e){if(this.validCssRgb(e))return this.fromCssRgb(e);if(this.validHex(e))return this.fromHex(e);throw new Error("Invalid RGB color format")}static validCssRgb(e){return this.rgbEx.test(e)||this.rgbaEx.test(e)}static fromCssRgb(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");const t=e.slice(0,-1),o=t.indexOf("("),s=t.slice(o+1).split(",").map(r=>parseFloat(r.trim()));return new Yo(s[0],s[1],s[2],s.length===4?s[3]:1)}static validHex(e){return this.hexShortEx.test(e)||this.hexLongEx.test(e)}static fromHex(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");const t=e.slice(1);if(t.length===3)return new Yo(parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),1);if(t.length===4)return new Yo(parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)/255);if(t.length===6)return new Yo(parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16),1);if(t.length===8)return new Yo(parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16),parseInt(t[6]+t[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:e,g:t,b:o}=this;const{a:n}=this;e/=255,t/=255,o/=255;const s=Math.max(e,t,o),r=Math.min(e,t,o);let i,a;const l=(s+r)/2;if(s===r)i=a=0;else{const d=s-r;switch(a=l>.5?d/(2-s-r):d/(s+r),s){case e:i=(t-o)/d+(t<o?6:0);break;case t:i=(o-e)/d+2;break;case o:i=(e-t)/d+4;break}i/=6}return new be(i,a,l,n)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};let ie=Yo;Pr(ie,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i);Pr(ie,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i);Pr(ie,"hexShortEx",/^#[0-9A-Z]{3,4}$/i);Pr(ie,"hexLongEx",/^#[0-9A-Z]{6,8}$/i);class be{constructor(t,o,n,s){this.h=t,this.s=o,this.l=n,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(t){let{h:o,s:n,l:s,a:r}=this;return o+=t.h,o>=1?o-=1:o<0&&(o+=1),n+t.s>1?n-=t.s:(n+=t.s,n<0&&(n=0)),s+t.l>1||s+t.l<0?s-=t.l:s+=t.l,r+t.a>1||r+t.a<0?r-=t.a:r+=t.a,new be(o,n,s,r)}toRgb(){const{h:t,s:o,l:n,a:s}=this;let r,i,a;if(o===0)r=i=a=n;else{const l=n<.5?n*(1+o):n+o-n*o,d=2*n-l;r=be.hue2rgb(d,l,t+1/3),i=be.hue2rgb(d,l,t),a=be.hue2rgb(d,l,t-1/3)}return new ie(Math.round(r*255),Math.round(i*255),Math.round(a*255),s)}toHSL(){return this}static hue2rgb(t,o,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(o-t)*6*n:n<1/2?o:n<2/3?t+(o-t)*(2/3-n)*6:t}}const Qv=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),ey="#ffe6f4",ty="#ffbde1",oy=420,ny=22,sy=640,wf=270,ry=7,iy=3,ly=(Yl-wf)/2,ay={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},dy=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:Qv,ChoiceButtonColor:ey,ChoiceButtonBorderColor:ty,ChoiceButtonWidth:oy,ChoiceSpacing:ny,ChoiceX:sy,ChoiceYOffset:wf,ChoicePadding:ry,Outline:iy,ChoiceY:ly,ChoiceTextStyle:ay},Symbol.toStringTag,{value:"Module"})),$f="#ffa8d2",cy="#552222",uy="#ffeef6",Jl="#bb5599",Cf=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Pf=new be(.002028397565922768,0,.13725490196078438,0),kf=.82,Sf=new be(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Of=12,fy=1.5,zi=12,Mt=1.5,py=.6,hy=new be(.08045977011494243,-.5714285714285714,-.5960784313725489,0),gy=new be(0,-.14285714285714296,.3,0),xf=new be(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Ui=9.5,Ft=47,jf=new be(.0023347701149424305,0,.10784313725490202,0),If=3,my=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:$f,controlsDefaultColor:cy,nameboxDefaultColor:uy,nameboxStrokeDefaultColor:Jl,nameboxTextOutlineDelta:Cf,nameboxBackgroundDelta:Pf,nameboxGradientMiddleStopPosition:kf,nameboxGradientEndDelta:Sf,nameboxRounding:Of,nameboxRoundingBuffer:fy,textboxRounding:zi,textboxRoundingBuffer:Mt,nameColorThreshold:py,controlColorDelta:hy,controlDisableColorDelta:gy,dotColorDelta:xf,dotRadius:Ui,dotPatternSize:Ft,textboxOutlineColorDelta:jf,textboxOutlineWidth:If},Symbol.toStringTag,{value:"Module"}));var by=Object.defineProperty,vy=Object.defineProperties,yy=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,_y=Object.prototype.hasOwnProperty,wy=Object.prototype.propertyIsEnumerable,Ed=(e,t,o)=>t in e?by(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Tf=(e,t)=>{for(var o in t||(t={}))_y.call(t,o)&&Ed(e,o,t[o]);if(Td)for(var o of Td(t))wy.call(t,o)&&Ed(e,o,t[o]);return e},Ef=(e,t)=>vy(e,yy(t));const yn=816,Zl=900,kr=146,$y=0,Cy=29,Py=8,ds=38,Sr=44,ky=6,Sy=93,Oy=404,xy=9,jy=9,xt=39,cs=168,us=34,Or=29,Ql=12,ea=-126,ta=-72,oa=-38,na=30.75,sa=26,Bf=426,Gi=58,ra={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},xr=Ef(Tf({},ra),{fontName:"riffic",fontSize:24,strokeColor:Jl,strokeWidth:6,color:"white",letterSpacing:1}),ia={align:"left",font:"13px aller",fill:{style:"#522"}},Af=Ef(Tf({},ia),{fill:{style:"#a66"}}),Iy={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},la={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},_n=Cr/2-yn/2,Ty=Cr/2-Zl/2,Ey=_n+ds,Df=_n+us,By=Df+cs/2,Ay=_n+ea,Dy=_n+ta,Ry=_n+oa,Hy="normal",My=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:yn,TextBoxCorruptedWidth:Zl,TextBoxHeight:kr,TextBoxKerning:$y,TextBoxLineHeight:Cy,TextBoxCorruptedKerning:Py,TextBoxTextXOffset:ds,TextBoxTextYOffset:Sr,TextBoxBottomSpacing:ky,HdSpacing:Sy,HdSideMargin:Oy,TextBoxTextCorruptedXOffset:xy,TextBoxTextCorruptedYOffset:jy,NameboxHeight:xt,NameboxWidth:cs,NameboxXOffset:us,NameboxTextYOffset:Or,ControlsYBottomOffset:Ql,ControlsXHistoryOffset:ea,ControlsXSkipOffset:ta,ControlsXStuffOffset:oa,ArrowXRightOffset:na,ArrowYBottomOffset:sa,GlowRX:Bf,GlowRY:Gi,BaseTextStyle:ra,NameboxTextStyle:xr,ControlsTextStyle:ia,ControlsTextDisabledStyle:Af,TextBoxCorruptedStyle:Iy,TextBoxStyle:la,TextBoxX:_n,TextBoxCorruptedX:Ty,TextBoxTextX:Ey,NameboxX:Df,NameboxTextX:By,ControlsXHistory:Ay,ControlsXSkip:Dy,ControlsXStuff:Ry,DefaultTextboxStyle:Hy},Symbol.toStringTag,{value:"Module"}));var Fy=Object.defineProperty,Ny=Object.defineProperties,Ly=Object.getOwnPropertyDescriptors,Bd=Object.getOwnPropertySymbols,Vy=Object.prototype.hasOwnProperty,Wy=Object.prototype.propertyIsEnumerable,Ad=(e,t,o)=>t in e?Fy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,zy=(e,t)=>{for(var o in t||(t={}))Vy.call(t,o)&&Ad(e,o,t[o]);if(Bd)for(var o of Bd(t))Wy.call(t,o)&&Ad(e,o,t[o]);return e},Uy=(e,t)=>Ny(e,Ly(t));const Gy="#ffe6f4",qy="#ffbde1",Xy="rgba(255,255,255,0.6)",Ky=40,Yy=30,Jy=Uy(zy({},ra),{fontName:"riffic",fontSize:24,strokeColor:Jl,strokeWidth:8,letterSpacing:1,color:"white"}),Zy={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Qy=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:Gy,NotificationBorderColor:qy,NotificationBackdropColor:Xy,NotificationPadding:Ky,NotificationSpacing:Yy,NotificationOkTextStyle:Jy,NotificationTextStyle:Zy},Symbol.toStringTag,{value:"Module"}));var e_=Object.defineProperty,t_=Object.defineProperties,o_=Object.getOwnPropertyDescriptors,Dd=Object.getOwnPropertySymbols,n_=Object.prototype.hasOwnProperty,s_=Object.prototype.propertyIsEnumerable,Rd=(e,t,o)=>t in e?e_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Qt=(e,t)=>{for(var o in t||(t={}))n_.call(t,o)&&Rd(e,o,t[o]);if(Dd)for(var o of Dd(t))s_.call(t,o)&&Rd(e,o,t[o]);return e},eo=(e,t)=>t_(e,o_(t));const Rf=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],r_=0,i_=0,l_=Cr/2,a_=Yl/2,d_=33,c_=100,u_=30,f_=800,p_=720,h_="rgba(51,51,51,0.75)",g_=480,m_=180,b_=3,v_=7,to={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Hf=[eo(Qt({},to),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),eo(Qt({},to),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),eo(Qt({},to),{name:"Monika",fontName:"journal",fontSize:34}),eo(Qt({},to),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),eo(Qt({},to),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),eo(Qt({},to),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),eo(Qt({},to),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),eo(Qt({},to),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],y_=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:Rf,defaultPoemBackground:r_,defaultPoemStyle:i_,defaultX:l_,defaultY:a_,poemTopPadding:d_,poemBottomPadding:c_,poemPadding:u_,defaultPoemWidth:f_,defaultPoemHeight:p_,consoleBackgroundColor:h_,consoleWidth:g_,consoleHeight:m_,defaultConsoleBackground:b_,defaultConsoleStyle:v_,poemTextStyles:Hf},Symbol.toStringTag,{value:"Module"})),__={Base:Yv,Choices:dy,Notification:Qy,Poem:y_,TextBox:My,TextBoxCustom:my},jr=1920,aa=1080,w_=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],$_=1.5,C_=1,P_=-111,k_=-39,S_=[300,360,600,740,960,1180,1320,1560,1620],O_=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:jr,screenHeight:aa,positions:w_,sdCharacterScaleFactor:$_,hdCharacterScaleFactor:C_,CloseUpYOffset:P_,BaseCharacterYPos:k_,characterPositions:S_},Symbol.toStringTag,{value:"Module"})),x_=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),j_="#ffe6f4",I_="#ffbde1",T_=630,E_=33,B_=960,Mf=405,A_=10.5,D_=4.5,R_=(aa-Mf)/2,H_={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},M_=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:x_,ChoiceButtonColor:j_,ChoiceButtonBorderColor:I_,ChoiceButtonWidth:T_,ChoiceSpacing:E_,ChoiceX:B_,ChoiceYOffset:Mf,ChoicePadding:A_,Outline:D_,ChoiceY:R_,ChoiceTextStyle:H_},Symbol.toStringTag,{value:"Module"})),Ff="#ffa8d2",F_="#552222",N_="#ffeef6",da="#bb5599",Nf=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Lf=new be(.002028397565922768,0,.13725490196078438,0),Vf=.82,Wf=new be(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),zf=15,L_=1.5,qi=19,Nt=1.5,V_=.6,W_=new be(.08045977011494243,-.5714285714285714,-.5960784313725489,0),z_=new be(0,-.14285714285714296,.3,0),Uf=new be(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Xi=9.5*1.5,Lt=47*1.5,Gf=new be(.0023347701149424305,0,.10784313725490202,0),qf=5,U_=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:Ff,controlsDefaultColor:F_,nameboxDefaultColor:N_,nameboxStrokeDefaultColor:da,nameboxTextOutlineDelta:Nf,nameboxBackgroundDelta:Lf,nameboxGradientMiddleStopPosition:Vf,nameboxGradientEndDelta:Wf,nameboxRounding:zf,nameboxRoundingBuffer:L_,textboxRounding:qi,textboxRoundingBuffer:Nt,nameColorThreshold:V_,controlColorDelta:W_,controlDisableColorDelta:z_,dotColorDelta:Uf,dotRadius:Xi,dotPatternSize:Lt,textboxOutlineColorDelta:Gf,textboxOutlineWidth:qf},Symbol.toStringTag,{value:"Module"}));var G_=Object.defineProperty,q_=Object.defineProperties,X_=Object.getOwnPropertyDescriptors,Hd=Object.getOwnPropertySymbols,K_=Object.prototype.hasOwnProperty,Y_=Object.prototype.propertyIsEnumerable,Md=(e,t,o)=>t in e?G_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Xf=(e,t)=>{for(var o in t||(t={}))K_.call(t,o)&&Md(e,o,t[o]);if(Hd)for(var o of Hd(t))Y_.call(t,o)&&Md(e,o,t[o]);return e},Kf=(e,t)=>q_(e,X_(t));const ca=1220,Yf=900,Jf=219,J_=0,Z_=29,Q_=8,ua=57,Zf=68,ew=54,tw=9,ow=9,Qo=59,fa=252,pa=49,Qf=43,ep=12*1.5,tp=-126*1.5,op=-72*1.5,np=-38*1.5,sp=30.75*1.5,rp=26*1.5,ip=426*1.5,Ki=58*1.5,ha={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},lp=Kf(Xf({},ha),{fontName:"riffic",fontSize:36,strokeColor:da,strokeWidth:9,color:"white",letterSpacing:2}),or={align:"left",font:"24px aller",fill:{style:"#522"}},ap=Kf(Xf({},or),{fill:{style:"#a66"}}),dp={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},nw={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},wn=jr/2-ca/2,sw=jr/2-Yf/2,rw=wn+ua,cp=wn+pa,iw=cp+fa/2,lw=wn+tp,aw=wn+op,dw=wn+np,cw="custom_plus",uw=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:ca,TextBoxCorruptedWidth:Yf,TextBoxHeight:Jf,TextBoxKerning:J_,TextBoxLineHeight:Z_,TextBoxCorruptedKerning:Q_,TextBoxTextXOffset:ua,TextBoxTextYOffset:Zf,TextBoxBottomSpacing:ew,TextBoxTextCorruptedXOffset:tw,TextBoxTextCorruptedYOffset:ow,NameboxHeight:Qo,NameboxWidth:fa,NameboxXOffset:pa,NameboxTextYOffset:Qf,ControlsYBottomOffset:ep,ControlsXHistoryOffset:tp,ControlsXSkipOffset:op,ControlsXStuffOffset:np,ArrowXRightOffset:sp,ArrowYBottomOffset:rp,GlowRX:ip,GlowRY:Ki,BaseTextStyle:ha,NameboxTextStyle:lp,ControlsTextStyle:or,ControlsTextDisabledStyle:ap,TextBoxStyle:dp,TextBoxCorruptedStyle:nw,TextBoxX:wn,TextBoxCorruptedX:sw,TextBoxTextX:rw,NameboxX:cp,NameboxTextX:iw,ControlsXHistory:lw,ControlsXSkip:aw,ControlsXStuff:dw,DefaultTextboxStyle:cw},Symbol.toStringTag,{value:"Module"}));var fw=Object.defineProperty,pw=Object.defineProperties,hw=Object.getOwnPropertyDescriptors,Fd=Object.getOwnPropertySymbols,gw=Object.prototype.hasOwnProperty,mw=Object.prototype.propertyIsEnumerable,Nd=(e,t,o)=>t in e?fw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,bw=(e,t)=>{for(var o in t||(t={}))gw.call(t,o)&&Nd(e,o,t[o]);if(Fd)for(var o of Fd(t))mw.call(t,o)&&Nd(e,o,t[o]);return e},vw=(e,t)=>pw(e,hw(t));const yw="#ffe6f4",_w="#ffbde1",ww="rgba(255,255,255,0.6)",$w=60,Cw=45,Pw=vw(bw({},ha),{fontName:"riffic",fontSize:36,strokeColor:da,strokeWidth:12,letterSpacing:1,color:"white"}),kw={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Sw=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:yw,NotificationBorderColor:_w,NotificationBackdropColor:ww,NotificationPadding:$w,NotificationSpacing:Cw,NotificationOkTextStyle:Pw,NotificationTextStyle:kw},Symbol.toStringTag,{value:"Module"}));var Ow=Object.defineProperty,xw=Object.defineProperties,jw=Object.getOwnPropertyDescriptors,Ld=Object.getOwnPropertySymbols,Iw=Object.prototype.hasOwnProperty,Tw=Object.prototype.propertyIsEnumerable,Vd=(e,t,o)=>t in e?Ow(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,oo=(e,t)=>{for(var o in t||(t={}))Iw.call(t,o)&&Vd(e,o,t[o]);if(Ld)for(var o of Ld(t))Tw.call(t,o)&&Vd(e,o,t[o]);return e},no=(e,t)=>xw(e,jw(t));const Ew=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Bw=0,Aw=0,Dw=jr/2,Rw=aa/2,Hw=33,Mw=100,Fw=30,Nw=800,Lw=720,Vw="rgba(51,51,51,0.75)",Ww=480,zw=180,Uw=3,Gw=7,so={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},qw=[no(oo({},so),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),no(oo({},so),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),no(oo({},so),{name:"Monika",fontName:"journal",fontSize:34}),no(oo({},so),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),no(oo({},so),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),no(oo({},so),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),no(oo({},so),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),no(oo({},so),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],Xw=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:Ew,defaultPoemBackground:Bw,defaultPoemStyle:Aw,defaultX:Dw,defaultY:Rw,poemTopPadding:Hw,poemBottomPadding:Mw,poemPadding:Fw,defaultPoemWidth:Nw,defaultPoemHeight:Lw,consoleBackgroundColor:Vw,consoleWidth:Ww,consoleHeight:zw,defaultConsoleBackground:Uw,defaultConsoleStyle:Gw,poemTextStyles:qw},Symbol.toStringTag,{value:"Module"})),Kw={Base:O_,Choices:M_,Notification:Sw,Poem:Xw,TextBox:uw,TextBoxCustom:U_};function K(){return X.gameMode==="ddlc_plus"?Kw:__}function $n(){return{flip:!1,rotation:0,version:0,opacity:100,x:K().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,zoom:1}}var Yw=Object.defineProperty,Jw=Object.defineProperties,Zw=Object.getOwnPropertyDescriptors,Wd=Object.getOwnPropertySymbols,Qw=Object.prototype.hasOwnProperty,e$=Object.prototype.propertyIsEnumerable,zd=(e,t,o)=>t in e?Yw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,nr=(e,t)=>{for(var o in t||(t={}))Qw.call(t,o)&&zd(e,o,t[o]);if(Wd)for(var o of Wd(t))e$.call(t,o)&&zd(e,o,t[o]);return e},t$=(e,t)=>Jw(e,Zw(t)),o$=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const n$={setPose(e,t){const o=e.panels[t.panelId].objects[t.id];o.poseId=t.poseId,++o.version},setCharStyleGroup(e,{id:t,panelId:o,styleGroupId:n}){const s=e.panels[o].objects[t];s.styleGroupId=n,++s.version},setCharStyle(e,{id:t,panelId:o,styleId:n}){const s=e.panels[o].objects[t];s.styleId=n,++s.version},setClose(e,t){const o=e.panels[t.panelId].objects[t.id];o.close=t.close,++o.version},setPosePosition(e,t){const o=e.panels[t.panelId].objects[t.id];o.posePositions=nr(nr({},o.posePositions),t.posePositions),++o.version},setFreeMove(e,t){const o=e.panels[t.panelId].objects[t.id];if(o.freeMove=t.freeMove,!o.freeMove){const n=K();o.x=n.Base.characterPositions[sr(o.x)],o.y=n.Base.BaseCharacterYPos}}};function Ir(e,t){return e.getters["content/getCharacters"].get(t.characterType)}function _o(e,t){return e["content/getCharacters"].get(t)}function uo(e,t){return e.styleGroups[t.styleGroupId].styles[t.styleId].poses[t.poseId]}function s$(e,t){const o=uo(e,t),n=[...Object.keys(o.positions).filter(s=>o.positions[s].length>1)];return o.compatibleHeads.length>0&&n.unshift("head"),n}function Yi(e,t,o=t.posePositions.headType||0){const n=uo(e,t).compatibleHeads;return n.length===0?null:e.heads[n[o]]}function sr(e){return K().Base.characterPositions.map((n,s)=>({pos:Math.abs(e-n),idx:s})).sort((n,s)=>n.pos-s.pos)[0].idx}const r$={createCharacters({rootState:e,rootGetters:t,commit:o,state:n},s){var r;const i=n.panels[s.panelId].lastObjId+1,a=K(),l=_o(t,s.characterType),d=l.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;return o("create",{object:t$(nr({},$n()),{id:i,panelId:e.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,preserveRatio:!0,ratio:1,width:l.size[0]*l.defaultScale[0]*d,height:l.size[1]*l.defaultScale[1]*d,characterType:s.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:(r=l.label)!=null?r:l.id,enlargeWhenTalking:e.ui.defaultCharacterTalkingZoom})}),i},seekPart({state:e,commit:t,dispatch:o,rootGetters:n},{delta:s,id:r,panelId:i,part:a}){if(a==="head"){o("seekHead",{id:r,panelId:i,delta:s});return}const l=e.panels[i].objects[r],d=uo(_o(n,l.characterType),l);!d.positions[a]||t("setPosePosition",{id:r,panelId:i,posePositions:{[a]:Nn(d.positions[a],l.posePositions[a]||0,s)}})},seekPose({state:e,commit:t,rootGetters:o},{id:n,panelId:s,delta:r}){const i=e.panels[s].objects[n],a=_o(o,i.characterType),l=a.styleGroups[i.styleGroupId].styles[i.styleId].poses;Wo(t,i,a,d=>{d.poseId=Nn(l,d.poseId,r)})},seekStyle({state:e,commit:t,rootGetters:o},{id:n,panelId:s,delta:r}){const i=e.panels[s].objects[n],a=_o(o,i.characterType),l=a.styleGroups.flatMap((c,f)=>c.styles.map((p,b)=>({styleGroupIdx:f,styleIdx:b,styleGroupJson:JSON.stringify(p.components)}))).sort((c,f)=>c.styleGroupJson.localeCompare(f.styleGroupJson)),d=l.findIndex(c=>c.styleGroupIdx===i.styleGroupId&&c.styleIdx===i.styleId);Wo(t,i,a,c=>{const f=Nn(l,d,r),p=l[f];c.styleGroupId=p.styleGroupIdx,c.styleId=p.styleIdx})},seekHead({state:e,commit:t,rootGetters:o},{id:n,panelId:s,delta:r}){const i=e.panels[s].objects[n],a=_o(o,i.characterType),l=uo(a,i);let d=Yi(a,i);if(!d)return;let c=(i.posePositions.head||0)+r,f=i.posePositions.headType||0;(c<0||c>=d.variants.length)&&(f=Nn(l.compatibleHeads.map(p=>a.heads[p]),f,r),d=Yi(a,i,f),c=r===1?0:d.variants.length-1),t("setPosePosition",{id:n,panelId:s,posePositions:{head:c,headType:f}})},setPart({state:e,commit:t,rootGetters:o},{panelId:n,id:s,part:r,val:i}){const a=e.panels[n].objects[s],l=_o(o,a.characterType);r==="pose"?Wo(t,a,l,d=>{d.poseId=i}):r==="style"?Wo(t,a,l,d=>{d.styleId=i}):Wo(t,a,l,d=>{d.posePositions[r]=i})},setCharStyle({state:e,commit:t,rootGetters:o},{panelId:n,id:s,styleGroupId:r,styleId:i}){const a=e.panels[n].objects[s],l=_o(o,a.characterType);Wo(t,a,l,d=>{d.styleGroupId=r,d.styleId=i})},setCharacterPosition({state:e,commit:t},{panelId:o,id:n,x:s,y:r}){const i=e.panels[o].objects[n];if(!i.freeMove){const a=K();s=a.Base.characterPositions[sr(s)],r=a.Base.BaseCharacterYPos+(i.close?a.Base.CloseUpYOffset:0)}i.x===s&&i.y===r||t("setPosition",{panelId:o,id:n,x:s,y:r})},shiftCharacterSlot({state:e,commit:t},{panelId:o,id:n,delta:s}){const r=e.panels[o].objects[n],i=K();let l=sr(r.x)+s;l<0&&(l=0),l>=i.Base.characterPositions.length&&(l=i.Base.characterPositions.length-1),t("setPosition",{panelId:o,id:n,x:i.Base.characterPositions[l],y:r.y})}};function i$(e,t,o,n){return o$(this,null,function*(){const s=e.state.panels[t].objects[o],r=n.characters.find(j=>j.id===s.characterType);if(!r){console.error("Character data is missing. Dropping the character."),yield e.dispatch("removeObject",{id:o,panelId:t});return}const i=up(s),a=r.styleGroups[s.styleGroupId],l=a.styles[i.styleId],d=l.poses[i.poseId],c=e.rootState.content.current.characters.find(j=>j.id===r.id);if(!c){console.error("Character data is missing. Dropping the character."),yield e.dispatch("removeObject",{id:o,panelId:t});return}const f=c.styleGroups.findIndex(j=>j.id===a.id);i.styleGroupId=f===-1?0:f;const p=c.styleGroups[i.styleGroupId],b=JSON.stringify(l.components),v=p.styles.findIndex(j=>JSON.stringify(j.components)===b);i.styleId=v===-1?0:v;const C=p.styles[i.styleId],B=C.poses.findIndex(j=>j.id===d.id);i.poseId=B===-1?0:B;const D=C.poses[i.poseId];for(const j in D.positions){if(!D.positions.hasOwnProperty(j))continue;const J=D.positions[j];if(d.positions[j]){const Z=i.posePositions[j];Z>=0&&Z<J.length}}const $=d.compatibleHeads[s.posePositions.headType],H=D.compatibleHeads.indexOf($);if(H===-1)i.posePositions.headType=0,i.posePositions.head=0;else{H!==s.posePositions.headType&&(i.posePositions.headType=H);const j=JSON.stringify(r.heads[$].variants[s.posePositions.head]),J=c.heads[$].variants.findIndex(Z=>JSON.stringify(Z)===j);J===-1?i.posePositions.head=0:i.posePositions.head=J}fp(e.commit,s,i)})}function up(e){return{styleGroupId:e.styleGroupId,styleId:e.styleId,poseId:e.poseId,posePositions:nr({},e.posePositions)}}function fp(e,t,o){o.styleGroupId!==t.styleGroupId&&e("setCharStyleGroup",{id:t.id,panelId:t.panelId,styleGroupId:o.styleGroupId}),o.styleId!==t.styleId&&(console.log(`Setting style of ${t.id} to ${o.styleId}`),e("setCharStyle",{id:t.id,panelId:t.panelId,styleId:o.styleId})),o.poseId!==t.poseId&&e("setPose",{id:t.id,panelId:t.panelId,poseId:o.poseId}),JSON.stringify(o.posePositions)!==JSON.stringify(t.posePositions)&&e("setPosePosition",{id:t.id,panelId:t.panelId,posePositions:o.posePositions})}function Wo(e,t,o,n){const s=up(t);n(s),o.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=o.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const i=r.styles[s.styleId];i.poses[s.poseId]||(s.poseId=0);const a=i.poses[s.poseId];for(const f in a.positions)!a.positions[f]||a.positions[f][s.posePositions[f]]||(s.posePositions[f]=0);const d=o.styleGroups[t.styleGroupId].styles[t.styleId].poses[t.poseId].compatibleHeads[t.posePositions.headType||0],c=a.compatibleHeads.indexOf(d);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),fp(e,t,s)}const l$=oe({props:{title:{required:!0,type:String}}});const a$={class:"fieldset_wrapper"},d$={key:0},c$={class:"fieldset_contents"};function u$(e,t,o,n,s,r){return m(),_("div",a$,[u("fieldset",null,[e.title>""?(m(),_("legend",d$,pe(e.title),1)):q("",!0),u("div",c$,[Wt(e.$slots,"default",{},void 0,!0)])])])}const Bt=ne(l$,[["render",u$],["__scopeId","data-v-33044af4"]]);var f$=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Ud=960,p$=oe({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:()=>({lookups:[],loaded:!1}),computed:{scaleX(){return this.size/this.part.size[0]},scaleY(){return this.size/this.part.size[1]},backgroundSize(){return`${Math.floor(Ud*this.scaleX)}px ${Math.floor(Ud*this.scaleY)}px`},backgroundPosition(){return`${Math.floor(this.part.offset[0]*-this.scaleX)}px ${Math.floor(this.part.offset[1]*-this.scaleY)}px`},background(){var e,t;let o="";const n=this.backgroundSize,s=(e=this.part.offset)!=null?e:[0,0];for(let r=0;r<this.part.images.length;++r){const i=this.part.images[r],a=this.lookups[r];if(!a)continue;r>0&&(o+=", ");const l=(t=i.offset)!=null?t:[0,0],d=`${Math.floor((s[0]-l[0])*-this.scaleX)}px ${Math.floor((s[1]-l[1])*-this.scaleY)}px`;o+=`url('${a.replace("'","\\'")}') ${d} / ${n}`}return o},style(){return{height:this.size+"px",width:this.size+"px",background:this.background}}},created(){return f$(this,null,function*(){this.lookups=yield Promise.all(this.part.images.map(e=>typeof e.asset=="string"?mb(e.asset,!1):Gl(e.asset,!1)))})},methods:{quickClick(e){e.preventDefault(),this.$emit("quick-click")}}});function h$(e,t,o,n,s,r){var i;return m(),_("div",{class:le({part:!0,active:(i=e.part)==null?void 0:i.active}),style:Re(e.style),tabindex:"0",onClick:t[0]||(t[0]=a=>e.$emit("click")),onContextmenu:t[1]||(t[1]=(...a)=>e.quickClick&&e.quickClick(...a)),onKeydown:[t[2]||(t[2]=Ue(G(a=>e.$emit("click"),["prevent"]),["enter"])),t[3]||(t[3]=Ue(G((...a)=>e.quickClick&&e.quickClick(...a),["prevent"]),["space"]))]},null,38)}const g$=ne(p$,[["render",h$],["__scopeId","data-v-aa6e96cb"]]);var m$=Object.defineProperty,b$=Object.defineProperties,v$=Object.getOwnPropertyDescriptors,Gd=Object.getOwnPropertySymbols,y$=Object.prototype.hasOwnProperty,_$=Object.prototype.propertyIsEnumerable,qd=(e,t,o)=>t in e?m$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,w$=(e,t)=>{for(var o in t||(t={}))y$.call(t,o)&&qd(e,o,t[o]);if(Gd)for(var o of Gd(t))_$.call(t,o)&&qd(e,o,t[o]);return e},$$=(e,t)=>b$(e,v$(t));const C$=oe({mixins:[ql],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.$store.state.ui.vertical?"vertical":"horizontal":this.direction==="inverted"?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render(){const e=this.noWraping?"no-wraping":"wraping",o=td("div",$$(w$({},{}),{class:["d-flow",this.finalDirection,e],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize!==void 0){const n=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return td("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:n}},[o])}return o},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});const fs=ne(C$,[["__scopeId","data-v-fdd024db"]]);var Xd=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const P$=oe({components:{PartButton:g$,DFieldset:Bt,DFlow:fs},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:()=>({isWebPSupported:null,stylePriorities:[]}),computed:{vertical(){return this.$store.state.ui.vertical},styleComponents(){if(this.part!=="style")return[];const e=this.charData.styleGroups[this.character.styleGroupId];return e.styleComponents.map(t=>{const o={};for(const n in t.variants){if(!t.variants.hasOwnProperty(n))continue;const s=t.variants[n];o[n]={size:e.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:s}],active:!1}}return{label:t.label,name:t.id,buttons:o}})},parts(){const e={};let t,o,n;const s=this.charData,r=uo(s,this.character);switch(this.part){case"head":const i=this.character.posePositions.headType||0,a=this.character.posePositions.head||0;for(let d=0;d<r.compatibleHeads.length;++d){const c=r.compatibleHeads[d],f=s.heads[c];for(let p=0;p<f.variants.length;++p){const b=f.variants[p];e[`${d}_${p}`]={size:f.previewSize,offset:f.previewOffset,images:b.map(v=>({asset:v,offset:[0,0]})),active:a===p&&i===d}}}return e;case"pose":const l=s.styleGroups[this.character.styleGroupId].styles[this.character.styleId];for(let d=0;d<l.poses.length;++d){const c=l.poses[d];e[d]=this.generatePosePreview(c),e[d].active=d===this.character.poseId}return e;case"style":for(let d=0;d<s.styleGroups.length;++d){const c=s.styleGroups[d];e[c.id]=this.generatePosePreview(c.styles[0].poses[0]),e[c.id].active=d===this.character.styleGroupId}return e;default:t=r.positions[this.part],n=r.previewSize,o=r.previewOffset;break}for(let i=0;i<t.length;++i){const a=t[i];e[i]={images:a.map(l=>({offset:[0,0],asset:l})),size:n,offset:o,active:i===(this.character.posePositions[this.part]||0)}}return e},charData(){return Ir(this.$store,this.character)}},methods:{updateStyleData(){const e=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(e.components).map(t=>[t,e.components[t]])},generatePosePreview(e){const t=this.charData;let o=[];for(const n of e.renderCommands)switch(n.type){case"pose-part":const s=e.positions[n.part];if(s==null||s.length===0)break;o=o.concat(s[0].map(a=>({asset:a,offset:n.offset})));break;case"head":const r=t.heads[e.compatibleHeads[0]];if(e.compatibleHeads.length===0)break;const i=r.variants[0];o=o.concat(i.map(a=>({asset:a,offset:n.offset})));break;case"image":o=o.concat(n.images.map(a=>({asset:a,offset:n.offset})));break}return{images:o,size:e.previewSize,offset:e.previewOffset,active:!1}},updatePose(e){e==null&&(e=this.character.styleGroupId);const o=this.charData.styleGroups[e];let n=o.styles;for(const s of this.stylePriorities){const r=n.filter(i=>i.components[s[0]]===s[1]);r.length>0&&(n=r)}this.vuexHistory.transaction(()=>Xd(this,null,function*(){yield this.$store.dispatch("panels/setCharStyle",{id:this.character.id,panelId:this.character.panelId,styleGroupId:e,styleId:o.styles.indexOf(n[0])})}))},choose(e){if(this.part==="style")this.updatePose(this.charData.styleGroups.findIndex(t=>t.id===e));else if(this.part==="head"){const[t,o]=e.split("_",2).map(n=>parseInt(n,10));this.$store.commit("panels/setPosePosition",{id:this.character.id,panelId:this.character.panelId,posePositions:{headType:t,head:o}})}else this.setPart(this.part,parseInt(e,10))},choose_component(e,t){const o=this.stylePriorities.findIndex(n=>n[0]===e);this.stylePriorities.splice(o,1),this.stylePriorities.unshift([e,t]),this.updatePose()},onKeydown(e){(e.key==="Backspace"||e.key==="Escape")&&(this.$emit("leave"),e.preventDefault(),e.stopPropagation())},setPart(e,t){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setPart",{id:this.character.id,panelId:this.character.panelId,part:e,val:t})})}},created(){return Xd(this,null,function*(){this.updateStyleData(),this.isWebPSupported=yield Bo()})},watch:{character(){this.updateStyleData()}}});const mo=e=>(Ne("data-v-fce4aeac"),e=e(),Le(),e),k$=mo(()=>u("i",{class:"material-icons"},"extension",-1)),S$=mo(()=>u("span",{class:"text-block"},"Create new expressions",-1)),O$=[k$,S$],x$=mo(()=>u("i",{class:"material-icons"},"extension",-1)),j$=mo(()=>u("span",{class:"text-block"},"Search in content packs",-1)),I$=[x$,j$],T$=mo(()=>u("i",{class:"material-icons"},"extension",-1)),E$=mo(()=>u("span",null,"Search in content packs",-1)),B$=[T$,E$],A$=mo(()=>u("i",{class:"material-icons"},"extension",-1)),D$=mo(()=>u("span",null,"Search in content packs",-1)),R$=[A$,D$];function H$(e,t,o,n,s,r){const i=A("part-button"),a=A("d-flow"),l=A("d-fieldset");return m(),W(a,{"no-wraping":"",onKeydown:e.onKeydown},{default:T(()=>[u("button",{onClick:t[0]||(t[0]=d=>e.$emit("leave"))},"Back"),e.part==="head"?(m(),_("button",{key:0,onClick:t[1]||(t[1]=d=>e.$emit("show-expression-dialog",{character:e.character.characterType})),class:"icon-button"},O$)):q("",!0),e.part==="head"?(m(),_("button",{key:1,onClick:t[2]||(t[2]=d=>e.$emit("show-dialog","type: Expressions character: "+e.charData.label)),class:"icon-button"},I$)):e.part==="style"?(m(),_("button",{key:2,onClick:t[3]||(t[3]=d=>e.$emit("show-dialog","type: Styles character: "+e.charData.label)),class:"icon-button"},B$)):(m(),_("button",{key:3,onClick:t[4]||(t[4]=d=>e.$emit("show-dialog","type: Poses character: "+e.charData.label)),class:"icon-button"},R$)),(m(!0),_(N,null,$e(e.parts,(d,c)=>(m(),W(i,{key:c,value:c,part:d,onClick:f=>{e.choose(c),e.$emit("leave")},onQuickClick:f=>e.choose(c)},null,8,["value","part","onClick","onQuickClick"]))),128)),(m(!0),_(N,null,$e(e.styleComponents,d=>(m(),W(l,{key:d.name,title:d.label},{default:T(()=>[w(a,{noWraping:""},{default:T(()=>[(m(!0),_(N,null,$e(d.buttons,(c,f)=>(m(),W(i,{size:130,key:f,value:f,part:c,onClick:p=>e.choose_component(d.name,f)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["onKeydown"])}const M$=ne(P$,[["render",H$],["__scopeId","data-v-fce4aeac"]]);function ps(){return function(t,o,n=!1){return{get(){return this.object[t]},set(s){this.vuexHistory.transaction(()=>{this.$store[n?"dispatch":"commit"](o,{panelId:this.object.panelId,id:this.object.id,[t]:s})})}}}}function ga(e){return function(o){return{get(){return this.object[o]},set(n){this.vuexHistory.transaction(()=>{this.$store.commit(e,{panelId:this.object.panelId,id:this.object.id,key:o,value:n})})}}}}var F$=Object.defineProperty,N$=(e,t,o)=>t in e?F$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,L$=(e,t,o)=>(N$(e,typeof t!="symbol"?t+"":t,o),o);const Kd=5;class V${constructor(t){this.str=t,L$(this,"pos",0)}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-Kd),this.pos+Kd)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function Yd(e,t=!0){const o=[],n=new V$(e);let s=Tr;for(;s!==Er;){const r=n.pos;try{s=s(o,n)}catch(i){if(t&&s!==Ji)n.pos=r,s=(a,l)=>Ji(a,l,!0);else throw i}}return o}function Tr(e,t){return t.current()===void 0?Er:t.current()==="{"?W$:t.current()===`
`?z$:Ji}function Er(){return Er}function Ji(e,t,o=!1){const{pos:n}=t;let s="",r=o,i;for(;;){if(t.current()===void 0){i=Er;break}else if(r)s+=t.current(),r=!1;else if(t.current()==="\\")r=!0;else if(t.current()==="{"||t.current()===`
`){i=Tr;break}else s+=t.current();t.next()}return e.push({type:"text",pos:n,content:s}),i}function oi(e,t){throw new Error(`Error when parsing text at position ${e.pos}: (around: "${e.around}") ${t}`)}function W$(e,t){const{pos:o}=t;if(t.current()!=="{")throw new Error("Parser error: Command does not start with {");const n=t.next()==="/";n&&t.next();let s="",r="",i=!1;for(;t.current()===void 0&&oi(t,"Unexpected end of text inside a command"),t.current()!=="}";)i?r+=t.current():t.current().match(/[a-z]/i)?s+=t.current():t.current()==="="?(n&&oi(t,"Closing commands may not contain arguments"),i=!0):oi(t,`Unexpected character '${t.current()}' in command name.`),t.next();return t.next(),n?e.push({type:"commandClose",commandName:s,pos:o}):e.push({type:"command",pos:o,argument:r,commandName:s}),Tr}function z$(e,t){return e.push({type:"newline",pos:t.pos}),t.next(),Tr}var U$=Object.defineProperty,G$=Object.defineProperties,q$=Object.getOwnPropertyDescriptors,Jd=Object.getOwnPropertySymbols,X$=Object.prototype.hasOwnProperty,K$=Object.prototype.propertyIsEnumerable,Zd=(e,t,o)=>t in e?U$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Qe=(e,t)=>{for(var o in t||(t={}))X$.call(t,o)&&Zd(e,o,t[o]);if(Jd)for(var o of Jd(t))K$.call(t,o)&&Zd(e,o,t[o]);return e},et=(e,t)=>G$(e,q$(t));const Qd=new Map([zo("i",e=>et(Qe({},e),{isItalic:!0})),zo("b",e=>et(Qe({},e),{isBold:!0})),zo("u",e=>et(Qe({},e),{isUnderlined:!0})),zo("s",e=>et(Qe({},e),{isStrikethrough:!0})),zo("plain",e=>et(Qe({},e),{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),zo("edited",e=>et(Qe({},e),{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),xs("k",(e,t,o)=>et(Qe({},e),{letterSpacing:t?e.letterSpacing+o:o})),xs("size",(e,t,o)=>et(Qe({},e),{fontSize:t?e.fontSize+o:o})),xs("alpha",(e,t,o)=>et(Qe({},e),{alpha:t?e.alpha+o:o})),xs("stroke",(e,t,o)=>et(Qe({},e),{strokeWidth:t?e.strokeWidth+o:o})),["font",(e,t)=>et(Qe({},e),{fontName:t})],["color",(e,t)=>et(Qe({},e),{color:t})],["outlinecolor",(e,t)=>et(Qe({},e),{strokeColor:t})]]);function zo(e,t){return[e,(o,n)=>{if(n!=="")throw new Error(`Operator '${e}' does not take any arguments.`);return t(o)}]}function xs(e,t){return[e,(o,n)=>{if(n=="")throw new Error(`Operator '${e}' needs an argument.`);const s=n[0]==="+"||n[0]==="-",r=Number(n);if(isNaN(r))throw new Error(`Operator '${e}' needs a numeric argument.`);return t(o,s,r)}]}var je=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},It={},pp={};Object.defineProperty(pp,"__esModule",{value:!0});var at={};Object.defineProperty(at,"__esModule",{value:!0});at.createFactoryWithConstraint=at.isExact=at.noop=at.assert=at.UnreachableCaseError=void 0;class Y$ extends Error{constructor(t){super(`Unreachable case: ${t}`)}}at.UnreachableCaseError=Y$;function J$(e,t="no additional info provided"){if(!e)throw new Error("Assertion Error: "+t)}at.assert=J$;function Z$(...e){}at.noop=Z$;const Q$=()=>e=>e;at.isExact=Q$;const e0=()=>e=>e;at.createFactoryWithConstraint=e0;var hp={};Object.defineProperty(hp,"__esModule",{value:!0});(function(e){var t=je&&je.__createBinding||(Object.create?function(n,s,r,i){i===void 0&&(i=r);var a=Object.getOwnPropertyDescriptor(s,r);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(n,i,a)}:function(n,s,r,i){i===void 0&&(i=r),n[i]=s[r]}),o=je&&je.__exportStar||function(n,s){for(var r in n)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,n,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(pp,e),o(at,e),o(hp,e)})(It);function un(e){e.width=0,e.height=0,ma.delete(e.disposalId||0)}function ss(){const e=document.createElement("canvas");return o0(e),e}const ma=new Map;let t0=0;function o0(e){e.disposalId=t0++,typeof WeakRef!="undefined"&&ma.set(e.disposalId,new WeakRef(e))}window.addEventListener("unload",()=>{ma.forEach(e=>{const t=e.deref();!t||un(t)})});var n0=Object.defineProperty,s0=(e,t,o)=>t in e?n0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ni=(e,t,o)=>(s0(e,typeof t!="symbol"?t+"":t,o),o),r0=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class dt{constructor(t,o){this.str=t,this.baseStyle=o,ni(this,"renderParts"),ni(this,"tokens"),ni(this,"loose"),this.loose=X.state.looseTextParsing;try{this.tokens=Yd(t,this.loose)}catch(n){if(n instanceof Error)this.tokens=[{type:"text",pos:0,content:n.message}];else throw n}this.rebuildParts()}rebuildParts(){this.renderParts=dt.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){return r0(this,null,function*(){if(!("fonts"in document))return;const t=new Set;let o=null;for(const s of this.renderParts)"style"in s&&s.style!==o&&(o=s.style,o.fontName&&t.add(o.fontName));let n=!1;for(const s of t){const r=document,i=`8px ${s}`;r.fonts.check(i)||(n=!0,yield r.fonts.load(i))}if(n){const s=Yd(this.str);this.renderParts=dt.getRenderParts(s,this.baseStyle,this.loose)}})}render(t){t.save();let o=null;for(const n of this.renderParts)n.type!=="newline"&&(n.style!==o&&(o=n.style,Zi(o,t)),o.strokeWidth>0&&o.strokeColor>""&&t.strokeText(n.character,n.x,n.y));for(const n of this.renderParts)n.type!=="newline"&&(n.style!==o&&(o=n.style,Zi(o,t)),t.fillText(n.character,n.x,n.y));t.restore()}quote(){let t;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(t||(t={}));let o=-1,n=0;for(let r=0;r<this.renderParts.length;++r){const i=this.renderParts[r];if(i.type==="character")switch(n){case 0:if(i.character.match(/\s/))continue;i.character==='"'?(n=1,o=r):i.character==="*"?(n=3,o=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Dn(i.style,'"')}),r++,o=r,n=2);break;case 1:o=r,i.character==='"'&&(n=0);break;case 2:if(i.character.match(/\s/))continue;i.character==="*"&&(this.renderParts.splice(o+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Dn(i.style,'"')}),n=3,r++),o=r;break;case 3:i.character==="*"&&(n=0),o=r;break;default:throw new It.UnreachableCaseError(n)}}const s=this.renderParts[o];s&&n===3&&this.renderParts.splice(o+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:Dn(s.style,'"')}),s&&(n===1||n===2)&&this.renderParts.splice(o+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:Dn(s.style,'"')})}fixAlignment(t,o,n,s,r){let i=0,a=[];function l(){let v=o;t==="center"?v=o+(n-o)/2-i/2:t==="right"&&(v=n-i);for(const C of a)C.x=v,v+=C.width}let d=this.renderParts;r>0&&(d=dt.applyLineWrapping(this.renderParts.slice(0),r));let c=s;const f=[];let p=0;for(const v of d)p=Math.max(p,v.height),v.type==="newline"&&(f.push(p),p=0);f.push(p);let b=0;for(const v of d)if(p=Math.max(p,v.height),v.y=c,a.push(v),i+=v.width,v.type==="newline")l(),c+=f[++b]||0,i=0,p=0,a=[];else if(v.type==="character"){const C=a[a.length-1];C.type==="character"&&(i+=C.style.letterSpacing,C.width+=C.style.letterSpacing)}l()}getHeight(t){let o=0,n=0;const s=t===0?this.renderParts:dt.applyLineWrapping(this.renderParts.slice(0),t);for(const r of s)o=Math.max(o,r.height),r.type==="newline"&&(n+=o,o=0);return n+=o,n}getWidth(){let t=0,o=0,n=null;for(const s of this.renderParts)t+=s.width,s.type==="newline"?(o=Math.max(o,t),t=0,n=null):s.type==="character"&&(n&&n.type==="character"&&(t+=n.style.letterSpacing),n=s);return o=Math.max(o,t),o}static getRenderParts(t,o,n){const s=[],r=[],i=[];let a=oc(o),l=o,d=null;function c(f){for(const p of f)s.push({type:"character",character:p,height:a,width:Dn(l,p),style:l,x:0,y:0})}for(const f of t){const p=f.type;switch(p){case"command":if(Qd.has(f.commandName))r.push(l),i.push(d),l=Qd.get(f.commandName)(l,f.argument),a=oc(l),d=f;else if(n)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!d)if(n){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==d.commandName)if(n){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${d}' first. (Opened at position ${d.pos})`);d=i.pop(),l=r.pop();break;case"newline":s.push({height:a,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new It.UnreachableCaseError(p)}}return s}static applyLineWrapping(t,o){let n=-1,s=0,r=0;const i=[];for(const a of t)if(a.type==="newline")n=-1,s=0,r=0,i.push(a);else if(a.type==="character")a.character===" "?s>o?(n=-1,s=0,r=0,i.push({type:"newline",height:a.height,width:0,x:0,y:0})):(s+=a.width,r=s,n=i.length,i.push(a)):(s+=a.width,s>o&&n!==-1&&(s-=r,i.splice(n,1,{type:"newline",height:a.height,width:0,x:0,y:0}),n=-1,r=0),i.push(a));else throw new It.UnreachableCaseError(a);return i}}const ba=ss();ba.width=0;ba.height=0;const ec=ba.getContext("2d");let tc=null;function Dn(e,t){return e!==tc&&(Zi(e,ec),tc=e),ec.measureText(t).width}const si=new Map;function oc(e){const t=e.fontSize+" "+e.fontName;if(si.has(t))return si.get(t)*e.lineSpacing;const o=document.createElement("span");o.innerHTML="Hg",o.style.fontFamily=e.fontName,o.style.fontSize=`${e.fontSize}px`,o.style.lineHeight="1";const n=document.createElement("div");n.style.opacity="0",n.style.fontFamily=e.fontName,n.style.fontSize=`${e.fontSize}px`,n.style.lineHeight="1",n.style.position="absolute",n.style.top="0",n.style.left="0",n.appendChild(o),document.body.appendChild(n);try{const s=n.offsetHeight;return si.set(t,s),s*e.lineSpacing}finally{n.remove()}}function Zi(e,t){t.textAlign="left",t.font=(e.isItalic?"italic ":"")+(e.isBold?"bold ":"")+e.fontSize+"px "+e.fontName,t.lineJoin="round",e.strokeWidth>0&&e.strokeColor>""?(t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeWidth):(t.strokeStyle="",t.lineWidth=0),t.globalAlpha=e.alpha||0,t.fillStyle=e.color}class Jo{}var i0=Object.defineProperty,nc=Object.getOwnPropertySymbols,l0=Object.prototype.hasOwnProperty,a0=Object.prototype.propertyIsEnumerable,Qi=(e,t,o)=>t in e?i0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Rn=(e,t)=>{for(var o in t||(t={}))l0.call(t,o)&&Qi(e,o,t[o]);if(nc)for(var o of nc(t))a0.call(t,o)&&Qi(e,o,t[o]);return e},d0=(e,t,o)=>(Qi(e,typeof t!="symbol"?t+"":t,o),o),c0=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class fn{constructor(t,o,n,s){this.canvas=t,this.fsCtx=o,this.hq=n,this.preview=s,d0(this,"aborted",!1)}static make(t,o,n){return new fn(t,t.getContext("2d"),o,n)}static makeWithContext(t,o,n,s){return new fn(t,o,n,s)}drawText(t){if(this.aborted)throw new Jo;this.fsCtx.save();const{font:o,align:n,x:s=0,y:r=0,text:i=""}=Rn(Rn({},{font:"20px aller",align:"left"}),t);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=n,this.fsCtx.font=o,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(i,s,r)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(i,s,r)),this.fsCtx.restore()}measureText(t){if(this.aborted)throw new Jo;this.fsCtx.save();const{font:o,align:n,text:s=""}=Rn(Rn({},{font:"20px aller",align:"left"}),t);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=n,this.fsCtx.font=o,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(t){if(this.aborted)throw new Jo;if(t.image instanceof Hi)return;const{image:o,flip:n,x:s,y:r,w:i,h:a,filters:l,composite:d}=Rn({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t);if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=d,l)if("filter"in this.fsCtx){const c=[];for(const f of l)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of l)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(t.shadow){const c=t.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(t.rotation!=null&&t.rotation!==0){const c=t.rotationAnchor?t.rotationAnchor.x:0,f=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+i/2,r+a/2),this.fsCtx.scale(n?-1:1,1),o.paintOnto(this.fsCtx,{x:-i/2,y:-a/2,w:i,h:a}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:t,y:o,w:n,h:s,outline:r,fill:i,composition:a}){if(this.aborted)throw new Jo;this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(t,o,n,s),a&&(this.fsCtx.globalCompositeOperation=a),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:t,fill:o,path:n}){if(this.aborted)throw new Jo;this.fsCtx.save(),this.fsCtx.beginPath(),n(this.fsCtx),o&&(this.fsCtx.fillStyle=o.style,this.fsCtx.fill()),t&&(this.fsCtx.strokeStyle=t.style,this.fsCtx.lineWidth=t.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(t,o="repeat"){return t instanceof hs&&(t=t.previewCanvas),this.fsCtx.createPattern(t,o)}customTransform(t,o){return c0(this,null,function*(){this.fsCtx.save(),yield t(this.fsCtx),yield o(this),this.fsCtx.restore()})}linearGradient(t,o,n,s){return this.fsCtx.createLinearGradient(t,o,n,s)}applyFilters(t){if(t.length===0)return;this.fsCtx.save();let o=1;for(const n of t)n.type==="opacity"&&(o*=n.value);if("filter"in this.fsCtx){const n=[];for(const s of t)s.type!=="opacity"&&(s.type==="drop-shadow"?n.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?n.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?n.push(`blur(${s.value}px)`):n.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=n.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),o!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${o})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}var u0=Object.defineProperty,f0=(e,t,o)=>t in e?u0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ri=(e,t,o)=>(f0(e,typeof t!="symbol"?t+"":t,o),o),js=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class hs{constructor(t,o){ri(this,"previewCanvas"),ri(this,"runningContext",null),ri(this,"_disposed",!1);const n=K();this.previewCanvas=ss(),this.previewCanvas.width=t!=null?t:n.Base.screenWidth,this.previewCanvas.height=o!=null?o:n.Base.screenHeight}get disposed(){return this._disposed}render(t,o=!0,n=!0){return js(this,null,function*(){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=fn.makeWithContext(this.previewCanvas,s,o,n);try{yield t(this.runningContext)}catch(i){if(i instanceof Jo)return!1;throw i}finally{r===this.runningContext&&(this.runningContext=null)}return!0})}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(t,o){o.w!=null&&o.h!=null?t.drawImage(this.previewCanvas,o.x,o.y,o.w,o.h):t.drawImage(this.previewCanvas,o.x,o.y)}download(t,o){return js(this,null,function*(){const n=yield this.drawToCanvas(t);return yield X.saveToFile(n,o)})}renderToBlob(t){return js(this,null,function*(){const o=yield this.drawToCanvas(t);return yield new Promise((n,s)=>{o.toBlob(r=>{r?n(r):s()})})})}drawToCanvas(t){return js(this,null,function*(){const o=ss();o.width=this.previewCanvas.width,o.height=this.previewCanvas.height;const n=o.getContext("2d");return n.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),yield t(fn.makeWithContext(o,n,!0,!1)),o})}dispose(){this.runningContext&&this.runningContext.abort(),un(this.previewCanvas),this._disposed=!0}getDataAt(t,o){return this.previewCanvas.getContext("2d").getImageData(t,o,1,1).data}}function rr(e,t,o,n,s){const r=Math.cos(s),i=Math.sin(s),a=e-o,l=t-n,d=r*a-i*l+o,c=i*a+r*l+n;return[d,c]}var p0=Object.defineProperty,h0=(e,t,o)=>t in e?p0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,wo=(e,t,o)=>(h0(e,typeof t!="symbol"?t+"":t,o),o),ii=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())}),Ln=(e=>(e[e.None=0]="None",e[e.Selected=1]="Selected",e[e.Focused=2]="Focused",e[e.Both=3]="Both",e))(Ln||{});class gp{constructor(t){this.obj=t,wo(this,"localRenderer",null),wo(this,"lastVersion",null),wo(this,"hitDetectionFallback",!1),wo(this,"renderable",!1),wo(this,"_disposed",!1),wo(this,"lastHq",!1),wo(this,"ready",Promise.resolve())}get id(){return this.obj.id}get x(){return this.obj.x}get y(){return this.obj.y}get version(){return this.obj.version}get flip(){return this.obj.flip}get rotation(){return this.obj.rotation/180*Math.PI}get composite(){return this.obj.composite}get filters(){return this.obj.filters}get width(){return this.obj.width}get height(){return this.obj.height}get allowSkippingLocalCanvas(){return!0}updateLocalCanvas(t,o){return ii(this,null,function*(){if(this._disposed)throw new Error("Disposed renderable called");yield this.ready;const n=this.canvasWidth,s=this.canvasHeight;if(s===0&&n===0){this.renderable=!1;return}if(this.renderable=!0,this.lastHq=t,!o){this.localRenderer=new hs(n,s);try{yield this.localRenderer.render(this.renderLocal.bind(this),t)}catch(r){throw this.localRenderer.dispose(),this.localRenderer=null,r}}})}needsRedraw(){return this.localRenderer===null||this.lastVersion!==this.version}getRenderRotation(){return[this.flip?-this.rotation:this.rotation,{x:this.x,y:this.y+this.height/2}]}render(t,o,n){return ii(this,null,function*(){if(this._disposed)throw new Error("Disposed renderable called");if(this.canSkipLocal()||(n=!1),(t!==0||this.localRenderer)&&(n=!1),(this.lastHq!==o.hq||this.needsRedraw())&&(yield this.updateLocalCanvas(o.hq,n)),this.lastVersion=this.version,!this.renderable)return;const[r,i]=this.getRenderRotation();let a;switch(t){case 0:a=void 0;break;case 1:a={blur:20,color:"red"};break;case 2:a={blur:20,color:"blue"};break;case 3:a={blur:20,color:"purple"};break}n?yield o.customTransform(l=>ii(this,null,function*(){l.translate(this.canvasDrawPosX,this.canvasDrawPosY)}),this.renderLocal.bind(this)):o.drawImage({image:this.localRenderer,x:this.canvasDrawPosX,y:this.canvasDrawPosY,w:this.canvasDrawWidth,h:this.canvasDrawHeight,rotation:r,rotationAnchor:i,flip:this.flip,shadow:t&&o.preview?a:void 0,composite:this.composite,filters:this.filters})})}canSkipLocal(){return this.allowSkippingLocalCanvas&&this.obj.filters.length===0&&!this.obj.flip}hitTest(t,o){if(!this.localRenderer)return!1;const n=this.getHitbox(),s=n.x0+(n.x1-n.x0)/2,r=n.y0+(n.y1-n.y0)/2,[i,a]=rr(t,o,s,r,this.flip?this.rotation:-this.rotation);if(!(i>=n.x0&&i<=n.x1&&a>=n.y0&&a<=n.y1))return!1;if(this.hitDetectionFallback)return!0;try{return this.pixelPerfectHitTest(t,o)}catch(d){this.hitDetectionFallback=!0}return!0}pixelPerfectHitTest(t,o){if(!this.localRenderer)return!1;const[n,s]=this.getRenderRotation(),[r,i]=s?rr(t,o,s.x,s.y,-n):[t,o],a=Math.round(r-this.canvasDrawPosX),l=Math.round(i-this.canvasDrawPosY),d=this.canvasDrawWidth,c=this.canvasDrawHeight;if(a>=0&&a<=d&&l>=0&&l<=c){const f=this.flip?this.canvasDrawWidth-a:a,p=this.canvasWidth/this.canvasDrawWidth,b=this.canvasHeight/this.canvasDrawHeight;return this.localRenderer.getDataAt(Math.round(f*p),Math.round(l*b))[3]!==0}return!1}getHitbox(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}updatedContent(t,o){}get disposed(){return this._disposed}dispose(){var t;this._disposed=!0,(t=this.localRenderer)==null||t.dispose(),this.localRenderer=null}}var g0=Object.defineProperty,m0=Object.getPrototypeOf,b0=Reflect.get,v0=(e,t,o)=>t in e?g0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,mt=(e,t,o)=>(v0(e,typeof t!="symbol"?t+"":t,o),o),y0=(e,t,o)=>b0(m0(e),o,t),li=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class Cn extends gp{constructor(t){super(t),mt(this,"lastWidth",-1),mt(this,"lastHeight",-1),mt(this,"lastX",-1),mt(this,"lastY",-1),mt(this,"lastFlip",null),mt(this,"canvasHeight"),mt(this,"canvasWidth"),mt(this,"canvasDrawHeight"),mt(this,"canvasDrawWidth"),mt(this,"canvasDrawPosX",0),mt(this,"canvasDrawPosY",0);const o=K().Base;this.canvasHeight=o.screenHeight,this.canvasWidth=o.screenWidth,this.canvasDrawHeight=o.screenHeight,this.canvasDrawWidth=o.screenWidth}getRenderRotation(){return[0,void 0]}needsRedraw(){return super.needsRedraw()?!0:this.width!==this.lastWidth||this.height!==this.lastHeight||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip}updateLocalCanvas(t,o){return li(this,null,function*(){this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip,yield y0(Cn.prototype,this,"updateLocalCanvas").call(this,t,o)})}renderLocal(t){return li(this,null,function*(){const o=K().Base;if(this.rotation===0)return yield this.draw(t);yield t.customTransform(n=>li(this,null,function*(){const s=this.getHitbox(),r=s.x0+(s.x1-s.x0)/2,i=s.y0+(s.y1-s.y0)/2,a=this.flip?o.screenWidth-r:r;n.translate(a,i),n.rotate(this.rotation),n.translate(-a,-i)}),this.draw.bind(this))})}getHitbox(){const t=this.centeredVertically,o=this.width/2,n=this.height/2;return{x0:this.x-o,x1:this.x+o,y0:t?this.y-n:this.y,y1:t?this.y+n:this.y+this.height}}get centeredVertically(){return!1}}var _0=Object.defineProperty,sc=Object.getOwnPropertySymbols,w0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,rc=(e,t,o)=>t in e?_0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ai=(e,t)=>{for(var o in t||(t={}))w0.call(t,o)&&rc(e,o,t[o]);if(sc)for(var o of sc(t))$0.call(t,o)&&rc(e,o,t[o]);return e};class va{constructor(t){this.base=t}static get resizable(){return!1}static get defaultWidth(){return yn}static get defaultHeight(){return kr}static get defaultX(){return K().Base.screenWidth/2}static get defaultY(){return K().Base.screenHeight-this.defaultHeight-xt-K().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return ia}getControlsDisabledStyle(){return Af}get textboxStyle(){return la}renderControls(t,o){const n=K(),s=this.width,r=s/2,l=(this.base.obj.flip?n.Base.screenWidth-this.base.obj.x:this.base.obj.x)-r+s/2,d=this.getControlsStyle();t.drawText(ai({text:"History",x:l+ea,y:o},d)),t.drawText(ai({text:"Skip",x:l+ta,y:o},this.base.obj.skip?d:this.getControlsDisabledStyle())),t.drawText(ai({text:"Auto   Save   Load   Settings",x:l+oa,y:o},d))}}var C0=Object.defineProperty,P0=(e,t,o)=>t in e?C0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,pn=(e,t,o)=>(P0(e,typeof t!="symbol"?t+"":t,o),o),di=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class Pn extends va{constructor(){super(...arguments),pn(this,"backgroundImage","textbox"),pn(this,"xOffset",0)}get height(){return kr+xt}get width(){return yn}get nameboxWidth(){return cs}get nameboxHeight(){return xt}get nameboxOffsetX(){return us}get nameboxOffsetY(){return Or}get nameboxStyle(){return xr}get textOffsetX(){return ds}get textOffsetY(){return Sr}renderNamebox(t,o,n){return di(this,null,function*(){t.drawImage({image:yield rn("namebox"),x:o,y:n})})}renderBackdrop(t,o,n){return di(this,null,function*(){o+=this.xOffset;const s=yield rn(this.backgroundImage);t.drawImage({image:s,x:o,y:n})})}render(t){return di(this,null,function*(){const o=K(),n=this.width,s=this.height,r=n/2,a=(this.obj.flip?o.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;yield this.renderBackdrop(t,a,l+this.nameboxHeight),this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l));const d=l+s,c=d-Ql;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield rn("next"),x:a+n-na,y:d-sa})})}}pn(Pn,"id","normal");pn(Pn,"label","Normal");pn(Pn,"priority",0);pn(Pn,"gameMode","ddlc");var k0=Object.defineProperty,S0=(e,t,o)=>t in e?k0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,hn=(e,t,o)=>(S0(e,typeof t!="symbol"?t+"":t,o),o);class gs extends Pn{constructor(){super(...arguments),hn(this,"backgroundImage","textbox_monika"),hn(this,"xOffset",(yn-Zl)/2)}}hn(gs,"id","corrupt");hn(gs,"label","Corrupted");hn(gs,"priority",1);hn(gs,"gameMode","ddlc");function ir(e,t,o,n,s,r){n<0&&(n=0),s<0&&(s=0),n<2*r&&(r=n/2),s<2*r&&(r=s/2),e.moveTo(t+r,o),e.arcTo(t+n,o,t+n,o+s,r),e.arcTo(t+n,o+s,t,o+s,r),e.arcTo(t,o+s,t,o,r),e.arcTo(t,o,t+n,o,r),e.closePath()}function mp(e,t,o,n,s,r){n<0&&(n=0),s<0&&(s=0),n<2*r&&(r=n/2),s<2*r&&(r=s/2),e.moveTo(t+r,o),e.arcTo(t+n,o,t+n,o+s,r),e.lineTo(t+n,o+s),e.lineTo(t,o+s),e.arcTo(t,o,t+n,o,r),e.closePath()}var O0=Object.defineProperty,x0=Object.defineProperties,j0=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,I0=Object.prototype.hasOwnProperty,T0=Object.prototype.propertyIsEnumerable,el=(e,t,o)=>t in e?O0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,E0=(e,t)=>{for(var o in t||(t={}))I0.call(t,o)&&el(e,o,t[o]);if(ic)for(var o of ic(t))T0.call(t,o)&&el(e,o,t[o]);return e},B0=(e,t)=>x0(e,j0(t)),gn=(e,t,o)=>(el(e,typeof t!="symbol"?t+"":t,o),o),Ct=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class ms extends va{constructor(){super(...arguments),gn(this,"backgroundImage","textbox"),gn(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height+xt}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:cs}get nameboxHeight(){return xt}get nameboxOffsetX(){return us}get nameboxOffsetY(){return Or}get nameboxStyle(){return B0(E0({},xr),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return ds}get textOffsetY(){return Sr}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const t=this.refObject;return t!=null&&t.textboxColor!=null?t.textboxColor:$f}get nameboxOutlineColor(){return this.obj.deriveCustomColors?ie.fromCss(this.customColor).toHSL().shift(Cf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?ie.fromCss(this.customColor).toHSL().shift(Pf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(t,o,n){return Ct(this,null,function*(){const s=this.nameboxWidth,r=this.nameboxHeight;yield t.customTransform(i=>Ct(this,null,function*(){i.beginPath(),mp(i,o,n,s,r,Of),i.clip()}),i=>Ct(this,null,function*(){const a=i.linearGradient(o,n,o,n+r),l=ie.fromCss(this.nameboxBackgroundColor),d=new ie(l.r,l.g,l.b,.95),c=d.toHSL().shift(Sf).toRgb();a.addColorStop(0,d.toCss()),a.addColorStop(kf,d.toCss()),a.addColorStop(1,c.toCss()),i.drawRect({x:o,y:n,w:this.obj.width,h:r,fill:{style:a}})}))})}renderBackdrop(t,o,n){return Ct(this,null,function*(){const s=ie.fromCss(this.customColor).toHSL(),r=new hs(Ft,Ft);yield r.render(a=>Ct(this,null,function*(){const l={style:s.shift(xf).toRgb().toCss()};function d(c,f){a.drawPath({path:p=>{p.ellipse(c,f,Ui,Ui,0,0,2*Math.PI)},fill:l})}d(0,0),d(Ft,0),d(0,Ft),d(Ft,Ft),d(Ft/2,Ft/2)}),!0),yield t.customTransform(a=>Ct(this,null,function*(){a.beginPath(),ir(a,o+Mt,n+Mt,this.width-Mt*2,this.height-xt-Mt*2,zi),a.clip()}),a=>Ct(this,null,function*(){const l=this.obj.height,d=this.obj.width,c=a.linearGradient(o,n,o,n+l),f=ie.fromHex(this.customColor);c.addColorStop(0,f.toCss()),c.addColorStop(1,`rgba(${f.r},${f.g},${f.b},0.6667)`),a.drawRect({x:o,y:n,w:d,h:l,fill:{style:c},outline:{style:"#ffdfee",width:6}}),yield a.customTransform(b=>Ct(this,null,function*(){b.translate(o,n)}),b=>Ct(this,null,function*(){const v=a.patternFrom(r);a.drawRect({x:0,y:0,w:d,h:l,fill:{style:v},composition:"source-atop"})}));const p=a.linearGradient(o,n+l-Gi,o,n+l);p.addColorStop(0,"rgba(255,255,255,0.3137)"),p.addColorStop(.5,"rgba(255,255,255,0.0627)"),p.addColorStop(1,"rgba(255,255,255,0)"),a.drawPath({path:b=>{b.ellipse(o+d/2,n+l,Bf,Gi,0,0,2*Math.PI)},fill:{style:p}})}));const i=s.shift(jf).toRgb().toCss();t.drawPath({path:a=>{ir(a,o+Mt,n+Mt,this.width-Mt*2,this.height-xt-Mt*2,zi)},outline:{style:i,width:If}}),r.dispose()})}render(t){return Ct(this,null,function*(){const o=K(),n=this.width,s=this.height,r=n/2,a=(this.obj.flip?o.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l)),yield this.renderBackdrop(t,a,l+this.nameboxHeight);const d=l+s,c=d-Ql;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield rn("next"),x:a+n-na,y:d-sa})})}}gn(ms,"id","custom");gn(ms,"label","Custom");gn(ms,"priority",0);gn(ms,"gameMode","ddlc");var A0=Object.defineProperty,D0=(e,t,o)=>t in e?A0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Br=(e,t,o)=>(D0(e,typeof t!="symbol"?t+"":t,o),o),R0=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class bs extends va{get height(){return kr+xt}get width(){return yn}get nameboxWidth(){return cs}get nameboxHeight(){return xt}get nameboxOffsetX(){return us}get nameboxOffsetY(){return Or}get nameboxStyle(){return xr}get textOffsetX(){return ds}get textOffsetY(){return Sr}get textboxStyle(){return la}render(t){return R0(this,null,function*(){})}}Br(bs,"id","none");Br(bs,"label","None");Br(bs,"priority",0);Br(bs,"gameMode","ddlc");var H0=Object.defineProperty,lc=Object.getOwnPropertySymbols,M0=Object.prototype.hasOwnProperty,F0=Object.prototype.propertyIsEnumerable,tl=(e,t,o)=>t in e?H0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ac=(e,t)=>{for(var o in t||(t={}))M0.call(t,o)&&tl(e,o,t[o]);if(lc)for(var o of lc(t))F0.call(t,o)&&tl(e,o,t[o]);return e},N0=(e,t,o)=>(tl(e,typeof t!="symbol"?t+"":t,o),o);const bp=class{constructor(e){this.base=e}static get resizable(){return!1}static get defaultWidth(){return ca}static get defaultHeight(){return Jf}static get defaultX(){return K().Base.screenWidth/2}static get defaultY(){return K().Base.screenHeight-this.defaultHeight-Qo-K().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return or}getControlsDisabledStyle(){return ap}renderControls(e,t){const o=K(),n=this.width,s=n/2,i=(this.base.obj.flip?o.Base.screenWidth-this.base.obj.x:this.base.obj.x)-s,a=this.getControlsStyle(),l=["History","Skip","Auto","Save","Load","Settings"],d=[];let c=0;for(const b of l){const v=bp.controlWidth(e,b);d.push(v),c+=v}const f=Math.min((n-c)/(l.length+2),78);let p=i+(n-c-f*(l.length-1))/2;for(let b=0;b<l.length;++b){const v=l[b],C=d[b],B=v==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():a;e.drawText(ac({text:v,x:p,y:t},B)),p+=C+f}}static controlWidth(e,t){if(this.widthCache[t])return this.widthCache[t];const o=e.measureText(ac({text:t},or)).width;return this.widthCache[t]=o,o}};let vp=bp;N0(vp,"widthCache",{});var L0=Object.defineProperty,V0=Object.defineProperties,W0=Object.getOwnPropertyDescriptors,dc=Object.getOwnPropertySymbols,z0=Object.prototype.hasOwnProperty,U0=Object.prototype.propertyIsEnumerable,ol=(e,t,o)=>t in e?L0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,G0=(e,t)=>{for(var o in t||(t={}))z0.call(t,o)&&ol(e,o,t[o]);if(dc)for(var o of dc(t))U0.call(t,o)&&ol(e,o,t[o]);return e},q0=(e,t)=>V0(e,W0(t)),mn=(e,t,o)=>(ol(e,typeof t!="symbol"?t+"":t,o),o),Pt=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class vs extends vp{constructor(){super(...arguments),mn(this,"backgroundImage","textbox"),mn(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height+Qo}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:fa}get nameboxHeight(){return Qo}get nameboxOffsetX(){return pa}get nameboxOffsetY(){return Qf}get nameboxStyle(){return q0(G0({},lp),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return ua}get textOffsetY(){return Zf}get textboxStyle(){return dp}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const t=this.refObject;return t!=null&&t.textboxColor!=null?t.textboxColor:Ff}get nameboxOutlineColor(){return this.obj.deriveCustomColors?ie.fromCss(this.customColor).toHSL().shift(Nf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?ie.fromCss(this.customColor).toHSL().shift(Lf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(t,o,n){return Pt(this,null,function*(){const s=this.nameboxWidth,r=this.nameboxHeight;yield t.customTransform(i=>Pt(this,null,function*(){i.beginPath(),mp(i,o,n,s,r,zf),i.clip()}),i=>Pt(this,null,function*(){const a=i.linearGradient(o,n,o,n+r),l=ie.fromCss(this.nameboxBackgroundColor),d=new ie(l.r,l.g,l.b,.95),c=d.toHSL().shift(Wf).toRgb();a.addColorStop(0,d.toCss()),a.addColorStop(Vf,d.toCss()),a.addColorStop(1,c.toCss()),i.drawRect({x:o,y:n,w:this.obj.width,h:r,fill:{style:a}})}))})}renderBackdrop(t,o,n){return Pt(this,null,function*(){const s=ie.fromCss(this.customColor).toHSL(),r=new hs(Lt,Lt);yield r.render(a=>Pt(this,null,function*(){const l={style:s.shift(Uf).toRgb().toCss()};function d(c,f){a.drawPath({path:p=>{p.ellipse(c,f,Xi,Xi,0,0,2*Math.PI)},fill:l})}d(0,0),d(Lt,0),d(0,Lt),d(Lt,Lt),d(Lt/2,Lt/2)}),!0),yield t.customTransform(a=>Pt(this,null,function*(){a.beginPath(),ir(a,o+Nt,n+Nt,this.width-Nt*2,this.height-Qo-Nt*2,qi),a.clip()}),a=>Pt(this,null,function*(){const l=this.obj.height,d=this.obj.width,c=a.linearGradient(o,n,o,n+l),f=ie.fromHex(this.customColor);c.addColorStop(0,f.toCss()),c.addColorStop(1,`rgba(${f.r},${f.g},${f.b},0.6667)`),a.drawRect({x:o,y:n,w:d,h:l,fill:{style:c},outline:{style:"#ffdfee",width:6}}),yield a.customTransform(b=>Pt(this,null,function*(){b.translate(o,n)}),b=>Pt(this,null,function*(){const v=a.patternFrom(r);a.drawRect({x:0,y:0,w:d,h:l,fill:{style:v},composition:"source-atop"})}));const p=a.linearGradient(o,n+l-Ki,o,n+l);p.addColorStop(0,"rgba(255,255,255,0.3137)"),p.addColorStop(.5,"rgba(255,255,255,0.0627)"),p.addColorStop(1,"rgba(255,255,255,0)"),a.drawPath({path:b=>{b.ellipse(o+d/2,n+l,ip,Ki,0,0,2*Math.PI)},fill:{style:p}})}));const i=s.shift(Gf).toRgb().toCss();t.drawPath({path:a=>{ir(a,o+Nt,n+Nt,this.width-Nt*2,this.height-Qo-Nt*2,qi)},outline:{style:i,width:qf}}),r.dispose()})}render(t){return Pt(this,null,function*(){const o=K(),n=this.width,s=this.height,r=n/2,a=(this.obj.flip?o.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l)),yield this.renderBackdrop(t,a,l+this.nameboxHeight);const d=l+s,c=d-ep;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield rn("next_plus"),x:a+n-sp,y:d-rp})})}}mn(vs,"id","custom_plus");mn(vs,"label","Custom (Plus)");mn(vs,"priority",0);mn(vs,"gameMode","ddlc_plus");var X0=Object.defineProperty,K0=(e,t,o)=>t in e?X0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,cc=(e,t,o)=>(K0(e,typeof t!="symbol"?t+"":t,o),o),ci=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Y0=[Pn,gs,ms,bs,vs],Gn=(()=>{const e={};for(const t of Y0)e[t.id]=t;return e})();class J0 extends Cn{constructor(){super(...arguments),cc(this,"refObject",null),cc(this,"_lastRenderer",null)}get y(){return this.obj.y}get width(){return this.textboxRenderer.width}get height(){return this.textboxRenderer.height}get textboxRenderer(){const t=this.forcedStyle,o=Gn[t];if(this._lastRenderer&&this._lastRenderer.constructor===o)return this._lastRenderer;const n=new o(this);return this._lastRenderer=n,n}get forcedStyle(){const t=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&t&&(t.textboxColor!=null||t.nameboxWidth!=null)?"custom":this.obj.style}updatedContent(t,o){super.updatedContent(t,o);const n=this.obj.talkingObjId;if(n!==null&&n!=="$other$"){const s=t.state.panels.panels[o].objects[n];this.refObject=s!=null?s:null;return}this.refObject=null}draw(t){return ci(this,null,function*(){var o,n;const s=K(),r=this.textboxRenderer,i=r.width,a=i/2,d=(this.flip?s.Base.screenWidth-this.obj.x:this.obj.x)-a,c=this.obj.y;if(yield r.render(t),this.obj.talkingObjId!==null){const f=this.obj.talkingObjId==="$other$"?this.obj.talkingOther:(n=(o=this.refObject)==null?void 0:o.label)!=null?n:"Missing name";yield this.renderName(t,d+r.nameboxOffsetX,c,f)}yield this.renderText(t,d,c,this.obj.autoWrap?i:0)})}renderName(t,o,n,s){return ci(this,null,function*(){const r=this.textboxRenderer,i=r.nameboxWidth,a=r.nameboxStyle,l=new dt(s,a);yield l.loadFonts(),l.fixAlignment("center",o,o+i,n+r.nameboxOffsetY,0),l.render(t.fsCtx)})}renderText(t,o,n,s){return ci(this,null,function*(){const r=this.textboxRenderer,i=new dt(this.obj.text,r.textboxStyle);this.obj.autoQuoting&&this.obj.talkingObjId!==null&&i.quote(),yield i.loadFonts(),i.fixAlignment("left",o+r.textOffsetX,0,n+r.nameboxHeight+r.textOffsetY,s-r.textOffsetX*2),i.render(t.fsCtx)})}}const Z0=oe({components:{Toggle:Et,DFieldset:Bt},props:{obj:{required:!0}},computed:{freeMove:{get(){return this.obj.freeMove},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setFreeMove",{id:this.obj.id,panelId:this.obj.panelId,freeMove:e})})}},preserveRatio:{get(){return this.obj.preserveRatio},set(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setPreserveRatio",{id:this.obj.id,panelId:this.obj.panelId,preserveRatio:e})})}},pos:{get(){return sr(this.obj.x)},set(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:K().Base.characterPositions[e],y:this.obj.y})})}},x:{get(){return this.obj.x},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:e,y:this.y})})}},y:{get(){return this.obj.y},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:this.x,y:e})})}},height:{get(){return this.obj.height},set(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setHeight",{id:this.obj.id,panelId:this.obj.panelId,height:e})})}},width:{get(){return this.obj.width},set(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setWidth",{id:this.obj.id,panelId:this.obj.panelId,width:e})})}},allowSize(){const e=this.obj;return e.type==="textBox"?Gn[e.style].resizable:!(e.type==="character"&&!e.freeMove)},allowStepMove(){return"freeMove"in this.obj},positionNames(){return K().Base.positions},isFirstPos(){return this.pos===0},isLastPos(){return this.pos===K().Base.positions.length-1}}});const Ar=e=>(Ne("data-v-ffa7a993"),e=e(),Le(),e),Q0={colspan:"2"},eC={key:0},tC={colspan:"2"},oC={class:"arrow-col"},nC=["disabled"],sC=["value"],rC={class:"arrow-col"},iC=["disabled"],lC=Ar(()=>u("td",null,[u("label",{for:"sprite_x"},"X:")],-1)),aC=Ar(()=>u("td",null,[u("label",{for:"sprite_y"},"Y:")],-1)),dC=Ar(()=>u("td",null,[u("label",{for:"sprite_w"},"Width:")],-1)),cC=Ar(()=>u("td",null,[u("label",{for:"sprite_h"},"Height:")],-1)),uC={colspan:"2"};function fC(e,t,o,n,s,r){const i=A("toggle"),a=A("d-fieldset");return m(),W(a,{title:"Position"+(e.allowSize?"/Size":"")},{default:T(()=>[u("table",null,[u("tr",null,[u("td",Q0,[e.allowStepMove?(m(),W(i,{key:0,modelValue:e.freeMove,"onUpdate:modelValue":t[0]||(t[0]=l=>e.freeMove=l),label:"Move freely?"},null,8,["modelValue"])):q("",!0)])]),e.allowStepMove&&!e.freeMove?(m(),_("tr",eC,[u("td",tC,[u("table",null,[u("tr",null,[u("td",oC,[u("button",{onClick:t[1]||(t[1]=l=>--e.pos),disabled:e.isFirstPos},"<",8,nC)]),u("td",null,[ae(u("select",{id:"current_talking","onUpdate:modelValue":t[2]||(t[2]=l=>e.pos=l)},[(m(!0),_(N,null,$e(e.positionNames,(l,d)=>(m(),_("option",{key:d,value:d},pe(l),9,sC))),128))],512),[[yt,e.pos,void 0,{number:!0}]])]),u("td",rC,[u("button",{onClick:t[3]||(t[3]=l=>++e.pos),disabled:e.isLastPos},">",8,iC)])])])])])):(m(),_(N,{key:1},[u("tr",null,[lC,u("td",null,[ae(u("input",{id:"sprite_x",type:"number","onUpdate:modelValue":t[4]||(t[4]=l=>e.x=l),onKeydown:t[5]||(t[5]=G(()=>{},["stop"]))},null,544),[[xe,e.x,void 0,{number:!0}]])])]),u("tr",null,[aC,u("td",null,[ae(u("input",{id:"sprite_y",type:"number","onUpdate:modelValue":t[6]||(t[6]=l=>e.y=l),onKeydown:t[7]||(t[7]=G(()=>{},["stop"]))},null,544),[[xe,e.y,void 0,{number:!0}]])])])],64)),e.allowSize?(m(),_(N,{key:2},[u("tr",null,[dC,u("td",null,[ae(u("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":t[8]||(t[8]=l=>e.width=l),onKeydown:t[9]||(t[9]=G(()=>{},["stop"]))},null,544),[[xe,e.width,void 0,{number:!0}]])])]),u("tr",null,[cC,u("td",null,[ae(u("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":t[10]||(t[10]=l=>e.height=l),onKeydown:t[11]||(t[11]=G(()=>{},["stop"]))},null,544),[[xe,e.height,void 0,{number:!0}]])])]),u("tr",null,[u("td",uC,[w(i,{modelValue:e.preserveRatio,"onUpdate:modelValue":t[12]||(t[12]=l=>e.preserveRatio=l),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):q("",!0)])]),_:1},8,["title"])}const pC=ne(Z0,[["render",fC],["__scopeId","data-v-ffa7a993"]]),hC=oe({components:{Toggle:Et,DFieldset:Bt},props:{object:{required:!0}},computed:{onTop:ps()("onTop","panels/setOnTop",!0)},methods:{shiftLayer(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/shiftLayer",{id:this.object.id,panelId:this.object.panelId,delta:e})})}}});const Dr=e=>(Ne("data-v-585e22f7"),e=e(),Le(),e),gC=Dr(()=>u("i",{class:"material-icons"},"vertical_align_bottom",-1)),mC=[gC],bC=Dr(()=>u("i",{class:"material-icons"},"arrow_downward",-1)),vC=[bC],yC=Dr(()=>u("i",{class:"material-icons"},"arrow_upward",-1)),_C=[yC],wC=Dr(()=>u("i",{class:"material-icons"},"vertical_align_top",-1)),$C=[wC];function CC(e,t,o,n,s,r){const i=A("toggle"),a=A("d-fieldset");return m(),W(a,{id:"layerfs",title:"Layer:"},{default:T(()=>[u("table",null,[u("tbody",null,[u("tr",null,[u("td",null,[u("button",{onClick:t[0]||(t[0]=l=>e.shiftLayer(-1/0)),title:"Move to back"},mC)]),u("td",null,[u("button",{onClick:t[1]||(t[1]=l=>e.shiftLayer(-1)),title:"Move backwards"},vC)]),u("td",null,[u("button",{onClick:t[2]||(t[2]=l=>e.shiftLayer(1)),title:"Move forwards"},_C)]),u("td",null,[u("button",{onClick:t[3]||(t[3]=l=>e.shiftLayer(1/0)),title:"Move to front"},$C)])])])]),w(i,{modelValue:e.onTop,"onUpdate:modelValue":t[4]||(t[4]=l=>e.onTop=l),label:"In front?"},null,8,["modelValue"])]),_:1})}const PC=ne(hC,[["render",CC],["__scopeId","data-v-585e22f7"]]),kC=oe({props:{obj:{required:!0}},methods:{onClick(){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/removeObject",{panelId:this.obj.panelId,id:this.obj.id})})}}});function SC(e,t,o,n,s,r){return m(),_("button",{onClick:t[0]||(t[0]=(...i)=>e.onClick&&e.onClick(...i))},"Delete")}const OC=ne(kC,[["render",SC]]),Is=255,ui=8,xC=oe({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},data:()=>({slideActive:!1}),computed:{vertical(){return this.$store.state.ui.vertical},pointerPath(){const e=this.modelValue/this.maxValue*Is;return`M${e} 0L${e+14} 0L${e+7} 12Z`},gradientOffset(){return!this.shiftGradient||this.modelValue===0?0:this.modelValue/this.maxValue}},methods:{enterSlide(e){this.slideActive=!0,this.moveSlide(e)},moveSlide(e){if(!this.slideActive)return;const t=this.$refs.svg;if(!t.contains(e.target)&&e.target!==t)return;if(e instanceof MouseEvent&&e.which!==1){this.slideActive=!1;return}const o=t.getBoundingClientRect(),n=o.width/(ui+Is+ui),r=((e instanceof MouseEvent?e.clientX:e.touches[0].clientX)-o.x)/n;e.preventDefault();const i=Math.max(Math.min(r-ui,Is),0)/Is*this.maxValue;this.$emit("update:modelValue",i)},exitSlide(){this.slideActive=!1}}});const jC=["for"],IC=["id","x1","x2"],TC=["offset"],EC=["fill"],BC=["d"],AC=["id","max","value"];function DC(e,t,o,n,s,r){return m(),_("div",{class:le({slider:!0,vertical:e.vertical}),onKeydown:t[8]||(t[8]=G(()=>{},["stop"]))},[e.noInput?q("",!0):(m(),_("label",{key:0,for:e._.uid},pe(e.label),9,jC)),u("div",null,[(m(),_("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:t[0]||(t[0]=(...i)=>e.enterSlide&&e.enterSlide(...i)),onTouchstart:t[1]||(t[1]=(...i)=>e.enterSlide&&e.enterSlide(...i)),onMousemove:t[2]||(t[2]=(...i)=>e.moveSlide&&e.moveSlide(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.moveSlide&&e.moveSlide(...i)),onMouseup:t[4]||(t[4]=(...i)=>e.exitSlide&&e.exitSlide(...i)),onTouchend:t[5]||(t[5]=(...i)=>e.exitSlide&&e.exitSlide(...i))},[u("defs",null,[u("linearGradient",{id:`gradient${e._.uid}`,x1:e.gradientOffset*100+"%",y1:"0%",x2:(e.gradientOffset+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(m(!0),_(N,null,$e(e.gradientStops,(i,a)=>(m(),_("stop",{key:a,offset:a/(e.gradientStops.length-1)*100+"%",style:Re("stop-color:"+i)},null,12,TC))),128))],8,IC)]),u("g",null,[u("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${e._.uid})`},null,8,EC),u("path",{d:e.pointerPath,"stroke-width":"2",class:"slider-pointer"},null,8,BC)])],544))]),e.noInput?q("",!0):(m(),_("input",{key:1,id:e._.uid,class:"sliderInput",min:"0",max:e.maxValue,value:e.modelValue,type:"number",onInput:t[6]||(t[6]=i=>e.$emit("update:modelValue",parseFloat(i.target.value))),onKeydown:t[7]||(t[7]=G(()=>{},["stop"]))},null,40,AC))],34)}const yp=ne(xC,[["render",DC],["__scopeId","data-v-256246ea"]]),RC=oe({components:{Slider:yp},props:{modelValue:{type:String,validator:e=>!!e.match(/^#[0-9a-f]{6,8}$/i)},mode:{type:String},relative:Boolean},data:()=>({lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}),computed:{vertical(){return this.$store.state.ui.vertical},maxValue1(){return this.mode==="rgba"?255:360},label1(){return this.mode==="rgba"?"Red":"Hue"},stops1(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v2:0,o=this.relative?this.v3:0;e=[new ie(0,t,o,1),new ie(255,t,o,1)]}else{const t=this.relative?this.v2/100:1,o=this.relative?this.v3/100:.5;e=this.eightsStops(n=>new be(n,t,o,1))}return e.map(t=>t.toRgb().toCss())},maxValue2(){return this.mode==="rgba"?255:100},label2(){return this.mode==="rgba"?"Green":"Saturation"},stops2(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v1:0,o=this.relative?this.v3:0;e=[new ie(t,0,o,1),new ie(t,255,o,1)]}else{const t=this.relative?this.v1/360:0,o=this.relative?this.v3/100:.5;e=this.eightsStops(n=>new be(t,n,o,1))}return e.map(t=>t.toRgb().toCss())},maxValue3(){return this.mode==="rgba"?255:100},label3(){return this.mode==="rgba"?"Blue":"Luminosity"},stops3(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v1:0,o=this.relative?this.v2:0;e=[new ie(t,o,0,1),new ie(t,o,255,1)]}else{const t=this.relative?this.v1/360:0,o=this.relative?this.v2/100:.5;e=this.eightsStops(n=>new be(t,o,n,1))}return e.map(t=>t.toRgb().toCss())},stopsAlpha(){const e=ie.fromHex(this.modelValue);return[new ie(e.r,e.g,e.b,0).toCss(),new ie(e.r,e.g,e.b,1).toCss()]}},created(){this.initValues()},methods:{valueChanged(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue(){let e;this.mode==="rgba"?e=new ie(this.v1,this.v2,this.v3,this.a/255):e=new be(this.v1/360,this.v2/100,this.v3/100,this.a/255);const t=e.toRgb().toHex();if(this.lastRGBEmit!==t){if(t.length!==9)throw new Error(`Invalid color code: ${t}`);this.lastRGBEmit=t,this.$emit("update:modelValue",t)}},initValues(){const e=ie.fromHex(this.modelValue);if(this.lastRGBEmit=e.toHex(),this.a=e.a*255,this.mode==="hsla"){const t=e.toHSL();this.v1=t.h*360,this.v2=t.s*100,this.v3=t.l*100}else this.v1=e.r,this.v2=e.g,this.v3=e.b},eightsStops(e){const t=[];for(let o=0;o<=8;++o)t.push(e(o/8));return t}},watch:{value(){this.valueChanged()},v1(){this.updateValue()},v2(){this.updateValue()},v3(){this.updateValue()},a(){this.updateValue()},mode(){this.initValues()}}});function HC(e,t,o,n,s,r){const i=A("slider");return m(),_("div",null,[w(i,{label:e.label1,modelValue:e.v1,"onUpdate:modelValue":t[0]||(t[0]=a=>e.v1=a),"max-value":e.maxValue1,"gradient-stops":e.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),w(i,{label:e.label2,modelValue:e.v2,"onUpdate:modelValue":t[1]||(t[1]=a=>e.v2=a),"max-value":e.maxValue2,"gradient-stops":e.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),w(i,{label:e.label3,modelValue:e.v3,"onUpdate:modelValue":t[2]||(t[2]=a=>e.v3=a),"max-value":e.maxValue3,"gradient-stops":e.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),w(i,{label:"Alpha",modelValue:e.a,"onUpdate:modelValue":t[3]||(t[3]=a=>e.a=a),"max-value":255,"gradient-stops":e.stopsAlpha},null,8,["modelValue","gradient-stops"])])}const MC=ne(RC,[["render",HC],["__scopeId","data-v-3f181f4f"]]);var FC=Object.defineProperty,NC=Object.defineProperties,LC=Object.getOwnPropertyDescriptors,uc=Object.getOwnPropertySymbols,VC=Object.prototype.hasOwnProperty,WC=Object.prototype.propertyIsEnumerable,fc=(e,t,o)=>t in e?FC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,zC=(e,t)=>{for(var o in t||(t={}))VC.call(t,o)&&fc(e,o,t[o]);if(uc)for(var o of uc(t))WC.call(t,o)&&fc(e,o,t[o]);return e},UC=(e,t)=>NC(e,LC(t));const pc="dddg.generated.colors",GC=oe({components:{SliderGroup:MC,DButton:$r},inheritAttrs:!1,emits:["leave","update:modelValue"],props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:()=>({mode:"hsla",relative:!0}),computed:{vertical(){return this.$store.state.ui.vertical},swatches(){return this.$store.state.content.current.colors},color:{get(){return this.format==="rgb"?ie.fromCss(this.modelValue).toHex():this.modelValue},set(e){if(this.format==="rgb"){const t=ie.fromCss(e);this.$emit("update:modelValue",t.toCss())}else this.$emit("update:modelValue",e)}}},mounted(){fe.subscribe(Qs,this.settingColor)},unmounted(){fe.unsubscribe(Qs,this.settingColor)},methods:{settingColor(e){this.color=ie.fromCss(e.color).toHex()},updateHex(e){const t=e.target.value;ie.validHex(t)&&(t.length===7||t.length===9)&&(this.color=t)},addSwatch(){if(this.swatches.find(o=>o.color===this.color))return;const e=this.$store.state.content.contentPacks.find(o=>o.packId===pc)||{packId:pc,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},t=UC(zC({},e),{colors:[...e.colors,{label:this.color,color:this.color}]});this.vuexHistory.transaction(()=>{this.$store.dispatch("content/replaceContentPack",{contentPack:t,processed:!0})})},pickColor(){this.vuexHistory.transaction(()=>{this.$store.commit("ui/setColorPicker",!0)})}}});const qC={class:"column"},XC={class:"hex-selector"},KC=["for"],YC=["id","value"],JC=O("Pick color"),ZC=["title","onClick"];function QC(e,t,o,n,s,r){const i=A("slider-group"),a=A("d-button");return m(),_("div",{class:le({color:!0,vertical:e.vertical})},[u("h2",null,pe(e.title),1),u("button",{onClick:t[0]||(t[0]=l=>e.$emit("leave"))},"OK"),u("table",null,[u("tr",null,[u("td",null,[u("button",{onClick:t[1]||(t[1]=l=>e.mode="hsla")},"HSLA")]),u("td",null,[u("button",{onClick:t[2]||(t[2]=l=>e.mode="rgba")},"RGBA")])])]),u("div",qC,[w(i,{mode:e.mode,modelValue:e.color,"onUpdate:modelValue":t[3]||(t[3]=l=>e.color=l),relative:!0},null,8,["mode","modelValue"]),u("div",XC,[u("label",{class:"hex-label",for:`hex_${e._.uid}`},"Hex",8,KC),u("input",{id:`hex_${e._.uid}`,value:e.color,onInput:t[4]||(t[4]=(...l)=>e.updateHex&&e.updateHex(...l)),onKeydown:t[5]||(t[5]=G(()=>{},["stop"]))},null,40,YC)]),u("button",{onClick:t[6]||(t[6]=(...l)=>e.addSwatch&&e.addSwatch(...l))},"Add as swatch"),w(a,{icon:"colorize",onClick:e.pickColor},{default:T(()=>[JC]),_:1},8,["onClick"])]),u("div",{id:"color-swatches",class:le({vertical:e.vertical})},[(m(!0),_(N,null,$e(e.swatches,l=>(m(),_("button",{class:"swatch",key:l.color,style:Re({backgroundColor:l.color}),title:l.label,onClick:d=>{e.color=l.color,e.$emit("leave")}},null,12,ZC))),128))],2)],2)}const Rr=ne(GC,[["render",QC],["__scopeId","data-v-f8f3d802"]]);var e1=Object.defineProperty,hc=Object.getOwnPropertySymbols,t1=Object.prototype.hasOwnProperty,o1=Object.prototype.propertyIsEnumerable,gc=(e,t,o)=>t in e?e1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,n1=(e,t)=>{for(var o in t||(t={}))t1.call(t,o)&&gc(e,o,t[o]);if(hc)for(var o of hc(t))o1.call(t,o)&&gc(e,o,t[o]);return e};const mc=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function nl(e,t,o){const s=[...t().filters];let r;switch(e.type){case"hue-rotate":r={type:e.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:e.type,value:1};break;case"drop-shadow":r={type:e.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:throw new It.UnreachableCaseError(e.type)}s.splice(e.idx,0,r),o({panelId:e.panelId,id:e.id,filters:s})}function sl(e,t,o){const s=[...t().filters];s.splice(e.idx,1),o({id:e.id,panelId:e.panelId,filters:s})}function rl(e,t,o){const s=[...t().filters],r=s[e.idx];s.splice(e.idx,1),s.splice(e.idx+e.moveBy,0,r),o({id:e.id,panelId:e.panelId,filters:s})}function il(e,t,o){const s=[...t().filters],r=n1({},s[e.idx]);s[e.idx]=r,r.type==="drop-shadow"?(e.blurRadius!==void 0&&(r.blurRadius=e.blurRadius),e.color!==void 0&&(r.color=e.color),e.offsetX!==void 0&&(r.offsetX=e.offsetX),e.offsetY!==void 0&&(r.offsetY=e.offsetY)):r.value=e.value,o({id:e.id,panelId:e.panelId,filters:s})}var s1=Object.defineProperty,bc=Object.getOwnPropertySymbols,r1=Object.prototype.hasOwnProperty,i1=Object.prototype.propertyIsEnumerable,vc=(e,t,o)=>t in e?s1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,l1=(e,t)=>{for(var o in t||(t={}))r1.call(t,o)&&vc(e,o,t[o]);if(bc)for(var o of bc(t))i1.call(t,o)&&vc(e,o,t[o]);return e},a1=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Zo=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),d1=(()=>{try{const e=ss();e.width=0,e.height=0;const o="filter"in e.getContext("2d");if(un(e),o)return Array.from(Zo.keys()).sort()}catch(e){}return["opacity"]})(),c1=oe({components:{DFlow:fs,DFieldset:Bt,Color:Rr,Slider:yp,L:Kl},props:{type:{type:String,required:!0},title:{type:String},id:{},panelId:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],data:()=>({addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}),computed:{object(){switch(this.type){case"object":return this.$store.state.panels.panels[this.panelId].objects[this.id];case"background":return this.$store.state.panels.panels[this.panelId].background;case"panel":return this.$store.state.panels.panels[this.panelId];default:throw new It.UnreachableCaseError(this.type)}},compositionMode:{get(){return this.object.composite},set(e){this.vuexHistory.transaction(()=>{switch(this.type){case"object":this.$store.commit("panels/setComposition",{id:this.id,panelId:this.panelId,composite:e});break;case"background":break;case"panel":break;default:throw new It.UnreachableCaseError(this.type)}})}},filters(){return this.object.filters},filterTypes(){return d1},currentFilter(){var e;return(e=this.filters[this.currentFilterIdx])!=null?e:null},isPercentFilter(){const e=this.currentFilter;return e?mc.has(e.type):!1},maxValue(){const e=this.currentFilter;if(!!e){if(e.type==="hue-rotate")return 360;if(e.type==="grayscale"||e.type==="sepia"||e.type==="opacity"||e.type==="invert")return 100}},minValue(){const e=this.currentFilter;if(!!e)switch(e.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get(){const e=this.currentFilter;if(!!e&&"color"in e)return e.color},set(e){this.setValue({color:e})}},shadowX:{get(){const e=this.currentFilter;if(!!e&&"offsetX"in e)return e.offsetX},set(e){this.setValue({offsetX:e})}},shadowY:{get(){const e=this.currentFilter;if(!!e&&"offsetY"in e)return e.offsetY},set(e){this.setValue({offsetY:e})}},shadowBlur:{get(){const e=this.currentFilter;if(!!e&&"blurRadius"in e)return e.blurRadius},set(e){this.setValue({blurRadius:e})}},hueStops(){return this.eightsStops(t=>new be(t,1,.5,1)).map(t=>t.toRgb().toCss())}},methods:{getFilterLabel(e){return Zo.get(e)},getFilterText(e){return mc.has(e.type)?`${Zo.get(e.type)} ${(e.value*100).toFixed()}%`:e.type==="hue-rotate"?`${Zo.get(e.type)} ${e.value.toFixed()}\xB0`:e.type==="blur"?`${Zo.get(e.type)} ${e.value.toFixed()}px`:Zo.get(e.type)},objectTypeScope(e){switch(this.type){case"object":return"panels/object_"+e;case"background":return"panels/background"+e[0].toUpperCase()+e.slice(1);case"panel":return"panels/"+e}},addFilter(){this.vuexHistory.transaction(()=>{this.$store.dispatch(this.objectTypeScope("addFilter"),{id:this.id,panelId:this.panelId,type:this.addEffectSelection,idx:this.currentFilterIdx+1})})},selectFilter(e){this.currentFilterIdx=e},removeFilter(){this.vuexHistory.transaction(()=>a1(this,null,function*(){yield this.$store.dispatch(this.objectTypeScope("removeFilter"),{id:this.id,panelId:this.panelId,idx:this.currentFilterIdx}),this.currentFilterIdx>=this.object.filters.length&&(this.currentFilterIdx=this.object.filters.length-1)}))},moveFilter(e){this.vuexHistory.transaction(()=>{this.$store.dispatch(this.objectTypeScope("moveFilter"),{id:this.id,panelId:this.panelId,idx:this.currentFilterIdx,moveBy:e}),this.currentFilterIdx+=e})},setValue(e){this.vuexHistory.transaction(()=>{this.$store.dispatch(this.objectTypeScope("setFilter"),l1({id:this.id,panelId:this.panelId,idx:this.currentFilterIdx},e))})},eightsStops(e){const t=[];for(let o=0;o<=8;++o)t.push(e(o/8));return t}}});const ce=e=>(Ne("data-v-e3b0e8df"),e=e(),Le(),e),u1=ce(()=>u("h2",null,"Image options",-1)),f1={class:"column ok-col"},p1={key:0,class:"column"},h1=ce(()=>u("label",{for:"compositionSelect"},"Compositing Mode:",-1)),g1=O("[?] "),m1=ce(()=>u("option",{value:"source-over"},"source-over",-1)),b1=ce(()=>u("option",{value:"source-atop"},"source-atop",-1)),v1=ce(()=>u("option",{value:"destination-over"},"destination-over",-1)),y1=ce(()=>u("option",{value:"destination-in"},"destination-in",-1)),_1=ce(()=>u("option",{value:"destination-in"},"destination-out",-1)),w1=ce(()=>u("option",{value:"destination-in"},"destination-atop",-1)),$1=ce(()=>u("option",{value:"lighter"},"lighter",-1)),C1=ce(()=>u("option",{value:"xor"},"xor",-1)),P1=ce(()=>u("option",{value:"multiply"},"multiply",-1)),k1=ce(()=>u("option",{value:"screen"},"screen",-1)),S1=ce(()=>u("option",{value:"overlay"},"overlay",-1)),O1=ce(()=>u("option",{value:"darken"},"darken",-1)),x1=ce(()=>u("option",{value:"lighten"},"lighten",-1)),j1=ce(()=>u("option",{value:"color-dodge"},"color-dodge",-1)),I1=ce(()=>u("option",{value:"color-burn"},"color-burn",-1)),T1=ce(()=>u("option",{value:"hard-light"},"hard-light",-1)),E1=ce(()=>u("option",{value:"soft-light"},"soft-light",-1)),B1=ce(()=>u("option",{value:"difference"},"difference",-1)),A1=ce(()=>u("option",{value:"exclusion"},"exclusion",-1)),D1=ce(()=>u("option",{value:"hue"},"hue",-1)),R1=ce(()=>u("option",{value:"saturation"},"saturation",-1)),H1=ce(()=>u("option",{value:"color"},"color",-1)),M1=ce(()=>u("option",{value:"luminosity"},"luminosity",-1)),F1=[m1,b1,v1,y1,_1,w1,$1,C1,P1,k1,S1,O1,x1,j1,I1,T1,E1,B1,A1,D1,R1,H1,M1],N1=ce(()=>u("label",{for:"addEffect"},"Add new effect",-1)),L1=["value"],V1=["disabled"],W1=["disabled"],z1=["disabled"],U1=["disabled"],G1=["onClick","onKeydown"],q1={key:0,class:"value-input-table"},X1=ce(()=>u("td",null,[u("label",{for:"shadow_color"},"Color:")],-1)),K1=ce(()=>u("td",null,[u("label",{for:"filter_x"},"X:")],-1)),Y1=ce(()=>u("td",null,[u("label",{for:"filter_y"},"Y:")],-1)),J1=ce(()=>u("td",null,[u("label",{for:"filter_blur"},"Blur:")],-1)),Z1=ce(()=>u("td",null,[u("label",{for:"filter_value"},"Value:")],-1)),Q1=["value","max","min"],eP=O("% "),tP={key:0},oP={colspan:"2"},nP=ce(()=>u("td",null,[u("label",{for:"filter_value"},"Value:")],-1)),sP=["value","max","min"],rP={key:0},iP={colspan:"2"};function lP(e,t,o,n,s,r){const i=A("color"),a=A("l"),l=A("d-flow"),d=A("slider"),c=A("d-fieldset");return e.showShadowColor?(m(),W(i,{key:0,modelValue:e.shadowColor,"onUpdate:modelValue":t[0]||(t[0]=f=>e.shadowColor=f),format:"rgb",onLeave:t[1]||(t[1]=f=>e.showShadowColor=!1)},null,8,["modelValue"])):(m(),W(l,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:T(()=>[u1,u("div",f1,[u("button",{onClick:t[2]||(t[2]=f=>e.$emit("leave"))},"Back")]),e.noComposition?q("",!0):(m(),_("div",p1,[h1,w(a,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:T(()=>[g1]),_:1}),ae(u("select",{id:"compositionSelect","onUpdate:modelValue":t[3]||(t[3]=f=>e.compositionMode=f),onKeydown:t[4]||(t[4]=G(()=>{},["stop"]))},F1,544),[[yt,e.compositionMode]])])),w(c,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:T(()=>[w(l,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:T(()=>[w(l,{direction:"vertical","no-wraping":""},{default:T(()=>[N1,ae(u("select",{id:"addEffect","onUpdate:modelValue":t[5]||(t[5]=f=>e.addEffectSelection=f),onKeydown:t[6]||(t[6]=G(()=>{},["stop"]))},[(m(!0),_(N,null,$e(e.filterTypes,f=>(m(),_("option",{key:f,value:f},pe(e.getFilterLabel(f)),9,L1))),128))],544),[[yt,e.addEffectSelection]]),u("button",{disabled:e.addEffectSelection==="",onClick:t[7]||(t[7]=(...f)=>e.addFilter&&e.addFilter(...f)),onKeydown:t[8]||(t[8]=G(()=>{},["stop"]))}," Add ",40,V1),u("button",{disabled:!e.currentFilter,onClick:t[9]||(t[9]=(...f)=>e.removeFilter&&e.removeFilter(...f)),onKeydown:t[10]||(t[10]=G(()=>{},["stop"]))}," Remove ",40,W1),u("button",{disabled:e.currentFilterIdx===0,onClick:t[11]||(t[11]=f=>e.moveFilter(-1)),onKeydown:t[12]||(t[12]=G(()=>{},["stop"]))}," Move up ",40,z1),u("button",{disabled:e.currentFilterIdx===e.filters.length-1||e.filters.length===0,onClick:t[13]||(t[13]=f=>e.moveFilter(1)),onKeydown:t[14]||(t[14]=G(()=>{},["stop"]))}," Move down ",40,U1)]),_:1}),w(l,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:T(()=>[(m(!0),_(N,null,$e(e.filters,(f,p)=>(m(),_("div",{key:p,class:le({choiceBtn:!0,active:p===e.currentFilterIdx}),tabindex:"0",onClick:b=>e.selectFilter(p),onKeydown:[Ue(b=>e.selectFilter(p),["enter"]),Ue(G(b=>e.selectFilter(p),["prevent"]),["space"])]},pe(e.getFilterText(f)),43,G1))),128))]),_:1}),e.currentFilter?(m(),_("table",q1,[e.currentFilter.type==="drop-shadow"?(m(),_(N,{key:0},[u("tr",null,[X1,u("td",null,[u("button",{id:"shadow_color",class:"color-button",style:Re({background:e.shadowColor}),onClick:t[15]||(t[15]=f=>e.showShadowColor=!0)}," \xA0 ",4)])]),u("tr",null,[K1,u("td",null,[ae(u("input",{id:"filter_x",type:"number","onUpdate:modelValue":t[16]||(t[16]=f=>e.shadowX=f),onKeydown:t[17]||(t[17]=G(()=>{},["stop"]))},null,544),[[xe,e.shadowX,void 0,{number:!0}]])])]),u("tr",null,[Y1,u("td",null,[ae(u("input",{id:"filter_y",type:"number","onUpdate:modelValue":t[18]||(t[18]=f=>e.shadowY=f),onKeydown:t[19]||(t[19]=G(()=>{},["stop"]))},null,544),[[xe,e.shadowY,void 0,{number:!0}]])])]),u("tr",null,[J1,u("td",null,[ae(u("input",{id:"filter_blur",type:"number","onUpdate:modelValue":t[20]||(t[20]=f=>e.shadowBlur=f),onKeydown:t[21]||(t[21]=G(()=>{},["stop"]))},null,544),[[xe,e.shadowBlur,void 0,{number:!0}]])])])],64)):e.isPercentFilter?(m(),_(N,{key:1},[u("tr",null,[Z1,u("td",null,[u("input",{id:"filter_value",value:(e.currentFilter.value*100).toFixed(),type:"number",max:e.maxValue,min:e.minValue,onInput:t[22]||(t[22]=f=>e.setValue({value:Number(f.target.value/100)})),onKeydown:t[23]||(t[23]=G(()=>{},["stop"]))},null,40,Q1),eP])]),e.minValue===0&&e.maxValue!==void 0?(m(),_("tr",tP,[u("td",oP,[w(d,{gradientStops:["#000000","#ffffff"],label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value*100,"no-input":"","onUpdate:modelValue":t[24]||(t[24]=f=>e.setValue({value:Math.round(f)/100}))},null,8,["maxValue","modelValue"])])])):q("",!0)],64)):(m(),_(N,{key:2},[u("tr",null,[nP,u("td",null,[u("input",{id:"filter_value",value:e.currentFilter.value,type:"number",max:e.maxValue,min:e.minValue,onInput:t[25]||(t[25]=f=>e.setValue({value:Number(f.target.value)})),onKeydown:t[26]||(t[26]=G(()=>{},["stop"]))},null,40,sP)])]),e.minValue===0&&e.maxValue!==void 0?(m(),_("tr",rP,[u("td",iP,[w(d,{gradientStops:e.hueStops,label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value,"no-input":"","onUpdate:modelValue":t[27]||(t[27]=f=>e.setValue({value:Math.round(f)}))},null,8,["gradientStops","maxValue","modelValue"]),w(d,{gradientStops:e.hueStops,label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):q("",!0)],64))])):q("",!0)]),_:1})]),_:1})]),_:1}))}const ya=ne(c1,[["render",lP],["__scopeId","data-v-e3b0e8df"]]),aP=oe({inheritAttrs:!1,components:{Color:Rr},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:()=>({colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}),computed:{vertical(){return this.$store.state.ui.vertical}},watch:{selectedFont(){this.selectedFont!==""&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged(){const e=K(),t=this.$refs.textArea.value;try{new dt(t,e.TextBox.NameboxTextStyle),this.error=""}catch(o){this.error=o.message}this.$emit("update:modelValue",t)},selectColor(e){const t=this.$refs.textArea;this.colorSelector=e,this.rememberedStart=t.selectionStart,this.rememberedEnd=t.selectionEnd},applyColor(){const e=this.selectedColor,t=this.colorSelector,o=()=>{const n=this.$refs.textArea;if(!n){this.$nextTick(o);return}n.selectionStart=this.rememberedStart,n.selectionEnd=this.rememberedEnd,this.insertCommand(t==="text"?"color":"outlinecolor",e)};this.$nextTick(o),this.selectedColor="#000000",this.colorSelector=""},insertText(e){const t=this.$refs.textArea,o=t.value,n=t.selectionStart,s=t.selectionEnd;t.value=o.slice(0,n)+e+o.slice(s),t.selectionStart=t.selectionEnd=n+e.length,t.focus(),this.onValueChanged()},insertCommand(e,t){const o=this.$refs.textArea,n=o.value,s=o.selectionStart,r=o.selectionEnd,i=n.slice(s,r),a=n.slice(0,s),l=n.slice(r);let d=e;t&&(d+="="+t),o.value=`${a}{${d}}${i}{/${e}}${l}`,o.selectionStart=s+d.length+2,o.selectionEnd=o.selectionStart+i.length,o.focus(),this.onValueChanged()}}});const dP=e=>(Ne("data-v-d3fa7848"),e=e(),Le(),e),cP={class:"column ok-col"},uP={class:"column"},fP=["value"],pP={key:0,class:"column error-col"},hP={class:"column"},gP=dP(()=>u("p",{class:"hint-col"},"Apply style to selected text:",-1)),mP={class:"column"},bP={class:"column"},vP={class:"column"},yP=Rg('<option value data-v-d3fa7848>Font</option><option value="aller" style="font-family:aller;" data-v-d3fa7848> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-d3fa7848> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-d3fa7848> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-d3fa7848> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-d3fa7848> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-d3fa7848> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-d3fa7848> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-d3fa7848> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-d3fa7848> Halogen (MC) </option>',10),_P=[yP];function wP(e,t,o,n,s,r){const i=A("color");return e.colorSelector?(m(),W(i,{key:0,modelValue:e.selectedColor,"onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedColor=a),onLeave:e.applyColor},null,8,["modelValue","onLeave"])):(m(),_("div",{key:1,class:le({"text-subpanel":!0,vertical:e.vertical})},[u("h2",null,pe(e.title),1),u("div",cP,[u("button",{onClick:t[1]||(t[1]=a=>e.$emit("leave"))},"OK")]),u("div",uP,[u("textarea",{ref:"textArea",value:e.modelValue,onInput:t[2]||(t[2]=(...a)=>e.onValueChanged&&e.onValueChanged(...a)),onKeydown:t[3]||(t[3]=G(()=>{},["stop"])),onKeypress:t[4]||(t[4]=G(()=>{},["stop"]))},null,40,fP)]),e.error?(m(),_("div",pP,pe(e.error),1)):q("",!0),u("div",hP,[u("button",{onClick:t[5]||(t[5]=a=>e.insertText("\\\\")),class:"style-button"},"Insert \\"),u("button",{onClick:t[6]||(t[6]=a=>e.insertText("\\{")),class:"style-button"},"Insert {"),u("button",{onClick:t[7]||(t[7]=a=>e.insertText("\\}")),class:"style-button"},"Insert }")]),gP,u("div",mP,[u("button",{onClick:t[8]||(t[8]=a=>e.insertCommand("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),u("button",{onClick:t[9]||(t[9]=a=>e.insertCommand("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),u("button",{onClick:t[10]||(t[10]=a=>e.insertCommand("plain")),class:"style-button"}," Plain "),u("button",{onClick:t[11]||(t[11]=a=>e.insertCommand("edited")),class:"style-button edited-style"}," Edited "),u("button",{onClick:t[12]||(t[12]=a=>e.insertCommand("k",2)),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),u("div",bP,[u("button",{onClick:t[13]||(t[13]=a=>e.insertCommand("alpha",.5)),class:"style-button"}," Alpha ")]),u("div",vP,[u("button",{onClick:t[14]||(t[14]=a=>e.insertCommand("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),ae(u("select",{"onUpdate:modelValue":t[15]||(t[15]=a=>e.selectedFont=a),class:"style-button"},_P,512),[[yt,e.selectedFont]]),u("button",{onClick:t[16]||(t[16]=a=>e.selectColor("text")),class:"style-button"}," Text color "),u("button",{onClick:t[17]||(t[17]=a=>e.selectColor("outline")),class:"style-button"}," Outline color ")])],2))}const $P=ne(aP,[["render",wP],["__scopeId","data-v-d3fa7848"]]);var Uo=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const fi=ps(),CP=oe({mixins:[ut],components:{Toggle:Et,PositionAndSize:pC,Layers:PC,Delete:OC,TextEditor:$P,ImageOptions:ya,Color:Rr,ModalDialog:Xl,DFieldset:Bt},props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},data:()=>({imageOptionsOpen:!1,canEdit:!0,modalNameInput:"",showRename:!1,localColorHandler:null}),computed:{flip:fi("flip","panels/setFlip"),rotation:fi("rotation","panels/setRotation"),enlargeWhenTalking:fi("enlargeWhenTalking","panels/setEnlargeWhenTalking"),currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},nameboxWidth:{get(){const e=this.object.nameboxWidth;return e===null?"":e+""},set(e){const t=e.trim()===""?null:parseInt(e);this.vuexHistory.transaction(()=>Uo(this,null,function*(){this.$store.commit("panels/setObjectNameboxWidth",{id:this.object.id,panelId:this.object.panelId,nameboxWidth:t})}))}},zoom:{get(){return this.object.zoom*100},set(e){this.vuexHistory.transaction(()=>Uo(this,null,function*(){this.$store.commit("panels/setObjectZoom",{id:this.object.id,panelId:this.object.panelId,zoom:e/100})}))}},defaultNameboxWidth(){return K().TextBox.NameboxWidth},finalColorHandler(){return this.localColorHandler||this.colorHandler||null},hasLabel(){return this.object.label!==null},heading(){var e,t;return(t=(e=this.object.label)!=null?e:this.title)!=null?t:"Object"},useCustomTextboxColor:{get(){return this.object.textboxColor!==null},set(e){this.vuexHistory.transaction(()=>Uo(this,null,function*(){this.$store.commit("panels/setTextboxColor",{panelId:this.object.panelId,id:this.object.id,textboxColor:e?K().TextBoxCustom.textboxDefaultColor:null})}))}}},methods:{copy(){this.vuexHistory.transaction(()=>Uo(this,null,function*(){yield this.$store.dispatch("panels/copyObjectToClipboard",{panelId:this.object.panelId,id:this.object.id})}))},enableNameEdit(){var e;this.modalNameInput=(e=this.object.label)!=null?e:"",this.showRename=!0},renameOption(e){this.showRename=!1,e==="Apply"&&this.vuexHistory.transaction(()=>Uo(this,null,function*(){this.$store.commit("panels/setLabel",{panelId:this.object.panelId,id:this.object.id,label:this.modalNameInput})}))},selectTextboxColor(){this.localColorHandler={title:"Textbox color",get:()=>this.object.textboxColor,set:e=>{this.vuexHistory.transaction(()=>Uo(this,null,function*(){this.$store.commit("panels/setTextboxColor",{panelId:this.object.panelId,id:this.object.id,textboxColor:e})}))},leave:()=>{this.localColorHandler=null}}}}});const kn=e=>(Ne("data-v-f18d06fb"),e=e(),Le(),e),PP={class:"panel"},kP=kn(()=>u("span",{class:"icon material-icons"},"edit",-1)),SP=kn(()=>u("p",{class:"modal-text"},"Enter the new name",-1)),OP={class:"modal-text"},xP={class:"input-table"},jP=kn(()=>u("td",null,[u("label",{for:"rotation"},"Rotation: \xB0")],-1)),IP={key:0},TP=kn(()=>u("td",null,[u("label",{for:"zoom"},"Zoom: ")],-1)),EP={key:0},BP=kn(()=>u("td",null,[u("label",{for:"textbox_color"},"Color:")],-1)),AP=kn(()=>u("td",null,[u("label",{for:"namebox_width"},"Namebox width:")],-1)),DP=["placeholder"];function RP(e,t,o,n,s,r){const i=A("modal-dialog"),a=A("text-editor"),l=A("color"),d=A("image-options"),c=A("position-and-size"),f=A("layers"),p=A("toggle"),b=A("d-fieldset"),v=A("delete");return m(),_("div",PP,[u("h1",{style:Re({fontStyle:e.hasLabel?"italic":"normal"}),onClick:t[0]||(t[0]=(...C)=>e.enableNameEdit&&e.enableNameEdit(...C))},[O(pe(e.heading)+" ",1),kP],4),(m(),W(Wu,{to:"#modal-messages"},[e.showRename?(m(),W(i,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:e.renameOption,onLeave:t[3]||(t[3]=C=>e.renameOption("Cancel"))},{default:T(()=>[SP,u("p",OP,[ae(u("input",{"onUpdate:modelValue":t[1]||(t[1]=C=>e.modalNameInput=C),style:{width:"100%"},onKeydown:t[2]||(t[2]=Ue(G(C=>e.renameOption("Apply"),["prevent","stop"]),["enter"]))},null,544),[[xe,e.modalNameInput]])])]),_:1},8,["onOption"])):q("",!0)])),e.textHandler?(m(),W(a,{key:0,title:e.textHandler.title,modelValue:e.textHandler.get(),"onUpdate:modelValue":t[4]||(t[4]=C=>e.textHandler.set(C)),onLeave:t[5]||(t[5]=C=>e.textHandler.leave())},null,8,["title","modelValue"])):e.finalColorHandler?(m(),W(l,{key:1,title:e.finalColorHandler.title,modelValue:e.finalColorHandler.get(),"onUpdate:modelValue":t[6]||(t[6]=C=>e.finalColorHandler.set(C)),onLeave:t[7]||(t[7]=C=>e.finalColorHandler.leave())},null,8,["title","modelValue"])):e.imageOptionsOpen?(m(),W(d,{key:2,type:"object","panel-id":e.object.panelId,id:e.object.id,onLeave:t[8]||(t[8]=C=>e.imageOptionsOpen=!1)},null,8,["panel-id","id"])):e.showAltPanel?Wt(e.$slots,"alt-panel",{key:3},void 0,!0):(m(),_(N,{key:4},[Wt(e.$slots,"default",{},void 0,!0),w(c,{obj:e.object},null,8,["obj"]),w(f,{object:e.object},null,8,["object"]),w(p,{modelValue:e.flip,"onUpdate:modelValue":t[9]||(t[9]=C=>e.flip=C),label:"Flip?"},null,8,["modelValue"]),u("table",xP,[u("tr",null,[jP,u("td",null,[ae(u("input",{id:"rotation",class:"smol",type:"number","onUpdate:modelValue":t[10]||(t[10]=C=>e.rotation=C),onKeydown:t[11]||(t[11]=G(()=>{},["stop"]))},null,544),[[xe,e.rotation]])])]),e.object.type==="character"||e.object.type==="sprite"?(m(),_("tr",IP,[TP,u("td",null,[ae(u("input",{id:"zoom",type:"number",class:"smol",step:"1",min:"0","onUpdate:modelValue":t[12]||(t[12]=C=>e.zoom=C),onKeydown:t[13]||(t[13]=G(()=>{},["stop"]))},null,544),[[xe,e.zoom]])])])):q("",!0)]),Wt(e.$slots,"options",{},void 0,!0),e.hasLabel?(m(),W(b,{key:0,title:"Textbox settings"},{default:T(()=>[e.object.type==="character"||e.object.type==="sprite"?(m(),W(p,{key:0,label:"Enlarge when talking",modelValue:e.enlargeWhenTalking,"onUpdate:modelValue":t[14]||(t[14]=C=>e.enlargeWhenTalking=C)},null,8,["modelValue"])):q("",!0),w(p,{label:"Use custom textbox color",modelValue:e.useCustomTextboxColor,"onUpdate:modelValue":t[15]||(t[15]=C=>e.useCustomTextboxColor=C)},null,8,["modelValue"]),u("table",null,[e.useCustomTextboxColor?(m(),_("tr",EP,[BP,u("td",null,[u("button",{id:"textbox_color",class:"color-button",style:Re({background:e.object.textboxColor}),onClick:t[16]||(t[16]=(...C)=>e.selectTextboxColor&&e.selectTextboxColor(...C))},null,4)])])):q("",!0),u("tr",null,[AP,u("td",null,[ae(u("input",{id:"namebox_width",type:"number",placeholder:e.defaultNameboxWidth,"onUpdate:modelValue":t[17]||(t[17]=C=>e.nameboxWidth=C)},null,8,DP),[[xe,e.nameboxWidth,void 0,{lazy:!0}]])])])])]),_:1})):q("",!0),u("button",{onClick:t[18]||(t[18]=C=>e.imageOptionsOpen=!0)},"Image options"),u("button",{onClick:t[19]||(t[19]=(...C)=>e.copy&&e.copy(...C))},"Copy"),w(v,{obj:e.object},null,8,["obj"])],64))])}const Sn=ne(CP,[["render",RP],["__scopeId","data-v-f18d06fb"]]),yc=ps(),HP=oe({mixins:[ut],components:{Toggle:Et,Parts:M$,DFieldset:Bt,ObjectTool:Sn},data:()=>({panelForParts:null}),computed:{flip:yc("flip","panels/setFlip"),closeUp:yc("close","panels/setClose"),selection(){return this.$store.state.ui.selection},currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.selection];if(e.type==="character")return e},charData(){return Ir(this.$store,this.object)},label(){var e;return(e=this.charData.label)!=null?e:""},parts(){return s$(this.charData,this.object)},hasMultipleStyles(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses(){return this.charData.styleGroups[this.object.styleGroupId].styles[this.object.styleId].poses.length>1}},methods:{seekPose(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/seekPose",{id:this.object.id,panelId:this.object.panelId,delta:e})})},seekStyle(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/seekStyle",{id:this.object.id,panelId:this.object.panelId,delta:e})})},seekPart(e,t){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/seekPart",{id:this.object.id,panelId:this.object.panelId,delta:t,part:e})})},captialize(e){return e.charAt(0).toUpperCase()+e.substring(1)}},watch:{selection(){this.panelForParts=null}}});const MP={key:0},FP={class:"arrow-col"},NP={class:"arrow-col"},LP={key:1},VP={class:"arrow-col"},WP={class:"arrow-col"},zP={class:"arrow-col"},UP=["onClick"],GP=["onClick"],qP={class:"arrow-col"},XP=["onClick"];function KP(e,t,o,n,s,r){const i=A("parts"),a=A("d-fieldset"),l=A("toggle"),d=A("object-tool");return m(),W(d,{object:e.object,title:e.label,showAltPanel:!!e.panelForParts},{"alt-panel":T(()=>[e.panelForParts?(m(),W(i,{key:0,character:e.object,part:e.panelForParts,onLeave:t[0]||(t[0]=c=>e.panelForParts=null),onShowDialog:t[1]||(t[1]=c=>e.$emit("show-dialog",c)),onShowExpressionDialog:t[2]||(t[2]=c=>e.$emit("show-expression-dialog",c))},null,8,["character","part"])):q("",!0)]),default:T(()=>[e.hasMultiplePoses||e.parts.length>0||e.hasMultipleStyles?(m(),W(a,{key:0,class:"pose-list",title:"Pose:"},{default:T(()=>[u("table",null,[u("tbody",null,[e.hasMultipleStyles?(m(),_("tr",MP,[u("td",FP,[u("button",{onClick:t[3]||(t[3]=c=>e.seekStyle(-1))},"<")]),u("td",null,[u("button",{class:"middle-button",onClick:t[4]||(t[4]=c=>e.panelForParts="style")}," Style ")]),u("td",NP,[u("button",{onClick:t[5]||(t[5]=c=>e.seekStyle(1))},">")])])):q("",!0),e.hasMultiplePoses?(m(),_("tr",LP,[u("td",VP,[u("button",{onClick:t[6]||(t[6]=c=>e.seekPose(-1))},"<")]),u("td",null,[u("button",{class:"middle-button",onClick:t[7]||(t[7]=c=>e.panelForParts="pose")}," Pose ")]),u("td",WP,[u("button",{onClick:t[8]||(t[8]=c=>e.seekPose(1))},">")])])):q("",!0),(m(!0),_(N,null,$e(e.parts,c=>(m(),_("tr",{key:c},[u("td",zP,[u("button",{onClick:f=>e.seekPart(c,-1)},"<",8,UP)]),u("td",null,[u("button",{class:"middle-button",onClick:f=>e.panelForParts=c},pe(e.captialize(c)),9,GP)]),u("td",qP,[u("button",{onClick:f=>e.seekPart(c,1)},">",8,XP)])]))),128))])])]),_:1})):q("",!0)]),options:T(()=>[w(l,{modelValue:e.closeUp,"onUpdate:modelValue":t[9]||(t[9]=c=>e.closeUp=c),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"])}const YP=ne(HP,[["render",KP],["__scopeId","data-v-239a7671"]]),JP=oe({mixins:[ut],components:{ObjectTool:Sn},computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="sprite")return e}}});function ZP(e,t,o,n,s,r){const i=A("object-tool");return m(),W(i,{object:e.object,title:"Custom Sprite"},null,8,["object"])}const QP=ne(JP,[["render",ZP]]);function _c(e,t,o){return e>t?e:t>o?o:t}var ek=Object.defineProperty,tk=Object.defineProperties,ok=Object.getOwnPropertyDescriptors,wc=Object.getOwnPropertySymbols,nk=Object.prototype.hasOwnProperty,sk=Object.prototype.propertyIsEnumerable,$c=(e,t,o)=>t in e?ek(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Cc=(e,t)=>{for(var o in t||(t={}))nk.call(t,o)&&$c(e,o,t[o]);if(wc)for(var o of wc(t))sk.call(t,o)&&$c(e,o,t[o]);return e},rk=(e,t)=>tk(e,ok(t)),ik=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Pc=4,lk={setTalkingObject(e,t){const o=e.panels[t.panelId].objects[t.id];o.talkingObjId=t.talkingObjId,++o.version},setTalkingOther(e,t){const o=e.panels[t.panelId].objects[t.id];o.talkingOther=t.talkingOther,o.talkingObjId="$other$",++o.version},setResetBounds(e,t){const o=e.panels[t.panelId].objects[t.id];o.resetBounds=t.resetBounds,o.x=t.resetBounds.x,o.y=t.resetBounds.y,o.height=t.resetBounds.height,o.width=t.resetBounds.width,o.rotation=t.resetBounds.rotation,++o.version},setTextBoxProperty(e,t){const o=e.panels[t.panelId].objects[t.id];o[t.key]=t.value,++o.version}},ak={createTextBox({commit:e,state:t,rootState:o},n){var s;const r=K(),i=t.panels[n.panelId].lastObjId+1,a=r.TextBox.DefaultTextboxStyle,l=Gn[a],d=n.resetBounds||{x:l.defaultX,y:l.defaultY,width:l.defaultWidth,height:l.defaultHeight,rotation:0};return e("create",{object:rk(Cc(Cc({},$n()),d),{panelId:o.panels.currentPanel,id:i,onTop:!0,type:"textBox",preserveRatio:!1,ratio:r.TextBox.TextBoxWidth/r.TextBox.TextBoxHeight,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:a,overrideColor:!1,customColor:r.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:r.TextBoxCustom.controlsDefaultColor,customNameboxColor:r.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:r.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:(s=n.text)!=null?s:"Click here to edit the textbox",resetBounds:d})}),i},setStyle({state:e,commit:t},o){const n=K(),s=e.panels[o.panelId].objects[o.id],r=Gn[s.style],i=Gn[o.style],a=10;let l=!1;const d={panelId:o.panelId,id:o.id,x:s.x,y:s.y};let c=!1;const f={panelId:o.panelId,id:o.id,width:s.width,height:s.height};i.resizable?(r.defaultWidth!==i.defaultWidth&&(c=!0,f.width=Math.max(f.width+i.defaultWidth-r.defaultWidth,a)),r.defaultHeight!==i.defaultHeight&&(c=!0,f.height=Math.max(f.height+i.defaultHeight-r.defaultHeight,a))):(c=!0,f.width=i.defaultWidth,f.height=i.defaultHeight),r.defaultX!==i.defaultX&&(l=!0,d.x=_c(-f.width+a,d.x+i.defaultX-r.defaultX,n.Base.screenWidth-a)),r.defaultY!==i.defaultY&&(l=!0,d.y=_c(-f.height+a,d.y+i.defaultY-r.defaultY,n.Base.screenHeight-a)),l&&t("setPosition",d),c&&t("setSize",f),t("setTextBoxProperty",Fs(o.panelId,o.id,"style",o.style))},resetTextboxBounds({commit:e,state:t},o){const n=t.panels[o.panelId].objects[o.id];e("setPosition",{panelId:o.panelId,id:o.id,x:n.resetBounds.x,y:n.resetBounds.y}),e("setSize",{panelId:o.panelId,id:o.id,height:n.resetBounds.height,width:n.resetBounds.width}),e("setRotation",{panelId:o.panelId,id:o.id,rotation:n.resetBounds.rotation})},splitTextbox(e,t){return ik(this,arguments,function*({commit:o,state:n,dispatch:s},r){const i=n.panels[r.panelId].objects[r.id];if(i.type!=="textBox")return;const a=(i.width-Pc)/2,l=a/2+Pc/2,d=[i.x,i.y];let c=[i.x-l,i.y],f=[i.x+l,i.y];i.rotation!==0&&(c=rr(c[0],c[1],d[0],d[1],i.rotation/180*Math.PI),f=rr(f[0],f[1],d[0],d[1],i.rotation/180*Math.PI)),o("setResetBounds",{id:r.id,panelId:r.panelId,resetBounds:{x:c[0],y:c[1],width:a,height:i.height,rotation:i.rotation}});const p=i.style==="custom_plus"?"custom_plus":"custom";i.style!==p&&(yield s("setStyle",Fs(r.panelId,r.id,"style",p)));const b=yield s("createTextBox",{panelId:r.panelId,resetBounds:{x:f[0],y:f[1],width:a,height:i.height,rotation:i.rotation}});yield s("setStyle",Fs(r.panelId,b,"style",p)),i.flip&&o("setFlip",{id:b,panelId:r.panelId,flip:i.flip})})}};function Fs(e,t,o,n){return{id:t,panelId:e,key:o,value:n}}const kc=ps(),Rt=ga("panels/setTextBoxProperty"),dk=oe({components:{Toggle:Et,DFieldset:Bt,ObjectTool:Sn,DFlow:fs},mixins:[ut],data:()=>({textEditor:"",colorSelect:""}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},customizable(){return this.textBoxStyle.startsWith("custom")},nameboxWidthDefault(){return K().TextBox.NameboxWidth},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="textBox")return e},textHandler(){if(!!this.textEditor)return{title:this.textEditorName,get:()=>this.textEditor==="name"?this.object.talkingOther:this.textEditor==="body"?this.dialog:"",set:e=>{this.textEditor==="name"?this.talkingOther=e:this.textEditor==="body"&&(this.dialog=e)},leave:()=>{this.textEditor=""}}},colorHandler(){if(!!this.colorSelect)return{title:this.colorName,get:()=>{switch(this.colorSelect){case"":return"#000000";case"base":return this.object.customColor;case"controls":return this.object.customControlsColor;case"namebox":return this.object.customNameboxColor;case"nameboxStroke":return this.object.customNameboxStroke;default:throw new It.UnreachableCaseError(this.colorSelect)}},set:e=>{this.vuexHistory.transaction(()=>{const t=this.currentPanel.id,o=this.object.id;let n={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[this.colorSelect];e!==void 0&&this.$store.commit("panels/setTextBoxProperty",Fs(t,o,n,e))})},leave:()=>{this.colorSelect=""}}},talkingObjId:{get(){var e;return(e=this.object.talkingObjId)!=null?e:"$null$"},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setTalkingObject",{id:this.object.id,panelId:this.object.panelId,talkingObjId:e==="$null$"?null:e})})}},talkingOther:kc("talkingOther","panels/setTalkingOther"),textBoxStyle:kc("style","panels/setStyle",!0),showControls:Rt("controls"),allowSkipping:Rt("skip"),autoQuoting:Rt("autoQuoting"),autoWrap:Rt("autoWrap"),showContinueArrow:Rt("continue"),dialog:Rt("text"),overrideColor:Rt("overrideColor"),deriveCustomColors:Rt("deriveCustomColors"),customNameboxWidth:Rt("customNameboxWidth"),nameList(){const e=this.currentPanel,t=[];for(const o of[...e.order,...e.onTopOrder]){const n=e.objects[o];n.label!==null&&t.push([o,n.label])}return t},textEditorName(){return this.textEditor==="name"?"Name":this.textEditor==="body"?"Dialog":""},customControlsColor(){return this.object.customControlsColor},colorName(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new It.UnreachableCaseError(this.colorSelect)}}},methods:{splitTextbox(){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/splitTextbox",{id:this.object.id,panelId:this.object.panelId})})},resetPosition(){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/resetTextboxBounds",{id:this.object.id,panelId:this.object.panelId})})},jumpToCharacter(){this.vuexHistory.transaction(()=>{this.$store.commit("ui/setSelection",this.talkingObjId)})}}});const Ve=e=>(Ne("data-v-bee2c661"),e=e(),Le(),e),ck={class:"upper-combos"},uk=Ve(()=>u("td",null,[u("label",{for:"text_style"},"Style:")],-1)),fk={colspan:"2"},pk=Ve(()=>u("option",{value:"normal"},"Normal",-1)),hk=Ve(()=>u("option",{value:"corrupt"},"Corrupt",-1)),gk=Ve(()=>u("option",{value:"custom"},"Custom",-1)),mk=Ve(()=>u("option",{value:"custom_plus"},"Custom (Plus)",-1)),bk=Ve(()=>u("option",{value:"none"},"None",-1)),vk=[pk,hk,gk,mk,bk],yk=Ve(()=>u("td",null,[u("label",{for:"current_talking"},"Person talking:")],-1)),_k=Ve(()=>u("option",{value:"$null$"},"No-one",-1)),wk=["value"],$k=Ve(()=>u("option",{value:"$other$"},"Other",-1)),Ck=["disabled"],Pk=Ve(()=>u("td",null,[u("label",{for:"custom_name"},"Other name:")],-1)),kk={id:"dialog_text_wrapper"},Sk=Ve(()=>u("label",{for:"dialog_text"},"Dialog:",-1)),Ok={key:0},xk=Ve(()=>u("td",null,[u("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),jk=["placeholder","disabled"],Ik={colspan:"2"},Tk={key:0},Ek=Ve(()=>u("td",null,[u("label",{for:"textbox_color"},"Color:")],-1)),Bk={key:1},Ak={colspan:"2"},Dk=Ve(()=>u("td",null,[u("label",{for:"custom_controls_color"},"Controls Color:")],-1)),Rk=Ve(()=>u("td",null,[u("label",{for:"custom_namebox_color"},"Namebox Color:")],-1)),Hk=Ve(()=>u("td",null,[u("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1));function Mk(e,t,o,n,s,r){const i=A("toggle"),a=A("d-flow"),l=A("d-fieldset"),d=A("object-tool");return m(),W(d,{object:e.object,title:"Textbox",textHandler:e.textHandler,colorHandler:e.colorHandler},{default:T(()=>[u("table",ck,[u("tr",null,[uk,u("td",fk,[ae(u("select",{id:"text_style","onUpdate:modelValue":t[0]||(t[0]=c=>e.textBoxStyle=c),onKeydown:t[1]||(t[1]=G(()=>{},["stop"]))},vk,544),[[yt,e.textBoxStyle]])])]),u("tr",null,[yk,u("td",null,[ae(u("select",{id:"current_talking","onUpdate:modelValue":t[2]||(t[2]=c=>e.talkingObjId=c),onKeydown:t[3]||(t[3]=G(()=>{},["stop"]))},[_k,(m(!0),_(N,null,$e(e.nameList,([c,f])=>(m(),_("option",{key:c,value:c},pe(f),9,wk))),128)),$k],544),[[yt,e.talkingObjId]])]),u("td",null,[u("button",{title:"Jump to talking character",onClick:t[4]||(t[4]=(...c)=>e.jumpToCharacter&&e.jumpToCharacter(...c)),disabled:e.talkingObjId==="$null$"||e.talkingObjId==="$other$"}," > ",8,Ck)])]),u("tr",null,[Pk,u("td",null,[ae(u("input",{id:"custom_name","onUpdate:modelValue":t[5]||(t[5]=c=>e.talkingOther=c),onKeydown:t[6]||(t[6]=G(()=>{},["stop"]))},null,544),[[xe,e.talkingOther]])]),u("td",null,[u("button",{onClick:t[7]||(t[7]=c=>e.textEditor="name")},"...")])])]),w(i,{label:"Auto quoting?",modelValue:e.autoQuoting,"onUpdate:modelValue":t[8]||(t[8]=c=>e.autoQuoting=c)},null,8,["modelValue"]),w(i,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[9]||(t[9]=c=>e.autoWrap=c)},null,8,["modelValue"]),u("div",kk,[Sk,ae(u("textarea",{"onUpdate:modelValue":t[10]||(t[10]=c=>e.dialog=c),id:"dialog_text",onKeydown:t[11]||(t[11]=G(()=>{},["stop"]))},null,544),[[xe,e.dialog]]),u("button",{onClick:t[12]||(t[12]=c=>e.textEditor="body")},"Formatting")])]),options:T(()=>[w(l,{title:"Customization:",class:le(e.customizable?"customization-set":"")},{default:T(()=>[w(a,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:T(()=>[w(i,{label:"Controls visible?",modelValue:e.showControls,"onUpdate:modelValue":t[13]||(t[13]=c=>e.showControls=c)},null,8,["modelValue"]),w(i,{label:"Able to skip?",modelValue:e.allowSkipping,"onUpdate:modelValue":t[14]||(t[14]=c=>e.allowSkipping=c)},null,8,["modelValue"]),w(i,{label:"Continue arrow?",modelValue:e.showContinueArrow,"onUpdate:modelValue":t[15]||(t[15]=c=>e.showContinueArrow=c)},null,8,["modelValue"]),e.customizable?(m(),_("table",Ok,[u("tr",null,[xk,u("td",null,[ae(u("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:e.nameboxWidthDefault,"onUpdate:modelValue":t[16]||(t[16]=c=>e.customNameboxWidth=c),disabled:e.overrideColor,onKeydown:t[17]||(t[17]=G(()=>{},["stop"]))},null,40,jk),[[xe,e.customNameboxWidth,void 0,{number:!0}]])])]),u("tr",null,[u("td",Ik,[w(i,{modelValue:e.overrideColor,"onUpdate:modelValue":t[18]||(t[18]=c=>e.overrideColor=c),label:"Override color"},null,8,["modelValue"])])]),e.overrideColor?(m(),_("tr",Tk,[Ek,u("td",null,[u("button",{id:"textbox_color",class:"color-button",style:Re({background:e.object.customColor}),onClick:t[19]||(t[19]=c=>e.colorSelect="base")},null,4)])])):q("",!0),e.overrideColor?(m(),_("tr",Bk,[u("td",Ak,[w(i,{id:"derive_custom_colors",modelValue:e.deriveCustomColors,"onUpdate:modelValue":t[20]||(t[20]=c=>e.deriveCustomColors=c),label:"Derive other colors"},null,8,["modelValue"])])])):q("",!0),e.overrideColor&&!e.deriveCustomColors?(m(),_(N,{key:2},[u("tr",null,[Dk,u("td",null,[u("button",{id:"custom_controls_color",class:"color-button",style:Re({background:e.object.customControlsColor}),onClick:t[21]||(t[21]=c=>e.colorSelect="controls")},null,4)])]),u("tr",null,[Rk,u("td",null,[u("button",{id:"custom_namebox_color",class:"color-button",style:Re({background:e.object.customNameboxColor}),onClick:t[22]||(t[22]=c=>e.colorSelect="namebox")},null,4)])]),u("tr",null,[Hk,u("td",null,[u("button",{id:"custom_namebox_stroke",class:"color-button",style:Re({background:e.object.customNameboxStroke}),onClick:t[23]||(t[23]=c=>e.colorSelect="nameboxStroke")},null,4)])])],64)):q("",!0)])):q("",!0)]),_:1})]),_:1},8,["class"]),u("button",{onClick:t[24]||(t[24]=(...c)=>e.resetPosition&&e.resetPosition(...c))},"Reset position"),u("button",{onClick:t[25]||(t[25]=(...c)=>e.splitTextbox&&e.splitTextbox(...c))},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"])}const Fk=ne(dk,[["render",Mk],["__scopeId","data-v-bee2c661"]]),Nk=ps(),Lk=oe({mixins:[ut],components:{Toggle:Et,DFieldset:Bt,DFlow:fs,ObjectTool:Sn},data:()=>({currentIdx:0,textEditor:!1}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="choice")return e},autoWrap:Nk("autoWrap","panels/setAutoWrapping"),buttonText:Vk("text"),buttons(){return this.object.choices},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.buttonText,set:e=>{this.buttonText=e},leave:()=>{this.textEditor=!1}}}},methods:{select(e){this.currentIdx=e},addChoice(){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/addChoice",{id:this.object.id,panelId:this.object.panelId,text:""})})},removeChoice(){this.vuexHistory.transaction(()=>{this.currentIdx===this.object.choices.length-1&&this.currentIdx>0&&this.select(this.currentIdx-1),this.$store.dispatch("panels/removeChoice",{id:this.object.id,panelId:this.object.panelId,choiceIdx:this.currentIdx})})}}});function Vk(e){return{get(){return this.object.choices[this.currentIdx][e]},set(t){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setChoiceProperty",{id:this.object.id,panelId:this.object.panelId,choiceIdx:this.currentIdx,key:e,value:t})})}}}const Wk=e=>(Ne("data-v-bdedda57"),e=e(),Le(),e),zk=["onClick"],Uk=Wk(()=>u("tr",null,[u("td",{colspan:"2"},[u("label",{for:"choice-button-input"},"Text")])],-1));function Gk(e,t,o,n,s,r){const i=A("d-flow"),a=A("d-fieldset"),l=A("toggle"),d=A("object-tool");return m(),W(d,{object:e.object,title:"Choice",textHandler:e.textHandler},{default:T(()=>[w(a,{class:"buttons",title:"Buttons:"},{default:T(()=>[w(i,{maxSize:"100%",direction:"vertical",noWraping:""},{default:T(()=>[(m(!0),_(N,null,$e(e.buttons,(c,f)=>(m(),_("div",{class:le({choiceBtn:!0,active:f===e.currentIdx}),key:f,onClick:p=>e.select(f)},pe(c.text.trim()===""?"[Empty]":c.text),11,zk))),128))]),_:1})]),_:1}),w(a,{class:"current_button",title:"Current button:"},{default:T(()=>[u("table",null,[Uk,u("tr",null,[u("td",null,[ae(u("input",{id:"choice-button-input","onUpdate:modelValue":t[0]||(t[0]=c=>e.buttonText=c),onKeydown:t[1]||(t[1]=G(()=>{},["stop"]))},null,544),[[xe,e.buttonText]])]),u("td",null,[u("button",{onClick:t[2]||(t[2]=c=>e.textEditor=!0)},"...")])])])]),_:1}),u("button",{onClick:t[3]||(t[3]=(...c)=>e.addChoice&&e.addChoice(...c))},"Add"),u("button",{onClick:t[4]||(t[4]=(...c)=>e.removeChoice&&e.removeChoice(...c))},"Remove"),w(l,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[5]||(t[5]=c=>e.autoWrap=c)},null,8,["modelValue"])]),_:1},8,["object","textHandler"])}const qk=ne(Lk,[["render",Gk],["__scopeId","data-v-bdedda57"]]),Xk=oe({mixins:[ut],components:{L:Kl}});const Xt=e=>(Ne("data-v-36c192ba"),e=e(),Le(),e),Kk={class:"panel"},Yk=Xt(()=>u("h1",null,"Help and Credits",-1)),Jk=O("Help"),Zk=O("Fork me on GitHub"),Qk=O("Privacy Statement"),eS=Xt(()=>u("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),tS=Xt(()=>u("p",null,[O(" Doki Doki Dialog Generator developed by EDave64 "),u("br"),O("Based on gemdude46's DDLC Shitpost generator ")],-1)),oS=O(" Unused House Background by "),nS=O(" Fatelogic "),sS=O(" Aller Font by "),rS=O("Dalton Maag Ltd"),iS=O(" Riffic Bold Font by "),lS=O("InkyType"),aS=O(" Verily Serif Mono Font by "),dS=O("Stephen G. Hartke"),cS=O(" F25 Bank Printer Font by "),uS=O("F25 Digital Typeface Design"),fS=O(" Journal Font by "),pS=O("Fontourist"),hS=O(" Hashtag Font by "),gS=O(" TitanVex"),mS=O(" JP Hand Slanted Font by "),bS=O("Jonathan Paterson"),vS=O(" As I Lay Dying Font by "),yS=O("Moises Esqueda"),_S=O(" Damagrafik Script Font by "),wS=O("Davide Terenzi"),$S=O(" Ammy's Handwriting Font by "),CS=O("Ammy K."),PS=O(" Halogen Font by "),kS=O("JLH Fonts"),SS=Xt(()=>u("p",null,[O(" MC Sprite by Childish-N "),u("br"),O("MC Casual Sprite by SlightlySimple "),u("br"),O("MC Chibi by SlightlySimple ")],-1)),OS=O("Concept MC"),xS=O(" by StormBlazed76, "),jS=O("red"),IS=O(" and "),TS=O("yellow"),ES=O(" eyes by YinuS_WinneR, "),BS=O("chibi"),AS=O(" by Hadrosaur838 "),DS=Xt(()=>u("p",null,[O(" MC Chad Sprite by Cylent-Nite "),u("br"),O("MC Chad Poses and expressions by SlightlySimple "),u("br"),O("MC Chad Poses and chibi by Meddy-sin ")],-1)),RS=Xt(()=>u("p",null,[O(" FeMC Sprite by Meddy-sin "),u("br"),O("FeMC Casual Sprite by SlightlySimple ")],-1)),HS=O("Concept FeMC"),MS=O(" by ShidoDraws, "),FS=O("additional poses, expressions and chibi"),NS=O(" by SlightlySimple "),LS=Xt(()=>u("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),VS=Xt(()=>u("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),WS=Xt(()=>u("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1));function zS(e,t,o,n,s,r){const i=A("l");return m(),_("div",Kk,[Yk,w(i,{class:"btn",to:"wiki://Dokumentation"},{default:T(()=>[Jk]),_:1}),w(i,{class:"btn",to:"github://"},{default:T(()=>[Zk]),_:1}),w(i,{class:"btn",to:"wiki://Privacy Statement"},{default:T(()=>[Qk]),_:1}),eS,tS,u("p",null,[oS,w(i,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:T(()=>[nS]),_:1})]),u("p",null,[sS,w(i,{to:"https://www.daltonmaag.com/library/aller"},{default:T(()=>[rS]),_:1})]),u("p",null,[iS,w(i,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:T(()=>[lS]),_:1})]),u("p",null,[aS,w(i,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:T(()=>[dS]),_:1})]),u("p",null,[cS,w(i,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:T(()=>[uS]),_:1})]),u("p",null,[fS,w(i,{to:"https://www.dafont.com/journal.font"},{default:T(()=>[pS]),_:1})]),u("p",null,[hS,w(i,{to:"https://www.dafont.com/hashtag.font"},{default:T(()=>[gS]),_:1})]),u("p",null,[mS,w(i,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:T(()=>[bS]),_:1})]),u("p",null,[vS,w(i,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:T(()=>[yS]),_:1})]),u("p",null,[_S,w(i,{to:"https://www.dafont.com/damagrafik-script.font"},{default:T(()=>[wS]),_:1})]),u("p",null,[$S,w(i,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:T(()=>[CS]),_:1})]),u("p",null,[PS,w(i,{to:"https://www.dafont.com/halogen.font"},{default:T(()=>[kS]),_:1})]),SS,u("p",null,[w(i,{to:"https://www.reddit.com/ofkg59"},{default:T(()=>[OS]),_:1}),xS,w(i,{to:"https://www.reddit.com/og6shh"},{default:T(()=>[jS]),_:1}),IS,w(i,{to:"https://www.reddit.com/oft3vb"},{default:T(()=>[TS]),_:1}),ES,w(i,{to:"https://www.reddit.com/ofof3o"},{default:T(()=>[BS]),_:1}),AS]),DS,RS,u("p",null,[w(i,{to:"https://www.reddit.com/oizaow"},{default:T(()=>[HS]),_:1}),MS,w(i,{to:"https://www.reddit.com/oosuxu"},{default:T(()=>[FS]),_:1}),NS]),LS,VS,WS])}const US=ne(Xk,[["render",zS],["__scopeId","data-v-36c192ba"]]),GS=oe({props:{backgroundId:{type:String,required:!0}},data:()=>({isWebPSupported:null,assets:[]}),computed:{background(){const e=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[e].background},bgData(){return this.$store.getters["content/getBackgrounds"].get(this.backgroundId)||null},isActive(){return this.backgroundId===this.background.current},title(){var e;switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return(e=this.bgData.label)!=null?e:""},style(){var e;switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}const t=(e=this.bgData)==null?void 0:e.variants[0].map(o=>`url('${Gl(o,!1)}')`).join(",");return{backgroundImage:t!=null?t:""}}}});const qS=["title"];function XS(e,t,o,n,s,r){return m(),_("div",{class:le({background:!0,active:e.isActive}),title:e.title,style:Re(e.style),tabindex:"0",onClick:t[0]||(t[0]=i=>e.$emit("input",e.backgroundId)),onKeydown:[t[1]||(t[1]=Ue(i=>e.$emit("input",e.backgroundId),["enter"])),t[2]||(t[2]=Ue(G(i=>e.$emit("input",e.backgroundId),["prevent"]),["space"]))]},pe(e.title),47,qS)}const KS=ne(GS,[["render",XS],["__scopeId","data-v-e727d6d8"]]),YS=oe({components:{Toggle:Et,DFieldset:Bt},computed:{vertical(){return this.$store.state.ui.vertical},color:{get(){return this.background.color},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setBackgroundColor",{color:e,panelId:this.$store.state.panels.currentPanel})})}},flipped:{get(){return this.background.flipped},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setBackgroundFlipped",{flipped:e,panelId:this.$store.state.panels.currentPanel})})}},scaling:{get(){return this.background.scaling.toString()},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(e,10),panelId:this.$store.state.panels.currentPanel})})}},currentBackgroundId(){return this.background.current},background(){const e=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[e].background},bgData(){return this.$store.state.content.current.backgrounds.find(e=>e.id===this.currentBackgroundId)||null},isColor(){return this.currentBackgroundId==="buildin.static-color"},isVariant(){return!!this.bgData},hasVariants(){return this.bgData?this.bgData.variants.length>1:!1}},methods:{seekVariant(e){this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/seekBackgroundVariant",{delta:e,panelId:this.$store.state.panels.currentPanel})})}}});const ys=e=>(Ne("data-v-41fa88c5"),e=e(),Le(),e),JS=ys(()=>u("label",{for:"bg_color"},"Color:",-1)),ZS={key:1},QS={colspan:"3"},eO={key:0},tO={class:"arrow-col"},oO=ys(()=>u("td",{style:{"text-align":"center"}},"Variant",-1)),nO={class:"arrow-col"},sO={colspan:"3"},rO=ys(()=>u("option",{value:"0"},"None",-1)),iO=ys(()=>u("option",{value:"1"},"Stretch",-1)),lO=ys(()=>u("option",{value:"2"},"Cover",-1)),aO=[rO,iO,lO],dO={colspan:"3"};function cO(e,t,o,n,s,r){const i=A("toggle"),a=A("d-fieldset");return m(),W(a,{class:le({"bg-settings":!0,vertical:e.vertical}),title:"Settings:"},{default:T(()=>[e.isColor?(m(),_(N,{key:0},[JS,u("button",{id:"bg_color",class:"color-button",style:Re({background:e.color}),onClick:t[0]||(t[0]=l=>e.$emit("change-color"))},null,4)],64)):q("",!0),e.isVariant?(m(),_("table",ZS,[u("tr",null,[u("td",QS,[w(i,{modelValue:e.flipped,"onUpdate:modelValue":t[1]||(t[1]=l=>e.flipped=l),label:"Flipped?"},null,8,["modelValue"])])]),e.hasVariants?(m(),_("tr",eO,[u("td",tO,[u("button",{class:"small-button",onClick:t[2]||(t[2]=l=>e.seekVariant(-1))},"<")]),oO,u("td",nO,[u("button",{class:"small-button",onClick:t[3]||(t[3]=l=>e.seekVariant(1))},">")])])):q("",!0),u("tr",null,[u("td",sO,[ae(u("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.scaling=l),onKeydown:t[5]||(t[5]=G(()=>{},["stop"]))},aO,544),[[yt,e.scaling]])])]),u("tr",null,[u("td",dO,[u("button",{id:"image_options_button",onClick:t[6]||(t[6]=l=>e.$emit("open-image-options"))}," Image options ")])])])):q("",!0)]),_:1},8,["class"])}const uO=ne(YS,[["render",cO],["__scopeId","data-v-41fa88c5"]]);var fO=Object.defineProperty,pO=Object.defineProperties,hO=Object.getOwnPropertyDescriptors,Sc=Object.getOwnPropertySymbols,gO=Object.prototype.hasOwnProperty,mO=Object.prototype.propertyIsEnumerable,Oc=(e,t,o)=>t in e?fO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,bO=(e,t)=>{for(var o in t||(t={}))gO.call(t,o)&&Oc(e,o,t[o]);if(Sc)for(var o of Sc(t))mO.call(t,o)&&Oc(e,o,t[o]);return e},vO=(e,t)=>pO(e,hO(t)),xc=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const jc={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},yO=oe({mixins:[ut],components:{BackgroundButton:KS,BackgroundSettings:uO,DropTarget:_f,Color:Rr,ImageOptions:ya,DButton:$r},data:()=>({colorSelect:!1,imageOptions:!1}),computed:{bgColor:{get(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set(e){this.vuexHistory.transaction(()=>{this.$store.commit("panels/setBackgroundColor",{color:e,panelId:this.$store.state.panels.currentPanel})})}},backgrounds(){return[...this.$store.state.content.current.backgrounds.map(e=>e.id),"buildin.static-color","buildin.transparent"]},showBackgroundsFolder(){return X.supports.openableFolders.has("backgrounds")}},methods:{setBackground(e){this.$store.commit("panels/setCurrentBackground",{current:e,panelId:this.$store.state.panels.currentPanel})},onFileUpload(e){const t=this.$refs.upload;if(!!t.files)for(const o of t.files)this.addImageFile(o)},addImageFile(e){return xc(this,null,function*(){yield this.vuexHistory.transaction(()=>xc(this,null,function*(){const t=URL.createObjectURL(e),o=yield this.$store.dispatch("uploadUrls/add",{name:e.name,url:t});this.addNewCustomBackground(e.name,e.name,o)}))})},addByUrl(){const e=prompt("Enter the URL of the image");if(e==null)return;const t=e.split("/").slice(-1)[0];this.addNewCustomBackground(t,t,e)},addNewCustomBackground(e,t,o){const n=this.$store.state.content.contentPacks.find(r=>r.packId===jc.packId)||jc,s=vO(bO({},n),{backgrounds:[...n.backgrounds,{id:e,label:t,variants:[[o]],scaling:"none"}]});this.vuexHistory.transaction(()=>{this.$store.dispatch("content/replaceContentPack",{contentPack:s}),this.setBackground(e)})},dragEnter(e){!e.dataTransfer||(e.dataTransfer.effectAllowed="none",Array.from(e.dataTransfer.items).find(t=>t.type.match(/^image.*$/))&&(e.dataTransfer.effectAllowed="link",this.$refs.dt.show()))},openBackgroundFolder(){X.openFolder("backgrounds")}}});const _p=e=>(Ne("data-v-dd870fc5"),e=e(),Le(),e),_O=O("Drop here to add as a new background "),wO=_p(()=>u("h1",null,"Background",-1)),$O=O(" Upload "),CO=_p(()=>u("i",{class:"material-icons"},"extension",-1)),PO=O(" Search in content packs "),kO=[CO,PO],SO=O(" Open backgrounds folder ");function OO(e,t,o,n,s,r){const i=A("drop-target"),a=A("color"),l=A("image-options"),d=A("background-settings"),c=A("d-button"),f=A("background-button");return m(),_("div",{class:"panel",onDragenter:t[9]||(t[9]=(...p)=>e.dragEnter&&e.dragEnter(...p)),onMouseleave:t[10]||(t[10]=p=>e.$refs.dt.hide())},[w(i,{ref:"dt",class:"drop-target",onDrop:e.addImageFile},{default:T(()=>[_O]),_:1},8,["onDrop"]),wO,e.colorSelect?(m(),W(a,{key:0,modelValue:e.bgColor,"onUpdate:modelValue":t[0]||(t[0]=p=>e.bgColor=p),onLeave:t[1]||(t[1]=p=>e.colorSelect=!1)},null,8,["modelValue"])):e.imageOptions?(m(),W(l,{key:1,type:"background",title:"","panel-id":e.$store.state.panels.currentPanel,"no-composition":"",onLeave:t[2]||(t[2]=p=>e.imageOptions=!1)},null,8,["panel-id"])):(m(),_(N,{key:2},[w(d,{onChangeColor:t[3]||(t[3]=p=>e.colorSelect=!0),onOpenImageOptions:t[4]||(t[4]=p=>e.imageOptions=!0)}),u("button",{class:"btn upload-background",onClick:t[6]||(t[6]=p=>e.$refs.upload.click())},[$O,u("input",{type:"file",ref:"upload",onChange:t[5]||(t[5]=(...p)=>e.onFileUpload&&e.onFileUpload(...p))},null,544)]),u("button",{class:"upload-background",onClick:t[7]||(t[7]=(...p)=>e.addByUrl&&e.addByUrl(...p))},"Add by URL"),u("button",{class:"upload-background",onClick:t[8]||(t[8]=p=>e.$emit("show-dialog","type: Backgrounds"))},kO),e.showBackgroundsFolder?(m(),W(c,{key:0,icon:"folder",class:"upload-background",onClick:e.openBackgroundFolder},{default:T(()=>[SO]),_:1},8,["onClick"])):q("",!0),(m(!0),_(N,null,$e(e.backgrounds,p=>(m(),W(f,{key:p,backgroundId:p,onInput:b=>e.setBackground(p)},null,8,["backgroundId","onInput"]))),128))],64))],32)}const xO=ne(yO,[["render",OO],["__scopeId","data-v-dd870fc5"]]);var jO=Object.defineProperty,IO=Object.defineProperties,TO=Object.getOwnPropertyDescriptors,Ic=Object.getOwnPropertySymbols,EO=Object.prototype.hasOwnProperty,BO=Object.prototype.propertyIsEnumerable,Tc=(e,t,o)=>t in e?jO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,AO=(e,t)=>{for(var o in t||(t={}))EO.call(t,o)&&Tc(e,o,t[o]);if(Ic)for(var o of Ic(t))BO.call(t,o)&&Tc(e,o,t[o]);return e},DO=(e,t)=>IO(e,TO(t)),RO=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const HO={},MO={createSprite(e,t){return RO(this,arguments,function*({commit:o,rootState:n,state:s},r){const i=yield wr(r.assets[0],!1);if(!(i instanceof mf))return;const a=s.panels[r.panelId].lastObjId+1;return o("create",{object:DO(AO({},$n()),{assets:r.assets,height:i.height,width:i.width,id:a,panelId:n.panels.currentPanel,onTop:!1,preserveRatio:!0,ratio:i.width/i.height,type:"sprite",y:0,enlargeWhenTalking:n.ui.defaultCharacterTalkingZoom})}),a})}};var FO=Object.defineProperty,NO=Object.defineProperties,LO=Object.getOwnPropertyDescriptors,Ec=Object.getOwnPropertySymbols,VO=Object.prototype.hasOwnProperty,WO=Object.prototype.propertyIsEnumerable,Bc=(e,t,o)=>t in e?FO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,zO=(e,t)=>{for(var o in t||(t={}))VO.call(t,o)&&Bc(e,o,t[o]);if(Ec)for(var o of Ec(t))WO.call(t,o)&&Bc(e,o,t[o]);return e},UO=(e,t)=>NO(e,LO(t));const GO={setChoicesProperty(e,t){const o=e.panels[t.panelId].objects[t.id];o[t.key]=t.value,++o.version},setChoiceProperty(e,t){const o=e.panels[t.panelId].objects[t.id];o.choices[t.choiceIdx][t.key]=t.value,++o.version},setChoices(e,t){const o=e.panels[t.panelId].objects[t.id];o.choices=t.choices,++o.version}},qO={createChoice({commit:e,rootState:t,state:o},n){const s=K(),r=o.panels[n.panelId].lastObjId+1;return e("create",{object:UO(zO({},$n()),{y:s.Choices.ChoiceY,width:s.Choices.ChoiceButtonWidth,height:0,panelId:t.panels.currentPanel,id:r,onTop:!0,autoWrap:!0,type:"choice",preserveRatio:!1,ratio:s.TextBox.TextBoxWidth/s.TextBox.TextBoxHeight,choiceDistance:s.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:s.Choices.ChoiceButtonColor})}),r},addChoice({state:e,commit:t},o){const n=e.panels[o.panelId].objects[o.id];t("setChoices",{id:o.id,panelId:o.panelId,choices:[...n.choices,{selected:!1,text:o.text}]})},removeChoice({state:e,commit:t},o){const s=[...e.panels[o.panelId].objects[o.id].choices];s.splice(o.choiceIdx,1),s.length===0&&s.push({selected:!1,text:""}),t("setChoices",{id:o.id,panelId:o.panelId,choices:s})}};var XO=Object.defineProperty,KO=Object.defineProperties,YO=Object.getOwnPropertyDescriptors,Ac=Object.getOwnPropertySymbols,JO=Object.prototype.hasOwnProperty,ZO=Object.prototype.propertyIsEnumerable,Dc=(e,t,o)=>t in e?XO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,QO=(e,t)=>{for(var o in t||(t={}))JO.call(t,o)&&Dc(e,o,t[o]);if(Ac)for(var o of Ac(t))ZO.call(t,o)&&Dc(e,o,t[o]);return e},ex=(e,t)=>KO(e,YO(t));const tx={setNotificationProperty(e,t){const o=e.panels[t.panelId].objects[t.id];o[t.key]=t.value,++o.version}},ox={createNotification({commit:e,rootState:t,state:o},n){const s=K(),r=o.panels[n.panelId].lastObjId+1;return e("create",{object:ex(QO({},$n()),{y:s.Base.screenHeight/2,width:s.Choices.ChoiceButtonWidth,height:0,panelId:t.panels.currentPanel,autoWrap:!1,id:r,onTop:!0,type:"notification",preserveRatio:!1,ratio:s.TextBox.TextBoxWidth/s.TextBox.TextBoxHeight,customColor:s.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),r}};var nx=Object.defineProperty,sx=Object.defineProperties,rx=Object.getOwnPropertyDescriptors,Rc=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Hc=(e,t,o)=>t in e?nx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,ax=(e,t)=>{for(var o in t||(t={}))ix.call(t,o)&&Hc(e,o,t[o]);if(Rc)for(var o of Rc(t))lx.call(t,o)&&Hc(e,o,t[o]);return e},dx=(e,t)=>sx(e,rx(t));const cx={setPoemProperty(e,t){const o=e.panels[t.panelId].objects[t.id];o[t.key]=t.value,++o.version}},ux={createPoem({commit:e,rootState:t,state:o},n){const s=K(),r=o.panels[n.panelId].lastObjId+1;return e("create",{object:{subType:"poem",x:s.Poem.defaultX,y:s.Poem.defaultY,width:s.Poem.defaultPoemWidth,height:s.Poem.defaultPoemHeight,panelId:t.panels.currentPanel,flip:!1,rotation:0,id:r,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:s.Poem.defaultPoemWidth/s.Poem.defaultPoemHeight,background:s.Poem.defaultPoemBackground,font:s.Poem.defaultPoemStyle,text:`New poem

Click here to edit poem`,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,zoom:1}}),r},createConsole({commit:e,rootState:t,state:o},n){const s=K(),r=o.panels[n.panelId].lastObjId+1;return e("create",{object:dx(ax({},$n()),{subType:"console",x:s.Poem.consoleWidth/2,y:s.Poem.consoleHeight/2,width:s.Poem.consoleWidth,height:s.Poem.consoleHeight,panelId:t.panels.currentPanel,id:r,onTop:!0,type:"poem",preserveRatio:!1,ratio:s.Poem.consoleWidth/s.Poem.consoleHeight,background:s.Poem.defaultConsoleBackground,font:s.Poem.defaultConsoleStyle,text:`> _
  
  Console command
  Click here to edit`,autoWrap:!0})}),r}};var fx=Object.defineProperty,px=Object.defineProperties,hx=Object.getOwnPropertyDescriptors,Mc=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,mx=Object.prototype.propertyIsEnumerable,Fc=(e,t,o)=>t in e?fx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Xe=(e,t)=>{for(var o in t||(t={}))gx.call(t,o)&&Fc(e,o,t[o]);if(Mc)for(var o of Mc(t))mx.call(t,o)&&Fc(e,o,t[o]);return e},Nc=(e,t)=>px(e,hx(t));const bx=Xe(Xe(Xe(Xe(Xe(Xe({create(e,{object:t}){const o=e.panels[t.panelId];t.id>o.lastObjId&&(o.lastObjId=t.id),o.objects[t.id]=t,(t.onTop?o.onTopOrder:o.order).push(t.id)},removeFromList(e,t){const o=e.panels[t.panelId],n=t.onTop?o.onTopOrder:o.order,s=n.indexOf(t.id);n.splice(s,1)},addToList(e,t){const o=e.panels[t.panelId];(t.onTop?o.onTopOrder:o.order).splice(t.position,0,t.id)},setOnTop(e,t){const n=e.panels[t.panelId].objects[t.id];n.onTop=t.onTop},setPosition(e,t){const n=e.panels[t.panelId].objects[t.id];n.x=t.x,n.y=t.y},setFlip(e,t){const n=e.panels[t.panelId].objects[t.id];n.flip=t.flip},setSize(e,t){const n=e.panels[t.panelId].objects[t.id];n.width=t.width,n.height=t.height},setRatio(e,t){const n=e.panels[t.panelId].objects[t.id];n.preserveRatio=t.preserveRatio,n.ratio=t.ratio},setRotation(e,t){const n=e.panels[t.panelId].objects[t.id];n.rotation=t.rotation<0?360-Math.abs(t.rotation)%360:t.rotation%360},removeObject(e,t){const o=e.panels[t.panelId];delete o.objects[t.id]},setComposition(e,t){const n=e.panels[t.panelId].objects[t.id];n.composite=t.composite},object_setFilters(e,t){const n=e.panels[t.panelId].objects[t.id];n.filters=t.filters},setLabel(e,t){const n=e.panels[t.panelId].objects[t.id];n.label=t.label},setTextboxColor(e,t){const n=e.panels[t.panelId].objects[t.id];n.textboxColor=t.textboxColor},setEnlargeWhenTalking(e,t){const n=e.panels[t.panelId].objects[t.id];n.enlargeWhenTalking=t.enlargeWhenTalking,++n.version},setObjectNameboxWidth(e,t){const n=e.panels[t.panelId].objects[t.id];n.nameboxWidth=t.nameboxWidth,++n.version},setObjectZoom(e,t){const n=e.panels[t.panelId].objects[t.id];n.zoom=t.zoom,++n.version}},HO),n$),lk),GO),tx),cx),vx=Xe(Xe(Xe(Xe(Xe(Xe({removeObject({state:e,commit:t,rootState:o},n){var s;const r=e.panels[n.panelId],i=r.objects[n.id];o.ui.selection===n.id&&t("ui/setSelection",null,{root:!0});for(const a of[...r.onTopOrder,...r.order]){const l=r.objects[a];i.id===a||l.type!=="textBox"||l.talkingObjId===i.id&&t("setTalkingOther",{id:l.id,talkingOther:(s=i.label)!=null?s:"",panelId:n.panelId})}t("removeFromList",{id:n.id,panelId:n.panelId,onTop:i.onTop}),t("removeObject",{id:n.id,panelId:n.panelId})},setPosition({state:e,commit:t,dispatch:o},n){e.panels[n.panelId].objects[n.id].type==="character"?o("setCharacterPosition",n):t("setPosition",n)},setOnTop({state:e,commit:t},o){const n=e.panels[o.panelId],s=n.objects[o.id];s.onTop!==o.onTop&&(t("removeFromList",{panelId:o.panelId,id:o.id,onTop:s.onTop}),t("addToList",{id:o.id,panelId:o.panelId,position:(o.onTop?n.onTopOrder:n.order).length,onTop:o.onTop}),t("setOnTop",{panelId:o.panelId,id:o.id,onTop:o.onTop}))},shiftLayer({state:e,commit:t},o){const n=e.panels[o.panelId],s=n.objects[o.id],r=s.onTop?n.onTopOrder:n.order;let a=r.indexOf(s.id)+o.delta;a<0&&(a=0),a>r.length&&(a=r.length),t("removeFromList",{panelId:o.panelId,id:o.id,onTop:s.onTop}),t("addToList",{panelId:o.panelId,id:o.id,position:a,onTop:s.onTop})},setPreserveRatio({commit:e,state:t},o){const s=t.panels[o.panelId].objects[o.id],r=o.preserveRatio?s.width/s.height:0;e("setRatio",{panelId:o.panelId,id:o.id,preserveRatio:o.preserveRatio,ratio:r})},setWidth({commit:e,state:t},o){const s=t.panels[o.panelId].objects[o.id],r=s.preserveRatio?o.width/s.ratio:s.height;e("setSize",{panelId:o.panelId,id:o.id,height:r,width:o.width})},setHeight({commit:e,state:t},o){const s=t.panels[o.panelId].objects[o.id],r=s.preserveRatio?o.height*s.ratio:s.width;e("setSize",{panelId:o.panelId,id:o.id,height:o.height,width:r})},copyObjects({commit:e,state:t},{sourcePanelId:o,targetPanelId:n}){const s=t.panels[o],r=t.panels[n],i=[...s.onTopOrder,...s.order],a=new Map;let l=r.lastObjId;for(const d of i){const c=++l;a.set(d,c)}for(const d of i){const c=s.objects[d],f=JSON.parse(JSON.stringify(c));if("talkingObjId"in f){const p=f;p.talkingObjId!==null&&p.talkingObjId!=="$other$"&&a.has(p.talkingObjId)&&(p.talkingObjId=a.get(p.talkingObjId))}e("create",{object:Nc(Xe({},f),{id:a.get(d),panelId:n})})}},copyObjectToClipboard({commit:e,state:t},{id:o,panelId:n}){const s=t.panels[n].objects[o];e("ui/setClipboard",JSON.stringify(s),{root:!0})},pasteObjectFromClipboard({commit:e,state:t,rootState:o}){if(o.ui.clipboard==null)return;const n=JSON.parse(o.ui.clipboard);e("create",{object:Nc(Xe({},n),{id:t.panels[t.currentPanel].lastObjId+1,panelId:t.currentPanel})})},object_addFilter({state:e,commit:t},o){nl(o,()=>e.panels[o.panelId].objects[o.id],n=>t("object_setFilters",n))},object_removeFilter({state:e,commit:t},o){sl(o,()=>e.panels[o.panelId].objects[o.id],n=>t("object_setFilters",n))},object_moveFilter({state:e,commit:t},o){rl(o,()=>e.panels[o.panelId].objects[o.id],n=>t("object_setFilters",n))},object_setFilter({state:e,commit:t},o){il(o,()=>e.panels[o.panelId].objects[o.id],n=>t("object_setFilters",n))}},MO),r$),ak),qO),ox),ux);function yx(e,t){const o=e.state.panels;for(const n in o){const s=o[n];for(const r in s.objects){const i=s.objects[r];if(i.type==="character"){i$(e,i.panelId,i.id,t);return}}}}var _x=Object.defineProperty,wx=Object.defineProperties,$x=Object.getOwnPropertyDescriptors,Lc=Object.getOwnPropertySymbols,Cx=Object.prototype.hasOwnProperty,Px=Object.prototype.propertyIsEnumerable,Vc=(e,t,o)=>t in e?_x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,pi=(e,t)=>{for(var o in t||(t={}))Cx.call(t,o)&&Vc(e,o,t[o]);if(Lc)for(var o of Lc(t))Px.call(t,o)&&Vc(e,o,t[o]);return e},kx=(e,t)=>wx(e,$x(t)),Ns=(e=>(e[e.None=0]="None",e[e.Stretch=1]="Stretch",e[e.Cover=2]="Cover",e))(Ns||{});const Sx="buildin.transparent",Ts={panelToUrl:new Map,urlToPanel:new Map,register(e,t){if(this.panelToUrl.has(e)){if(this.panelToUrl.get(e)===t)return;this.unregister(e,this.panelToUrl.get(e))}this.panelToUrl.set(e,t),this.urlToPanel.has(t)?this.urlToPanel.get(t).push(e):this.urlToPanel.set(t,[e])},unregister(e,t){if(this.urlToPanel.has(t)){const o=this.urlToPanel.get(t);o.splice(o.indexOf(e),1),o.length===0&&(this.urlToPanel.delete(t),URL.revokeObjectURL(t))}this.panelToUrl.delete(e)}},Ox={namespaced:!0,state:{lastPanelId:-1,panels:{},panelOrder:[],currentPanel:null},mutations:pi({setCurrentPanel(e,{panelId:t}){e.currentPanel=t},setPanelPreview(e,{panelId:t,url:o}){e.panels[t].lastRender=o,Ts.register(t,o)},createPanel(e,{panel:t}){e.lastPanelId=t.id,e.panels[t.id]=t},setPanelOrder(e,{panelOrder:t}){e.panelOrder=[...t]},setCurrentBackground(e,{current:t,panelId:o}){const n=e.panels[o];n.background.current=t,n.background.variant=0},setBackgroundColor(e,{color:t,panelId:o}){const n=e.panels[o];n.background.color=t},setBackgroundFlipped(e,{flipped:t,panelId:o}){const n=e.panels[o];n.background.flipped=t},setBackgroundVariant(e,{variant:t,panelId:o}){const n=e.panels[o];n.background.variant=t},setBackgroundScaling(e,{scaling:t,panelId:o}){const n=e.panels[o];n.background.scaling=t},deletePanel(e,{panelId:t}){Ts.unregister(t,Ts.panelToUrl.get(t)),delete e.panels[t]},setComposition(e,t){const o=e.panels[t.panelId];o.composite=t.composite},setFilters(e,t){const o=e.panels[t.panelId];o.filters=t.filters},backgroundSetComposition(e,t){const o=e.panels[t.panelId];o.background.composite=t.composite},backgroundSetFilters(e,t){const o=e.panels[t.panelId];o.background.filters=t.filters}},bx),actions:pi({createPanel({state:e,commit:t}){const o=e.lastPanelId+1;return t("createPanel",{panel:{id:o,background:{color:"#000000",current:Sx,flipped:!1,scaling:2,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[],objects:{},onTopOrder:[],order:[],lastObjId:-1}}),t("setPanelOrder",{panelOrder:[...e.panelOrder,o]}),t("setCurrentPanel",{panelId:o}),o},duplicatePanel({state:e,commit:t},{panelId:o}){const n=e.panels[o],s=e.lastPanelId+1;Ts.register(s,n.lastRender);const r=JSON.parse(JSON.stringify(n));let i=-1;const a=new Map,l={};for(const c in r.objects)a.set(+c,++i);for(const c in r.objects){const f=r.objects[c],p=a.get(+c);if(l[p]=f,f.panelId=s,f.id=p,"talkingObjId"in f){const b=f;b.talkingObjId!==null&&b.talkingObjId!=="$other$"&&a.has(b.talkingObjId)&&(b.talkingObjId=a.get(b.talkingObjId))}}t("createPanel",{panel:kx(pi({},r),{id:s,lastObjId:i,objects:l,order:r.order.map(c=>a.get(c)),onTopOrder:r.onTopOrder.map(c=>a.get(c))})});const d=e.panelOrder.indexOf(o);t("setPanelOrder",{panelOrder:[...e.panelOrder.slice(0,d+1),s,...e.panelOrder.slice(d+1)]}),t("setCurrentPanel",{panelId:s})},seekBackgroundVariant({state:e,rootGetters:t,commit:o},{delta:n}){const s=e.panels[e.currentPanel],i=t["content/getBackgrounds"].get(s.background.current);!i||o("setBackgroundVariant",{panelId:e.currentPanel,variant:Nn(i.variants,s.background.variant,n)})},delete({state:e,commit:t},{panelId:o}){if(e.panelOrder.length<=1)return;const n=e.panelOrder.indexOf(o);let s;n===e.panelOrder.length-1?s=n-1:s=n+1,t("setCurrentPanel",{panelId:e.panelOrder[s]}),t("setPanelOrder",{panelOrder:[...e.panelOrder.slice(0,n),...e.panelOrder.slice(n+1)]}),t("deletePanel",{panelId:o})},fixContentPackRemoval(e,t){const{state:o,rootGetters:n,commit:s,rootState:r}=e;for(const i of Object.values(o.panels)){const a=t.backgrounds.find(f=>f.id===i.background.current);if(!a)return;const l=n["content/getBackgrounds"].get(i.background.current);if(!l){r.content.current.backgrounds.length>0?s("setCurrentBackground",{current:r.content.current.backgrounds[0].id,panelId:i.id}):s("setCurrentBackground",{current:"buildin.transparent",panelId:i.id});return}const d=JSON.stringify(a.variants[i.background.variant]),c=l.variants.findIndex(f=>JSON.stringify(f)===d);c!==i.background.variant&&s("setBackgroundVariant",{variant:c===-1?0:c,panelId:i.id})}yx(e,t)},move({state:e,commit:t},{panelId:o,delta:n}){const s=[...e.panelOrder],r=s.indexOf(o);s.splice(r,1);const i=Math.max(r+n,0);s.splice(i,0,o),t("setPanelOrder",{panelOrder:s})},addFilter({state:e,commit:t},o){nl(o,()=>e.panels[o.panelId],n=>t("setFilters",n))},removeFilter({state:e,commit:t},o){sl(o,()=>e.panels[o.panelId],n=>t("setFilters",n))},moveFilter({state:e,commit:t},o){rl(o,()=>e.panels[o.panelId],n=>t("setFilters",n))},setFilter({state:e,commit:t},o){il(o,()=>e.panels[o.panelId],n=>t("setFilters",n))},backgroundAddFilter({state:e,commit:t},o){nl(o,()=>e.panels[o.panelId].background,n=>t("backgroundSetFilters",n))},backgroundRemoveFilter({state:e,commit:t},o){sl(o,()=>e.panels[o.panelId].background,n=>t("backgroundSetFilters",n))},backgroundMoveFilter({state:e,commit:t},o){rl(o,()=>e.panels[o.panelId].background,n=>t("backgroundSetFilters",n))},backgroundSetFilter({state:e,commit:t},o){il(o,()=>e.panels[o.panelId].background,n=>t("backgroundSetFilters",n))}},vx)};var wp=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class xx{constructor(t,o,n,s,r,i){this.id=t,this.assets=o,this.flip=n,this.scale=s,this.compositeMode=r,this.filters=i}render(t){return wp(this,null,function*(){const{screenWidth:o,screenHeight:n}=K().Base,s=yield Promise.all(this.assets.map(r=>wr(r,t.hq)));for(const r of s){let i=0,a=0,l=r.width,d=r.height;switch(this.scale){case Ns.None:i=o/2-l/2,a=n/2-d/2;break;case Ns.Stretch:l=o,d=n;break;case Ns.Cover:const c=l/d,f=o/n;c>f?(d=n,l=d*c):(l=o,d=l/c),i=o/2-l/2,a=n/2-d/2}t.drawImage({image:r,x:i,y:a,w:l,h:d,flip:this.flip,composite:this.compositeMode,filters:this.filters})}})}}const Wc={id:"buildin.static-color",name:"Static color",color:"#000000",render(e){return wp(this,null,function*(){const{screenWidth:t,screenHeight:o}=K().Base;e.drawRect({x:0,y:0,w:t,h:o,fill:{style:this.color}})})}};var jx=Object.defineProperty,Ix=(e,t,o)=>t in e?jx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Tx=(e,t,o)=>(Ix(e,typeof t!="symbol"?t+"":t,o),o),$p=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class Cp extends gp{constructor(){super(...arguments),Tx(this,"refTextbox",null)}get canvasDrawWidth(){return this.width*this.objZoom}get canvasDrawHeight(){return this.height*this.objZoom}get canvasDrawPosX(){return this.x-this.width/2+(this.height-this.canvasDrawHeight)/2}get canvasDrawPosY(){return this.y+(this.height-this.canvasDrawHeight)}get allowSkippingLocalCanvas(){return!1}get objZoom(){return(this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1)*this.obj.zoom}getHitbox(){const t=super.getHitbox(),o=this.width*(this.objZoom-1),n=this.height*(this.objZoom-1);return{x0:t.x0-o/2,x1:t.x1+o/2,y0:t.y0-n,y1:t.y1}}updatedContent(t,o){const n=t.state.panels.panels[o],s=[...n.order,...n.onTopOrder];this.refTextbox=null;for(const r of s){const i=t.state.panels.panels[o].objects[r];if(i.type==="textBox"&&i.talkingObjId===this.obj.id){this.refTextbox=i;return}}}renderLocal(t){return $p(this,null,function*(){const o=this.getAssetList(),n=yield Promise.all(o.filter(s=>s.assets).map(s=>Ex(s,t.hq)));for(const s of n)for(const r of s.assets)t.drawImage({image:r,composite:s.composite,x:s.offset[0],y:s.offset[1]})})}}function Ex(e,t){return $p(this,null,function*(){return"loaded"in e?e:{loaded:!0,offset:e.offset,assets:yield Promise.all(e.assets.map(o=>wr(o,t))),composite:e.composite}})}var Bx=Object.defineProperty,Ax=(e,t,o)=>t in e?Bx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Es=(e,t,o)=>(Ax(e,typeof t!="symbol"?t+"":t,o),o),Dx=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class Rx extends Cp{constructor(t){super(t),Es(this,"assets"),Es(this,"ready",null),Es(this,"canvasHeight",0),Es(this,"canvasWidth",0),this.init()}get version(){return this.assets===null?-1:this.obj.version}init(){return Dx(this,null,function*(){let t;this.ready=new Promise((r,i)=>{t=r});const o=yield Promise.all(this.obj.assets.map(r=>wr(r)));let n=0,s=0;for(const r of o)r.height>s&&(s=r.height),r.width>n&&(n=r.width);this.canvasWidth=n,this.canvasHeight=s,this.assets=[{loaded:!0,assets:o,offset:[0,0]}],t()})}getAssetList(){var t;return(t=this.assets)!=null?t:[]}}var Hx=Object.defineProperty,Mx=(e,t,o)=>t in e?Hx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Fx=(e,t,o)=>(Mx(e,typeof t!="symbol"?t+"":t,o),o);class Nx extends Cp{constructor(t,o){super(t),this.data=o,Fx(this,"scaleable",!0)}updatedContent(t,o){super.updatedContent(t,o),this.data=Ir(t,this.obj)}getAssetList(){const t=uo(this.data,this.obj),o=Yi(this.data,this.obj),n=[];for(const s of t.renderCommands)switch(s.type){case"head":n.push({offset:s.offset,composite:s.composite,assets:o?o.variants[this.obj.posePositions.head||0]:[]});break;case"image":n.push({offset:s.offset,composite:s.composite,assets:s.images});break;case"pose-part":const r=t.positions[s.part];if(!r||r.length===0)break;const i=r[this.obj.posePositions[s.part]||0];if(!i)break;n.push({offset:s.offset,composite:s.composite,assets:i});break}return n}get canvasHeight(){return uo(this.data,this.obj).size[1]}get canvasWidth(){return uo(this.data,this.obj).size[0]}get closeZoom(){let t=1;return this.obj.close&&(t*=2),t}get width(){return this.obj.width*this.closeZoom}get height(){return this.obj.height*this.closeZoom}}var Lx=Object.defineProperty,Vx=(e,t,o)=>t in e?Lx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,zc=(e,t,o)=>(Vx(e,typeof t!="symbol"?t+"":t,o),o),Uc=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class Wx extends Cn{constructor(){super(...arguments),zc(this,"_height",0),zc(this,"choiceRenderers",[])}get height(){return this._height}get centeredVertically(){return!0}draw(t){return Uc(this,null,function*(){yield this.updateChoiceBounds();const o=K(),n=this.obj.width,s=this.height,r=n/2,a=(this.flip?o.Base.screenWidth-this.obj.x:this.obj.x)-r;let l=this.obj.y-s/2;for(const d of this.choiceRenderers){yield d.loadFonts();const c=d.getHeight(this.obj.autoWrap?this.obj.width:0);t.drawRect({x:a,y:l,w:n,h:c+o.Choices.ChoicePadding*2,outline:{style:o.Choices.ChoiceButtonBorderColor,width:o.Choices.Outline},fill:{style:o.Choices.ChoiceButtonColor}}),d.fixAlignment("center",a,a+n,l+o.Choices.ChoiceSpacing*1.25,this.obj.autoWrap?n:0),d.render(t.fsCtx),l+=c+o.Choices.ChoicePadding*2+o.Choices.ChoiceSpacing}})}updateChoiceBounds(){return Uc(this,null,function*(){const t=K();this.choiceRenderers=this.obj.choices.map(o=>new dt(o.text||" ",t.Choices.ChoiceTextStyle)),this._height=this.choiceRenderers.reduce((o,n)=>o+n.getHeight(this.obj.autoWrap?this.obj.width:0)+t.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1)})}}var zx=Object.defineProperty,Ux=Object.getPrototypeOf,Gx=Reflect.get,qx=(e,t,o)=>t in e?zx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Gc=(e,t,o)=>(qx(e,typeof t!="symbol"?t+"":t,o),o),Xx=(e,t,o)=>Gx(Ux(e),o,t),qc=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});class _a extends Cn{constructor(){super(...arguments),Gc(this,"_height",0),Gc(this,"_width",0)}get height(){return this._height}get width(){return this._width}get centeredVertically(){return!0}get id(){return this.obj.id}render(t,o,n){return qc(this,null,function*(){const s=K();this.obj.backdrop&&o.drawRect({x:0,y:0,w:s.Base.screenWidth,h:s.Base.screenHeight,fill:{style:K().Notification.NotificationBackdropColor}}),yield Xx(_a.prototype,this,"render").call(this,t,o,n)})}draw(t){return qc(this,null,function*(){const o=K(),n=new dt(this.obj.text,o.Notification.NotificationTextStyle),s=new dt("OK",o.Notification.NotificationOkTextStyle);yield n.loadFonts(),yield s.loadFonts();const r=this.obj.autoWrap?this.obj.width-o.Notification.NotificationPadding*2:0,i=this.obj.autoWrap?r:n.getWidth(),a=n.getHeight(r),l=this.obj.autoWrap?r:s.getWidth(),d=s.getHeight(r),c=this._width=Math.max(i,l)+o.Notification.NotificationPadding*2,f=this._height=a+o.Notification.NotificationPadding*2+o.Notification.NotificationSpacing+d,p=c/2,v=(this.flip?o.Base.screenWidth-this.obj.x:this.obj.x)-p,C=this.obj.y-f/2;t.drawRect({x:v,y:C,w:c,h:f,outline:{style:o.Choices.ChoiceButtonBorderColor,width:3},fill:{style:o.Choices.ChoiceButtonColor}}),n.fixAlignment("center",v,v+c,C+o.Notification.NotificationPadding*1.5,r),n.render(t.fsCtx),s.fixAlignment("center",v,v+c,C+f-o.Notification.NotificationPadding,r),s.render(t.fsCtx)})}}var Kx=Object.defineProperty,Yx=(e,t,o)=>t in e?Kx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Xc=(e,t,o)=>(Yx(e,typeof t!="symbol"?t+"":t,o),o),Jx=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Zx=-2,Qx=26,ej=10,tj=10;class oj extends Cn{constructor(){super(...arguments),Xc(this,"_height",0),Xc(this,"_width",0)}get height(){return this._height}get width(){return this._width}get centeredVertically(){return!0}draw(t){return Jx(this,null,function*(){const o=K(),n=o.Poem.poemBackgrounds[this.obj.background],s=this.flip?o.Base.screenWidth-this.obj.x:this.obj.x;let r=this.obj.y,i=s+tj,a=o.Poem.poemPadding,l=o.Poem.poemTopPadding,d=a*2;if(n.file==="internal:console"){const p=this._height=this.obj.height,b=this._width=this.obj.width;t.drawRect({x:s-b/2,y:this.obj.y-p/2,h:p,w:b,fill:{style:o.Poem.consoleBackgroundColor}}),a=Zx,l=Qx,d=ej}else if(n.file==="internal:transparent")this._height=this.obj.height,this._width=this.obj.width;else{const p=yield vf(`assets/poemBackgrounds/${n.file}`);t.drawImage({image:p,x:s-p.width/2,y:this.obj.y-p.height/2}),this._height=p.height,this._width=p.width}r-=this.height/2,i-=this.width/2;const c=o.Poem.poemTextStyles[this.obj.font],f=new dt(this.obj.text,c);yield f.loadFonts(),f.fixAlignment("left",i+a,i+a,r+l+a,this.obj.autoWrap?this.width-d:0),f.render(t.fsCtx)})}}var nj=Object.defineProperty,sj=(e,t,o)=>t in e?nj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ls=(e,t,o)=>(sj(e,typeof t!="symbol"?t+"":t,o),o),rj=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const Pp=class{constructor(e,t,o,n){this.store=e,this._panelId=t,this.canvasWidth=o,this.canvasHeight=n,Ls(this,"renderObjectCache",new Map),Ls(this,"renderer"),Ls(this,"_disposed",!1),this.renderer=new hs(o,n)}get panelId(){return this._panelId}setPanelId(e){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==e&&(this._panelId=e,this.renderObjectCache.forEach(t=>{t.dispose()}),this.renderObjectCache.clear())}render(e,t,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),e,t):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const e=new Date,t=`panel-${[e.getFullYear(),`${e.getMonth()+1}`.padStart(2,"0"),`${e.getDate()}`.padStart(2,"0"),`${e.getHours()}`.padStart(2,"0"),`${e.getMinutes()}`.padStart(2,"0"),`${e.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),t)}paintOnto(e,t){this.renderer.paintOnto(e,t)}objectsAt(e,t){return this.getRenderObjects().filter(o=>o.hitTest(e,t)).map(o=>o.id)}renderCallback(e,t){return rj(this,null,function*(){var o;if(this._disposed)throw new Error("Disposed scene-renderer called");t.fsCtx.imageSmoothingEnabled=!0,t.fsCtx.imageSmoothingQuality=t.hq?"high":"low",yield(o=this.getBackgroundRenderer())==null?void 0:o.render(t);const n=this.store.state.ui.selection;for(const s of this.getRenderObjects()){s.updatedContent(this.store,this.panelId);const r=n===s.id,i=document.querySelector(Pp.FocusProp),a=(i==null?void 0:i.getAttribute("data-obj-id"))===""+s.id;yield s.render((r?Ln.Selected:Ln.None)+(a?Ln.Focused:Ln.None),t,e)}t.applyFilters([...this.panel.filters]),t.preview&&t.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:yield rn("backgrounds/transparent")})})}getRenderObjects(){const e=this.store.state.panels.panels[this.panelId],t=[...e.order,...e.onTopOrder],o=e.objects,n=Array.from(this.renderObjectCache.keys()).filter(s=>!t.includes(s));for(const s of n)this.renderObjectCache.get(s).dispose(),this.renderObjectCache.delete(s);return t.map(s=>{let r=this.renderObjectCache.get(s);if(!r){const i=o[s],a=i.type;switch(a){case"sprite":r=new Rx(i);break;case"character":const l=i;r=new Nx(l,Ir(this.store,l));break;case"textBox":r=new J0(i);break;case"choice":r=new Wx(i);break;case"notification":r=new _a(i);break;case"poem":r=new oj(i);break;default:throw new It.UnreachableCaseError(a)}this.renderObjectCache.set(s,r)}return r})}get panel(){return this.store.state.panels.panels[this.panelId]}getBackgroundRenderer(){const e=this.panel;switch(e.background.current){case"buildin.static-color":return Wc.color=e.background.color,Wc;default:const o=this.store.getters["content/getBackgrounds"].get(e.background.current);if(!o)return null;const n=o.variants[e.background.variant];return new xx(e.background.current,n,e.background.flipped,e.background.scaling,e.background.composite,e.background.filters)}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}};let wa=Pp;Ls(wa,"FocusProp",typeof CSS!="undefined"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");var De=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const ij=1.5,Kc=1/4,lj=.5,Yc=100,Jc=90,Zc=70,aj=oe({mixins:[ut],components:{DFieldset:Bt,DFlow:fs,DButton:$r,ImageOptions:ya},data:()=>({webpSupport:!1,heifSupport:!1,ppi:X.supports.limitedCanvasSpace?10:0,pages:"",format:"image/png",quality:Jc,imageOptions:!1,thumbnailCtx:null}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},isLossy(){return this.format!=="image/png"},canDeletePanel(){return this.panelButtons.length>1},panelButtons(){return this.$store.state.panels.panelOrder.map(t=>{const o=this.$store.state.panels.panels[t],n=this.$store.state.panels.panels[t],s=[...n.order,...n.onTopOrder].map(r=>this.$store.state.panels.panels[t].objects[r]).map(this.extractObjectText);return{id:t,image:o.lastRender,text:s.reduce((r,i)=>r.length>i.length?r:i,"")}})},canMoveAhead(){return this.$store.state.panels.panelOrder.indexOf(this.currentPanel.id)>0},canMoveBehind(){const e=this.$store.state.panels.panelOrder;return e.indexOf(this.currentPanel.id)<e.length-1}},created(){return De(this,null,function*(){fe.subscribe(Wl,()=>requestAnimationFrame(()=>this.renderThumbnail()));const e=K().Base,t=ss();t.width=e.screenWidth*Kc,t.height=e.screenHeight*Kc,this.thumbnailCtx=mr(t.getContext("2d")),[this.webpSupport,this.heifSupport]=yield Promise.all([Bo(),pb()])})},mounted(){this.moveFocusToActivePanel(),requestAnimationFrame(()=>this.renderThumbnail().catch(()=>{}))},unmounted(){un(this.thumbnailCtx.canvas)},methods:{download(){return De(this,null,function*(){yield Wi("export image",()=>De(this,null,function*(){const e=this.getPanelDistibution(),t=new Date,o=`cd-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}`,n=this.format.split("/")[1],s=this.format,r=this.quality;yield this.renderObjects(e,!0,(i,a)=>De(this,null,function*(){yield X.saveToFile(a,`${o}_${i}.${n}`,s,r/Yc)}))}))})},estimateExportSize(){return De(this,null,function*(){const e=this.getPanelDistibution(),t=this.format||"image/png",o=this.quality||Jc,s=(yield this.renderObjects(e,!1,(l,d)=>De(this,null,function*(){return new Promise((c,f)=>{d.toBlob(p=>{if(!p){f(`Image ${l+1} could not be rendered.`);return}c(p.size)},t,o/Yc)})}))).map(l=>(l*ij/1024/1024).toFixed(2)+"MiB"),r=s.length>1?"files":"file",i=s.length>1?"These":"It",a=s.length>1?"sizes":"size";fe.fire(new lt(`This would export ${s.length} ${r}. ${i} would have the following (aproximate) ${a}: ${s.join(",")}`))})},renderObjects(e,t,o){return De(this,null,function*(){const n=K().Base,s=[];for(let r=0;r<e.length;++r){const i=e[r],a=document.createElement("canvas");a.width=n.screenWidth,a.height=n.screenHeight*i.length;try{const l=a.getContext("2d");for(let d=0;d<i.length;++d){const c=i[d],f=new wa(this.$store,c,n.screenWidth,n.screenHeight);try{yield f.render(t,!1,!0),f.paintOnto(l,{x:0,y:n.screenHeight*d,w:n.screenWidth,h:n.screenHeight})}finally{f.dispose()}}s.push(yield o(r,a))}finally{un(a)}}return s})},getLimitedPanelList(){const e=this.$store.state.panels.panelOrder.length-1,t=0,o=this.pages.split(","),n=[];let s=!1;for(const r of o){const i=r.trim(),a=i.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!a){i!==""&&fe.fire(new lt(`Could not read '${r}' in the page list.`));continue}if(s=!0,a[2])n.push(parseInt(a[2],10)-1);else{const l=Math.max(parseInt(a[3],10)-1,t),d=Math.min(parseInt(a[4],10)-1,e);if(l==null||d==null||l>d)continue;for(let c=l;c<=d;++c)n.push(c)}}return s?n.sort((r,i)=>r-i).filter((r,i,a)=>a[i-1]!==r).map(r=>this.$store.state.panels.panelOrder[r]):this.$store.state.panels.panelOrder},getPanelDistibution(){const e=this.getLimitedPanelList();if(isNaN(this.ppi)&&(this.ppi=0),this.ppi===0)return[e];const t=[];for(let o=0;o<e.length/this.ppi;++o){const n=o*this.ppi,s=n+this.ppi;t.push([...e.slice(n,s)])}return t},moveFocusToActivePanel(){const e=this.$el.querySelector(".panel_button.active");e&&this.scrollIntoView(e)},scrollIntoView(e){const t=e.parentElement.parentElement;this.$store.state.ui.vertical?(t.scrollTop=e.offsetTop-t.clientHeight/2,t.scrollLeft=0):(t.scrollLeft=e.offsetLeft-t.clientWidth/2,t.scrollTop=0)},extractObjectText(e){switch(e.type){case"textBox":return e.text;case"notification":return e.text;case"poem":return e.text;case"choice":return e.choices.map(t=>`[${t.text}]`).join(`
`)}return""},addNewPanel(){return De(this,null,function*(){yield this.vuexHistory.transaction(()=>De(this,null,function*(){yield this.$store.dispatch("panels/duplicatePanel",{panelId:this.$store.state.panels.currentPanel})})),yield this.$nextTick(),this.moveFocusToActivePanel()})},updateCurrentPanel(e){this.vuexHistory.transaction(()=>De(this,null,function*(){this.$store.commit("panels/setCurrentPanel",{panelId:e})})),this.$nextTick(()=>{this.moveFocusToActivePanel()})},deletePanel(){this.vuexHistory.transaction(()=>De(this,null,function*(){yield this.$store.dispatch("panels/delete",{panelId:this.$store.state.panels.currentPanel})})),this.$nextTick(()=>{this.moveFocusToActivePanel()})},moveAhead(){this.vuexHistory.transaction(()=>De(this,null,function*(){yield this.$store.dispatch("panels/move",{panelId:this.currentPanel.id,delta:-1})}))},moveBehind(){this.vuexHistory.transaction(()=>De(this,null,function*(){yield this.$store.dispatch("panels/move",{panelId:this.currentPanel.id,delta:1})}))},renderThumbnail(){return De(this,null,function*(){yield Wi("render thumbnail",()=>De(this,null,function*(){const e=window.getMainSceneRenderer,t=e&&e();!t||(t.paintOnto(this.thumbnailCtx,{x:0,y:0,w:this.thumbnailCtx.canvas.width,h:this.thumbnailCtx.canvas.height}),this.thumbnailCtx.canvas.toBlob(o=>{if(!o)return;const n=URL.createObjectURL(o);this.vuexHistory.transaction(()=>{this.$store.commit("panels/setPanelPreview",{panelId:this.$store.state.panels.currentPanel,url:n})})},(yield Bo())?"image/webp":"image/jpeg",lj))}))})},save(){return De(this,null,function*(){const e=yield this.$store.dispatch("getSave",!0),t=new Blob([e],{type:"text/plain"}),o=new Date,s=`${`save-${[o.getFullYear(),`${o.getMonth()+1}`.padStart(2,"0"),`${o.getDate()}`.padStart(2,"0"),`${o.getHours()}`.padStart(2,"0"),`${o.getMinutes()}`.padStart(2,"0"),`${o.getSeconds()}`.padStart(2,"0")].join("-")}`}.dddg`,r=document.createElement("a"),i=URL.createObjectURL(t);r.setAttribute("download",s),r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)})},load(){return De(this,null,function*(){yield this.vuexHistory.transaction(()=>De(this,null,function*(){const e=this.$refs.loadUpload;if(!e.files)return;fe.fire(new zl);const t=yield dj(e.files[0]);yield this.$store.dispatch("loadSave",t)})),yield this.renderThumbnail()})}},watch:{quality(e,t){if(e===100){fe.fire(new lt("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(t>Zc&&e<=Zc){fe.fire(new lt("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}},ppi(e,t){if(!!X.supports.limitedCanvasSpace&&(t<=10&&e>10||e===0&&this.panelButtons.length>10)){fe.fire(new lt("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}}});function dj(e){return new Promise((t,o)=>{const n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(s){o(s)},n.readAsText(e)})}const Ho=e=>(Ne("data-v-9ef644f2"),e=e(),Le(),e),cj={class:"panel"},uj=Ho(()=>u("h1",null,"Panels",-1)),fj=["onClick","onKeydown"],pj={class:"panel_text"},hj={class:"panel_nr"},gj={class:"column"},mj=O(" Add new"),bj=O(" Delete panel "),vj=O(" Move ahead "),yj=O(" Move behind "),_j=O(" Image options "),wj=Ho(()=>u("td",null,[u("label",{for:"export_format"},"Format")],-1)),$j=Ho(()=>u("option",{value:"image/png"},"PNG (lossless)",-1)),Cj={key:0,value:"image/webp"},Pj={key:1,value:"image/heif"},kj=Ho(()=>u("option",{value:"image/jpeg"},"JPEG (lossy)",-1)),Sj={key:0},Oj=Ho(()=>u("td",null,[u("label",{for:"export_quality"},"Quality:")],-1)),xj=Ho(()=>u("td",null,[u("label",{for:"export_ppi"},[O(" Panels per image: "),u("br"),u("small",null,"(0 for one single image)")])],-1)),jj=Ho(()=>u("td",null,[u("label",{for:"export_pages"},[O(" Panels to export: "),u("br"),u("small",null,"(Leave empty for all)")])],-1)),Ij=O(" Download "),Tj={class:"column"},Ej=O("Save"),Bj=O(" Load ");function Aj(e,t,o,n,s,r){const i=A("image-options"),a=A("d-flow"),l=A("d-fieldset"),d=A("d-button");return m(),_("div",cj,[uj,e.imageOptions?(m(),W(i,{key:0,type:"panel",title:"","panel-id":e.currentPanel.id,"no-composition":"",onLeave:t[0]||(t[0]=c=>{e.imageOptions=!1,e.renderThumbnail()})},null,8,["panel-id"])):(m(),_(N,{key:1},[w(l,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:T(()=>[w(a,{"no-wraping":"",maxSize:"350px"},{default:T(()=>[(m(!0),_(N,null,$e(e.panelButtons,(c,f)=>(m(),_("div",{key:c.id,class:le({panel_button:!0,active:c.id===e.currentPanel.id}),style:Re(`background-image: url('${c.image}')`),tabindex:"0",onClick:p=>e.updateCurrentPanel(c.id),onKeydown:[Ue(p=>e.updateCurrentPanel(c.id),["enter"]),Ue(G(p=>e.updateCurrentPanel(c.id),["prevent"]),["space"])]},[u("div",pj,[u("p",null,pe(c.text),1)]),u("div",hj,pe(f+1),1)],46,fj))),128))]),_:1})]),_:1}),u("div",gj,[w(d,{icon:"add_to_queue",onClick:e.addNewPanel},{default:T(()=>[mj]),_:1},8,["onClick"]),w(d,{icon:"remove_from_queue",onClick:e.deletePanel,disabled:!e.canDeletePanel},{default:T(()=>[bj]),_:1},8,["onClick","disabled"]),w(d,{icon:"arrow_upward",onClick:e.moveAhead,disabled:!e.canMoveAhead},{default:T(()=>[vj]),_:1},8,["onClick","disabled"]),w(d,{icon:"arrow_downward",onClick:e.moveBehind,disabled:!e.canMoveBehind},{default:T(()=>[yj]),_:1},8,["onClick","disabled"]),w(d,{icon:"color_lens",onClick:t[1]||(t[1]=c=>e.imageOptions=!0)},{default:T(()=>[_j]),_:1})]),w(l,{title:"Export"},{default:T(()=>[u("table",null,[u("tr",null,[wj,u("td",null,[ae(u("select",{id:"export_format","onUpdate:modelValue":t[2]||(t[2]=c=>e.format=c)},[$j,e.webpSupport?(m(),_("option",Cj," WebP (lossy) ")):q("",!0),e.heifSupport?(m(),_("option",Pj," HEIF (lossy) ")):q("",!0),kj],512),[[yt,e.format]])])]),e.isLossy?(m(),_("tr",Sj,[Oj,u("td",null,[ae(u("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":t[3]||(t[3]=c=>e.quality=c),onKeydown:t[4]||(t[4]=G(()=>{},["stop"]))},null,544),[[xe,e.quality,void 0,{number:!0}]])])])):q("",!0),u("tr",null,[xj,u("td",null,[ae(u("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":t[5]||(t[5]=c=>e.ppi=c),onKeydown:t[6]||(t[6]=G(()=>{},["stop"])),onBlur:t[7]||(t[7]=c=>{e.ppi===""&&(e.ppi=0)})},null,544),[[xe,e.ppi,void 0,{number:!0}]])])]),u("tr",null,[jj,u("td",null,[ae(u("input",{id:"export_pages","onUpdate:modelValue":t[8]||(t[8]=c=>e.pages=c),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[xe,e.pages]])])]),u("tr",null,[u("td",null,[w(d,{icon:"photo_camera",onClick:e.download},{default:T(()=>[Ij]),_:1},8,["onClick"])]),u("td",null,[u("button",{onClick:t[9]||(t[9]=(...c)=>e.estimateExportSize&&e.estimateExportSize(...c))},"Estimate filesizes")])])])]),_:1}),u("div",Tj,[w(d,{icon:"save",onClick:e.save},{default:T(()=>[Ej]),_:1},8,["onClick"]),w(d,{icon:"folder_open",onClick:t[11]||(t[11]=c=>e.$refs.loadUpload.click())},{default:T(()=>[Bj,u("input",{type:"file",ref:"loadUpload",onChange:t[10]||(t[10]=(...c)=>e.load&&e.load(...c))},null,544)]),_:1})])],64))])}const Dj=ne(aj,[["render",Aj],["__scopeId","data-v-9ef644f2"]]),hi=ga("panels/setNotificationProperty"),Rj=oe({mixins:[ut],components:{Toggle:Et,ObjectTool:Sn},data:()=>({textEditor:!1}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="notification")return e},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.text,set:e=>{this.text=e},leave:()=>{this.textEditor=!1}}},text:hi("text"),autoWrap:hi("autoWrap"),renderBackdrop:hi("backdrop")}});const Hj=e=>(Ne("data-v-61859d19"),e=e(),Le(),e),Mj={id:"notification_text_wrapper"},Fj=Hj(()=>u("label",{for:"notification_text"},"Text:",-1));function Nj(e,t,o,n,s,r){const i=A("toggle"),a=A("object-tool");return m(),W(a,{object:e.object,title:"Notification",textHandler:e.textHandler},{default:T(()=>[u("div",Mj,[Fj,ae(u("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.text=l),id:"notification_text",onKeydown:t[1]||(t[1]=G(()=>{},["stop"]))},null,544),[[xe,e.text]]),u("button",{onClick:t[2]||(t[2]=l=>e.textEditor=!0)},"Formatting")])]),options:T(()=>[w(i,{modelValue:e.renderBackdrop,"onUpdate:modelValue":t[3]||(t[3]=l=>e.renderBackdrop=l),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"])}const Lj=ne(Rj,[["render",Nj],["__scopeId","data-v-61859d19"]]),Bs=ga("panels/setPoemProperty"),Vj=oe({mixins:[ut],components:{Toggle:Et,ObjectTool:Sn},data:()=>({textEditor:!1}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},backgrounds(){return Rf},poemTextStyles(){return Hf},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="poem")return e},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.text,set:e=>{this.text=e},leave:()=>{this.textEditor=!1}}},text:Bs("text"),autoWrap:Bs("autoWrap"),poemStyle:Bs("font"),poemBackground:Bs("background")}});const Wj=e=>(Ne("data-v-0171fde1"),e=e(),Le(),e),zj={id:"poem_text"},Uj=Wj(()=>u("label",{for:"poem_text"},"Text:",-1)),Gj=["value"],qj=["value"];function Xj(e,t,o,n,s,r){const i=A("toggle"),a=A("object-tool");return m(),W(a,{object:e.object,title:e.object.subType==="poem"?"Poem":"Console",textHandler:e.textHandler},{default:T(()=>[u("div",zj,[Uj,ae(u("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.text=l),onKeydown:t[1]||(t[1]=G(()=>{},["stop"]))},null,544),[[xe,e.text]]),u("button",{onClick:t[2]||(t[2]=l=>e.textEditor=!0)},"Formatting")]),w(i,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[3]||(t[3]=l=>e.autoWrap=l)},null,8,["modelValue"]),e.object.subType==="poem"?(m(),_(N,{key:0},[ae(u("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.poemBackground=l),onKeydown:t[5]||(t[5]=G(()=>{},["stop"]))},[(m(!0),_(N,null,$e(e.backgrounds,(l,d)=>(m(),_("option",{value:d,key:d},pe(l.name),9,Gj))),128))],544),[[yt,e.poemBackground]]),ae(u("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>e.poemStyle=l),onKeydown:t[7]||(t[7]=G(()=>{},["stop"]))},[(m(!0),_(N,null,$e(e.poemTextStyles,(l,d)=>(m(),_("option",{value:d,key:d},pe(l.name),9,qj))),128))],544),[[yt,e.poemStyle]])],64)):q("",!0)]),_:1},8,["object","title","textHandler"])}const Kj=ne(Vj,[["render",Xj],["__scopeId","data-v-0171fde1"]]),Yj={a:"add",s:"backgrounds",d:"panels",f:"settings"},Jj=oe({components:{SettingsPanel:cv,AddPanel:Wv,BackgroundsPanel:xO,CreditsPanel:US,CharacterPanel:YP,TextBoxPanel:Fk,ChoicePanel:qk,SpritePanel:QP,PanelsPanel:Dj,NotificationPanel:Lj,PoemPanel:Kj},data:()=>({panelSelection:"add"}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},vertical(){return this.$store.state.ui.vertical},selection(){return this.$store.state.ui.selection},panel(){if(this.panelSelection==="selection")if(this.selection===null)this.panelSelection="add";else return this.currentPanel.objects[this.selection].type;return this.panelSelection},hasPrevRender(){return this.$store.state.ui.lastDownload!==null}},methods:{setPanel(e){e===this.panelSelection&&(e="add"),this.panelSelection=e,this.selection!==null&&this.$store.commit("ui/setSelection",null)},resetScroll(){console.log("resetting scrolls"),this.$refs.panels instanceof HTMLElement&&(this.$refs.panels.scrollTop=0,this.$refs.panels.scrollLeft=0)},onKeydown(e){if(e.ctrlKey){const t=Yj[e.key];t&&(this.setPanel(t),e.preventDefault(),e.stopPropagation())}}},watch:{selection(e){if(e!=null){this.panelSelection="selection";return}this.panelSelection==="selection"&&(this.panelSelection="add")}},created(){X.onPanelChange(e=>{this.panelSelection=e}),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown)}});const Zj={id:"toolbar"},Qj=u("i",{class:"material-icons","aria-hidden":"true"},"add_box",-1),eI=u("div",{class:"shortcut-popup"},"A",-1),tI=[Qj,eI],oI=u("i",{class:"material-icons","aria-hidden":"true"},"panorama",-1),nI=u("div",{class:"shortcut-popup"},"S",-1),sI=[oI,nI],rI=u("i",{class:"material-icons","aria-hidden":"true"},"view_module",-1),iI=u("div",{class:"shortcut-popup"},"D",-1),lI=[rI,iI],aI=u("i",{class:"material-icons","aria-hidden":"true"},"settings_applications",-1),dI=u("div",{class:"shortcut-popup"},"F",-1),cI=[aI,dI],uI={id:"toolbar-end"},fI=u("i",{class:"material-icons","aria-hidden":"true"},"help",-1),pI=[fI],hI=u("i",{class:"material-icons","aria-hidden":"true"},"extension",-1),gI=[hI],mI=["disabled"],bI=u("i",{class:"material-icons","aria-hidden":"true"},"flip_to_back",-1),vI=[bI],yI=u("i",{class:"material-icons","aria-hidden":"true"},"photo_camera",-1),_I=[yI];function wI(e,t,o,n,s,r){const i=A("settings-panel"),a=A("backgrounds-panel"),l=A("credits-panel"),d=A("character-panel"),c=A("sprite-panel"),f=A("text-box-panel"),p=A("choice-panel"),b=A("panels-panel"),v=A("notification-panel"),C=A("poem-panel"),B=A("add-panel");return m(),_("div",{id:"panels",class:le({vertical:e.vertical}),onScroll:t[12]||(t[12]=(...D)=>e.resetScroll&&e.resetScroll(...D)),ref:"panels"},[u("div",Zj,[u("button",{class:le({active:e.panel==="add"}),onClick:t[0]||(t[0]=D=>e.setPanel("add")),title:"Add new objects to the scene","aria-label":"Add new objects to the scene"},tI,2),u("button",{class:le({active:e.panel==="backgrounds"}),onClick:t[1]||(t[1]=D=>e.setPanel("backgrounds")),"aria-label":"Change the current background",title:"Change the current background"},sI,2),u("button",{class:le({active:e.panel==="panels"}),title:"Panels","aria-label":"Panels",onClick:t[2]||(t[2]=D=>e.setPanel("panels"))},lI,2),u("button",{class:le({active:e.panel==="settings"}),title:"Settings","aria-label":"Settings",onClick:t[3]||(t[3]=D=>e.setPanel("settings"))},cI,2)]),e.panel==="settings"?(m(),W(i,{key:0})):e.panel==="backgrounds"?(m(),W(a,{key:1,onShowDialog:t[4]||(t[4]=D=>e.$emit("show-dialog",D))})):e.panel==="help_credits"?(m(),W(l,{key:2})):e.panel==="character"?(m(),W(d,{key:3,onShowDialog:t[5]||(t[5]=D=>e.$emit("show-dialog",D)),onShowExpressionDialog:t[6]||(t[6]=D=>e.$emit("show-expression-dialog",D))})):e.panel==="sprite"?(m(),W(c,{key:4})):e.panel==="textBox"?(m(),W(f,{key:5})):e.panel==="choice"?(m(),W(p,{key:6})):e.panel==="panels"?(m(),W(b,{key:7})):e.panel==="notification"?(m(),W(v,{key:8})):e.panel==="poem"?(m(),W(C,{key:9})):(m(),W(B,{key:10,onShowDialog:t[7]||(t[7]=D=>e.$emit("show-dialog",D))})),u("div",uI,[u("button",{class:le({active:e.panel==="help_credits"}),onClick:t[8]||(t[8]=D=>e.setPanel("help_credits")),title:"Help & Credits","aria-label":"Help & Credits"},pI,2),u("button",{class:le({active:e.panel==="packs"}),onClick:t[9]||(t[9]=D=>e.$emit("show-dialog")),title:"Content packs","aria-label":"Content packs"},gI,2),u("button",{onClick:t[10]||(t[10]=D=>e.$emit("show-prev-render")),title:"Show last downloaded panel","aria-label":"Show last downloaded panel",disabled:!e.hasPrevRender},vI,8,mI),u("button",{title:"Take a screenshot of the current scene","aria-label":"Take a screenshot of the current scene",onClick:t[11]||(t[11]=D=>e.$emit("download"))},_I)])],34)}const $I=ne(Jj,[["render",wI]]);var CI=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const PI=5e3,gi=2e4,Qc=100,kI=oe({props:{loading:{default:!1,type:Boolean}},data:()=>({messages:[],errors:[],resolvableErrors:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}),computed:{vertical(){return this.$store.state.ui.vertical}},created(){this.onLoadingChange(this.loading),fe.subscribe(Zs,e=>{this.messages.push(`Failed to load asset '${e.path}'`),setTimeout(()=>{this.messages.shift()},PI)}),fe.subscribe(uf,e=>{this.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{this.messages.shift()},gi)}),fe.subscribe(Vl,e=>{this.errors.push(e.message)}),fe.subscribe(Ul,e=>{this.resolvableErrors.push(e)}),fe.subscribe(lt,e=>{this.messages.push(e.message),setTimeout(()=>{this.messages.shift()},gi)}),fe.subscribe(hf,e=>{this.messages.push(e.error.name),this.messages.push(JSON.stringify(e.error.stack)),this.messages.push(e.info),setTimeout(()=>{this.messages.shift(),this.messages.shift(),this.messages.shift()},gi)})},methods:{onLoadingChange(e){e?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),!this.showLoading&&!this.showLoadingTimeout&&(this.showLoadingTimeout=setTimeout(()=>{this.showLoading=!0,this.showLoadingTimeout=0},Qc))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout(()=>{this.showLoading=!1,this.hideLoadingTimeout=0},Qc)))},dismissError(e){this.errors.splice(e,1)},resolvableAction(e,t){return CI(this,null,function*(){const o=this.resolvableErrors[e];this.resolvableErrors.splice(e,1),yield o.actions.find(s=>s.name===t).exec()})}},watch:{loading(e){this.onLoadingChange(e)}}});const SI={key:0},OI=["onClick"],xI=["onClick"];function jI(e,t,o,n,s,r){return m(),_("div",{id:"messageConsole",class:le({vertical:e.vertical})},[e.showLoading?(m(),_("p",SI,"Loading...")):q("",!0),(m(!0),_(N,null,$e(e.messages,(i,a)=>(m(),_("p",{key:i+"_"+a},pe(i),1))),128)),(m(!0),_(N,null,$e(e.resolvableErrors,(i,a)=>(m(),_("p",{class:"error",key:"resolvableError_"+a},[O(pe(i.message)+" ",1),(m(!0),_(N,null,$e(i.actions,l=>(m(),_("a",{href:"#",key:"resolvableError_"+a+l.name,onClick:d=>e.resolvableAction(a,l.name)},"["+pe(l.name)+"]",9,OI))),128))]))),128)),(m(!0),_(N,null,$e(e.errors,(i,a)=>(m(),_("p",{class:"error",key:"error_"+a},[O(pe(i)+" ",1),u("a",{href:"#",onClick:l=>e.dismissError(a)},"[Dismiss]",8,xI)]))),128))],2)}const II=ne(kI,[["render",jI],["__scopeId","data-v-aa1cfe72"]]);var Go=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const TI=oe({props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},data:()=>({sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0,sceneRendererCache:null}),computed:{selection(){var e;return(e=this.$store.state.ui.selection)!=null?e:null},currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},lqRendering(){return this.$store.state.ui.lqRendering},sceneRender(){const e=this.$store.state.panels.currentPanel;return this.sceneRendererCache?this.sceneRendererCache.setPanelId(e):(console.log("New scene renderer!"),this.sceneRendererCache=mr(new wa(this.$store,e,this.bitmapWidth,this.bitmapHeight))),this.sceneRendererCache},bitmapHeight(){return this.preLoading,K().Base.screenHeight},bitmapWidth(){return this.preLoading,K().Base.screenWidth},pickerMode(){return this.$store.state.ui.pickColor},cursor(){return this.pickerMode?"crosshair":"default"}},methods:{download(){return Go(this,null,function*(){const e=yield this.sceneRender.download();yield this.vuexHistory.transaction(()=>Go(this,null,function*(){const t=this.$store.state.ui.lastDownload;this.$store.commit("ui/setLastDownload",e),t!=null&&URL.revokeObjectURL(t)}))})},invalidateRender(){this.queuedRender==null&&(this.queuedRender=requestAnimationFrame(this.render_))},render_(){return Go(this,null,function*(){if(this.queuedRender!=null&&(cancelAnimationFrame(this.queuedRender),this.queuedRender=null),!this.$store.state.unsafe){try{yield this.sceneRender.render(!this.lqRendering,!0,!1)}catch(e){console.log(e)}this.display(),fe.fire(new Wl)}})},renderLoadingScreen(){const e=document.createElement("canvas");e.height=this.bitmapHeight,e.width=this.bitmapWidth;try{fn.make(e,!0,!1).drawText({text:"Starting...",x:e.width/2,y:e.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(e,this.canvasWidth,this.canvasHeight)}finally{un(e)}},display(){this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,{x:0,y:0,w:this.bitmapWidth,h:this.bitmapHeight})},toRendererCoordinate(e,t){const o=this.$refs.sd,n=e-o.offsetLeft,s=t-o.offsetTop,r=n/o.offsetWidth*o.width,i=s/o.offsetWidth*o.width;return[r,i]},onUiClick(e){var t;const[o,n]=this.toRendererCoordinate(e.clientX,e.clientY);if(this.pickerMode){const a=this.sdCtx.getImageData(o,n,1,1).data,l=`rgba(${a[0].toString()},${a[1].toString()},${a[2].toString()},${(a[3]/255).toString()})`;this.vuexHistory.transaction(()=>{this.$store.commit("ui/setColorPicker",!1),fe.fire(new Qs(l))});return}if(this.dropPreventClick){this.dropPreventClick=!1;return}const s=this.sceneRender.objectsAt(o,n),r=s.findIndex(a=>a===this.selection);let i;r===0?i=null:r!==-1?i=s[r-1]:i=(t=s[s.length-1])!=null?t:null,this.$store.state.ui.selection!==i&&this.vuexHistory.transaction(()=>{this.$store.commit("ui/setSelection",i)})},onDragStart(e){if(e.preventDefault(),this.selection===null)return;this.draggedObject=this.currentPanel.objects[this.selection];const[t,o]=this.toRendererCoordinate(e.clientX,e.clientY);this.dragXOffset=t-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y},onTouchStart(e){if(this.selection===null)return;this.draggedObject=this.currentPanel.objects[this.selection];const[t,o]=this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY);this.dragXOffset=t-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y},onDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onSpriteDragMove(e){if(!this.draggedObject)return;e.preventDefault();let[t,o]=e instanceof MouseEvent?this.toRendererCoordinate(e.clientX,e.clientY):this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY);t-=this.dragXOffset,o-=this.dragYOffset;const n=Math.abs(t-this.dragXOriginal),s=Math.abs(o-this.dragYOriginal);n+s>1&&(this.dropPreventClick=!0),e.shiftKey&&(n>s?o=this.dragYOriginal:t=this.dragXOriginal),this.vuexHistory.transaction(()=>{this.$store.dispatch("panels/setPosition",{panelId:this.draggedObject.panelId,id:this.draggedObject.id,x:t,y:o})})},onDrop(e){return Go(this,null,function*(){if(e.stopPropagation(),e.preventDefault(),!!e.dataTransfer){for(const t of e.dataTransfer.items)if(t.kind==="file"&&t.type.match(/image.*/)){const o=t.getAsFile(),n=URL.createObjectURL(o);try{const s=yield this.$store.dispatch("uploadUrls/add",{name:o.name,url:n});yield this.vuexHistory.transaction(()=>Go(this,null,function*(){yield this.$store.dispatch("panels/createSprite",{assets:[{hq:s,lq:s,sourcePack:"dddg.uploaded.sprites"}]})}))}catch(s){URL.revokeObjectURL(n)}}}})},onSpriteDrop(e){this.draggedObject&&("TouchEvent"in window&&e instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter(e){e.buttons!==1&&(this.draggedObject=null)}},watch:{canvasWidth(){this.display()},canvasHeight(){this.display()}},created(){return Go(this,null,function*(){if(typeof WeakRef!="undefined"){const e=new WeakRef(this);window.getMainSceneRenderer=function(){var t;return(t=e.deref())==null?void 0:t.sceneRender}}else window.getMainSceneRenderer=()=>this.sceneRender;fe.subscribe(_r,()=>this.invalidateRender()),fe.subscribe(zl,()=>{const e=this.sceneRendererCache;e&&e.setPanelId(-1)}),this.$store.subscribe(e=>{e.type!=="panels/setPanelPreview"&&e.type!=="panels/currentPanel"&&this.invalidateRender()})})},mounted(){const e=this.$refs.sd;this.sdCtx=e.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()},unmounted(){var e;(e=this.sceneRendererCache)==null||e.dispose()}});const EI=["height","width"];function BI(e,t,o,n,s,r){return m(),_("canvas",{id:"scaled_display",ref:"sd",height:e.bitmapHeight,width:e.bitmapWidth,style:Re({width:e.canvasWidth+"px",height:e.canvasHeight+"px",cursor:e.cursor}),draggable:"true",onClick:t[0]||(t[0]=(...i)=>e.onUiClick&&e.onUiClick(...i)),onTouchstart:t[1]||(t[1]=(...i)=>e.onTouchStart&&e.onTouchStart(...i)),onDragstart:t[2]||(t[2]=(...i)=>e.onDragStart&&e.onDragStart(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.onSpriteDragMove&&e.onSpriteDragMove(...i)),onMousemove:t[4]||(t[4]=(...i)=>e.onSpriteDragMove&&e.onSpriteDragMove(...i)),onTouchend:t[5]||(t[5]=(...i)=>e.onSpriteDrop&&e.onSpriteDrop(...i)),onMouseup:t[6]||(t[6]=(...i)=>e.onSpriteDrop&&e.onSpriteDrop(...i)),onDragover:t[7]||(t[7]=(...i)=>e.onDragOver&&e.onDragOver(...i)),onDrop:t[8]||(t[8]=(...i)=>e.onDrop&&e.onDrop(...i)),onMouseenter:t[9]||(t[9]=(...i)=>e.onMouseEnter&&e.onMouseEnter(...i)),onContextmenu:t[10]||(t[10]=G(()=>{},["prevent"]))},"HTML5 is required to use the Doki Doki Dialog Generator. ",44,EI)}const AI=ne(TI,[["render",BI]]),$a={"dddg.buildin.backgrounds.nsfw":`${Fe}packs/buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${Fe}packs/buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${Fe}packs/buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${Fe}packs/buildin.base.yuri.nsfw.json`},DI=new Set(Object.keys($a)),RI=Object.values($a);var mi=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const eu=16/9,As=20,HI=50,MI=200,FI=oe({components:{ToolBox:$I,MessageConsole:II,Render:AI,ModalDialog:Xl,SingleBox:Va(()=>vd(()=>import("./SingleBox.0fc49ee3.js"),["SingleBox.0fc49ee3.js","SingleBox.5819689f.css"],import.meta.url)),ExpressionBuilder:Va(()=>vd(()=>import("./index.983914b1.js"),["index.983914b1.js","index.0518bc90.css"],import.meta.url))},data:()=>({canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0,systemPrefersDarkMode:!1,preLoading:!0,classes:new Set,classTimeout:null,queuedRerender:null}),computed:{isSafari(){return!1},useDarkTheme(){var e;return(e=this.userPrefersDarkMode)!=null?e:this.systemPrefersDarkMode},userPrefersDarkMode(){return this.$store.state.ui.useDarkTheme},nsfw(){return this.$store.state.ui.nsfw},objects(){const e=this.$store.state.panels,t=e.panels[e.currentPanel];return t==null?[]:[...t.order,...t.onTopOrder]}},methods:{drawLastDownload(){const e=this.$store.state.ui.lastDownload;e!=null&&this.$refs.render.blendOver(e)},setBlendOver(){this.blendOver=this.$store.state.ui.lastDownload},optimum(e,t){let o=e/eu,n=t*eu;return o>t?o=t:n=e,[n,o]},optimizeWithMenu(e,t){const o=this.optimum(e,t-this.uiSize),n=this.optimum(e-this.uiSize,t);return!this.isSafari&&o[0]*o[1]>n[0]*n[1]?[o[0],o[1],!1]:[n[0],n[1],!0]},updateArea(){const[e,t,o]=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight);this.canvasWidth=e,this.canvasHeight=t,this.canvasTooSmall=Math.max(e,t)<MI,this.$store.state.ui.vertical!==o&&this.$store.commit("ui/setVertical",o)},showDialog(e){if(this.dialogVisable=!0,e==null)return;const t=()=>{this.$refs.packDialog?this.$refs.packDialog.setSearch(e):setTimeout(t,HI)};this.$nextTick(t)},showExpressionDialog(e){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=e.character,this.expressionBuilderHeadGroup=e.headGroup},rerender(){this.queuedRerender==null&&(this.queuedRerender=requestAnimationFrame(()=>{this.queuedRerender=null,fe.fire(new _r)}))},onKeydown(e){if(e.key==="Control"){this.classTimeout===null&&(this.classTimeout=setTimeout(()=>{this.classTimeout=null,this.classes.add("ctrl-key")},500));return}if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement){console.log("skip keydown on potential target");return}this.vuexHistory.transaction(()=>{if(e.ctrlKey){if(e.key==="z"){e.preventDefault();return}else if(e.key==="y"){e.preventDefault();return}else if(e.key==="v"){this.$store.dispatch("panels/pasteObjectFromClipboard",{}),e.preventDefault();return}}const o=this.$store.state.panels.panels[this.$store.state.panels.currentPanel].objects[this.$store.state.ui.selection];if(o==null)return;if(e.key==="Delete"){this.$store.dispatch("panels/removeObject",{id:o.id,panelId:o.panelId});return}if(e.key==="c"||e.key==="x"){this.$store.dispatch("panels/copyObjectToClipboard",{id:o.id,panelId:o.panelId}),e.key==="x"&&this.$store.dispatch("panels/removeObject",{id:o.id,panelId:o.panelId}),e.preventDefault();return}if(e.key==="/"||e.key==="*"){let r=e.key==="/"?-10:10;e.shiftKey&&(r/=Math.abs(r)),this.$store.commit("panels/setRotation",{id:o.id,panelId:o.panelId,rotation:o.rotation+r}),e.stopPropagation(),e.preventDefault();return}if(o.type==="character"){const r=o;if(!r.freeMove){if(e.key==="ArrowLeft"){this.$store.dispatch("panels/shiftCharacterSlot",{id:r.id,panelId:r.panelId,delta:-1});return}if(e.key==="ArrowRight"){this.$store.dispatch("panels/shiftCharacterSlot",{id:r.id,panelId:r.panelId,delta:1});return}}}let{x:n,y:s}=o;if(e.key==="ArrowLeft")n-=e.shiftKey?1:As;else if(e.key==="ArrowRight")n+=e.shiftKey?1:As;else if(e.key==="ArrowUp")s-=e.shiftKey?1:As;else if(e.key==="ArrowDown")s+=e.shiftKey?1:As;else return;this.$store.dispatch("panels/setPosition",{id:o.id,panelId:o.panelId,x:n,y:s})})},onKeyup(e){if(e.key==="Control"){this.classTimeout!=null&&clearTimeout(this.classTimeout),this.classTimeout=null,this.classes.delete("ctrl-key");return}},applyTheme(){document.body.classList.toggle("dark-theme",this.useDarkTheme)},select(e){this.$store.state.ui.selection!==e&&this.vuexHistory.transaction(()=>{this.$store.commit("ui/setSelection",e)})}},watch:{systemPrefersDarkMode(){this.applyTheme()},userPrefersDarkMode(){this.applyTheme()},nsfw(e){return mi(this,null,function*(){e?yield this.$store.dispatch("content/loadContentPacks",RI):yield this.$store.dispatch("removePacks",{packs:DI})})}},mounted(){if(window.addEventListener("keypress",e=>{e.key==="Escape"&&this.vuexHistory.transaction(()=>{this.$store.state.ui.selection!==null&&this.$store.commit("ui/setSelection",null)})}),window.addEventListener("resize",this.updateArea),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown),window.addEventListener("keyup",this.onKeyup),window.matchMedia!=null){const e=window.matchMedia("(prefers-color-scheme: dark)");this.systemPrefersDarkMode=e.matches,e.addListener(t=>{this.systemPrefersDarkMode=t.matches})}},created(){return mi(this,null,function*(){this.updateArea(),Gt.setStore(this.$store),window.app=this,window.store=this.$store,window.env=X,To(()=>this.$store.state.ui.selection,t=>{var o,n;((o=document.activeElement)==null?void 0:o.getAttribute("data-obj-id"))!==""+t&&((n=document.querySelector(`*[data-obj-id='${t}']`))==null||n.focus({focusVisible:!1,preventScroll:!0}))}),document.body.addEventListener("drop",t=>{t.preventDefault()},!0),document.body.addEventListener("dragover",t=>{t.preventDefault()},!0),yield X.loadGameMode(),this.preLoading=!1,X.connectToStore(this.vuexHistory,this.$store);const e=yield X.loadSettings();yield this.vuexHistory.transaction(()=>mi(this,null,function*(){var t,o,n,s;X.state.looseTextParsing=e.looseTextParsing||!0,this.$store.commit("ui/setLqRendering",(t=e.lq)!=null?t:!1),this.$store.commit("ui/setDarkTheme",(o=e.darkMode)!=null?o:null),this.$store.commit("ui/setDefaultCharacterTalkingZoom",(n=e.defaultCharacterTalkingZoom)!=null?n:!0),yield this.$store.dispatch("content/loadContentPacks",[`${Fe}packs/buildin.base.backgrounds.json`,`${Fe}packs/buildin.base.monika.json`,`${Fe}packs/buildin.base.sayori.json`,`${Fe}packs/buildin.base.natsuki.json`,`${Fe}packs/buildin.base.yuri.json`,`${Fe}packs/buildin.extra.mc.json`,`${Fe}packs/buildin.extra.concept_mc.json`,`${Fe}packs/buildin.extra.mc_chad.json`,`${Fe}packs/buildin.extra.femc.json`,`${Fe}packs/buildin.extra.concept_femc.json`,`${Fe}packs/buildin.extra.amy.json`]),yield X.loadContentPacks();const r=yield this.$store.dispatch("panels/createPanel");Object.keys(this.$store.state.panels.panels[r].objects).length===0&&(yield this.$store.dispatch("panels/createTextBox",{panelId:r,text:`Hi! Click here to edit this textbox! ${this.$store.state.ui.vertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more!`})),yield this.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:this.$store.state.panels.currentPanel}),yield this.$store.commit("ui/setNsfw",(s=e.nsfw)!=null?s:!1)}))})},unmounted(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("keyup",this.onKeyup)}});const NI={key:0},LI={class:"hidden-selectors"},VI=["data-obj-id","onKeydown"],WI=u("div",{id:"modal-messages"},null,-1);function zI(e,t,o,n,s,r){const i=A("render"),a=A("message-console"),l=A("tool-box"),d=A("single-box"),c=A("modal-dialog"),f=A("expression-builder");return m(),_(N,null,[e.canvasTooSmall&&e.isSafari?(m(),_("div",NI," Protrait mode is not supported by safari. Please turn the device sideways. ")):(m(),_("div",{key:1,id:"app",class:le(Array.from(e.classes))},[u("div",LI,[(m(!0),_(N,null,$e(e.objects,p=>(m(),_("div",{key:p,tabindex:"0","data-obj-id":p,onFocus:t[0]||(t[0]=b=>e.rerender()),onBlur:t[1]||(t[1]=b=>e.rerender()),onKeydown:[Ue(G(b=>e.select(p),["prevent"]),["enter"]),Ue(G(b=>e.select(p),["prevent"]),["space"])]},null,40,VI))),128))]),w(i,{ref:"render",canvasWidth:e.canvasWidth,canvasHeight:e.canvasHeight,preLoading:e.preLoading},null,8,["canvasWidth","canvasHeight","preLoading"]),w(a),w(l,{onShowPrevRender:e.drawLastDownload,onDownload:t[2]||(t[2]=p=>e.$refs.render.download()),onShowDialog:e.showDialog,onShowExpressionDialog:e.showExpressionDialog},null,8,["onShowPrevRender","onShowDialog","onShowExpressionDialog"]),(m(),W(ng,null,[e.dialogVisable?(m(),W(c,{key:0,ref:"dialog",onLeave:t[4]||(t[4]=p=>e.dialogVisable=!1)},{default:T(()=>[w(d,{ref:"packDialog",onLeave:t[3]||(t[3]=p=>e.dialogVisable=!1)},null,512)]),_:1},512)):q("",!0)],1024)),e.expressionBuilderVisible?(m(),W(c,{key:0,ref:"dialog",onLeave:t[6]||(t[6]=p=>e.expressionBuilderVisible=!1)},{default:T(()=>[w(f,{character:e.expressionBuilderCharacter,initHeadGroup:e.expressionBuilderHeadGroup,onLeave:t[5]||(t[5]=p=>e.expressionBuilderVisible=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):q("",!0)],2)),WI],64)}const UI=ne(FI,[["render",zI]]);var GI=Object.defineProperty,qI=Object.defineProperties,XI=Object.getOwnPropertyDescriptors,tu=Object.getOwnPropertySymbols,KI=Object.prototype.hasOwnProperty,YI=Object.prototype.propertyIsEnumerable,ou=(e,t,o)=>t in e?GI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Hr=(e,t)=>{for(var o in t||(t={}))KI.call(t,o)&&ou(e,o,t[o]);if(tu)for(var o of tu(t))YI.call(t,o)&&ou(e,o,t[o]);return e},JI=(e,t)=>qI(e,XI(t));function Vs(e,t){return{backgrounds:ZI(e.backgrounds,t.backgrounds),characters:eT(e.characters,t.characters),dependencies:ll(e.dependencies,t.dependencies),fonts:jt(e.fonts,t.fonts,o=>o.id,(o,n)=>JI(Hr({},o),{files:ll(o.files,n.files)})),poemStyles:jt(e.poemStyles,t.poemStyles,o=>o.label,()=>{throw new Error}),poemBackgrounds:[...e.poemBackgrounds,...t.poemBackgrounds],sprites:jt(e.sprites,t.sprites,o=>o.id,(o,n)=>{var s;return{id:o.id,label:o.label,variants:[...o.variants,...n.variants],defaultScale:o.defaultScale,hd:o.hd,sdVersion:(s=o.sdVersion)!=null?s:n.sdVersion}}),colors:jt(e.colors,t.colors,o=>o.color,o=>o)}}function ZI(e,t){return jt(e,t,o=>o.id,QI)}function QI(e,t){var o;return{id:e.id,label:e.label,variants:[...e.variants,...t.variants],scaling:e.scaling,sdVersion:(o=e.sdVersion)!=null?o:t.sdVersion}}function eT(e,t){return jt(e,t,o=>o.id,tT)}function tT(e,t){return{chibi:e.chibi,id:e.id,label:e.label,heads:sT(e.heads,t.heads),defaultScale:e.defaultScale,hd:e.hd,size:e.size,sdVersion:e.sdVersion,styleGroups:jt(e.styleGroups,t.styleGroups,o=>o.id,(o,n)=>({id:o.id,styleComponents:jt(o.styleComponents,n.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:oT(s.variants,r.variants)})),styles:jt(o.styles,n.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:jt(s.poses,r.poses,i=>i.id,nT)}))}))}}function oT(e,t){const o=Hr({},e);for(const n in t)!t.hasOwnProperty(n)||o.hasOwnProperty(n)||(o[n]=t[n]);return o}function nT(e,t){const o=Hr({},e.positions);for(const n in t.positions)o[n]?o[n]=[...o[n],...t.positions[n]]:o[n]=t.positions[n];return{id:e.id,compatibleHeads:ll(e.compatibleHeads,t.compatibleHeads),previewOffset:e.previewOffset,previewSize:e.previewSize,scale:e.scale,size:e.size,renderCommands:e.renderCommands,positions:o}}function sT(e,t){const o=Hr({},e);for(const n in t){if(!t.hasOwnProperty(n))continue;const s=t[n];if(o[n]){const r=o[n];o[n]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else o[n]=s}return o}function ll(e,t){const o=[...e];for(const n of t)o.includes(n)||o.push(n);return o}function jt(e,t,o,n){const s=[...e],r=new Map(e.map((i,a)=>[o(i),a]));for(const i of t){const a=o(i);if(r.has(a)){const l=r.get(a),d=s[l];s.splice(l,1,n(d,i))}else r.set(a,s.length),s.push(i)}return s}function rT(){return kp().__VUE_DEVTOOLS_GLOBAL_HOOK__}function kp(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const iT=typeof Proxy=="function",lT="devtools-plugin:setup",aT="plugin:settings:set";class dT{constructor(t,o){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=o;const n={};if(t.settings)for(const i in t.settings){const a=t.settings[i];n[i]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let r=Object.assign({},n);try{const i=localStorage.getItem(s),a=JSON.parse(i);Object.assign(r,a)}catch(i){}this.fallbacks={getSettings(){return r},setSettings(i){try{localStorage.setItem(s,JSON.stringify(i))}catch(a){}r=i}},o&&o.on(aT,(i,a)=>{i===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(i,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(i,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(d=>{this.targetQueue.push({method:a,args:l,resolve:d})})})}setRealTarget(t){return Yt(this,null,function*(){this.target=t;for(const o of this.onQueue)this.target.on[o.method](...o.args);for(const o of this.targetQueue)o.resolve(yield this.target[o.method](...o.args))})}}function cT(e,t){const o=kp(),n=rT(),s=iT&&e.enableEarlyProxy;if(n&&(o.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))n.emit(lT,e,t);else{const r=s?new dT(e,n):null;(o.__VUE_DEVTOOLS_PLUGINS__=o.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:r}),r&&t(r.proxiedTarget)}}/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var uT="store";function On(e,t){Object.keys(e).forEach(function(o){return t(e[o],o)})}function fT(e){return e!==null&&typeof e=="object"}function pT(e){return e&&typeof e.then=="function"}function hT(e,t){return function(){return e(t)}}function Sp(e,t,o){return t.indexOf(e)<0&&(o&&o.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function Op(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var o=e.state;Mr(e,o,[],e._modules.root,!0),Ca(e,o,t)}function Ca(e,t,o){var n=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,r={};On(s,function(i,a){r[a]=hT(i,e),Object.defineProperty(e.getters,a,{get:function(){return r[a]()},enumerable:!0})}),e._state=Ut({data:t}),e.strict&&yT(e),n&&o&&e._withCommit(function(){n.data=null})}function Mr(e,t,o,n,s){var r=!o.length,i=e._modules.getNamespace(o);if(n.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=n),!r&&!s){var a=Pa(t,o.slice(0,-1)),l=o[o.length-1];e._withCommit(function(){a[l]=n.state})}var d=n.context=gT(e,i,o);n.forEachMutation(function(c,f){var p=i+f;mT(e,p,c,d)}),n.forEachAction(function(c,f){var p=c.root?f:i+f,b=c.handler||c;bT(e,p,b,d)}),n.forEachGetter(function(c,f){var p=i+f;vT(e,p,c,d)}),n.forEachChild(function(c,f){Mr(e,t,o.concat(f),c,s)})}function gT(e,t,o){var n=t==="",s={dispatch:n?e.dispatch:function(r,i,a){var l=lr(r,i,a),d=l.payload,c=l.options,f=l.type;return(!c||!c.root)&&(f=t+f),e.dispatch(f,d)},commit:n?e.commit:function(r,i,a){var l=lr(r,i,a),d=l.payload,c=l.options,f=l.type;(!c||!c.root)&&(f=t+f),e.commit(f,d,c)}};return Object.defineProperties(s,{getters:{get:n?function(){return e.getters}:function(){return xp(e,t)}},state:{get:function(){return Pa(e.state,o)}}}),s}function xp(e,t){if(!e._makeLocalGettersCache[t]){var o={},n=t.length;Object.keys(e.getters).forEach(function(s){if(s.slice(0,n)===t){var r=s.slice(n);Object.defineProperty(o,r,{get:function(){return e.getters[s]},enumerable:!0})}}),e._makeLocalGettersCache[t]=o}return e._makeLocalGettersCache[t]}function mT(e,t,o,n){var s=e._mutations[t]||(e._mutations[t]=[]);s.push(function(i){o.call(e,n.state,i)})}function bT(e,t,o,n){var s=e._actions[t]||(e._actions[t]=[]);s.push(function(i){var a=o.call(e,{dispatch:n.dispatch,commit:n.commit,getters:n.getters,state:n.state,rootGetters:e.getters,rootState:e.state},i);return pT(a)||(a=Promise.resolve(a)),e._devtoolHook?a.catch(function(l){throw e._devtoolHook.emit("vuex:error",l),l}):a})}function vT(e,t,o,n){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(r){return o(n.state,n.getters,r.state,r.getters)})}function yT(e){To(function(){return e._state.data},function(){},{deep:!0,flush:"sync"})}function Pa(e,t){return t.reduce(function(o,n){return o[n]},e)}function lr(e,t,o){return fT(e)&&e.type&&(o=t,t=e,e=e.type),{type:e,payload:t,options:o}}var _T="vuex bindings",nu="vuex:mutations",bi="vuex:actions",qo="vuex",wT=0;function $T(e,t){cT({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[_T]},function(o){o.addTimelineLayer({id:nu,label:"Vuex Mutations",color:su}),o.addTimelineLayer({id:bi,label:"Vuex Actions",color:su}),o.addInspector({id:qo,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),o.on.getInspectorTree(function(n){if(n.app===e&&n.inspectorId===qo)if(n.filter){var s=[];Ep(s,t._modules.root,n.filter,""),n.rootNodes=s}else n.rootNodes=[Tp(t._modules.root,"")]}),o.on.getInspectorState(function(n){if(n.app===e&&n.inspectorId===qo){var s=n.nodeId;xp(t,s),n.state=kT(OT(t._modules,s),s==="root"?t.getters:t._makeLocalGettersCache,s)}}),o.on.editInspectorState(function(n){if(n.app===e&&n.inspectorId===qo){var s=n.nodeId,r=n.path;s!=="root"&&(r=s.split("/").filter(Boolean).concat(r)),t._withCommit(function(){n.set(t._state.data,r,n.state.value)})}}),t.subscribe(function(n,s){var r={};n.payload&&(r.payload=n.payload),r.state=s,o.notifyComponentUpdate(),o.sendInspectorTree(qo),o.sendInspectorState(qo),o.addTimelineEvent({layerId:nu,event:{time:Date.now(),title:n.type,data:r}})}),t.subscribeAction({before:function(n,s){var r={};n.payload&&(r.payload=n.payload),n._id=wT++,n._time=Date.now(),r.state=s,o.addTimelineEvent({layerId:bi,event:{time:n._time,title:n.type,groupId:n._id,subtitle:"start",data:r}})},after:function(n,s){var r={},i=Date.now()-n._time;r.duration={_custom:{type:"duration",display:i+"ms",tooltip:"Action duration",value:i}},n.payload&&(r.payload=n.payload),r.state=s,o.addTimelineEvent({layerId:bi,event:{time:Date.now(),title:n.type,groupId:n._id,subtitle:"end",data:r}})}})})}var su=8702998,CT=6710886,PT=16777215,jp={label:"namespaced",textColor:PT,backgroundColor:CT};function Ip(e){return e&&e!=="root"?e.split("/").slice(-2,-1)[0]:"Root"}function Tp(e,t){return{id:t||"root",label:Ip(t),tags:e.namespaced?[jp]:[],children:Object.keys(e._children).map(function(o){return Tp(e._children[o],t+o+"/")})}}function Ep(e,t,o,n){n.includes(o)&&e.push({id:n||"root",label:n.endsWith("/")?n.slice(0,n.length-1):n||"Root",tags:t.namespaced?[jp]:[]}),Object.keys(t._children).forEach(function(s){Ep(e,t._children[s],o,n+s+"/")})}function kT(e,t,o){t=o==="root"?t:t[o];var n=Object.keys(t),s={state:Object.keys(e.state).map(function(i){return{key:i,editable:!0,value:e.state[i]}})};if(n.length){var r=ST(t);s.getters=Object.keys(r).map(function(i){return{key:i.endsWith("/")?Ip(i):i,editable:!1,value:al(function(){return r[i]})}})}return s}function ST(e){var t={};return Object.keys(e).forEach(function(o){var n=o.split("/");if(n.length>1){var s=t,r=n.pop();n.forEach(function(i){s[i]||(s[i]={_custom:{value:{},display:i,tooltip:"Module",abstract:!0}}),s=s[i]._custom.value}),s[r]=al(function(){return e[o]})}else t[o]=al(function(){return e[o]})}),t}function OT(e,t){var o=t.split("/").filter(function(n){return n});return o.reduce(function(n,s,r){var i=n[s];if(!i)throw new Error('Missing module "'+s+'" for path "'+t+'".');return r===o.length-1?i:i._children},t==="root"?e:e.root._children)}function al(e){try{return e()}catch(t){return t}}var wt=function(t,o){this.runtime=o,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=(typeof n=="function"?n():n)||{}},Bp={namespaced:{configurable:!0}};Bp.namespaced.get=function(){return!!this._rawModule.namespaced};wt.prototype.addChild=function(t,o){this._children[t]=o};wt.prototype.removeChild=function(t){delete this._children[t]};wt.prototype.getChild=function(t){return this._children[t]};wt.prototype.hasChild=function(t){return t in this._children};wt.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)};wt.prototype.forEachChild=function(t){On(this._children,t)};wt.prototype.forEachGetter=function(t){this._rawModule.getters&&On(this._rawModule.getters,t)};wt.prototype.forEachAction=function(t){this._rawModule.actions&&On(this._rawModule.actions,t)};wt.prototype.forEachMutation=function(t){this._rawModule.mutations&&On(this._rawModule.mutations,t)};Object.defineProperties(wt.prototype,Bp);var Mo=function(t){this.register([],t,!1)};Mo.prototype.get=function(t){return t.reduce(function(o,n){return o.getChild(n)},this.root)};Mo.prototype.getNamespace=function(t){var o=this.root;return t.reduce(function(n,s){return o=o.getChild(s),n+(o.namespaced?s+"/":"")},"")};Mo.prototype.update=function(t){Ap([],this.root,t)};Mo.prototype.register=function(t,o,n){var s=this;n===void 0&&(n=!0);var r=new wt(o,n);if(t.length===0)this.root=r;else{var i=this.get(t.slice(0,-1));i.addChild(t[t.length-1],r)}o.modules&&On(o.modules,function(a,l){s.register(t.concat(l),a,n)})};Mo.prototype.unregister=function(t){var o=this.get(t.slice(0,-1)),n=t[t.length-1],s=o.getChild(n);!s||!s.runtime||o.removeChild(n)};Mo.prototype.isRegistered=function(t){var o=this.get(t.slice(0,-1)),n=t[t.length-1];return o?o.hasChild(n):!1};function Ap(e,t,o){if(t.update(o),o.modules)for(var n in o.modules){if(!t.getChild(n))return;Ap(e.concat(n),t.getChild(n),o.modules[n])}}function xT(e){return new Ke(e)}var Ke=function(t){var o=this;t===void 0&&(t={});var n=t.plugins;n===void 0&&(n=[]);var s=t.strict;s===void 0&&(s=!1);var r=t.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Mo(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=r;var i=this,a=this,l=a.dispatch,d=a.commit;this.dispatch=function(p,b){return l.call(i,p,b)},this.commit=function(p,b,v){return d.call(i,p,b,v)},this.strict=s;var c=this._modules.root.state;Mr(this,c,[],this._modules.root),Ca(this,c),n.forEach(function(f){return f(o)})},ka={state:{configurable:!0}};Ke.prototype.install=function(t,o){t.provide(o||uT,this),t.config.globalProperties.$store=this;var n=this._devtools!==void 0?this._devtools:!1;n&&$T(t,this)};ka.state.get=function(){return this._state.data};ka.state.set=function(e){};Ke.prototype.commit=function(t,o,n){var s=this,r=lr(t,o,n),i=r.type,a=r.payload,l={type:i,payload:a},d=this._mutations[i];!d||(this._withCommit(function(){d.forEach(function(f){f(a)})}),this._subscribers.slice().forEach(function(c){return c(l,s.state)}))};Ke.prototype.dispatch=function(t,o){var n=this,s=lr(t,o),r=s.type,i=s.payload,a={type:r,payload:i},l=this._actions[r];if(!!l){try{this._actionSubscribers.slice().filter(function(c){return c.before}).forEach(function(c){return c.before(a,n.state)})}catch(c){}var d=l.length>1?Promise.all(l.map(function(c){return c(i)})):l[0](i);return new Promise(function(c,f){d.then(function(p){try{n._actionSubscribers.filter(function(b){return b.after}).forEach(function(b){return b.after(a,n.state)})}catch(b){}c(p)},function(p){try{n._actionSubscribers.filter(function(b){return b.error}).forEach(function(b){return b.error(a,n.state,p)})}catch(b){}f(p)})})}};Ke.prototype.subscribe=function(t,o){return Sp(t,this._subscribers,o)};Ke.prototype.subscribeAction=function(t,o){var n=typeof t=="function"?{before:t}:t;return Sp(n,this._actionSubscribers,o)};Ke.prototype.watch=function(t,o,n){var s=this;return To(function(){return t(s.state,s.getters)},o,Object.assign({},n))};Ke.prototype.replaceState=function(t){var o=this;this._withCommit(function(){o._state.data=t})};Ke.prototype.registerModule=function(t,o,n){n===void 0&&(n={}),typeof t=="string"&&(t=[t]),this._modules.register(t,o),Mr(this,this.state,t,this._modules.get(t),n.preserveState),Ca(this,this.state)};Ke.prototype.unregisterModule=function(t){var o=this;typeof t=="string"&&(t=[t]),this._modules.unregister(t),this._withCommit(function(){var n=Pa(o.state,t.slice(0,-1));delete n[t[t.length-1]]}),Op(this)};Ke.prototype.hasModule=function(t){return typeof t=="string"&&(t=[t]),this._modules.isRegistered(t)};Ke.prototype.hotUpdate=function(t){this._modules.update(t),Op(this,!0)};Ke.prototype._withCommit=function(t){var o=this._committing;this._committing=!0,t(),this._committing=o};Object.defineProperties(Ke.prototype,ka);function Dp(){return{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1}}const jT={namespaced:!0,state:Dp(),mutations:{setVertical(e,t){e.vertical=t},setNsfw(e,t){e.nsfw=t},setLqRendering(e,t){e.lqRendering=t},setSelection(e,t){e.selection=t},setLastDownload(e,t){e.lastDownload=t},setClipboard(e,t){e.clipboard=t},setDarkTheme(e,t){e.useDarkTheme=t},setDefaultCharacterTalkingZoom(e,t){e.defaultCharacterTalkingZoom=t},setColorPicker(e,t){e.pickColor=t}}};var fo={},ar=je&&je.__assign||function(){return ar=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ar.apply(this,arguments)},Rp=je&&je.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},IT=je&&je.__read||function(e,t){var o=typeof Symbol=="function"&&e[Symbol.iterator];if(!o)return e;var n=o.call(e),s,r=[],i;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)r.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return r},TT=je&&je.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(IT(arguments[t]));return e};Object.defineProperty(fo,"__esModule",{value:!0});fo.mapObject=Hp=fo.assetWalker=dl=fo.normalizePath=void 0;var ET=10;function BT(e,t,o,n){for(var s,r,i="",a=0,l=new Map(Array.from(t.entries()).map(function(p){return[new RegExp("{"+p[0]+"}","g"),p[1]]}));i!==e;){if(i=e,++a>ET)throw new Error("Maximum replacement recursion exceeded!");try{for(var d=(s=void 0,Rp(l.entries())),c=d.next();!c.done;c=d.next()){var f=c.value;e=e.replace(f[0],f[1])}}catch(p){s={error:p}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(s)throw s.error}}e=e.replace(/{format(:.*?:.*?)+}/gi,function(p){p=p.slice(8,-1);for(var b=p.split(":"),v=0;v<b.length;v+=2)if(o.has(b[v]))return b[v+1];return""}),e=e.replace(/{lq:(.*?):(.*?)}/gi,function(p){return p.slice(4,-1).split(":")[n?0:1]})}return e}var dl=fo.normalizePath=BT;function AT(e,t){return{packId:e.packId,packCredits:e.packCredits,dependencies:e.dependencies,characters:e.characters.map(function(o){return DT(o,t)}),backgrounds:e.backgrounds.map(function(o){return WT(o,t)}),fonts:e.fonts.map(function(o){return zT(o,t)}),poemStyles:TT(e.poemStyles),poemBackgrounds:e.poemBackgrounds.map(function(o){return UT(o,t)}),sprites:e.sprites.map(function(o){return GT(o,t)}),colors:e.colors}}var Hp=fo.assetWalker=AT;function DT(e,t){return{id:e.id,label:e.label,chibi:e.chibi?t(e.chibi,"image"):void 0,heads:LT(e.heads,t),styleGroups:e.styleGroups.map(function(o){return RT(o,t)}),defaultScale:e.defaultScale,hd:e.hd,size:e.size,sdVersion:e.sdVersion}}function RT(e,t){return{id:e.id,styleComponents:e.styleComponents.map(function(o){return MT(o,t)}),styles:e.styles.map(function(o){return HT(o,t)})}}function HT(e,t){return{components:e.components,poses:e.poses.map(function(o){return NT(o,t)})}}function MT(e,t){return ar(ar({},e),{variants:FT(e.variants,t)})}function FT(e,t){var o={};for(var n in e)!e.hasOwnProperty(n)||(o[n]=t(e[n],"image"));return o}function NT(e,t){var o,n,s={};try{for(var r=Rp(Object.keys(e.positions)),i=r.next();!i.done;i=r.next()){var a=i.value,l=e.positions[a];s[a]=l.map(function(d){return d.map(function(c){return t(c,"image")})})}}catch(d){o={error:d}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return{compatibleHeads:e.compatibleHeads,id:e.id,previewOffset:e.previewOffset,previewSize:e.previewSize,renderCommands:e.renderCommands.map(function(d){return d.type==="image"?{type:"image",offset:d.offset,images:d.images.map(function(c){return t(c,"image")})}:d}),size:e.size,scale:e.scale,positions:s}}function LT(e,t){var o={};for(var n in e)!e.hasOwnProperty(n)||(o[n]=VT(e[n],t));return o}function VT(e,t){return{previewOffset:e.previewOffset,previewSize:e.previewSize,variants:e.variants.map(function(o){return o.map(function(n){return t(n,"image")})})}}function WT(e,t){return{id:e.id,label:e.label,variants:e.variants.map(function(o){return o.map(function(n){return t(n,"image")})}),scaling:e.scaling,sdVersion:e.sdVersion}}function zT(e,t){return{id:e.id,label:e.label,files:e.files.map(function(o){return t(o,"font")})}}function UT(e,t){return{id:e.id,fontColor:e.fontColor,label:e.label,images:e.images.map(function(o){return t(o,"image")}),sdVersion:e.sdVersion}}function GT(e,t){return{id:e.id,label:e.label,variants:e.variants.map(function(o){return o.map(function(n){return t(n,"image")})}),defaultScale:e.defaultScale,hd:e.hd,sdVersion:e.sdVersion}}function qT(e,t){var o={};for(var n in e)!e.hasOwnProperty(n)||(o[n]=t(e[n],n));return o}fo.mapObject=qT;var Se={},dr=je&&je.__assign||function(){return dr=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},dr.apply(this,arguments)};Object.defineProperty(Se,"__esModule",{value:!0});Se.expandId=Se.normalizeStyleComponent=Se.normalizeColor=Se.normalizeBackground=Se.normalizeFont=Se.normalizePoemBackground=Se.normalizePoemStyles=Se.normalizeSprite=Se.mapNormalize=Mp=Se.normalizeContentPack=void 0;var XT=fo;function KT(e,t){var o={paths:t,packId:e.packId},n=qe("",e.folder||"/",o);return{packId:e.packId,packCredits:e.packCredits,dependencies:e.dependencies||[],characters:St(YT,e.characters,n,o),backgrounds:St(Wp,e.backgrounds,n,o),fonts:St(Vp,e.fonts,n,o),poemStyles:St(Np,e.poemStyles,n,o),poemBackgrounds:St(Lp,e.poemBackgrounds,n,o),sprites:St(Fp,e.sprites,n,o),colors:St(zp,e.colors,n,o)}}var Mp=Se.normalizeContentPack=KT;function St(e,t,o,n){return t?t.map(function(s){return e(s,o,n)}):[]}Se.mapNormalize=St;function Fp(e,t,o){var n,s=qe(t,e.folder,o);return{id:_t(o.packId,e.id),label:e.label||e.variants[0][0],variants:e.variants.map(function(r){return Fr(r,s,o)}),defaultScale:e.defaultScale||[1,1],sdVersion:e.sdVersion,hd:(n=e.hd)!==null&&n!==void 0?n:null}}Se.normalizeSprite=Fp;function Np(e){return{label:e.label,defaultFont:e.defaultFont||"Aller",fontSize:e.fontSize!==void 0?e.fontSize:30,letterSpacing:e.letterSpacing!==void 0?e.letterSpacing:1,lineSpacing:e.lineSpacing!==void 0?e.lineSpacing:1.2}}Se.normalizePoemStyles=Np;function Lp(e,t,o){var n=qe(t,e.folder,o);return{id:e.id,label:e.label,images:Fr(e.images,n,o),fontColor:e.fontColor||"black",sdVersion:e.sdVersion}}Se.normalizePoemBackground=Lp;function Vp(e,t,o){var n=qe(t,e.folder,o);return{id:_t(o.packId,e.id?e.id:e.label?e.label:e.files[0]),label:e.label?e.label:e.id?e.id:e.files[0],files:Fr(e.files,n,o)}}Se.normalizeFont=Vp;function Wp(e,t,o){var n,s=qe(t,e.folder,o);return{id:_t(o.packId,e.id),label:e.label?e.label:e.variants[0][0],variants:e.variants.map(function(r){return Fr(r,s,o)}),scaling:["none","strech","cover"].includes((n=e.scaling)===null||n===void 0?void 0:n.toLowerCase())?e.scaling.toLowerCase():"cover",sdVersion:e.sdVersion}}Se.normalizeBackground=Wp;function zp(e){return{label:e.label||e.color,color:e.color}}Se.normalizeColor=zp;function Fr(e,t,o){return e.map(function(n){return qe(t,n,o)})}function YT(e,t,o){var n,s,r,i=qe(t,e.folder,o);return{id:_t(o.packId,e.id),label:e.label,chibi:e.chibi?qe(i,e.chibi,o):void 0,heads:e2(e.heads,i,o),defaultScale:(n=e.defaultScale)!==null&&n!==void 0?n:[.8,.8],size:(s=e.size)!==null&&s!==void 0?s:[960,960],hd:(r=e.hd)!==null&&r!==void 0?r:!1,sdVersion:e.sdVersion,styleGroups:St(JT,e.styleGroups,i,o)}}function JT(e,t,o){var n=qe(t,e.folder,o);return{id:_t(o.packId,e.id),styleComponents:St(Up,e.styleComponents,n,o),styles:e.styles.map(function(s){return ZT(s,n,o)})}}function ZT(e,t,o){var n=qe(t,e.folder,o),s={};if(e.components)for(var r in e.components)!e.components.hasOwnProperty(r)||(s[_t(o.packId,r)]=e.components[r]);return{components:s,poses:e.poses.map(function(i){return t2(i,n,o)})}}function Up(e,t,o){return{id:_t(o.packId,e.id),label:e.label,variants:QT(e.variants,t,o)}}Se.normalizeStyleComponent=Up;function QT(e,t,o){if(!e)return{};var n={};for(var s in e)!e.hasOwnProperty(s)||(n[s]=qe(t,e[s],o));return n}function e2(e,t,o){var n={};if(!e)return n;for(var s in e)if(!!e.hasOwnProperty(s)){var r=e[s],i=void 0;if(r instanceof Array)i={variants:cl(r,t,o),previewOffset:[290,70],previewSize:[380,380]};else{var a=qe(t,r.folder,o);i={variants:cl(r.variants,a,o),previewOffset:r.previewOffset||[290,70],previewSize:r.previewSize||[380,380]}}n[_t(o.packId,s)]=i}return n}function t2(e,t,o){var n,s,r=qe(t,e.folder,o);return{compatibleHeads:((n=e.compatibleHeads)===null||n===void 0?void 0:n.map(function(i){return _t(o.packId,i)}))||[],id:_t(o.packId,e.id),previewOffset:e.previewOffset||[0,0],previewSize:e.previewSize||[960,960],size:e.size||[960,960],scale:e.scale||.8,positions:XT.mapObject(e.positions||{},function(i){return cl(i,r,o)}),renderCommands:((s=e.renderCommands)===null||s===void 0?void 0:s.map(function(i){return o2(i,t,o)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function o2(e,t,o){if(e.type==="image"){var n=qe(t,e.folder,o);return{type:"image",composite:e.composite,offset:e.offset||[0,0],images:Gp(e.images,n,o)}}else return dr(dr({},e),{offset:e.offset||[0,0]})}function cl(e,t,o){return e.map(function(n){return Gp(n,t,o)})}function Gp(e,t,o){return e.map(function(n){return qe(t,n,o)})}function n2(e){return e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("://")}function qe(e,t,o){if(!t)return e;for(var n in o.paths)if(t.startsWith(n))return o.paths[n]+t.slice(n.length);return n2(t)?t:e+t}function _t(e,t){return t.indexOf(":")!==-1?t:e+":"+t}Se.expandId=_t;var rs={},Ws=je&&je.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s2=je&&je.__read||function(e,t){var o=typeof Symbol=="function"&&e[Symbol.iterator];if(!o)return e;var n=o.call(e),s,r=[],i;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)r.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return r},vi=je&&je.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s2(arguments[t]));return e};Object.defineProperty(rs,"__esModule",{value:!0});rs.expandOrTranslateId=qp=rs.convert=void 0;var ul=Se;function r2(e,t,o){if(!e.packId)throw new Error("");return{packId:e.packId,packCredits:e.packCredits?[e.packCredits]:[],dependencies:i2(e.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[l2(e,t,o)],colors:[]}}var qp=rs.convert=r2,Xp={"ddlc.monika":kt("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":kt("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":kt("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":kt("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":kt("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":kt("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":kt("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":kt("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":kt("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":kt("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function i2(e){return[]}function l2(e,t,o){var n={characterId:e.id,packId:e.packId,paths:t};return{id:ho("character",e.id,n),chibi:e.chibi,label:e.name,heads:f2(e.heads,n,o),styleGroups:a2(e,n,o),defaultScale:[.8,.8],size:[960,960],hd:!1}}function a2(e,t,o){var n,s,r=Xp[t.characterId],i=[],a=new Map,l=p2(e,t),d=l.length===0?r&&r.defaultStyleComponents?d2(r.defaultStyleComponents,t):[]:l,c=e.poses.map(function(B){return B.style}).filter(function(B,D,$){return $.indexOf(B)===D}),f=new Map(e.styles.map(function(B){return[B.name,B]})),p=function(B){var D,$,H,j,J=f.get(B);if(J&&J.nsfw&&!o)return"continue";var Z=B,U={};try{for(var ee=(D=void 0,Ws(d)),te=ee.next();!te.done;te=ee.next()){var he=te.value;try{for(var ue=(H=void 0,Ws(Object.keys(he.variants))),F=ue.next();!F.done;F=ue.next()){var Ce=F.value,Ye=new RegExp("-"+Ce+"\\b");if(Z.match(Ye)){U[he.id]=Ce,Z=Z.replace(Ye,"");break}}}catch(Pe){H={error:Pe}}finally{try{F&&!F.done&&(j=ue.return)&&j.call(ue)}finally{if(H)throw H.error}}}}catch(Pe){D={error:Pe}}finally{try{te&&!te.done&&($=ee.return)&&$.call(ee)}finally{if(D)throw D.error}}Z=ho("styleGroups",Z,t);var pt=a.get(Z);pt||(pt={id:Z,styleComponents:d,styles:[]},a.set(Z,pt),i.push(Z)),pt.styles.push({components:U,poses:u2(e.poses.filter(function(Pe){return Pe.style===B}),t,o)})};try{for(var b=Ws(c),v=b.next();!v.done;v=b.next()){var C=v.value;p(C)}}catch(B){n={error:B}}finally{try{v&&!v.done&&(s=b.return)&&s.call(b)}finally{if(n)throw n.error}}return i.map(function(B){return a.get(B)})}function d2(e,t){return ul.mapNormalize(ul.normalizeStyleComponent,e,"",{packId:t.packId,paths:t.paths})}function c2(e,t){return e?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:t}]:[{type:"head",offset:t},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function u2(e,t,o){return e.map(function(n){return{compatibleHeads:n.compatibleHeads.map(function(s){return ho("heads",s.toString(),t)}),id:ho("poses",n.name,t),renderCommands:c2(n.headInForeground,n.headAnchor),previewOffset:n.offset,previewSize:n.size,size:[960,960],scale:.8,positions:{Static:"static"in n?[[n.static]]:[],Left:"left"in n?yi(n.left,o):[],Right:"right"in n?yi(n.right,o):[],Variant:"variant"in n?yi(n.variant,o):[]}}})}function yi(e,t){return e.filter(function(o){return!o.nsfw||t}).map(function(o){return[o.img]})}function f2(e,t,o){var n,s,r={};try{for(var i=Ws(Object.keys(e)),a=i.next();!a.done;a=i.next()){var l=a.value,d=e[l];d.nsfw&&!o||(r[ho("heads",l,t)]={previewOffset:d.offset,previewSize:d.size,variants:d.all.filter(function(c){return!c.nsfw||o}).map(function(c){return[c.img]})})}}catch(c){n={error:c}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}return r}function p2(e,t){var o=[],n=[];return Object.keys(e.eyes).length>0&&(Object.keys(e.eyes).forEach(function(s){return n.push(s)}),o.push({label:"Eyes",id:ho("eyes","eyes",t),variants:e.eyes})),Object.keys(e.hairs).length>0&&(Object.keys(e.hairs).forEach(function(s){return n.push(s)}),o.push({label:"Hairs",id:ho("hairs","hairs",t),variants:e.hairs})),o}function _i(e,t){return new Map(t.map(function(o){return[o,e+":"+o]}))}function kt(e,t,o){return o.extraHeadAssoc?o.extraHeadAssoc=o.extraHeadAssoc.map(function(n){return[n[0],e+":"+n[1]]}):o.extraHeadAssoc=[],o.extraPoseAssoc?o.extraPoseAssoc=o.extraPoseAssoc.map(function(n){return[n[0],e+":"+n[1]]}):o.extraPoseAssoc=[],o.extraStyleGroupAssoc?o.extraStyleGroupAssoc=o.extraStyleGroupAssoc.map(function(n){return[n[0],e+":"+n[1]]}):o.extraStyleGroupAssoc=[],{character:e+":"+t,eyes:e+":eyes",hairs:e+":hair",defaultStyleComponents:o.defaultStyleComponents||[],heads:new Map(vi(_i(e,o.heads),o.extraHeadAssoc)),poses:new Map(vi(_i(e,o.poses),o.extraPoseAssoc)),styleGroups:new Map(vi(_i(e,o.styleGroups),o.extraStyleGroupAssoc))}}function ho(e,t,o){var n=Xp[o.characterId];if(n){if(e==="character"||e==="hairs"||e==="eyes")return n[e];var s=n[e].get(t);if(s)return s}return ul.expandId(o.packId,t)}rs.expandOrTranslateId=ho;var Sa={};Object.defineProperty(Sa,"__esModule",{value:!0});var Kp=Sa.normalizeCharacter=void 0;function h2(e,t){var o=go("",e.folder||"/",t),n=void 0;return e.chibi&&(n=go(o,e.chibi,t)),n===void 0&&e.internalId&&(n=(t["/"]||"")+"chibis/"+e.internalId),{id:e.id,packId:e.packId,packCredits:e.packCredits,name:e.name,nsfw:!!e.nsfw,chibi:n,eyes:ru(e.eyes,o,t),hairs:ru(e.hairs,o,t),styles:b2(e.styles),heads:g2(e.heads,o,t),poses:m2(e.poses,o,t)}}Kp=Sa.normalizeCharacter=h2;function ru(e,t,o){if(!e)return{};var n={};for(var s in e)!e.hasOwnProperty(s)||(n[s]=go(t,e[s],o));return n}function g2(e,t,o){var n={};if(!e)return n;for(var s in e)if(!!e.hasOwnProperty(s)){var r=e[s],i=void 0;if(r instanceof Array)i={all:qn(r,t,o),nsfw:!1,offset:[290,70],size:[380,380]};else{var a=go(t,r.folder,o);i={all:qn(r.all,a,o),nsfw:!!r.nsfw,offset:r.offset||[290,70],size:r.size||[380,380]}}n[s]=i}return n}function m2(e,t,o){return e?e.map(function(n){var s=go(t,n.folder,o),r={compatibleHeads:n.compatibleHeads||[],headAnchor:n.headAnchor||[0,0],headInForeground:!!n.headInForeground,name:n.name,nsfw:!!n.nsfw,style:n.style,offset:[0,0],size:[960,960]};if("static"in n)r.static=go(s,n.static,o);else if("variant"in n)r.variant=qn(n.variant,s,o);else if("left"in n)r.left=qn(n.left,s,o),r.right=qn(n.right,s,o);else throw new Error("Invalid pose");return r}):[]}function qn(e,t,o){return e.map(function(n){return typeof n=="string"?{img:go(t,n,o),nsfw:!1}:{img:go(t,n.img,o),nsfw:n.nsfw||!1}})}function b2(e){return e?e.map(function(t){return{name:t.name,label:t.label,nsfw:t.nsfw||!1}}):[]}function v2(e){return e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("://")}function go(e,t,o){if(!t)return e;for(var n in o)if(t.startsWith(n))return o[n]+t.slice(n.length);return v2(t)?t:e+t}var Xn=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});function iu(e){return e.split("/").slice(0,-1).join("/")+"/"}const lu=new Set(["png","gif","bmp","svg"]);function Yp(){return{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}}}const y2={namespaced:!0,state:Yp(),mutations:{setContentPacks(e,t){e.contentPacks=t},setCurrentContent(e,t){e.current=t}},actions:{removeContentPacks({commit:e,state:t,dispatch:o},n){const s=JSON.parse(JSON.stringify(t.current)),r=t.contentPacks.filter(i=>!n.has(i.packId));e("setContentPacks",r),e("setCurrentContent",r.reduce((i,a)=>Vs(i,a))),o("panels/fixContentPackRemoval",s,{root:!0})},replaceContentPack(e,t){return Xn(this,arguments,function*({commit:o,state:n},s){debugger;const r=s.processed?s.contentPack:yield cr(s.contentPack);let i=n.contentPacks;const a=i.findIndex(l=>l.packId===s.contentPack.packId);a===-1?i.push(r):i.splice(a,1,r),i=i,o("setContentPacks",i),o("setCurrentContent",i.reduce((l,d)=>Vs(l,d)))})},loadContentPacks(e,t){return Xn(this,arguments,function*({commit:o,state:n},s){typeof s=="string"&&(s=[s]);const r=yield Promise.all(s.map(d=>Xn(this,null,function*(){return fl(d)}))),i=yield Promise.all(r.map(d=>cr(d))),a=new Set(n.contentPacks.map(d=>d.packId));let l=n.current;for(const d of i){for(const c of d.dependencies)if(!a.has(c))throw new Error(`Missing dependency '${c}'. Refusing to install ${d.packId}`);l=Vs(l,d)}return o("setContentPacks",[...n.contentPacks,...i]),o("setCurrentContent",l),r.map(d=>d.packId)})}},getters:{getCharacters({current:e}){const t=new Map;for(const o of e.characters)t.set(o.id,o);return t},getBackgrounds({current:e}){const t=new Map;for(const o of e.backgrounds)t.set(o.id,o);return t}}};function fl(e){return Xn(this,null,function*(){const t=yield fetch(e);if(!t.ok)throw new Error(`Could not load content pack. Server responded with: ${t.statusText}`);let o;try{o=yield t.json()}catch(n){throw new Error("Content pack is not valid json!")}try{const n={"./":iu(e),"/":iu(location.href)+"assets/"};return o.version==="2.0"?Mp(o,n):qp(Kp(o,n),n,!1)}catch(n){throw new Error("Content pack is not in a valid format!")}})}function cr(e){return Xn(this,null,function*(){const t=new Set((yield Bo())?["webp",...lu]:lu),o=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Hp(e,(n,s)=>{var r;const i=dl(n,o,t,!1),a=dl(n,o,t,!0);return{hq:i,lq:a,sourcePack:(r=e.packId)!=null?r:"buildIn"}})})}const _2={namespaced:!0,state:{},mutations:{add(e,{name:t,url:o}){e[t]=o}},actions:{add({state:e,commit:t},{name:o,url:n}){if(e[o])throw new Error(`There is already an uploaded file called "${o}"`);const s="uploads:"+o;return t("add",{name:s,url:n}),yf(s,n),s}}};var w2=Object.defineProperty,$2=Object.defineProperties,C2=Object.getOwnPropertyDescriptors,au=Object.getOwnPropertySymbols,P2=Object.prototype.hasOwnProperty,k2=Object.prototype.propertyIsEnumerable,du=(e,t,o)=>t in e?w2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,S2=(e,t)=>{for(var o in t||(t={}))P2.call(t,o)&&du(e,o,t[o]);if(au)for(var o of au(t))k2.call(t,o)&&du(e,o,t[o]);return e},O2=(e,t)=>$2(e,C2(t)),Ds=(e,t,o)=>new Promise((n,s)=>{var r=l=>{try{a(o.next(l))}catch(d){s(d)}},i=l=>{try{a(o.throw(l))}catch(d){s(d)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,i);a((o=o.apply(e,t)).next())});const x2=xT({state:{unsafe:!1},mutations:{setUnsafe(e,t){e.unsafe=t}},actions:{removePacks(e,t){return Ds(this,arguments,function*({dispatch:o,commit:n},{packs:s}){n("setUnsafe",!0),o("content/removeContentPacks",s),n("setUnsafe",!1)})},getSave(e,t){return Ds(this,arguments,function*({state:o},n){const s=yield Gt.getInstance();return JSON.stringify(o,(r,i)=>{if(r!=="ui"&&r!=="lastRender")return r==="uploadUrls"?Object.keys(i):r==="content"&&n?i.contentPacks.filter(a=>{var l,d;return!((l=a.packId)!=null&&l.startsWith("dddg.buildin."))||((d=a.packId)==null?void 0:d.endsWith(".nsfw"))}).map(a=>{var l;let d=(l=a.packId)!=null&&l.startsWith("dddg.uploads.")?a:a.packId;if(a.packId!=null){const c=s.getPack(a.packId);c&&c.repoUrl!=null&&(d+=`;${c.repoUrl}`)}return d}):i},2)})},loadSave(e,t){return Ds(this,arguments,function*({state:o},n){const s=JSON.parse(n),r=s.content;s.ui=O2(S2({},Dp()),{vertical:o.ui.vertical,lqRendering:o.ui.lqRendering,nsfw:r.find(l=>typeof l=="string"&&l.startsWith("dddg.buildin.")&&l.endsWith(".nsfw"))!==void 0,clipboard:o.ui.clipboard,useDarkTheme:o.ui.useDarkTheme,defaultCharacterTalkingZoom:o.ui.defaultCharacterTalkingZoom}),s.uploadUrls={},s.content=Yp();const i=yield Gt.getInstance();s.content.contentPacks=[...o.content.contentPacks.filter(l=>{var d;return(d=l.packId)==null?void 0:d.startsWith("dddg.buildin.")}),...(yield Promise.all(r.map(l=>Ds(this,null,function*(){if(typeof l!="string")return l;let d=null,c;l.indexOf(";")>=0?[c,d]=l.split(";"):c=l;const f=o.content.contentPacks.find(v=>v.packId===c);if(f)return f;if(l.startsWith("dddg.buildin.")&&l.endsWith(".nsfw")){const v=yield fl($a[l]);return yield cr(v)}d!=null&&!i.hasPack(c)&&(yield i.loadTempPack(d));const p=i.getPack(c);if(!p)return console.warn(`Pack Id ${l} not found!`),null;const b=yield fl(p.dddg2Path||p.dddg1Path);return yield cr(b)})))).filter(l=>l!==null)];let a=s.content.current;for(const l of s.content.contentPacks)a=Vs(a,l);s.content.current=a,this.replaceState(s),fe.fire(new _r)})}},modules:{ui:jT,panels:Ox,content:y2,uploadUrls:_2}}),j2={install(e,t={}){if(!e.config.globalProperties.$store)throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");t.resetStateMutation||(t.resetStateMutation="emptyState"),t.mutations||(t.mutations={});const o=e.config.globalProperties.$store;function n(c,f){let p={};switch(typeof f.payload){case"object":f.payload instanceof Array&&(p=[]),o.commit(`${f.type}`,Object.assign(p,f.payload));break;default:o.commit(`${f.type}`,f.payload)}}function s(c,f){return Yt(this,null,function*(){return yield c.transaction(()=>{f.forEach(p=>{n(c,p)})})})}function r(c){return Yt(this,null,function*(){const f=c.data.done.slice(0);c.data.done=[],o.commit(t.resetStateMutation);for(let p=0;p<f.length;++p)yield s(c,f[p])})}const i={};function a(c){if(!i[c]){const f=c.split("/"),p={ignore:v=>!1,combinable:(v,C)=>!1,combinator:(v,C)=>C};let b="";for(const v of f)t.mutations[b+"*"]&&Object.assign(p,t.mutations[b+"*"]),b+=v+"/";t.mutations[c]&&Object.assign(p,t.mutations[c]),i[c]=p}return i[c]}const l={data:Ut({done:[],undone:[],snapshots:[],transactionsSinceSnapshot:0,newMutation:!0,ignoreMutations:t.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}),initialize(){l.initialized||(l.initialized=!0,o.subscribe(c=>{const f=()=>{c.type===t.resetStateMutation||a(c.type).ignore(c)||(l.currentTransaction.push(c),l.newMutation&&(l.data.undone=[]))};l.currentTransaction?f():l.transaction(()=>{f()})}))},redo(){return Yt(this,null,function*(){if(l.data.undone.length<=0)return;const c=l.data.undone.pop();l.newMutation=!1,yield s(l,c),l.newMutation=!0})},undo(){return Yt(this,null,function*(){l.data.done.length<=0||(l.data.undone.push(l.data.done.pop()),l.newMutation=!1,yield r(l),l.newMutation=!0)})},clearHistory(){return new Promise((c,f)=>{const p=()=>Yt(this,null,function*(){l.currentTransaction=[],l.transactionsSinceSnapshot=0,l.data.undone=[],l.data.done=[],c(),l.currentTransaction=null,l.data.transactionQueue.length>0&&l.data.transactionQueue.shift()()});l.currentTransaction?l.data.transactionQueue.push(p):p()})},transaction(c){return new Promise((f,p)=>{const b=()=>Yt(this,null,function*(){l.currentTransaction=[],l.transactionsSinceSnapshot++;try{yield c()}catch(v){console.log("Error during transaction!: ",v)}l.currentTransaction=null,l.data.transactionQueue.length>0&&l.data.transactionQueue.shift()(),f()});l.currentTransaction?l.data.transactionQueue.push(b):b()})}};window.storeHistory=l,e.config.globalProperties.vuexHistory=l,l.initialize()}};Dm(UI).use(x2).use(j2).mount("#main_wrapper");export{Bt as A,Gl as B,vf as C,_f as D,hs as E,N as F,Nx as G,yt as H,Kl as L,Gt as R,Ln as S,T2 as T,hf as V,ne as _,u as a,G as b,_ as c,oe as d,q as e,Rg as f,Le as g,w as h,T as i,Et as j,X as k,A as l,O as m,le as n,m as o,Ne as p,W as q,$e as r,Re as s,pe as t,fe as u,xe as v,ae as w,Ut as x,Wt as y,ql as z};
