var Zr=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function kl(e,t){const n=Object.create(null),o=e.split(",");for(let s=0;s<o.length;s++)n[o[s]]=!0;return t?s=>!!n[s.toLowerCase()]:s=>!!n[s]}function Be(e){if(G(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],s=je(o)?mh(o):Be(o);if(s)for(const r in s)t[r]=s[r]}return t}else{if(je(e))return e;if(ve(e))return e}}const fh=/;(?![^(]*\))/g,hh=/:([^]+)/,gh=new RegExp("\\/\\*.*?\\*\\/","gs");function mh(e){const t={};return e.replace(gh,"").split(fh).forEach(n=>{if(n){const o=n.split(hh);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function fe(e){let t="";if(je(e))t=e;else if(G(e))for(let n=0;n<e.length;n++){const o=fe(e[n]);o&&(t+=o+" ")}else if(ve(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const bh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vh=kl(bh);function _u(e){return!!e||e===""}function yh(e,t){if(e.length!==t.length)return!1;let n=!0;for(let o=0;n&&o<e.length;o++)n=fs(e[o],t[o]);return n}function fs(e,t){if(e===t)return!0;let n=Ma(e),o=Ma(t);if(n||o)return n&&o?e.getTime()===t.getTime():!1;if(n=ts(e),o=ts(t),n||o)return e===t;if(n=G(e),o=G(t),n||o)return n&&o?yh(e,t):!1;if(n=ve(e),o=ve(t),n||o){if(!n||!o)return!1;const s=Object.keys(e).length,r=Object.keys(t).length;if(s!==r)return!1;for(const i in e){const a=e.hasOwnProperty(i),l=t.hasOwnProperty(i);if(a&&!l||!a&&l||!fs(e[i],t[i]))return!1}}return String(e)===String(t)}function Ol(e,t){return e.findIndex(n=>fs(n,t))}const he=e=>je(e)?e:e==null?"":G(e)||ve(e)&&(e.toString===Cu||!Q(e.toString))?JSON.stringify(e,wu,2):String(e),wu=(e,t)=>t&&t.__v_isRef?wu(e,t.value):oo(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[o,s])=>(n[`${o} =>`]=s,n),{})}:Co(t)?{[`Set(${t.size})`]:[...t.values()]}:ve(t)&&!G(t)&&!Pu(t)?String(t):t,Ce={},no=[],yt=()=>{},_h=()=>!1,wh=/^on[^a-z]/,yr=e=>wh.test(e),xl=e=>e.startsWith("onUpdate:"),Me=Object.assign,jl=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},$h=Object.prototype.hasOwnProperty,ie=(e,t)=>$h.call(e,t),G=Array.isArray,oo=e=>Po(e)==="[object Map]",Co=e=>Po(e)==="[object Set]",Ma=e=>Po(e)==="[object Date]",Ch=e=>Po(e)==="[object RegExp]",Q=e=>typeof e=="function",je=e=>typeof e=="string",ts=e=>typeof e=="symbol",ve=e=>e!==null&&typeof e=="object",$u=e=>ve(e)&&Q(e.then)&&Q(e.catch),Cu=Object.prototype.toString,Po=e=>Cu.call(e),Ph=e=>Po(e).slice(8,-1),Pu=e=>Po(e)==="[object Object]",Il=e=>je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Vs=kl(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),_r=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Sh=/-(\w)/g,Rt=_r(e=>e.replace(Sh,(t,n)=>n?n.toUpperCase():"")),kh=/\B([A-Z])/g,Hn=_r(e=>e.replace(kh,"-$1").toLowerCase()),wr=_r(e=>e.charAt(0).toUpperCase()+e.slice(1)),Qr=_r(e=>e?`on${wr(e)}`:""),ns=(e,t)=>!Object.is(e,t),so=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Js=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},Zs=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Oh=e=>{const t=je(e)?Number(e):NaN;return isNaN(t)?e:t};let Na;const xh=()=>Na||(Na=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let mt;class Su{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=mt,!t&&mt&&(this.index=(mt.scopes||(mt.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const n=mt;try{return mt=this,t()}finally{mt=n}}}on(){mt=this}off(){mt=this.parent}stop(t){if(this._active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function jh(e){return new Su(e)}function Ih(e,t=mt){t&&t.active&&t.effects.push(e)}function Th(){return mt}const Tl=e=>{const t=new Set(e);return t.w=0,t.n=0,t},ku=e=>(e.w&vn)>0,Ou=e=>(e.n&vn)>0,Eh=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=vn},Bh=e=>{const{deps:t}=e;if(t.length){let n=0;for(let o=0;o<t.length;o++){const s=t[o];ku(s)&&!Ou(s)?s.delete(e):t[n++]=s,s.w&=~vn,s.n&=~vn}t.length=n}},Fi=new WeakMap;let zo=0,vn=1;const Mi=30;let bt;const Dn=Symbol(""),Ni=Symbol("");class El{constructor(t,n=null,o){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Ih(this,o)}run(){if(!this.active)return this.fn();let t=bt,n=hn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=bt,bt=this,hn=!0,vn=1<<++zo,zo<=Mi?Eh(this):Ha(this),this.fn()}finally{zo<=Mi&&Bh(this),vn=1<<--zo,bt=this.parent,hn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){bt===this?this.deferStop=!0:this.active&&(Ha(this),this.onStop&&this.onStop(),this.active=!1)}}function Ha(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let hn=!0;const xu=[];function So(){xu.push(hn),hn=!1}function ko(){const e=xu.pop();hn=e===void 0?!0:e}function Ze(e,t,n){if(hn&&bt){let o=Fi.get(e);o||Fi.set(e,o=new Map);let s=o.get(n);s||o.set(n,s=Tl()),ju(s)}}function ju(e,t){let n=!1;zo<=Mi?Ou(e)||(e.n|=vn,n=!ku(e)):n=!e.has(bt),n&&(e.add(bt),bt.deps.push(e))}function Kt(e,t,n,o,s,r){const i=Fi.get(e);if(!i)return;let a=[];if(t==="clear")a=[...i.values()];else if(n==="length"&&G(e)){const l=Number(o);i.forEach((d,c)=>{(c==="length"||c>=l)&&a.push(d)})}else switch(n!==void 0&&a.push(i.get(n)),t){case"add":G(e)?Il(n)&&a.push(i.get("length")):(a.push(i.get(Dn)),oo(e)&&a.push(i.get(Ni)));break;case"delete":G(e)||(a.push(i.get(Dn)),oo(e)&&a.push(i.get(Ni)));break;case"set":oo(e)&&a.push(i.get(Dn));break}if(a.length===1)a[0]&&Hi(a[0]);else{const l=[];for(const d of a)d&&l.push(...d);Hi(Tl(l))}}function Hi(e,t){const n=G(e)?e:[...e];for(const o of n)o.computed&&La(o);for(const o of n)o.computed||La(o)}function La(e,t){(e!==bt||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Ah=kl("__proto__,__v_isRef,__isVue"),Iu=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ts)),Dh=Bl(),Rh=Bl(!1,!0),Fh=Bl(!0),Ua=Mh();function Mh(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const o=le(this);for(let r=0,i=this.length;r<i;r++)Ze(o,"get",r+"");const s=o[t](...n);return s===-1||s===!1?o[t](...n.map(le)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){So();const o=le(this)[t].apply(this,n);return ko(),o}}),e}function Nh(e){const t=le(this);return Ze(t,"has",e),t.hasOwnProperty(e)}function Bl(e=!1,t=!1){return function(o,s,r){if(s==="__v_isReactive")return!e;if(s==="__v_isReadonly")return e;if(s==="__v_isShallow")return t;if(s==="__v_raw"&&r===(e?t?tg:Du:t?Au:Bu).get(o))return o;const i=G(o);if(!e){if(i&&ie(Ua,s))return Reflect.get(Ua,s,r);if(s==="hasOwnProperty")return Nh}const a=Reflect.get(o,s,r);return(ts(s)?Iu.has(s):Ah(s))||(e||Ze(o,"get",s),t)?a:ze(a)?i&&Il(s)?a:a.value:ve(a)?e?Ru(a):yn(a):a}}const Hh=Tu(),Lh=Tu(!0);function Tu(e=!1){return function(n,o,s,r){let i=n[o];if(uo(i)&&ze(i)&&!ze(s))return!1;if(!e&&(!Qs(s)&&!uo(s)&&(i=le(i),s=le(s)),!G(n)&&ze(i)&&!ze(s)))return i.value=s,!0;const a=G(n)&&Il(o)?Number(o)<n.length:ie(n,o),l=Reflect.set(n,o,s,r);return n===le(r)&&(a?ns(s,i)&&Kt(n,"set",o,s):Kt(n,"add",o,s)),l}}function Uh(e,t){const n=ie(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&Kt(e,"delete",t,void 0),o}function Vh(e,t){const n=Reflect.has(e,t);return(!ts(t)||!Iu.has(t))&&Ze(e,"has",t),n}function Wh(e){return Ze(e,"iterate",G(e)?"length":Dn),Reflect.ownKeys(e)}const Eu={get:Dh,set:Hh,deleteProperty:Uh,has:Vh,ownKeys:Wh},zh={get:Fh,set(e,t){return!0},deleteProperty(e,t){return!0}},Gh=Me({},Eu,{get:Rh,set:Lh}),Al=e=>e,$r=e=>Reflect.getPrototypeOf(e);function js(e,t,n=!1,o=!1){e=e.__v_raw;const s=le(e),r=le(t);n||(t!==r&&Ze(s,"get",t),Ze(s,"get",r));const{has:i}=$r(s),a=o?Al:n?Fl:os;if(i.call(s,t))return a(e.get(t));if(i.call(s,r))return a(e.get(r));e!==s&&e.get(t)}function Is(e,t=!1){const n=this.__v_raw,o=le(n),s=le(e);return t||(e!==s&&Ze(o,"has",e),Ze(o,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function Ts(e,t=!1){return e=e.__v_raw,!t&&Ze(le(e),"iterate",Dn),Reflect.get(e,"size",e)}function Va(e){e=le(e);const t=le(this);return $r(t).has.call(t,e)||(t.add(e),Kt(t,"add",e,e)),this}function Wa(e,t){t=le(t);const n=le(this),{has:o,get:s}=$r(n);let r=o.call(n,e);r||(e=le(e),r=o.call(n,e));const i=s.call(n,e);return n.set(e,t),r?ns(t,i)&&Kt(n,"set",e,t):Kt(n,"add",e,t),this}function za(e){const t=le(this),{has:n,get:o}=$r(t);let s=n.call(t,e);s||(e=le(e),s=n.call(t,e)),o&&o.call(t,e);const r=t.delete(e);return s&&Kt(t,"delete",e,void 0),r}function Ga(){const e=le(this),t=e.size!==0,n=e.clear();return t&&Kt(e,"clear",void 0,void 0),n}function Es(e,t){return function(o,s){const r=this,i=r.__v_raw,a=le(i),l=t?Al:e?Fl:os;return!e&&Ze(a,"iterate",Dn),i.forEach((d,c)=>o.call(s,l(d),l(c),r))}}function Bs(e,t,n){return function(...o){const s=this.__v_raw,r=le(s),i=oo(r),a=e==="entries"||e===Symbol.iterator&&i,l=e==="keys"&&i,d=s[e](...o),c=n?Al:t?Fl:os;return!t&&Ze(r,"iterate",l?Ni:Dn),{next(){const{value:p,done:f}=d.next();return f?{value:p,done:f}:{value:a?[c(p[0]),c(p[1])]:c(p),done:f}},[Symbol.iterator](){return this}}}}function en(e){return function(...t){return e==="delete"?!1:this}}function qh(){const e={get(r){return js(this,r)},get size(){return Ts(this)},has:Is,add:Va,set:Wa,delete:za,clear:Ga,forEach:Es(!1,!1)},t={get(r){return js(this,r,!1,!0)},get size(){return Ts(this)},has:Is,add:Va,set:Wa,delete:za,clear:Ga,forEach:Es(!1,!0)},n={get(r){return js(this,r,!0)},get size(){return Ts(this,!0)},has(r){return Is.call(this,r,!0)},add:en("add"),set:en("set"),delete:en("delete"),clear:en("clear"),forEach:Es(!0,!1)},o={get(r){return js(this,r,!0,!0)},get size(){return Ts(this,!0)},has(r){return Is.call(this,r,!0)},add:en("add"),set:en("set"),delete:en("delete"),clear:en("clear"),forEach:Es(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=Bs(r,!1,!1),n[r]=Bs(r,!0,!1),t[r]=Bs(r,!1,!0),o[r]=Bs(r,!0,!0)}),[e,n,t,o]}const[Xh,Kh,Yh,Jh]=qh();function Dl(e,t){const n=t?e?Jh:Yh:e?Kh:Xh;return(o,s,r)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?o:Reflect.get(ie(n,s)&&s in o?n:o,s,r)}const Zh={get:Dl(!1,!1)},Qh={get:Dl(!1,!0)},eg={get:Dl(!0,!1)},Bu=new WeakMap,Au=new WeakMap,Du=new WeakMap,tg=new WeakMap;function ng(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function og(e){return e.__v_skip||!Object.isExtensible(e)?0:ng(Ph(e))}function yn(e){return uo(e)?e:Rl(e,!1,Eu,Zh,Bu)}function sg(e){return Rl(e,!1,Gh,Qh,Au)}function Ru(e){return Rl(e,!0,zh,eg,Du)}function Rl(e,t,n,o,s){if(!ve(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=s.get(e);if(r)return r;const i=og(e);if(i===0)return e;const a=new Proxy(e,i===2?o:n);return s.set(e,a),a}function ro(e){return uo(e)?ro(e.__v_raw):!!(e&&e.__v_isReactive)}function uo(e){return!!(e&&e.__v_isReadonly)}function Qs(e){return!!(e&&e.__v_isShallow)}function Fu(e){return ro(e)||uo(e)}function le(e){const t=e&&e.__v_raw;return t?le(t):e}function Cr(e){return Js(e,"__v_skip",!0),e}const os=e=>ve(e)?yn(e):e,Fl=e=>ve(e)?Ru(e):e;function Mu(e){hn&&bt&&(e=le(e),ju(e.dep||(e.dep=Tl())))}function Nu(e,t){e=le(e);const n=e.dep;n&&Hi(n)}function ze(e){return!!(e&&e.__v_isRef===!0)}function io(e){return rg(e,!1)}function rg(e,t){return ze(e)?e:new ig(e,t)}class ig{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:le(t),this._value=n?t:os(t)}get value(){return Mu(this),this._value}set value(t){const n=this.__v_isShallow||Qs(t)||uo(t);t=n?t:le(t),ns(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:os(t),Nu(this))}}function lg(e){return ze(e)?e.value:e}const ag={get:(e,t,n)=>lg(Reflect.get(e,t,n)),set:(e,t,n,o)=>{const s=e[t];return ze(s)&&!ze(n)?(s.value=n,!0):Reflect.set(e,t,n,o)}};function Hu(e){return ro(e)?e:new Proxy(e,ag)}var Lu;class dg{constructor(t,n,o,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Lu]=!1,this._dirty=!0,this.effect=new El(t,()=>{this._dirty||(this._dirty=!0,Nu(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const t=le(this);return Mu(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Lu="__v_isReadonly";function cg(e,t,n=!1){let o,s;const r=Q(e);return r?(o=e,s=yt):(o=e.get,s=e.set),new dg(o,s,r||!s,n)}function gn(e,t,n,o){let s;try{s=o?e(...o):e()}catch(r){hs(r,t,n)}return s}function pt(e,t,n,o){if(Q(e)){const r=gn(e,t,n,o);return r&&$u(r)&&r.catch(i=>{hs(i,t,n)}),r}const s=[];for(let r=0;r<e.length;r++)s.push(pt(e[r],t,n,o));return s}function hs(e,t,n,o=!0){const s=t?t.vnode:null;if(t){let r=t.parent;const i=t.proxy,a=n;for(;r;){const d=r.ec;if(d){for(let c=0;c<d.length;c++)if(d[c](e,i,a)===!1)return}r=r.parent}const l=t.appContext.config.errorHandler;if(l){gn(l,null,10,[e,i,a]);return}}ug(e,n,s,o)}function ug(e,t,n,o=!0){console.error(e)}let ss=!1,Li=!1;const We=[];let Bt=0;const lo=[];let qt=null,En=0;const Uu=Promise.resolve();let Ml=null;function pg(e){const t=Ml||Uu;return e?t.then(this?e.bind(this):e):t}function fg(e){let t=Bt+1,n=We.length;for(;t<n;){const o=t+n>>>1;rs(We[o])<e?t=o+1:n=o}return t}function Pr(e){(!We.length||!We.includes(e,ss&&e.allowRecurse?Bt+1:Bt))&&(e.id==null?We.push(e):We.splice(fg(e.id),0,e),Vu())}function Vu(){!ss&&!Li&&(Li=!0,Ml=Uu.then(zu))}function hg(e){const t=We.indexOf(e);t>Bt&&We.splice(t,1)}function gg(e){G(e)?lo.push(...e):(!qt||!qt.includes(e,e.allowRecurse?En+1:En))&&lo.push(e),Vu()}function qa(e,t=ss?Bt+1:0){for(;t<We.length;t++){const n=We[t];n&&n.pre&&(We.splice(t,1),t--,n())}}function Wu(e){if(lo.length){const t=[...new Set(lo)];if(lo.length=0,qt){qt.push(...t);return}for(qt=t,qt.sort((n,o)=>rs(n)-rs(o)),En=0;En<qt.length;En++)qt[En]();qt=null,En=0}}const rs=e=>e.id==null?1/0:e.id,mg=(e,t)=>{const n=rs(e)-rs(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function zu(e){Li=!1,ss=!0,We.sort(mg);const t=yt;try{for(Bt=0;Bt<We.length;Bt++){const n=We[Bt];n&&n.active!==!1&&gn(n,null,14)}}finally{Bt=0,We.length=0,Wu(),ss=!1,Ml=null,(We.length||lo.length)&&zu()}}function bg(e,t,...n){if(e.isUnmounted)return;const o=e.vnode.props||Ce;let s=n;const r=t.startsWith("update:"),i=r&&t.slice(7);if(i&&i in o){const c=`${i==="modelValue"?"model":i}Modifiers`,{number:p,trim:f}=o[c]||Ce;f&&(s=n.map(b=>je(b)?b.trim():b)),p&&(s=n.map(Zs))}let a,l=o[a=Qr(t)]||o[a=Qr(Rt(t))];!l&&r&&(l=o[a=Qr(Hn(t))]),l&&pt(l,e,6,s);const d=o[a+"Once"];if(d){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,pt(d,e,6,s)}}function Gu(e,t,n=!1){const o=t.emitsCache,s=o.get(e);if(s!==void 0)return s;const r=e.emits;let i={},a=!1;if(!Q(e)){const l=d=>{const c=Gu(d,t,!0);c&&(a=!0,Me(i,c))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!r&&!a?(ve(e)&&o.set(e,null),null):(G(r)?r.forEach(l=>i[l]=null):Me(i,r),ve(e)&&o.set(e,i),i)}function Sr(e,t){return!e||!yr(t)?!1:(t=t.slice(2).replace(/Once$/,""),ie(e,t[0].toLowerCase()+t.slice(1))||ie(e,Hn(t))||ie(e,t))}let Le=null,kr=null;function er(e){const t=Le;return Le=e,kr=e&&e.type.__scopeId||null,t}function Ge(e){kr=e}function qe(){kr=null}function B(e,t=Le,n){if(!t||e._n)return e;const o=(...s)=>{o._d&&rd(-1);const r=er(t);let i;try{i=e(...s)}finally{er(r),o._d&&rd(1)}return i};return o._n=!0,o._c=!0,o._d=!0,o}function ei(e){const{type:t,vnode:n,proxy:o,withProxy:s,props:r,propsOptions:[i],slots:a,attrs:l,emit:d,render:c,renderCache:p,data:f,setupState:b,ctx:v,inheritAttrs:$}=e;let M,R;const w=er(e);try{if(n.shapeFlag&4){const j=s||o;M=Et(c.call(j,j,p,r,b,f,v)),R=l}else{const j=t;M=Et(j.length>1?j(r,{attrs:l,slots:a,emit:d}):j(r,null)),R=t.props?l:vg(l)}}catch(j){Jo.length=0,hs(j,e,1),M=C(ft)}let x=M;if(R&&$!==!1){const j=Object.keys(R),{shapeFlag:Y}=x;j.length&&Y&7&&(i&&j.some(xl)&&(R=yg(R,i)),x=Yt(x,R))}return n.dirs&&(x=Yt(x),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&(x.transition=n.transition),M=x,er(w),M}const vg=e=>{let t;for(const n in e)(n==="class"||n==="style"||yr(n))&&((t||(t={}))[n]=e[n]);return t},yg=(e,t)=>{const n={};for(const o in e)(!xl(o)||!(o.slice(9)in t))&&(n[o]=e[o]);return n};function _g(e,t,n){const{props:o,children:s,component:r}=e,{props:i,children:a,patchFlag:l}=t,d=r.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return o?Xa(o,i,d):!!i;if(l&8){const c=t.dynamicProps;for(let p=0;p<c.length;p++){const f=c[p];if(i[f]!==o[f]&&!Sr(d,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===i?!1:o?i?Xa(o,i,d):!0:!!i;return!1}function Xa(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(t[r]!==e[r]&&!Sr(n,r))return!0}return!1}function wg({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const qu=e=>e.__isSuspense;function $g(e,t){t&&t.pendingBranch?G(e)?t.effects.push(...e):t.effects.push(e):gg(e)}function Cg(e,t){if(xe){let n=xe.provides;const o=xe.parent&&xe.parent.provides;o===n&&(n=xe.provides=Object.create(o)),n[e]=t}}function Ws(e,t,n=!1){const o=xe||Le;if(o){const s=o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&Q(t)?t.call(o.proxy):t}}const As={};function Rn(e,t,n){return Xu(e,t,n)}function Xu(e,t,{immediate:n,deep:o,flush:s,onTrack:r,onTrigger:i}=Ce){const a=Th()===(xe==null?void 0:xe.scope)?xe:null;let l,d=!1,c=!1;if(ze(e)?(l=()=>e.value,d=Qs(e)):ro(e)?(l=()=>e,o=!0):G(e)?(c=!0,d=e.some(x=>ro(x)||Qs(x)),l=()=>e.map(x=>{if(ze(x))return x.value;if(ro(x))return An(x);if(Q(x))return gn(x,a,2)})):Q(e)?t?l=()=>gn(e,a,2):l=()=>{if(!(a&&a.isUnmounted))return p&&p(),pt(e,a,3,[f])}:l=yt,t&&o){const x=l;l=()=>An(x())}let p,f=x=>{p=R.onStop=()=>{gn(x,a,4)}},b;if(ho)if(f=yt,t?n&&pt(t,a,3,[l(),c?[]:void 0,f]):l(),s==="sync"){const x=ym();b=x.__watcherHandles||(x.__watcherHandles=[])}else return yt;let v=c?new Array(e.length).fill(As):As;const $=()=>{if(!!R.active)if(t){const x=R.run();(o||d||(c?x.some((j,Y)=>ns(j,v[Y])):ns(x,v)))&&(p&&p(),pt(t,a,3,[x,v===As?void 0:c&&v[0]===As?[]:v,f]),v=x)}else R.run()};$.allowRecurse=!!t;let M;s==="sync"?M=$:s==="post"?M=()=>Ne($,a&&a.suspense):($.pre=!0,a&&($.id=a.uid),M=()=>Pr($));const R=new El(l,M);t?n?$():v=R.run():s==="post"?Ne(R.run.bind(R),a&&a.suspense):R.run();const w=()=>{R.stop(),a&&a.scope&&jl(a.scope.effects,R)};return b&&b.push(w),w}function Pg(e,t,n){const o=this.proxy,s=je(e)?e.includes(".")?Ku(o,e):()=>o[e]:e.bind(o,o);let r;Q(t)?r=t:(r=t.handler,n=t);const i=xe;fo(this);const a=Xu(s,r.bind(o),n);return i?fo(i):Fn(),a}function Ku(e,t){const n=t.split(".");return()=>{let o=e;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}function An(e,t){if(!ve(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ze(e))An(e.value,t);else if(G(e))for(let n=0;n<e.length;n++)An(e[n],t);else if(Co(e)||oo(e))e.forEach(n=>{An(n,t)});else if(Pu(e))for(const n in e)An(e[n],t);return e}function Yu(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hl(()=>{e.isMounted=!0}),Ul(()=>{e.isUnmounting=!0}),e}const rt=[Function,Array],Sg={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:rt,onEnter:rt,onAfterEnter:rt,onEnterCancelled:rt,onBeforeLeave:rt,onLeave:rt,onAfterLeave:rt,onLeaveCancelled:rt,onBeforeAppear:rt,onAppear:rt,onAfterAppear:rt,onAppearCancelled:rt},setup(e,{slots:t}){const n=ql(),o=Yu();let s;return()=>{const r=t.default&&Nl(t.default(),!0);if(!r||!r.length)return;let i=r[0];if(r.length>1){for(const $ of r)if($.type!==ft){i=$;break}}const a=le(e),{mode:l}=a;if(o.isLeaving)return ti(i);const d=Ka(i);if(!d)return ti(i);const c=is(d,a,o,n);po(d,c);const p=n.subTree,f=p&&Ka(p);let b=!1;const{getTransitionKey:v}=d.type;if(v){const $=v();s===void 0?s=$:$!==s&&(s=$,b=!0)}if(f&&f.type!==ft&&(!un(d,f)||b)){const $=is(f,a,o,n);if(po(f,$),l==="out-in")return o.isLeaving=!0,$.afterLeave=()=>{o.isLeaving=!1,n.update.active!==!1&&n.update()},ti(i);l==="in-out"&&d.type!==ft&&($.delayLeave=(M,R,w)=>{const x=Ju(o,f);x[String(f.key)]=f,M._leaveCb=()=>{R(),M._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=w})}return i}}},kg=Sg;function Ju(e,t){const{leavingVNodes:n}=e;let o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function is(e,t,n,o){const{appear:s,mode:r,persisted:i=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:d,onEnterCancelled:c,onBeforeLeave:p,onLeave:f,onAfterLeave:b,onLeaveCancelled:v,onBeforeAppear:$,onAppear:M,onAfterAppear:R,onAppearCancelled:w}=t,x=String(e.key),j=Ju(n,e),Y=(L,se)=>{L&&pt(L,o,9,se)},ee=(L,se)=>{const ne=se[1];Y(L,se),G(L)?L.every(ge=>ge.length<=1)&&ne():L.length<=1&&ne()},ae={mode:r,persisted:i,beforeEnter(L){let se=a;if(!n.isMounted)if(s)se=$||a;else return;L._leaveCb&&L._leaveCb(!0);const ne=j[x];ne&&un(e,ne)&&ne.el._leaveCb&&ne.el._leaveCb(),Y(se,[L])},enter(L){let se=l,ne=d,ge=c;if(!n.isMounted)if(s)se=M||l,ne=R||d,ge=w||c;else return;let N=!1;const ye=L._enterCb=Ve=>{N||(N=!0,Ve?Y(ge,[L]):Y(ne,[L]),ae.delayedLeave&&ae.delayedLeave(),L._enterCb=void 0)};se?ee(se,[L,ye]):ye()},leave(L,se){const ne=String(e.key);if(L._enterCb&&L._enterCb(!0),n.isUnmounting)return se();Y(p,[L]);let ge=!1;const N=L._leaveCb=ye=>{ge||(ge=!0,se(),ye?Y(v,[L]):Y(b,[L]),L._leaveCb=void 0,j[ne]===e&&delete j[ne])};j[ne]=e,f?ee(f,[L,N]):N()},clone(L){return is(L,t,n,o)}};return ae}function ti(e){if(gs(e))return e=Yt(e),e.children=null,e}function Ka(e){return gs(e)?e.children?e.children[0]:void 0:e}function po(e,t){e.shapeFlag&6&&e.component?po(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Nl(e,t=!1,n){let o=[],s=0;for(let r=0;r<e.length;r++){let i=e[r];const a=n==null?i.key:String(n)+String(i.key!=null?i.key:r);i.type===V?(i.patchFlag&128&&s++,o=o.concat(Nl(i.children,t,a))):(t||i.type!==ft)&&o.push(a!=null?Yt(i,{key:a}):i)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}function te(e){return Q(e)?{setup:e,name:e.name}:e}const ao=e=>!!e.type.__asyncLoader;function Ya(e){Q(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:o,delay:s=200,timeout:r,suspensible:i=!0,onError:a}=e;let l=null,d,c=0;const p=()=>(c++,l=null,f()),f=()=>{let b;return l||(b=l=t().catch(v=>{if(v=v instanceof Error?v:new Error(String(v)),a)return new Promise(($,M)=>{a(v,()=>$(p()),()=>M(v),c+1)});throw v}).then(v=>b!==l&&l?l:(v&&(v.__esModule||v[Symbol.toStringTag]==="Module")&&(v=v.default),d=v,v)))};return te({name:"AsyncComponentWrapper",__asyncLoader:f,get __asyncResolved(){return d},setup(){const b=xe;if(d)return()=>ni(d,b);const v=w=>{l=null,hs(w,b,13,!o)};if(i&&b.suspense||ho)return f().then(w=>()=>ni(w,b)).catch(w=>(v(w),()=>o?C(o,{error:w}):null));const $=io(!1),M=io(),R=io(!!s);return s&&setTimeout(()=>{R.value=!1},s),r!=null&&setTimeout(()=>{if(!$.value&&!M.value){const w=new Error(`Async component timed out after ${r}ms.`);v(w),M.value=w}},r),f().then(()=>{$.value=!0,b.parent&&gs(b.parent.vnode)&&Pr(b.parent.update)}).catch(w=>{v(w),M.value=w}),()=>{if($.value&&d)return ni(d,b);if(M.value&&o)return C(o,{error:M.value});if(n&&!R.value)return C(n)}}})}function ni(e,t){const{ref:n,props:o,children:s,ce:r}=t.vnode,i=C(e,o,s);return i.ref=n,i.ce=r,delete t.vnode.ce,i}const gs=e=>e.type.__isKeepAlive,Og={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=ql(),o=n.ctx;if(!o.renderer)return()=>{const w=t.default&&t.default();return w&&w.length===1?w[0]:w};const s=new Map,r=new Set;let i=null;const a=n.suspense,{renderer:{p:l,m:d,um:c,o:{createElement:p}}}=o,f=p("div");o.activate=(w,x,j,Y,ee)=>{const ae=w.component;d(w,x,j,0,a),l(ae.vnode,w,x,j,ae,a,Y,w.slotScopeIds,ee),Ne(()=>{ae.isDeactivated=!1,ae.a&&so(ae.a);const L=w.props&&w.props.onVnodeMounted;L&&at(L,ae.parent,w)},a)},o.deactivate=w=>{const x=w.component;d(w,f,null,1,a),Ne(()=>{x.da&&so(x.da);const j=w.props&&w.props.onVnodeUnmounted;j&&at(j,x.parent,w),x.isDeactivated=!0},a)};function b(w){oi(w),c(w,n,a,!0)}function v(w){s.forEach((x,j)=>{const Y=Xi(x.type);Y&&(!w||!w(Y))&&$(j)})}function $(w){const x=s.get(w);!i||!un(x,i)?b(x):i&&oi(i),s.delete(w),r.delete(w)}Rn(()=>[e.include,e.exclude],([w,x])=>{w&&v(j=>Go(w,j)),x&&v(j=>!Go(x,j))},{flush:"post",deep:!0});let M=null;const R=()=>{M!=null&&s.set(M,si(n.subTree))};return Hl(R),Ll(R),Ul(()=>{s.forEach(w=>{const{subTree:x,suspense:j}=n,Y=si(x);if(w.type===Y.type&&w.key===Y.key){oi(Y);const ee=Y.component.da;ee&&Ne(ee,j);return}b(w)})}),()=>{if(M=null,!t.default)return null;const w=t.default(),x=w[0];if(w.length>1)return i=null,w;if(!as(x)||!(x.shapeFlag&4)&&!(x.shapeFlag&128))return i=null,x;let j=si(x);const Y=j.type,ee=Xi(ao(j)?j.type.__asyncResolved||{}:Y),{include:ae,exclude:L,max:se}=e;if(ae&&(!ee||!Go(ae,ee))||L&&ee&&Go(L,ee))return i=j,x;const ne=j.key==null?Y:j.key,ge=s.get(ne);return j.el&&(j=Yt(j),x.shapeFlag&128&&(x.ssContent=j)),M=ne,ge?(j.el=ge.el,j.component=ge.component,j.transition&&po(j,j.transition),j.shapeFlag|=512,r.delete(ne),r.add(ne)):(r.add(ne),se&&r.size>parseInt(se,10)&&$(r.values().next().value)),j.shapeFlag|=256,i=j,qu(x.type)?x:j}}},xg=Og;function Go(e,t){return G(e)?e.some(n=>Go(n,t)):je(e)?e.split(",").includes(t):Ch(e)?e.test(t):!1}function jg(e,t){Zu(e,"a",t)}function Ig(e,t){Zu(e,"da",t)}function Zu(e,t,n=xe){const o=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(Or(t,o,n),n){let s=n.parent;for(;s&&s.parent;)gs(s.parent.vnode)&&Tg(o,t,n,s),s=s.parent}}function Tg(e,t,n,o){const s=Or(t,e,o,!0);Qu(()=>{jl(o[t],s)},n)}function oi(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function si(e){return e.shapeFlag&128?e.ssContent:e}function Or(e,t,n=xe,o=!1){if(n){const s=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...i)=>{if(n.isUnmounted)return;So(),fo(n);const a=pt(t,n,e,i);return Fn(),ko(),a});return o?s.unshift(r):s.push(r),r}}const Zt=e=>(t,n=xe)=>(!ho||e==="sp")&&Or(e,(...o)=>t(...o),n),Eg=Zt("bm"),Hl=Zt("m"),Bg=Zt("bu"),Ll=Zt("u"),Ul=Zt("bum"),Qu=Zt("um"),Ag=Zt("sp"),Dg=Zt("rtg"),Rg=Zt("rtc");function Fg(e,t=xe){Or("ec",e,t)}function ce(e,t){const n=Le;if(n===null)return e;const o=Ir(n)||n.proxy,s=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[i,a,l,d=Ce]=t[r];i&&(Q(i)&&(i={mounted:i,updated:i}),i.deep&&An(a),s.push({dir:i,instance:o,value:a,oldValue:void 0,arg:l,modifiers:d}))}return e}function Sn(e,t,n,o){const s=e.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){const a=s[i];r&&(a.oldValue=r[i].value);let l=a.dir[o];l&&(So(),pt(l,n,8,[e.el,a,e,t]),ko())}}const ep="components";function E(e,t){return Ng(ep,e,!0,t)||e}const Mg=Symbol();function Ng(e,t,n=!0,o=!1){const s=Le||xe;if(s){const r=s.type;if(e===ep){const a=Xi(r,!1);if(a&&(a===t||a===Rt(t)||a===wr(Rt(t))))return r}const i=Ja(s[e]||r[e],t)||Ja(s.appContext[e],t);return!i&&o?r:i}}function Ja(e,t){return e&&(e[t]||e[Rt(t)]||e[wr(Rt(t))])}function Pe(e,t,n,o){let s;const r=n&&n[o];if(G(e)||je(e)){s=new Array(e.length);for(let i=0,a=e.length;i<a;i++)s[i]=t(e[i],i,void 0,r&&r[i])}else if(typeof e=="number"){s=new Array(e);for(let i=0;i<e;i++)s[i]=t(i+1,i,void 0,r&&r[i])}else if(ve(e))if(e[Symbol.iterator])s=Array.from(e,(i,a)=>t(i,a,void 0,r&&r[a]));else{const i=Object.keys(e);s=new Array(i.length);for(let a=0,l=i.length;a<l;a++){const d=i[a];s[a]=t(e[d],d,a,r&&r[a])}}else s=[];return n&&(n[o]=s),s}function Xt(e,t,n={},o,s){if(Le.isCE||Le.parent&&ao(Le.parent)&&Le.parent.isCE)return t!=="default"&&(n.name=t),C("slot",n,o&&o());let r=e[t];r&&r._c&&(r._d=!1),g();const i=r&&tp(r(n)),a=U(V,{key:n.key||i&&i.key||`_${t}`},i||(o?o():[]),i&&e._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function tp(e){return e.some(t=>as(t)?!(t.type===ft||t.type===V&&!tp(t.children)):!0)?e:null}const Ui=e=>e?fp(e)?Ir(e)||e.proxy:Ui(e.parent):null,Ko=Me(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ui(e.parent),$root:e=>Ui(e.root),$emit:e=>e.emit,$options:e=>Vl(e),$forceUpdate:e=>e.f||(e.f=()=>Pr(e.update)),$nextTick:e=>e.n||(e.n=pg.bind(e.proxy)),$watch:e=>Pg.bind(e)}),ri=(e,t)=>e!==Ce&&!e.__isScriptSetup&&ie(e,t),Hg={get({_:e},t){const{ctx:n,setupState:o,data:s,props:r,accessCache:i,type:a,appContext:l}=e;let d;if(t[0]!=="$"){const b=i[t];if(b!==void 0)switch(b){case 1:return o[t];case 2:return s[t];case 4:return n[t];case 3:return r[t]}else{if(ri(o,t))return i[t]=1,o[t];if(s!==Ce&&ie(s,t))return i[t]=2,s[t];if((d=e.propsOptions[0])&&ie(d,t))return i[t]=3,r[t];if(n!==Ce&&ie(n,t))return i[t]=4,n[t];Vi&&(i[t]=0)}}const c=Ko[t];let p,f;if(c)return t==="$attrs"&&Ze(e,"get",t),c(e);if((p=a.__cssModules)&&(p=p[t]))return p;if(n!==Ce&&ie(n,t))return i[t]=4,n[t];if(f=l.config.globalProperties,ie(f,t))return f[t]},set({_:e},t,n){const{data:o,setupState:s,ctx:r}=e;return ri(s,t)?(s[t]=n,!0):o!==Ce&&ie(o,t)?(o[t]=n,!0):ie(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:s,propsOptions:r}},i){let a;return!!n[i]||e!==Ce&&ie(e,i)||ri(t,i)||(a=r[0])&&ie(a,i)||ie(o,i)||ie(Ko,i)||ie(s.config.globalProperties,i)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ie(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Vi=!0;function Lg(e){const t=Vl(e),n=e.proxy,o=e.ctx;Vi=!1,t.beforeCreate&&Za(t.beforeCreate,e,"bc");const{data:s,computed:r,methods:i,watch:a,provide:l,inject:d,created:c,beforeMount:p,mounted:f,beforeUpdate:b,updated:v,activated:$,deactivated:M,beforeDestroy:R,beforeUnmount:w,destroyed:x,unmounted:j,render:Y,renderTracked:ee,renderTriggered:ae,errorCaptured:L,serverPrefetch:se,expose:ne,inheritAttrs:ge,components:N,directives:ye,filters:Ve}=t;if(d&&Ug(d,o,null,e.appContext.config.unwrapInjectedRef),i)for(const ke in i){const _e=i[ke];Q(_e)&&(o[ke]=_e.bind(n))}if(s){const ke=s.call(n,n);ve(ke)&&(e.data=yn(ke))}if(Vi=!0,r)for(const ke in r){const _e=r[ke],Cn=Q(_e)?_e.bind(n,n):Q(_e.get)?_e.get.bind(n,n):yt,Os=!Q(_e)&&Q(_e.set)?_e.set.bind(n):yt,Pn=nr({get:Cn,set:Os});Object.defineProperty(o,ke,{enumerable:!0,configurable:!0,get:()=>Pn.value,set:St=>Pn.value=St})}if(a)for(const ke in a)np(a[ke],o,n,ke);if(l){const ke=Q(l)?l.call(n):l;Reflect.ownKeys(ke).forEach(_e=>{Cg(_e,ke[_e])})}c&&Za(c,e,"c");function Se(ke,_e){G(_e)?_e.forEach(Cn=>ke(Cn.bind(n))):_e&&ke(_e.bind(n))}if(Se(Eg,p),Se(Hl,f),Se(Bg,b),Se(Ll,v),Se(jg,$),Se(Ig,M),Se(Fg,L),Se(Rg,ee),Se(Dg,ae),Se(Ul,w),Se(Qu,j),Se(Ag,se),G(ne))if(ne.length){const ke=e.exposed||(e.exposed={});ne.forEach(_e=>{Object.defineProperty(ke,_e,{get:()=>n[_e],set:Cn=>n[_e]=Cn})})}else e.exposed||(e.exposed={});Y&&e.render===yt&&(e.render=Y),ge!=null&&(e.inheritAttrs=ge),N&&(e.components=N),ye&&(e.directives=ye)}function Ug(e,t,n=yt,o=!1){G(e)&&(e=Wi(e));for(const s in e){const r=e[s];let i;ve(r)?"default"in r?i=Ws(r.from||s,r.default,!0):i=Ws(r.from||s):i=Ws(r),ze(i)&&o?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[s]=i}}function Za(e,t,n){pt(G(e)?e.map(o=>o.bind(t.proxy)):e.bind(t.proxy),t,n)}function np(e,t,n,o){const s=o.includes(".")?Ku(n,o):()=>n[o];if(je(e)){const r=t[e];Q(r)&&Rn(s,r)}else if(Q(e))Rn(s,e.bind(n));else if(ve(e))if(G(e))e.forEach(r=>np(r,t,n,o));else{const r=Q(e.handler)?e.handler.bind(n):t[e.handler];Q(r)&&Rn(s,r,e)}}function Vl(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=e.appContext,a=r.get(t);let l;return a?l=a:!s.length&&!n&&!o?l=t:(l={},s.length&&s.forEach(d=>tr(l,d,i,!0)),tr(l,t,i)),ve(t)&&r.set(t,l),l}function tr(e,t,n,o=!1){const{mixins:s,extends:r}=t;r&&tr(e,r,n,!0),s&&s.forEach(i=>tr(e,i,n,!0));for(const i in t)if(!(o&&i==="expose")){const a=Vg[i]||n&&n[i];e[i]=a?a(e[i],t[i]):t[i]}return e}const Vg={data:Qa,props:Tn,emits:Tn,methods:Tn,computed:Tn,beforeCreate:Ke,created:Ke,beforeMount:Ke,mounted:Ke,beforeUpdate:Ke,updated:Ke,beforeDestroy:Ke,beforeUnmount:Ke,destroyed:Ke,unmounted:Ke,activated:Ke,deactivated:Ke,errorCaptured:Ke,serverPrefetch:Ke,components:Tn,directives:Tn,watch:zg,provide:Qa,inject:Wg};function Qa(e,t){return t?e?function(){return Me(Q(e)?e.call(this,this):e,Q(t)?t.call(this,this):t)}:t:e}function Wg(e,t){return Tn(Wi(e),Wi(t))}function Wi(e){if(G(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Ke(e,t){return e?[...new Set([].concat(e,t))]:t}function Tn(e,t){return e?Me(Me(Object.create(null),e),t):t}function zg(e,t){if(!e)return t;if(!t)return e;const n=Me(Object.create(null),e);for(const o in t)n[o]=Ke(e[o],t[o]);return n}function Gg(e,t,n,o=!1){const s={},r={};Js(r,jr,1),e.propsDefaults=Object.create(null),op(e,t,s,r);for(const i in e.propsOptions[0])i in s||(s[i]=void 0);n?e.props=o?s:sg(s):e.type.props?e.props=s:e.props=r,e.attrs=r}function qg(e,t,n,o){const{props:s,attrs:r,vnode:{patchFlag:i}}=e,a=le(s),[l]=e.propsOptions;let d=!1;if((o||i>0)&&!(i&16)){if(i&8){const c=e.vnode.dynamicProps;for(let p=0;p<c.length;p++){let f=c[p];if(Sr(e.emitsOptions,f))continue;const b=t[f];if(l)if(ie(r,f))b!==r[f]&&(r[f]=b,d=!0);else{const v=Rt(f);s[v]=zi(l,a,v,b,e,!1)}else b!==r[f]&&(r[f]=b,d=!0)}}}else{op(e,t,s,r)&&(d=!0);let c;for(const p in a)(!t||!ie(t,p)&&((c=Hn(p))===p||!ie(t,c)))&&(l?n&&(n[p]!==void 0||n[c]!==void 0)&&(s[p]=zi(l,a,p,void 0,e,!0)):delete s[p]);if(r!==a)for(const p in r)(!t||!ie(t,p)&&!0)&&(delete r[p],d=!0)}d&&Kt(e,"set","$attrs")}function op(e,t,n,o){const[s,r]=e.propsOptions;let i=!1,a;if(t)for(let l in t){if(Vs(l))continue;const d=t[l];let c;s&&ie(s,c=Rt(l))?!r||!r.includes(c)?n[c]=d:(a||(a={}))[c]=d:Sr(e.emitsOptions,l)||(!(l in o)||d!==o[l])&&(o[l]=d,i=!0)}if(r){const l=le(n),d=a||Ce;for(let c=0;c<r.length;c++){const p=r[c];n[p]=zi(s,l,p,d[p],e,!ie(d,p))}}return i}function zi(e,t,n,o,s,r){const i=e[n];if(i!=null){const a=ie(i,"default");if(a&&o===void 0){const l=i.default;if(i.type!==Function&&Q(l)){const{propsDefaults:d}=s;n in d?o=d[n]:(fo(s),o=d[n]=l.call(null,t),Fn())}else o=l}i[0]&&(r&&!a?o=!1:i[1]&&(o===""||o===Hn(n))&&(o=!0))}return o}function sp(e,t,n=!1){const o=t.propsCache,s=o.get(e);if(s)return s;const r=e.props,i={},a=[];let l=!1;if(!Q(e)){const c=p=>{l=!0;const[f,b]=sp(p,t,!0);Me(i,f),b&&a.push(...b)};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!r&&!l)return ve(e)&&o.set(e,no),no;if(G(r))for(let c=0;c<r.length;c++){const p=Rt(r[c]);ed(p)&&(i[p]=Ce)}else if(r)for(const c in r){const p=Rt(c);if(ed(p)){const f=r[c],b=i[p]=G(f)||Q(f)?{type:f}:Object.assign({},f);if(b){const v=od(Boolean,b.type),$=od(String,b.type);b[0]=v>-1,b[1]=$<0||v<$,(v>-1||ie(b,"default"))&&a.push(p)}}}const d=[i,a];return ve(e)&&o.set(e,d),d}function ed(e){return e[0]!=="$"}function td(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function nd(e,t){return td(e)===td(t)}function od(e,t){return G(t)?t.findIndex(n=>nd(n,e)):Q(t)&&nd(t,e)?0:-1}const rp=e=>e[0]==="_"||e==="$stable",Wl=e=>G(e)?e.map(Et):[Et(e)],Xg=(e,t,n)=>{if(t._n)return t;const o=B((...s)=>Wl(t(...s)),n);return o._c=!1,o},ip=(e,t,n)=>{const o=e._ctx;for(const s in e){if(rp(s))continue;const r=e[s];if(Q(r))t[s]=Xg(s,r,o);else if(r!=null){const i=Wl(r);t[s]=()=>i}}},lp=(e,t)=>{const n=Wl(t);e.slots.default=()=>n},Kg=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=le(t),Js(t,"_",n)):ip(t,e.slots={})}else e.slots={},t&&lp(e,t);Js(e.slots,jr,1)},Yg=(e,t,n)=>{const{vnode:o,slots:s}=e;let r=!0,i=Ce;if(o.shapeFlag&32){const a=t._;a?n&&a===1?r=!1:(Me(s,t),!n&&a===1&&delete s._):(r=!t.$stable,ip(t,s)),i=t}else t&&(lp(e,t),i={default:1});if(r)for(const a in s)!rp(a)&&!(a in i)&&delete s[a]};function ap(){return{app:null,config:{isNativeTag:_h,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Jg=0;function Zg(e,t){return function(o,s=null){Q(o)||(o=Object.assign({},o)),s!=null&&!ve(s)&&(s=null);const r=ap(),i=new Set;let a=!1;const l=r.app={_uid:Jg++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:_m,get config(){return r.config},set config(d){},use(d,...c){return i.has(d)||(d&&Q(d.install)?(i.add(d),d.install(l,...c)):Q(d)&&(i.add(d),d(l,...c))),l},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),l},component(d,c){return c?(r.components[d]=c,l):r.components[d]},directive(d,c){return c?(r.directives[d]=c,l):r.directives[d]},mount(d,c,p){if(!a){const f=C(o,s);return f.appContext=r,c&&t?t(f,d):e(f,d,p),a=!0,l._container=d,d.__vue_app__=l,Ir(f.component)||f.component.proxy}},unmount(){a&&(e(null,l._container),delete l._container.__vue_app__)},provide(d,c){return r.provides[d]=c,l}};return l}}function Gi(e,t,n,o,s=!1){if(G(e)){e.forEach((f,b)=>Gi(f,t&&(G(t)?t[b]:t),n,o,s));return}if(ao(o)&&!s)return;const r=o.shapeFlag&4?Ir(o.component)||o.component.proxy:o.el,i=s?null:r,{i:a,r:l}=e,d=t&&t.r,c=a.refs===Ce?a.refs={}:a.refs,p=a.setupState;if(d!=null&&d!==l&&(je(d)?(c[d]=null,ie(p,d)&&(p[d]=null)):ze(d)&&(d.value=null)),Q(l))gn(l,a,12,[i,c]);else{const f=je(l),b=ze(l);if(f||b){const v=()=>{if(e.f){const $=f?ie(p,l)?p[l]:c[l]:l.value;s?G($)&&jl($,r):G($)?$.includes(r)||$.push(r):f?(c[l]=[r],ie(p,l)&&(p[l]=c[l])):(l.value=[r],e.k&&(c[e.k]=l.value))}else f?(c[l]=i,ie(p,l)&&(p[l]=i)):b&&(l.value=i,e.k&&(c[e.k]=i))};i?(v.id=-1,Ne(v,n)):v()}}}const Ne=$g;function Qg(e){return em(e)}function em(e,t){const n=xh();n.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:i,createText:a,createComment:l,setText:d,setElementText:c,parentNode:p,nextSibling:f,setScopeId:b=yt,insertStaticContent:v}=e,$=(h,m,_,S=null,P=null,T=null,F=!1,I=null,D=!!m.dynamicChildren)=>{if(h===m)return;h&&!un(h,m)&&(S=xs(h),St(h,P,T,!0),h=null),m.patchFlag===-2&&(D=!1,m.dynamicChildren=null);const{type:k,ref:W,shapeFlag:H}=m;switch(k){case xr:M(h,m,_,S);break;case ft:R(h,m,_,S);break;case zs:h==null&&w(m,_,S,F);break;case V:N(h,m,_,S,P,T,F,I,D);break;default:H&1?Y(h,m,_,S,P,T,F,I,D):H&6?ye(h,m,_,S,P,T,F,I,D):(H&64||H&128)&&k.process(h,m,_,S,P,T,F,I,D,Wn)}W!=null&&P&&Gi(W,h&&h.ref,T,m||h,!m)},M=(h,m,_,S)=>{if(h==null)o(m.el=a(m.children),_,S);else{const P=m.el=h.el;m.children!==h.children&&d(P,m.children)}},R=(h,m,_,S)=>{h==null?o(m.el=l(m.children||""),_,S):m.el=h.el},w=(h,m,_,S)=>{[h.el,h.anchor]=v(h.children,m,_,S,h.el,h.anchor)},x=({el:h,anchor:m},_,S)=>{let P;for(;h&&h!==m;)P=f(h),o(h,_,S),h=P;o(m,_,S)},j=({el:h,anchor:m})=>{let _;for(;h&&h!==m;)_=f(h),s(h),h=_;s(m)},Y=(h,m,_,S,P,T,F,I,D)=>{F=F||m.type==="svg",h==null?ee(m,_,S,P,T,F,I,D):se(h,m,P,T,F,I,D)},ee=(h,m,_,S,P,T,F,I)=>{let D,k;const{type:W,props:H,shapeFlag:z,transition:Z,dirs:re}=h;if(D=h.el=i(h.type,T,H&&H.is,H),z&8?c(D,h.children):z&16&&L(h.children,D,null,S,P,T&&W!=="foreignObject",F,I),re&&Sn(h,null,S,"created"),ae(D,h,h.scopeId,F,S),H){for(const me in H)me!=="value"&&!Vs(me)&&r(D,me,null,H[me],T,h.children,S,P,Nt);"value"in H&&r(D,"value",null,H.value),(k=H.onVnodeBeforeMount)&&at(k,S,h)}re&&Sn(h,null,S,"beforeMount");const we=(!P||P&&!P.pendingBranch)&&Z&&!Z.persisted;we&&Z.beforeEnter(D),o(D,m,_),((k=H&&H.onVnodeMounted)||we||re)&&Ne(()=>{k&&at(k,S,h),we&&Z.enter(D),re&&Sn(h,null,S,"mounted")},P)},ae=(h,m,_,S,P)=>{if(_&&b(h,_),S)for(let T=0;T<S.length;T++)b(h,S[T]);if(P){let T=P.subTree;if(m===T){const F=P.vnode;ae(h,F,F.scopeId,F.slotScopeIds,P.parent)}}},L=(h,m,_,S,P,T,F,I,D=0)=>{for(let k=D;k<h.length;k++){const W=h[k]=I?cn(h[k]):Et(h[k]);$(null,W,m,_,S,P,T,F,I)}},se=(h,m,_,S,P,T,F)=>{const I=m.el=h.el;let{patchFlag:D,dynamicChildren:k,dirs:W}=m;D|=h.patchFlag&16;const H=h.props||Ce,z=m.props||Ce;let Z;_&&kn(_,!1),(Z=z.onVnodeBeforeUpdate)&&at(Z,_,m,h),W&&Sn(m,h,_,"beforeUpdate"),_&&kn(_,!0);const re=P&&m.type!=="foreignObject";if(k?ne(h.dynamicChildren,k,I,_,S,re,T):F||_e(h,m,I,null,_,S,re,T,!1),D>0){if(D&16)ge(I,m,H,z,_,S,P);else if(D&2&&H.class!==z.class&&r(I,"class",null,z.class,P),D&4&&r(I,"style",H.style,z.style,P),D&8){const we=m.dynamicProps;for(let me=0;me<we.length;me++){const Ie=we[me],gt=H[Ie],zn=z[Ie];(zn!==gt||Ie==="value")&&r(I,Ie,gt,zn,P,h.children,_,S,Nt)}}D&1&&h.children!==m.children&&c(I,m.children)}else!F&&k==null&&ge(I,m,H,z,_,S,P);((Z=z.onVnodeUpdated)||W)&&Ne(()=>{Z&&at(Z,_,m,h),W&&Sn(m,h,_,"updated")},S)},ne=(h,m,_,S,P,T,F)=>{for(let I=0;I<m.length;I++){const D=h[I],k=m[I],W=D.el&&(D.type===V||!un(D,k)||D.shapeFlag&70)?p(D.el):_;$(D,k,W,null,S,P,T,F,!0)}},ge=(h,m,_,S,P,T,F)=>{if(_!==S){if(_!==Ce)for(const I in _)!Vs(I)&&!(I in S)&&r(h,I,_[I],null,F,m.children,P,T,Nt);for(const I in S){if(Vs(I))continue;const D=S[I],k=_[I];D!==k&&I!=="value"&&r(h,I,k,D,F,m.children,P,T,Nt)}"value"in S&&r(h,"value",_.value,S.value)}},N=(h,m,_,S,P,T,F,I,D)=>{const k=m.el=h?h.el:a(""),W=m.anchor=h?h.anchor:a("");let{patchFlag:H,dynamicChildren:z,slotScopeIds:Z}=m;Z&&(I=I?I.concat(Z):Z),h==null?(o(k,_,S),o(W,_,S),L(m.children,_,W,P,T,F,I,D)):H>0&&H&64&&z&&h.dynamicChildren?(ne(h.dynamicChildren,z,_,P,T,F,I),(m.key!=null||P&&m===P.subTree)&&zl(h,m,!0)):_e(h,m,_,W,P,T,F,I,D)},ye=(h,m,_,S,P,T,F,I,D)=>{m.slotScopeIds=I,h==null?m.shapeFlag&512?P.ctx.activate(m,_,S,F,D):Ve(m,_,S,P,T,F,D):Pt(h,m,D)},Ve=(h,m,_,S,P,T,F)=>{const I=h.component=pm(h,S,P);if(gs(h)&&(I.ctx.renderer=Wn),fm(I),I.asyncDep){if(P&&P.registerDep(I,Se),!h.el){const D=I.subTree=C(ft);R(null,D,m,_)}return}Se(I,h,m,_,P,T,F)},Pt=(h,m,_)=>{const S=m.component=h.component;if(_g(h,m,_))if(S.asyncDep&&!S.asyncResolved){ke(S,m,_);return}else S.next=m,hg(S.update),S.update();else m.el=h.el,S.vnode=m},Se=(h,m,_,S,P,T,F)=>{const I=()=>{if(h.isMounted){let{next:W,bu:H,u:z,parent:Z,vnode:re}=h,we=W,me;kn(h,!1),W?(W.el=re.el,ke(h,W,F)):W=re,H&&so(H),(me=W.props&&W.props.onVnodeBeforeUpdate)&&at(me,Z,W,re),kn(h,!0);const Ie=ei(h),gt=h.subTree;h.subTree=Ie,$(gt,Ie,p(gt.el),xs(gt),h,P,T),W.el=Ie.el,we===null&&wg(h,Ie.el),z&&Ne(z,P),(me=W.props&&W.props.onVnodeUpdated)&&Ne(()=>at(me,Z,W,re),P)}else{let W;const{el:H,props:z}=m,{bm:Z,m:re,parent:we}=h,me=ao(m);if(kn(h,!1),Z&&so(Z),!me&&(W=z&&z.onVnodeBeforeMount)&&at(W,we,m),kn(h,!0),H&&Jr){const Ie=()=>{h.subTree=ei(h),Jr(H,h.subTree,h,P,null)};me?m.type.__asyncLoader().then(()=>!h.isUnmounted&&Ie()):Ie()}else{const Ie=h.subTree=ei(h);$(null,Ie,_,S,h,P,T),m.el=Ie.el}if(re&&Ne(re,P),!me&&(W=z&&z.onVnodeMounted)){const Ie=m;Ne(()=>at(W,we,Ie),P)}(m.shapeFlag&256||we&&ao(we.vnode)&&we.vnode.shapeFlag&256)&&h.a&&Ne(h.a,P),h.isMounted=!0,m=_=S=null}},D=h.effect=new El(I,()=>Pr(k),h.scope),k=h.update=()=>D.run();k.id=h.uid,kn(h,!0),k()},ke=(h,m,_)=>{m.component=h;const S=h.vnode.props;h.vnode=m,h.next=null,qg(h,m.props,S,_),Yg(h,m.children,_),So(),qa(),ko()},_e=(h,m,_,S,P,T,F,I,D=!1)=>{const k=h&&h.children,W=h?h.shapeFlag:0,H=m.children,{patchFlag:z,shapeFlag:Z}=m;if(z>0){if(z&128){Os(k,H,_,S,P,T,F,I,D);return}else if(z&256){Cn(k,H,_,S,P,T,F,I,D);return}}Z&8?(W&16&&Nt(k,P,T),H!==k&&c(_,H)):W&16?Z&16?Os(k,H,_,S,P,T,F,I,D):Nt(k,P,T,!0):(W&8&&c(_,""),Z&16&&L(H,_,S,P,T,F,I,D))},Cn=(h,m,_,S,P,T,F,I,D)=>{h=h||no,m=m||no;const k=h.length,W=m.length,H=Math.min(k,W);let z;for(z=0;z<H;z++){const Z=m[z]=D?cn(m[z]):Et(m[z]);$(h[z],Z,_,null,P,T,F,I,D)}k>W?Nt(h,P,T,!0,!1,H):L(m,_,S,P,T,F,I,D,H)},Os=(h,m,_,S,P,T,F,I,D)=>{let k=0;const W=m.length;let H=h.length-1,z=W-1;for(;k<=H&&k<=z;){const Z=h[k],re=m[k]=D?cn(m[k]):Et(m[k]);if(un(Z,re))$(Z,re,_,null,P,T,F,I,D);else break;k++}for(;k<=H&&k<=z;){const Z=h[H],re=m[z]=D?cn(m[z]):Et(m[z]);if(un(Z,re))$(Z,re,_,null,P,T,F,I,D);else break;H--,z--}if(k>H){if(k<=z){const Z=z+1,re=Z<W?m[Z].el:S;for(;k<=z;)$(null,m[k]=D?cn(m[k]):Et(m[k]),_,re,P,T,F,I,D),k++}}else if(k>z)for(;k<=H;)St(h[k],P,T,!0),k++;else{const Z=k,re=k,we=new Map;for(k=re;k<=z;k++){const et=m[k]=D?cn(m[k]):Et(m[k]);et.key!=null&&we.set(et.key,k)}let me,Ie=0;const gt=z-re+1;let zn=!1,Da=0;const Ro=new Array(gt);for(k=0;k<gt;k++)Ro[k]=0;for(k=Z;k<=H;k++){const et=h[k];if(Ie>=gt){St(et,P,T,!0);continue}let kt;if(et.key!=null)kt=we.get(et.key);else for(me=re;me<=z;me++)if(Ro[me-re]===0&&un(et,m[me])){kt=me;break}kt===void 0?St(et,P,T,!0):(Ro[kt-re]=k+1,kt>=Da?Da=kt:zn=!0,$(et,m[kt],_,null,P,T,F,I,D),Ie++)}const Ra=zn?tm(Ro):no;for(me=Ra.length-1,k=gt-1;k>=0;k--){const et=re+k,kt=m[et],Fa=et+1<W?m[et+1].el:S;Ro[k]===0?$(null,kt,_,Fa,P,T,F,I,D):zn&&(me<0||k!==Ra[me]?Pn(kt,_,Fa,2):me--)}}},Pn=(h,m,_,S,P=null)=>{const{el:T,type:F,transition:I,children:D,shapeFlag:k}=h;if(k&6){Pn(h.component.subTree,m,_,S);return}if(k&128){h.suspense.move(m,_,S);return}if(k&64){F.move(h,m,_,Wn);return}if(F===V){o(T,m,_);for(let H=0;H<D.length;H++)Pn(D[H],m,_,S);o(h.anchor,m,_);return}if(F===zs){x(h,m,_);return}if(S!==2&&k&1&&I)if(S===0)I.beforeEnter(T),o(T,m,_),Ne(()=>I.enter(T),P);else{const{leave:H,delayLeave:z,afterLeave:Z}=I,re=()=>o(T,m,_),we=()=>{H(T,()=>{re(),Z&&Z()})};z?z(T,re,we):we()}else o(T,m,_)},St=(h,m,_,S=!1,P=!1)=>{const{type:T,props:F,ref:I,children:D,dynamicChildren:k,shapeFlag:W,patchFlag:H,dirs:z}=h;if(I!=null&&Gi(I,null,_,h,!0),W&256){m.ctx.deactivate(h);return}const Z=W&1&&z,re=!ao(h);let we;if(re&&(we=F&&F.onVnodeBeforeUnmount)&&at(we,m,h),W&6)ph(h.component,_,S);else{if(W&128){h.suspense.unmount(_,S);return}Z&&Sn(h,null,m,"beforeUnmount"),W&64?h.type.remove(h,m,_,P,Wn,S):k&&(T!==V||H>0&&H&64)?Nt(k,m,_,!1,!0):(T===V&&H&384||!P&&W&16)&&Nt(D,m,_),S&&Ba(h)}(re&&(we=F&&F.onVnodeUnmounted)||Z)&&Ne(()=>{we&&at(we,m,h),Z&&Sn(h,null,m,"unmounted")},_)},Ba=h=>{const{type:m,el:_,anchor:S,transition:P}=h;if(m===V){uh(_,S);return}if(m===zs){j(h);return}const T=()=>{s(_),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(h.shapeFlag&1&&P&&!P.persisted){const{leave:F,delayLeave:I}=P,D=()=>F(_,T);I?I(h.el,T,D):D()}else T()},uh=(h,m)=>{let _;for(;h!==m;)_=f(h),s(h),h=_;s(m)},ph=(h,m,_)=>{const{bum:S,scope:P,update:T,subTree:F,um:I}=h;S&&so(S),P.stop(),T&&(T.active=!1,St(F,h,m,_)),I&&Ne(I,m),Ne(()=>{h.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&h.asyncDep&&!h.asyncResolved&&h.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Nt=(h,m,_,S=!1,P=!1,T=0)=>{for(let F=T;F<h.length;F++)St(h[F],m,_,S,P)},xs=h=>h.shapeFlag&6?xs(h.component.subTree):h.shapeFlag&128?h.suspense.next():f(h.anchor||h.el),Aa=(h,m,_)=>{h==null?m._vnode&&St(m._vnode,null,null,!0):$(m._vnode||null,h,m,null,null,null,_),qa(),Wu(),m._vnode=h},Wn={p:$,um:St,m:Pn,r:Ba,mt:Ve,mc:L,pc:_e,pbc:ne,n:xs,o:e};let Yr,Jr;return t&&([Yr,Jr]=t(Wn)),{render:Aa,hydrate:Yr,createApp:Zg(Aa,Yr)}}function kn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function zl(e,t,n=!1){const o=e.children,s=t.children;if(G(o)&&G(s))for(let r=0;r<o.length;r++){const i=o[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=cn(s[r]),a.el=i.el),n||zl(i,a)),a.type===xr&&(a.el=i.el)}}function tm(e){const t=e.slice(),n=[0];let o,s,r,i,a;const l=e.length;for(o=0;o<l;o++){const d=e[o];if(d!==0){if(s=n[n.length-1],e[s]<d){t[o]=s,n.push(o);continue}for(r=0,i=n.length-1;r<i;)a=r+i>>1,e[n[a]]<d?r=a+1:i=a;d<e[n[r]]&&(r>0&&(t[o]=n[r-1]),n[r]=o)}}for(r=n.length,i=n[r-1];r-- >0;)n[r]=i,i=t[i];return n}const nm=e=>e.__isTeleport,Yo=e=>e&&(e.disabled||e.disabled===""),sd=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,qi=(e,t)=>{const n=e&&e.to;return je(n)?t?t(n):null:n},om={__isTeleport:!0,process(e,t,n,o,s,r,i,a,l,d){const{mc:c,pc:p,pbc:f,o:{insert:b,querySelector:v,createText:$,createComment:M}}=d,R=Yo(t.props);let{shapeFlag:w,children:x,dynamicChildren:j}=t;if(e==null){const Y=t.el=$(""),ee=t.anchor=$("");b(Y,n,o),b(ee,n,o);const ae=t.target=qi(t.props,v),L=t.targetAnchor=$("");ae&&(b(L,ae),i=i||sd(ae));const se=(ne,ge)=>{w&16&&c(x,ne,ge,s,r,i,a,l)};R?se(n,ee):ae&&se(ae,L)}else{t.el=e.el;const Y=t.anchor=e.anchor,ee=t.target=e.target,ae=t.targetAnchor=e.targetAnchor,L=Yo(e.props),se=L?n:ee,ne=L?Y:ae;if(i=i||sd(ee),j?(f(e.dynamicChildren,j,se,s,r,i,a),zl(e,t,!0)):l||p(e,t,se,ne,s,r,i,a,!1),R)L||Ds(t,n,Y,d,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ge=t.target=qi(t.props,v);ge&&Ds(t,ge,null,d,0)}else L&&Ds(t,ee,ae,d,1)}cp(t)},remove(e,t,n,o,{um:s,o:{remove:r}},i){const{shapeFlag:a,children:l,anchor:d,targetAnchor:c,target:p,props:f}=e;if(p&&r(c),(i||!Yo(f))&&(r(d),a&16))for(let b=0;b<l.length;b++){const v=l[b];s(v,t,n,!0,!!v.dynamicChildren)}},move:Ds,hydrate:sm};function Ds(e,t,n,{o:{insert:o},m:s},r=2){r===0&&o(e.targetAnchor,t,n);const{el:i,anchor:a,shapeFlag:l,children:d,props:c}=e,p=r===2;if(p&&o(i,t,n),(!p||Yo(c))&&l&16)for(let f=0;f<d.length;f++)s(d[f],t,n,2);p&&o(a,t,n)}function sm(e,t,n,o,s,r,{o:{nextSibling:i,parentNode:a,querySelector:l}},d){const c=t.target=qi(t.props,l);if(c){const p=c._lpa||c.firstChild;if(t.shapeFlag&16)if(Yo(t.props))t.anchor=d(i(e),t,a(e),n,o,s,r),t.targetAnchor=p;else{t.anchor=i(e);let f=p;for(;f;)if(f=i(f),f&&f.nodeType===8&&f.data==="teleport anchor"){t.targetAnchor=f,c._lpa=t.targetAnchor&&i(t.targetAnchor);break}d(p,t,c,n,o,s,r)}cp(t)}return t.anchor&&i(t.anchor)}const dp=om;function cp(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;for(;n!==e.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}const V=Symbol(void 0),xr=Symbol(void 0),ft=Symbol(void 0),zs=Symbol(void 0),Jo=[];let vt=null;function g(e=!1){Jo.push(vt=e?null:[])}function rm(){Jo.pop(),vt=Jo[Jo.length-1]||null}let ls=1;function rd(e){ls+=e}function up(e){return e.dynamicChildren=ls>0?vt||no:null,rm(),ls>0&&vt&&vt.push(e),e}function y(e,t,n,o,s,r){return up(u(e,t,n,o,s,r,!0))}function U(e,t,n,o,s){return up(C(e,t,n,o,s,!0))}function as(e){return e?e.__v_isVNode===!0:!1}function un(e,t){return e.type===t.type&&e.key===t.key}const jr="__vInternal",pp=({key:e})=>e!=null?e:null,Gs=({ref:e,ref_key:t,ref_for:n})=>e!=null?je(e)||ze(e)||Q(e)?{i:Le,r:e,k:t,f:!!n}:e:null;function u(e,t=null,n=null,o=0,s=null,r=e===V?0:1,i=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&pp(t),ref:t&&Gs(t),scopeId:kr,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Le};return a?(Gl(l,n),r&128&&e.normalize(l)):n&&(l.shapeFlag|=je(n)?8:16),ls>0&&!i&&vt&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&vt.push(l),l}const C=im;function im(e,t=null,n=null,o=0,s=null,r=!1){if((!e||e===Mg)&&(e=ft),as(e)){const a=Yt(e,t,!0);return n&&Gl(a,n),ls>0&&!r&&vt&&(a.shapeFlag&6?vt[vt.indexOf(e)]=a:vt.push(a)),a.patchFlag|=-2,a}if(bm(e)&&(e=e.__vccOpts),t){t=lm(t);let{class:a,style:l}=t;a&&!je(a)&&(t.class=fe(a)),ve(l)&&(Fu(l)&&!G(l)&&(l=Me({},l)),t.style=Be(l))}const i=je(e)?1:qu(e)?128:nm(e)?64:ve(e)?4:Q(e)?2:0;return u(e,t,n,o,s,i,r,!0)}function lm(e){return e?Fu(e)||jr in e?Me({},e):e:null}function Yt(e,t,n=!1){const{props:o,ref:s,patchFlag:r,children:i}=e,a=t?dm(o||{},t):o;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&pp(a),ref:t&&t.ref?n&&s?G(s)?s.concat(Gs(t)):[s,Gs(t)]:Gs(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==V?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Yt(e.ssContent),ssFallback:e.ssFallback&&Yt(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function O(e=" ",t=0){return C(xr,null,e,t)}function am(e,t){const n=C(zs,null,e);return n.staticCount=t,n}function K(e="",t=!1){return t?(g(),U(ft,null,e)):C(ft,null,e)}function Et(e){return e==null||typeof e=="boolean"?C(ft):G(e)?C(V,null,e.slice()):typeof e=="object"?cn(e):C(xr,null,String(e))}function cn(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Yt(e)}function Gl(e,t){let n=0;const{shapeFlag:o}=e;if(t==null)t=null;else if(G(t))n=16;else if(typeof t=="object")if(o&65){const s=t.default;s&&(s._c&&(s._d=!1),Gl(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!(jr in t)?t._ctx=Le:s===3&&Le&&(Le.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Q(t)?(t={default:t,_ctx:Le},n=32):(t=String(t),o&64?(n=16,t=[O(t)]):n=8);e.children=t,e.shapeFlag|=n}function dm(...e){const t={};for(let n=0;n<e.length;n++){const o=e[n];for(const s in o)if(s==="class")t.class!==o.class&&(t.class=fe([t.class,o.class]));else if(s==="style")t.style=Be([t.style,o.style]);else if(yr(s)){const r=t[s],i=o[s];i&&r!==i&&!(G(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=o[s])}return t}function at(e,t,n,o=null){pt(e,t,7,[n,o])}const cm=ap();let um=0;function pm(e,t,n){const o=e.type,s=(t?t.appContext:e.appContext)||cm,r={uid:um++,vnode:e,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Su(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sp(o,s),emitsOptions:Gu(o,s),emit:null,emitted:null,propsDefaults:Ce,inheritAttrs:o.inheritAttrs,ctx:Ce,data:Ce,props:Ce,attrs:Ce,slots:Ce,refs:Ce,setupState:Ce,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=bg.bind(null,r),e.ce&&e.ce(r),r}let xe=null;const ql=()=>xe||Le,fo=e=>{xe=e,e.scope.on()},Fn=()=>{xe&&xe.scope.off(),xe=null};function fp(e){return e.vnode.shapeFlag&4}let ho=!1;function fm(e,t=!1){ho=t;const{props:n,children:o}=e.vnode,s=fp(e);Gg(e,n,s,t),Kg(e,o);const r=s?hm(e,t):void 0;return ho=!1,r}function hm(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Cr(new Proxy(e.ctx,Hg));const{setup:o}=n;if(o){const s=e.setupContext=o.length>1?mm(e):null;fo(e),So();const r=gn(o,e,0,[e.props,s]);if(ko(),Fn(),$u(r)){if(r.then(Fn,Fn),t)return r.then(i=>{id(e,i,t)}).catch(i=>{hs(i,e,0)});e.asyncDep=r}else id(e,r,t)}else hp(e,t)}function id(e,t,n){Q(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ve(t)&&(e.setupState=Hu(t)),hp(e,n)}let ld;function hp(e,t,n){const o=e.type;if(!e.render){if(!t&&ld&&!o.render){const s=o.template||Vl(e).template;if(s){const{isCustomElement:r,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:l}=o,d=Me(Me({isCustomElement:r,delimiters:a},i),l);o.render=ld(s,d)}}e.render=o.render||yt}fo(e),So(),Lg(e),ko(),Fn()}function gm(e){return new Proxy(e.attrs,{get(t,n){return Ze(e,"get","$attrs"),t[n]}})}function mm(e){const t=o=>{e.exposed=o||{}};let n;return{get attrs(){return n||(n=gm(e))},slots:e.slots,emit:e.emit,expose:t}}function Ir(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Hu(Cr(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ko)return Ko[n](e)},has(t,n){return n in t||n in Ko}}))}function Xi(e,t=!0){return Q(e)?e.displayName||e.name:e.name||t&&e.__name}function bm(e){return Q(e)&&"__vccOpts"in e}const nr=(e,t)=>cg(e,t,ho);function ad(e,t,n){const o=arguments.length;return o===2?ve(t)&&!G(t)?as(t)?C(e,null,[t]):C(e,t):C(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&as(n)&&(n=[n]),C(e,t,n))}const vm=Symbol(""),ym=()=>Ws(vm),_m="3.2.47",wm="http://www.w3.org/2000/svg",Bn=typeof document!="undefined"?document:null,dd=Bn&&Bn.createElement("template"),$m={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const s=t?Bn.createElementNS(wm,e):Bn.createElement(e,n?{is:n}:void 0);return e==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:e=>Bn.createTextNode(e),createComment:e=>Bn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Bn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,s,r){const i=n?n.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{dd.innerHTML=o?`<svg>${e}</svg>`:e;const a=dd.content;if(o){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,n)}return[i?i.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Cm(e,t,n){const o=e._vtc;o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function Pm(e,t,n){const o=e.style,s=je(n);if(n&&!s){if(t&&!je(t))for(const r in t)n[r]==null&&Ki(o,r,"");for(const r in n)Ki(o,r,n[r])}else{const r=o.display;s?t!==n&&(o.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(o.display=r)}}const cd=/\s*!important$/;function Ki(e,t,n){if(G(n))n.forEach(o=>Ki(e,t,o));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=Sm(e,t);cd.test(n)?e.setProperty(Hn(o),n.replace(cd,""),"important"):e[o]=n}}const ud=["Webkit","Moz","ms"],ii={};function Sm(e,t){const n=ii[t];if(n)return n;let o=Rt(t);if(o!=="filter"&&o in e)return ii[t]=o;o=wr(o);for(let s=0;s<ud.length;s++){const r=ud[s]+o;if(r in e)return ii[t]=r}return t}const pd="http://www.w3.org/1999/xlink";function km(e,t,n,o,s){if(o&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(pd,t.slice(6,t.length)):e.setAttributeNS(pd,t,n);else{const r=vh(t);n==null||r&&!_u(n)?e.removeAttribute(t):e.setAttribute(t,r?"":n)}}function Om(e,t,n,o,s,r,i){if(t==="innerHTML"||t==="textContent"){o&&i(o,s,r),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const l=n==null?"":n;(e.value!==l||e.tagName==="OPTION")&&(e.value=l),n==null&&e.removeAttribute(t);return}let a=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=_u(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{e[t]=n}catch(l){}a&&e.removeAttribute(t)}function pn(e,t,n,o){e.addEventListener(t,n,o)}function xm(e,t,n,o){e.removeEventListener(t,n,o)}function jm(e,t,n,o,s=null){const r=e._vei||(e._vei={}),i=r[t];if(o&&i)i.value=o;else{const[a,l]=Im(t);if(o){const d=r[t]=Bm(o,s);pn(e,a,d,l)}else i&&(xm(e,a,i,l),r[t]=void 0)}}const fd=/(?:Once|Passive|Capture)$/;function Im(e){let t;if(fd.test(e)){t={};let o;for(;o=e.match(fd);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Hn(e.slice(2)),t]}let li=0;const Tm=Promise.resolve(),Em=()=>li||(Tm.then(()=>li=0),li=Date.now());function Bm(e,t){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;pt(Am(o,n.value),t,5,[o])};return n.value=e,n.attached=Em(),n}function Am(e,t){if(G(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}const hd=/^on[a-z]/,Dm=(e,t,n,o,s=!1,r,i,a,l)=>{t==="class"?Cm(e,o,s):t==="style"?Pm(e,n,o):yr(t)?xl(t)||jm(e,t,n,o,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Rm(e,t,o,s))?Om(e,t,o,r,i,a,l):(t==="true-value"?e._trueValue=o:t==="false-value"&&(e._falseValue=o),km(e,t,o,s))};function Rm(e,t,n,o){return o?!!(t==="innerHTML"||t==="textContent"||t in e&&hd.test(t)&&Q(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||hd.test(t)&&je(n)?!1:t in e}const tn="transition",Fo="animation",gp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Fm=Me({},kg.props,gp),On=(e,t=[])=>{G(e)?e.forEach(n=>n(...t)):e&&e(...t)},gd=e=>e?G(e)?e.some(t=>t.length>1):e.length>1:!1;function Mm(e){const t={};for(const N in e)N in gp||(t[N]=e[N]);if(e.css===!1)return t;const{name:n="v",type:o,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:i=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=r,appearActiveClass:d=i,appearToClass:c=a,leaveFromClass:p=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:b=`${n}-leave-to`}=e,v=Nm(s),$=v&&v[0],M=v&&v[1],{onBeforeEnter:R,onEnter:w,onEnterCancelled:x,onLeave:j,onLeaveCancelled:Y,onBeforeAppear:ee=R,onAppear:ae=w,onAppearCancelled:L=x}=t,se=(N,ye,Ve)=>{dn(N,ye?c:a),dn(N,ye?d:i),Ve&&Ve()},ne=(N,ye)=>{N._isLeaving=!1,dn(N,p),dn(N,b),dn(N,f),ye&&ye()},ge=N=>(ye,Ve)=>{const Pt=N?ae:w,Se=()=>se(ye,N,Ve);On(Pt,[ye,Se]),md(()=>{dn(ye,N?l:r),Ut(ye,N?c:a),gd(Pt)||bd(ye,o,$,Se)})};return Me(t,{onBeforeEnter(N){On(R,[N]),Ut(N,r),Ut(N,i)},onBeforeAppear(N){On(ee,[N]),Ut(N,l),Ut(N,d)},onEnter:ge(!1),onAppear:ge(!0),onLeave(N,ye){N._isLeaving=!0;const Ve=()=>ne(N,ye);Ut(N,p),bp(),Ut(N,f),md(()=>{!N._isLeaving||(dn(N,p),Ut(N,b),gd(j)||bd(N,o,M,Ve))}),On(j,[N,Ve])},onEnterCancelled(N){se(N,!1),On(x,[N])},onAppearCancelled(N){se(N,!0),On(L,[N])},onLeaveCancelled(N){ne(N),On(Y,[N])}})}function Nm(e){if(e==null)return null;if(ve(e))return[ai(e.enter),ai(e.leave)];{const t=ai(e);return[t,t]}}function ai(e){return Oh(e)}function Ut(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function dn(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.remove(o));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function md(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Hm=0;function bd(e,t,n,o){const s=e._endId=++Hm,r=()=>{s===e._endId&&o()};if(n)return setTimeout(r,n);const{type:i,timeout:a,propCount:l}=mp(e,t);if(!i)return o();const d=i+"end";let c=0;const p=()=>{e.removeEventListener(d,f),r()},f=b=>{b.target===e&&++c>=l&&p()};setTimeout(()=>{c<l&&p()},a+1),e.addEventListener(d,f)}function mp(e,t){const n=window.getComputedStyle(e),o=v=>(n[v]||"").split(", "),s=o(`${tn}Delay`),r=o(`${tn}Duration`),i=vd(s,r),a=o(`${Fo}Delay`),l=o(`${Fo}Duration`),d=vd(a,l);let c=null,p=0,f=0;t===tn?i>0&&(c=tn,p=i,f=r.length):t===Fo?d>0&&(c=Fo,p=d,f=l.length):(p=Math.max(i,d),c=p>0?i>d?tn:Fo:null,f=c?c===tn?r.length:l.length:0);const b=c===tn&&/\b(transform|all)(,|$)/.test(o(`${tn}Property`).toString());return{type:c,timeout:p,propCount:f,hasTransform:b}}function vd(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,o)=>yd(n)+yd(e[o])))}function yd(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function bp(){return document.body.offsetHeight}const vp=new WeakMap,yp=new WeakMap,_p={name:"TransitionGroup",props:Me({},Fm,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=ql(),o=Yu();let s,r;return Ll(()=>{if(!s.length)return;const i=e.moveClass||`${e.name||"v"}-move`;if(!zm(s[0].el,n.vnode.el,i))return;s.forEach(Um),s.forEach(Vm);const a=s.filter(Wm);bp(),a.forEach(l=>{const d=l.el,c=d.style;Ut(d,i),c.transform=c.webkitTransform=c.transitionDuration="";const p=d._moveCb=f=>{f&&f.target!==d||(!f||/transform$/.test(f.propertyName))&&(d.removeEventListener("transitionend",p),d._moveCb=null,dn(d,i))};d.addEventListener("transitionend",p)})}),()=>{const i=le(e),a=Mm(i);let l=i.tag||V;s=r,r=t.default?Nl(t.default()):[];for(let d=0;d<r.length;d++){const c=r[d];c.key!=null&&po(c,is(c,a,o,n))}if(s)for(let d=0;d<s.length;d++){const c=s[d];po(c,is(c,a,o,n)),vp.set(c,c.el.getBoundingClientRect())}return C(l,null,r)}}},Lm=e=>delete e.mode;_p.props;const UT=_p;function Um(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Vm(e){yp.set(e,e.el.getBoundingClientRect())}function Wm(e){const t=vp.get(e),n=yp.get(e),o=t.left-n.left,s=t.top-n.top;if(o||s){const r=e.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",e}}function zm(e,t,n){const o=e.cloneNode();e._vtc&&e._vtc.forEach(i=>{i.split(/\s+/).forEach(a=>a&&o.classList.remove(a))}),n.split(/\s+/).forEach(i=>i&&o.classList.add(i)),o.style.display="none";const s=t.nodeType===1?t:t.parentNode;s.appendChild(o);const{hasTransform:r}=mp(o);return s.removeChild(o),r}const go=e=>{const t=e.props["onUpdate:modelValue"]||!1;return G(t)?n=>so(t,n):t};function Gm(e){e.target.composing=!0}function _d(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ae={created(e,{modifiers:{lazy:t,trim:n,number:o}},s){e._assign=go(s);const r=o||s.props&&s.props.type==="number";pn(e,t?"change":"input",i=>{if(i.target.composing)return;let a=e.value;n&&(a=a.trim()),r&&(a=Zs(a)),e._assign(a)}),n&&pn(e,"change",()=>{e.value=e.value.trim()}),t||(pn(e,"compositionstart",Gm),pn(e,"compositionend",_d),pn(e,"change",_d))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:o,number:s}},r){if(e._assign=go(r),e.composing||document.activeElement===e&&e.type!=="range"&&(n||o&&e.value.trim()===t||(s||e.type==="number")&&Zs(e.value)===t))return;const i=t==null?"":t;e.value!==i&&(e.value=i)}},qm={deep:!0,created(e,t,n){e._assign=go(n),pn(e,"change",()=>{const o=e._modelValue,s=ds(e),r=e.checked,i=e._assign;if(G(o)){const a=Ol(o,s),l=a!==-1;if(r&&!l)i(o.concat(s));else if(!r&&l){const d=[...o];d.splice(a,1),i(d)}}else if(Co(o)){const a=new Set(o);r?a.add(s):a.delete(s),i(a)}else i(wp(e,r))})},mounted:wd,beforeUpdate(e,t,n){e._assign=go(n),wd(e,t,n)}};function wd(e,{value:t,oldValue:n},o){e._modelValue=t,G(t)?e.checked=Ol(t,o.props.value)>-1:Co(t)?e.checked=t.has(o.props.value):t!==n&&(e.checked=fs(t,wp(e,!0)))}const wt={deep:!0,created(e,{value:t,modifiers:{number:n}},o){const s=Co(t);pn(e,"change",()=>{const r=Array.prototype.filter.call(e.options,i=>i.selected).map(i=>n?Zs(ds(i)):ds(i));e._assign(e.multiple?s?new Set(r):r:r[0])}),e._assign=go(o)},mounted(e,{value:t}){$d(e,t)},beforeUpdate(e,t,n){e._assign=go(n)},updated(e,{value:t}){$d(e,t)}};function $d(e,t){const n=e.multiple;if(!(n&&!G(t)&&!Co(t))){for(let o=0,s=e.options.length;o<s;o++){const r=e.options[o],i=ds(r);if(n)G(t)?r.selected=Ol(t,i)>-1:r.selected=t.has(i);else if(fs(ds(r),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function ds(e){return"_value"in e?e._value:e.value}function wp(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Xm=["ctrl","shift","alt","meta"],Km={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Xm.some(n=>e[`${n}Key`]&&!t.includes(n))},q=(e,t)=>(n,...o)=>{for(let s=0;s<t.length;s++){const r=Km[t[s]];if(r&&r(n,t))return}return e(n,...o)},Ym={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ue=(e,t)=>n=>{if(!("key"in n))return;const o=Hn(n.key);if(t.some(s=>s===o||Ym[s]===o))return e(n)},Jm=Me({patchProp:Dm},$m);let Cd;function Zm(){return Cd||(Cd=Qg(Jm))}const Qm=(...e)=>{const t=Zm().createApp(...e),{mount:n}=t;return t.mount=o=>{const s=eb(o);if(!s)return;const r=t._component;!Q(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";const i=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function eb(e){return je(e)?document.querySelector(e):e}const tb="modulepreload",nb=function(e,t){return new URL(e,t).href},Pd={},Sd=function(t,n,o){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=nb(r,o),r in Pd)return;Pd[r]=!0;const i=r.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(!!o)for(let c=s.length-1;c>=0;c--){const p=s[c];if(p.href===r&&(!i||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":tb,i||(d.as="script",d.crossOrigin=""),d.href=r,document.head.appendChild(d),i)return new Promise((c,p)=>{d.addEventListener("load",c),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())};function ob(e){return{all:e=e||new Map,on:function(t,n){var o=e.get(t);o?o.push(n):e.set(t,[n])},off:function(t,n){var o=e.get(t);o&&(n?o.splice(o.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var o=e.get(t);o&&o.slice().map(function(s){s(n)}),(o=e.get("*"))&&o.slice().map(function(s){s(t,n)})}}}var sb=Object.defineProperty,rb=(e,t,n)=>t in e?sb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Re=(e,t,n)=>(rb(e,typeof t!="symbol"?t+"":t,n),n);const di=ob(),pe={fire(e){di.emit(e.kind,e)},subscribe(e,t){di.on(e.kind,t)},unsubscribe(e,t){di.off(e.kind,t)}};class or{constructor(t){this.path=t,Re(this,"kind","AssetFailureEvent")}}Re(or,"kind","AssetFailureEvent");class Xl{constructor(t){this.message=t,Re(this,"kind","FailureEvent")}}Re(Xl,"kind","FailureEvent");class $p{constructor(t){this.error=t,Re(this,"kind","CustomAssetFailureEvent")}}Re($p,"kind","CustomAssetFailureEvent");class Tr{constructor(){Re(this,"kind","InvalidateRenderEvent")}}Re(Tr,"kind","InvalidateRenderEvent");const Cp=class{constructor(){Re(this,"kind",Cp.kind)}};let Kl=Cp;Re(Kl,"kind","RenderUpdatedEvent");const Pp=class{constructor(){Re(this,"kind",Pp.kind)}};let Yl=Pp;Re(Yl,"kind","StateLoadingEvent");class ot{constructor(t){this.message=t,Re(this,"kind","ShowMessageEvent")}}Re(ot,"kind","ShowMessageEvent");class Jl{constructor(t,n){this.message=t,this.actions=n,Re(this,"kind","ResolvableErrorEvent")}}Re(Jl,"kind","ResolvableErrorEvent");class sr{constructor(t){this.color=t,Re(this,"kind","ColorPickedEvent")}}Re(sr,"kind","ColorPickedEvent");class Sp{constructor(t,n){this.error=t,this.info=n,Re(this,"kind","VueErrorEvent")}}Re(Sp,"kind","VueErrorEvent");const kp=""+new URL("missing_image.81acc086.svg",import.meta.url).href;var ib=Object.defineProperty,kd=Object.getOwnPropertySymbols,lb=Object.prototype.hasOwnProperty,ab=Object.prototype.propertyIsEnumerable,Yi=(e,t,n)=>t in e?ib(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Od=(e,t)=>{for(var n in t||(t={}))lb.call(t,n)&&Yi(e,n,t[n]);if(kd)for(var n of kd(t))ab.call(t,n)&&Yi(e,n,t[n]);return e},xd=(e,t,n)=>(Yi(e,typeof t!="symbol"?t+"":t,n),n);class Zl{constructor(t){this.html=t,xd(this,"width"),xd(this,"height"),this.width=t.width,this.height=t.height}paintOnto(t,n={}){const{w:o,h:s}=Od({w:this.width,h:this.height},n),{x:r,y:i}=Od({x:-o/2,y:-s/2},n);t.drawImage(this.html,r,i,o,s)}}var db=Object.defineProperty,cb=(e,t,n)=>t in e?db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jd=(e,t,n)=>(cb(e,typeof t!="symbol"?t+"":t,n),n);let Ji=null;setTimeout(()=>Ql(kp).then(e=>{e instanceof Zl&&(Ji=e)}),0);class rr{constructor(){jd(this,"width",300),jd(this,"height",300)}paintOnto(t,n={}){Ji&&Ji.paintOnto(t,n)}}var ub=Object.defineProperty,pb=Object.defineProperties,fb=Object.getOwnPropertyDescriptors,Id=Object.getOwnPropertySymbols,hb=Object.prototype.hasOwnProperty,gb=Object.prototype.propertyIsEnumerable,Zi=(e,t,n)=>t in e?ub(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Mo=(e,t)=>{for(var n in t||(t={}))hb.call(t,n)&&Zi(e,n,t[n]);if(Id)for(var n of Id(t))gb.call(t,n)&&Zi(e,n,t[n]);return e},mb=(e,t)=>pb(e,fb(t)),fn=(e,t,n)=>(Zi(e,typeof t!="symbol"?t+"":t,n),n),No=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const bb="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",dt=class{constructor(e,t,n){this.$store=n,fn(this,"onlineRepo"),fn(this,"localRepo"),fn(this,"tempRepo",yn({authors:{},packs:[]})),fn(this,"combinedList"),fn(this,"authors"),window.repo=this,e||(e={authors:{},packs:[]},pe.fire(new ot("Couldn't load remote repository."))),t||(t={authors:{},packs:[]},X.supports.localRepo&&pe.fire(new ot("Couldn't load local repository."))),this.onlineRepo=io(e),this.localRepo=io(t),this.combinedList=nr(()=>{var o,s;const r=this.onlineRepo.value,i=(o=r==null?void 0:r.packs)!=null?o:[],a=new Map(i.map(w=>[w.id,w])),l=this.localRepo.value,d=(s=l==null?void 0:l.packs)!=null?s:[],c=new Map(d.map(w=>[w.id,w])),f=this.tempRepo.packs,b=new Map(f.map(w=>[w.id,w])),v=new Set(X.state.autoAdd),$=this.$store.state.content.contentPacks.map(w=>w.packId).filter(w=>w!=null),M=new Set($),R=new Set;return[...$,...d.map(w=>w.id),...i.map(w=>w.id),...f.map(w=>w.id)].filter(w=>w.startsWith("dddg.buildin.")||w.startsWith("dddg.uploads.")||w.startsWith("dddg.desktop.")||w==="concept_femc.shido_draws.edave64"||w==="mc.storm_blaze.edave64"||R.has(w)?!1:(R.add(w),!0)).map(w=>{var x,j,Y;return mb(Mo(Mo(Mo({},(x=a.get(w))!=null?x:{characters:[],kind:[],authors:[]}),(j=c.get(w))!=null?j:{}),(Y=b.get(w))!=null?Y:{}),{autoloading:v.has(w),installed:c.has(w),online:a.has(w)||b.has(w),loaded:M.has(w)})})}),this.authors=nr(()=>{var o,s;const r=this.onlineRepo.value,i=(o=r==null?void 0:r.authors)!=null?o:{},a=this.localRepo.value,l=(s=a==null?void 0:a.authors)!=null?s:{};return Mo(Mo({},i),l)}),Object.freeze(this)}static getInstance(){return dt.instance||(dt.instance=this.createInstance()),dt.instance}static createInstance(){return No(this,null,function*(){const e=dt.loadRepo(bb),t=X.supports.localRepo?yield dt.loadRepo(X.localRepositoryUrl):null,[n,o,s]=yield Promise.all([e,t,dt.$store]);return new dt(n,o,s)})}static loadRepo(e){return No(this,null,function*(){try{const[t,n]=yield Promise.all([dt.fetchJSON(e+"repo.json"),dt.fetchJSON(e+"people.json")]);return{packs:t,authors:n}}catch(t){return null}})}static fetchJSON(e){return No(this,null,function*(){const t=yield fetch(e);if(!t.ok)throw new Error("Could not load json");return yield t.json()})}reloadLocalRepo(){return No(this,null,function*(){this.localRepo.value=X.supports.localRepo?yield dt.loadRepo(X.localRepositoryUrl):null})}getPacks(){return this.combinedList.value}hasPack(e,t=!1){var n;return t?!!((n=this.onlineRepo.value)!=null&&n.packs.find(o=>o.id===e)):!!this.getPacks().find(o=>o.id===e)}getPack(e){var t;return(t=this.getPacks().find(n=>n.id===e))!=null?t:null}getAuthor(e){return this.authors.value[e]||null}getAuthors(){return this.authors.value}loadTempPack(e){return No(this,null,function*(){const t=fetch(e);let n;try{n=yield t}catch(r){throw new Error(`Failed to load '${e}'`)}let o;try{o=yield n.json()}catch(r){throw new Error(`The contents of '${e}' is not a valid JSON: ${r.message}`)}if(!o.pack)throw new Error(`The json file '${e}' does not contain any packages`);if(o.authors)for(const r in o.authors)this.tempRepo.authors[r]&&(this.tempRepo.authors[r]=o.authors[r]);const s=o.pack;return s.repoUrl=e,this.tempRepo.packs.find(r=>r.id===s.id)||this.tempRepo.packs.push(s),s.id})}};let Jt=dt;fn(Jt,"instance");fn(Jt,"setStore");fn(Jt,"$store",new Promise((e,t)=>{dt.setStore=e}));let ci=null,ui=[];function A(e){return new Promise((t,n)=>{const o=()=>Zr(this,null,function*(){ci=[];try{yield e()}catch(s){console.log("Error during transaction!: ",s)}ci=null,ui.length>0&&ui.shift()(),t()});ci?ui.push(o):o()})}var vb=Object.defineProperty,Td=Object.getOwnPropertySymbols,yb=Object.prototype.hasOwnProperty,_b=Object.prototype.propertyIsEnumerable,Qi=(e,t,n)=>t in e?vb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,el=(e,t)=>{for(var n in t||(t={}))yb.call(t,n)&&Qi(e,n,t[n]);if(Td)for(var n of Td(t))_b.call(t,n)&&Qi(e,n,t[n]);return e},Ot=(e,t,n)=>(Qi(e,typeof t!="symbol"?t+"":t,n),n),Ee=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const ir=navigator.userAgent,wb=!!ir.match(/iPad/i)||!!ir.match(/iPhone/i),$b=!!ir.match(/WebKit/i),Ed=wb&&$b&&!ir.match(/CriOS/i);class Op{constructor(){Ot(this,"state",yn({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder"})),Ot(this,"supports"),Ot(this,"_gameMode",null),Ot(this,"$store",null),Ot(this,"isSavingEnabled",io(!1)),Ot(this,"localRepositoryUrl",""),Ot(this,"loading"),Ot(this,"creatingDB"),Ot(this,"loadingContentPacksAllowed"),Ot(this,"loadContentPacks");const t=this,n=Fe.canSave();window.addEventListener("beforeunload",function(o){o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise((o,s)=>{this.loadContentPacks=()=>o()}),this.supports=yn({optionalSaving:n,get autoLoading(){return n&&t.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!Ed,allowWebP:!0,limitedCanvasSpace:Ed}),n?this.loading=(()=>Ee(this,null,function*(){this.savingEnabled=yield Fe.doesDbExists()}))():this.loading=Promise.resolve(),this.loading.then(()=>Ee(this,null,function*(){var o;if(yield this.loadingContentPacksAllowed,this.creatingDB&&(yield this.creatingDB),this.savingEnabled){const s=(o=yield Fe.loadAutoload())!=null?o:[];this.state.autoAdd=s;const r=yield Jt.getInstance(),i=yield Promise.all(s.map(a=>Ee(this,null,function*(){var l;const[d,c]=a.split(";",2);c!=null&&!r.hasPack(d)&&(yield r.loadTempPack(c));const p=r.getPack(d);return(l=p.dddg2Path)!=null?l:p.dddg1Path})));yield A(()=>Ee(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",i)}))}}))}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(t){t?(localStorage.setItem("saving","true"),this.creatingDB=Fe.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=Fe.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(t,n){return Ee(this,null,function*(){const o=document.createElement("a"),s=URL.createObjectURL(t);o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)})}loadGameMode(){return Ee(this,null,function*(){const n=new URLSearchParams(location.search).get("mode");if(n==="ddlc"||n==="ddlc_plus"){this._gameMode=n;return}yield this.loading,yield this.creatingDB;let o="";this.isSavingEnabled.value&&(o=yield Fe.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s})}setGameMode(t){return Ee(this,null,function*(){this.isSavingEnabled.value&&(yield Fe.saveGameMode(t));const n=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${n}?mode=${t}`})}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(t){throw new Error("Method not implemented.")}connectToStore(t){this.$store=t}saveToFile(t,n,o="image/png",s=1){return Ee(this,null,function*(){const r=document.createElement("a");r.setAttribute("download",n);const i=yield this.createObjectURL(t,o,s);return r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),i})}localRepoInstall(t,n,o){throw new Error("This environment does not support a local repository")}localRepoUninstall(t){throw new Error("This environment does not support a local repository")}autoLoadAdd(t){return Ee(this,null,function*(){yield this.loading,yield this.creatingDB,yield Fe.saveAutoload([...this.state.autoAdd,t]),this.state.autoAdd.push(t)})}autoLoadRemove(t){return Ee(this,null,function*(){yield this.loading,yield this.creatingDB;const n=this.normalizePackId(t);yield Fe.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=n));const o=this.state.autoAdd.indexOf(t);this.state.autoAdd.splice(o,1)})}normalizePackId(t){const n=t.split(";");return n.length===1?n[0]:n[n.length-1]}loadSettings(){return Ee(this,null,function*(){yield this.loading,yield this.creatingDB;const t={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?el(el({},t),yield Fe.loadSettings()):t})}saveSettings(t){return Ee(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield Fe.saveSettings(t))})}isInitialized(){return Ee(this,null,function*(){yield this.loading,yield this.creatingDB})}prompt(t,n){return new Promise((o,s)=>{o(prompt(t,n))})}onPanelChange(t){}createObjectURL(t,n,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(t.toDataURL(n,o));if(t.toBlob!=null)t.toBlob(a=>{if(!a){r();return}s(URL.createObjectURL(a))},n,o);else{const a=t.toDataURL(n,o),l=this.dataURItoBlob(a,n);s(URL.createObjectURL(l))}})}dataURItoBlob(t,n){const o=atob(t.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=o.charCodeAt(i);return new Blob([r],{type:n})}}const Fe={indexedDB:(()=>{var e,t,n;try{return(n=(t=(e=window.indexedDB)!=null?e:window.mozIndexedDB)!=null?t:window.webkitIndexedDB)!=null?n:window.msIndexedDB}catch(o){return null}})(),transaction:(()=>{try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(e){return null}})(),db:null,canSave(){return!!(Fe.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return Fe.db?Fe.db:Fe.db=new Promise((e,t)=>{const n=Fe.indexedDB.open("dddg",3);n.onerror=o=>{t(o)},n.onupgradeneeded=o=>{var s;const r=o.target.result,i=(s=o.oldVersion)!=null?s:o.version;i<1&&r.createObjectStore("settings"),i===1&&(r.deleteObjectStore("settings"),r.createObjectStore("settings"))},n.onsuccess=o=>{e(n.result)}})},clearDB(){return new Promise((e,t)=>{if(!Fe.db){e();return}const n=Fe.indexedDB.deleteDatabase("dddg");Fe.db=null,n.onerror=o=>{t(o)},n.onsuccess=o=>{e()}})},loadAutoload(){return this.objectStorePromise("readonly",e=>Ee(this,null,function*(){return yield this.reqPromise(e.get("autoload"))}))},saveAutoload(e){return this.objectStorePromise("readwrite",t=>Ee(this,null,function*(){yield this.reqPromise(t.put([...e],"autoload"))}))},loadGameMode(){return this.objectStorePromise("readonly",e=>Ee(this,null,function*(){return yield this.reqPromise(e.get("gameMode"))}))},saveGameMode(e){return this.objectStorePromise("readwrite",t=>Ee(this,null,function*(){yield this.reqPromise(t.put(e,"gameMode"))}))},saveSettings(e){return this.objectStorePromise("readwrite",t=>Ee(this,null,function*(){yield this.reqPromise(t.put(el({},e),"settings"))}))},loadSettings(){return this.objectStorePromise("readonly",e=>Ee(this,null,function*(){return yield this.reqPromise(e.get("settings"))}))},objectStorePromise(e,t){return this.db?new Promise((n,o)=>Ee(this,null,function*(){const r=(yield this.db).transaction(["settings"],e).objectStore("settings");try{n(yield t(r))}catch(i){o(i)}})):Promise.reject(new Error("No database"))},reqPromise(e){return new Promise((t,n)=>{e.onerror=o=>{n(o)},e.onsuccess=o=>{t(e.result)}})}};var Cb=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Pb extends Op{saveToFile(t,n,o="image/png",s=1){return Cb(this,null,function*(){let r=t.toDataURL(o,s);const i=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,n),r})}}var Sb=Object.defineProperty,kb=(e,t,n)=>t in e?Sb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,it=(e,t,n)=>(kb(e,typeof t!="symbol"?t+"":t,n),n),$e=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Bd={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};class Ob{constructor(){it(this,"state",yn({looseTextParsing:!0,autoAdd:[],downloadLocation:""})),it(this,"localRepositoryUrl","/repo/"),it(this,"_gameMode",null),it(this,"electron",window),it(this,"$store",null),it(this,"bgInvalidation",null),it(this,"pendingContentPacks",[]),it(this,"pendingContentPacksReplace",[]),it(this,"loadingContentPacksAllowed"),it(this,"loadContentPacks"),it(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1}),it(this,"savingEnabled",!0),this.loadingContentPacksAllowed=new Promise((n,o)=>{this.loadContentPacks=()=>n()}),this.electron.ipcRenderer.on("add-persistent-content-pack",n=>$e(this,null,function*(){if(yield this.loadingContentPacksAllowed,!this.$store){this.pendingContentPacks.push(n);return}yield A(()=>$e(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",n)}))})),this.electron.ipcRenderer.on("add-persistent-background",n=>$e(this,null,function*(){const o="persistentBg-"+n,s=n.split("/");yield jp(o,n),Bd.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()})),this.electron.ipcRenderer.on("push-message",n=>$e(this,null,function*(){pe.fire(new ot(n))})),this.electron.ipcRenderer.on("config.downloadFolderUpdate",n=>$e(this,null,function*(){this.state.downloadLocation=n})),this.electron.ipcRenderer.onConversation("load-packs",n=>$e(this,null,function*(){const o=yield Jt.getInstance(),s=yield Promise.all(n.map(r=>$e(this,null,function*(){const[i,a]=r.split(";",2);a!=null&&!o.hasPack(i)&&(yield o.loadTempPack(a));const l=o.getPack(i);return l.dddg2Path||l.dddg1Path})));if(!this.$store){s.forEach(r=>this.pendingContentPacks.push(r));return}yield A(()=>$e(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",s)}))})),this.electron.ipcRenderer.onConversation("auto-load.changed",n=>$e(this,null,function*(){this.state.autoAdd=n})),this.electron.ipcRenderer.onConversation("reload-repo",()=>$e(this,null,function*(){yield(yield Jt.getInstance()).reloadLocalRepo()})),this.electron.ipcRenderer.onConversation("replace-pack",n=>$e(this,null,function*(){const o={processed:!1,contentPack:n};this.$store?yield A(()=>$e(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",o)})):this.pendingContentPacksReplace.push(o)})),this.electron.ipcRenderer.onConversation("resolvable-error",(n,o)=>new Promise((s,r)=>{pe.fire(new Jl(n,o.map(i=>({exec:()=>s(i),name:i}))))}));let t=!1;this.electron.ipcRenderer.on("update.progress",n=>{n==="done"?(t=!1,pe.fire(new ot("An update is ready and will be installed once DDDG closes."))):t||(t=!0,pe.fire(new ot("An update is ready and will be installed once DDDG closes.")))}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}storeSaveFile(t,n){return $e(this,null,function*(){const o=document.createElement("a"),s=URL.createObjectURL(t);o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)})}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(t){this.electron.ipcRenderer.send("open-folder",t)}onPanelChange(t){}saveSettings(t){return $e(this,null,function*(){var n;yield this.electron.ipcRenderer.sendConvo("config.set","nsfw",t.nsfw),yield this.electron.ipcRenderer.sendConvo("config.set","darkMode",(n=t.darkMode)!=null?n:void 0),yield this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",t.defaultCharacterTalkingZoom)})}loadGameMode(){return $e(this,null,function*(){this._gameMode=(yield this.electron.ipcRenderer.sendConvo("config.get","gameMode"))||"ddlc"})}setGameMode(t){return $e(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("config.set","gameMode",t),this.electron.ipcRenderer.send("reload")})}loadSettings(){return $e(this,null,function*(){var t,n,o;return{lq:!1,nsfw:(t=yield this.electron.ipcRenderer.sendConvo("config.get","nsfw"))!=null?t:!1,darkMode:(n=yield this.electron.ipcRenderer.sendConvo("config.get","darkMode"))!=null?n:void 0,defaultCharacterTalkingZoom:(o=yield this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom"))!=null?o:void 0}})}localRepoInstall(t,n,o){return $e(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.install",t,n,o)})}localRepoUninstall(t){return $e(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.uninstall",t)})}autoLoadAdd(t){return $e(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.add",t)})}autoLoadRemove(t){return $e(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.remove",t)})}saveToFile(t,n,o="image/png",s=1){return new Promise((r,i)=>{t.toBlob(a=>$e(this,null,function*(){if(!a){i();return}const l=yield a.arrayBuffer();yield this.electron.ipcRenderer.sendConvo("save-file",n,new Uint8Array(l)),r(URL.createObjectURL(a))}),o,s)})}prompt(t,n){return $e(this,null,function*(){return yield this.electron.ipcRenderer.sendConvo("show-prompt",t,n)})}connectToStore(t){this.$store=t,this.invalidateInstalledBGs(),A(()=>$e(this,null,function*(){if(this.pendingContentPacks.length>0&&(yield this.$store.dispatch("content/loadContentPacks",this.pendingContentPacks)),this.pendingContentPacksReplace.length>0)for(const n of this.pendingContentPacksReplace)yield this.$store.dispatch("content/replaceContentPack",n)}))}invalidateInstalledBGs(){!this.$store||this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.$store&&A(()=>$e(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",{contentPack:Bd})}))}}function xb(){return window.isElectron?new Ob:"msSaveOrOpenBlob"in window.navigator?new Pb:new Op}const X=xb();window.toast=X;var jb=Object.defineProperty,Ib=(e,t,n)=>t in e?jb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xp=(e,t,n)=>(Ib(e,typeof t!="symbol"?t+"":t,n),n),cs=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});let pi;function mo(){if(pi)return pi;if(!X.supports.allowWebP)return Promise.resolve(!1);const e="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",t="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return pi=(()=>cs(this,null,function*(){const n=yield Promise.all([Ad(e,1,2),Ad(t,720,1280)]);return n[0]&&n[1]}))()}function Ad(e,t,n){return new Promise((o,s)=>{const r=document.createElement("img");r.addEventListener("load",()=>{o(r.width===n&&r.height===t)}),r.addEventListener("error",()=>{o(!1)}),r.src=e})}let fi;function Tb(){return fi||(fi=new Promise((e,t)=>{const n="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",o=document.createElement("img");o.addEventListener("load",()=>{console.log("Heif no error. "+(o.width===2&&o.height===1)),e(o.width===2&&o.height===1)}),o.addEventListener("error",()=>{console.log("Heif not supported"),e(!1)}),o.src=n}))}class Eb{constructor(){xp(this,"cache",new Map)}get(t){const n=this.cache.get(t);if(n)return n;const o=tl(t);return this.cache.set(t,o),o}remove(t){this.cache.delete(t)}}class Bb{constructor(){xp(this,"cache",new Map)}get(t){var n;const o=(n=this.cache.get(t))==null?void 0:n.deref();if(o)return o;const s=Db(t);return this.cache.set(t,new WeakRef(s)),s}remove(t){this.cache.delete(t)}}let hi=null;function lr(){return hi||(window.assetCache=hi=X.supports.assetCaching||typeof WeakRef=="undefined"?new Eb:new Bb)}const Nn={};function Er(e,t=!0){return Ql(X.supports.lq&&!t?e.lq:e.hq)}function Mn(e,t=!0){const n=X.supports.lq&&!t?e.lq:e.hq;return Nn[n]?Nn[n]:n}function Ql(e){return Nn[e]&&(e=Nn[e]),lr().get(e)}const He="./";function co(e,t=!0){return cs(this,null,function*(){const n=`${He}assets/${e}${t?"":".lq"}${(yield mo())?".webp":".png"}`.replace(/\/+/,"/");return yield lr().get(n)})}function Ab(e,t=!0){return cs(this,null,function*(){return`${He}assets/${e}${X.supports.lq&&!t?".lq":""}${(yield mo())?".webp":".png"}`.replace(/\/+/,"/")})}function jp(e,t){Nn[e]=t}function Db(e){return cs(this,null,function*(){const t=!!Nn[e];return t&&(e=Nn[e]),(()=>cs(this,null,function*(){try{return yield tl(e)}catch(n){if(e.endsWith(".webp")&&!t)try{return yield tl(e.replace(/\.webp$/,".png"))}catch(o){return pe.fire(new or(e)),lr().remove(e),new rr}else return pe.fire(new or(e)),lr().remove(e),new rr}}))()})}function tl(e){return new Promise((t,n)=>{const o=new Image;o.addEventListener("load",()=>{t(new Zl(o)),X.supports.assetCaching||document.body.removeChild(o)}),o.addEventListener("error",s=>{t(new rr),X.supports.assetCaching||document.body.removeChild(o)}),o.crossOrigin="Anonymous",o.src=e,o.style.display="none",document.body.appendChild(o)})}const Rb=te({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},checkbox(){return this.$refs.checkbox}}});const oe=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},Fb={class:"toggle_box"},Mb=["id"],Nb=["for"],Hb=["for"];function Lb(e,t,n,o,s,r){return g(),y("div",Fb,[ce(u("input",{id:e._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":t[0]||(t[0]=i=>e.value=i)},null,8,Mb),[[qm,e.value]]),u("label",{for:e._.uid,class:"switch"},null,8,Nb),u("label",{for:e._.uid,class:"toggle_label"},he(e.label),9,Hb)])}const Ft=oe(Rb,[["render",Lb]]),ea={methods:{verticalScrollRedirect(e){if(e.type!=="wheel"||!e.currentTarget)return;const t=e.currentTarget,n=getComputedStyle(t),o=e;if(o.deltaY===0)return;if(n.overflowY==="auto"){if(o.deltaY>0){if(t.scrollHeight>t.scrollTop+t.clientHeight){e.stopPropagation();return}}else if(t.scrollTop>0){e.stopPropagation();return}}const s=t.scrollLeft;t.scrollLeft+=o.deltaY,t.scrollLeft!==s&&e.stopPropagation()}}},st={mixins:[ea],computed:{vertical(){return this.$store.state.ui.vertical}},mounted(){this.updateVertical(),this.$el.addEventListener("wheel",e=>{this.vertical||this.verticalScrollRedirect(e)},{passive:!0})},methods:{updateVertical(){!this.$el||(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical(){this.updateVertical()}}},Ub=window.HTMLDialogElement!=null,Vb=te({props:{noBaseSize:Boolean,options:{type:Array,default:[]}},computed:{nativeDialogs(){return Ub}},methods:{open(){if(this.nativeDialogs){const e=this.$refs.dialog;e&&!e.open&&e.showModal()}window.addEventListener("click",this.clickSomewhere)},close(){if(this.nativeDialogs){const e=this.$refs.dialog;e&&e.open&&e.close(),this.$emit("leave")}window.removeEventListener("click",this.clickSomewhere)},clickSomewhere(e){const t=this.$refs.dialog;t&&t.open?e.target===t&&(this.close(),e.preventDefault(),e.stopPropagation()):window.removeEventListener("click",this.clickSomewhere)}},mounted(){this.open()},activated(){this.open()},deactivated(){this.close()},unmounted(){this.close()}});const Wb={key:0,id:"submit-options"},zb=["onClick"],Gb={key:0,id:"submit-options"},qb=["onClick"];function Xb(e,t,n,o,s,r){return e.nativeDialogs?(g(),y("dialog",{key:0,ref:"dialog",class:fe(["native",{"base-size":!e.noBaseSize}]),onCancel:t[0]||(t[0]=(...i)=>e.close&&e.close(...i))},[Xt(e.$slots,"default",{},void 0,!0),e.options.length>0?(g(),y("div",Wb,[(g(!0),y(V,null,Pe(e.options,i=>(g(),y("button",{key:i,class:"option",onClick:a=>e.$emit("option",i)},he(i),9,zb))),128))])):K("",!0)],34)):(g(),y("div",{key:1,class:"dialog-wrapper",onClick:t[2]||(t[2]=i=>e.$emit("leave"))},[u("dialog",{ref:"dialog",open:"",class:fe({"base-size":!e.noBaseSize}),onClick:t[1]||(t[1]=q(()=>{},["stop"]))},[Xt(e.$slots,"default",{},void 0,!0),e.options.length>0?(g(),y("div",Gb,[(g(!0),y(V,null,Pe(e.options,i=>(g(),y("button",{key:i,class:"option",onClick:a=>e.$emit("option",i)},he(i),9,qb))),128))])):K("",!0)],2)]))}const ta=oe(Vb,[["render",Xb],["__scopeId","data-v-05695279"]]),Kb=te({mixins:[ea],props:{to:{type:String,required:!0}},computed:{href(){let e=this.to;return e=e.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),e=e.replace(/^wiki:\/\/(.*)/,(t,n)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+n.replaceAll(" ","-")),e}}}),Yb=["href"];function Jb(e,t,n,o,s,r){return g(),y("a",{target:"_blank",rel:"noopener noreferrer",href:e.href},[Xt(e.$slots,"default")],8,Yb)}const na=oe(Kb,[["render",Jb]]);var Zb=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});function nl(e,t){return Zb(this,null,function*(){try{yield t()}catch(n){console.error("Error in promise",e,n),pe.fire(new Xl("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+e+'", '+Qb(n)))}})}function Qb(e){if(e instanceof Error){if(e.stack!=null){const t=e.stack.split(`
`);return t[0].includes(e.name)&&t[0].includes(e.message)?t[0]+`
<br />`+t[1]:e.name+": "+e.message+`
<br />`+t[0]}return e.name+": "+e.message}return e instanceof Object?JSON.stringify(e):""+e}var Ho=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const ev=te({mixins:[st],components:{Toggle:Ft,ModalDialog:ta,L:na},data:()=>({allowSavesModal:!1,denySavesModal:!1,waitOnSaveChange:!1,showModeDialog:!1}),computed:{savesAllowed:{get(){return X.savingEnabled},set(e){this.waitOnSaveChange=!0,X.savingEnabled=e,this.saveSettings()}},inPlusMode(){return X.gameMode==="ddlc_plus"},savesEnabledInEnv(){return X.supports.optionalSaving},lqAllowed(){return X.supports.lq},looseTextParsing:{get(){return X.state.looseTextParsing},set(e){X.state.looseTextParsing=e,this.saveSettings()}},lqRendering:{get(){return this.$store.state.ui.lqRendering},set(e){A(()=>Ho(this,null,function*(){yield this.$store.commit("ui/setLqRendering",e)})),this.saveSettings()}},nsfw:{get(){return!!this.$store.state.ui.nsfw},set(e){A(()=>Ho(this,null,function*(){yield this.$store.commit("ui/setNsfw",e),this.saveSettings()}))}},defaultCharacterTalkingZoom:{get(){return!!this.$store.state.ui.defaultCharacterTalkingZoom},set(e){A(()=>Ho(this,null,function*(){yield this.$store.commit("ui/setDefaultCharacterTalkingZoom",e),this.saveSettings()}))}},theme:{get(){return this.$store.state.ui.useDarkTheme},set(e){A(()=>Ho(this,null,function*(){yield this.$store.commit("ui/setDarkTheme",e),this.saveSettings()}))}},showDownloadFolder(){return X.supports.setDownloadFolder},downloadFolder(){return X.state.downloadLocation}},watch:{savesAllowed(){this.waitOnSaveChange=!1}},methods:{allowSaves(e){this.allowSavesModal=!1,e==="Allow"&&(this.savesAllowed=!0)},denySaves(e){this.denySavesModal=!1,e==="Deny"&&(this.savesAllowed=!1)},modeChange(e){nl("changing modes",()=>Ho(this,null,function*(){e==="Enter Classic Mode"?yield X.setGameMode("ddlc"):e==="Enter Plus mode"?yield X.setGameMode("ddlc_plus"):this.showModeDialog=!1}))},saveSettings(){var e;X.saveSettings({lq:this.$store.state.ui.lqRendering,nsfw:this.$store.state.ui.nsfw,darkMode:(e=this.$store.state.ui.useDarkTheme)!=null?e:void 0,looseTextParsing:X.state.looseTextParsing,defaultCharacterTalkingZoom:this.$store.state.ui.defaultCharacterTalkingZoom})},setDownloadFolder(){X.updateDownloadFolder()},openDownloadFolder(){X.openFolder("downloads")}}});const ht=e=>(Ge("data-v-b4fef818"),e=e(),qe(),e),tv={class:"panel"},nv=ht(()=>u("h1",null,"Settings",-1)),ov={class:"modal-scroll-area"},sv=ht(()=>u("p",null,"Do you want to allow DDDG to save settings on your device?",-1)),rv=ht(()=>u("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),iv=ht(()=>u("p",null,"You can revoke this permission at any time.",-1)),lv={class:"modal-scroll-area"},av=ht(()=>u("p",null,"Do you want to deny DDDG from saving settings on your device?",-1)),dv=ht(()=>u("p",null," This will cause all your settings to reset when leaving the page. ",-1)),cv=ht(()=>u("div",{class:"modal-scroll-area"},[u("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)),uv={key:0,disabled:""},pv=ht(()=>u("td",null,[u("label",null,"Theme:")],-1)),fv=ht(()=>u("option",{value:null},"System",-1)),hv=ht(()=>u("option",{value:!1},"Light",-1)),gv=ht(()=>u("option",{value:!0},"Dark",-1)),mv=[fv,hv,gv],bv={key:4,class:"downloadTable"},vv=ht(()=>u("td",null,[u("label",null,"Download folder:")],-1));function yv(e,t,n,o,s,r){const i=E("l"),a=E("modal-dialog"),l=E("toggle");return g(),y("div",tv,[nv,(g(),U(dp,{to:"#modal-messages"},[e.allowSavesModal?(g(),U(a,{key:0,options:["Allow","Deny"],onLeave:t[0]||(t[0]=d=>e.allowSaves("Deny")),onOption:e.allowSaves,"no-base-size":""},{default:B(()=>[u("div",ov,[sv,rv,iv,u("p",null,[O(" Our usual "),C(i,{to:"wiki://Privacy Statement"},{default:B(()=>[O("privacy policy")]),_:1}),O(" still applies. ")])])]),_:1},8,["onOption"])):K("",!0),e.denySavesModal?(g(),U(a,{key:1,options:["Deny","Cancle"],onLeave:t[1]||(t[1]=d=>e.denySaves("Cancle")),onOption:e.denySaves,"no-base-size":""},{default:B(()=>[u("div",lv,[av,dv,u("p",null,[O(" Our usual "),C(i,{to:"wiki://Privacy Statement"},{default:B(()=>[O("privacy policy")]),_:1}),O(" still applies. ")])])]),_:1},8,["onOption"])):K("",!0),e.showModeDialog?(g(),U(a,{key:2,options:[e.inPlusMode?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:t[2]||(t[2]=d=>e.showModeDialog=!1),onOption:e.modeChange,"no-base-size":""},{default:B(()=>[cv]),_:1},8,["options","onOption"])):K("",!0)])),e.waitOnSaveChange?(g(),y("button",uv,"Applying...")):!e.savesAllowed&&e.savesEnabledInEnv?(g(),y("button",{key:1,onClick:t[3]||(t[3]=d=>e.allowSavesModal=!0)}," Allow saving options ")):e.savesAllowed&&e.savesEnabledInEnv?(g(),y("button",{key:2,onClick:t[4]||(t[4]=d=>e.denySavesModal=!0)}," Deny saving options ")):K("",!0),u("button",{onClick:t[5]||(t[5]=d=>e.showModeDialog=!0)},[e.inPlusMode?(g(),y(V,{key:0},[O(" Enter Classic Mode ")],64)):(g(),y(V,{key:1},[O(" Enter DDLC Plus Mode ")],64))]),e.lqAllowed?(g(),U(l,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:e.lqRendering,"onUpdate:modelValue":t[6]||(t[6]=d=>e.lqRendering=d)},null,8,["modelValue"])):K("",!0),C(l,{label:"NSFW Mode?",modelValue:e.nsfw,"onUpdate:modelValue":t[7]||(t[7]=d=>e.nsfw=d)},null,8,["modelValue"]),C(l,{label:"Enlarge talking objects? (Default value)",modelValue:e.defaultCharacterTalkingZoom,"onUpdate:modelValue":t[8]||(t[8]=d=>e.defaultCharacterTalkingZoom=d)},null,8,["modelValue"]),C(l,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:e.looseTextParsing,"onUpdate:modelValue":t[9]||(t[9]=d=>e.looseTextParsing=d)},null,8,["modelValue"]),u("table",null,[u("tr",null,[pv,u("td",null,[ce(u("select",{"onUpdate:modelValue":t[10]||(t[10]=d=>e.theme=d)},mv,512),[[wt,e.theme]])])])]),e.showDownloadFolder?(g(),y("table",bv,[u("tr",null,[vv,u("td",null,he(e.downloadFolder),1),u("td",null,[u("button",{onClick:t[11]||(t[11]=(...d)=>e.setDownloadFolder&&e.setDownloadFolder(...d))},"Set"),u("button",{onClick:t[12]||(t[12]=(...d)=>e.openDownloadFolder&&e.openDownloadFolder(...d))},"Open")])])])):K("",!0)])}const _v=oe(ev,[["render",yv],["__scopeId","data-v-b4fef818"]]),wv=te({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},shortcut:{type:String,default:null}},computed:{showPopup(){return this.shortcut!=null&&!this.shortcut.startsWith("!")},popupText(){const e=this.shortcut;return e==null?"":e.startsWith("!")?e.substring(1):e}}});const $v=["disabled"],Cv={class:"material-icons","aria-hidden":"true"},Pv={class:"content"},Sv={key:0,class:"shortcut-popup"};function kv(e,t,n,o,s,r){return g(),y("button",{class:fe([e.iconPos]),disabled:e.disabled},[u("div",Cv,he(e.icon),1),u("div",Pv,[Xt(e.$slots,"default",{},void 0,!0)]),e.showPopup?(g(),y("div",Sv,he(e.popupText),1)):K("",!0)],10,$v)}const Ln=oe(wv,[["render",kv],["__scopeId","data-v-154d0c63"]]);var Ov=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const xv=te({emits:["show-dialog"],components:{DButton:Ln},computed:{characters(){return this.$store.state.content.current.characters}},methods:{assetPath(e){return e.chibi?X.supports.lq?e.chibi.lq:e.chibi.hq:""},onChosen(e){A(()=>Ov(this,null,function*(){yield this.$store.dispatch("panels/createCharacters",{characterType:e,panelId:this.$store.state.panels.currentPanel})}))}}});const jv=["title","onClick","onKeypress"],Iv=["src","alt"];function Tv(e,t,n,o,s,r){const i=E("d-button");return g(),y(V,null,[(g(!0),y(V,null,Pe(e.characters,a=>(g(),y("div",{class:"character",tabindex:"0",key:a.id,title:a.label,onClick:q(l=>e.onChosen(a.id),["left"]),onKeypress:[Ue(q(l=>e.onChosen(a.id),["prevent","stop"]),["enter"]),Ue(q(l=>e.onChosen(a.id),["prevent","stop"]),["space"])]},[u("img",{src:e.assetPath(a),alt:a.label},null,8,Iv)],40,jv))),128)),C(i,{class:"custom-sprite",icon:"extension",onClick:t[0]||(t[0]=a=>e.$emit("show-dialog","type: Characters"))},{default:B(()=>[O(" Search in content packs ")]),_:1})],64)}const Ev=oe(xv,[["render",Tv],["__scopeId","data-v-f4dce733"]]),Bv=te({computed:{vertical(){return this.$store.state.ui.vertical}},data:()=>({visible:!1}),methods:{show(){this.visible=!0},hide(){this.visible=!1},drop(e){if(this.hide(),e.stopPropagation(),e.preventDefault(),!!e.dataTransfer)for(const t of e.dataTransfer.items)t.kind==="file"&&t.type.match(/image.*/)&&this.$emit("drop",t.getAsFile())}}});function Av(e,t,n,o,s,r){return e.visible?(g(),y("div",{key:0,onDragleave:t[0]||(t[0]=i=>e.visible=!1),onDrop:t[1]||(t[1]=(...i)=>e.drop&&e.drop(...i)),class:fe({vertical:e.vertical})},[Xt(e.$slots,"default",{},void 0,!0)],34)):K("",!0)}const Ip=oe(Bv,[["render",Av],["__scopeId","data-v-9c9153a9"]]);var Dv=Object.defineProperty,Rv=Object.defineProperties,Fv=Object.getOwnPropertyDescriptors,Dd=Object.getOwnPropertySymbols,Mv=Object.prototype.hasOwnProperty,Nv=Object.prototype.propertyIsEnumerable,Rd=(e,t,n)=>t in e?Dv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fd=(e,t)=>{for(var n in t||(t={}))Mv.call(t,n)&&Rd(e,n,t[n]);if(Dd)for(var n of Dd(t))Nv.call(t,n)&&Rd(e,n,t[n]);return e},Md=(e,t)=>Rv(e,Fv(t)),Ht=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Nd={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},Hv=te({mixins:[st],components:{DropTarget:Ip,DButton:Ln},computed:{sprites(){return this.$store.state.content.current.sprites.map(e=>{let t=null;const n=e.variants[0].map(o=>{const s=Mn(o,!1);return s.startsWith("uploads:")?(Object.keys(this.$store.state.uploadUrls),t=s,kp):s});return Md(Fd({},e),{missing:t,urls:n})})},showSpritesFolder(){return X.supports.openableFolders.has("sprites")}},methods:{assetSpriteBackground(e){return e.variants[0].map(t=>`url('${Mn(t,!1)}')`).join(",")},showDropTarget(e){!e.dataTransfer||(e.dataTransfer.effectAllowed="none",Array.from(e.dataTransfer.items).find(t=>t.type.match(/^image.*$/))&&(e.dataTransfer.effectAllowed="link",this.$refs.spriteDt.show()))},hideDropTarget(){this.$refs.spriteDt.hide()},onSpriteFileUpload(){const e=this.$refs.spriteUpload;if(!!e.files)for(const t of e.files)this.addCustomSpriteFile(t)},onMissingSpriteFileUpload(e){return Ht(this,null,function*(){const t=this.$refs.missingSpriteUpload,n=t.uploadingSprite;if(!t.files)return;if(t.files.length!==1){console.error("More than one file uploaded!");return}const o=t.files[0];yield A(()=>Ht(this,null,function*(){const s=URL.createObjectURL(o);yield this.$store.dispatch("uploadUrls/add",{name:n,url:s})}))})},uploadFromURL(){return Ht(this,null,function*(){const e=prompt("Enter the URL of the image");if(e==null)return;const t=e.split("/").slice(-1)[0];yield A(()=>Ht(this,null,function*(){yield this.addNewCustomSprite(t,e)}))})},addSpriteToScene(e){return Ht(this,null,function*(){yield A(()=>Ht(this,null,function*(){yield this.$store.dispatch("panels/createSprite",{panelId:this.$store.state.panels.currentPanel,assets:e.variants[0]})}))})},reuploadingSprite(e){const t=this.$refs.missingSpriteUpload;t.uploadingSprite=Mn(e.variants[0][0]).substring(8),t.click()},addCustomSpriteFile(e){return Ht(this,null,function*(){yield A(()=>Ht(this,null,function*(){const t=URL.createObjectURL(e),n=yield this.$store.dispatch("uploadUrls/add",{name:e.name,url:t});yield this.addNewCustomSprite(e.name,n)}))})},addNewCustomSprite(e,t){return Ht(this,null,function*(){const n=this.$store.state.content.contentPacks.find(s=>s.packId===Nd.packId)||Nd,o=Md(Fd({},n),{sprites:[...n.sprites,{id:t,label:e,variants:[[{lq:t,hq:t}]],defaultScale:[1,1],hd:null}]});yield this.$store.dispatch("content/replaceContentPack",{contentPack:o,processed:!0})})},openSpritesFolder(){X.openFolder("sprites")}}});const Lv=["title","onClick","onKeypress"],Uv=["title","onClick","onKeypress"];function Vv(e,t,n,o,s,r){const i=E("drop-target"),a=E("d-button");return g(),y("div",{class:fe(["sub-item-grid",{vertical:e.vertical}]),onDragenter:t[4]||(t[4]=(...l)=>e.showDropTarget&&e.showDropTarget(...l)),onMouseleave:t[5]||(t[5]=(...l)=>e.hideDropTarget&&e.hideDropTarget(...l))},[C(i,{ref:"spriteDt",class:"drop-target",onDrop:e.addCustomSpriteFile},{default:B(()=>[O("Drop here to add as a new sprite ")]),_:1},8,["onDrop"]),(g(!0),y(V,null,Pe(e.sprites,l=>(g(),y(V,null,[l.missing!==null?(g(),y("div",{class:"sprite",tabindex:"0",key:l.label,title:l.label,style:Be({background:e.assetSpriteBackground(l)}),onClick:d=>e.reuploadingSprite(l),onKeypress:[Ue(q(d=>e.reuploadingSprite(l),["prevent","stop"]),["enter"]),Ue(q(d=>e.reuploadingSprite(l),["prevent","stop"]),["space"])]},he(l.label),45,Lv)):(g(),y("div",{class:"sprite",tabindex:"0",key:l.label,title:l.label,style:Be({background:e.assetSpriteBackground(l)}),onClick:d=>e.addSpriteToScene(l),onKeypress:[Ue(q(d=>e.addSpriteToScene(l),["prevent","stop"]),["enter"]),Ue(q(d=>e.addSpriteToScene(l),["prevent","stop"]),["space"])]},he(l.label),45,Uv))],64))),256)),C(a,{class:"custom-sprite",icon:"publish",onClick:t[1]||(t[1]=l=>e.$refs.spriteUpload.click())},{default:B(()=>[O(" Upload new sprite "),u("input",{type:"file",ref:"spriteUpload",onChange:t[0]||(t[0]=(...l)=>e.onSpriteFileUpload&&e.onSpriteFileUpload(...l))},null,544)]),_:1}),C(a,{icon:"insert_link",onClick:e.uploadFromURL},{default:B(()=>[O(" New sprite from URL ")]),_:1},8,["onClick"]),C(a,{icon:"extension",onClick:t[2]||(t[2]=l=>e.$emit("show-dialog","type: Sprites"))},{default:B(()=>[O(" Search in content packs ")]),_:1}),e.showSpritesFolder?(g(),U(a,{key:0,icon:"folder",onClick:e.openSpritesFolder},{default:B(()=>[O(" Open sprites folder ")]),_:1},8,["onClick"])):K("",!0),u("input",{type:"file",ref:"missingSpriteUpload",onChange:t[3]||(t[3]=(...l)=>e.onMissingSpriteFileUpload&&e.onMissingSpriteFileUpload(...l))},null,544)],34)}const Wv=oe(Hv,[["render",Vv],["__scopeId","data-v-328962f7"]]);var xn=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const zv=te({components:{DButton:Ln},methods:{addTextBox(){return xn(this,null,function*(){return yield this.createUiElement("createTextBox")})},addChoice(){return xn(this,null,function*(){return yield this.createUiElement("createChoice")})},addDialog(){return xn(this,null,function*(){return yield this.createUiElement("createNotification")})},addPoem(){return xn(this,null,function*(){return yield this.createUiElement("createPoem")})},addConsole(){return xn(this,null,function*(){return yield this.createUiElement("createConsole")})},createUiElement(e){return xn(this,null,function*(){A(()=>xn(this,null,function*(){yield this.$store.dispatch(`panels/${e}`,{panelId:this.$store.state.panels.currentPanel})}))})}}});function Gv(e,t,n,o,s,r){return g(),y(V,null,[u("button",{onClick:t[0]||(t[0]=(...i)=>e.addTextBox&&e.addTextBox(...i))},"Textbox"),u("button",{onClick:t[1]||(t[1]=(...i)=>e.addPoem&&e.addPoem(...i))},"Poem"),u("button",{onClick:t[2]||(t[2]=(...i)=>e.addDialog&&e.addDialog(...i))},"Notification"),u("button",{onClick:t[3]||(t[3]=(...i)=>e.addChoice&&e.addChoice(...i))},"Choice"),u("button",{onClick:t[4]||(t[4]=(...i)=>e.addConsole&&e.addConsole(...i))},"Console")],64)}const qv=oe(zv,[["render",Gv]]);var Xv=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Kv=te({mixins:[st],components:{DButton:Ln,Characters:Ev,Sprites:Wv,UI:qv},data:()=>({group:"characters",groups:{characters:{icon:"emoji_people",text:"Char&shy;acters"},sprites:{icon:"change_history",text:"Sprites"},ui:{icon:"view_quilt",text:"UI"}}}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},hasClipboardContent(){return this.$store.state.ui.clipboard!=null},showSpritesFolder(){return X.supports.openableFolders.has("sprites")}},methods:{paste(){A(()=>Xv(this,null,function*(){yield this.$store.dispatch("panels/pasteObjectFromClipboard",{panelId:this.currentPanel.id})}))}}});const Yv=e=>(Ge("data-v-40e4de4a"),e=e(),qe(),e),Jv={class:"panel"},Zv=Yv(()=>u("h1",null,"Add",-1)),Qv=["innerHTML"],ey=["disabled"];function ty(e,t,n,o,s,r){const i=E("d-button"),a=E("Characters"),l=E("Sprites"),d=E("UI");return g(),y("div",Jv,[Zv,u("div",{class:fe({"group-selector":!0,vertical:e.vertical})},[(g(!0),y(V,null,Pe(e.groups,(c,p)=>(g(),U(i,{key:p,class:fe({active:e.group===p}),"icon-pos":"top",icon:c.icon,onClick:f=>e.group=p},{default:B(()=>[u("span",{innerHTML:c.text},null,8,Qv)]),_:2},1032,["class","icon","onClick"]))),128))],2),u("div",{class:fe({"item-grid":!0,vertical:e.vertical})},[e.group==="characters"?(g(),U(a,{key:0,onShowDialog:t[0]||(t[0]=c=>e.$emit("show-dialog",c))})):e.group==="sprites"?(g(),U(l,{key:1,onShowDialog:t[1]||(t[1]=c=>e.$emit("show-dialog",c))})):e.group==="ui"?(g(),U(d,{key:2})):K("",!0),u("button",{onClick:t[2]||(t[2]=(...c)=>e.paste&&e.paste(...c)),disabled:!e.hasClipboardContent},"Paste",8,ey)],2)])}const ny=oe(Kv,[["render",ty],["__scopeId","data-v-40e4de4a"]]);function qo(e,t,n){let o=t+n;const s=e.length;return o<0&&(o+=s),o>=s&&(o-=s),o}const Br=1280,oa=720,oy=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Tp=1,sy=1/1.5,ry=-74,iy=-26,ly=[200,240,400,493,640,786,880,1040,1080],ay=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:Br,screenHeight:oa,positions:oy,sdCharacterScaleFactor:Tp,hdCharacterScaleFactor:sy,CloseUpYOffset:ry,BaseCharacterYPos:iy,characterPositions:ly},Symbol.toStringTag,{value:"Module"}));var dy=Object.defineProperty,cy=(e,t,n)=>t in e?dy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ar=(e,t,n)=>(cy(e,typeof t!="symbol"?t+"":t,n),n);const Zn=class{constructor(e,t,n,o){this.r=e,this.g=t,this.b=n,this.a=o}static validCss(e){return this.validCssRgb(e)||this.validHex(e)}static fromCss(e){if(this.validCssRgb(e))return this.fromCssRgb(e);if(this.validHex(e))return this.fromHex(e);throw new Error("Invalid RGB color format")}static validCssRgb(e){return this.rgbEx.test(e)||this.rgbaEx.test(e)}static fromCssRgb(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");const t=e.slice(0,-1),n=t.indexOf("("),s=t.slice(n+1).split(",").map(r=>parseFloat(r.trim()));return new Zn(s[0],s[1],s[2],s.length===4?s[3]:1)}static validHex(e){return this.hexShortEx.test(e)||this.hexLongEx.test(e)}static fromHex(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");const t=e.slice(1);if(t.length===3)return new Zn(parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),1);if(t.length===4)return new Zn(parseInt(t[0]+t[0],16),parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)/255);if(t.length===6)return new Zn(parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16),1);if(t.length===8)return new Zn(parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16),parseInt(t[6]+t[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:e,g:t,b:n}=this;const{a:o}=this;e/=255,t/=255,n/=255;const s=Math.max(e,t,n),r=Math.min(e,t,n);let i,a;const l=(s+r)/2;if(s===r)i=a=0;else{const d=s-r;switch(a=l>.5?d/(2-s-r):d/(s+r),s){case e:i=(t-n)/d+(t<n?6:0);break;case t:i=(n-e)/d+2;break;case n:i=(e-t)/d+4;break}i/=6}return new be(i,a,l,o)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};let de=Zn;Ar(de,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i);Ar(de,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i);Ar(de,"hexShortEx",/^#[0-9A-Z]{3,4}$/i);Ar(de,"hexLongEx",/^#[0-9A-Z]{6,8}$/i);class be{constructor(t,n,o,s){this.h=t,this.s=n,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(t){let{h:n,s:o,l:s,a:r}=this;return n+=t.h,n>=1?n-=1:n<0&&(n+=1),o+t.s>1?o-=t.s:(o+=t.s,o<0&&(o=0)),s+t.l>1||s+t.l<0?s-=t.l:s+=t.l,r+t.a>1||r+t.a<0?r-=t.a:r+=t.a,new be(n,o,s,r)}toRgb(){const{h:t,s:n,l:o,a:s}=this;let r,i,a;if(n===0)r=i=a=o;else{const l=o<.5?o*(1+n):o+n-o*n,d=2*o-l;r=be.hue2rgb(d,l,t+1/3),i=be.hue2rgb(d,l,t),a=be.hue2rgb(d,l,t-1/3)}return new de(Math.round(r*255),Math.round(i*255),Math.round(a*255),s)}toHSL(){return this}static hue2rgb(t,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?t+(n-t)*6*o:o<1/2?n:o<2/3?t+(n-t)*(2/3-o)*6:t}}const uy=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),py="#ffe6f4",fy="#ffbde1",hy=420,gy=22,my=640,Ep=270,by=7,vy=3,yy=(oa-Ep)/2,_y={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},wy=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:uy,ChoiceButtonColor:py,ChoiceButtonBorderColor:fy,ChoiceButtonWidth:hy,ChoiceSpacing:gy,ChoiceX:my,ChoiceYOffset:Ep,ChoicePadding:by,Outline:vy,ChoiceY:yy,ChoiceTextStyle:_y},Symbol.toStringTag,{value:"Module"})),Bp="#ffa8d2",$y="#552222",Cy="#ffeef6",sa="#bb5599",Ap=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Dp=new be(.002028397565922768,0,.13725490196078438,0),Rp=.82,Fp=new be(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Mp=12,Py=1.5,ol=12,Vt=1.5,Sy=.6,ky=new be(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Oy=new be(0,-.14285714285714296,.3,0),Np=new be(.004269293924466178,-.01869158878504662,-.039215686274509665,0),sl=9.5,Wt=47,Hp=new be(.0023347701149424305,0,.10784313725490202,0),Lp=3,xy=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:Bp,controlsDefaultColor:$y,nameboxDefaultColor:Cy,nameboxStrokeDefaultColor:sa,nameboxTextOutlineDelta:Ap,nameboxBackgroundDelta:Dp,nameboxGradientMiddleStopPosition:Rp,nameboxGradientEndDelta:Fp,nameboxRounding:Mp,nameboxRoundingBuffer:Py,textboxRounding:ol,textboxRoundingBuffer:Vt,nameColorThreshold:Sy,controlColorDelta:ky,controlDisableColorDelta:Oy,dotColorDelta:Np,dotRadius:sl,dotPatternSize:Wt,textboxOutlineColorDelta:Hp,textboxOutlineWidth:Lp},Symbol.toStringTag,{value:"Module"}));var jy=Object.defineProperty,Iy=Object.defineProperties,Ty=Object.getOwnPropertyDescriptors,Hd=Object.getOwnPropertySymbols,Ey=Object.prototype.hasOwnProperty,By=Object.prototype.propertyIsEnumerable,Ld=(e,t,n)=>t in e?jy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Up=(e,t)=>{for(var n in t||(t={}))Ey.call(t,n)&&Ld(e,n,t[n]);if(Hd)for(var n of Hd(t))By.call(t,n)&&Ld(e,n,t[n]);return e},Vp=(e,t)=>Iy(e,Ty(t));const Oo=816,ra=900,Dr=146,Ay=0,Dy=29,Ry=8,ms=38,Rr=44,Fy=6,My=93,Ny=404,Hy=9,Ly=9,At=39,bs=168,vs=34,Fr=29,ia=12,la=-126,aa=-72,da=-38,ca=30.75,ua=26,Wp=426,rl=58,pa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Mr=Vp(Up({},pa),{fontName:"riffic",fontSize:24,strokeColor:sa,strokeWidth:6,color:"white",letterSpacing:1}),fa={align:"left",font:"13px aller",fill:{style:"#522"}},zp=Vp(Up({},fa),{fill:{style:"#a66"}}),Uy={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},ha={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},xo=Br/2-Oo/2,Vy=Br/2-ra/2,Wy=xo+ms,Gp=xo+vs,zy=Gp+bs/2,Gy=xo+la,qy=xo+aa,Xy=xo+da,Ky="normal",Yy=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:Oo,TextBoxCorruptedWidth:ra,TextBoxHeight:Dr,TextBoxKerning:Ay,TextBoxLineHeight:Dy,TextBoxCorruptedKerning:Ry,TextBoxTextXOffset:ms,TextBoxTextYOffset:Rr,TextBoxBottomSpacing:Fy,HdSpacing:My,HdSideMargin:Ny,TextBoxTextCorruptedXOffset:Hy,TextBoxTextCorruptedYOffset:Ly,NameboxHeight:At,NameboxWidth:bs,NameboxXOffset:vs,NameboxTextYOffset:Fr,ControlsYBottomOffset:ia,ControlsXHistoryOffset:la,ControlsXSkipOffset:aa,ControlsXStuffOffset:da,ArrowXRightOffset:ca,ArrowYBottomOffset:ua,GlowRX:Wp,GlowRY:rl,BaseTextStyle:pa,NameboxTextStyle:Mr,ControlsTextStyle:fa,ControlsTextDisabledStyle:zp,TextBoxCorruptedStyle:Uy,TextBoxStyle:ha,TextBoxX:xo,TextBoxCorruptedX:Vy,TextBoxTextX:Wy,NameboxX:Gp,NameboxTextX:zy,ControlsXHistory:Gy,ControlsXSkip:qy,ControlsXStuff:Xy,DefaultTextboxStyle:Ky},Symbol.toStringTag,{value:"Module"}));var Jy=Object.defineProperty,Zy=Object.defineProperties,Qy=Object.getOwnPropertyDescriptors,Ud=Object.getOwnPropertySymbols,e_=Object.prototype.hasOwnProperty,t_=Object.prototype.propertyIsEnumerable,Vd=(e,t,n)=>t in e?Jy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,n_=(e,t)=>{for(var n in t||(t={}))e_.call(t,n)&&Vd(e,n,t[n]);if(Ud)for(var n of Ud(t))t_.call(t,n)&&Vd(e,n,t[n]);return e},o_=(e,t)=>Zy(e,Qy(t));const s_="#ffe6f4",r_="#ffbde1",i_="rgba(255,255,255,0.6)",l_=40,a_=30,d_=o_(n_({},pa),{fontName:"riffic",fontSize:24,strokeColor:sa,strokeWidth:8,letterSpacing:1,color:"white"}),c_={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},u_=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:s_,NotificationBorderColor:r_,NotificationBackdropColor:i_,NotificationPadding:l_,NotificationSpacing:a_,NotificationOkTextStyle:d_,NotificationTextStyle:c_},Symbol.toStringTag,{value:"Module"}));var p_=Object.defineProperty,f_=Object.defineProperties,h_=Object.getOwnPropertyDescriptors,Wd=Object.getOwnPropertySymbols,g_=Object.prototype.hasOwnProperty,m_=Object.prototype.propertyIsEnumerable,zd=(e,t,n)=>t in e?p_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nn=(e,t)=>{for(var n in t||(t={}))g_.call(t,n)&&zd(e,n,t[n]);if(Wd)for(var n of Wd(t))m_.call(t,n)&&zd(e,n,t[n]);return e},on=(e,t)=>f_(e,h_(t));const qp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],b_=0,v_=0,y_=Br/2,__=oa/2,w_=33,$_=100,C_=30,P_=800,S_=720,k_=Tp,O_="#333333bf",x_=480,j_=180,I_=3,T_=7,sn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Xp=[on(nn({},sn),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),on(nn({},sn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),on(nn({},sn),{name:"Monika",fontName:"journal",fontSize:34}),on(nn({},sn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),on(nn({},sn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),on(nn({},sn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),on(nn({},sn),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),on(nn({},sn),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],E_=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:qp,defaultPoemBackground:b_,defaultPoemStyle:v_,defaultX:y_,defaultY:__,poemTopPadding:w_,poemBottomPadding:$_,poemPadding:C_,defaultPoemWidth:P_,defaultPoemHeight:S_,backgroundScale:k_,consoleBackgroundColor:O_,consoleWidth:x_,consoleHeight:j_,defaultConsoleBackground:I_,defaultConsoleStyle:T_,poemTextStyles:Xp},Symbol.toStringTag,{value:"Module"})),B_={Base:ay,Choices:wy,Notification:u_,Poem:E_,TextBox:Yy,TextBoxCustom:xy},Nr=1920,ga=1080,A_=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Kp=1.5,D_=1,R_=-111,F_=-39,M_=[300,360,600,740,960,1180,1320,1560,1620],N_=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:Nr,screenHeight:ga,positions:A_,sdCharacterScaleFactor:Kp,hdCharacterScaleFactor:D_,CloseUpYOffset:R_,BaseCharacterYPos:F_,characterPositions:M_},Symbol.toStringTag,{value:"Module"})),H_=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),L_="#ffe6f4",U_="#ffbde1",V_=630,W_=33,z_=960,Yp=405,G_=10.5,q_=4.5,X_=(ga-Yp)/2,K_={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Y_=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:H_,ChoiceButtonColor:L_,ChoiceButtonBorderColor:U_,ChoiceButtonWidth:V_,ChoiceSpacing:W_,ChoiceX:z_,ChoiceYOffset:Yp,ChoicePadding:G_,Outline:q_,ChoiceY:X_,ChoiceTextStyle:K_},Symbol.toStringTag,{value:"Module"})),Jp="#ffa8d2",J_="#552222",Z_="#ffeef6",ma="#bb5599",Zp=new be(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Qp=new be(.002028397565922768,0,.13725490196078438,0),ef=.82,tf=new be(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),nf=15,Q_=1.5,il=19,zt=1.5,ew=.6,tw=new be(.08045977011494243,-.5714285714285714,-.5960784313725489,0),nw=new be(0,-.14285714285714296,.3,0),of=new be(.004269293924466178,-.01869158878504662,-.039215686274509665,0),ll=9.5*1.5,Gt=47*1.5,sf=new be(.0023347701149424305,0,.10784313725490202,0),rf=5,ow=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:Jp,controlsDefaultColor:J_,nameboxDefaultColor:Z_,nameboxStrokeDefaultColor:ma,nameboxTextOutlineDelta:Zp,nameboxBackgroundDelta:Qp,nameboxGradientMiddleStopPosition:ef,nameboxGradientEndDelta:tf,nameboxRounding:nf,nameboxRoundingBuffer:Q_,textboxRounding:il,textboxRoundingBuffer:zt,nameColorThreshold:ew,controlColorDelta:tw,controlDisableColorDelta:nw,dotColorDelta:of,dotRadius:ll,dotPatternSize:Gt,textboxOutlineColorDelta:sf,textboxOutlineWidth:rf},Symbol.toStringTag,{value:"Module"}));var sw=Object.defineProperty,rw=Object.defineProperties,iw=Object.getOwnPropertyDescriptors,Gd=Object.getOwnPropertySymbols,lw=Object.prototype.hasOwnProperty,aw=Object.prototype.propertyIsEnumerable,qd=(e,t,n)=>t in e?sw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lf=(e,t)=>{for(var n in t||(t={}))lw.call(t,n)&&qd(e,n,t[n]);if(Gd)for(var n of Gd(t))aw.call(t,n)&&qd(e,n,t[n]);return e},af=(e,t)=>rw(e,iw(t));const ba=1220,df=900,cf=219,dw=0,cw=29,uw=8,va=57,uf=68,pw=54,fw=9,hw=9,to=59,ya=252,_a=49,pf=43,ff=12*1.5,hf=-126*1.5,gf=-72*1.5,mf=-38*1.5,bf=30.75*1.5,vf=26*1.5,yf=426*1.5,al=58*1.5,wa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},_f=af(lf({},wa),{fontName:"riffic",fontSize:36,strokeColor:ma,strokeWidth:9,color:"white",letterSpacing:2}),ar={align:"left",font:"24px aller",fill:{style:"#522"}},wf=af(lf({},ar),{fill:{style:"#a66"}}),$f={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},gw={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},jo=Nr/2-ba/2,mw=Nr/2-df/2,bw=jo+va,Cf=jo+_a,vw=Cf+ya/2,yw=jo+hf,_w=jo+gf,ww=jo+mf,$w="custom_plus",Cw=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:ba,TextBoxCorruptedWidth:df,TextBoxHeight:cf,TextBoxKerning:dw,TextBoxLineHeight:cw,TextBoxCorruptedKerning:uw,TextBoxTextXOffset:va,TextBoxTextYOffset:uf,TextBoxBottomSpacing:pw,TextBoxTextCorruptedXOffset:fw,TextBoxTextCorruptedYOffset:hw,NameboxHeight:to,NameboxWidth:ya,NameboxXOffset:_a,NameboxTextYOffset:pf,ControlsYBottomOffset:ff,ControlsXHistoryOffset:hf,ControlsXSkipOffset:gf,ControlsXStuffOffset:mf,ArrowXRightOffset:bf,ArrowYBottomOffset:vf,GlowRX:yf,GlowRY:al,BaseTextStyle:wa,NameboxTextStyle:_f,ControlsTextStyle:ar,ControlsTextDisabledStyle:wf,TextBoxStyle:$f,TextBoxCorruptedStyle:gw,TextBoxX:jo,TextBoxCorruptedX:mw,TextBoxTextX:bw,NameboxX:Cf,NameboxTextX:vw,ControlsXHistory:yw,ControlsXSkip:_w,ControlsXStuff:ww,DefaultTextboxStyle:$w},Symbol.toStringTag,{value:"Module"}));var Pw=Object.defineProperty,Sw=Object.defineProperties,kw=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,Ow=Object.prototype.hasOwnProperty,xw=Object.prototype.propertyIsEnumerable,Kd=(e,t,n)=>t in e?Pw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jw=(e,t)=>{for(var n in t||(t={}))Ow.call(t,n)&&Kd(e,n,t[n]);if(Xd)for(var n of Xd(t))xw.call(t,n)&&Kd(e,n,t[n]);return e},Iw=(e,t)=>Sw(e,kw(t));const Tw="#ffe6f4",Ew="#ffbde1",Bw="rgba(255,255,255,0.6)",Aw=60,Dw=45,Rw=Iw(jw({},wa),{fontName:"riffic",fontSize:36,strokeColor:ma,strokeWidth:12,letterSpacing:1,color:"white"}),Fw={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Mw=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:Tw,NotificationBorderColor:Ew,NotificationBackdropColor:Bw,NotificationPadding:Aw,NotificationSpacing:Dw,NotificationOkTextStyle:Rw,NotificationTextStyle:Fw},Symbol.toStringTag,{value:"Module"}));var Nw=Object.defineProperty,Hw=Object.defineProperties,Lw=Object.getOwnPropertyDescriptors,Yd=Object.getOwnPropertySymbols,Uw=Object.prototype.hasOwnProperty,Vw=Object.prototype.propertyIsEnumerable,Jd=(e,t,n)=>t in e?Nw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rn=(e,t)=>{for(var n in t||(t={}))Uw.call(t,n)&&Jd(e,n,t[n]);if(Yd)for(var n of Yd(t))Vw.call(t,n)&&Jd(e,n,t[n]);return e},ln=(e,t)=>Hw(e,Lw(t));const Ww=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],zw=0,Gw=0,qw=Nr/2,Xw=ga/2,Kw=26,Yw=150,Jw=61,Zw=1200,Qw=1080,e$=Kp,t$="#333333bf",n$=720,o$=270,s$=3,r$=7,an={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},i$=[ln(rn({},an),{name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1}),ln(rn({},an),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5}),ln(rn({},an),{name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5}),ln(rn({},an),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48}),ln(rn({},an),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12}),ln(rn({},an),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60}),ln(rn({},an),{name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53}),ln(rn({},an),{name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1})],l$=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:Ww,defaultPoemBackground:zw,defaultPoemStyle:Gw,defaultX:qw,defaultY:Xw,poemTopPadding:Kw,poemBottomPadding:Yw,poemPadding:Jw,defaultPoemWidth:Zw,defaultPoemHeight:Qw,backgroundScale:e$,consoleBackgroundColor:t$,consoleWidth:n$,consoleHeight:o$,defaultConsoleBackground:s$,defaultConsoleStyle:r$,poemTextStyles:i$},Symbol.toStringTag,{value:"Module"})),a$={Base:N_,Choices:Y_,Notification:Mw,Poem:l$,TextBox:Cw,TextBoxCustom:ow};function J(){return X.gameMode==="ddlc_plus"?a$:B_}function Io(){return{flip:!1,rotation:0,version:0,opacity:100,x:J().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,zoom:1}}var d$=Object.defineProperty,c$=Object.defineProperties,u$=Object.getOwnPropertyDescriptors,Zd=Object.getOwnPropertySymbols,p$=Object.prototype.hasOwnProperty,f$=Object.prototype.propertyIsEnumerable,Qd=(e,t,n)=>t in e?d$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dr=(e,t)=>{for(var n in t||(t={}))p$.call(t,n)&&Qd(e,n,t[n]);if(Zd)for(var n of Zd(t))f$.call(t,n)&&Qd(e,n,t[n]);return e},h$=(e,t)=>c$(e,u$(t)),g$=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const m$={setPose(e,t){const n=e.panels[t.panelId].objects[t.id];n.poseId=t.poseId,++n.version},setCharStyleGroup(e,{id:t,panelId:n,styleGroupId:o}){const s=e.panels[n].objects[t];s.styleGroupId=o,++s.version},setCharStyle(e,{id:t,panelId:n,styleId:o}){const s=e.panels[n].objects[t];s.styleId=o,++s.version},setClose(e,t){const n=e.panels[t.panelId].objects[t.id];n.close=t.close,++n.version},setPosePosition(e,t){const n=e.panels[t.panelId].objects[t.id];n.posePositions=dr(dr({},n.posePositions),t.posePositions),++n.version},setFreeMove(e,t){const n=e.panels[t.panelId].objects[t.id];if(n.freeMove=t.freeMove,!n.freeMove){const o=J();n.x=o.Base.characterPositions[ur(n.x)],n.y=o.Base.BaseCharacterYPos}}};function Hr(e,t){return e.getters["content/getCharacters"].get(t.characterType)}function jn(e,t){return e["content/getCharacters"].get(t)}function mn(e,t){return e.styleGroups[t.styleGroupId].styles[t.styleId].poses[t.poseId]}function b$(e,t){const n=mn(e,t),o=[...Object.keys(n.positions).filter(s=>n.positions[s].length>1)];return n.compatibleHeads.length>0&&o.unshift("head"),o}function cr(e,t,n=t.posePositions.headType||0){const o=mn(e,t).compatibleHeads;return o.length===0?null:e.heads[o[n]]}function ur(e){return J().Base.characterPositions.map((o,s)=>({pos:Math.abs(e-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}const v$={createCharacters({rootState:e,rootGetters:t,commit:n,state:o},s){var r;const i=o.panels[s.panelId].lastObjId+1,a=J(),l=jn(t,s.characterType),d=l.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;return n("create",{object:h$(dr({},Io()),{id:i,panelId:e.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,preserveRatio:!0,ratio:1,width:l.size[0]*l.defaultScale[0]*d,height:l.size[1]*l.defaultScale[1]*d,characterType:s.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:(r=l.label)!=null?r:l.id,enlargeWhenTalking:e.ui.defaultCharacterTalkingZoom})}),i},seekPart({state:e,commit:t,dispatch:n,rootGetters:o},{delta:s,id:r,panelId:i,part:a}){if(a==="head"){n("seekHead",{id:r,panelId:i,delta:s});return}const l=e.panels[i].objects[r],d=mn(jn(o,l.characterType),l);!d.positions[a]||t("setPosePosition",{id:r,panelId:i,posePositions:{[a]:qo(d.positions[a],l.posePositions[a]||0,s)}})},seekPose({state:e,commit:t,rootGetters:n},{id:o,panelId:s,delta:r}){const i=e.panels[s].objects[o],a=jn(n,i.characterType),l=a.styleGroups[i.styleGroupId].styles[i.styleId].poses;Gn(t,i,a,d=>{d.poseId=qo(l,d.poseId,r)})},seekStyle({state:e,commit:t,rootGetters:n},{id:o,panelId:s,delta:r}){const i=e.panels[s].objects[o],a=jn(n,i.characterType),l=a.styleGroups.flatMap((c,p)=>c.styles.map((f,b)=>({styleGroupIdx:p,styleIdx:b,styleGroupJson:JSON.stringify(f.components)}))).sort((c,p)=>c.styleGroupJson.localeCompare(p.styleGroupJson)),d=l.findIndex(c=>c.styleGroupIdx===i.styleGroupId&&c.styleIdx===i.styleId);Gn(t,i,a,c=>{const p=qo(l,d,r),f=l[p];c.styleGroupId=f.styleGroupIdx,c.styleId=f.styleIdx})},seekHead({state:e,commit:t,rootGetters:n},{id:o,panelId:s,delta:r}){const i=e.panels[s].objects[o],a=jn(n,i.characterType),l=mn(a,i);let d=cr(a,i);if(!d)return;let c=(i.posePositions.head||0)+r,p=i.posePositions.headType||0;(c<0||c>=d.variants.length)&&(p=qo(l.compatibleHeads.map(f=>a.heads[f]),p,r),d=cr(a,i,p),c=r===1?0:d.variants.length-1),t("setPosePosition",{id:o,panelId:s,posePositions:{head:c,headType:p}})},setPart({state:e,commit:t,rootGetters:n},{panelId:o,id:s,part:r,val:i}){const a=e.panels[o].objects[s],l=jn(n,a.characterType);r==="pose"?Gn(t,a,l,d=>{d.poseId=i}):r==="style"?Gn(t,a,l,d=>{d.styleId=i}):Gn(t,a,l,d=>{d.posePositions[r]=i})},setCharStyle({state:e,commit:t,rootGetters:n},{panelId:o,id:s,styleGroupId:r,styleId:i}){const a=e.panels[o].objects[s],l=jn(n,a.characterType);Gn(t,a,l,d=>{d.styleGroupId=r,d.styleId=i})},setCharacterPosition({state:e,commit:t},{panelId:n,id:o,x:s,y:r}){const i=e.panels[n].objects[o];if(!i.freeMove){const a=J();s=a.Base.characterPositions[ur(s)],r=a.Base.BaseCharacterYPos+(i.close?a.Base.CloseUpYOffset:0)}i.x===s&&i.y===r||t("setPosition",{panelId:n,id:o,x:s,y:r})},shiftCharacterSlot({state:e,commit:t},{panelId:n,id:o,delta:s}){const r=e.panels[n].objects[o],i=J();let l=ur(r.x)+s;l<0&&(l=0),l>=i.Base.characterPositions.length&&(l=i.Base.characterPositions.length-1),t("setPosition",{panelId:n,id:o,x:i.Base.characterPositions[l],y:r.y})}};function y$(e,t,n,o){return g$(this,null,function*(){const s=e.state.panels[t].objects[n],r=o.characters.find(j=>j.id===s.characterType);if(!r){console.error("Character data is missing. Dropping the character."),yield e.dispatch("removeObject",{id:n,panelId:t});return}const i=Pf(s),a=r.styleGroups[s.styleGroupId],l=a.styles[i.styleId],d=l.poses[i.poseId],c=e.rootState.content.current.characters.find(j=>j.id===r.id);if(!c){console.error("Character data is missing. Dropping the character."),yield e.dispatch("removeObject",{id:n,panelId:t});return}const p=c.styleGroups.findIndex(j=>j.id===a.id);i.styleGroupId=p===-1?0:p;const f=c.styleGroups[i.styleGroupId],b=JSON.stringify(l.components),v=f.styles.findIndex(j=>JSON.stringify(j.components)===b);i.styleId=v===-1?0:v;const $=f.styles[i.styleId],M=$.poses.findIndex(j=>j.id===d.id);i.poseId=M===-1?0:M;const R=$.poses[i.poseId];for(const j in R.positions){if(!R.positions.hasOwnProperty(j))continue;const Y=R.positions[j];if(d.positions[j]){const ee=i.posePositions[j];ee>=0&&ee<Y.length}}const w=d.compatibleHeads[s.posePositions.headType],x=R.compatibleHeads.indexOf(w);if(x===-1)i.posePositions.headType=0,i.posePositions.head=0;else{x!==s.posePositions.headType&&(i.posePositions.headType=x);const j=JSON.stringify(r.heads[w].variants[s.posePositions.head]),Y=c.heads[w].variants.findIndex(ee=>JSON.stringify(ee)===j);Y===-1?i.posePositions.head=0:i.posePositions.head=Y}Sf(e.commit,s,i)})}function Pf(e){return{styleGroupId:e.styleGroupId,styleId:e.styleId,poseId:e.poseId,posePositions:dr({},e.posePositions)}}function Sf(e,t,n){n.styleGroupId!==t.styleGroupId&&e("setCharStyleGroup",{id:t.id,panelId:t.panelId,styleGroupId:n.styleGroupId}),n.styleId!==t.styleId&&(console.log(`Setting style of ${t.id} to ${n.styleId}`),e("setCharStyle",{id:t.id,panelId:t.panelId,styleId:n.styleId})),n.poseId!==t.poseId&&e("setPose",{id:t.id,panelId:t.panelId,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(t.posePositions)&&e("setPosePosition",{id:t.id,panelId:t.panelId,posePositions:n.posePositions})}function Gn(e,t,n,o){const s=Pf(t);o(s),n.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=n.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const i=r.styles[s.styleId];i.poses[s.poseId]||(s.poseId=0);const a=i.poses[s.poseId];for(const p in a.positions)!a.positions[p]||a.positions[p][s.posePositions[p]]||(s.posePositions[p]=0);const d=n.styleGroups[t.styleGroupId].styles[t.styleId].poses[t.poseId].compatibleHeads[t.posePositions.headType||0],c=a.compatibleHeads.indexOf(d);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),Sf(e,t,s)}const _$=te({props:{title:{required:!0,type:String}}});const w$={class:"fieldset_wrapper"},$$={key:0},C$={class:"fieldset_contents"};function P$(e,t,n,o,s,r){return g(),y("div",w$,[u("fieldset",null,[e.title>""?(g(),y("legend",$$,he(e.title),1)):K("",!0),u("div",C$,[Xt(e.$slots,"default",{},void 0,!0)])])])}const Mt=oe(_$,[["render",P$],["__scopeId","data-v-4c2ec328"]]);var S$=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const ec=960,k$=te({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:()=>({lookups:[],loaded:!1}),computed:{scaleX(){return this.size/this.part.size[0]},scaleY(){return this.size/this.part.size[1]},backgroundSize(){return`${Math.floor(ec*this.scaleX)}px ${Math.floor(ec*this.scaleY)}px`},backgroundPosition(){return`${Math.floor(this.part.offset[0]*-this.scaleX)}px ${Math.floor(this.part.offset[1]*-this.scaleY)}px`},background(){var e,t;let n="";const o=this.backgroundSize,s=(e=this.part.offset)!=null?e:[0,0];for(let r=0;r<this.part.images.length;++r){const i=this.part.images[r],a=this.lookups[r];if(!a)continue;r>0&&(n+=", ");const l=(t=i.offset)!=null?t:[0,0],d=`${Math.floor((s[0]-l[0])*-this.scaleX)}px ${Math.floor((s[1]-l[1])*-this.scaleY)}px`;n+=`url('${a.replace("'","\\'")}') ${d} / ${o}`}return n},style(){return{height:this.size+"px",width:this.size+"px",background:this.background}}},created(){return S$(this,null,function*(){this.lookups=yield Promise.all(this.part.images.map(e=>typeof e.asset=="string"?Ab(e.asset,!1):Mn(e.asset,!1)))})},methods:{quickClick(e){e.preventDefault(),this.$emit("quick-click")}}});function O$(e,t,n,o,s,r){var i;return g(),y("div",{class:fe({part:!0,active:(i=e.part)==null?void 0:i.active}),style:Be(e.style),tabindex:"0",onClick:t[0]||(t[0]=a=>e.$emit("click")),onContextmenu:t[1]||(t[1]=(...a)=>e.quickClick&&e.quickClick(...a)),onKeydown:[t[2]||(t[2]=Ue(q(a=>e.$emit("click"),["prevent"]),["enter"])),t[3]||(t[3]=Ue(q((...a)=>e.quickClick&&e.quickClick(...a),["prevent"]),["space"]))]},null,38)}const x$=oe(k$,[["render",O$],["__scopeId","data-v-037b2b66"]]);var j$=Object.defineProperty,I$=Object.defineProperties,T$=Object.getOwnPropertyDescriptors,tc=Object.getOwnPropertySymbols,E$=Object.prototype.hasOwnProperty,B$=Object.prototype.propertyIsEnumerable,nc=(e,t,n)=>t in e?j$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,A$=(e,t)=>{for(var n in t||(t={}))E$.call(t,n)&&nc(e,n,t[n]);if(tc)for(var n of tc(t))B$.call(t,n)&&nc(e,n,t[n]);return e},D$=(e,t)=>I$(e,T$(t));const R$=te({mixins:[ea],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.$store.state.ui.vertical?"vertical":"horizontal":this.direction==="inverted"?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render(){const e=this.noWraping?"no-wraping":"wraping",n=ad("div",D$(A$({},{}),{class:["d-flow",this.finalDirection,e],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize!==void 0){const o=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return ad("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:o}},[n])}return n},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});const ys=oe(R$,[["__scopeId","data-v-4268a65b"]]);var oc=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const F$=te({components:{PartButton:x$,DFieldset:Mt,DFlow:ys},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:()=>({isWebPSupported:null,stylePriorities:[]}),computed:{vertical(){return this.$store.state.ui.vertical},styleComponents(){if(this.part!=="style")return[];const e=this.charData.styleGroups[this.character.styleGroupId];return e.styleComponents.map(t=>{const n={};for(const o in t.variants){if(!t.variants.hasOwnProperty(o))continue;const s=t.variants[o];n[o]={size:e.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:s}],active:!1}}return{label:t.label,name:t.id,buttons:n}})},parts(){const e={};let t,n,o;const s=this.charData,r=mn(s,this.character);switch(this.part){case"head":const i=this.character.posePositions.headType||0,a=this.character.posePositions.head||0;for(let d=0;d<r.compatibleHeads.length;++d){const c=r.compatibleHeads[d],p=s.heads[c];for(let f=0;f<p.variants.length;++f){const b=p.variants[f];e[`${d}_${f}`]={size:p.previewSize,offset:p.previewOffset,images:b.map(v=>({asset:v,offset:[0,0]})),active:a===f&&i===d}}}return e;case"pose":const l=s.styleGroups[this.character.styleGroupId].styles[this.character.styleId];for(let d=0;d<l.poses.length;++d){const c=l.poses[d];e[d]=this.generatePosePreview(c),e[d].active=d===this.character.poseId}return e;case"style":for(let d=0;d<s.styleGroups.length;++d){const c=s.styleGroups[d];e[c.id]=this.generatePosePreview(c.styles[0].poses[0]),e[c.id].active=d===this.character.styleGroupId}return e;default:t=r.positions[this.part],o=r.previewSize,n=r.previewOffset;break}for(let i=0;i<t.length;++i){const a=t[i];e[i]={images:a.map(l=>({offset:[0,0],asset:l})),size:o,offset:n,active:i===(this.character.posePositions[this.part]||0)}}return e},charData(){return Hr(this.$store,this.character)}},methods:{updateStyleData(){const e=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(e.components).map(t=>[t,e.components[t]])},generatePosePreview(e){const t=this.charData;let n=[];for(const o of e.renderCommands)switch(o.type){case"pose-part":const s=e.positions[o.part];if(s==null||s.length===0)break;n=n.concat(s[0].map(a=>({asset:a,offset:o.offset})));break;case"head":const r=t.heads[e.compatibleHeads[0]];if(e.compatibleHeads.length===0)break;const i=r.variants[0];n=n.concat(i.map(a=>({asset:a,offset:o.offset})));break;case"image":n=n.concat(o.images.map(a=>({asset:a,offset:o.offset})));break}return{images:n,size:e.previewSize,offset:e.previewOffset,active:!1}},updatePose(e){e==null&&(e=this.character.styleGroupId);const n=this.charData.styleGroups[e];let o=n.styles;for(const s of this.stylePriorities){const r=o.filter(i=>i.components[s[0]]===s[1]);r.length>0&&(o=r)}A(()=>oc(this,null,function*(){yield this.$store.dispatch("panels/setCharStyle",{id:this.character.id,panelId:this.character.panelId,styleGroupId:e,styleId:n.styles.indexOf(o[0])})}))},choose(e){if(this.part==="style")this.updatePose(this.charData.styleGroups.findIndex(t=>t.id===e));else if(this.part==="head"){const[t,n]=e.split("_",2).map(o=>parseInt(o,10));this.$store.commit("panels/setPosePosition",{id:this.character.id,panelId:this.character.panelId,posePositions:{headType:t,head:n}})}else this.setPart(this.part,parseInt(e,10))},choose_component(e,t){const n=this.stylePriorities.findIndex(o=>o[0]===e);this.stylePriorities.splice(n,1),this.stylePriorities.unshift([e,t]),this.updatePose()},onKeydown(e){(e.key==="Backspace"||e.key==="Escape")&&(this.$emit("leave"),e.preventDefault(),e.stopPropagation())},setPart(e,t){A(()=>{this.$store.dispatch("panels/setPart",{id:this.character.id,panelId:this.character.panelId,part:e,val:t})})}},created(){return oc(this,null,function*(){this.updateStyleData(),this.isWebPSupported=yield mo()})},watch:{character(){this.updateStyleData()}}});const $n=e=>(Ge("data-v-95a67c67"),e=e(),qe(),e),M$=$n(()=>u("i",{class:"material-icons"},"extension",-1)),N$=$n(()=>u("span",{class:"text-block"},"Create new expressions",-1)),H$=[M$,N$],L$=$n(()=>u("i",{class:"material-icons"},"extension",-1)),U$=$n(()=>u("span",{class:"text-block"},"Search in content packs",-1)),V$=[L$,U$],W$=$n(()=>u("i",{class:"material-icons"},"extension",-1)),z$=$n(()=>u("span",null,"Search in content packs",-1)),G$=[W$,z$],q$=$n(()=>u("i",{class:"material-icons"},"extension",-1)),X$=$n(()=>u("span",null,"Search in content packs",-1)),K$=[q$,X$];function Y$(e,t,n,o,s,r){const i=E("part-button"),a=E("d-flow"),l=E("d-fieldset");return g(),U(a,{"no-wraping":"",onKeydown:e.onKeydown},{default:B(()=>[u("button",{onClick:t[0]||(t[0]=d=>e.$emit("leave"))},"Back"),e.part==="head"?(g(),y("button",{key:0,onClick:t[1]||(t[1]=d=>e.$emit("show-expression-dialog",{character:e.character.characterType})),class:"icon-button"},H$)):K("",!0),e.part==="head"?(g(),y("button",{key:1,onClick:t[2]||(t[2]=d=>e.$emit("show-dialog","type: Expressions character: "+e.charData.label)),class:"icon-button"},V$)):e.part==="style"?(g(),y("button",{key:2,onClick:t[3]||(t[3]=d=>e.$emit("show-dialog","type: Styles character: "+e.charData.label)),class:"icon-button"},G$)):(g(),y("button",{key:3,onClick:t[4]||(t[4]=d=>e.$emit("show-dialog","type: Poses character: "+e.charData.label)),class:"icon-button"},K$)),(g(!0),y(V,null,Pe(e.parts,(d,c)=>(g(),U(i,{key:c,value:c,part:d,onClick:p=>{e.choose(c),e.$emit("leave")},onQuickClick:p=>e.choose(c)},null,8,["value","part","onClick","onQuickClick"]))),128)),(g(!0),y(V,null,Pe(e.styleComponents,d=>(g(),U(l,{key:d.name,title:d.label},{default:B(()=>[C(a,{noWraping:""},{default:B(()=>[(g(!0),y(V,null,Pe(d.buttons,(c,p)=>(g(),U(i,{size:130,key:p,value:p,part:c,onClick:f=>e.choose_component(d.name,p)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1},8,["onKeydown"])}const J$=oe(F$,[["render",Y$],["__scopeId","data-v-95a67c67"]]);function _s(){return function(t,n,o=!1){return{get(){return this.object[t]},set(s){A(()=>{this.$store[o?"dispatch":"commit"](n,{panelId:this.object.panelId,id:this.object.id,[t]:s})})}}}}function $a(e){return function(n){return{get(){return this.object[n]},set(o){A(()=>{this.$store.commit(e,{panelId:this.object.panelId,id:this.object.id,key:n,value:o})})}}}}var Z$=Object.defineProperty,Q$=(e,t,n)=>t in e?Z$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,e0=(e,t,n)=>(Q$(e,typeof t!="symbol"?t+"":t,n),n);const sc=5;class t0{constructor(t){this.str=t,e0(this,"pos",0)}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-sc),this.pos+sc)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function rc(e,t=!0){const n=[],o=new t0(e);let s=Lr;for(;s!==Ur;){const r=o.pos;try{s=s(n,o)}catch(i){if(t&&s!==dl)o.pos=r,s=(a,l)=>dl(a,l,!0);else throw i}}return n}function Lr(e,t){return t.current()===void 0?Ur:t.current()==="{"?n0:t.current()===`
`?o0:dl}function Ur(){return Ur}function dl(e,t,n=!1){const{pos:o}=t;let s="",r=n,i;for(;;){if(t.current()===void 0){i=Ur;break}else if(r)s+=t.current(),r=!1;else if(t.current()==="\\")r=!0;else if(t.current()==="{"||t.current()===`
`){i=Lr;break}else s+=t.current();t.next()}return e.push({type:"text",pos:o,content:s}),i}function gi(e,t){throw new Error(`Error when parsing text at position ${e.pos}: (around: "${e.around}") ${t}`)}function n0(e,t){const{pos:n}=t;if(t.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=t.next()==="/";o&&t.next();let s="",r="",i=!1;for(;t.current()===void 0&&gi(t,"Unexpected end of text inside a command"),t.current()!=="}";)i?r+=t.current():t.current().match(/[a-z]/i)?s+=t.current():t.current()==="="?(o&&gi(t,"Closing commands may not contain arguments"),i=!0):gi(t,`Unexpected character '${t.current()}' in command name.`),t.next();return t.next(),o?e.push({type:"commandClose",commandName:s,pos:n}):e.push({type:"command",pos:n,argument:r,commandName:s}),Lr}function o0(e,t){return e.push({type:"newline",pos:t.pos}),t.next(),Lr}var s0=Object.defineProperty,r0=Object.defineProperties,i0=Object.getOwnPropertyDescriptors,ic=Object.getOwnPropertySymbols,l0=Object.prototype.hasOwnProperty,a0=Object.prototype.propertyIsEnumerable,lc=(e,t,n)=>t in e?s0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tt=(e,t)=>{for(var n in t||(t={}))l0.call(t,n)&&lc(e,n,t[n]);if(ic)for(var n of ic(t))a0.call(t,n)&&lc(e,n,t[n]);return e},nt=(e,t)=>r0(e,i0(t));const ac=new Map([qn("i",e=>nt(tt({},e),{isItalic:!0})),qn("b",e=>nt(tt({},e),{isBold:!0})),qn("u",e=>nt(tt({},e),{isUnderlined:!0})),qn("s",e=>nt(tt({},e),{isStrikethrough:!0})),qn("plain",e=>nt(tt({},e),{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),qn("edited",e=>nt(tt({},e),{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),Rs("k",(e,t,n)=>nt(tt({},e),{letterSpacing:t?e.letterSpacing+n:n})),Rs("size",(e,t,n)=>nt(tt({},e),{fontSize:t?e.fontSize+n:n})),Rs("alpha",(e,t,n)=>nt(tt({},e),{alpha:t?e.alpha+n:n})),Rs("stroke",(e,t,n)=>nt(tt({},e),{strokeWidth:t?e.strokeWidth+n:n})),["font",(e,t)=>nt(tt({},e),{fontName:t})],["color",(e,t)=>nt(tt({},e),{color:t})],["outlinecolor",(e,t)=>nt(tt({},e),{strokeColor:t})]]);function qn(e,t){return[e,(n,o)=>{if(o!=="")throw new Error(`Operator '${e}' does not take any arguments.`);return t(n)}]}function Rs(e,t){return[e,(n,o)=>{if(o=="")throw new Error(`Operator '${e}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${e}' needs a numeric argument.`);return t(n,s,r)}]}var De=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_t={},kf={};Object.defineProperty(kf,"__esModule",{value:!0});var ct={};Object.defineProperty(ct,"__esModule",{value:!0});ct.createFactoryWithConstraint=ct.isExact=ct.noop=ct.assert=ct.UnreachableCaseError=void 0;class d0 extends Error{constructor(t){super(`Unreachable case: ${t}`)}}ct.UnreachableCaseError=d0;function c0(e,t="no additional info provided"){if(!e)throw new Error("Assertion Error: "+t)}ct.assert=c0;function u0(...e){}ct.noop=u0;const p0=()=>e=>e;ct.isExact=p0;const f0=()=>e=>e;ct.createFactoryWithConstraint=f0;var Of={};Object.defineProperty(Of,"__esModule",{value:!0});(function(e){var t=De&&De.__createBinding||(Object.create?function(o,s,r,i){i===void 0&&(i=r);var a=Object.getOwnPropertyDescriptor(s,r);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,i,a)}:function(o,s,r,i){i===void 0&&(i=r),o[i]=s[r]}),n=De&&De.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(kf,e),n(ct,e),n(Of,e)})(_t);function bo(e){e.width=0,e.height=0,Ca.delete(e.disposalId||0)}function us(){const e=document.createElement("canvas");return g0(e),e}const Ca=new Map;let h0=0;function g0(e){e.disposalId=h0++,typeof WeakRef!="undefined"&&Ca.set(e.disposalId,new WeakRef(e))}window.addEventListener("unload",()=>{Ca.forEach(e=>{const t=e.deref();!t||bo(t)})});var m0=Object.defineProperty,b0=(e,t,n)=>t in e?m0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mi=(e,t,n)=>(b0(e,typeof t!="symbol"?t+"":t,n),n),v0=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class ut{constructor(t,n){this.str=t,this.baseStyle=n,mi(this,"renderParts"),mi(this,"tokens"),mi(this,"loose"),this.loose=X.state.looseTextParsing;try{this.tokens=rc(t,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=ut.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){return v0(this,null,function*(){if(!("fonts"in document))return;const t=new Set;let n=null;for(const s of this.renderParts)"style"in s&&s.style!==n&&(n=s.style,n.fontName&&t.add(n.fontName));let o=!1;for(const s of t){const r=document,i=`8px ${s}`;r.fonts.check(i)||(o=!0,yield r.fonts.load(i))}if(o){const s=rc(this.str);this.renderParts=ut.getRenderParts(s,this.baseStyle,this.loose)}})}render(t){t.save();let n=null;for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,cl(n,t)),n.strokeWidth>0&&n.strokeColor>""&&t.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,cl(n,t)),t.fillText(o.character,o.x,o.y));t.restore()}quote(){let t;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(t||(t={}));let n=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const i=this.renderParts[r];if(i.type==="character")switch(o){case 0:if(i.character.match(/\s/))continue;i.character==='"'?(o=1,n=r):i.character==="*"?(o=3,n=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Lo(i.style,'"')}),r++,n=r,o=2);break;case 1:n=r,i.character==='"'&&(o=0);break;case 2:if(i.character.match(/\s/))continue;i.character==="*"&&(this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Lo(i.style,'"')}),o=3,r++),n=r;break;case 3:i.character==="*"&&(o=0),n=r;break;default:throw new _t.UnreachableCaseError(o)}}const s=this.renderParts[n];s&&o===3&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:Lo(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:Lo(s.style,'"')})}fixAlignment(t,n,o,s,r){let i=0,a=[];function l(){let v=n;t==="center"?v=n+(o-n)/2-i/2:t==="right"&&(v=o-i);for(const $ of a)$.x=v,v+=$.width}let d=this.renderParts;r>0&&(d=ut.applyLineWrapping(this.renderParts.slice(0),r));let c=s;const p=[];let f=0;for(const v of d)f=Math.max(f,v.height),v.type==="newline"&&(p.push(f),f=0);p.push(f);let b=0;for(const v of d)if(f=Math.max(f,v.height),v.y=c,a.push(v),i+=v.width,v.type==="newline")l(),c+=p[++b]||0,i=0,f=0,a=[];else if(v.type==="character"){const $=a[a.length-1];$.type==="character"&&(i+=$.style.letterSpacing,$.width+=$.style.letterSpacing)}l()}getHeight(t){let n=0,o=0;const s=t===0?this.renderParts:ut.applyLineWrapping(this.renderParts.slice(0),t);for(const r of s)n=Math.max(n,r.height),r.type==="newline"&&(o+=n,n=0);return o+=n,o}getWidth(){let t=0,n=0,o=null;for(const s of this.renderParts)t+=s.width,s.type==="newline"?(n=Math.max(n,t),t=0,o=null):s.type==="character"&&(o&&o.type==="character"&&(t+=o.style.letterSpacing),o=s);return n=Math.max(n,t),n}static getRenderParts(t,n,o){const s=[],r=[],i=[];let a=uc(n),l=n,d=null;function c(p){for(const f of p)s.push({type:"character",character:f,height:a,width:Lo(l,f),style:l,x:0,y:0})}for(const p of t){const f=p.type;switch(f){case"command":if(ac.has(p.commandName))r.push(l),i.push(d),l=ac.get(p.commandName)(l,p.argument),a=uc(l),d=p;else if(o)c("{"+p.commandName+"}");else throw new Error(`There is no text command called '${p.commandName}' at position ${p.pos}.`);break;case"commandClose":if(!d)if(o){c("{/"+p.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${p.pos}. Closed '${p.commandName}', but no commands are currently open.`);if(p.commandName!==d.commandName)if(o){c("{/"+p.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${p.pos}. Closed '${p.commandName}', expected to close '${d}' first. (Opened at position ${d.pos})`);d=i.pop(),l=r.pop();break;case"newline":s.push({height:a,width:0,x:0,y:0,type:"newline"});break;case"text":c(p.content);break;default:throw new _t.UnreachableCaseError(f)}}return s}static applyLineWrapping(t,n){let o=-1,s=0,r=0;const i=[];for(const a of t)if(a.type==="newline")o=-1,s=0,r=0,i.push(a);else if(a.type==="character")a.character===" "?s>n?(o=-1,s=0,r=0,i.push({type:"newline",height:a.height,width:0,x:0,y:0})):(s+=a.width,r=s,o=i.length,i.push(a)):(s+=a.width,s>n&&o!==-1&&(s-=r,i.splice(o,1,{type:"newline",height:a.height,width:0,x:0,y:0}),o=-1,r=0),i.push(a));else throw new _t.UnreachableCaseError(a);return i}}const Pa=us();Pa.width=0;Pa.height=0;const dc=Pa.getContext("2d");let cc=null;function Lo(e,t){return e!==cc&&(cl(e,dc),cc=e),dc.measureText(t).width}const bi=new Map;function uc(e){const t=e.fontSize+" "+e.fontName;if(bi.has(t))return bi.get(t)*e.lineSpacing;const n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=e.fontName,n.style.fontSize=`${e.fontSize}px`,n.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=e.fontName,o.style.fontSize=`${e.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(n),document.body.appendChild(o);try{const s=o.offsetHeight;return bi.set(t,s),s*e.lineSpacing}finally{o.remove()}}function cl(e,t){t.textAlign="left",t.font=(e.isItalic?"italic ":"")+(e.isBold?"bold ":"")+e.fontSize+"px "+e.fontName,t.lineJoin="round",e.strokeWidth>0&&e.strokeColor>""?(t.strokeStyle=e.strokeColor,t.lineWidth=e.strokeWidth):(t.strokeStyle="",t.lineWidth=0),t.globalAlpha=e.alpha||0,t.fillStyle=e.color}class Qn{}var y0=Object.defineProperty,pc=Object.getOwnPropertySymbols,_0=Object.prototype.hasOwnProperty,w0=Object.prototype.propertyIsEnumerable,ul=(e,t,n)=>t in e?y0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Uo=(e,t)=>{for(var n in t||(t={}))_0.call(t,n)&&ul(e,n,t[n]);if(pc)for(var n of pc(t))w0.call(t,n)&&ul(e,n,t[n]);return e},$0=(e,t,n)=>(ul(e,typeof t!="symbol"?t+"":t,n),n),C0=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class vo{constructor(t,n,o,s){this.canvas=t,this.fsCtx=n,this.hq=o,this.preview=s,$0(this,"aborted",!1)}static make(t,n,o){return new vo(t,t.getContext("2d"),n,o)}static makeWithContext(t,n,o,s){return new vo(t,n,o,s)}drawText(t){if(this.aborted)throw new Qn;this.fsCtx.save();const{font:n,align:o,x:s=0,y:r=0,text:i=""}=Uo(Uo({},{font:"20px aller",align:"left"}),t);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(i,s,r)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(i,s,r)),this.fsCtx.restore()}measureText(t){if(this.aborted)throw new Qn;this.fsCtx.save();const{font:n,align:o,text:s=""}=Uo(Uo({},{font:"20px aller",align:"left"}),t);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(t){if(this.aborted)throw new Qn;const{image:n,flip:o,x:s,y:r,w:i,h:a,filters:l,composite:d}=Uo({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t);if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=d,l)if("filter"in this.fsCtx){const c=[];for(const p of l)p.type==="drop-shadow"?c.push(`drop-shadow(${p.offsetX}px ${p.offsetY}px ${p.blurRadius}px ${p.color})`):p.type==="hue-rotate"?c.push(`hue-rotate(${p.value}deg)`):p.type==="blur"?c.push(`blur(${p.value}px)`):c.push(`${p.type}(${p.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const p of l)p.type==="opacity"&&(c*=p.value);this.fsCtx.globalAlpha=c}if(t.shadow){const c=t.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(t.rotation!=null&&t.rotation!==0){const c=t.rotationAnchor?t.rotationAnchor.x:0,p=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(c,p),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-c,-p)}this.fsCtx.translate(s+i/2,r+a/2),this.fsCtx.scale(o?-1:1,1),n.paintOnto(this.fsCtx,{x:-i/2,y:-a/2,w:i,h:a}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:t,y:n,w:o,h:s,outline:r,fill:i,composition:a,rotation:l,rotationAnchor:d}){if(this.aborted)throw new Qn;if(this.fsCtx.save(),l!=null&&l!==0){const c=d?d.x:0,p=d?d.y:0;d&&this.fsCtx.translate(c,p),this.fsCtx.rotate(l),d&&this.fsCtx.translate(-c,-p)}this.fsCtx.beginPath(),this.fsCtx.rect(t,n,o,s),a&&(this.fsCtx.globalCompositeOperation=a),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:t,fill:n,path:o}){if(this.aborted)throw new Qn;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),t&&(this.fsCtx.strokeStyle=t.style,this.fsCtx.lineWidth=t.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(t,n="repeat"){return t instanceof ws&&(t=t.previewCanvas),this.fsCtx.createPattern(t,n)}customTransform(t,n){return C0(this,null,function*(){this.fsCtx.save(),yield t(this.fsCtx),yield n(this),this.fsCtx.restore()})}linearGradient(t,n,o,s){return this.fsCtx.createLinearGradient(t,n,o,s)}applyFilters(t){if(t.length===0)return;this.fsCtx.save();let n=1;for(const o of t)o.type==="opacity"&&(n*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of t)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),n!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${n})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}var P0=Object.defineProperty,S0=(e,t,n)=>t in e?P0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vi=(e,t,n)=>(S0(e,typeof t!="symbol"?t+"":t,n),n),Fs=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class ws{constructor(t,n){vi(this,"previewCanvas"),vi(this,"runningContext",null),vi(this,"_disposed",!1);const o=J();this.previewCanvas=us(),this.previewCanvas.width=t!=null?t:o.Base.screenWidth,this.previewCanvas.height=n!=null?n:o.Base.screenHeight}get disposed(){return this._disposed}render(t,n=!0,o=!0){return Fs(this,null,function*(){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=vo.makeWithContext(this.previewCanvas,s,n,o);try{yield t(this.runningContext)}catch(i){if(i instanceof Qn)return!1;throw i}finally{r===this.runningContext&&(this.runningContext=null)}return!0})}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(t,n){n.w!=null&&n.h!=null?t.drawImage(this.previewCanvas,n.x,n.y,n.w,n.h):t.drawImage(this.previewCanvas,n.x,n.y)}download(t,n){return Fs(this,null,function*(){const o=yield this.drawToCanvas(t);return yield X.saveToFile(o,n)})}renderToBlob(t){return Fs(this,null,function*(){const n=yield this.drawToCanvas(t);return yield new Promise((o,s)=>{n.toBlob(r=>{r?o(r):s()})})})}drawToCanvas(t){return Fs(this,null,function*(){const n=us();n.width=this.previewCanvas.width,n.height=this.previewCanvas.height;const o=n.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),yield t(vo.makeWithContext(n,o,!0,!1)),n})}dispose(){this.runningContext&&this.runningContext.abort(),bo(this.previewCanvas),this._disposed=!0}getDataAt(t,n){return this.previewCanvas.getContext("2d").getImageData(t,n,1,1).data}}function pr(e,t,n,o,s){const r=Math.cos(s),i=Math.sin(s),a=e-n,l=t-o,d=r*a-i*l+n,c=i*a+r*l+o;return[d,c]}var k0=Object.defineProperty,O0=(e,t,n)=>t in e?k0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,In=(e,t,n)=>(O0(e,typeof t!="symbol"?t+"":t,n),n),yi=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())}),Xo=(e=>(e[e.None=0]="None",e[e.Selected=1]="Selected",e[e.Focused=2]="Focused",e[e.Both=3]="Both",e))(Xo||{});window.dddg_dbg_paint_hitboxes="none";class xf{constructor(t){this.obj=t,In(this,"localRenderer",null),In(this,"lastVersion",null),In(this,"hitDetectionFallback",!1),In(this,"renderable",!1),In(this,"_disposed",!1),In(this,"lastHq",!1),In(this,"ready",Promise.resolve())}get id(){return this.obj.id}get x(){return this.obj.x}get y(){return this.obj.y}get version(){return this.obj.version}get flip(){return this.obj.flip}get rotation(){return this.obj.rotation/180*Math.PI}get composite(){return this.obj.composite}get filters(){return this.obj.filters}get width(){return this.obj.width}get height(){return this.obj.height}get allowSkippingLocalCanvas(){return!0}updateLocalCanvas(t,n){return yi(this,null,function*(){if(this._disposed)throw new Error("Disposed renderable called");yield this.ready;const o=this.canvasWidth,s=this.canvasHeight;if(s===0&&o===0){this.renderable=!1;return}if(this.renderable=!0,this.lastHq=t,!n){this.localRenderer&&!this.localRenderer.disposed&&this.localRenderer.height===s&&this.localRenderer.width===o||(this.localRenderer&&this.localRenderer.dispose(),this.localRenderer=new ws(o,s));try{yield this.localRenderer.render(this.renderLocal.bind(this),t)}catch(r){throw this.localRenderer.dispose(),this.localRenderer=null,r}}})}needsRedraw(){return this.localRenderer===null||this.lastVersion!==this.version}getHitboxRotation(){return[this.flip?-this.rotation:this.rotation,{x:this.x,y:this.y+this.height/2}]}getRenderRotation(){return this.getHitboxRotation()}render(t,n,o){return yi(this,null,function*(){if(this._disposed)throw new Error("Disposed renderable called");if(this.canSkipLocal()||(o=!1),(t!==0||this.localRenderer)&&(o=!1),(this.lastHq!==n.hq||this.needsRedraw())&&(yield this.updateLocalCanvas(n.hq,o)),this.lastVersion=this.version,!this.renderable)return;if(window.dddg_dbg_paint_hitboxes=="all"||window.dddg_dbg_paint_hitboxes=="selected"&&t!==0){const l=this.getHitbox(),[d,c]=this.getHitboxRotation();n.drawRect({h:l.y1-l.y0,w:l.x1-l.x0,x:l.x0,y:l.y0,rotation:d,rotationAnchor:c,outline:{style:"#000",width:2}})}const[r,i]=this.getRenderRotation();let a;switch(t){case 0:a=void 0;break;case 1:a={blur:20,color:"red"};break;case 2:a={blur:20,color:"blue"};break;case 3:a={blur:20,color:"purple"};break}o?yield n.customTransform(l=>yi(this,null,function*(){l.translate(this.canvasDrawPosX,this.canvasDrawPosY)}),this.renderLocal.bind(this)):n.drawImage({image:this.localRenderer,x:this.canvasDrawPosX,y:this.canvasDrawPosY,w:this.canvasDrawWidth,h:this.canvasDrawHeight,rotation:r,rotationAnchor:i,flip:this.flip,shadow:a&&n.preview?a:void 0,composite:this.composite,filters:this.filters})})}canSkipLocal(){return this.allowSkippingLocalCanvas&&this.obj.filters.length===0&&!this.obj.flip}hitTest(t,n){if(!this.localRenderer)return!1;const o=this.getHitbox(),[s,r]=this.getHitboxRotation(),[i,a]=r?pr(t,n,r.x,r.y,-s):[t,n],l=i>=o.x0&&i<=o.x1&&a>=o.y0&&a<=o.y1;if(this.obj.type==="choice"&&console.log("Simple hitbox test: ",l),!l)return!1;if(this.hitDetectionFallback)return!0;try{return this.pixelPerfectHitTest(t,n)}catch(d){this.hitDetectionFallback=!0}return!0}pixelPerfectHitTest(t,n){if(!this.localRenderer)return!1;const[o,s]=this.getRenderRotation(),[r,i]=s?pr(t,n,s.x,s.y,-o):[t,n],a=Math.round(r-this.canvasDrawPosX),l=Math.round(i-this.canvasDrawPosY),d=this.canvasDrawWidth,c=this.canvasDrawHeight;if(a>=0&&a<=d&&l>=0&&l<=c){const p=this.flip?this.canvasDrawWidth-a:a,f=this.canvasWidth/this.canvasDrawWidth,b=this.canvasHeight/this.canvasDrawHeight,v=this.localRenderer.getDataAt(Math.round(p*f),Math.round(l*b));return this.obj.type==="choice"&&console.log("pixel test: ",v[3]!==0),v[3]!==0}return!1}getHitbox(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}updatedContent(t,n){}get disposed(){return this._disposed}dispose(){var t;this._disposed=!0,(t=this.localRenderer)==null||t.dispose(),this.localRenderer=null}}var x0=Object.defineProperty,j0=Object.getPrototypeOf,I0=Reflect.get,T0=(e,t,n)=>t in e?x0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lt=(e,t,n)=>(T0(e,typeof t!="symbol"?t+"":t,n),n),E0=(e,t,n)=>I0(j0(e),n,t),_i=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class To extends xf{constructor(t){super(t),lt(this,"lastWidth",-1),lt(this,"lastHeight",-1),lt(this,"lastX",-1),lt(this,"lastY",-1),lt(this,"lastFlip",null),lt(this,"lastRotation",null),lt(this,"canvasHeight"),lt(this,"canvasWidth"),lt(this,"canvasDrawHeight"),lt(this,"canvasDrawWidth"),lt(this,"canvasDrawPosX",0),lt(this,"canvasDrawPosY",0);const n=J().Base;this.canvasHeight=n.screenHeight,this.canvasWidth=n.screenWidth,this.canvasDrawHeight=n.screenHeight,this.canvasDrawWidth=n.screenWidth}getRenderRotation(){return[0,void 0]}getHitboxRotation(){const t=this.getHitbox();return[this.flip?-this.rotation:this.rotation,{x:t.x0+(t.x1-t.x0)/2,y:t.y0+(t.y1-t.y0)/2}]}needsRedraw(){return super.needsRedraw()?!0:this.width!==this.lastWidth||this.height!==this.lastHeight||this.rotation!==this.lastRotation||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip}updateLocalCanvas(t,n){return _i(this,null,function*(){this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip,this.lastRotation=this.rotation,yield E0(To.prototype,this,"updateLocalCanvas").call(this,t,n)})}renderLocal(t){return _i(this,null,function*(){const n=J().Base;if(this.rotation===0)return yield this.draw(t);yield t.customTransform(o=>_i(this,null,function*(){const s=this.getHitbox(),r=s.x0+(s.x1-s.x0)/2,i=s.y0+(s.y1-s.y0)/2,a=this.flip?n.screenWidth-r:r;o.translate(a,i),o.rotate(this.rotation),o.translate(-a,-i)}),this.draw.bind(this))})}getHitbox(){const t=this.centeredVertically,n=this.width/2,o=this.height/2;return{x0:this.x-n,x1:this.x+n,y0:t?this.y-o:this.y,y1:t?this.y+o:this.y+this.height}}get centeredVertically(){return!1}}var B0=Object.defineProperty,fc=Object.getOwnPropertySymbols,A0=Object.prototype.hasOwnProperty,D0=Object.prototype.propertyIsEnumerable,hc=(e,t,n)=>t in e?B0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wi=(e,t)=>{for(var n in t||(t={}))A0.call(t,n)&&hc(e,n,t[n]);if(fc)for(var n of fc(t))D0.call(t,n)&&hc(e,n,t[n]);return e};class Sa{constructor(t){this.base=t}static get resizable(){return!1}static get defaultWidth(){return Oo}static get defaultHeight(){return Dr}static get defaultX(){return J().Base.screenWidth/2}static get defaultY(){return J().Base.screenHeight-this.defaultHeight-At-J().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return fa}getControlsDisabledStyle(){return zp}get textboxStyle(){return ha}renderControls(t,n){const o=J(),s=this.width,r=s/2,l=(this.base.obj.flip?o.Base.screenWidth-this.base.obj.x:this.base.obj.x)-r+s/2,d=this.getControlsStyle();t.drawText(wi({text:"History",x:l+la,y:n},d)),t.drawText(wi({text:"Skip",x:l+aa,y:n},this.base.obj.skip?d:this.getControlsDisabledStyle())),t.drawText(wi({text:"Auto   Save   Load   Settings",x:l+da,y:n},d))}}var R0=Object.defineProperty,F0=(e,t,n)=>t in e?R0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yo=(e,t,n)=>(F0(e,typeof t!="symbol"?t+"":t,n),n),$i=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Eo extends Sa{constructor(){super(...arguments),yo(this,"backgroundImage","textbox"),yo(this,"xOffset",0)}get height(){return Dr+At}get width(){return Oo}get nameboxWidth(){return bs}get nameboxHeight(){return At}get nameboxOffsetX(){return vs}get nameboxOffsetY(){return Fr}get nameboxStyle(){return Mr}get textOffsetX(){return ms}get textOffsetY(){return Rr}renderNamebox(t,n,o){return $i(this,null,function*(){t.drawImage({image:yield co("namebox"),x:n,y:o})})}renderBackdrop(t,n,o){return $i(this,null,function*(){n+=this.xOffset;const s=yield co(this.backgroundImage);t.drawImage({image:s,x:n,y:o})})}render(t){return $i(this,null,function*(){const n=J(),o=this.width,s=this.height,r=o/2,a=(this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;yield this.renderBackdrop(t,a,l+this.nameboxHeight),this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l));const d=l+s,c=d-ia;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield co("next"),x:a+o-ca,y:d-ua})})}}yo(Eo,"id","normal");yo(Eo,"label","Normal");yo(Eo,"priority",0);yo(Eo,"gameMode","ddlc");var M0=Object.defineProperty,N0=(e,t,n)=>t in e?M0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_o=(e,t,n)=>(N0(e,typeof t!="symbol"?t+"":t,n),n);class $s extends Eo{constructor(){super(...arguments),_o(this,"backgroundImage","textbox_monika"),_o(this,"xOffset",(Oo-ra)/2)}}_o($s,"id","corrupt");_o($s,"label","Corrupted");_o($s,"priority",1);_o($s,"gameMode","ddlc");function fr(e,t,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),e.moveTo(t+r,n),e.arcTo(t+o,n,t+o,n+s,r),e.arcTo(t+o,n+s,t,n+s,r),e.arcTo(t,n+s,t,n,r),e.arcTo(t,n,t+o,n,r),e.closePath()}function jf(e,t,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),e.moveTo(t+r,n),e.arcTo(t+o,n,t+o,n+s,r),e.lineTo(t+o,n+s),e.lineTo(t,n+s),e.arcTo(t,n,t+o,n,r),e.closePath()}var H0=Object.defineProperty,L0=Object.defineProperties,U0=Object.getOwnPropertyDescriptors,gc=Object.getOwnPropertySymbols,V0=Object.prototype.hasOwnProperty,W0=Object.prototype.propertyIsEnumerable,pl=(e,t,n)=>t in e?H0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z0=(e,t)=>{for(var n in t||(t={}))V0.call(t,n)&&pl(e,n,t[n]);if(gc)for(var n of gc(t))W0.call(t,n)&&pl(e,n,t[n]);return e},G0=(e,t)=>L0(e,U0(t)),wo=(e,t,n)=>(pl(e,typeof t!="symbol"?t+"":t,n),n),xt=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Cs extends Sa{constructor(){super(...arguments),wo(this,"backgroundImage","textbox"),wo(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height+At}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:bs}get nameboxHeight(){return At}get nameboxOffsetX(){return vs}get nameboxOffsetY(){return Fr}get nameboxStyle(){return G0(z0({},Mr),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return ms}get textOffsetY(){return Rr}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const t=this.refObject;return t!=null&&t.textboxColor!=null?t.textboxColor:Bp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?de.fromCss(this.customColor).toHSL().shift(Ap).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?de.fromCss(this.customColor).toHSL().shift(Dp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(t,n,o){return xt(this,null,function*(){const s=this.nameboxWidth,r=this.nameboxHeight;yield t.customTransform(i=>xt(this,null,function*(){i.beginPath(),jf(i,n,o,s,r,Mp),i.clip()}),i=>xt(this,null,function*(){const a=i.linearGradient(n,o,n,o+r),l=de.fromCss(this.nameboxBackgroundColor),d=new de(l.r,l.g,l.b,.95),c=d.toHSL().shift(Fp).toRgb();a.addColorStop(0,d.toCss()),a.addColorStop(Rp,d.toCss()),a.addColorStop(1,c.toCss()),i.drawRect({x:n,y:o,w:this.obj.width,h:r,fill:{style:a}})}))})}renderBackdrop(t,n,o){return xt(this,null,function*(){const s=de.fromCss(this.customColor).toHSL(),r=new ws(Wt,Wt);yield r.render(a=>xt(this,null,function*(){const l={style:s.shift(Np).toRgb().toCss()};function d(c,p){a.drawPath({path:f=>{f.ellipse(c,p,sl,sl,0,0,2*Math.PI)},fill:l})}d(0,0),d(Wt,0),d(0,Wt),d(Wt,Wt),d(Wt/2,Wt/2)}),!0),yield t.customTransform(a=>xt(this,null,function*(){a.beginPath(),fr(a,n+Vt,o+Vt,this.width-Vt*2,this.height-At-Vt*2,ol),a.clip()}),a=>xt(this,null,function*(){const l=this.obj.height,d=this.obj.width,c=a.linearGradient(n,o,n,o+l),p=de.fromHex(this.customColor);c.addColorStop(0,p.toCss()),c.addColorStop(1,`rgba(${p.r},${p.g},${p.b},0.6667)`),a.drawRect({x:n,y:o,w:d,h:l,fill:{style:c},outline:{style:"#ffdfee",width:6}}),yield a.customTransform(b=>xt(this,null,function*(){b.translate(n,o)}),b=>xt(this,null,function*(){const v=a.patternFrom(r);a.drawRect({x:0,y:0,w:d,h:l,fill:{style:v},composition:"source-atop"})}));const f=a.linearGradient(n,o+l-rl,n,o+l);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),a.drawPath({path:b=>{b.ellipse(n+d/2,o+l,Wp,rl,0,0,2*Math.PI)},fill:{style:f}})}));const i=s.shift(Hp).toRgb().toCss();t.drawPath({path:a=>{fr(a,n+Vt,o+Vt,this.width-Vt*2,this.height-At-Vt*2,ol)},outline:{style:i,width:Lp}}),r.dispose()})}render(t){return xt(this,null,function*(){const n=J(),o=this.width,s=this.height,r=o/2,a=(this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l)),yield this.renderBackdrop(t,a,l+this.nameboxHeight);const d=l+s,c=d-ia;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield co("next"),x:a+o-ca,y:d-ua})})}}wo(Cs,"id","custom");wo(Cs,"label","Custom");wo(Cs,"priority",0);wo(Cs,"gameMode","ddlc");var q0=Object.defineProperty,X0=(e,t,n)=>t in e?q0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vr=(e,t,n)=>(X0(e,typeof t!="symbol"?t+"":t,n),n),K0=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Ps extends Sa{get height(){return Dr+At}get width(){return Oo}get nameboxWidth(){return bs}get nameboxHeight(){return At}get nameboxOffsetX(){return vs}get nameboxOffsetY(){return Fr}get nameboxStyle(){return Mr}get textOffsetX(){return ms}get textOffsetY(){return Rr}get textboxStyle(){return ha}render(t){return K0(this,null,function*(){})}}Vr(Ps,"id","none");Vr(Ps,"label","None");Vr(Ps,"priority",0);Vr(Ps,"gameMode","ddlc");var Y0=Object.defineProperty,mc=Object.getOwnPropertySymbols,J0=Object.prototype.hasOwnProperty,Z0=Object.prototype.propertyIsEnumerable,fl=(e,t,n)=>t in e?Y0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bc=(e,t)=>{for(var n in t||(t={}))J0.call(t,n)&&fl(e,n,t[n]);if(mc)for(var n of mc(t))Z0.call(t,n)&&fl(e,n,t[n]);return e},Q0=(e,t,n)=>(fl(e,typeof t!="symbol"?t+"":t,n),n);const If=class{constructor(e){this.base=e}static get resizable(){return!1}static get defaultWidth(){return ba}static get defaultHeight(){return cf}static get defaultX(){return J().Base.screenWidth/2}static get defaultY(){return J().Base.screenHeight-this.defaultHeight-to-J().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return ar}getControlsDisabledStyle(){return wf}renderControls(e,t){const n=J(),o=this.width,s=o/2,i=(this.base.obj.flip?n.Base.screenWidth-this.base.obj.x:this.base.obj.x)-s,a=this.getControlsStyle(),l=["History","Skip","Auto","Save","Load","Settings"],d=[];let c=0;for(const b of l){const v=If.controlWidth(e,b);d.push(v),c+=v}const p=Math.min((o-c)/(l.length+2),78);let f=i+(o-c-p*(l.length-1))/2;for(let b=0;b<l.length;++b){const v=l[b],$=d[b],M=v==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():a;e.drawText(bc({text:v,x:f,y:t},M)),f+=$+p}}static controlWidth(e,t){if(this.widthCache[t])return this.widthCache[t];const n=e.measureText(bc({text:t},ar)).width;return this.widthCache[t]=n,n}};let Tf=If;Q0(Tf,"widthCache",{});var eC=Object.defineProperty,tC=Object.defineProperties,nC=Object.getOwnPropertyDescriptors,vc=Object.getOwnPropertySymbols,oC=Object.prototype.hasOwnProperty,sC=Object.prototype.propertyIsEnumerable,hl=(e,t,n)=>t in e?eC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rC=(e,t)=>{for(var n in t||(t={}))oC.call(t,n)&&hl(e,n,t[n]);if(vc)for(var n of vc(t))sC.call(t,n)&&hl(e,n,t[n]);return e},iC=(e,t)=>tC(e,nC(t)),$o=(e,t,n)=>(hl(e,typeof t!="symbol"?t+"":t,n),n),jt=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Ss extends Tf{constructor(){super(...arguments),$o(this,"backgroundImage","textbox"),$o(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height+to}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:ya}get nameboxHeight(){return to}get nameboxOffsetX(){return _a}get nameboxOffsetY(){return pf}get nameboxStyle(){return iC(rC({},_f),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return va}get textOffsetY(){return uf}get textboxStyle(){return $f}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const t=this.refObject;return t!=null&&t.textboxColor!=null?t.textboxColor:Jp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?de.fromCss(this.customColor).toHSL().shift(Zp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?de.fromCss(this.customColor).toHSL().shift(Qp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(t,n,o){return jt(this,null,function*(){const s=this.nameboxWidth,r=this.nameboxHeight;yield t.customTransform(i=>jt(this,null,function*(){i.beginPath(),jf(i,n,o,s,r,nf),i.clip()}),i=>jt(this,null,function*(){const a=i.linearGradient(n,o,n,o+r),l=de.fromCss(this.nameboxBackgroundColor),d=new de(l.r,l.g,l.b,.95),c=d.toHSL().shift(tf).toRgb();a.addColorStop(0,d.toCss()),a.addColorStop(ef,d.toCss()),a.addColorStop(1,c.toCss()),i.drawRect({x:n,y:o,w:this.obj.width,h:r,fill:{style:a}})}))})}renderBackdrop(t,n,o){return jt(this,null,function*(){const s=de.fromCss(this.customColor).toHSL(),r=new ws(Gt,Gt);yield r.render(a=>jt(this,null,function*(){const l={style:s.shift(of).toRgb().toCss()};function d(c,p){a.drawPath({path:f=>{f.ellipse(c,p,ll,ll,0,0,2*Math.PI)},fill:l})}d(0,0),d(Gt,0),d(0,Gt),d(Gt,Gt),d(Gt/2,Gt/2)}),!0),yield t.customTransform(a=>jt(this,null,function*(){a.beginPath(),fr(a,n+zt,o+zt,this.width-zt*2,this.height-to-zt*2,il),a.clip()}),a=>jt(this,null,function*(){const l=this.obj.height,d=this.obj.width,c=a.linearGradient(n,o,n,o+l),p=de.fromHex(this.customColor);c.addColorStop(0,p.toCss()),c.addColorStop(1,`rgba(${p.r},${p.g},${p.b},0.6667)`),a.drawRect({x:n,y:o,w:d,h:l,fill:{style:c},outline:{style:"#ffdfee",width:6}}),yield a.customTransform(b=>jt(this,null,function*(){b.translate(n,o)}),b=>jt(this,null,function*(){const v=a.patternFrom(r);a.drawRect({x:0,y:0,w:d,h:l,fill:{style:v},composition:"source-atop"})}));const f=a.linearGradient(n,o+l-al,n,o+l);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),a.drawPath({path:b=>{b.ellipse(n+d/2,o+l,yf,al,0,0,2*Math.PI)},fill:{style:f}})}));const i=s.shift(sf).toRgb().toCss();t.drawPath({path:a=>{fr(a,n+zt,o+zt,this.width-zt*2,this.height-to-zt*2,il)},outline:{style:i,width:rf}}),r.dispose()})}render(t){return jt(this,null,function*(){const n=J(),o=this.width,s=this.height,r=o/2,a=(this.obj.flip?n.Base.screenWidth-this.obj.x:this.obj.x)-r,l=this.obj.y;this.obj.talkingObjId!==null&&(yield this.renderNamebox(t,a+this.nameboxOffsetX,l)),yield this.renderBackdrop(t,a,l+this.nameboxHeight);const d=l+s,c=d-ff;this.obj.controls&&this.renderControls(t,c),this.obj.continue&&t.drawImage({image:yield co("next_plus"),x:a+o-bf,y:d-vf})})}}$o(Ss,"id","custom_plus");$o(Ss,"label","Custom (Plus)");$o(Ss,"priority",0);$o(Ss,"gameMode","ddlc_plus");var lC=Object.defineProperty,aC=(e,t,n)=>t in e?lC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vo=(e,t,n)=>(aC(e,typeof t!="symbol"?t+"":t,n),n),Ci=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const dC=[Eo,$s,Cs,Ps,Ss],Zo=(()=>{const e={};for(const t of dC)e[t.id]=t;return e})();class cC extends To{constructor(){super(...arguments),Vo(this,"refObject",null),Vo(this,"_lastRenderer",null),Vo(this,"lastForcedStyle"),Vo(this,"lastRefVars"),Vo(this,"lastRefVersion")}get refVars(){const t=this.refObject;return t?JSON.stringify([t.label,t.textboxColor,t.nameboxWidth]):""}get y(){return this.obj.y}get width(){return this.textboxRenderer.width}get height(){return this.textboxRenderer.height}get textboxRenderer(){const t=this.forcedStyle,n=Zo[t];if(this._lastRenderer&&this._lastRenderer.constructor===n)return this._lastRenderer;const o=new n(this);return this._lastRenderer=o,o}needsRedraw(){if(super.needsRedraw()||this.lastForcedStyle!==this.forcedStyle)return!0;const t=this.refObject;if((t==null?void 0:t.version)!==this.lastRefVersion){const n=this.lastRefVars!==this.refVars;return n||(this.lastRefVersion=t==null?void 0:t.version),n}return!1}get forcedStyle(){const t=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&t&&(t.textboxColor!=null||t.nameboxWidth!=null)?"custom":this.obj.style}updatedContent(t,n){super.updatedContent(t,n);const o=this.obj.talkingObjId;if(o!==null&&o!=="$other$"){const s=t.state.panels.panels[n].objects[o];this.refObject=s!=null?s:null;return}this.refObject=null}draw(t){return Ci(this,null,function*(){var n,o,s;const r=J(),i=this.textboxRenderer,a=i.width,l=a/2,c=(this.flip?r.Base.screenWidth-this.obj.x:this.obj.x)-l,p=this.obj.y;if(this.lastRefVars=this.refVars,this.lastRefVersion=(n=this.refObject)==null?void 0:n.version,this.lastForcedStyle=this.forcedStyle,yield i.render(t),this.obj.talkingObjId!==null){const f=this.obj.talkingObjId==="$other$"?this.obj.talkingOther:(s=(o=this.refObject)==null?void 0:o.label)!=null?s:"Missing name";yield this.renderName(t,c+i.nameboxOffsetX,p,f)}yield this.renderText(t,c,p,this.obj.autoWrap?a:0)})}renderName(t,n,o,s){return Ci(this,null,function*(){const r=this.textboxRenderer,i=r.nameboxWidth,a=r.nameboxStyle,l=new ut(s,a);yield l.loadFonts(),l.fixAlignment("center",n,n+i,o+r.nameboxOffsetY,0),l.render(t.fsCtx)})}renderText(t,n,o,s){return Ci(this,null,function*(){const r=this.textboxRenderer,i=new ut(this.obj.text,r.textboxStyle);this.obj.autoQuoting&&this.obj.talkingObjId!==null&&i.quote(),yield i.loadFonts(),i.fixAlignment("left",n+r.textOffsetX,0,o+r.nameboxHeight+r.textOffsetY,s-r.textOffsetX*2),i.render(t.fsCtx)})}}const uC=te({components:{Toggle:Ft,DFieldset:Mt},props:{obj:{required:!0}},computed:{freeMove:{get(){return this.obj.freeMove},set(e){A(()=>{this.$store.commit("panels/setFreeMove",{id:this.obj.id,panelId:this.obj.panelId,freeMove:e})})}},preserveRatio:{get(){return this.obj.preserveRatio},set(e){A(()=>{this.$store.dispatch("panels/setPreserveRatio",{id:this.obj.id,panelId:this.obj.panelId,preserveRatio:e})})}},pos:{get(){return ur(this.obj.x)},set(e){A(()=>{this.$store.dispatch("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:J().Base.characterPositions[e],y:this.obj.y})})}},x:{get(){return this.obj.x},set(e){A(()=>{this.$store.commit("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:e,y:this.y})})}},y:{get(){return this.obj.y},set(e){A(()=>{this.$store.commit("panels/setPosition",{id:this.obj.id,panelId:this.obj.panelId,x:this.x,y:e})})}},height:{get(){return this.obj.height},set(e){A(()=>{this.$store.dispatch("panels/setHeight",{id:this.obj.id,panelId:this.obj.panelId,height:e})})}},width:{get(){return this.obj.width},set(e){A(()=>{this.$store.dispatch("panels/setWidth",{id:this.obj.id,panelId:this.obj.panelId,width:e})})}},allowSize(){const e=this.obj;return e.type==="textBox"?Zo[e.style].resizable:!(e.type==="character"&&!e.freeMove)},allowStepMove(){return"freeMove"in this.obj},positionNames(){return J().Base.positions},isFirstPos(){return this.pos===0},isLastPos(){return this.pos===J().Base.positions.length-1}}});const Wr=e=>(Ge("data-v-e042cb55"),e=e(),qe(),e),pC={colspan:"2"},fC={key:0},hC={colspan:"2"},gC={class:"arrow-col"},mC=["disabled"],bC=["value"],vC={class:"arrow-col"},yC=["disabled"],_C=Wr(()=>u("td",null,[u("label",{for:"sprite_x"},"X:")],-1)),wC=Wr(()=>u("td",null,[u("label",{for:"sprite_y"},"Y:")],-1)),$C=Wr(()=>u("td",null,[u("label",{for:"sprite_w"},"Width:")],-1)),CC=Wr(()=>u("td",null,[u("label",{for:"sprite_h"},"Height:")],-1)),PC={colspan:"2"};function SC(e,t,n,o,s,r){const i=E("toggle"),a=E("d-fieldset");return g(),U(a,{title:"Position"+(e.allowSize?"/Size":"")},{default:B(()=>[u("table",null,[u("tr",null,[u("td",pC,[e.allowStepMove?(g(),U(i,{key:0,modelValue:e.freeMove,"onUpdate:modelValue":t[0]||(t[0]=l=>e.freeMove=l),label:"Move freely?"},null,8,["modelValue"])):K("",!0)])]),e.allowStepMove&&!e.freeMove?(g(),y("tr",fC,[u("td",hC,[u("table",null,[u("tr",null,[u("td",gC,[u("button",{onClick:t[1]||(t[1]=l=>--e.pos),disabled:e.isFirstPos},"<",8,mC)]),u("td",null,[ce(u("select",{id:"current_talking","onUpdate:modelValue":t[2]||(t[2]=l=>e.pos=l)},[(g(!0),y(V,null,Pe(e.positionNames,(l,d)=>(g(),y("option",{key:d,value:d},he(l),9,bC))),128))],512),[[wt,e.pos,void 0,{number:!0}]])]),u("td",vC,[u("button",{onClick:t[3]||(t[3]=l=>++e.pos),disabled:e.isLastPos},">",8,yC)])])])])])):(g(),y(V,{key:1},[u("tr",null,[_C,u("td",null,[ce(u("input",{id:"sprite_x",type:"number","onUpdate:modelValue":t[4]||(t[4]=l=>e.x=l),onKeydown:t[5]||(t[5]=q(()=>{},["stop"]))},null,544),[[Ae,e.x,void 0,{number:!0}]])])]),u("tr",null,[wC,u("td",null,[ce(u("input",{id:"sprite_y",type:"number","onUpdate:modelValue":t[6]||(t[6]=l=>e.y=l),onKeydown:t[7]||(t[7]=q(()=>{},["stop"]))},null,544),[[Ae,e.y,void 0,{number:!0}]])])])],64)),e.allowSize?(g(),y(V,{key:2},[u("tr",null,[$C,u("td",null,[ce(u("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":t[8]||(t[8]=l=>e.width=l),onKeydown:t[9]||(t[9]=q(()=>{},["stop"]))},null,544),[[Ae,e.width,void 0,{number:!0}]])])]),u("tr",null,[CC,u("td",null,[ce(u("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":t[10]||(t[10]=l=>e.height=l),onKeydown:t[11]||(t[11]=q(()=>{},["stop"]))},null,544),[[Ae,e.height,void 0,{number:!0}]])])]),u("tr",null,[u("td",PC,[C(i,{modelValue:e.preserveRatio,"onUpdate:modelValue":t[12]||(t[12]=l=>e.preserveRatio=l),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):K("",!0)])]),_:1},8,["title"])}const kC=oe(uC,[["render",SC],["__scopeId","data-v-e042cb55"]]),OC=te({components:{Toggle:Ft,DFieldset:Mt},props:{object:{required:!0}},computed:{onTop:_s()("onTop","panels/setOnTop",!0)},methods:{shiftLayer(e){A(()=>{this.$store.dispatch("panels/shiftLayer",{id:this.object.id,panelId:this.object.panelId,delta:e})})}}});const zr=e=>(Ge("data-v-79ef8c93"),e=e(),qe(),e),xC=zr(()=>u("i",{class:"material-icons"},"vertical_align_bottom",-1)),jC=[xC],IC=zr(()=>u("i",{class:"material-icons"},"arrow_downward",-1)),TC=[IC],EC=zr(()=>u("i",{class:"material-icons"},"arrow_upward",-1)),BC=[EC],AC=zr(()=>u("i",{class:"material-icons"},"vertical_align_top",-1)),DC=[AC];function RC(e,t,n,o,s,r){const i=E("toggle"),a=E("d-fieldset");return g(),U(a,{id:"layerfs",title:"Layer:"},{default:B(()=>[u("table",null,[u("tbody",null,[u("tr",null,[u("td",null,[u("button",{onClick:t[0]||(t[0]=l=>e.shiftLayer(-1/0)),title:"Move to back"},jC)]),u("td",null,[u("button",{onClick:t[1]||(t[1]=l=>e.shiftLayer(-1)),title:"Move backwards"},TC)]),u("td",null,[u("button",{onClick:t[2]||(t[2]=l=>e.shiftLayer(1)),title:"Move forwards"},BC)]),u("td",null,[u("button",{onClick:t[3]||(t[3]=l=>e.shiftLayer(1/0)),title:"Move to front"},DC)])])])]),C(i,{modelValue:e.onTop,"onUpdate:modelValue":t[4]||(t[4]=l=>e.onTop=l),label:"In front?"},null,8,["modelValue"])]),_:1})}const FC=oe(OC,[["render",RC],["__scopeId","data-v-79ef8c93"]]),MC=te({props:{obj:{required:!0}},methods:{onClick(){A(()=>{this.$store.dispatch("panels/removeObject",{panelId:this.obj.panelId,id:this.obj.id})})}}});function NC(e,t,n,o,s,r){return g(),y("button",{onClick:t[0]||(t[0]=(...i)=>e.onClick&&e.onClick(...i))},"Delete")}const HC=oe(MC,[["render",NC]]),Ms=255,Pi=8,LC=te({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},data:()=>({slideActive:!1}),computed:{vertical(){return this.$store.state.ui.vertical},pointerPath(){const e=this.modelValue/this.maxValue*Ms;return`M${e} 0L${e+14} 0L${e+7} 12Z`},gradientOffset(){return!this.shiftGradient||this.modelValue===0?0:this.modelValue/this.maxValue}},methods:{enterSlide(e){this.slideActive=!0,this.moveSlide(e)},moveSlide(e){if(!this.slideActive)return;const t=this.$refs.svg;if(!t.contains(e.target)&&e.target!==t)return;if(e instanceof MouseEvent&&e.which!==1){this.slideActive=!1;return}const n=t.getBoundingClientRect(),o=n.width/(Pi+Ms+Pi),r=((e instanceof MouseEvent?e.clientX:e.touches[0].clientX)-n.x)/o;e.preventDefault();const i=Math.max(Math.min(r-Pi,Ms),0)/Ms*this.maxValue;this.$emit("update:modelValue",i)},exitSlide(){this.slideActive=!1}}});const UC=["for"],VC=["id","x1","x2"],WC=["offset"],zC=["fill"],GC=["d"],qC=["id","max","value"];function XC(e,t,n,o,s,r){return g(),y("div",{class:fe({slider:!0,vertical:e.vertical}),onKeydown:t[8]||(t[8]=q(()=>{},["stop"]))},[e.noInput?K("",!0):(g(),y("label",{key:0,for:e._.uid},he(e.label),9,UC)),u("div",null,[(g(),y("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:t[0]||(t[0]=(...i)=>e.enterSlide&&e.enterSlide(...i)),onTouchstart:t[1]||(t[1]=(...i)=>e.enterSlide&&e.enterSlide(...i)),onMousemove:t[2]||(t[2]=(...i)=>e.moveSlide&&e.moveSlide(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.moveSlide&&e.moveSlide(...i)),onMouseup:t[4]||(t[4]=(...i)=>e.exitSlide&&e.exitSlide(...i)),onTouchend:t[5]||(t[5]=(...i)=>e.exitSlide&&e.exitSlide(...i))},[u("defs",null,[u("linearGradient",{id:`gradient${e._.uid}`,x1:e.gradientOffset*100+"%",y1:"0%",x2:(e.gradientOffset+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(g(!0),y(V,null,Pe(e.gradientStops,(i,a)=>(g(),y("stop",{key:a,offset:a/(e.gradientStops.length-1)*100+"%",style:Be("stop-color:"+i)},null,12,WC))),128))],8,VC)]),u("g",null,[u("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${e._.uid})`},null,8,zC),u("path",{d:e.pointerPath,"stroke-width":"2",class:"slider-pointer"},null,8,GC)])],544))]),e.noInput?K("",!0):(g(),y("input",{key:1,id:e._.uid,class:"sliderInput",min:"0",max:e.maxValue,value:e.modelValue,type:"number",onInput:t[6]||(t[6]=i=>e.$emit("update:modelValue",parseFloat(i.target.value))),onKeydown:t[7]||(t[7]=q(()=>{},["stop"]))},null,40,qC))],34)}const Ef=oe(LC,[["render",XC],["__scopeId","data-v-7f02dff9"]]),KC=te({components:{Slider:Ef},props:{modelValue:{type:String,validator:e=>!!e.match(/^#[0-9a-f]{6,8}$/i)},mode:{type:String},relative:Boolean},data:()=>({lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}),computed:{vertical(){return this.$store.state.ui.vertical},maxValue1(){return this.mode==="rgba"?255:360},label1(){return this.mode==="rgba"?"Red":"Hue"},stops1(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v2:0,n=this.relative?this.v3:0;e=[new de(0,t,n,1),new de(255,t,n,1)]}else{const t=this.relative?this.v2/100:1,n=this.relative?this.v3/100:.5;e=this.eightsStops(o=>new be(o,t,n,1))}return e.map(t=>t.toRgb().toCss())},maxValue2(){return this.mode==="rgba"?255:100},label2(){return this.mode==="rgba"?"Green":"Saturation"},stops2(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v1:0,n=this.relative?this.v3:0;e=[new de(t,0,n,1),new de(t,255,n,1)]}else{const t=this.relative?this.v1/360:0,n=this.relative?this.v3/100:.5;e=this.eightsStops(o=>new be(t,o,n,1))}return e.map(t=>t.toRgb().toCss())},maxValue3(){return this.mode==="rgba"?255:100},label3(){return this.mode==="rgba"?"Blue":"Luminosity"},stops3(){let e=[];if(this.mode==="rgba"){const t=this.relative?this.v1:0,n=this.relative?this.v2:0;e=[new de(t,n,0,1),new de(t,n,255,1)]}else{const t=this.relative?this.v1/360:0,n=this.relative?this.v2/100:.5;e=this.eightsStops(o=>new be(t,n,o,1))}return e.map(t=>t.toRgb().toCss())},stopsAlpha(){const e=de.fromHex(this.modelValue);return[new de(e.r,e.g,e.b,0).toCss(),new de(e.r,e.g,e.b,1).toCss()]}},created(){this.initValues()},methods:{valueChanged(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue(){let e;this.mode==="rgba"?e=new de(this.v1,this.v2,this.v3,this.a/255):e=new be(this.v1/360,this.v2/100,this.v3/100,this.a/255);const t=e.toRgb().toHex();if(this.lastRGBEmit!==t){if(t.length!==9)throw new Error(`Invalid color code: ${t}`);this.lastRGBEmit=t,this.$emit("update:modelValue",t)}},initValues(){const e=de.fromHex(this.modelValue);if(this.lastRGBEmit=e.toHex(),this.a=e.a*255,this.mode==="hsla"){const t=e.toHSL();this.v1=t.h*360,this.v2=t.s*100,this.v3=t.l*100}else this.v1=e.r,this.v2=e.g,this.v3=e.b},eightsStops(e){const t=[];for(let n=0;n<=8;++n)t.push(e(n/8));return t}},watch:{value(){this.valueChanged()},v1(){this.updateValue()},v2(){this.updateValue()},v3(){this.updateValue()},a(){this.updateValue()},mode(){this.initValues()}}});function YC(e,t,n,o,s,r){const i=E("slider");return g(),y("div",null,[C(i,{label:e.label1,modelValue:e.v1,"onUpdate:modelValue":t[0]||(t[0]=a=>e.v1=a),"max-value":e.maxValue1,"gradient-stops":e.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),C(i,{label:e.label2,modelValue:e.v2,"onUpdate:modelValue":t[1]||(t[1]=a=>e.v2=a),"max-value":e.maxValue2,"gradient-stops":e.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),C(i,{label:e.label3,modelValue:e.v3,"onUpdate:modelValue":t[2]||(t[2]=a=>e.v3=a),"max-value":e.maxValue3,"gradient-stops":e.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),C(i,{label:"Alpha",modelValue:e.a,"onUpdate:modelValue":t[3]||(t[3]=a=>e.a=a),"max-value":255,"gradient-stops":e.stopsAlpha},null,8,["modelValue","gradient-stops"])])}const JC=oe(KC,[["render",YC],["__scopeId","data-v-c0b91184"]]);var ZC=Object.defineProperty,QC=Object.defineProperties,e1=Object.getOwnPropertyDescriptors,yc=Object.getOwnPropertySymbols,t1=Object.prototype.hasOwnProperty,n1=Object.prototype.propertyIsEnumerable,_c=(e,t,n)=>t in e?ZC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,o1=(e,t)=>{for(var n in t||(t={}))t1.call(t,n)&&_c(e,n,t[n]);if(yc)for(var n of yc(t))n1.call(t,n)&&_c(e,n,t[n]);return e},s1=(e,t)=>QC(e,e1(t));const wc="dddg.generated.colors",r1=te({components:{SliderGroup:JC,DButton:Ln},inheritAttrs:!1,emits:["leave","update:modelValue"],props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:()=>({mode:"hsla",relative:!0}),computed:{vertical(){return this.$store.state.ui.vertical},swatches(){return this.$store.state.content.current.colors},color:{get(){return this.format==="rgb"?de.fromCss(this.modelValue).toHex():this.modelValue},set(e){if(this.format==="rgb"){const t=de.fromCss(e);this.$emit("update:modelValue",t.toCss())}else this.$emit("update:modelValue",e)}}},mounted(){pe.subscribe(sr,this.settingColor)},unmounted(){pe.unsubscribe(sr,this.settingColor)},methods:{settingColor(e){this.color=de.fromCss(e.color).toHex()},updateHex(e){const t=e.target.value;de.validHex(t)&&(t.length===7||t.length===9)&&(this.color=t)},addSwatch(){if(this.swatches.find(n=>n.color===this.color))return;const e=this.$store.state.content.contentPacks.find(n=>n.packId===wc)||{packId:wc,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},t=s1(o1({},e),{colors:[...e.colors,{label:this.color,color:this.color}]});A(()=>{this.$store.dispatch("content/replaceContentPack",{contentPack:t,processed:!0})})},pickColor(){A(()=>{this.$store.commit("ui/setColorPicker",!0)})}}});const i1={class:"column"},l1={class:"hex-selector"},a1=["for"],d1=["id","value"],c1=["title","onClick"];function u1(e,t,n,o,s,r){const i=E("slider-group"),a=E("d-button");return g(),y("div",{class:fe({color:!0,vertical:e.vertical})},[u("h2",null,he(e.title),1),u("button",{onClick:t[0]||(t[0]=l=>e.$emit("leave"))},"OK"),u("table",null,[u("tr",null,[u("td",null,[u("button",{onClick:t[1]||(t[1]=l=>e.mode="hsla")},"HSLA")]),u("td",null,[u("button",{onClick:t[2]||(t[2]=l=>e.mode="rgba")},"RGBA")])])]),u("div",i1,[C(i,{mode:e.mode,modelValue:e.color,"onUpdate:modelValue":t[3]||(t[3]=l=>e.color=l),relative:!0},null,8,["mode","modelValue"]),u("div",l1,[u("label",{class:"hex-label",for:`hex_${e._.uid}`},"Hex",8,a1),u("input",{id:`hex_${e._.uid}`,value:e.color,onInput:t[4]||(t[4]=(...l)=>e.updateHex&&e.updateHex(...l)),onKeydown:t[5]||(t[5]=q(()=>{},["stop"]))},null,40,d1)]),u("button",{onClick:t[6]||(t[6]=(...l)=>e.addSwatch&&e.addSwatch(...l))},"Add as swatch"),C(a,{icon:"colorize",onClick:e.pickColor},{default:B(()=>[O("Pick color")]),_:1},8,["onClick"])]),u("div",{id:"color-swatches",class:fe({vertical:e.vertical})},[(g(!0),y(V,null,Pe(e.swatches,l=>(g(),y("button",{class:"swatch",key:l.color,style:Be({backgroundColor:l.color}),title:l.label,onClick:d=>{e.color=l.color,e.$emit("leave")}},null,12,c1))),128))],2)],2)}const Gr=oe(r1,[["render",u1],["__scopeId","data-v-070f8114"]]);var p1=Object.defineProperty,$c=Object.getOwnPropertySymbols,f1=Object.prototype.hasOwnProperty,h1=Object.prototype.propertyIsEnumerable,Cc=(e,t,n)=>t in e?p1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g1=(e,t)=>{for(var n in t||(t={}))f1.call(t,n)&&Cc(e,n,t[n]);if($c)for(var n of $c(t))h1.call(t,n)&&Cc(e,n,t[n]);return e};const Pc=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function gl(e,t,n){const s=[...t().filters];let r;switch(e.type){case"hue-rotate":r={type:e.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:e.type,value:1};break;case"drop-shadow":r={type:e.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:throw new _t.UnreachableCaseError(e.type)}s.splice(e.idx,0,r),n({panelId:e.panelId,id:e.id,filters:s})}function ml(e,t,n){const s=[...t().filters];s.splice(e.idx,1),n({id:e.id,panelId:e.panelId,filters:s})}function bl(e,t,n){const s=[...t().filters],r=s[e.idx];s.splice(e.idx,1),s.splice(e.idx+e.moveBy,0,r),n({id:e.id,panelId:e.panelId,filters:s})}function vl(e,t,n){const s=[...t().filters],r=g1({},s[e.idx]);s[e.idx]=r,r.type==="drop-shadow"?(e.blurRadius!==void 0&&(r.blurRadius=e.blurRadius),e.color!==void 0&&(r.color=e.color),e.offsetX!==void 0&&(r.offsetX=e.offsetX),e.offsetY!==void 0&&(r.offsetY=e.offsetY)):r.value=e.value,n({id:e.id,panelId:e.panelId,filters:s})}var m1=Object.defineProperty,Sc=Object.getOwnPropertySymbols,b1=Object.prototype.hasOwnProperty,v1=Object.prototype.propertyIsEnumerable,kc=(e,t,n)=>t in e?m1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y1=(e,t)=>{for(var n in t||(t={}))b1.call(t,n)&&kc(e,n,t[n]);if(Sc)for(var n of Sc(t))v1.call(t,n)&&kc(e,n,t[n]);return e},_1=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const eo=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),w1=(()=>{try{const e=us();e.width=0,e.height=0;const n="filter"in e.getContext("2d");if(bo(e),n)return Array.from(eo.keys()).sort()}catch(e){}return["opacity"]})(),$1=te({components:{DFlow:ys,DFieldset:Mt,Color:Gr,Slider:Ef,L:na},props:{type:{type:String,required:!0},title:{type:String},id:{},panelId:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],data:()=>({addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}),computed:{object(){switch(this.type){case"object":return this.$store.state.panels.panels[this.panelId].objects[this.id];case"background":return this.$store.state.panels.panels[this.panelId].background;case"panel":return this.$store.state.panels.panels[this.panelId];default:throw new _t.UnreachableCaseError(this.type)}},compositionMode:{get(){return this.object.composite},set(e){A(()=>{switch(this.type){case"object":this.$store.commit("panels/setComposition",{id:this.id,panelId:this.panelId,composite:e});break;case"background":break;case"panel":break;default:throw new _t.UnreachableCaseError(this.type)}})}},filters(){return this.object.filters},filterTypes(){return w1},currentFilter(){var e;return(e=this.filters[this.currentFilterIdx])!=null?e:null},isPercentFilter(){const e=this.currentFilter;return e?Pc.has(e.type):!1},maxValue(){const e=this.currentFilter;if(!!e){if(e.type==="hue-rotate")return 360;if(e.type==="grayscale"||e.type==="sepia"||e.type==="opacity"||e.type==="invert")return 100}},minValue(){const e=this.currentFilter;if(!!e)switch(e.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get(){const e=this.currentFilter;if(!!e&&"color"in e)return e.color},set(e){this.setValue({color:e})}},shadowX:{get(){const e=this.currentFilter;if(!!e&&"offsetX"in e)return e.offsetX},set(e){this.setValue({offsetX:e})}},shadowY:{get(){const e=this.currentFilter;if(!!e&&"offsetY"in e)return e.offsetY},set(e){this.setValue({offsetY:e})}},shadowBlur:{get(){const e=this.currentFilter;if(!!e&&"blurRadius"in e)return e.blurRadius},set(e){this.setValue({blurRadius:e})}},hueStops(){return this.eightsStops(t=>new be(t,1,.5,1)).map(t=>t.toRgb().toCss())}},methods:{getFilterLabel(e){return eo.get(e)},getFilterText(e){return Pc.has(e.type)?`${eo.get(e.type)} ${(e.value*100).toFixed()}%`:e.type==="hue-rotate"?`${eo.get(e.type)} ${e.value.toFixed()}\xB0`:e.type==="blur"?`${eo.get(e.type)} ${e.value.toFixed()}px`:eo.get(e.type)},objectTypeScope(e){switch(this.type){case"object":return"panels/object_"+e;case"background":return"panels/background"+e[0].toUpperCase()+e.slice(1);case"panel":return"panels/"+e}},addFilter(){A(()=>{this.$store.dispatch(this.objectTypeScope("addFilter"),{id:this.id,panelId:this.panelId,type:this.addEffectSelection,idx:this.currentFilterIdx+1})})},selectFilter(e){this.currentFilterIdx=e},removeFilter(){A(()=>_1(this,null,function*(){yield this.$store.dispatch(this.objectTypeScope("removeFilter"),{id:this.id,panelId:this.panelId,idx:this.currentFilterIdx}),this.currentFilterIdx>=this.object.filters.length&&(this.currentFilterIdx=this.object.filters.length-1)}))},moveFilter(e){A(()=>{this.$store.dispatch(this.objectTypeScope("moveFilter"),{id:this.id,panelId:this.panelId,idx:this.currentFilterIdx,moveBy:e}),this.currentFilterIdx+=e})},setValue(e){A(()=>{this.$store.dispatch(this.objectTypeScope("setFilter"),y1({id:this.id,panelId:this.panelId,idx:this.currentFilterIdx},e))})},eightsStops(e){const t=[];for(let n=0;n<=8;++n)t.push(e(n/8));return t}}});const ue=e=>(Ge("data-v-ee42cbcd"),e=e(),qe(),e),C1=ue(()=>u("h2",null,"Image options",-1)),P1={class:"column ok-col"},S1={key:0,class:"column"},k1=ue(()=>u("label",{for:"compositionSelect"},"Compositing Mode:",-1)),O1=ue(()=>u("option",{value:"source-over"},"source-over",-1)),x1=ue(()=>u("option",{value:"source-atop"},"source-atop",-1)),j1=ue(()=>u("option",{value:"destination-over"},"destination-over",-1)),I1=ue(()=>u("option",{value:"destination-in"},"destination-in",-1)),T1=ue(()=>u("option",{value:"destination-in"},"destination-out",-1)),E1=ue(()=>u("option",{value:"destination-in"},"destination-atop",-1)),B1=ue(()=>u("option",{value:"lighter"},"lighter",-1)),A1=ue(()=>u("option",{value:"xor"},"xor",-1)),D1=ue(()=>u("option",{value:"multiply"},"multiply",-1)),R1=ue(()=>u("option",{value:"screen"},"screen",-1)),F1=ue(()=>u("option",{value:"overlay"},"overlay",-1)),M1=ue(()=>u("option",{value:"darken"},"darken",-1)),N1=ue(()=>u("option",{value:"lighten"},"lighten",-1)),H1=ue(()=>u("option",{value:"color-dodge"},"color-dodge",-1)),L1=ue(()=>u("option",{value:"color-burn"},"color-burn",-1)),U1=ue(()=>u("option",{value:"hard-light"},"hard-light",-1)),V1=ue(()=>u("option",{value:"soft-light"},"soft-light",-1)),W1=ue(()=>u("option",{value:"difference"},"difference",-1)),z1=ue(()=>u("option",{value:"exclusion"},"exclusion",-1)),G1=ue(()=>u("option",{value:"hue"},"hue",-1)),q1=ue(()=>u("option",{value:"saturation"},"saturation",-1)),X1=ue(()=>u("option",{value:"color"},"color",-1)),K1=ue(()=>u("option",{value:"luminosity"},"luminosity",-1)),Y1=[O1,x1,j1,I1,T1,E1,B1,A1,D1,R1,F1,M1,N1,H1,L1,U1,V1,W1,z1,G1,q1,X1,K1],J1=ue(()=>u("label",{for:"addEffect"},"Add new effect",-1)),Z1=["value"],Q1=["disabled"],eP=["disabled"],tP=["disabled"],nP=["disabled"],oP=["onClick","onKeydown"],sP={key:0,class:"value-input-table"},rP=ue(()=>u("td",null,[u("label",{for:"shadow_color"},"Color:")],-1)),iP=ue(()=>u("td",null,[u("label",{for:"filter_x"},"X:")],-1)),lP=ue(()=>u("td",null,[u("label",{for:"filter_y"},"Y:")],-1)),aP=ue(()=>u("td",null,[u("label",{for:"filter_blur"},"Blur:")],-1)),dP=ue(()=>u("td",null,[u("label",{for:"filter_value"},"Value:")],-1)),cP=["value","max","min"],uP={key:0},pP={colspan:"2"},fP=ue(()=>u("td",null,[u("label",{for:"filter_value"},"Value:")],-1)),hP=["value","max","min"],gP={key:0},mP={colspan:"2"};function bP(e,t,n,o,s,r){const i=E("color"),a=E("l"),l=E("d-flow"),d=E("slider"),c=E("d-fieldset");return e.showShadowColor?(g(),U(i,{key:0,modelValue:e.shadowColor,"onUpdate:modelValue":t[0]||(t[0]=p=>e.shadowColor=p),format:"rgb",onLeave:t[1]||(t[1]=p=>e.showShadowColor=!1)},null,8,["modelValue"])):(g(),U(l,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:B(()=>[C1,u("div",P1,[u("button",{onClick:t[2]||(t[2]=p=>e.$emit("leave"))},"Back")]),e.noComposition?K("",!0):(g(),y("div",S1,[k1,C(a,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:B(()=>[O("[?] ")]),_:1}),ce(u("select",{id:"compositionSelect","onUpdate:modelValue":t[3]||(t[3]=p=>e.compositionMode=p),onKeydown:t[4]||(t[4]=q(()=>{},["stop"]))},Y1,544),[[wt,e.compositionMode]])])),C(c,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:B(()=>[C(l,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:B(()=>[C(l,{direction:"vertical","no-wraping":""},{default:B(()=>[J1,ce(u("select",{id:"addEffect","onUpdate:modelValue":t[5]||(t[5]=p=>e.addEffectSelection=p),onKeydown:t[6]||(t[6]=q(()=>{},["stop"]))},[(g(!0),y(V,null,Pe(e.filterTypes,p=>(g(),y("option",{key:p,value:p},he(e.getFilterLabel(p)),9,Z1))),128))],544),[[wt,e.addEffectSelection]]),u("button",{disabled:e.addEffectSelection==="",onClick:t[7]||(t[7]=(...p)=>e.addFilter&&e.addFilter(...p)),onKeydown:t[8]||(t[8]=q(()=>{},["stop"]))}," Add ",40,Q1),u("button",{disabled:!e.currentFilter,onClick:t[9]||(t[9]=(...p)=>e.removeFilter&&e.removeFilter(...p)),onKeydown:t[10]||(t[10]=q(()=>{},["stop"]))}," Remove ",40,eP),u("button",{disabled:e.currentFilterIdx===0,onClick:t[11]||(t[11]=p=>e.moveFilter(-1)),onKeydown:t[12]||(t[12]=q(()=>{},["stop"]))}," Move up ",40,tP),u("button",{disabled:e.currentFilterIdx===e.filters.length-1||e.filters.length===0,onClick:t[13]||(t[13]=p=>e.moveFilter(1)),onKeydown:t[14]||(t[14]=q(()=>{},["stop"]))}," Move down ",40,nP)]),_:1}),C(l,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:B(()=>[(g(!0),y(V,null,Pe(e.filters,(p,f)=>(g(),y("div",{key:f,class:fe({choiceBtn:!0,active:f===e.currentFilterIdx}),tabindex:"0",onClick:b=>e.selectFilter(f),onKeydown:[Ue(b=>e.selectFilter(f),["enter"]),Ue(q(b=>e.selectFilter(f),["prevent"]),["space"])]},he(e.getFilterText(p)),43,oP))),128))]),_:1}),e.currentFilter?(g(),y("table",sP,[e.currentFilter.type==="drop-shadow"?(g(),y(V,{key:0},[u("tr",null,[rP,u("td",null,[u("button",{id:"shadow_color",class:"color-button",style:Be({background:e.shadowColor}),onClick:t[15]||(t[15]=p=>e.showShadowColor=!0)}," \xA0 ",4)])]),u("tr",null,[iP,u("td",null,[ce(u("input",{id:"filter_x",type:"number","onUpdate:modelValue":t[16]||(t[16]=p=>e.shadowX=p),onKeydown:t[17]||(t[17]=q(()=>{},["stop"]))},null,544),[[Ae,e.shadowX,void 0,{number:!0}]])])]),u("tr",null,[lP,u("td",null,[ce(u("input",{id:"filter_y",type:"number","onUpdate:modelValue":t[18]||(t[18]=p=>e.shadowY=p),onKeydown:t[19]||(t[19]=q(()=>{},["stop"]))},null,544),[[Ae,e.shadowY,void 0,{number:!0}]])])]),u("tr",null,[aP,u("td",null,[ce(u("input",{id:"filter_blur",type:"number","onUpdate:modelValue":t[20]||(t[20]=p=>e.shadowBlur=p),onKeydown:t[21]||(t[21]=q(()=>{},["stop"]))},null,544),[[Ae,e.shadowBlur,void 0,{number:!0}]])])])],64)):e.isPercentFilter?(g(),y(V,{key:1},[u("tr",null,[dP,u("td",null,[u("input",{id:"filter_value",value:(e.currentFilter.value*100).toFixed(),type:"number",max:e.maxValue,min:e.minValue,onInput:t[22]||(t[22]=p=>e.setValue({value:Number(p.target.value/100)})),onKeydown:t[23]||(t[23]=q(()=>{},["stop"]))},null,40,cP),O("% ")])]),e.minValue===0&&e.maxValue!==void 0?(g(),y("tr",uP,[u("td",pP,[C(d,{gradientStops:["#000000","#ffffff"],label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value*100,"no-input":"","onUpdate:modelValue":t[24]||(t[24]=p=>e.setValue({value:Math.round(p)/100}))},null,8,["maxValue","modelValue"])])])):K("",!0)],64)):(g(),y(V,{key:2},[u("tr",null,[fP,u("td",null,[u("input",{id:"filter_value",value:e.currentFilter.value,type:"number",max:e.maxValue,min:e.minValue,onInput:t[25]||(t[25]=p=>e.setValue({value:Number(p.target.value)})),onKeydown:t[26]||(t[26]=q(()=>{},["stop"]))},null,40,hP)])]),e.minValue===0&&e.maxValue!==void 0?(g(),y("tr",gP,[u("td",mP,[C(d,{gradientStops:e.hueStops,label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value,"no-input":"","onUpdate:modelValue":t[27]||(t[27]=p=>e.setValue({value:Math.round(p)}))},null,8,["gradientStops","maxValue","modelValue"]),C(d,{gradientStops:e.hueStops,label:"",maxValue:e.maxValue,modelValue:e.currentFilter.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):K("",!0)],64))])):K("",!0)]),_:1})]),_:1})]),_:1}))}const ka=oe($1,[["render",bP],["__scopeId","data-v-ee42cbcd"]]),vP=te({inheritAttrs:!1,components:{Color:Gr},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:()=>({colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}),computed:{vertical(){return this.$store.state.ui.vertical}},watch:{selectedFont(){this.selectedFont!==""&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged(){const e=J(),t=this.$refs.textArea.value;try{new ut(t,e.TextBox.NameboxTextStyle),this.error=""}catch(n){this.error=n.message}this.$emit("update:modelValue",t)},selectColor(e){const t=this.$refs.textArea;this.colorSelector=e,this.rememberedStart=t.selectionStart,this.rememberedEnd=t.selectionEnd},applyColor(){const e=this.selectedColor,t=this.colorSelector,n=()=>{const o=this.$refs.textArea;if(!o){this.$nextTick(n);return}o.selectionStart=this.rememberedStart,o.selectionEnd=this.rememberedEnd,this.insertCommand(t==="text"?"color":"outlinecolor",e)};this.$nextTick(n),this.selectedColor="#000000",this.colorSelector=""},insertText(e){const t=this.$refs.textArea,n=t.value,o=t.selectionStart,s=t.selectionEnd;t.value=n.slice(0,o)+e+n.slice(s),t.selectionStart=t.selectionEnd=o+e.length,t.focus(),this.onValueChanged()},insertCommand(e,t){const n=this.$refs.textArea,o=n.value,s=n.selectionStart,r=n.selectionEnd,i=o.slice(s,r),a=o.slice(0,s),l=o.slice(r);let d=e;t&&(d+="="+t),n.value=`${a}{${d}}${i}{/${e}}${l}`,n.selectionStart=s+d.length+2,n.selectionEnd=n.selectionStart+i.length,n.focus(),this.onValueChanged()}}});const yP=e=>(Ge("data-v-926f0802"),e=e(),qe(),e),_P={class:"column ok-col"},wP={class:"column"},$P=["value"],CP={key:0,class:"column error-col"},PP={class:"column"},SP=yP(()=>u("p",{class:"hint-col"},"Apply style to selected text:",-1)),kP={class:"column"},OP={class:"column"},xP={class:"column"},jP=am('<option value data-v-926f0802>Font</option><option value="aller" style="font-family:aller;" data-v-926f0802> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-926f0802> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-926f0802> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-926f0802> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-926f0802> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-926f0802> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-926f0802> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-926f0802> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-926f0802> Halogen (MC) </option>',10),IP=[jP];function TP(e,t,n,o,s,r){const i=E("color");return e.colorSelector?(g(),U(i,{key:0,modelValue:e.selectedColor,"onUpdate:modelValue":t[0]||(t[0]=a=>e.selectedColor=a),onLeave:e.applyColor},null,8,["modelValue","onLeave"])):(g(),y("div",{key:1,class:fe({"text-subpanel":!0,vertical:e.vertical})},[u("h2",null,he(e.title),1),u("div",_P,[u("button",{onClick:t[1]||(t[1]=a=>e.$emit("leave"))},"OK")]),u("div",wP,[u("textarea",{ref:"textArea",value:e.modelValue,onInput:t[2]||(t[2]=(...a)=>e.onValueChanged&&e.onValueChanged(...a)),onKeydown:t[3]||(t[3]=q(()=>{},["stop"])),onKeypress:t[4]||(t[4]=q(()=>{},["stop"]))},null,40,$P)]),e.error?(g(),y("div",CP,he(e.error),1)):K("",!0),u("div",PP,[u("button",{onClick:t[5]||(t[5]=a=>e.insertText("\\\\")),class:"style-button"},"Insert \\"),u("button",{onClick:t[6]||(t[6]=a=>e.insertText("\\{")),class:"style-button"},"Insert {"),u("button",{onClick:t[7]||(t[7]=a=>e.insertText("\\}")),class:"style-button"},"Insert }")]),SP,u("div",kP,[u("button",{onClick:t[8]||(t[8]=a=>e.insertCommand("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),u("button",{onClick:t[9]||(t[9]=a=>e.insertCommand("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),u("button",{onClick:t[10]||(t[10]=a=>e.insertCommand("plain")),class:"style-button"}," Plain "),u("button",{onClick:t[11]||(t[11]=a=>e.insertCommand("edited")),class:"style-button edited-style"}," Edited "),u("button",{onClick:t[12]||(t[12]=a=>e.insertCommand("k",2)),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),u("div",OP,[u("button",{onClick:t[13]||(t[13]=a=>e.insertCommand("alpha",.5)),class:"style-button"}," Alpha ")]),u("div",xP,[u("button",{onClick:t[14]||(t[14]=a=>e.insertCommand("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),ce(u("select",{"onUpdate:modelValue":t[15]||(t[15]=a=>e.selectedFont=a),class:"style-button"},IP,512),[[wt,e.selectedFont]]),u("button",{onClick:t[16]||(t[16]=a=>e.selectColor("text")),class:"style-button"}," Text color "),u("button",{onClick:t[17]||(t[17]=a=>e.selectColor("outline")),class:"style-button"}," Outline color ")])],2))}const EP=oe(vP,[["render",TP],["__scopeId","data-v-926f0802"]]);var Xn=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Si=_s(),BP=te({mixins:[st],components:{Toggle:Ft,PositionAndSize:kC,Layers:FC,Delete:HC,TextEditor:EP,ImageOptions:ka,Color:Gr,ModalDialog:ta,DFieldset:Mt},props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},data:()=>({imageOptionsOpen:!1,canEdit:!0,modalNameInput:"",showRename:!1,localColorHandler:null}),computed:{flip:Si("flip","panels/setFlip"),rotation:Si("rotation","panels/setRotation"),enlargeWhenTalking:Si("enlargeWhenTalking","panels/setEnlargeWhenTalking"),currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},nameboxWidth:{get(){const e=this.object.nameboxWidth;return e===null?"":e},set(e){const t=typeof e=="string"&&e.trim()===""?null:parseInt(e+"");A(()=>Xn(this,null,function*(){this.$store.commit("panels/setObjectNameboxWidth",{id:this.object.id,panelId:this.object.panelId,nameboxWidth:t})}))}},zoom:{get(){return this.object.zoom*100},set(e){A(()=>Xn(this,null,function*(){this.$store.commit("panels/setObjectZoom",{id:this.object.id,panelId:this.object.panelId,zoom:e/100})}))}},defaultNameboxWidth(){return J().TextBox.NameboxWidth},finalColorHandler(){return this.localColorHandler||this.colorHandler||null},hasLabel(){return this.object.label!==null},heading(){var e,t;return(t=(e=this.object.label)!=null?e:this.title)!=null?t:"Object"},useCustomTextboxColor:{get(){return this.object.textboxColor!==null},set(e){A(()=>Xn(this,null,function*(){this.$store.commit("panels/setTextboxColor",{panelId:this.object.panelId,id:this.object.id,textboxColor:e?J().TextBoxCustom.textboxDefaultColor:null})}))}}},methods:{copy(){A(()=>Xn(this,null,function*(){yield this.$store.dispatch("panels/copyObjectToClipboard",{panelId:this.object.panelId,id:this.object.id})}))},enableNameEdit(){var e;this.modalNameInput=(e=this.object.label)!=null?e:"",this.showRename=!0},renameOption(e){this.showRename=!1,e==="Apply"&&A(()=>Xn(this,null,function*(){this.$store.commit("panels/setLabel",{panelId:this.object.panelId,id:this.object.id,label:this.modalNameInput})}))},selectTextboxColor(){this.localColorHandler={title:"Textbox color",get:()=>this.object.textboxColor,set:e=>{A(()=>Xn(this,null,function*(){this.$store.commit("panels/setTextboxColor",{panelId:this.object.panelId,id:this.object.id,textboxColor:e})}))},leave:()=>{this.localColorHandler=null}}}}});const Bo=e=>(Ge("data-v-45c45229"),e=e(),qe(),e),AP={class:"panel"},DP=Bo(()=>u("span",{class:"icon material-icons"},"edit",-1)),RP=Bo(()=>u("p",{class:"modal-text"},"Enter the new name",-1)),FP={class:"modal-text"},MP={class:"input-table"},NP=Bo(()=>u("td",null,[u("label",{for:"rotation"},"Rotation: \xB0")],-1)),HP={key:0},LP=Bo(()=>u("td",null,[u("label",{for:"zoom"},"Zoom: ")],-1)),UP={key:0},VP=Bo(()=>u("td",null,[u("label",{for:"textbox_color"},"Color:")],-1)),WP=Bo(()=>u("td",null,[u("label",{for:"namebox_width"},"Namebox width:")],-1)),zP=["placeholder"];function GP(e,t,n,o,s,r){const i=E("modal-dialog"),a=E("text-editor"),l=E("color"),d=E("image-options"),c=E("position-and-size"),p=E("layers"),f=E("toggle"),b=E("d-fieldset"),v=E("delete");return g(),y("div",AP,[u("h1",{style:Be({fontStyle:e.hasLabel?"italic":"normal"}),onClick:t[0]||(t[0]=(...$)=>e.enableNameEdit&&e.enableNameEdit(...$))},[O(he(e.heading)+" ",1),DP],4),(g(),U(dp,{to:"#modal-messages"},[e.showRename?(g(),U(i,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:e.renameOption,onLeave:t[3]||(t[3]=$=>e.renameOption("Cancel"))},{default:B(()=>[RP,u("p",FP,[ce(u("input",{"onUpdate:modelValue":t[1]||(t[1]=$=>e.modalNameInput=$),style:{width:"100%"},onKeydown:t[2]||(t[2]=Ue(q($=>e.renameOption("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Ae,e.modalNameInput]])])]),_:1},8,["onOption"])):K("",!0)])),e.textHandler?(g(),U(a,{key:0,title:e.textHandler.title,modelValue:e.textHandler.get(),"onUpdate:modelValue":t[4]||(t[4]=$=>e.textHandler.set($)),onLeave:t[5]||(t[5]=$=>e.textHandler.leave())},null,8,["title","modelValue"])):e.finalColorHandler?(g(),U(l,{key:1,title:e.finalColorHandler.title,modelValue:e.finalColorHandler.get(),"onUpdate:modelValue":t[6]||(t[6]=$=>e.finalColorHandler.set($)),onLeave:t[7]||(t[7]=$=>e.finalColorHandler.leave())},null,8,["title","modelValue"])):e.imageOptionsOpen?(g(),U(d,{key:2,type:"object","panel-id":e.object.panelId,id:e.object.id,onLeave:t[8]||(t[8]=$=>e.imageOptionsOpen=!1)},null,8,["panel-id","id"])):e.showAltPanel?Xt(e.$slots,"alt-panel",{key:3},void 0,!0):(g(),y(V,{key:4},[Xt(e.$slots,"default",{},void 0,!0),C(c,{obj:e.object},null,8,["obj"]),C(p,{object:e.object},null,8,["object"]),C(f,{modelValue:e.flip,"onUpdate:modelValue":t[9]||(t[9]=$=>e.flip=$),label:"Flip?"},null,8,["modelValue"]),u("table",MP,[u("tr",null,[NP,u("td",null,[ce(u("input",{id:"rotation",class:"smol",type:"number","onUpdate:modelValue":t[10]||(t[10]=$=>e.rotation=$),onKeydown:t[11]||(t[11]=q(()=>{},["stop"]))},null,544),[[Ae,e.rotation]])])]),e.object.type==="character"||e.object.type==="sprite"?(g(),y("tr",HP,[LP,u("td",null,[ce(u("input",{id:"zoom",type:"number",class:"smol",step:"1",min:"0","onUpdate:modelValue":t[12]||(t[12]=$=>e.zoom=$),onKeydown:t[13]||(t[13]=q(()=>{},["stop"]))},null,544),[[Ae,e.zoom]])])])):K("",!0)]),Xt(e.$slots,"options",{},void 0,!0),e.hasLabel?(g(),U(b,{key:0,title:"Textbox settings"},{default:B(()=>[e.object.type==="character"||e.object.type==="sprite"?(g(),U(f,{key:0,label:"Enlarge when talking",modelValue:e.enlargeWhenTalking,"onUpdate:modelValue":t[14]||(t[14]=$=>e.enlargeWhenTalking=$)},null,8,["modelValue"])):K("",!0),C(f,{label:"Use custom textbox color",modelValue:e.useCustomTextboxColor,"onUpdate:modelValue":t[15]||(t[15]=$=>e.useCustomTextboxColor=$)},null,8,["modelValue"]),u("table",null,[e.useCustomTextboxColor?(g(),y("tr",UP,[VP,u("td",null,[u("button",{id:"textbox_color",class:"color-button",style:Be({background:e.object.textboxColor}),onClick:t[16]||(t[16]=(...$)=>e.selectTextboxColor&&e.selectTextboxColor(...$))},null,4)])])):K("",!0),u("tr",null,[WP,u("td",null,[ce(u("input",{id:"namebox_width",type:"number",placeholder:e.defaultNameboxWidth+"","onUpdate:modelValue":t[17]||(t[17]=$=>e.nameboxWidth=$)},null,8,zP),[[Ae,e.nameboxWidth,void 0,{lazy:!0}]])])])])]),_:1})):K("",!0),u("button",{onClick:t[18]||(t[18]=$=>e.imageOptionsOpen=!0)},"Image options"),u("button",{onClick:t[19]||(t[19]=(...$)=>e.copy&&e.copy(...$))},"Copy"),C(v,{obj:e.object},null,8,["obj"])],64))])}const Ao=oe(BP,[["render",GP],["__scopeId","data-v-45c45229"]]);var Oc=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const xc=_s(),qP=te({mixins:[st],components:{Toggle:Ft,Parts:J$,DFieldset:Mt,ObjectTool:Ao},data:()=>({panelForParts:null}),computed:{flip:xc("flip","panels/setFlip"),closeUp:xc("close","panels/setClose"),missingHead(){const e=this.charData,t=this.object,n=cr(e,t);if(!n)return null;for(const o of n.variants){const s=Mn(o[0],!1);if(console.log(s),s.startsWith("uploads:"))return s.substring(8)}return null},selection(){return this.$store.state.ui.selection},currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.selection];if(e.type==="character")return e},charData(){return Hr(this.$store,this.object)},label(){var e;return(e=this.charData.label)!=null?e:""},parts(){return b$(this.charData,this.object)},hasMultipleStyles(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses(){return this.charData.styleGroups[this.object.styleGroupId].styles[this.object.styleId].poses.length>1}},methods:{reuploadHead(){this.$refs.missingHeadUpload.click()},onMissingHeadFileUpload(e){return Oc(this,null,function*(){const t=this.$refs.missingHeadUpload;if(!t.files)return;if(t.files.length!==1){console.error("More than one file uploaded!");return}const n=t.files[0];yield A(()=>Oc(this,null,function*(){const o=URL.createObjectURL(n);yield this.$store.dispatch("uploadUrls/add",{name:this.missingHead,url:o})}))})},seekPose(e){A(()=>{this.$store.dispatch("panels/seekPose",{id:this.object.id,panelId:this.object.panelId,delta:e})})},seekStyle(e){A(()=>{this.$store.dispatch("panels/seekStyle",{id:this.object.id,panelId:this.object.panelId,delta:e})})},seekPart(e,t){A(()=>{this.$store.dispatch("panels/seekPart",{id:this.object.id,panelId:this.object.panelId,delta:t,part:e})})},captialize(e){return e.charAt(0).toUpperCase()+e.substring(1)}},watch:{selection(){this.panelForParts=null}}});const XP={class:"warning"},KP={style:{"word-wrap":"break-word"}},YP={key:0},JP={class:"arrow-col"},ZP={class:"arrow-col"},QP={key:1},eS={class:"arrow-col"},tS={class:"arrow-col"},nS={class:"arrow-col"},oS=["onClick"],sS=["onClick"],rS={class:"arrow-col"},iS=["onClick"];function lS(e,t,n,o,s,r){const i=E("parts"),a=E("d-fieldset"),l=E("toggle"),d=E("object-tool");return g(),U(d,{object:e.object,title:e.label,showAltPanel:!!e.panelForParts},{"alt-panel":B(()=>[e.panelForParts?(g(),U(i,{key:0,character:e.object,part:e.panelForParts,onLeave:t[0]||(t[0]=c=>e.panelForParts=null),onShowDialog:t[1]||(t[1]=c=>e.$emit("show-dialog",c)),onShowExpressionDialog:t[2]||(t[2]=c=>e.$emit("show-expression-dialog",c))},null,8,["character","part"])):K("",!0)]),default:B(()=>[e.missingHead?(g(),y(V,{key:0},[u("p",XP,[O(" MISSING Head sprite! Click below to re-upload "),u("span",KP,'"'+he(e.missingHead)+'"',1),O(". ")]),u("button",{onClick:t[3]||(t[3]=c=>e.reuploadHead())},"Re-Upload"),u("input",{type:"file",ref:"missingHeadUpload",onChange:t[4]||(t[4]=(...c)=>e.onMissingHeadFileUpload&&e.onMissingHeadFileUpload(...c))},null,544)],64)):K("",!0),e.hasMultiplePoses||e.parts.length>0||e.hasMultipleStyles?(g(),U(a,{key:1,class:"pose-list",title:"Pose:"},{default:B(()=>[u("table",null,[u("tbody",null,[e.hasMultipleStyles?(g(),y("tr",YP,[u("td",JP,[u("button",{onClick:t[5]||(t[5]=c=>e.seekStyle(-1))},"<")]),u("td",null,[u("button",{class:"middle-button",onClick:t[6]||(t[6]=c=>e.panelForParts="style")}," Style ")]),u("td",ZP,[u("button",{onClick:t[7]||(t[7]=c=>e.seekStyle(1))},">")])])):K("",!0),e.hasMultiplePoses?(g(),y("tr",QP,[u("td",eS,[u("button",{onClick:t[8]||(t[8]=c=>e.seekPose(-1))},"<")]),u("td",null,[u("button",{class:"middle-button",onClick:t[9]||(t[9]=c=>e.panelForParts="pose")}," Pose ")]),u("td",tS,[u("button",{onClick:t[10]||(t[10]=c=>e.seekPose(1))},">")])])):K("",!0),(g(!0),y(V,null,Pe(e.parts,c=>(g(),y("tr",{key:c},[u("td",nS,[u("button",{onClick:p=>e.seekPart(c,-1)},"<",8,oS)]),u("td",null,[u("button",{class:"middle-button",onClick:p=>e.panelForParts=c},he(e.captialize(c)),9,sS)]),u("td",rS,[u("button",{onClick:p=>e.seekPart(c,1)},">",8,iS)])]))),128))])])]),_:1})):K("",!0)]),options:B(()=>[C(l,{modelValue:e.closeUp,"onUpdate:modelValue":t[11]||(t[11]=c=>e.closeUp=c),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"])}const aS=oe(qP,[["render",lS],["__scopeId","data-v-570947d4"]]);var jc=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const dS=te({mixins:[st],components:{ObjectTool:Ao},computed:{missing(){for(const e of this.object.assets){const t=Mn(e,!1);if(console.log(t),t.startsWith("uploads:"))return t.substring(8)}return null},currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="sprite")return e}},methods:{reupload(){this.$refs.missingSpriteUpload.click()},onMissingSpriteFileUpload(e){return jc(this,null,function*(){const t=this.$refs.missingSpriteUpload;if(!t.files)return;if(t.files.length!==1){console.error("More than one file uploaded!");return}const n=t.files[0];yield A(()=>jc(this,null,function*(){const o=URL.createObjectURL(n);yield this.$store.dispatch("uploadUrls/add",{name:this.missing,url:o})}))})}}});const cS={class:"warning"},uS={style:{"word-wrap":"break-word"}};function pS(e,t,n,o,s,r){const i=E("object-tool");return g(),U(i,{object:e.object,title:"Custom Sprite"},{default:B(()=>[e.missing?(g(),y(V,{key:0},[u("p",cS,[O(" MISSING SPRITE! Click below to re-upload "),u("span",uS,'"'+he(e.missing)+'"',1),O(". ")]),u("button",{onClick:t[0]||(t[0]=a=>e.reupload())},"Re-Upload"),u("input",{type:"file",ref:"missingSpriteUpload",onChange:t[1]||(t[1]=(...a)=>e.onMissingSpriteFileUpload&&e.onMissingSpriteFileUpload(...a))},null,544)],64)):K("",!0)]),_:1},8,["object"])}const fS=oe(dS,[["render",pS],["__scopeId","data-v-646b1b08"]]);function Ic(e,t,n){return e>t?e:t>n?n:t}var hS=Object.defineProperty,gS=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,Tc=Object.getOwnPropertySymbols,bS=Object.prototype.hasOwnProperty,vS=Object.prototype.propertyIsEnumerable,Ec=(e,t,n)=>t in e?hS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ki=(e,t)=>{for(var n in t||(t={}))bS.call(t,n)&&Ec(e,n,t[n]);if(Tc)for(var n of Tc(t))vS.call(t,n)&&Ec(e,n,t[n]);return e},Bc=(e,t)=>gS(e,mS(t)),yS=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Ac=4,_S={setTalkingObject(e,t){const n=e.panels[t.panelId].objects[t.id];n.talkingObjId=t.talkingObjId,++n.version},setTalkingOther(e,t){const n=e.panels[t.panelId].objects[t.id];n.talkingOther=t.talkingOther,n.talkingObjId="$other$",++n.version},setResetBounds(e,t){const n=e.panels[t.panelId].objects[t.id];n.resetBounds=t.resetBounds,n.x=t.resetBounds.x,n.y=t.resetBounds.y,n.height=t.resetBounds.height,n.width=t.resetBounds.width,n.rotation=t.resetBounds.rotation,++n.version},setTextBoxProperty(e,t){const n=e.panels[t.panelId].objects[t.id];n[t.key]=t.value,++n.version}},wS={createTextBox({commit:e,state:t,rootState:n},o){var s;const r=J(),i=t.panels[o.panelId].lastObjId+1,a=r.TextBox.DefaultTextboxStyle,l=Zo[a],d=o.resetBounds||{x:l.defaultX,y:l.defaultY,width:l.defaultWidth,height:l.defaultHeight,rotation:0};return e("create",{object:Bc(ki(ki({},Io()),d),{panelId:n.panels.currentPanel,id:i,onTop:!0,type:"textBox",preserveRatio:!1,ratio:r.TextBox.TextBoxWidth/r.TextBox.TextBoxHeight,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:a,overrideColor:!1,customColor:r.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:r.TextBoxCustom.controlsDefaultColor,customNameboxColor:r.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:r.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:(s=o.text)!=null?s:"Click here to edit the textbox",resetBounds:d})}),i},setStyle({state:e,commit:t},n){const o=J(),s=e.panels[n.panelId].objects[n.id],r=Zo[s.style],i=Zo[n.style],a=10;let l=!1;const d={panelId:n.panelId,id:n.id,x:s.x,y:s.y};let c=!1;const p={panelId:n.panelId,id:n.id,width:s.width,height:s.height};i.resizable?(r.defaultWidth!==i.defaultWidth&&(c=!0,p.width=Math.max(p.width+i.defaultWidth-r.defaultWidth,a)),r.defaultHeight!==i.defaultHeight&&(c=!0,p.height=Math.max(p.height+i.defaultHeight-r.defaultHeight,a))):(c=!0,p.width=i.defaultWidth,p.height=i.defaultHeight),r.defaultX!==i.defaultX&&(l=!0,d.x=Ic(-p.width+a,d.x+i.defaultX-r.defaultX,o.Base.screenWidth-a)),r.defaultY!==i.defaultY&&(l=!0,d.y=Ic(-p.height+a,d.y+i.defaultY-r.defaultY,o.Base.screenHeight-a)),l&&t("setPosition",d),c&&t("setSize",p),t("setTextBoxProperty",Bf(n.panelId,n.id,"style",n.style))},resetTextboxBounds({commit:e,state:t},n){const o=t.panels[n.panelId].objects[n.id];e("setPosition",{panelId:n.panelId,id:n.id,x:o.resetBounds.x,y:o.resetBounds.y}),e("setSize",{panelId:n.panelId,id:n.id,height:o.resetBounds.height,width:o.resetBounds.width}),e("setRotation",{panelId:n.panelId,id:n.id,rotation:o.resetBounds.rotation})},splitTextbox(e,t){return yS(this,arguments,function*({commit:n,state:o,dispatch:s},r){const i=o.panels[r.panelId].objects[r.id];if(i.type!=="textBox")return;const a=(i.width-Ac)/2,l=a/2+Ac/2,d=[i.x,i.y];let c=[i.x-l,i.y],p=[i.x+l,i.y];i.rotation!==0&&(c=pr(c[0],c[1],d[0],d[1],i.rotation/180*Math.PI),p=pr(p[0],p[1],d[0],d[1],i.rotation/180*Math.PI)),n("setResetBounds",{id:r.id,panelId:r.panelId,resetBounds:{x:c[0],y:c[1],width:a,height:i.height,rotation:i.rotation}});const f=i.style==="custom_plus"?"custom_plus":"custom";i.style!==f&&(yield s("setStyle",Bc(ki({},r),{style:f})));const b=yield s("createTextBox",{panelId:r.panelId,resetBounds:{x:p[0],y:p[1],width:a,height:i.height,rotation:i.rotation}});yield s("setStyle",{panelId:r.panelId,id:b,style:f}),i.flip&&n("setFlip",{id:b,panelId:r.panelId,flip:i.flip})})}};function Bf(e,t,n,o){return{id:t,panelId:e,key:n,value:o}}const Dc=_s(),Lt=$a("panels/setTextBoxProperty"),$S=te({components:{Toggle:Ft,DFieldset:Mt,ObjectTool:Ao,DFlow:ys},mixins:[st],data:()=>({textEditor:"",colorSelect:""}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},customizable(){return this.textBoxStyle.startsWith("custom")},nameboxWidthDefault(){return J().TextBox.NameboxWidth},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="textBox")return e},textHandler(){if(!!this.textEditor)return{title:this.textEditorName,get:()=>this.textEditor==="name"?this.object.talkingOther:this.textEditor==="body"?this.dialog:"",set:e=>{this.textEditor==="name"?this.talkingOther=e:this.textEditor==="body"&&(this.dialog=e)},leave:()=>{this.textEditor=""}}},colorHandler(){if(!!this.colorSelect)return{title:this.colorName,get:()=>{switch(this.colorSelect){case"":return"#000000";case"base":return this.object.customColor;case"controls":return this.object.customControlsColor;case"namebox":return this.object.customNameboxColor;case"nameboxStroke":return this.object.customNameboxStroke;default:throw new _t.UnreachableCaseError(this.colorSelect)}},set:e=>{A(()=>{const t=this.currentPanel.id,n=this.object.id;let o={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[this.colorSelect];e!==void 0&&this.$store.commit("panels/setTextBoxProperty",Bf(t,n,o,e))})},leave:()=>{this.colorSelect=""}}},talkingObjId:{get(){var e;return(e=this.object.talkingObjId)!=null?e:"$null$"},set(e){A(()=>{this.$store.commit("panels/setTalkingObject",{id:this.object.id,panelId:this.object.panelId,talkingObjId:e==="$null$"?null:e})})}},talkingOther:Dc("talkingOther","panels/setTalkingOther"),textBoxStyle:Dc("style","panels/setStyle",!0),showControls:Lt("controls"),allowSkipping:Lt("skip"),autoQuoting:Lt("autoQuoting"),autoWrap:Lt("autoWrap"),showContinueArrow:Lt("continue"),dialog:Lt("text"),overrideColor:Lt("overrideColor"),deriveCustomColors:Lt("deriveCustomColors"),customNameboxWidth:Lt("customNameboxWidth"),nameList(){const e=this.currentPanel,t=[];for(const n of[...e.order,...e.onTopOrder]){const o=e.objects[n];o.label!==null&&t.push([n,o.label])}return t},textEditorName(){return this.textEditor==="name"?"Name":this.textEditor==="body"?"Dialog":""},customControlsColor(){return this.object.customControlsColor},colorName(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new _t.UnreachableCaseError(this.colorSelect)}}},methods:{splitTextbox(){A(()=>{this.$store.dispatch("panels/splitTextbox",{id:this.object.id,panelId:this.object.panelId})})},resetPosition(){A(()=>{this.$store.dispatch("panels/resetTextboxBounds",{id:this.object.id,panelId:this.object.panelId})})},jumpToCharacter(){A(()=>{this.$store.commit("ui/setSelection",this.talkingObjId)})}}});const Xe=e=>(Ge("data-v-73bfcfe3"),e=e(),qe(),e),CS={class:"upper-combos"},PS=Xe(()=>u("td",null,[u("label",{for:"text_style"},"Style:")],-1)),SS={colspan:"2"},kS=Xe(()=>u("option",{value:"normal"},"Normal",-1)),OS=Xe(()=>u("option",{value:"corrupt"},"Corrupt",-1)),xS=Xe(()=>u("option",{value:"custom"},"Custom",-1)),jS=Xe(()=>u("option",{value:"custom_plus"},"Custom (Plus)",-1)),IS=Xe(()=>u("option",{value:"none"},"None",-1)),TS=[kS,OS,xS,jS,IS],ES=Xe(()=>u("td",null,[u("label",{for:"current_talking"},"Person talking:")],-1)),BS=Xe(()=>u("option",{value:"$null$"},"No-one",-1)),AS=["value"],DS=Xe(()=>u("option",{value:"$other$"},"Other",-1)),RS=["disabled"],FS=Xe(()=>u("td",null,[u("label",{for:"custom_name"},"Other name:")],-1)),MS={id:"dialog_text_wrapper"},NS=Xe(()=>u("label",{for:"dialog_text"},"Dialog:",-1)),HS={key:0},LS=Xe(()=>u("td",null,[u("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),US=["placeholder"],VS={colspan:"2"},WS={key:0},zS=Xe(()=>u("td",null,[u("label",{for:"textbox_color"},"Color:")],-1)),GS={key:1},qS={colspan:"2"},XS=Xe(()=>u("td",null,[u("label",{for:"custom_controls_color"},"Controls Color:")],-1)),KS=Xe(()=>u("td",null,[u("label",{for:"custom_namebox_color"},"Namebox Color:")],-1)),YS=Xe(()=>u("td",null,[u("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1));function JS(e,t,n,o,s,r){const i=E("toggle"),a=E("d-flow"),l=E("d-fieldset"),d=E("object-tool");return g(),U(d,{object:e.object,title:"Textbox",textHandler:e.textHandler,colorHandler:e.colorHandler},{default:B(()=>[u("table",CS,[u("tr",null,[PS,u("td",SS,[ce(u("select",{id:"text_style","onUpdate:modelValue":t[0]||(t[0]=c=>e.textBoxStyle=c),onKeydown:t[1]||(t[1]=q(()=>{},["stop"]))},TS,544),[[wt,e.textBoxStyle]])])]),u("tr",null,[ES,u("td",null,[ce(u("select",{id:"current_talking","onUpdate:modelValue":t[2]||(t[2]=c=>e.talkingObjId=c),onKeydown:t[3]||(t[3]=q(()=>{},["stop"]))},[BS,(g(!0),y(V,null,Pe(e.nameList,([c,p])=>(g(),y("option",{key:c,value:c},he(p),9,AS))),128)),DS],544),[[wt,e.talkingObjId]])]),u("td",null,[u("button",{title:"Jump to talking character",onClick:t[4]||(t[4]=(...c)=>e.jumpToCharacter&&e.jumpToCharacter(...c)),disabled:e.talkingObjId==="$null$"||e.talkingObjId==="$other$"}," > ",8,RS)])]),u("tr",null,[FS,u("td",null,[ce(u("input",{id:"custom_name","onUpdate:modelValue":t[5]||(t[5]=c=>e.talkingOther=c),onKeydown:t[6]||(t[6]=q(()=>{},["stop"]))},null,544),[[Ae,e.talkingOther]])]),u("td",null,[u("button",{onClick:t[7]||(t[7]=c=>e.textEditor="name")},"...")])])]),C(i,{label:"Auto quoting?",modelValue:e.autoQuoting,"onUpdate:modelValue":t[8]||(t[8]=c=>e.autoQuoting=c)},null,8,["modelValue"]),C(i,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[9]||(t[9]=c=>e.autoWrap=c)},null,8,["modelValue"]),u("div",MS,[NS,ce(u("textarea",{"onUpdate:modelValue":t[10]||(t[10]=c=>e.dialog=c),id:"dialog_text",onKeydown:t[11]||(t[11]=q(()=>{},["stop"]))},null,544),[[Ae,e.dialog]]),u("button",{onClick:t[12]||(t[12]=c=>e.textEditor="body")},"Formatting")])]),options:B(()=>[C(l,{title:"Customization:",class:fe(e.customizable?"customization-set":"")},{default:B(()=>[C(a,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:B(()=>[C(i,{label:"Controls visible?",modelValue:e.showControls,"onUpdate:modelValue":t[13]||(t[13]=c=>e.showControls=c)},null,8,["modelValue"]),C(i,{label:"Able to skip?",modelValue:e.allowSkipping,"onUpdate:modelValue":t[14]||(t[14]=c=>e.allowSkipping=c)},null,8,["modelValue"]),C(i,{label:"Continue arrow?",modelValue:e.showContinueArrow,"onUpdate:modelValue":t[15]||(t[15]=c=>e.showContinueArrow=c)},null,8,["modelValue"]),e.customizable?(g(),y("table",HS,[u("tr",null,[LS,u("td",null,[ce(u("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:e.nameboxWidthDefault+"","onUpdate:modelValue":t[16]||(t[16]=c=>e.customNameboxWidth=c),onKeydown:t[17]||(t[17]=q(()=>{},["stop"]))},null,40,US),[[Ae,e.customNameboxWidth,void 0,{number:!0}]])])]),u("tr",null,[u("td",VS,[C(i,{modelValue:e.overrideColor,"onUpdate:modelValue":t[18]||(t[18]=c=>e.overrideColor=c),label:"Override color"},null,8,["modelValue"])])]),e.overrideColor?(g(),y("tr",WS,[zS,u("td",null,[u("button",{id:"textbox_color",class:"color-button",style:Be({background:e.object.customColor}),onClick:t[19]||(t[19]=c=>e.colorSelect="base")},null,4)])])):K("",!0),e.overrideColor?(g(),y("tr",GS,[u("td",qS,[C(i,{id:"derive_custom_colors",modelValue:e.deriveCustomColors,"onUpdate:modelValue":t[20]||(t[20]=c=>e.deriveCustomColors=c),label:"Derive other colors"},null,8,["modelValue"])])])):K("",!0),e.overrideColor&&!e.deriveCustomColors?(g(),y(V,{key:2},[u("tr",null,[XS,u("td",null,[u("button",{id:"custom_controls_color",class:"color-button",style:Be({background:e.object.customControlsColor}),onClick:t[21]||(t[21]=c=>e.colorSelect="controls")},null,4)])]),u("tr",null,[KS,u("td",null,[u("button",{id:"custom_namebox_color",class:"color-button",style:Be({background:e.object.customNameboxColor}),onClick:t[22]||(t[22]=c=>e.colorSelect="namebox")},null,4)])]),u("tr",null,[YS,u("td",null,[u("button",{id:"custom_namebox_stroke",class:"color-button",style:Be({background:e.object.customNameboxStroke}),onClick:t[23]||(t[23]=c=>e.colorSelect="nameboxStroke")},null,4)])])],64)):K("",!0)])):K("",!0)]),_:1})]),_:1},8,["class"]),u("button",{onClick:t[24]||(t[24]=(...c)=>e.resetPosition&&e.resetPosition(...c))},"Reset position"),u("button",{onClick:t[25]||(t[25]=(...c)=>e.splitTextbox&&e.splitTextbox(...c))},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"])}const ZS=oe($S,[["render",JS],["__scopeId","data-v-73bfcfe3"]]),QS=_s(),ek=te({mixins:[st],components:{Toggle:Ft,DFieldset:Mt,DFlow:ys,ObjectTool:Ao},data:()=>({currentIdx:0,textEditor:!1}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="choice")return e},autoWrap:QS("autoWrap","panels/setAutoWrapping"),buttonText:tk("text"),buttons(){return this.object.choices},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.buttonText,set:e=>{this.buttonText=e},leave:()=>{this.textEditor=!1}}}},methods:{select(e){this.currentIdx=e},addChoice(){A(()=>{this.$store.dispatch("panels/addChoice",{id:this.object.id,panelId:this.object.panelId,text:""})})},removeChoice(){A(()=>{this.currentIdx===this.object.choices.length-1&&this.currentIdx>0&&this.select(this.currentIdx-1),this.$store.dispatch("panels/removeChoice",{id:this.object.id,panelId:this.object.panelId,choiceIdx:this.currentIdx})})}}});function tk(e){return{get(){return this.object.choices[this.currentIdx][e]},set(t){A(()=>{this.$store.commit("panels/setChoiceProperty",{id:this.object.id,panelId:this.object.panelId,choiceIdx:this.currentIdx,key:e,value:t})})}}}const nk=e=>(Ge("data-v-576e0f6a"),e=e(),qe(),e),ok=["onClick"],sk=nk(()=>u("tr",null,[u("td",{colspan:"2"},[u("label",{for:"choice-button-input"},"Text")])],-1));function rk(e,t,n,o,s,r){const i=E("d-flow"),a=E("d-fieldset"),l=E("toggle"),d=E("object-tool");return g(),U(d,{object:e.object,title:"Choice",textHandler:e.textHandler},{default:B(()=>[C(a,{class:"buttons",title:"Buttons:"},{default:B(()=>[C(i,{maxSize:"100%",direction:"vertical",noWraping:""},{default:B(()=>[(g(!0),y(V,null,Pe(e.buttons,(c,p)=>(g(),y("div",{class:fe({choiceBtn:!0,active:p===e.currentIdx}),key:p,onClick:f=>e.select(p)},he(c.text.trim()===""?"[Empty]":c.text),11,ok))),128))]),_:1})]),_:1}),C(a,{class:"current_button",title:"Current button:"},{default:B(()=>[u("table",null,[sk,u("tr",null,[u("td",null,[ce(u("input",{id:"choice-button-input","onUpdate:modelValue":t[0]||(t[0]=c=>e.buttonText=c),onKeydown:t[1]||(t[1]=q(()=>{},["stop"]))},null,544),[[Ae,e.buttonText]])]),u("td",null,[u("button",{onClick:t[2]||(t[2]=c=>e.textEditor=!0)},"...")])])])]),_:1}),u("button",{onClick:t[3]||(t[3]=(...c)=>e.addChoice&&e.addChoice(...c))},"Add"),u("button",{onClick:t[4]||(t[4]=(...c)=>e.removeChoice&&e.removeChoice(...c))},"Remove"),C(l,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[5]||(t[5]=c=>e.autoWrap=c)},null,8,["modelValue"])]),_:1},8,["object","textHandler"])}const ik=oe(ek,[["render",rk],["__scopeId","data-v-576e0f6a"]]),lk=te({mixins:[st],components:{L:na}});const Qt=e=>(Ge("data-v-2d991647"),e=e(),qe(),e),ak={class:"panel"},dk=Qt(()=>u("h1",null,"Help and Credits",-1)),ck=Qt(()=>u("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),uk=Qt(()=>u("p",null,[O(" Doki Doki Dialog Generator developed by EDave64 "),u("br"),O("Based on gemdude46's DDLC Shitpost generator ")],-1)),pk=Qt(()=>u("p",null,[O(" MC Sprite by Childish-N "),u("br"),O("MC Casual Sprite by SlightlySimple "),u("br"),O("MC Chibi by SlightlySimple ")],-1)),fk=Qt(()=>u("p",null,[O(" MC Chad Sprite by Cylent-Nite "),u("br"),O("MC Chad Poses and expressions by SlightlySimple "),u("br"),O("MC Chad Poses and chibi by Meddy-sin ")],-1)),hk=Qt(()=>u("p",null,[O(" FeMC Sprite by Meddy-sin "),u("br"),O("FeMC Casual Sprite by SlightlySimple ")],-1)),gk=Qt(()=>u("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),mk=Qt(()=>u("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),bk=Qt(()=>u("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1));function vk(e,t,n,o,s,r){const i=E("l");return g(),y("div",ak,[dk,C(i,{class:"btn",to:"wiki://Dokumentation"},{default:B(()=>[O("Help")]),_:1}),C(i,{class:"btn",to:"github://"},{default:B(()=>[O("Fork me on GitHub")]),_:1}),C(i,{class:"btn",to:"wiki://Privacy Statement"},{default:B(()=>[O("Privacy Statement")]),_:1}),ck,uk,u("p",null,[O(" Unused House Background by "),C(i,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:B(()=>[O(" Fatelogic ")]),_:1})]),u("p",null,[O(" Aller Font by "),C(i,{to:"https://www.daltonmaag.com/library/aller"},{default:B(()=>[O("Dalton Maag Ltd")]),_:1})]),u("p",null,[O(" Riffic Bold Font by "),C(i,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:B(()=>[O("InkyType")]),_:1})]),u("p",null,[O(" Verily Serif Mono Font by "),C(i,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:B(()=>[O("Stephen G. Hartke")]),_:1})]),u("p",null,[O(" F25 Bank Printer Font by "),C(i,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:B(()=>[O("F25 Digital Typeface Design")]),_:1})]),u("p",null,[O(" Journal Font by "),C(i,{to:"https://www.dafont.com/journal.font"},{default:B(()=>[O("Fontourist")]),_:1})]),u("p",null,[O(" Hashtag Font by "),C(i,{to:"https://www.dafont.com/hashtag.font"},{default:B(()=>[O(" TitanVex")]),_:1})]),u("p",null,[O(" JP Hand Slanted Font by "),C(i,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:B(()=>[O("Jonathan Paterson")]),_:1})]),u("p",null,[O(" As I Lay Dying Font by "),C(i,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:B(()=>[O("Moises Esqueda")]),_:1})]),u("p",null,[O(" Damagrafik Script Font by "),C(i,{to:"https://www.dafont.com/damagrafik-script.font"},{default:B(()=>[O("Davide Terenzi")]),_:1})]),u("p",null,[O(" Ammy's Handwriting Font by "),C(i,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:B(()=>[O("Ammy K.")]),_:1})]),u("p",null,[O(" Halogen Font by "),C(i,{to:"https://www.dafont.com/halogen.font"},{default:B(()=>[O("JLH Fonts")]),_:1})]),pk,u("p",null,[C(i,{to:"https://www.reddit.com/ofkg59"},{default:B(()=>[O("Concept MC")]),_:1}),O(" by StormBlazed76, "),C(i,{to:"https://www.reddit.com/og6shh"},{default:B(()=>[O("red")]),_:1}),O(" and "),C(i,{to:"https://www.reddit.com/oft3vb"},{default:B(()=>[O("yellow")]),_:1}),O(" eyes by YinuS_WinneR, "),C(i,{to:"https://www.reddit.com/ofof3o"},{default:B(()=>[O("chibi")]),_:1}),O(" by Hadrosaur838 ")]),fk,hk,u("p",null,[C(i,{to:"https://www.reddit.com/oizaow"},{default:B(()=>[O("Concept FeMC")]),_:1}),O(" by ShidoDraws, "),C(i,{to:"https://www.reddit.com/oosuxu"},{default:B(()=>[O("additional poses, expressions and chibi")]),_:1}),O(" by SlightlySimple ")]),gk,mk,bk])}const yk=oe(lk,[["render",vk],["__scopeId","data-v-2d991647"]]),_k=te({props:{backgroundId:{type:String,required:!0}},data:()=>({isWebPSupported:null,assets:[]}),computed:{background(){const e=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[e].background},bgData(){return this.$store.getters["content/getBackgrounds"].get(this.backgroundId)||null},isActive(){return this.backgroundId===this.background.current},title(){var e;switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return(e=this.bgData.label)!=null?e:""},style(){var e;switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}const t=(e=this.bgData)==null?void 0:e.variants[0].map(n=>`url('${Mn(n,!1)}')`).join(",");return{backgroundImage:t!=null?t:""}}}});const wk=["title"];function $k(e,t,n,o,s,r){return g(),y("div",{class:fe({background:!0,active:e.isActive}),title:e.title,style:Be(e.style),tabindex:"0",onClick:t[0]||(t[0]=i=>e.$emit("input",e.backgroundId)),onKeydown:[t[1]||(t[1]=Ue(i=>e.$emit("input",e.backgroundId),["enter"])),t[2]||(t[2]=Ue(q(i=>e.$emit("input",e.backgroundId),["prevent"]),["space"]))]},he(e.title),47,wk)}const Ck=oe(_k,[["render",$k],["__scopeId","data-v-f141eda2"]]),Pk=te({components:{Toggle:Ft,DFieldset:Mt},computed:{vertical(){return this.$store.state.ui.vertical},color:{get(){return this.background.color},set(e){A(()=>{this.$store.commit("panels/setBackgroundColor",{color:e,panelId:this.$store.state.panels.currentPanel})})}},flipped:{get(){return this.background.flipped},set(e){A(()=>{this.$store.commit("panels/setBackgroundFlipped",{flipped:e,panelId:this.$store.state.panels.currentPanel})})}},scaling:{get(){return this.background.scaling.toString()},set(e){A(()=>{this.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(e,10),panelId:this.$store.state.panels.currentPanel})})}},currentBackgroundId(){return this.background.current},background(){const e=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[e].background},bgData(){return this.$store.state.content.current.backgrounds.find(e=>e.id===this.currentBackgroundId)||null},isColor(){return this.currentBackgroundId==="buildin.static-color"},isVariant(){return!!this.bgData},hasVariants(){return this.bgData?this.bgData.variants.length>1:!1}},methods:{seekVariant(e){A(()=>{this.$store.dispatch("panels/seekBackgroundVariant",{delta:e,panelId:this.$store.state.panels.currentPanel})})}}});const ks=e=>(Ge("data-v-d37e8efc"),e=e(),qe(),e),Sk=ks(()=>u("label",{for:"bg_color"},"Color:",-1)),kk={key:1},Ok={colspan:"3"},xk={key:0},jk={class:"arrow-col"},Ik=ks(()=>u("td",{style:{"text-align":"center"}},"Variant",-1)),Tk={class:"arrow-col"},Ek={colspan:"3"},Bk=ks(()=>u("option",{value:"0"},"None",-1)),Ak=ks(()=>u("option",{value:"1"},"Stretch",-1)),Dk=ks(()=>u("option",{value:"2"},"Cover",-1)),Rk=[Bk,Ak,Dk],Fk={colspan:"3"};function Mk(e,t,n,o,s,r){const i=E("toggle"),a=E("d-fieldset");return g(),U(a,{class:fe({"bg-settings":!0,vertical:e.vertical}),title:"Settings:"},{default:B(()=>[e.isColor?(g(),y(V,{key:0},[Sk,u("button",{id:"bg_color",class:"color-button",style:Be({background:e.color}),onClick:t[0]||(t[0]=l=>e.$emit("change-color"))},null,4)],64)):K("",!0),e.isVariant?(g(),y("table",kk,[u("tr",null,[u("td",Ok,[C(i,{modelValue:e.flipped,"onUpdate:modelValue":t[1]||(t[1]=l=>e.flipped=l),label:"Flipped?"},null,8,["modelValue"])])]),e.hasVariants?(g(),y("tr",xk,[u("td",jk,[u("button",{class:"small-button",onClick:t[2]||(t[2]=l=>e.seekVariant(-1))},"<")]),Ik,u("td",Tk,[u("button",{class:"small-button",onClick:t[3]||(t[3]=l=>e.seekVariant(1))},">")])])):K("",!0),u("tr",null,[u("td",Ek,[ce(u("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.scaling=l),onKeydown:t[5]||(t[5]=q(()=>{},["stop"]))},Rk,544),[[wt,e.scaling]])])]),u("tr",null,[u("td",Fk,[u("button",{id:"image_options_button",onClick:t[6]||(t[6]=l=>e.$emit("open-image-options"))}," Image options ")])])])):K("",!0)]),_:1},8,["class"])}const Nk=oe(Pk,[["render",Mk],["__scopeId","data-v-d37e8efc"]]);var Hk=Object.defineProperty,Lk=Object.defineProperties,Uk=Object.getOwnPropertyDescriptors,Rc=Object.getOwnPropertySymbols,Vk=Object.prototype.hasOwnProperty,Wk=Object.prototype.propertyIsEnumerable,Fc=(e,t,n)=>t in e?Hk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zk=(e,t)=>{for(var n in t||(t={}))Vk.call(t,n)&&Fc(e,n,t[n]);if(Rc)for(var n of Rc(t))Wk.call(t,n)&&Fc(e,n,t[n]);return e},Gk=(e,t)=>Lk(e,Uk(t)),Mc=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Oi={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},qk=te({mixins:[st],components:{BackgroundButton:Ck,BackgroundSettings:Nk,DropTarget:Ip,Color:Gr,ImageOptions:ka,DButton:Ln},data:()=>({colorSelect:!1,imageOptions:!1}),computed:{bgColor:{get(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set(e){A(()=>{this.$store.commit("panels/setBackgroundColor",{color:e,panelId:this.$store.state.panels.currentPanel})})}},backgrounds(){return[...this.$store.state.content.current.backgrounds.map(e=>e.id),"buildin.static-color","buildin.transparent"]},showBackgroundsFolder(){return X.supports.openableFolders.has("backgrounds")}},methods:{setBackground(e){this.$store.commit("panels/setCurrentBackground",{current:e,panelId:this.$store.state.panels.currentPanel})},onFileUpload(e){const t=this.$refs.upload;if(!!t.files)for(const n of t.files)this.addImageFile(n)},addImageFile(e){return Mc(this,null,function*(){yield A(()=>Mc(this,null,function*(){const t=URL.createObjectURL(e),n=yield this.$store.dispatch("uploadUrls/add",{name:e.name,url:t});this.addNewCustomBackground(e.name,e.name,n)}))})},addByUrl(){const e=prompt("Enter the URL of the image");if(e==null)return;const t=e.split("/").slice(-1)[0];this.addNewCustomBackground(t,t,e)},addNewCustomBackground(e,t,n){const o=this.$store.state.content.contentPacks.find(r=>r.packId===Oi.packId)||Oi,s=Gk(zk({},o),{backgrounds:[...o.backgrounds,{id:e,label:t,variants:[[{hq:n,lq:n,sourcePack:Oi.packId}]],scaling:"none"}]});A(()=>{this.$store.dispatch("content/replaceContentPack",{contentPack:s,processed:!0}),this.setBackground(e)})},dragEnter(e){!e.dataTransfer||(e.dataTransfer.effectAllowed="none",Array.from(e.dataTransfer.items).find(t=>t.type.match(/^image.*$/))&&(e.dataTransfer.effectAllowed="link",this.$refs.dt.show()))},openBackgroundFolder(){X.openFolder("backgrounds")}}});const Af=e=>(Ge("data-v-f370e333"),e=e(),qe(),e),Xk=Af(()=>u("h1",null,"Background",-1)),Kk=Af(()=>u("i",{class:"material-icons"},"extension",-1));function Yk(e,t,n,o,s,r){const i=E("drop-target"),a=E("color"),l=E("image-options"),d=E("background-settings"),c=E("d-button"),p=E("background-button");return g(),y("div",{class:"panel",onDragenter:t[9]||(t[9]=(...f)=>e.dragEnter&&e.dragEnter(...f)),onMouseleave:t[10]||(t[10]=f=>e.$refs.dt.hide())},[C(i,{ref:"dt",class:"drop-target",onDrop:e.addImageFile},{default:B(()=>[O("Drop here to add as a new background ")]),_:1},8,["onDrop"]),Xk,e.colorSelect?(g(),U(a,{key:0,modelValue:e.bgColor,"onUpdate:modelValue":t[0]||(t[0]=f=>e.bgColor=f),onLeave:t[1]||(t[1]=f=>e.colorSelect=!1)},null,8,["modelValue"])):e.imageOptions?(g(),U(l,{key:1,type:"background",title:"","panel-id":e.$store.state.panels.currentPanel,"no-composition":"",onLeave:t[2]||(t[2]=f=>e.imageOptions=!1)},null,8,["panel-id"])):(g(),y(V,{key:2},[C(d,{onChangeColor:t[3]||(t[3]=f=>e.colorSelect=!0),onOpenImageOptions:t[4]||(t[4]=f=>e.imageOptions=!0)}),u("button",{class:"btn upload-background",onClick:t[6]||(t[6]=f=>e.$refs.upload.click())},[O(" Upload "),u("input",{type:"file",ref:"upload",onChange:t[5]||(t[5]=(...f)=>e.onFileUpload&&e.onFileUpload(...f))},null,544)]),u("button",{class:"upload-background",onClick:t[7]||(t[7]=(...f)=>e.addByUrl&&e.addByUrl(...f))},"Add by URL"),u("button",{class:"upload-background",onClick:t[8]||(t[8]=f=>e.$emit("show-dialog","type: Backgrounds"))},[Kk,O(" Search in content packs ")]),e.showBackgroundsFolder?(g(),U(c,{key:0,icon:"folder",class:"upload-background",onClick:e.openBackgroundFolder},{default:B(()=>[O(" Open backgrounds folder ")]),_:1},8,["onClick"])):K("",!0),(g(!0),y(V,null,Pe(e.backgrounds,f=>(g(),U(p,{key:f,backgroundId:f,onInput:b=>e.setBackground(f)},null,8,["backgroundId","onInput"]))),128))],64))],32)}const Jk=oe(qk,[["render",Yk],["__scopeId","data-v-f370e333"]]);var Zk=Object.defineProperty,Qk=Object.defineProperties,eO=Object.getOwnPropertyDescriptors,Nc=Object.getOwnPropertySymbols,tO=Object.prototype.hasOwnProperty,nO=Object.prototype.propertyIsEnumerable,Hc=(e,t,n)=>t in e?Zk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oO=(e,t)=>{for(var n in t||(t={}))tO.call(t,n)&&Hc(e,n,t[n]);if(Nc)for(var n of Nc(t))nO.call(t,n)&&Hc(e,n,t[n]);return e},sO=(e,t)=>Qk(e,eO(t)),rO=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const iO={},lO={createSprite(e,t){return rO(this,arguments,function*({commit:n,rootState:o,state:s},r){const i=yield Er(r.assets[0],!1);if(!(i instanceof Zl))return;const a=s.panels[r.panelId].lastObjId+1;return n("create",{object:sO(oO({},Io()),{assets:r.assets,height:i.height,width:i.width,id:a,panelId:o.panels.currentPanel,onTop:!1,preserveRatio:!0,ratio:i.width/i.height,type:"sprite",y:0,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})}),a})}};var aO=Object.defineProperty,dO=Object.defineProperties,cO=Object.getOwnPropertyDescriptors,Lc=Object.getOwnPropertySymbols,uO=Object.prototype.hasOwnProperty,pO=Object.prototype.propertyIsEnumerable,Uc=(e,t,n)=>t in e?aO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fO=(e,t)=>{for(var n in t||(t={}))uO.call(t,n)&&Uc(e,n,t[n]);if(Lc)for(var n of Lc(t))pO.call(t,n)&&Uc(e,n,t[n]);return e},hO=(e,t)=>dO(e,cO(t));const gO={setChoicesProperty(e,t){const n=e.panels[t.panelId].objects[t.id];n[t.key]=t.value,++n.version},setChoiceProperty(e,t){const n=e.panels[t.panelId].objects[t.id];n.choices[t.choiceIdx][t.key]=t.value,++n.version},setChoices(e,t){const n=e.panels[t.panelId].objects[t.id];n.choices=t.choices,++n.version}},mO={createChoice({commit:e,rootState:t,state:n},o){const s=J(),r=n.panels[o.panelId].lastObjId+1;return e("create",{object:hO(fO({},Io()),{y:s.Choices.ChoiceY,width:s.Choices.ChoiceButtonWidth,height:0,panelId:t.panels.currentPanel,id:r,onTop:!0,autoWrap:!0,type:"choice",preserveRatio:!1,ratio:s.TextBox.TextBoxWidth/s.TextBox.TextBoxHeight,choiceDistance:s.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:s.Choices.ChoiceButtonColor})}),r},addChoice({state:e,commit:t},n){const o=e.panels[n.panelId].objects[n.id];t("setChoices",{id:n.id,panelId:n.panelId,choices:[...o.choices,{selected:!1,text:n.text}]})},removeChoice({state:e,commit:t},n){const s=[...e.panels[n.panelId].objects[n.id].choices];s.splice(n.choiceIdx,1),s.length===0&&s.push({selected:!1,text:""}),t("setChoices",{id:n.id,panelId:n.panelId,choices:s})}};var bO=Object.defineProperty,vO=Object.defineProperties,yO=Object.getOwnPropertyDescriptors,Vc=Object.getOwnPropertySymbols,_O=Object.prototype.hasOwnProperty,wO=Object.prototype.propertyIsEnumerable,Wc=(e,t,n)=>t in e?bO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$O=(e,t)=>{for(var n in t||(t={}))_O.call(t,n)&&Wc(e,n,t[n]);if(Vc)for(var n of Vc(t))wO.call(t,n)&&Wc(e,n,t[n]);return e},CO=(e,t)=>vO(e,yO(t));const PO={setNotificationProperty(e,t){const n=e.panels[t.panelId].objects[t.id];n[t.key]=t.value,++n.version}},SO={createNotification({commit:e,rootState:t,state:n},o){const s=J(),r=n.panels[o.panelId].lastObjId+1;return e("create",{object:CO($O({},Io()),{y:s.Base.screenHeight/2,width:s.Choices.ChoiceButtonWidth,height:0,panelId:t.panels.currentPanel,autoWrap:!1,id:r,onTop:!0,type:"notification",preserveRatio:!1,ratio:s.TextBox.TextBoxWidth/s.TextBox.TextBoxHeight,customColor:s.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),r}};var kO=Object.defineProperty,OO=Object.defineProperties,xO=Object.getOwnPropertyDescriptors,zc=Object.getOwnPropertySymbols,jO=Object.prototype.hasOwnProperty,IO=Object.prototype.propertyIsEnumerable,Gc=(e,t,n)=>t in e?kO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,TO=(e,t)=>{for(var n in t||(t={}))jO.call(t,n)&&Gc(e,n,t[n]);if(zc)for(var n of zc(t))IO.call(t,n)&&Gc(e,n,t[n]);return e},EO=(e,t)=>OO(e,xO(t));const BO={setPoemProperty(e,t){const n=e.panels[t.panelId].objects[t.id];n[t.key]=t.value,++n.version}},AO={createPoem({commit:e,rootState:t,state:n},o){const s=J(),r=n.panels[o.panelId].lastObjId+1;return e("create",{object:{subType:"poem",x:s.Poem.defaultX,y:s.Poem.defaultY,width:s.Poem.defaultPoemWidth,height:s.Poem.defaultPoemHeight,panelId:t.panels.currentPanel,flip:!1,rotation:0,id:r,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:s.Poem.defaultPoemWidth/s.Poem.defaultPoemHeight,background:s.Poem.defaultPoemBackground,font:s.Poem.defaultPoemStyle,text:`New poem

Click here to edit poem`,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,zoom:1,consoleColor:s.Poem.consoleBackgroundColor}}),r},createConsole({commit:e,rootState:t,state:n},o){const s=J(),r=n.panels[o.panelId].lastObjId+1;return e("create",{object:EO(TO({},Io()),{subType:"console",x:s.Poem.consoleWidth/2,y:s.Poem.consoleHeight/2,width:s.Poem.consoleWidth,height:s.Poem.consoleHeight,panelId:t.panels.currentPanel,id:r,onTop:!0,type:"poem",preserveRatio:!1,ratio:s.Poem.consoleWidth/s.Poem.consoleHeight,background:s.Poem.defaultConsoleBackground,font:s.Poem.defaultConsoleStyle,text:`> _
  
  Console command
  Click here to edit`,autoWrap:!0,consoleColor:s.Poem.consoleBackgroundColor})}),r}};var DO=Object.defineProperty,RO=Object.defineProperties,FO=Object.getOwnPropertyDescriptors,qc=Object.getOwnPropertySymbols,MO=Object.prototype.hasOwnProperty,NO=Object.prototype.propertyIsEnumerable,Xc=(e,t,n)=>t in e?DO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t)=>{for(var n in t||(t={}))MO.call(t,n)&&Xc(e,n,t[n]);if(qc)for(var n of qc(t))NO.call(t,n)&&Xc(e,n,t[n]);return e},Kc=(e,t)=>RO(e,FO(t));const HO=Je(Je(Je(Je(Je(Je({create(e,{object:t}){const n=e.panels[t.panelId];t.id>n.lastObjId&&(n.lastObjId=t.id),n.objects[t.id]=t,(t.onTop?n.onTopOrder:n.order).push(t.id)},removeFromList(e,t){const n=e.panels[t.panelId],o=t.onTop?n.onTopOrder:n.order,s=o.indexOf(t.id);o.splice(s,1)},addToList(e,t){const n=e.panels[t.panelId];(t.onTop?n.onTopOrder:n.order).splice(t.position,0,t.id)},setOnTop(e,t){const o=e.panels[t.panelId].objects[t.id];o.onTop=t.onTop},setPosition(e,t){const o=e.panels[t.panelId].objects[t.id];o.x=t.x,o.y=t.y},setFlip(e,t){const o=e.panels[t.panelId].objects[t.id];o.flip=t.flip},setSize(e,t){const o=e.panels[t.panelId].objects[t.id];o.width=t.width,o.height=t.height},setRatio(e,t){const o=e.panels[t.panelId].objects[t.id];o.preserveRatio=t.preserveRatio,o.ratio=t.ratio},setRotation(e,t){const o=e.panels[t.panelId].objects[t.id];o.rotation=t.rotation<0?360-Math.abs(t.rotation)%360:t.rotation%360},removeObject(e,t){const n=e.panels[t.panelId];delete n.objects[t.id]},setComposition(e,t){const o=e.panels[t.panelId].objects[t.id];o.composite=t.composite},object_setFilters(e,t){const o=e.panels[t.panelId].objects[t.id];o.filters=t.filters},setLabel(e,t){const o=e.panels[t.panelId].objects[t.id];o.label=t.label,++o.version},setTextboxColor(e,t){const o=e.panels[t.panelId].objects[t.id];o.textboxColor=t.textboxColor,++o.version},setEnlargeWhenTalking(e,t){const o=e.panels[t.panelId].objects[t.id];o.enlargeWhenTalking=t.enlargeWhenTalking,++o.version},setObjectNameboxWidth(e,t){const o=e.panels[t.panelId].objects[t.id];o.nameboxWidth=t.nameboxWidth,++o.version},setObjectZoom(e,t){const o=e.panels[t.panelId].objects[t.id];o.zoom=t.zoom,++o.version}},iO),m$),_S),gO),PO),BO),LO=Je(Je(Je(Je(Je(Je({removeObject({state:e,commit:t,rootState:n},o){var s;const r=e.panels[o.panelId],i=r.objects[o.id];n.ui.selection===o.id&&t("ui/setSelection",null,{root:!0});for(const a of[...r.onTopOrder,...r.order]){const l=r.objects[a];i.id===a||l.type!=="textBox"||l.talkingObjId===i.id&&t("setTalkingOther",{id:l.id,talkingOther:(s=i.label)!=null?s:"",panelId:o.panelId})}t("removeFromList",{id:o.id,panelId:o.panelId,onTop:i.onTop}),t("removeObject",{id:o.id,panelId:o.panelId})},setPosition({state:e,commit:t,dispatch:n},o){e.panels[o.panelId].objects[o.id].type==="character"?n("setCharacterPosition",o):t("setPosition",o)},setOnTop({state:e,commit:t},n){const o=e.panels[n.panelId],s=o.objects[n.id];s.onTop!==n.onTop&&(t("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),t("addToList",{id:n.id,panelId:n.panelId,position:(n.onTop?o.onTopOrder:o.order).length,onTop:n.onTop}),t("setOnTop",{panelId:n.panelId,id:n.id,onTop:n.onTop}))},shiftLayer({state:e,commit:t},n){const o=e.panels[n.panelId],s=o.objects[n.id],r=s.onTop?o.onTopOrder:o.order;let a=r.indexOf(s.id)+n.delta;a<0&&(a=0),a>r.length&&(a=r.length),t("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),t("addToList",{panelId:n.panelId,id:n.id,position:a,onTop:s.onTop})},setPreserveRatio({commit:e,state:t},n){const s=t.panels[n.panelId].objects[n.id],r=n.preserveRatio?s.width/s.height:0;e("setRatio",{panelId:n.panelId,id:n.id,preserveRatio:n.preserveRatio,ratio:r})},setWidth({commit:e,state:t},n){const s=t.panels[n.panelId].objects[n.id],r=s.preserveRatio?n.width/s.ratio:s.height;e("setSize",{panelId:n.panelId,id:n.id,height:r,width:n.width})},setHeight({commit:e,state:t},n){const s=t.panels[n.panelId].objects[n.id],r=s.preserveRatio?n.height*s.ratio:s.width;e("setSize",{panelId:n.panelId,id:n.id,height:n.height,width:r})},copyObjects({commit:e,state:t},{sourcePanelId:n,targetPanelId:o}){const s=t.panels[n],r=t.panels[o],i=[...s.onTopOrder,...s.order],a=new Map;let l=r.lastObjId;for(const d of i){const c=++l;a.set(d,c)}for(const d of i){const c=s.objects[d],p=JSON.parse(JSON.stringify(c));if("talkingObjId"in p){const f=p;f.talkingObjId!==null&&f.talkingObjId!=="$other$"&&a.has(f.talkingObjId)&&(f.talkingObjId=a.get(f.talkingObjId))}e("create",{object:Kc(Je({},p),{id:a.get(d),panelId:o})})}},copyObjectToClipboard({commit:e,state:t},{id:n,panelId:o}){const s=t.panels[o].objects[n];e("ui/setClipboard",JSON.stringify(s),{root:!0})},pasteObjectFromClipboard({commit:e,state:t,rootState:n}){if(n.ui.clipboard==null)return;const o=JSON.parse(n.ui.clipboard);e("create",{object:Kc(Je({},o),{id:t.panels[t.currentPanel].lastObjId+1,panelId:t.currentPanel})})},object_addFilter({state:e,commit:t},n){gl(n,()=>e.panels[n.panelId].objects[n.id],o=>t("object_setFilters",o))},object_removeFilter({state:e,commit:t},n){ml(n,()=>e.panels[n.panelId].objects[n.id],o=>t("object_setFilters",o))},object_moveFilter({state:e,commit:t},n){bl(n,()=>e.panels[n.panelId].objects[n.id],o=>t("object_setFilters",o))},object_setFilter({state:e,commit:t},n){vl(n,()=>e.panels[n.panelId].objects[n.id],o=>t("object_setFilters",o))}},lO),v$),wS),mO),SO),AO);function UO(e,t){const n=e.state.panels;for(const o in n){const s=n[o];for(const r in s.objects){const i=s.objects[r];if(i.type==="character"){y$(e,i.panelId,i.id,t);return}}}}var VO=Object.defineProperty,WO=Object.defineProperties,zO=Object.getOwnPropertyDescriptors,Yc=Object.getOwnPropertySymbols,GO=Object.prototype.hasOwnProperty,qO=Object.prototype.propertyIsEnumerable,Jc=(e,t,n)=>t in e?VO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xi=(e,t)=>{for(var n in t||(t={}))GO.call(t,n)&&Jc(e,n,t[n]);if(Yc)for(var n of Yc(t))qO.call(t,n)&&Jc(e,n,t[n]);return e},XO=(e,t)=>WO(e,zO(t)),qs=(e=>(e[e.None=0]="None",e[e.Stretch=1]="Stretch",e[e.Cover=2]="Cover",e))(qs||{});const KO="buildin.transparent",Ns={panelToUrl:new Map,urlToPanel:new Map,register(e,t){if(this.panelToUrl.has(e)){if(this.panelToUrl.get(e)===t)return;this.unregister(e,this.panelToUrl.get(e))}this.panelToUrl.set(e,t),this.urlToPanel.has(t)?this.urlToPanel.get(t).push(e):this.urlToPanel.set(t,[e])},unregister(e,t){if(this.urlToPanel.has(t)){const n=this.urlToPanel.get(t);n.splice(n.indexOf(e),1),n.length===0&&(this.urlToPanel.delete(t),URL.revokeObjectURL(t))}this.panelToUrl.delete(e)}},YO={namespaced:!0,state:{lastPanelId:-1,panels:{},panelOrder:[],currentPanel:null},mutations:xi({setCurrentPanel(e,{panelId:t}){e.currentPanel=t},setPanelPreview(e,{panelId:t,url:n}){e.panels[t].lastRender=n,Ns.register(t,n)},createPanel(e,{panel:t}){e.lastPanelId=t.id,e.panels[t.id]=t},setPanelOrder(e,{panelOrder:t}){e.panelOrder=[...t]},setCurrentBackground(e,{current:t,panelId:n}){const o=e.panels[n];o.background.current=t,o.background.variant=0},setBackgroundColor(e,{color:t,panelId:n}){const o=e.panels[n];o.background.color=t},setBackgroundFlipped(e,{flipped:t,panelId:n}){const o=e.panels[n];o.background.flipped=t},setBackgroundVariant(e,{variant:t,panelId:n}){const o=e.panels[n];o.background.variant=t},setBackgroundScaling(e,{scaling:t,panelId:n}){const o=e.panels[n];o.background.scaling=t},deletePanel(e,{panelId:t}){Ns.unregister(t,Ns.panelToUrl.get(t)),delete e.panels[t]},setComposition(e,t){const n=e.panels[t.panelId];n.composite=t.composite},setFilters(e,t){const n=e.panels[t.panelId];n.filters=t.filters},backgroundSetComposition(e,t){const n=e.panels[t.panelId];n.background.composite=t.composite},backgroundSetFilters(e,t){const n=e.panels[t.panelId];n.background.filters=t.filters}},HO),actions:xi({createPanel({state:e,commit:t}){const n=e.lastPanelId+1;return t("createPanel",{panel:{id:n,background:{color:"#000000",current:KO,flipped:!1,scaling:2,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[],objects:{},onTopOrder:[],order:[],lastObjId:-1}}),t("setPanelOrder",{panelOrder:[...e.panelOrder,n]}),t("setCurrentPanel",{panelId:n}),n},duplicatePanel({state:e,commit:t},{panelId:n}){const o=e.panels[n],s=e.lastPanelId+1;Ns.register(s,o.lastRender);const r=JSON.parse(JSON.stringify(o));let i=-1;const a=new Map,l={};for(const c in r.objects)a.set(+c,++i);for(const c in r.objects){const p=r.objects[c],f=a.get(+c);if(l[f]=p,p.panelId=s,p.id=f,"talkingObjId"in p){const b=p;b.talkingObjId!==null&&b.talkingObjId!=="$other$"&&a.has(b.talkingObjId)&&(b.talkingObjId=a.get(b.talkingObjId))}}t("createPanel",{panel:XO(xi({},r),{id:s,lastObjId:i,objects:l,order:r.order.map(c=>a.get(c)),onTopOrder:r.onTopOrder.map(c=>a.get(c))})});const d=e.panelOrder.indexOf(n);t("setPanelOrder",{panelOrder:[...e.panelOrder.slice(0,d+1),s,...e.panelOrder.slice(d+1)]}),t("setCurrentPanel",{panelId:s})},seekBackgroundVariant({state:e,rootGetters:t,commit:n},{delta:o}){const s=e.panels[e.currentPanel],i=t["content/getBackgrounds"].get(s.background.current);!i||n("setBackgroundVariant",{panelId:e.currentPanel,variant:qo(i.variants,s.background.variant,o)})},delete({state:e,commit:t},{panelId:n}){if(e.panelOrder.length<=1)return;const o=e.panelOrder.indexOf(n);let s;o===e.panelOrder.length-1?s=o-1:s=o+1,t("setCurrentPanel",{panelId:e.panelOrder[s]}),t("setPanelOrder",{panelOrder:[...e.panelOrder.slice(0,o),...e.panelOrder.slice(o+1)]}),t("deletePanel",{panelId:n})},fixContentPackRemoval(e,t){const{state:n,rootGetters:o,commit:s,rootState:r}=e;for(const i of Object.values(n.panels)){const a=t.backgrounds.find(p=>p.id===i.background.current);if(!a)return;const l=o["content/getBackgrounds"].get(i.background.current);if(!l){r.content.current.backgrounds.length>0?s("setCurrentBackground",{current:r.content.current.backgrounds[0].id,panelId:i.id}):s("setCurrentBackground",{current:"buildin.transparent",panelId:i.id});return}const d=JSON.stringify(a.variants[i.background.variant]),c=l.variants.findIndex(p=>JSON.stringify(p)===d);c!==i.background.variant&&s("setBackgroundVariant",{variant:c===-1?0:c,panelId:i.id})}UO(e,t)},move({state:e,commit:t},{panelId:n,delta:o}){const s=[...e.panelOrder],r=s.indexOf(n);s.splice(r,1);const i=Math.max(r+o,0);s.splice(i,0,n),t("setPanelOrder",{panelOrder:s})},addFilter({state:e,commit:t},n){gl(n,()=>e.panels[n.panelId],o=>t("setFilters",o))},removeFilter({state:e,commit:t},n){ml(n,()=>e.panels[n.panelId],o=>t("setFilters",o))},moveFilter({state:e,commit:t},n){bl(n,()=>e.panels[n.panelId],o=>t("setFilters",o))},setFilter({state:e,commit:t},n){vl(n,()=>e.panels[n.panelId],o=>t("setFilters",o))},backgroundAddFilter({state:e,commit:t},n){gl(n,()=>e.panels[n.panelId].background,o=>t("backgroundSetFilters",o))},backgroundRemoveFilter({state:e,commit:t},n){ml(n,()=>e.panels[n.panelId].background,o=>t("backgroundSetFilters",o))},backgroundMoveFilter({state:e,commit:t},n){bl(n,()=>e.panels[n.panelId].background,o=>t("backgroundSetFilters",o))},backgroundSetFilter({state:e,commit:t},n){vl(n,()=>e.panels[n.panelId].background,o=>t("backgroundSetFilters",o))}},LO)};var Df=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class JO{constructor(t,n,o,s,r,i){this.id=t,this.assets=n,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=i}render(t){return Df(this,null,function*(){const{screenWidth:n,screenHeight:o}=J().Base,s=yield Promise.all(this.assets.map(r=>Er(r,t.hq)));for(const r of s){let i=0,a=0,l=r.width,d=r.height;switch(this.scale){case qs.None:i=n/2-l/2,a=o/2-d/2;break;case qs.Stretch:l=n,d=o;break;case qs.Cover:const c=l/d,p=n/o;c>p?(d=o,l=d*c):(l=n,d=l/c),i=n/2-l/2,a=o/2-d/2}t.drawImage({image:r,x:i,y:a,w:l,h:d,flip:this.flip,composite:this.compositeMode,filters:this.filters})}})}}const Zc={id:"buildin.static-color",name:"Static color",color:"#000000",render(e){return Df(this,null,function*(){const{screenWidth:t,screenHeight:n}=J().Base;e.drawRect({x:0,y:0,w:t,h:n,fill:{style:this.color}})})}};var ZO=Object.defineProperty,QO=(e,t,n)=>t in e?ZO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ji=(e,t,n)=>(QO(e,typeof t!="symbol"?t+"":t,n),n),Rf=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Ff extends xf{constructor(){super(...arguments),ji(this,"refTextbox",null),ji(this,"lastUploadCount",0),ji(this,"missingAsset",!1)}get canvasDrawWidth(){return this.width*this.objZoom}get canvasDrawHeight(){return this.height*this.objZoom}get canvasDrawPosX(){return this.x-this.width/2+(this.width-this.canvasDrawWidth)/2}get canvasDrawPosY(){return this.y+(this.height-this.canvasDrawHeight)}get allowSkippingLocalCanvas(){return!1}get objZoom(){return(this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1)*this.obj.zoom}getHitbox(){const t=super.getHitbox(),n=this.width*(this.objZoom-1),o=this.height*(this.objZoom-1);return{x0:t.x0-n/2,x1:t.x1+n/2,y0:t.y0-o,y1:t.y1}}updatedContent(t,n){const o=t.state.panels.panels[n],s=[...o.order,...o.onTopOrder];this.refTextbox=null;for(const i of s){const a=t.state.panels.panels[n].objects[i];if(a.type==="textBox"&&a.talkingObjId===this.obj.id){this.refTextbox=a;return}}const r=Object.keys(t.state.uploadUrls).length;this.missingAsset&&r!==this.lastUploadCount&&(this.localRenderer&&this.localRenderer.dispose(),this.localRenderer=null,this.lastUploadCount=r,this.reloadAssets(),console.log("forceing sprite rerender "+this.id))}renderLocal(t){return Rf(this,null,function*(){const n=yield this.getAssetList();console.log("rerendering local");const o=yield Promise.all(n.filter(s=>s.assets).map(s=>ex(s,t.hq)));this.missingAsset=!1;for(const s of o)for(const r of s.assets)r instanceof rr&&(this.missingAsset=!0),t.drawImage({image:r,composite:s.composite,x:s.offset[0],y:s.offset[1]})})}}function ex(e,t){return Rf(this,null,function*(){return"loaded"in e?e:{loaded:!0,offset:e.offset,assets:yield Promise.all(e.assets.map(n=>Er(n,t))),composite:e.composite}})}var tx=Object.defineProperty,nx=(e,t,n)=>t in e?tx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wo=(e,t,n)=>(nx(e,typeof t!="symbol"?t+"":t,n),n),Qc=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class ox extends Ff{constructor(t){super(t),Wo(this,"assets"),Wo(this,"ready",null),Wo(this,"canvasHeight",0),Wo(this,"canvasWidth",0),Wo(this,"needAssetUpdate",!0),this.init()}get version(){return this.assets===null?-1:this.obj.version}init(){return Qc(this,null,function*(){yield this.reloadAssets()})}reloadAssets(){return Qc(this,null,function*(){let t;this.ready=new Promise((r,i)=>{t=r});const n=yield Promise.all(this.obj.assets.map(r=>Er(r)));let o=0,s=0;for(const r of n)r.height>s&&(s=r.height),r.width>o&&(o=r.width);this.canvasWidth=o,this.canvasHeight=s,this.assets=[{loaded:!0,assets:n,offset:[0,0]}],t()})}getAssetList(){var t;return(t=this.assets)!=null?t:[]}}class sx extends Ff{constructor(t,n){super(t),this.data=n}reloadAssets(){}updatedContent(t,n){super.updatedContent(t,n),this.data=Hr(t,this.obj)}getAssetList(){const t=mn(this.data,this.obj),n=cr(this.data,this.obj),o=[];for(const s of t.renderCommands)switch(s.type){case"head":o.push({offset:s.offset,composite:s.composite,assets:n?n.variants[this.obj.posePositions.head||0]:[]});break;case"image":o.push({offset:s.offset,composite:s.composite,assets:s.images});break;case"pose-part":const r=t.positions[s.part];if(!r||r.length===0)break;const i=r[this.obj.posePositions[s.part]||0];if(!i)break;o.push({offset:s.offset,composite:s.composite,assets:i});break}return o}get canvasHeight(){return mn(this.data,this.obj).size[1]}get canvasWidth(){return mn(this.data,this.obj).size[0]}get closeZoom(){let t=1;return this.obj.close&&(t*=2),t}get width(){return this.obj.width*this.closeZoom}get height(){return this.obj.height*this.closeZoom}}var rx=Object.defineProperty,ix=(e,t,n)=>t in e?rx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,eu=(e,t,n)=>(ix(e,typeof t!="symbol"?t+"":t,n),n),tu=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class lx extends To{constructor(){super(...arguments),eu(this,"_height",0),eu(this,"choiceRenderers",[])}get height(){return this._height}get centeredVertically(){return!0}draw(t){return tu(this,null,function*(){yield this.updateChoiceBounds();const n=J(),o=this.obj.width,s=this.height,r=o/2,a=(this.flip?n.Base.screenWidth-this.obj.x:this.obj.x)-r;let l=this.obj.y-s/2;for(const d of this.choiceRenderers){yield d.loadFonts();const c=d.getHeight(this.obj.autoWrap?this.obj.width:0);t.drawRect({x:a,y:l,w:o,h:c+n.Choices.ChoicePadding*2,outline:{style:n.Choices.ChoiceButtonBorderColor,width:n.Choices.Outline},fill:{style:n.Choices.ChoiceButtonColor}}),d.fixAlignment("center",a,a+o,l+n.Choices.ChoiceSpacing*1.25,this.obj.autoWrap?o:0),d.render(t.fsCtx),l+=c+n.Choices.ChoicePadding*2+n.Choices.ChoiceSpacing}})}updateChoiceBounds(){return tu(this,null,function*(){const t=J();this.choiceRenderers=this.obj.choices.map(n=>new ut(n.text||" ",t.Choices.ChoiceTextStyle)),this._height=this.choiceRenderers.reduce((n,o)=>n+o.getHeight(this.obj.autoWrap?this.obj.width:0)+t.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1)})}}var ax=Object.defineProperty,dx=Object.getPrototypeOf,cx=Reflect.get,ux=(e,t,n)=>t in e?ax(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nu=(e,t,n)=>(ux(e,typeof t!="symbol"?t+"":t,n),n),px=(e,t,n)=>cx(dx(e),n,t),ou=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});class Oa extends To{constructor(){super(...arguments),nu(this,"_height",0),nu(this,"_width",0)}get height(){return this._height}get width(){return this._width}get centeredVertically(){return!0}get id(){return this.obj.id}render(t,n,o){return ou(this,null,function*(){const s=J();this.obj.backdrop&&n.drawRect({x:0,y:0,w:s.Base.screenWidth,h:s.Base.screenHeight,fill:{style:J().Notification.NotificationBackdropColor}}),yield px(Oa.prototype,this,"render").call(this,t,n,o)})}draw(t){return ou(this,null,function*(){const n=J(),o=new ut(this.obj.text,n.Notification.NotificationTextStyle),s=new ut("OK",n.Notification.NotificationOkTextStyle);yield o.loadFonts(),yield s.loadFonts();const r=this.obj.autoWrap?this.obj.width-n.Notification.NotificationPadding*2:0,i=this.obj.autoWrap?r:o.getWidth(),a=o.getHeight(r),l=this.obj.autoWrap?r:s.getWidth(),d=s.getHeight(r),c=this._width=Math.max(i,l)+n.Notification.NotificationPadding*2,p=this._height=a+n.Notification.NotificationPadding*2+n.Notification.NotificationSpacing+d,f=c/2,v=(this.flip?n.Base.screenWidth-this.obj.x:this.obj.x)-f,$=this.obj.y-p/2;t.drawRect({x:v,y:$,w:c,h:p,outline:{style:n.Choices.ChoiceButtonBorderColor,width:3},fill:{style:n.Choices.ChoiceButtonColor}}),o.fixAlignment("center",v,v+c,$+n.Notification.NotificationPadding*1.5,r),o.render(t.fsCtx),s.fixAlignment("center",v,v+c,$+p-n.Notification.NotificationPadding,r),s.render(t.fsCtx)})}}var fx=Object.defineProperty,hx=(e,t,n)=>t in e?fx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,su=(e,t,n)=>(hx(e,typeof t!="symbol"?t+"":t,n),n),gx=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const mx=-2,bx=26,vx=10,yx=10;class _x extends To{constructor(){super(...arguments),su(this,"_height",0),su(this,"_width",0)}get height(){return this._height}get width(){return this._width}get centeredVertically(){return!0}draw(t){return gx(this,null,function*(){const n=J(),o=n.Poem.poemBackgrounds[this.obj.background],s=this.flip?n.Base.screenWidth-this.obj.x:this.obj.x;let r=this.obj.y,i=s+yx,a=n.Poem.poemPadding,l=n.Poem.poemTopPadding,d=a*2;if(o.file==="internal:console"){const f=this._height=this.obj.height,b=this._width=this.obj.width;t.drawRect({x:s-b/2,y:this.obj.y-f/2,h:f,w:b,fill:{style:this.obj.consoleColor||n.Poem.consoleBackgroundColor}}),a=mx,l=bx,d=vx}else if(o.file==="internal:transparent")this._height=this.obj.height,this._width=this.obj.width;else{const f=yield Ql(`assets/poemBackgrounds/${o.file}`),b=f.height*n.Poem.backgroundScale,v=f.width*n.Poem.backgroundScale;t.drawImage({image:f,x:s-v/2,y:this.obj.y-b/2,h:b,w:v}),this._height=b,this._width=v}r-=this.height/2,i-=this.width/2;const c=n.Poem.poemTextStyles[this.obj.font],p=new ut(this.obj.text,c);yield p.loadFonts(),p.fixAlignment("left",i+a,i+a,r+l+a,this.obj.autoWrap?this.width-d:0),p.render(t.fsCtx)})}}var wx=Object.defineProperty,$x=(e,t,n)=>t in e?wx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xs=(e,t,n)=>($x(e,typeof t!="symbol"?t+"":t,n),n),Cx=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Mf=class{constructor(e,t,n,o){this.store=e,this._panelId=t,this.canvasWidth=n,this.canvasHeight=o,Xs(this,"renderObjectCache",new Map),Xs(this,"renderer"),Xs(this,"_disposed",!1),this.renderer=new ws(n,o)}get panelId(){return this._panelId}setPanelId(e){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==e&&(this._panelId=e,this.renderObjectCache.forEach(t=>{t.dispose()}),this.renderObjectCache.clear())}render(e,t,n){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,n),e,t):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const e=new Date,t=`panel-${[e.getFullYear(),`${e.getMonth()+1}`.padStart(2,"0"),`${e.getDate()}`.padStart(2,"0"),`${e.getHours()}`.padStart(2,"0"),`${e.getMinutes()}`.padStart(2,"0"),`${e.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),t)}paintOnto(e,t){this.renderer.paintOnto(e,t)}objectsAt(e,t){return this.getRenderObjects().filter(n=>n.hitTest(e,t)).map(n=>n.id)}renderCallback(e,t){return Cx(this,null,function*(){var n;if(this._disposed)throw new Error("Disposed scene-renderer called");t.fsCtx.imageSmoothingEnabled=!0,t.fsCtx.imageSmoothingQuality=t.hq?"high":"low",yield(n=this.getBackgroundRenderer())==null?void 0:n.render(t);const o=this.store.state.ui.selection;for(const s of this.getRenderObjects()){s.updatedContent(this.store,this.panelId);const r=o===s.id,i=document.querySelector(Mf.FocusProp),a=(i==null?void 0:i.getAttribute("data-obj-id"))===""+s.id;yield s.render((r?Xo.Selected:Xo.None)+(a?Xo.Focused:Xo.None),t,e)}t.applyFilters([...this.panel.filters]),t.preview&&t.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:yield co("backgrounds/transparent")})})}getRenderObjects(){const e=this.store.state.panels.panels[this.panelId],t=[...e.order,...e.onTopOrder],n=e.objects,o=Array.from(this.renderObjectCache.keys()).filter(s=>!t.includes(s));for(const s of o)this.renderObjectCache.get(s).dispose(),this.renderObjectCache.delete(s);return t.map(s=>{let r=this.renderObjectCache.get(s);if(!r){const i=n[s],a=i.type;switch(a){case"sprite":r=new ox(i);break;case"character":const l=i;r=new sx(l,Hr(this.store,l));break;case"textBox":r=new cC(i);break;case"choice":r=new lx(i);break;case"notification":r=new Oa(i);break;case"poem":r=new _x(i);break;default:throw new _t.UnreachableCaseError(a)}this.renderObjectCache.set(s,r)}return r})}get panel(){return this.store.state.panels.panels[this.panelId]}getBackgroundRenderer(){const e=this.panel;switch(e.background.current){case"buildin.static-color":return Zc.color=e.background.color,Zc;default:const n=this.store.getters["content/getBackgrounds"].get(e.background.current);if(!n)return null;const o=n.variants[e.background.variant];return new JO(e.background.current,o,e.background.flipped,e.background.scaling,e.background.composite,e.background.filters)}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}};let hr=Mf;Xs(hr,"FocusProp",typeof CSS!="undefined"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");var Te=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Px=1.5,ru=1/4,Sx=.5,iu=100,lu=90,au=70,kx=te({mixins:[st],components:{DFieldset:Mt,DFlow:ys,DButton:Ln,ImageOptions:ka},data:()=>({webpSupport:!1,heifSupport:!1,ppi:X.supports.limitedCanvasSpace?10:0,pages:"",format:"image/png",quality:lu,imageOptions:!1,isMounted:!1,thumbnailCtx:null}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},isLossy(){return this.format!=="image/png"},canDeletePanel(){return this.panelButtons.length>1},panelButtons(){return this.$store.state.panels.panelOrder.map(t=>{const n=this.$store.state.panels.panels[t],o=this.$store.state.panels.panels[t],s=[...o.order,...o.onTopOrder].map(r=>this.$store.state.panels.panels[t].objects[r]).map(this.extractObjectText);return{id:t,image:n.lastRender,text:s.reduce((r,i)=>r.length>i.length?r:i,"")}})},canMoveAhead(){return this.$store.state.panels.panelOrder.indexOf(this.currentPanel.id)>0},canMoveBehind(){const e=this.$store.state.panels.panelOrder;return e.indexOf(this.currentPanel.id)<e.length-1},missingThumbnails(){const e=this.$store;return e.state.panels.panelOrder.filter(n=>e.state.panels.panels[n].lastRender==null)}},created(){return Te(this,null,function*(){pe.subscribe(Kl,()=>requestAnimationFrame(()=>this.renderCurrentThumbnail()));const e=J().Base,t=us();t.width=e.screenWidth*ru,t.height=e.screenHeight*ru,this.thumbnailCtx=Cr(t.getContext("2d")),[this.webpSupport,this.heifSupport]=yield Promise.all([mo(),Tb()])})},mounted(){this.isMounted=!0,this.moveFocusToActivePanel(),requestAnimationFrame(()=>this.renderCurrentThumbnail().catch(()=>{}))},unmounted(){this.isMounted=!1,bo(this.thumbnailCtx.canvas)},methods:{restoreThumbnails(){return Te(this,null,function*(){const e=J().Base;if(!this.isMounted||X.supports.limitedCanvasSpace)return;const t=this.missingThumbnails;if(t.length===0)return;const n=t[0],o=new hr(this.$store,n,e.screenWidth,e.screenHeight);yield o.render(!1,!1,!0),yield this.renderPanelThumbnail(o),setTimeout(()=>{this.restoreThumbnails()},500)})},download(){return Te(this,null,function*(){yield nl("export image",()=>Te(this,null,function*(){const e=this.getPanelDistibution(),t=new Date,n=`cd-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}`,o=this.format.split("/")[1],s=this.format,r=this.quality;yield this.renderObjects(e,!0,(i,a)=>Te(this,null,function*(){yield X.saveToFile(a,`${n}_${i}.${o}`,s,r/iu)}))}))})},estimateExportSize(){return Te(this,null,function*(){const e=this.getPanelDistibution(),t=this.format||"image/png",n=this.quality||lu,s=(yield this.renderObjects(e,!1,(l,d)=>Te(this,null,function*(){return new Promise((c,p)=>{d.toBlob(f=>{if(!f){p(`Image ${l+1} could not be rendered.`);return}c(f.size)},t,n/iu)})}))).map(l=>(l*Px/1024/1024).toFixed(2)+"MiB"),r=s.length>1?"files":"file",i=s.length>1?"These":"It",a=s.length>1?"sizes":"size";pe.fire(new ot(`This would export ${s.length} ${r}. ${i} would have the following (aproximate) ${a}: ${s.join(",")}`))})},renderObjects(e,t,n){return Te(this,null,function*(){const o=J().Base,s=[];for(let r=0;r<e.length;++r){const i=e[r],a=document.createElement("canvas");a.width=o.screenWidth,a.height=o.screenHeight*i.length;try{const l=a.getContext("2d");for(let d=0;d<i.length;++d){const c=i[d],p=new hr(this.$store,c,o.screenWidth,o.screenHeight);try{yield p.render(t,!1,!0),p.paintOnto(l,{x:0,y:o.screenHeight*d,w:o.screenWidth,h:o.screenHeight})}finally{p.dispose()}}s.push(yield n(r,a))}finally{bo(a)}}return s})},getLimitedPanelList(){const e=this.$store.state.panels.panelOrder.length-1,t=0,n=this.pages.split(","),o=[];let s=!1;for(const r of n){const i=r.trim(),a=i.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!a){i!==""&&pe.fire(new ot(`Could not read '${r}' in the page list.`));continue}if(s=!0,a[2])o.push(parseInt(a[2],10)-1);else{const l=Math.max(parseInt(a[3],10)-1,t),d=Math.min(parseInt(a[4],10)-1,e);if(l==null||d==null||l>d)continue;for(let c=l;c<=d;++c)o.push(c)}}return s?o.sort((r,i)=>r-i).filter((r,i,a)=>a[i-1]!==r).map(r=>this.$store.state.panels.panelOrder[r]):this.$store.state.panels.panelOrder},getPanelDistibution(){const e=this.getLimitedPanelList();if(isNaN(this.ppi)&&(this.ppi=0),this.ppi===0)return[e];const t=[];for(let n=0;n<e.length/this.ppi;++n){const o=n*this.ppi,s=o+this.ppi;t.push([...e.slice(o,s)])}return t},moveFocusToActivePanel(){const e=this.$el.querySelector(".panel_button.active");e&&this.scrollIntoView(e)},scrollIntoView(e){const t=e.parentElement.parentElement;this.$store.state.ui.vertical?(t.scrollTop=e.offsetTop-t.clientHeight/2,t.scrollLeft=0):(t.scrollLeft=e.offsetLeft-t.clientWidth/2,t.scrollTop=0)},extractObjectText(e){switch(e.type){case"textBox":return e.text;case"notification":return e.text;case"poem":return e.text;case"choice":return e.choices.map(t=>`[${t.text}]`).join(`
`)}return""},addNewPanel(){return Te(this,null,function*(){yield A(()=>Te(this,null,function*(){yield this.$store.dispatch("panels/duplicatePanel",{panelId:this.$store.state.panels.currentPanel})})),yield this.$nextTick(),this.moveFocusToActivePanel()})},updateCurrentPanel(e){A(()=>Te(this,null,function*(){this.$store.commit("panels/setCurrentPanel",{panelId:e})})),this.$nextTick(()=>{this.moveFocusToActivePanel()})},deletePanel(){A(()=>Te(this,null,function*(){yield this.$store.dispatch("panels/delete",{panelId:this.$store.state.panels.currentPanel})})),this.$nextTick(()=>{this.moveFocusToActivePanel()})},moveAhead(){A(()=>Te(this,null,function*(){yield this.$store.dispatch("panels/move",{panelId:this.currentPanel.id,delta:-1})}))},moveBehind(){A(()=>Te(this,null,function*(){yield this.$store.dispatch("panels/move",{panelId:this.currentPanel.id,delta:1})}))},renderCurrentThumbnail(){return Te(this,null,function*(){const e=window.getMainSceneRenderer,t=e&&e();!t||(yield this.renderPanelThumbnail(t))})},renderPanelThumbnail(e){return Te(this,null,function*(){yield nl("render thumbnail",()=>Te(this,null,function*(){const t=e.panelId;e.paintOnto(this.thumbnailCtx,{x:0,y:0,w:this.thumbnailCtx.canvas.width,h:this.thumbnailCtx.canvas.height}),this.thumbnailCtx.canvas.toBlob(n=>{if(!n)return;const o=URL.createObjectURL(n);A(()=>{this.$store.commit("panels/setPanelPreview",{panelId:t,url:o})})},(yield mo())?"image/webp":"image/jpeg",Sx)}))})},save(){return Te(this,null,function*(){const e=yield this.$store.dispatch("getSave",!0),t=new Blob([e],{type:"text/plain"}),n=new Date,o=`save-${[n.getFullYear(),`${n.getMonth()+1}`.padStart(2,"0"),`${n.getDate()}`.padStart(2,"0"),`${n.getHours()}`.padStart(2,"0"),`${n.getMinutes()}`.padStart(2,"0"),`${n.getSeconds()}`.padStart(2,"0")].join("-")}`;X.storeSaveFile(t,`${o}.dddg`)})},load(){return Te(this,null,function*(){yield A(()=>Te(this,null,function*(){const e=this.$refs.loadUpload;if(!e.files)return;pe.fire(new Yl);const t=yield Ox(e.files[0]);yield this.$store.dispatch("loadSave",t),X.supports.limitedCanvasSpace&&pe.fire(new ot("To prevent running out of memory, thumbnails will not be automatically restored in the background."))})),yield this.renderCurrentThumbnail(),setTimeout(()=>{this.restoreThumbnails()},1e3)})}},watch:{quality(e,t){if(e===100){pe.fire(new ot("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(t>au&&e<=au){pe.fire(new ot("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}},ppi(e,t){if(!!X.supports.limitedCanvasSpace&&(t<=10&&e>10||e===0&&this.panelButtons.length>10)){pe.fire(new ot("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}}});function Ox(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=function(){t(o.result)},o.onerror=function(s){n(s)},o.readAsText(e)})}const Un=e=>(Ge("data-v-c7ec17cc"),e=e(),qe(),e),xx={class:"panel"},jx=Un(()=>u("h1",null,"Panels",-1)),Ix=["onClick","onKeydown"],Tx={class:"panel_text"},Ex={class:"panel_nr"},Bx={class:"column"},Ax=Un(()=>u("td",null,[u("label",{for:"export_format"},"Format")],-1)),Dx=Un(()=>u("option",{value:"image/png"},"PNG (lossless)",-1)),Rx={key:0,value:"image/webp"},Fx={key:1,value:"image/heif"},Mx=Un(()=>u("option",{value:"image/jpeg"},"JPEG (lossy)",-1)),Nx={key:0},Hx=Un(()=>u("td",null,[u("label",{for:"export_quality"},"Quality:")],-1)),Lx=Un(()=>u("td",null,[u("label",{for:"export_ppi"},[O(" Panels per image: "),u("br"),u("small",null,"(0 for one single image)")])],-1)),Ux=Un(()=>u("td",null,[u("label",{for:"export_pages"},[O(" Panels to export: "),u("br"),u("small",null,"(Leave empty for all)")])],-1)),Vx={class:"column"};function Wx(e,t,n,o,s,r){const i=E("image-options"),a=E("d-flow"),l=E("d-fieldset"),d=E("d-button");return g(),y("div",xx,[jx,e.imageOptions?(g(),U(i,{key:0,type:"panel",title:"","panel-id":e.currentPanel.id,"no-composition":"",onLeave:t[0]||(t[0]=c=>{e.imageOptions=!1,e.renderCurrentThumbnail()})},null,8,["panel-id"])):(g(),y(V,{key:1},[C(l,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:B(()=>[C(a,{"no-wraping":"",maxSize:"350px"},{default:B(()=>[(g(!0),y(V,null,Pe(e.panelButtons,(c,p)=>(g(),y("div",{key:c.id,class:fe({panel_button:!0,active:c.id===e.currentPanel.id}),style:Be(`background-image: url('${c.image}')`),tabindex:"0",onClick:f=>e.updateCurrentPanel(c.id),onKeydown:[Ue(f=>e.updateCurrentPanel(c.id),["enter"]),Ue(q(f=>e.updateCurrentPanel(c.id),["prevent"]),["space"])]},[u("div",Tx,[u("p",null,he(c.text),1)]),u("div",Ex,he(p+1),1)],46,Ix))),128))]),_:1})]),_:1}),u("div",Bx,[C(d,{icon:"add_to_queue",onClick:e.addNewPanel},{default:B(()=>[O(" Add new")]),_:1},8,["onClick"]),C(d,{icon:"remove_from_queue",onClick:e.deletePanel,disabled:!e.canDeletePanel},{default:B(()=>[O(" Delete panel ")]),_:1},8,["onClick","disabled"]),C(d,{icon:"arrow_upward",onClick:e.moveAhead,disabled:!e.canMoveAhead},{default:B(()=>[O(" Move ahead ")]),_:1},8,["onClick","disabled"]),C(d,{icon:"arrow_downward",onClick:e.moveBehind,disabled:!e.canMoveBehind},{default:B(()=>[O(" Move behind ")]),_:1},8,["onClick","disabled"]),C(d,{icon:"color_lens",onClick:t[1]||(t[1]=c=>e.imageOptions=!0)},{default:B(()=>[O(" Image options ")]),_:1})]),C(l,{title:"Export"},{default:B(()=>[u("table",null,[u("tr",null,[Ax,u("td",null,[ce(u("select",{id:"export_format","onUpdate:modelValue":t[2]||(t[2]=c=>e.format=c)},[Dx,e.webpSupport?(g(),y("option",Rx," WebP (lossy) ")):K("",!0),e.heifSupport?(g(),y("option",Fx," HEIF (lossy) ")):K("",!0),Mx],512),[[wt,e.format]])])]),e.isLossy?(g(),y("tr",Nx,[Hx,u("td",null,[ce(u("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":t[3]||(t[3]=c=>e.quality=c),onKeydown:t[4]||(t[4]=q(()=>{},["stop"]))},null,544),[[Ae,e.quality,void 0,{number:!0}]])])])):K("",!0),u("tr",null,[Lx,u("td",null,[ce(u("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":t[5]||(t[5]=c=>e.ppi=c),onKeydown:t[6]||(t[6]=q(()=>{},["stop"])),onBlur:t[7]||(t[7]=c=>{e.ppi===""&&(e.ppi=0)})},null,544),[[Ae,e.ppi,void 0,{number:!0}]])])]),u("tr",null,[Ux,u("td",null,[ce(u("input",{id:"export_pages","onUpdate:modelValue":t[8]||(t[8]=c=>e.pages=c),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Ae,e.pages]])])]),u("tr",null,[u("td",null,[C(d,{icon:"photo_camera",onClick:e.download},{default:B(()=>[O(" Download ")]),_:1},8,["onClick"])]),u("td",null,[u("button",{onClick:t[9]||(t[9]=(...c)=>e.estimateExportSize&&e.estimateExportSize(...c))},"Estimate filesizes")])])])]),_:1}),u("div",Vx,[C(d,{icon:"save",onClick:e.save},{default:B(()=>[O("Save")]),_:1},8,["onClick"]),C(d,{icon:"folder_open",onClick:t[11]||(t[11]=c=>e.$refs.loadUpload.click())},{default:B(()=>[O(" Load "),u("input",{type:"file",ref:"loadUpload",onChange:t[10]||(t[10]=(...c)=>e.load&&e.load(...c))},null,544)]),_:1})])],64))])}const zx=oe(kx,[["render",Wx],["__scopeId","data-v-c7ec17cc"]]),Ii=$a("panels/setNotificationProperty"),Gx=te({mixins:[st],components:{Toggle:Ft,ObjectTool:Ao},data:()=>({textEditor:!1}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="notification")return e},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.text,set:e=>{this.text=e},leave:()=>{this.textEditor=!1}}},text:Ii("text"),autoWrap:Ii("autoWrap"),renderBackdrop:Ii("backdrop")}});const qx=e=>(Ge("data-v-00949ad3"),e=e(),qe(),e),Xx={id:"notification_text_wrapper"},Kx=qx(()=>u("label",{for:"notification_text"},"Text:",-1));function Yx(e,t,n,o,s,r){const i=E("toggle"),a=E("object-tool");return g(),U(a,{object:e.object,title:"Notification",textHandler:e.textHandler},{default:B(()=>[u("div",Xx,[Kx,ce(u("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.text=l),id:"notification_text",onKeydown:t[1]||(t[1]=q(()=>{},["stop"]))},null,544),[[Ae,e.text]]),u("button",{onClick:t[2]||(t[2]=l=>e.textEditor=!0)},"Formatting")])]),options:B(()=>[C(i,{modelValue:e.renderBackdrop,"onUpdate:modelValue":t[3]||(t[3]=l=>e.renderBackdrop=l),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"])}const Jx=oe(Gx,[["render",Yx],["__scopeId","data-v-00949ad3"]]),Hs=$a("panels/setPoemProperty"),Zx=te({mixins:[st],components:{Toggle:Ft,ObjectTool:Ao},data:()=>({textEditor:!1,colorSelect:""}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},backgrounds(){return qp},poemTextStyles(){return Xp},object(){const e=this.currentPanel.objects[this.$store.state.ui.selection];if(e.type==="poem")return e},textHandler(){if(!!this.textEditor)return{title:"Text",get:()=>this.text,set:e=>{this.text=e},leave:()=>{this.textEditor=!1}}},colorHandler(){if(!!this.colorSelect)return{title:"Color",get:()=>{switch(this.colorSelect){case"":return"#000000";case"base":return this.object.consoleColor;default:throw new _t.UnreachableCaseError(this.colorSelect)}},set:e=>{A(()=>{const t=this.currentPanel.id,n=this.object.id;e!==void 0&&this.$store.commit("panels/setPoemProperty",{key:"consoleColor",panelId:t,id:n,value:e})})},leave:()=>{this.colorSelect=""}}},text:Hs("text"),autoWrap:Hs("autoWrap"),poemStyle:Hs("font"),poemBackground:Hs("background")}});const Qx=e=>(Ge("data-v-b1bb78fa"),e=e(),qe(),e),ej={id:"poem_text"},tj=Qx(()=>u("label",{for:"poem_text"},"Text:",-1)),nj=["value"],oj=["value"];function sj(e,t,n,o,s,r){const i=E("toggle"),a=E("object-tool");return g(),U(a,{object:e.object,title:e.object.subType==="poem"?"Poem":"Console",textHandler:e.textHandler,colorHandler:e.colorHandler},{default:B(()=>[u("div",ej,[tj,ce(u("textarea",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.text=l),onKeydown:t[1]||(t[1]=q(()=>{},["stop"]))},null,544),[[Ae,e.text]]),u("button",{onClick:t[2]||(t[2]=l=>e.textEditor=!0)},"Formatting")]),C(i,{label:"Auto line wrap?",modelValue:e.autoWrap,"onUpdate:modelValue":t[3]||(t[3]=l=>e.autoWrap=l)},null,8,["modelValue"]),e.object.subType==="poem"?(g(),y(V,{key:0},[ce(u("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>e.poemBackground=l),onKeydown:t[5]||(t[5]=q(()=>{},["stop"]))},[(g(!0),y(V,null,Pe(e.backgrounds,(l,d)=>(g(),y("option",{value:d,key:d},he(l.name),9,nj))),128))],544),[[wt,e.poemBackground]]),ce(u("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>e.poemStyle=l),onKeydown:t[7]||(t[7]=q(()=>{},["stop"]))},[(g(!0),y(V,null,Pe(e.poemTextStyles,(l,d)=>(g(),y("option",{value:d,key:d},he(l.name),9,oj))),128))],544),[[wt,e.poemStyle]])],64)):(g(),y("button",{key:1,id:"console_color",class:"color-button",style:Be({background:e.object.consoleColor}),onClick:t[8]||(t[8]=l=>e.colorSelect="base")}," Color ",4))]),_:1},8,["object","title","textHandler","colorHandler"])}const rj=oe(Zx,[["render",sj],["__scopeId","data-v-b1bb78fa"]]),ij={a:"add",s:"backgrounds",d:"panels",f:"settings"},lj=te({components:{SettingsPanel:_v,AddPanel:ny,BackgroundsPanel:Jk,CreditsPanel:yk,CharacterPanel:aS,TextBoxPanel:ZS,ChoicePanel:ik,SpritePanel:fS,PanelsPanel:zx,NotificationPanel:Jx,PoemPanel:rj},data:()=>({panelSelection:"add"}),computed:{currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},vertical(){return this.$store.state.ui.vertical},selection(){return this.$store.state.ui.selection},panel(){if(this.panelSelection==="selection")if(this.selection===null)this.panelSelection="add";else return this.currentPanel.objects[this.selection].type;return this.panelSelection},hasPrevRender(){return this.$store.state.ui.lastDownload!==null}},methods:{setPanel(e){e===this.panelSelection&&(e="add"),this.panelSelection=e,this.selection!==null&&this.$store.commit("ui/setSelection",null)},resetScroll(){console.log("resetting scrolls"),this.$refs.panels instanceof HTMLElement&&(this.$refs.panels.scrollTop=0,this.$refs.panels.scrollLeft=0)},onKeydown(e){if(e.ctrlKey){const t=ij[e.key];t&&(this.setPanel(t),e.preventDefault(),e.stopPropagation())}}},watch:{selection(e){if(e!=null){this.panelSelection="selection";return}this.panelSelection==="selection"&&(this.panelSelection="add")}},created(){X.onPanelChange(e=>{this.panelSelection=e}),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown)}});const aj={id:"toolbar"},dj=u("i",{class:"material-icons","aria-hidden":"true"},"add_box",-1),cj=u("div",{class:"shortcut-popup"},"A",-1),uj=[dj,cj],pj=u("i",{class:"material-icons","aria-hidden":"true"},"panorama",-1),fj=u("div",{class:"shortcut-popup"},"S",-1),hj=[pj,fj],gj=u("i",{class:"material-icons","aria-hidden":"true"},"view_module",-1),mj=u("div",{class:"shortcut-popup"},"D",-1),bj=[gj,mj],vj=u("i",{class:"material-icons","aria-hidden":"true"},"settings_applications",-1),yj=u("div",{class:"shortcut-popup"},"F",-1),_j=[vj,yj],wj={id:"toolbar-end"},$j=u("i",{class:"material-icons","aria-hidden":"true"},"help",-1),Cj=[$j],Pj=u("i",{class:"material-icons","aria-hidden":"true"},"extension",-1),Sj=[Pj],kj=["disabled"],Oj=u("i",{class:"material-icons","aria-hidden":"true"},"flip_to_back",-1),xj=[Oj],jj=u("i",{class:"material-icons","aria-hidden":"true"},"photo_camera",-1),Ij=[jj];function Tj(e,t,n,o,s,r){const i=E("settings-panel"),a=E("backgrounds-panel"),l=E("credits-panel"),d=E("character-panel"),c=E("sprite-panel"),p=E("text-box-panel"),f=E("choice-panel"),b=E("panels-panel"),v=E("notification-panel"),$=E("poem-panel"),M=E("add-panel");return g(),y("div",{id:"panels",class:fe({vertical:e.vertical}),onScroll:t[12]||(t[12]=(...R)=>e.resetScroll&&e.resetScroll(...R)),ref:"panels"},[u("div",aj,[u("button",{class:fe({active:e.panel==="add"}),onClick:t[0]||(t[0]=R=>e.setPanel("add")),title:"Add new objects to the scene","aria-label":"Add new objects to the scene"},uj,2),u("button",{class:fe({active:e.panel==="backgrounds"}),onClick:t[1]||(t[1]=R=>e.setPanel("backgrounds")),"aria-label":"Change the current background",title:"Change the current background"},hj,2),u("button",{class:fe({active:e.panel==="panels"}),title:"Panels","aria-label":"Panels",onClick:t[2]||(t[2]=R=>e.setPanel("panels"))},bj,2),u("button",{class:fe({active:e.panel==="settings"}),title:"Settings","aria-label":"Settings",onClick:t[3]||(t[3]=R=>e.setPanel("settings"))},_j,2)]),e.panel==="settings"?(g(),U(i,{key:0})):e.panel==="backgrounds"?(g(),U(a,{key:1,onShowDialog:t[4]||(t[4]=R=>e.$emit("show-dialog",R))})):e.panel==="help_credits"?(g(),U(l,{key:2})):e.panel==="character"?(g(),U(d,{key:3,onShowDialog:t[5]||(t[5]=R=>e.$emit("show-dialog",R)),onShowExpressionDialog:t[6]||(t[6]=R=>e.$emit("show-expression-dialog",R))})):e.panel==="sprite"?(g(),U(c,{key:4})):e.panel==="textBox"?(g(),U(p,{key:5})):e.panel==="choice"?(g(),U(f,{key:6})):e.panel==="panels"?(g(),U(b,{key:7})):e.panel==="notification"?(g(),U(v,{key:8})):e.panel==="poem"?(g(),U($,{key:9})):(g(),U(M,{key:10,onShowDialog:t[7]||(t[7]=R=>e.$emit("show-dialog",R))})),u("div",wj,[u("button",{class:fe({active:e.panel==="help_credits"}),onClick:t[8]||(t[8]=R=>e.setPanel("help_credits")),title:"Help & Credits","aria-label":"Help & Credits"},Cj,2),u("button",{class:fe({active:e.panel==="packs"}),onClick:t[9]||(t[9]=R=>e.$emit("show-dialog")),title:"Content packs","aria-label":"Content packs"},Sj,2),u("button",{onClick:t[10]||(t[10]=R=>e.$emit("show-prev-render")),title:"Show last downloaded panel","aria-label":"Show last downloaded panel",disabled:!e.hasPrevRender},xj,8,kj),u("button",{title:"Take a screenshot of the current scene","aria-label":"Take a screenshot of the current scene",onClick:t[11]||(t[11]=R=>e.$emit("download"))},Ij)])],34)}const Ej=oe(lj,[["render",Tj]]);var Bj=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Aj=5e3,Ti=2e4,du=100,Dj=te({props:{loading:{default:!1,type:Boolean}},data:()=>({messages:[],errors:[],resolvableErrors:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}),computed:{vertical(){return this.$store.state.ui.vertical}},created(){this.onLoadingChange(this.loading),pe.subscribe(or,e=>{this.messages.push(`Failed to load asset '${e.path}'`),setTimeout(()=>{this.messages.shift()},Aj)}),pe.subscribe($p,e=>{this.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{this.messages.shift()},Ti)}),pe.subscribe(Xl,e=>{this.errors.push(e.message)}),pe.subscribe(Jl,e=>{this.resolvableErrors.push(e)}),pe.subscribe(ot,e=>{this.messages.push(e.message),setTimeout(()=>{this.messages.shift()},Ti)}),pe.subscribe(Sp,e=>{this.messages.push(e.error.name),this.messages.push(JSON.stringify(e.error.stack)),this.messages.push(e.info),setTimeout(()=>{this.messages.shift(),this.messages.shift(),this.messages.shift()},Ti)})},methods:{onLoadingChange(e){e?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),!this.showLoading&&!this.showLoadingTimeout&&(this.showLoadingTimeout=setTimeout(()=>{this.showLoading=!0,this.showLoadingTimeout=0},du))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout(()=>{this.showLoading=!1,this.hideLoadingTimeout=0},du)))},dismissError(e){this.errors.splice(e,1)},resolvableAction(e,t){return Bj(this,null,function*(){const n=this.resolvableErrors[e];this.resolvableErrors.splice(e,1),yield n.actions.find(s=>s.name===t).exec()})}},watch:{loading(e){this.onLoadingChange(e)}}});const Rj={key:0},Fj=["onClick"],Mj=["onClick"];function Nj(e,t,n,o,s,r){return g(),y("div",{id:"messageConsole",class:fe({vertical:e.vertical})},[e.showLoading?(g(),y("p",Rj,"Loading...")):K("",!0),(g(!0),y(V,null,Pe(e.messages,(i,a)=>(g(),y("p",{key:i+"_"+a},he(i),1))),128)),(g(!0),y(V,null,Pe(e.resolvableErrors,(i,a)=>(g(),y("p",{class:"error",key:"resolvableError_"+a},[O(he(i.message)+" ",1),(g(!0),y(V,null,Pe(i.actions,l=>(g(),y("a",{href:"#",key:"resolvableError_"+a+l.name,onClick:d=>e.resolvableAction(a,l.name)},"["+he(l.name)+"]",9,Fj))),128))]))),128)),(g(!0),y(V,null,Pe(e.errors,(i,a)=>(g(),y("p",{class:"error",key:"error_"+a},[O(he(i)+" ",1),u("a",{href:"#",onClick:l=>e.dismissError(a)},"[Dismiss]",8,Mj)]))),128))],2)}const Hj=oe(Dj,[["render",Nj],["__scopeId","data-v-1e63d696"]]);var Kn=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const Lj=te({props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},data:()=>({sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0,sceneRendererCache:null}),computed:{selection(){var e;return(e=this.$store.state.ui.selection)!=null?e:null},currentPanel(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel]},lqRendering(){return this.$store.state.ui.lqRendering},sceneRender(){if(this.preLoading)return null;const e=this.$store.state.panels.currentPanel;return this.sceneRendererCache?this.sceneRendererCache.setPanelId(e):(console.log("New scene renderer!"),this.sceneRendererCache=Cr(new hr(this.$store,e,this.bitmapWidth,this.bitmapHeight))),this.sceneRendererCache},bitmapHeight(){return this.preLoading,J().Base.screenHeight},bitmapWidth(){return this.preLoading,J().Base.screenWidth},pickerMode(){return this.$store.state.ui.pickColor},cursor(){return this.pickerMode?"crosshair":"default"}},methods:{download(){return Kn(this,null,function*(){const e=yield this.sceneRender.download();yield A(()=>Kn(this,null,function*(){const t=this.$store.state.ui.lastDownload;this.$store.commit("ui/setLastDownload",e),t!=null&&URL.revokeObjectURL(t)}))})},invalidateRender(){this.queuedRender==null&&(this.queuedRender=requestAnimationFrame(this.render_))},render_(){return Kn(this,null,function*(){if(this.queuedRender!=null&&(cancelAnimationFrame(this.queuedRender),this.queuedRender=null),!this.preLoading&&!this.$store.state.unsafe){try{yield this.sceneRender.render(!this.lqRendering,!0,!1)}catch(e){console.log(e)}this.display(),pe.fire(new Kl)}})},renderLoadingScreen(){const e=document.createElement("canvas");e.height=this.bitmapHeight,e.width=this.bitmapWidth;try{vo.make(e,!0,!1).drawText({text:"Starting...",x:e.width/2,y:e.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(e,this.canvasWidth,this.canvasHeight)}finally{bo(e)}},display(){this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,{x:0,y:0,w:this.bitmapWidth,h:this.bitmapHeight})},toRendererCoordinate(e,t){const n=this.$refs.sd,o=e-n.offsetLeft,s=t-n.offsetTop,r=o/n.offsetWidth*n.width,i=s/n.offsetWidth*n.width;return[r,i]},onUiClick(e){var t;const[n,o]=this.toRendererCoordinate(e.clientX,e.clientY);if(this.pickerMode){const a=this.sdCtx.getImageData(n,o,1,1).data,l=`rgba(${a[0].toString()},${a[1].toString()},${a[2].toString()},${(a[3]/255).toString()})`;A(()=>{this.$store.commit("ui/setColorPicker",!1),pe.fire(new sr(l))});return}if(this.dropPreventClick){this.dropPreventClick=!1;return}const s=this.sceneRender.objectsAt(n,o),r=s.findIndex(a=>a===this.selection);let i;r===0?i=null:r!==-1?i=s[r-1]:i=(t=s[s.length-1])!=null?t:null,this.$store.state.ui.selection!==i&&A(()=>{this.$store.commit("ui/setSelection",i)})},onDragStart(e){if(e.preventDefault(),this.selection===null)return;this.draggedObject=this.currentPanel.objects[this.selection];const[t,n]=this.toRendererCoordinate(e.clientX,e.clientY);this.dragXOffset=t-this.draggedObject.x,this.dragYOffset=n-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y},onTouchStart(e){if(this.selection===null)return;this.draggedObject=this.currentPanel.objects[this.selection];const[t,n]=this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY);this.dragXOffset=t-this.draggedObject.x,this.dragYOffset=n-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y},onDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onSpriteDragMove(e){if(!this.draggedObject)return;e.preventDefault();let[t,n]=e instanceof MouseEvent?this.toRendererCoordinate(e.clientX,e.clientY):this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY);t-=this.dragXOffset,n-=this.dragYOffset;const o=Math.abs(t-this.dragXOriginal),s=Math.abs(n-this.dragYOriginal);o+s>1&&(this.dropPreventClick=!0),e.shiftKey&&(o>s?n=this.dragYOriginal:t=this.dragXOriginal),A(()=>{this.$store.dispatch("panels/setPosition",{panelId:this.draggedObject.panelId,id:this.draggedObject.id,x:t,y:n})})},onDrop(e){return Kn(this,null,function*(){if(e.stopPropagation(),e.preventDefault(),!!e.dataTransfer){for(const t of e.dataTransfer.items)if(t.kind==="file"&&t.type.match(/image.*/)){const n=t.getAsFile(),o=URL.createObjectURL(n);try{const s=yield this.$store.dispatch("uploadUrls/add",{name:n.name,url:o});yield A(()=>Kn(this,null,function*(){yield this.$store.dispatch("panels/createSprite",{panelId:this.$store.state.panels.currentPanel,assets:[{hq:s,lq:s,sourcePack:"dddg.uploaded.sprites"}]})}))}catch(s){URL.revokeObjectURL(o)}}}})},onSpriteDrop(e){this.draggedObject&&("TouchEvent"in window&&e instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter(e){e.buttons!==1&&(this.draggedObject=null)}},watch:{canvasWidth(){this.display()},canvasHeight(){this.display()}},created(){return Kn(this,null,function*(){if(typeof WeakRef!="undefined"){const e=new WeakRef(this);window.getMainSceneRenderer=function(){var t;return(t=e.deref())==null?void 0:t.sceneRender}}else window.getMainSceneRenderer=()=>this.sceneRender;pe.subscribe(Tr,()=>this.invalidateRender()),pe.subscribe(Yl,()=>{const e=this.sceneRendererCache;e&&e.setPanelId(-1)}),this.$store.subscribe(e=>{e.type!=="panels/setPanelPreview"&&e.type!=="panels/currentPanel"&&this.invalidateRender()})})},mounted(){const e=this.$refs.sd;this.sdCtx=e.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()},unmounted(){var e;(e=this.sceneRendererCache)==null||e.dispose()}});const Uj=["height","width"];function Vj(e,t,n,o,s,r){return g(),y("canvas",{id:"scaled_display",ref:"sd",height:e.bitmapHeight,width:e.bitmapWidth,style:Be({width:e.canvasWidth+"px",height:e.canvasHeight+"px",cursor:e.cursor}),draggable:"true",onClick:t[0]||(t[0]=(...i)=>e.onUiClick&&e.onUiClick(...i)),onTouchstart:t[1]||(t[1]=(...i)=>e.onTouchStart&&e.onTouchStart(...i)),onDragstart:t[2]||(t[2]=(...i)=>e.onDragStart&&e.onDragStart(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.onSpriteDragMove&&e.onSpriteDragMove(...i)),onMousemove:t[4]||(t[4]=(...i)=>e.onSpriteDragMove&&e.onSpriteDragMove(...i)),onTouchend:t[5]||(t[5]=(...i)=>e.onSpriteDrop&&e.onSpriteDrop(...i)),onMouseup:t[6]||(t[6]=(...i)=>e.onSpriteDrop&&e.onSpriteDrop(...i)),onDragover:t[7]||(t[7]=(...i)=>e.onDragOver&&e.onDragOver(...i)),onDrop:t[8]||(t[8]=(...i)=>e.onDrop&&e.onDrop(...i)),onMouseenter:t[9]||(t[9]=(...i)=>e.onMouseEnter&&e.onMouseEnter(...i)),onContextmenu:t[10]||(t[10]=q(()=>{},["prevent"]))},"HTML5 is required to use the Doki Doki Dialog Generator. ",44,Uj)}const Wj=oe(Lj,[["render",Vj]]),xa={"dddg.buildin.backgrounds.nsfw":`${He}packs/buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${He}packs/buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${He}packs/buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${He}packs/buildin.base.yuri.nsfw.json`},zj=new Set(Object.keys(xa)),Gj=Object.values(xa);var Ei=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const cu=16/9,Ls=20,qj=50,Xj=200,Kj=te({components:{ToolBox:Ej,MessageConsole:Hj,Render:Wj,ModalDialog:ta,SingleBox:Ya(()=>Sd(()=>import("./SingleBox.3d71169c.js"),["./SingleBox.3d71169c.js","./SingleBox.299f4dad.css"],import.meta.url)),ExpressionBuilder:Ya(()=>Sd(()=>import("./index.0438fb1b.js"),["./index.0438fb1b.js","./index.0c540de4.css"],import.meta.url))},data:()=>({canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0,systemPrefersDarkMode:!1,preLoading:!0,classes:new Set,classTimeout:null,queuedRerender:null}),computed:{isSafari(){return!1},useDarkTheme(){var e;return(e=this.userPrefersDarkMode)!=null?e:this.systemPrefersDarkMode},userPrefersDarkMode(){return this.$store.state.ui.useDarkTheme},nsfw(){return this.$store.state.ui.nsfw},objects(){const e=this.$store.state.panels,t=e.panels[e.currentPanel];return t==null?[]:[...t.order,...t.onTopOrder]}},methods:{drawLastDownload(){const e=this.$store.state.ui.lastDownload;e!=null&&this.$refs.render.blendOver(e)},setBlendOver(){this.blendOver=this.$store.state.ui.lastDownload},optimum(e,t){let n=e/cu,o=t*cu;return n>t?n=t:o=e,[o,n]},optimizeWithMenu(e,t){const n=this.optimum(e,t-this.uiSize),o=this.optimum(e-this.uiSize,t);return!this.isSafari&&n[0]*n[1]>o[0]*o[1]?[n[0],n[1],!1]:[o[0],o[1],!0]},updateArea(){const[e,t,n]=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight);this.canvasWidth=e,this.canvasHeight=t,this.canvasTooSmall=Math.max(e,t)<Xj,this.$store.state.ui.vertical!==n&&this.$store.commit("ui/setVertical",n)},showDialog(e){if(this.dialogVisable=!0,e==null)return;const t=()=>{this.$refs.packDialog?this.$refs.packDialog.setSearch(e):setTimeout(t,qj)};this.$nextTick(t)},showExpressionDialog(e){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=e.character,this.expressionBuilderHeadGroup=e.headGroup},rerender(){this.queuedRerender==null&&(this.queuedRerender=requestAnimationFrame(()=>{this.queuedRerender=null,pe.fire(new Tr)}))},onKeydown(e){if(e.key==="Control"){this.classTimeout===null&&(this.classTimeout=setTimeout(()=>{this.classTimeout=null,this.classes.add("ctrl-key")},500));return}if(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement){console.log("skip keydown on potential target");return}A(()=>{if(e.ctrlKey){if(e.key==="z"){e.preventDefault();return}else if(e.key==="y"){e.preventDefault();return}else if(e.key==="v"){this.$store.dispatch("panels/pasteObjectFromClipboard",{}),e.preventDefault();return}}const n=this.$store.state.panels.panels[this.$store.state.panels.currentPanel].objects[this.$store.state.ui.selection];if(n==null)return;if(e.key==="Delete"){this.$store.dispatch("panels/removeObject",{id:n.id,panelId:n.panelId});return}if(e.key==="c"||e.key==="x"){this.$store.dispatch("panels/copyObjectToClipboard",{id:n.id,panelId:n.panelId}),e.key==="x"&&this.$store.dispatch("panels/removeObject",{id:n.id,panelId:n.panelId}),e.preventDefault();return}if(e.key==="/"||e.key==="*"){let r=e.key==="/"?-10:10;e.shiftKey&&(r/=Math.abs(r)),this.$store.commit("panels/setRotation",{id:n.id,panelId:n.panelId,rotation:n.rotation+r}),e.stopPropagation(),e.preventDefault();return}if(n.type==="character"){const r=n;if(!r.freeMove){if(e.key==="ArrowLeft"){this.$store.dispatch("panels/shiftCharacterSlot",{id:r.id,panelId:r.panelId,delta:-1});return}if(e.key==="ArrowRight"){this.$store.dispatch("panels/shiftCharacterSlot",{id:r.id,panelId:r.panelId,delta:1});return}}}let{x:o,y:s}=n;if(e.key==="ArrowLeft")o-=e.shiftKey?1:Ls;else if(e.key==="ArrowRight")o+=e.shiftKey?1:Ls;else if(e.key==="ArrowUp")s-=e.shiftKey?1:Ls;else if(e.key==="ArrowDown")s+=e.shiftKey?1:Ls;else return;this.$store.dispatch("panels/setPosition",{id:n.id,panelId:n.panelId,x:o,y:s})})},onKeyup(e){if(e.key==="Control"){this.classTimeout!=null&&clearTimeout(this.classTimeout),this.classTimeout=null,this.classes.delete("ctrl-key");return}},applyTheme(){document.body.classList.toggle("dark-theme",this.useDarkTheme)},select(e){this.$store.state.ui.selection!==e&&A(()=>{this.$store.commit("ui/setSelection",e)})}},watch:{systemPrefersDarkMode(){this.applyTheme()},userPrefersDarkMode(){this.applyTheme()},nsfw(e){return Ei(this,null,function*(){e?yield this.$store.dispatch("content/loadContentPacks",Gj):yield this.$store.dispatch("removePacks",{packs:zj})})}},mounted(){if(window.addEventListener("keypress",e=>{e.key==="Escape"&&A(()=>{this.$store.state.ui.selection!==null&&this.$store.commit("ui/setSelection",null)})}),window.addEventListener("resize",this.updateArea),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown),window.addEventListener("keyup",this.onKeyup),window.matchMedia!=null){const e=window.matchMedia("(prefers-color-scheme: dark)");this.systemPrefersDarkMode=e.matches,e.addListener(t=>{this.systemPrefersDarkMode=t.matches})}},created(){return Ei(this,null,function*(){this.updateArea(),Jt.setStore(this.$store),window.app=this,window.store=this.$store,window.env=X,Rn(()=>this.$store.state.ui.selection,t=>{var n,o;((n=document.activeElement)==null?void 0:n.getAttribute("data-obj-id"))!==""+t&&((o=document.querySelector(`*[data-obj-id='${t}']`))==null||o.focus({focusVisible:!1,preventScroll:!0}))}),document.body.addEventListener("drop",t=>{t.preventDefault()},!0),document.body.addEventListener("dragover",t=>{t.preventDefault()},!0),yield X.loadGameMode(),this.preLoading=!1,X.connectToStore(this.$store);const e=yield X.loadSettings();yield A(()=>Ei(this,null,function*(){var t,n,o,s;X.state.looseTextParsing=e.looseTextParsing||!0,this.$store.commit("ui/setLqRendering",(t=e.lq)!=null?t:!1),this.$store.commit("ui/setDarkTheme",(n=e.darkMode)!=null?n:null),this.$store.commit("ui/setDefaultCharacterTalkingZoom",(o=e.defaultCharacterTalkingZoom)!=null?o:!0),yield this.$store.dispatch("content/loadContentPacks",[`${He}packs/buildin.base.backgrounds.json`,`${He}packs/buildin.base.monika.json`,`${He}packs/buildin.base.sayori.json`,`${He}packs/buildin.base.natsuki.json`,`${He}packs/buildin.base.yuri.json`,`${He}packs/buildin.extra.mc.json`,`${He}packs/buildin.extra.concept_mc.json`,`${He}packs/buildin.extra.mc_chad.json`,`${He}packs/buildin.extra.femc.json`,`${He}packs/buildin.extra.concept_femc.json`,`${He}packs/buildin.extra.amy.json`]),yield X.loadContentPacks();const r=yield this.$store.dispatch("panels/createPanel");Object.keys(this.$store.state.panels.panels[r].objects).length===0&&(yield this.$store.dispatch("panels/createTextBox",{panelId:r,text:`Hi! Click here to edit this textbox! ${this.$store.state.ui.vertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more!`})),yield this.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:this.$store.state.panels.currentPanel}),yield this.$store.commit("ui/setNsfw",(s=e.nsfw)!=null?s:!1)}))})},unmounted(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("keyup",this.onKeyup)}});const Yj={key:0},Jj={class:"hidden-selectors"},Zj=["data-obj-id","onKeydown"],Qj=u("div",{id:"modal-messages"},null,-1);function eI(e,t,n,o,s,r){const i=E("render"),a=E("message-console"),l=E("tool-box"),d=E("single-box"),c=E("modal-dialog"),p=E("expression-builder");return g(),y(V,null,[e.canvasTooSmall&&e.isSafari?(g(),y("div",Yj," Protrait mode is not supported by safari. Please turn the device sideways. ")):(g(),y("div",{key:1,id:"app",class:fe(Array.from(e.classes))},[u("div",Jj,[(g(!0),y(V,null,Pe(e.objects,f=>(g(),y("div",{key:f,tabindex:"0","data-obj-id":f,onFocus:t[0]||(t[0]=b=>e.rerender()),onBlur:t[1]||(t[1]=b=>e.rerender()),onKeydown:[Ue(q(b=>e.select(f),["prevent"]),["enter"]),Ue(q(b=>e.select(f),["prevent"]),["space"])]},null,40,Zj))),128))]),C(i,{ref:"render",canvasWidth:e.canvasWidth,canvasHeight:e.canvasHeight,preLoading:e.preLoading},null,8,["canvasWidth","canvasHeight","preLoading"]),C(a),C(l,{onShowPrevRender:e.drawLastDownload,onDownload:t[2]||(t[2]=f=>e.$refs.render.download()),onShowDialog:e.showDialog,onShowExpressionDialog:e.showExpressionDialog},null,8,["onShowPrevRender","onShowDialog","onShowExpressionDialog"]),(g(),U(xg,null,[e.dialogVisable?(g(),U(c,{key:0,ref:"dialog",onLeave:t[4]||(t[4]=f=>e.dialogVisable=!1)},{default:B(()=>[C(d,{ref:"packDialog",onLeave:t[3]||(t[3]=f=>e.dialogVisable=!1)},null,512)]),_:1},512)):K("",!0)],1024)),e.expressionBuilderVisible?(g(),U(c,{key:0,ref:"dialog",onLeave:t[6]||(t[6]=f=>e.expressionBuilderVisible=!1)},{default:B(()=>[C(p,{character:e.expressionBuilderCharacter,initHeadGroup:e.expressionBuilderHeadGroup,onLeave:t[5]||(t[5]=f=>e.expressionBuilderVisible=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):K("",!0)],2)),Qj],64)}const tI=oe(Kj,[["render",eI]]);var nI=Object.defineProperty,oI=Object.defineProperties,sI=Object.getOwnPropertyDescriptors,uu=Object.getOwnPropertySymbols,rI=Object.prototype.hasOwnProperty,iI=Object.prototype.propertyIsEnumerable,pu=(e,t,n)=>t in e?nI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qr=(e,t)=>{for(var n in t||(t={}))rI.call(t,n)&&pu(e,n,t[n]);if(uu)for(var n of uu(t))iI.call(t,n)&&pu(e,n,t[n]);return e},lI=(e,t)=>oI(e,sI(t));function Ks(e,t){return{backgrounds:aI(e.backgrounds,t.backgrounds),characters:cI(e.characters,t.characters),dependencies:yl(e.dependencies,t.dependencies),fonts:Dt(e.fonts,t.fonts,n=>n.id,(n,o)=>lI(qr({},n),{files:yl(n.files,o.files)})),poemStyles:Dt(e.poemStyles,t.poemStyles,n=>n.label,()=>{throw new Error}),poemBackgrounds:[...e.poemBackgrounds,...t.poemBackgrounds],sprites:Dt(e.sprites,t.sprites,n=>n.id,(n,o)=>{var s;return{id:n.id,label:n.label,variants:[...n.variants,...o.variants],defaultScale:n.defaultScale,hd:n.hd,sdVersion:(s=n.sdVersion)!=null?s:o.sdVersion}}),colors:Dt(e.colors,t.colors,n=>n.color,n=>n)}}function aI(e,t){return Dt(e,t,n=>n.id,dI)}function dI(e,t){var n;return{id:e.id,label:e.label,variants:[...e.variants,...t.variants],scaling:e.scaling,sdVersion:(n=e.sdVersion)!=null?n:t.sdVersion}}function cI(e,t){return Dt(e,t,n=>n.id,uI)}function uI(e,t){return{chibi:e.chibi,id:e.id,label:e.label,heads:hI(e.heads,t.heads),defaultScale:e.defaultScale,hd:e.hd,size:e.size,sdVersion:e.sdVersion,styleGroups:Dt(e.styleGroups,t.styleGroups,n=>n.id,(n,o)=>({id:n.id,styleComponents:Dt(n.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:pI(s.variants,r.variants)})),styles:Dt(n.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:Dt(s.poses,r.poses,i=>i.id,fI)}))}))}}function pI(e,t){const n=qr({},e);for(const o in t)!t.hasOwnProperty(o)||n.hasOwnProperty(o)||(n[o]=t[o]);return n}function fI(e,t){const n=qr({},e.positions);for(const o in t.positions)n[o]?n[o]=[...n[o],...t.positions[o]]:n[o]=t.positions[o];return{id:e.id,compatibleHeads:yl(e.compatibleHeads,t.compatibleHeads),previewOffset:e.previewOffset,previewSize:e.previewSize,scale:e.scale,size:e.size,renderCommands:e.renderCommands,positions:n}}function hI(e,t){const n=qr({},e);for(const o in t){if(!t.hasOwnProperty(o))continue;const s=t[o];if(n[o]){const r=n[o];n[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else n[o]=s}return n}function yl(e,t){const n=[...e];for(const o of t)n.includes(o)||n.push(o);return n}function Dt(e,t,n,o){const s=[...e],r=new Map(e.map((i,a)=>[n(i),a]));for(const i of t){const a=n(i);if(r.has(a)){const l=r.get(a),d=s[l];s.splice(l,1,o(d,i))}else r.set(a,s.length),s.push(i)}return s}function gI(){return Nf().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Nf(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const mI=typeof Proxy=="function",bI="devtools-plugin:setup",vI="plugin:settings:set";let Yn,_l;function yI(){var e;return Yn!==void 0||(typeof window!="undefined"&&window.performance?(Yn=!0,_l=window.performance):typeof global!="undefined"&&((e=global.perf_hooks)===null||e===void 0?void 0:e.performance)?(Yn=!0,_l=global.perf_hooks.performance):Yn=!1),Yn}function _I(){return yI()?_l.now():Date.now()}class wI{constructor(t,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=n;const o={};if(t.settings)for(const i in t.settings){const a=t.settings[i];o[i]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let r=Object.assign({},o);try{const i=localStorage.getItem(s),a=JSON.parse(i);Object.assign(r,a)}catch(i){}this.fallbacks={getSettings(){return r},setSettings(i){try{localStorage.setItem(s,JSON.stringify(i))}catch(a){}r=i},now(){return _I()}},n&&n.on(vI,(i,a)=>{i===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(i,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(i,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(d=>{this.targetQueue.push({method:a,args:l,resolve:d})})})}setRealTarget(t){return Zr(this,null,function*(){this.target=t;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(yield this.target[n.method](...n.args))})}}function $I(e,t){const n=e,o=Nf(),s=gI(),r=mI&&n.enableEarlyProxy;if(s&&(o.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!r))s.emit(bI,e,t);else{const i=r?new wI(n,s):null;(o.__VUE_DEVTOOLS_PLUGINS__=o.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:t,proxy:i}),i&&t(i.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var CI="store";function Do(e,t){Object.keys(e).forEach(function(n){return t(e[n],n)})}function PI(e){return e!==null&&typeof e=="object"}function SI(e){return e&&typeof e.then=="function"}function kI(e,t){return function(){return e(t)}}function Hf(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var o=t.indexOf(e);o>-1&&t.splice(o,1)}}function Lf(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;Xr(e,n,[],e._modules.root,!0),ja(e,n,t)}function ja(e,t,n){var o=e._state,s=e._scope;e.getters={},e._makeLocalGettersCache=Object.create(null);var r=e._wrappedGetters,i={},a={},l=jh(!0);l.run(function(){Do(r,function(d,c){i[c]=kI(d,e),a[c]=nr(function(){return i[c]()}),Object.defineProperty(e.getters,c,{get:function(){return a[c].value},enumerable:!0})})}),e._state=yn({data:t}),e._scope=l,e.strict&&TI(e),o&&n&&e._withCommit(function(){o.data=null}),s&&s.stop()}function Xr(e,t,n,o,s){var r=!n.length,i=e._modules.getNamespace(n);if(o.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=o),!r&&!s){var a=Ia(t,n.slice(0,-1)),l=n[n.length-1];e._withCommit(function(){a[l]=o.state})}var d=o.context=OI(e,i,n);o.forEachMutation(function(c,p){var f=i+p;xI(e,f,c,d)}),o.forEachAction(function(c,p){var f=c.root?p:i+p,b=c.handler||c;jI(e,f,b,d)}),o.forEachGetter(function(c,p){var f=i+p;II(e,f,c,d)}),o.forEachChild(function(c,p){Xr(e,t,n.concat(p),c,s)})}function OI(e,t,n){var o=t==="",s={dispatch:o?e.dispatch:function(r,i,a){var l=gr(r,i,a),d=l.payload,c=l.options,p=l.type;return(!c||!c.root)&&(p=t+p),e.dispatch(p,d)},commit:o?e.commit:function(r,i,a){var l=gr(r,i,a),d=l.payload,c=l.options,p=l.type;(!c||!c.root)&&(p=t+p),e.commit(p,d,c)}};return Object.defineProperties(s,{getters:{get:o?function(){return e.getters}:function(){return Uf(e,t)}},state:{get:function(){return Ia(e.state,n)}}}),s}function Uf(e,t){if(!e._makeLocalGettersCache[t]){var n={},o=t.length;Object.keys(e.getters).forEach(function(s){if(s.slice(0,o)===t){var r=s.slice(o);Object.defineProperty(n,r,{get:function(){return e.getters[s]},enumerable:!0})}}),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function xI(e,t,n,o){var s=e._mutations[t]||(e._mutations[t]=[]);s.push(function(i){n.call(e,o.state,i)})}function jI(e,t,n,o){var s=e._actions[t]||(e._actions[t]=[]);s.push(function(i){var a=n.call(e,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:e.getters,rootState:e.state},i);return SI(a)||(a=Promise.resolve(a)),e._devtoolHook?a.catch(function(l){throw e._devtoolHook.emit("vuex:error",l),l}):a})}function II(e,t,n,o){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(r){return n(o.state,o.getters,r.state,r.getters)})}function TI(e){Rn(function(){return e._state.data},function(){},{deep:!0,flush:"sync"})}function Ia(e,t){return t.reduce(function(n,o){return n[o]},e)}function gr(e,t,n){return PI(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var EI="vuex bindings",fu="vuex:mutations",Bi="vuex:actions",Jn="vuex",BI=0;function AI(e,t){$I({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[EI]},function(n){n.addTimelineLayer({id:fu,label:"Vuex Mutations",color:hu}),n.addTimelineLayer({id:Bi,label:"Vuex Actions",color:hu}),n.addInspector({id:Jn,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(o){if(o.app===e&&o.inspectorId===Jn)if(o.filter){var s=[];Gf(s,t._modules.root,o.filter,""),o.rootNodes=s}else o.rootNodes=[zf(t._modules.root,"")]}),n.on.getInspectorState(function(o){if(o.app===e&&o.inspectorId===Jn){var s=o.nodeId;Uf(t,s),o.state=FI(NI(t._modules,s),s==="root"?t.getters:t._makeLocalGettersCache,s)}}),n.on.editInspectorState(function(o){if(o.app===e&&o.inspectorId===Jn){var s=o.nodeId,r=o.path;s!=="root"&&(r=s.split("/").filter(Boolean).concat(r)),t._withCommit(function(){o.set(t._state.data,r,o.state.value)})}}),t.subscribe(function(o,s){var r={};o.payload&&(r.payload=o.payload),r.state=s,n.notifyComponentUpdate(),n.sendInspectorTree(Jn),n.sendInspectorState(Jn),n.addTimelineEvent({layerId:fu,event:{time:Date.now(),title:o.type,data:r}})}),t.subscribeAction({before:function(o,s){var r={};o.payload&&(r.payload=o.payload),o._id=BI++,o._time=Date.now(),r.state=s,n.addTimelineEvent({layerId:Bi,event:{time:o._time,title:o.type,groupId:o._id,subtitle:"start",data:r}})},after:function(o,s){var r={},i=Date.now()-o._time;r.duration={_custom:{type:"duration",display:i+"ms",tooltip:"Action duration",value:i}},o.payload&&(r.payload=o.payload),r.state=s,n.addTimelineEvent({layerId:Bi,event:{time:Date.now(),title:o.type,groupId:o._id,subtitle:"end",data:r}})}})})}var hu=8702998,DI=6710886,RI=16777215,Vf={label:"namespaced",textColor:RI,backgroundColor:DI};function Wf(e){return e&&e!=="root"?e.split("/").slice(-2,-1)[0]:"Root"}function zf(e,t){return{id:t||"root",label:Wf(t),tags:e.namespaced?[Vf]:[],children:Object.keys(e._children).map(function(n){return zf(e._children[n],t+n+"/")})}}function Gf(e,t,n,o){o.includes(n)&&e.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:t.namespaced?[Vf]:[]}),Object.keys(t._children).forEach(function(s){Gf(e,t._children[s],n,o+s+"/")})}function FI(e,t,n){t=n==="root"?t:t[n];var o=Object.keys(t),s={state:Object.keys(e.state).map(function(i){return{key:i,editable:!0,value:e.state[i]}})};if(o.length){var r=MI(t);s.getters=Object.keys(r).map(function(i){return{key:i.endsWith("/")?Wf(i):i,editable:!1,value:wl(function(){return r[i]})}})}return s}function MI(e){var t={};return Object.keys(e).forEach(function(n){var o=n.split("/");if(o.length>1){var s=t,r=o.pop();o.forEach(function(i){s[i]||(s[i]={_custom:{value:{},display:i,tooltip:"Module",abstract:!0}}),s=s[i]._custom.value}),s[r]=wl(function(){return e[n]})}else t[n]=wl(function(){return e[n]})}),t}function NI(e,t){var n=t.split("/").filter(function(o){return o});return n.reduce(function(o,s,r){var i=o[s];if(!i)throw new Error('Missing module "'+s+'" for path "'+t+'".');return r===n.length-1?i:i._children},t==="root"?e:e.root._children)}function wl(e){try{return e()}catch(t){return t}}var Ct=function(t,n){this.runtime=n,this._children=Object.create(null),this._rawModule=t;var o=t.state;this.state=(typeof o=="function"?o():o)||{}},qf={namespaced:{configurable:!0}};qf.namespaced.get=function(){return!!this._rawModule.namespaced};Ct.prototype.addChild=function(t,n){this._children[t]=n};Ct.prototype.removeChild=function(t){delete this._children[t]};Ct.prototype.getChild=function(t){return this._children[t]};Ct.prototype.hasChild=function(t){return t in this._children};Ct.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)};Ct.prototype.forEachChild=function(t){Do(this._children,t)};Ct.prototype.forEachGetter=function(t){this._rawModule.getters&&Do(this._rawModule.getters,t)};Ct.prototype.forEachAction=function(t){this._rawModule.actions&&Do(this._rawModule.actions,t)};Ct.prototype.forEachMutation=function(t){this._rawModule.mutations&&Do(this._rawModule.mutations,t)};Object.defineProperties(Ct.prototype,qf);var Vn=function(t){this.register([],t,!1)};Vn.prototype.get=function(t){return t.reduce(function(n,o){return n.getChild(o)},this.root)};Vn.prototype.getNamespace=function(t){var n=this.root;return t.reduce(function(o,s){return n=n.getChild(s),o+(n.namespaced?s+"/":"")},"")};Vn.prototype.update=function(t){Xf([],this.root,t)};Vn.prototype.register=function(t,n,o){var s=this;o===void 0&&(o=!0);var r=new Ct(n,o);if(t.length===0)this.root=r;else{var i=this.get(t.slice(0,-1));i.addChild(t[t.length-1],r)}n.modules&&Do(n.modules,function(a,l){s.register(t.concat(l),a,o)})};Vn.prototype.unregister=function(t){var n=this.get(t.slice(0,-1)),o=t[t.length-1],s=n.getChild(o);!s||!s.runtime||n.removeChild(o)};Vn.prototype.isRegistered=function(t){var n=this.get(t.slice(0,-1)),o=t[t.length-1];return n?n.hasChild(o):!1};function Xf(e,t,n){if(t.update(n),n.modules)for(var o in n.modules){if(!t.getChild(o))return;Xf(e.concat(o),t.getChild(o),n.modules[o])}}function HI(e){return new Qe(e)}var Qe=function(t){var n=this;t===void 0&&(t={});var o=t.plugins;o===void 0&&(o=[]);var s=t.strict;s===void 0&&(s=!1);var r=t.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new Vn(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=r;var i=this,a=this,l=a.dispatch,d=a.commit;this.dispatch=function(f,b){return l.call(i,f,b)},this.commit=function(f,b,v){return d.call(i,f,b,v)},this.strict=s;var c=this._modules.root.state;Xr(this,c,[],this._modules.root),ja(this,c),o.forEach(function(p){return p(n)})},Ta={state:{configurable:!0}};Qe.prototype.install=function(t,n){t.provide(n||CI,this),t.config.globalProperties.$store=this;var o=this._devtools!==void 0?this._devtools:!1;o&&AI(t,this)};Ta.state.get=function(){return this._state.data};Ta.state.set=function(e){};Qe.prototype.commit=function(t,n,o){var s=this,r=gr(t,n,o),i=r.type,a=r.payload,l={type:i,payload:a},d=this._mutations[i];!d||(this._withCommit(function(){d.forEach(function(p){p(a)})}),this._subscribers.slice().forEach(function(c){return c(l,s.state)}))};Qe.prototype.dispatch=function(t,n){var o=this,s=gr(t,n),r=s.type,i=s.payload,a={type:r,payload:i},l=this._actions[r];if(!!l){try{this._actionSubscribers.slice().filter(function(c){return c.before}).forEach(function(c){return c.before(a,o.state)})}catch(c){}var d=l.length>1?Promise.all(l.map(function(c){return c(i)})):l[0](i);return new Promise(function(c,p){d.then(function(f){try{o._actionSubscribers.filter(function(b){return b.after}).forEach(function(b){return b.after(a,o.state)})}catch(b){}c(f)},function(f){try{o._actionSubscribers.filter(function(b){return b.error}).forEach(function(b){return b.error(a,o.state,f)})}catch(b){}p(f)})})}};Qe.prototype.subscribe=function(t,n){return Hf(t,this._subscribers,n)};Qe.prototype.subscribeAction=function(t,n){var o=typeof t=="function"?{before:t}:t;return Hf(o,this._actionSubscribers,n)};Qe.prototype.watch=function(t,n,o){var s=this;return Rn(function(){return t(s.state,s.getters)},n,Object.assign({},o))};Qe.prototype.replaceState=function(t){var n=this;this._withCommit(function(){n._state.data=t})};Qe.prototype.registerModule=function(t,n,o){o===void 0&&(o={}),typeof t=="string"&&(t=[t]),this._modules.register(t,n),Xr(this,this.state,t,this._modules.get(t),o.preserveState),ja(this,this.state)};Qe.prototype.unregisterModule=function(t){var n=this;typeof t=="string"&&(t=[t]),this._modules.unregister(t),this._withCommit(function(){var o=Ia(n.state,t.slice(0,-1));delete o[t[t.length-1]]}),Lf(this)};Qe.prototype.hasModule=function(t){return typeof t=="string"&&(t=[t]),this._modules.isRegistered(t)};Qe.prototype.hotUpdate=function(t){this._modules.update(t),Lf(this,!0)};Qe.prototype._withCommit=function(t){var n=this._committing;this._committing=!0,t(),this._committing=n};Object.defineProperties(Qe.prototype,Ta);function Kf(){return{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1}}const LI={namespaced:!0,state:Kf(),mutations:{setVertical(e,t){e.vertical=t},setNsfw(e,t){e.nsfw=t},setLqRendering(e,t){e.lqRendering=t},setSelection(e,t){e.selection=t},setLastDownload(e,t){e.lastDownload=t},setClipboard(e,t){e.clipboard=t},setDarkTheme(e,t){e.useDarkTheme=t},setDefaultCharacterTalkingZoom(e,t){e.defaultCharacterTalkingZoom=t},setColorPicker(e,t){e.pickColor=t}}};var bn={},mr=De&&De.__assign||function(){return mr=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},mr.apply(this,arguments)},Yf=De&&De.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},UI=De&&De.__read||function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),s,r=[],i;try{for(;(t===void 0||t-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r},VI=De&&De.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(UI(arguments[t]));return e};Object.defineProperty(bn,"__esModule",{value:!0});bn.mapObject=Jf=bn.assetWalker=$l=bn.normalizePath=void 0;var WI=10;function zI(e,t,n,o){for(var s,r,i="",a=0,l=new Map(Array.from(t.entries()).map(function(f){return[new RegExp("{"+f[0]+"}","g"),f[1]]}));i!==e;){if(i=e,++a>WI)throw new Error("Maximum replacement recursion exceeded!");try{for(var d=(s=void 0,Yf(l.entries())),c=d.next();!c.done;c=d.next()){var p=c.value;e=e.replace(p[0],p[1])}}catch(f){s={error:f}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(s)throw s.error}}e=e.replace(/{format(:.*?:.*?)+}/gi,function(f){f=f.slice(8,-1);for(var b=f.split(":"),v=0;v<b.length;v+=2)if(n.has(b[v]))return b[v+1];return""}),e=e.replace(/{lq:(.*?):(.*?)}/gi,function(f){return f.slice(4,-1).split(":")[o?0:1]})}return e}var $l=bn.normalizePath=zI;function GI(e,t){return{packId:e.packId,packCredits:e.packCredits,dependencies:e.dependencies,characters:e.characters.map(function(n){return qI(n,t)}),backgrounds:e.backgrounds.map(function(n){return tT(n,t)}),fonts:e.fonts.map(function(n){return nT(n,t)}),poemStyles:VI(e.poemStyles),poemBackgrounds:e.poemBackgrounds.map(function(n){return oT(n,t)}),sprites:e.sprites.map(function(n){return sT(n,t)}),colors:e.colors}}var Jf=bn.assetWalker=GI;function qI(e,t){return{id:e.id,label:e.label,chibi:e.chibi?t(e.chibi,"image"):void 0,heads:QI(e.heads,t),styleGroups:e.styleGroups.map(function(n){return XI(n,t)}),defaultScale:e.defaultScale,hd:e.hd,size:e.size,sdVersion:e.sdVersion}}function XI(e,t){return{id:e.id,styleComponents:e.styleComponents.map(function(n){return YI(n,t)}),styles:e.styles.map(function(n){return KI(n,t)})}}function KI(e,t){return{components:e.components,poses:e.poses.map(function(n){return ZI(n,t)})}}function YI(e,t){return mr(mr({},e),{variants:JI(e.variants,t)})}function JI(e,t){var n={};for(var o in e)!e.hasOwnProperty(o)||(n[o]=t(e[o],"image"));return n}function ZI(e,t){var n,o,s={};try{for(var r=Yf(Object.keys(e.positions)),i=r.next();!i.done;i=r.next()){var a=i.value,l=e.positions[a];s[a]=l.map(function(d){return d.map(function(c){return t(c,"image")})})}}catch(d){n={error:d}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return{compatibleHeads:e.compatibleHeads,id:e.id,previewOffset:e.previewOffset,previewSize:e.previewSize,renderCommands:e.renderCommands.map(function(d){return d.type==="image"?{type:"image",offset:d.offset,images:d.images.map(function(c){return t(c,"image")})}:d}),size:e.size,scale:e.scale,positions:s}}function QI(e,t){var n={};for(var o in e)!e.hasOwnProperty(o)||(n[o]=eT(e[o],t));return n}function eT(e,t){return{previewOffset:e.previewOffset,previewSize:e.previewSize,variants:e.variants.map(function(n){return n.map(function(o){return t(o,"image")})})}}function tT(e,t){return{id:e.id,label:e.label,variants:e.variants.map(function(n){return n.map(function(o){return t(o,"image")})}),scaling:e.scaling,sdVersion:e.sdVersion}}function nT(e,t){return{id:e.id,label:e.label,files:e.files.map(function(n){return t(n,"font")})}}function oT(e,t){return{id:e.id,fontColor:e.fontColor,label:e.label,images:e.images.map(function(n){return t(n,"image")}),sdVersion:e.sdVersion}}function sT(e,t){return{id:e.id,label:e.label,variants:e.variants.map(function(n){return n.map(function(o){return t(o,"image")})}),defaultScale:e.defaultScale,hd:e.hd,sdVersion:e.sdVersion}}function rT(e,t){var n={};for(var o in e)!e.hasOwnProperty(o)||(n[o]=t(e[o],o));return n}bn.mapObject=rT;var Oe={},br=De&&De.__assign||function(){return br=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},br.apply(this,arguments)};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.expandId=Oe.normalizeStyleComponent=Oe.normalizeColor=Oe.normalizeBackground=Oe.normalizeFont=Oe.normalizePoemBackground=Oe.normalizePoemStyles=Oe.normalizeSprite=Oe.mapNormalize=Zf=Oe.normalizeContentPack=void 0;var iT=bn;function lT(e,t){var n={paths:t,packId:e.packId},o=Ye("",e.folder||"/",n);return{packId:e.packId,packCredits:e.packCredits,dependencies:e.dependencies||[],characters:Tt(aT,e.characters,o,n),backgrounds:Tt(oh,e.backgrounds,o,n),fonts:Tt(nh,e.fonts,o,n),poemStyles:Tt(eh,e.poemStyles,o,n),poemBackgrounds:Tt(th,e.poemBackgrounds,o,n),sprites:Tt(Qf,e.sprites,o,n),colors:Tt(sh,e.colors,o,n)}}var Zf=Oe.normalizeContentPack=lT;function Tt(e,t,n,o){return t?t.map(function(s){return e(s,n,o)}):[]}Oe.mapNormalize=Tt;function Qf(e,t,n){var o,s=Ye(t,e.folder,n);return{id:$t(n.packId,e.id),label:e.label||e.variants[0][0],variants:e.variants.map(function(r){return Kr(r,s,n)}),defaultScale:e.defaultScale||[1,1],sdVersion:e.sdVersion,hd:(o=e.hd)!==null&&o!==void 0?o:null}}Oe.normalizeSprite=Qf;function eh(e){return{label:e.label,defaultFont:e.defaultFont||"Aller",fontSize:e.fontSize!==void 0?e.fontSize:30,letterSpacing:e.letterSpacing!==void 0?e.letterSpacing:1,lineSpacing:e.lineSpacing!==void 0?e.lineSpacing:1.2}}Oe.normalizePoemStyles=eh;function th(e,t,n){var o=Ye(t,e.folder,n);return{id:e.id,label:e.label,images:Kr(e.images,o,n),fontColor:e.fontColor||"black",sdVersion:e.sdVersion}}Oe.normalizePoemBackground=th;function nh(e,t,n){var o=Ye(t,e.folder,n);return{id:$t(n.packId,e.id?e.id:e.label?e.label:e.files[0]),label:e.label?e.label:e.id?e.id:e.files[0],files:Kr(e.files,o,n)}}Oe.normalizeFont=nh;function oh(e,t,n){var o,s=Ye(t,e.folder,n);return{id:$t(n.packId,e.id),label:e.label?e.label:e.variants[0][0],variants:e.variants.map(function(r){return Kr(r,s,n)}),scaling:["none","strech","cover"].includes((o=e.scaling)===null||o===void 0?void 0:o.toLowerCase())?e.scaling.toLowerCase():"cover",sdVersion:e.sdVersion}}Oe.normalizeBackground=oh;function sh(e){return{label:e.label||e.color,color:e.color}}Oe.normalizeColor=sh;function Kr(e,t,n){return e.map(function(o){return Ye(t,o,n)})}function aT(e,t,n){var o,s,r,i=Ye(t,e.folder,n);return{id:$t(n.packId,e.id),label:e.label,chibi:e.chibi?Ye(i,e.chibi,n):void 0,heads:pT(e.heads,i,n),defaultScale:(o=e.defaultScale)!==null&&o!==void 0?o:[.8,.8],size:(s=e.size)!==null&&s!==void 0?s:[960,960],hd:(r=e.hd)!==null&&r!==void 0?r:!1,sdVersion:e.sdVersion,styleGroups:Tt(dT,e.styleGroups,i,n)}}function dT(e,t,n){var o=Ye(t,e.folder,n);return{id:$t(n.packId,e.id),styleComponents:Tt(rh,e.styleComponents,o,n),styles:e.styles.map(function(s){return cT(s,o,n)})}}function cT(e,t,n){var o=Ye(t,e.folder,n),s={};if(e.components)for(var r in e.components)!e.components.hasOwnProperty(r)||(s[$t(n.packId,r)]=e.components[r]);return{components:s,poses:e.poses.map(function(i){return fT(i,o,n)})}}function rh(e,t,n){return{id:$t(n.packId,e.id),label:e.label,variants:uT(e.variants,t,n)}}Oe.normalizeStyleComponent=rh;function uT(e,t,n){if(!e)return{};var o={};for(var s in e)!e.hasOwnProperty(s)||(o[s]=Ye(t,e[s],n));return o}function pT(e,t,n){var o={};if(!e)return o;for(var s in e)if(!!e.hasOwnProperty(s)){var r=e[s],i=void 0;if(r instanceof Array)i={variants:Cl(r,t,n),previewOffset:[290,70],previewSize:[380,380]};else{var a=Ye(t,r.folder,n);i={variants:Cl(r.variants,a,n),previewOffset:r.previewOffset||[290,70],previewSize:r.previewSize||[380,380]}}o[$t(n.packId,s)]=i}return o}function fT(e,t,n){var o,s,r=Ye(t,e.folder,n);return{compatibleHeads:((o=e.compatibleHeads)===null||o===void 0?void 0:o.map(function(i){return $t(n.packId,i)}))||[],id:$t(n.packId,e.id),previewOffset:e.previewOffset||[0,0],previewSize:e.previewSize||[960,960],size:e.size||[960,960],scale:e.scale||.8,positions:iT.mapObject(e.positions||{},function(i){return Cl(i,r,n)}),renderCommands:((s=e.renderCommands)===null||s===void 0?void 0:s.map(function(i){return hT(i,t,n)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function hT(e,t,n){if(e.type==="image"){var o=Ye(t,e.folder,n);return{type:"image",composite:e.composite,offset:e.offset||[0,0],images:ih(e.images,o,n)}}else return br(br({},e),{offset:e.offset||[0,0]})}function Cl(e,t,n){return e.map(function(o){return ih(o,t,n)})}function ih(e,t,n){return e.map(function(o){return Ye(t,o,n)})}function gT(e){return e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("://")}function Ye(e,t,n){if(!t)return e;for(var o in n.paths)if(t.startsWith(o))return n.paths[o]+t.slice(o.length);return gT(t)?t:e+t}function $t(e,t){return t.indexOf(":")!==-1?t:e+":"+t}Oe.expandId=$t;var ps={},Ys=De&&De.__values||function(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},mT=De&&De.__read||function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),s,r=[],i;try{for(;(t===void 0||t-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r},Ai=De&&De.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(mT(arguments[t]));return e};Object.defineProperty(ps,"__esModule",{value:!0});ps.expandOrTranslateId=lh=ps.convert=void 0;var Pl=Oe;function bT(e,t,n){if(!e.packId)throw new Error("");return{packId:e.packId,packCredits:e.packCredits?[e.packCredits]:[],dependencies:vT(e.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[yT(e,t,n)],colors:[]}}var lh=ps.convert=bT,ah={"ddlc.monika":It("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":It("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":It("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":It("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":It("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":It("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":It("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":It("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":It("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":It("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function vT(e){return[]}function yT(e,t,n){var o={characterId:e.id,packId:e.packId,paths:t};return{id:_n("character",e.id,o),chibi:e.chibi,label:e.name,heads:PT(e.heads,o,n),styleGroups:_T(e,o,n),defaultScale:[.8,.8],size:[960,960],hd:!1}}function _T(e,t,n){var o,s,r=ah[t.characterId],i=[],a=new Map,l=ST(e,t),d=l.length===0?r&&r.defaultStyleComponents?wT(r.defaultStyleComponents,t):[]:l,c=e.poses.map(function(M){return M.style}).filter(function(M,R,w){return w.indexOf(M)===R}),p=new Map(e.styles.map(function(M){return[M.name,M]})),f=function(M){var R,w,x,j,Y=p.get(M);if(Y&&Y.nsfw&&!n)return"continue";var ee=M,ae={};try{for(var L=(R=void 0,Ys(d)),se=L.next();!se.done;se=L.next()){var ne=se.value;try{for(var ge=(x=void 0,Ys(Object.keys(ne.variants))),N=ge.next();!N.done;N=ge.next()){var ye=N.value,Ve=new RegExp("-"+ye+"\\b");if(ee.match(Ve)){ae[ne.id]=ye,ee=ee.replace(Ve,"");break}}}catch(Se){x={error:Se}}finally{try{N&&!N.done&&(j=ge.return)&&j.call(ge)}finally{if(x)throw x.error}}}}catch(Se){R={error:Se}}finally{try{se&&!se.done&&(w=L.return)&&w.call(L)}finally{if(R)throw R.error}}ee=_n("styleGroups",ee,t);var Pt=a.get(ee);Pt||(Pt={id:ee,styleComponents:d,styles:[]},a.set(ee,Pt),i.push(ee)),Pt.styles.push({components:ae,poses:CT(e.poses.filter(function(Se){return Se.style===M}),t,n)})};try{for(var b=Ys(c),v=b.next();!v.done;v=b.next()){var $=v.value;f($)}}catch(M){o={error:M}}finally{try{v&&!v.done&&(s=b.return)&&s.call(b)}finally{if(o)throw o.error}}return i.map(function(M){return a.get(M)})}function wT(e,t){return Pl.mapNormalize(Pl.normalizeStyleComponent,e,"",{packId:t.packId,paths:t.paths})}function $T(e,t){return e?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:t}]:[{type:"head",offset:t},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function CT(e,t,n){return e.map(function(o){return{compatibleHeads:o.compatibleHeads.map(function(s){return _n("heads",s.toString(),t)}),id:_n("poses",o.name,t),renderCommands:$T(o.headInForeground,o.headAnchor),previewOffset:o.offset,previewSize:o.size,size:[960,960],scale:.8,positions:{Static:"static"in o?[[o.static]]:[],Left:"left"in o?Di(o.left,n):[],Right:"right"in o?Di(o.right,n):[],Variant:"variant"in o?Di(o.variant,n):[]}}})}function Di(e,t){return e.filter(function(n){return!n.nsfw||t}).map(function(n){return[n.img]})}function PT(e,t,n){var o,s,r={};try{for(var i=Ys(Object.keys(e)),a=i.next();!a.done;a=i.next()){var l=a.value,d=e[l];d.nsfw&&!n||(r[_n("heads",l,t)]={previewOffset:d.offset,previewSize:d.size,variants:d.all.filter(function(c){return!c.nsfw||n}).map(function(c){return[c.img]})})}}catch(c){o={error:c}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(o)throw o.error}}return r}function ST(e,t){var n=[],o=[];return Object.keys(e.eyes).length>0&&(Object.keys(e.eyes).forEach(function(s){return o.push(s)}),n.push({label:"Eyes",id:_n("eyes","eyes",t),variants:e.eyes})),Object.keys(e.hairs).length>0&&(Object.keys(e.hairs).forEach(function(s){return o.push(s)}),n.push({label:"Hairs",id:_n("hairs","hairs",t),variants:e.hairs})),n}function Ri(e,t){return new Map(t.map(function(n){return[n,e+":"+n]}))}function It(e,t,n){return n.extraHeadAssoc?n.extraHeadAssoc=n.extraHeadAssoc.map(function(o){return[o[0],e+":"+o[1]]}):n.extraHeadAssoc=[],n.extraPoseAssoc?n.extraPoseAssoc=n.extraPoseAssoc.map(function(o){return[o[0],e+":"+o[1]]}):n.extraPoseAssoc=[],n.extraStyleGroupAssoc?n.extraStyleGroupAssoc=n.extraStyleGroupAssoc.map(function(o){return[o[0],e+":"+o[1]]}):n.extraStyleGroupAssoc=[],{character:e+":"+t,eyes:e+":eyes",hairs:e+":hair",defaultStyleComponents:n.defaultStyleComponents||[],heads:new Map(Ai(Ri(e,n.heads),n.extraHeadAssoc)),poses:new Map(Ai(Ri(e,n.poses),n.extraPoseAssoc)),styleGroups:new Map(Ai(Ri(e,n.styleGroups),n.extraStyleGroupAssoc))}}function _n(e,t,n){var o=ah[n.characterId];if(o){if(e==="character"||e==="hairs"||e==="eyes")return o[e];var s=o[e].get(t);if(s)return s}return Pl.expandId(n.packId,t)}ps.expandOrTranslateId=_n;var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});var dh=Ea.normalizeCharacter=void 0;function kT(e,t){var n=wn("",e.folder||"/",t),o=void 0;return e.chibi&&(o=wn(n,e.chibi,t)),o===void 0&&e.internalId&&(o=(t["/"]||"")+"chibis/"+e.internalId),{id:e.id,packId:e.packId,packCredits:e.packCredits,name:e.name,nsfw:!!e.nsfw,chibi:o,eyes:gu(e.eyes,n,t),hairs:gu(e.hairs,n,t),styles:jT(e.styles),heads:OT(e.heads,n,t),poses:xT(e.poses,n,t)}}dh=Ea.normalizeCharacter=kT;function gu(e,t,n){if(!e)return{};var o={};for(var s in e)!e.hasOwnProperty(s)||(o[s]=wn(t,e[s],n));return o}function OT(e,t,n){var o={};if(!e)return o;for(var s in e)if(!!e.hasOwnProperty(s)){var r=e[s],i=void 0;if(r instanceof Array)i={all:Qo(r,t,n),nsfw:!1,offset:[290,70],size:[380,380]};else{var a=wn(t,r.folder,n);i={all:Qo(r.all,a,n),nsfw:!!r.nsfw,offset:r.offset||[290,70],size:r.size||[380,380]}}o[s]=i}return o}function xT(e,t,n){return e?e.map(function(o){var s=wn(t,o.folder,n),r={compatibleHeads:o.compatibleHeads||[],headAnchor:o.headAnchor||[0,0],headInForeground:!!o.headInForeground,name:o.name,nsfw:!!o.nsfw,style:o.style,offset:[0,0],size:[960,960]};if("static"in o)r.static=wn(s,o.static,n);else if("variant"in o)r.variant=Qo(o.variant,s,n);else if("left"in o)r.left=Qo(o.left,s,n),r.right=Qo(o.right,s,n);else throw new Error("Invalid pose");return r}):[]}function Qo(e,t,n){return e.map(function(o){return typeof o=="string"?{img:wn(t,o,n),nsfw:!1}:{img:wn(t,o.img,n),nsfw:o.nsfw||!1}})}function jT(e){return e?e.map(function(t){return{name:t.name,label:t.label,nsfw:t.nsfw||!1}}):[]}function IT(e){return e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")||e.startsWith("://")}function wn(e,t,n){if(!t)return e;for(var o in n)if(t.startsWith(o))return n[o]+t.slice(o.length);return IT(t)?t:e+t}var es=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});function mu(e){return e.split("/").slice(0,-1).join("/")+"/"}const bu=new Set(["png","gif","bmp","svg"]);function ch(){return{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}}}const TT={namespaced:!0,state:ch(),mutations:{setContentPacks(e,t){e.contentPacks=t},setCurrentContent(e,t){e.current=t}},actions:{removeContentPacks({commit:e,state:t,dispatch:n},o){const s=JSON.parse(JSON.stringify(t.current)),r=t.contentPacks.filter(i=>!o.has(i.packId));e("setContentPacks",r),e("setCurrentContent",r.reduce((i,a)=>Ks(i,a))),n("panels/fixContentPackRemoval",s,{root:!0})},replaceContentPack(e,t){return es(this,arguments,function*({commit:n,state:o},s){debugger;const r=s.processed?s.contentPack:yield vr(s.contentPack);let i=o.contentPacks;const a=i.findIndex(l=>l.packId===s.contentPack.packId);a===-1?i.push(r):i.splice(a,1,r),i=i,n("setContentPacks",i),n("setCurrentContent",i.reduce((l,d)=>Ks(l,d)))})},loadContentPacks(e,t){return es(this,arguments,function*({commit:n,state:o},s){typeof s=="string"&&(s=[s]);const r=yield Promise.all(s.map(d=>es(this,null,function*(){return Sl(d)}))),i=yield Promise.all(r.map(d=>vr(d))),a=new Set(o.contentPacks.map(d=>d.packId));let l=o.current;for(const d of i){for(const c of d.dependencies)if(!a.has(c))throw new Error(`Missing dependency '${c}'. Refusing to install ${d.packId}`);l=Ks(l,d)}return n("setContentPacks",[...o.contentPacks,...i]),n("setCurrentContent",l),r.map(d=>d.packId)})}},getters:{getCharacters({current:e}){const t=new Map;for(const n of e.characters)t.set(n.id,n);return t},getBackgrounds({current:e}){const t=new Map;for(const n of e.backgrounds)t.set(n.id,n);return t}}};function Sl(e){return es(this,null,function*(){const t=yield fetch(e);if(!t.ok)throw new Error(`Could not load content pack. Server responded with: ${t.statusText}`);let n;try{n=yield t.json()}catch(o){throw new Error("Content pack is not valid json!")}try{const o={"./":mu(e),"/":mu(location.href)+"assets/"};return n.version==="2.0"?Zf(n,o):lh(dh(n,o),o,!1)}catch(o){throw new Error("Content pack is not in a valid format!")}})}function vr(e){return es(this,null,function*(){const t=new Set((yield mo())?["webp",...bu]:bu),n=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Jf(e,(o,s)=>{var r;const i=$l(o,n,t,!1),a=$l(o,n,t,!0);return{hq:i,lq:a,sourcePack:(r=e.packId)!=null?r:"buildIn"}})})}const ET={namespaced:!0,state:{},mutations:{add(e,{name:t,url:n}){e[t]=n}},actions:{add({state:e,commit:t},{name:n,url:o}){if(e[n])throw new Error(`There is already an uploaded file called "${n}"`);const s="uploads:"+n;return t("add",{name:s,url:o}),jp(s,o),s}}};var BT=Object.defineProperty,AT=Object.defineProperties,DT=Object.getOwnPropertyDescriptors,vu=Object.getOwnPropertySymbols,RT=Object.prototype.hasOwnProperty,FT=Object.prototype.propertyIsEnumerable,yu=(e,t,n)=>t in e?BT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,MT=(e,t)=>{for(var n in t||(t={}))RT.call(t,n)&&yu(e,n,t[n]);if(vu)for(var n of vu(t))FT.call(t,n)&&yu(e,n,t[n]);return e},NT=(e,t)=>AT(e,DT(t)),Us=(e,t,n)=>new Promise((o,s)=>{var r=l=>{try{a(n.next(l))}catch(d){s(d)}},i=l=>{try{a(n.throw(l))}catch(d){s(d)}},a=l=>l.done?o(l.value):Promise.resolve(l.value).then(r,i);a((n=n.apply(e,t)).next())});const HT=HI({state:{unsafe:!1},mutations:{setUnsafe(e,t){e.unsafe=t}},actions:{removePacks(e,t){return Us(this,arguments,function*({dispatch:n,commit:o},{packs:s}){o("setUnsafe",!0),n("content/removeContentPacks",s),o("setUnsafe",!1)})},getSave(e,t){return Us(this,arguments,function*({state:n},o){const s=yield Jt.getInstance();return JSON.stringify(n,(r,i)=>{if(r!=="ui"&&r!=="lastRender")return r==="uploadUrls"?Object.keys(i):r==="content"&&o?i.contentPacks.filter(a=>{var l,d;return!((l=a.packId)!=null&&l.startsWith("dddg.buildin."))||((d=a.packId)==null?void 0:d.endsWith(".nsfw"))}).map(a=>{var l;let d=(l=a.packId)!=null&&l.startsWith("dddg.uploads.")?a:a.packId;if(a.packId!=null){const c=s.getPack(a.packId);c&&c.repoUrl!=null&&(d+=`;${c.repoUrl}`)}return d}):i},2)})},loadSave(e,t){return Us(this,arguments,function*({state:n},o){const s=JSON.parse(o),r=s.content;s.ui=NT(MT({},Kf()),{vertical:n.ui.vertical,lqRendering:n.ui.lqRendering,nsfw:r.find(l=>typeof l=="string"&&l.startsWith("dddg.buildin.")&&l.endsWith(".nsfw"))!==void 0,clipboard:n.ui.clipboard,useDarkTheme:n.ui.useDarkTheme,defaultCharacterTalkingZoom:n.ui.defaultCharacterTalkingZoom}),s.uploadUrls={},s.content=ch();const i=yield Jt.getInstance();s.content.contentPacks=[...n.content.contentPacks.filter(l=>{var d;return(d=l.packId)==null?void 0:d.startsWith("dddg.buildin.")}),...(yield Promise.all(r.map(l=>Us(this,null,function*(){if(typeof l!="string")return l;let d=null,c;l.indexOf(";")>=0?[c,d]=l.split(";"):c=l;const p=n.content.contentPacks.find(v=>v.packId===c);if(p)return p;if(l.startsWith("dddg.buildin.")&&l.endsWith(".nsfw")){const v=yield Sl(xa[l]);return yield vr(v)}d!=null&&!i.hasPack(c)&&(yield i.loadTempPack(d));const f=i.getPack(c);if(!f)return console.warn(`Pack Id ${l} not found!`),null;const b=yield Sl(f.dddg2Path||f.dddg1Path);return yield vr(b)})))).filter(l=>l!==null)];let a=s.content.current;for(const l of s.content.contentPacks)a=Ks(a,l);s.content.current=a,this.replaceState(s),pe.fire(new Tr)})}},modules:{ui:LI,panels:YO,content:TT,uploadUrls:ET}});Qm(tI).use(HT).mount("#main_wrapper");export{Mt as A,Mn as B,Ql as C,Ip as D,ws as E,V as F,sx as G,A as H,wt as I,na as L,Jt as R,Xo as S,UT as T,Sp as V,oe as _,u as a,q as b,y as c,te as d,K as e,am as f,qe as g,C as h,B as i,Ft as j,X as k,O as l,U as m,fe as n,g as o,Ge as p,Be as q,Pe as r,E as s,he as t,pe as u,Ae as v,ce as w,yn as x,Xt as y,ea as z};
