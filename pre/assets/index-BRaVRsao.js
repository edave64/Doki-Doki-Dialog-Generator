const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./single-box-D09kBSou.js","./single-box-NPFyOzrf.css","./expression-builder-x1snTv9q.js","./expression-builder-CTViDayE.css"])))=>i.map(i=>d[i]);
var th=Object.defineProperty;var nh=(n,t,e)=>t in n?th(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var C=(n,t,e)=>nh(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ql(n){const t=Object.create(null);for(const e of n.split(","))t[e]=1;return e=>e in t}const Ie={},Zn=[],Gt=()=>{},oh=()=>!1,hr=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),zl=n=>n.startsWith("onUpdate:"),ot=Object.assign,Xl=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},sh=Object.prototype.hasOwnProperty,Ee=(n,t)=>sh.call(n,t),me=Array.isArray,Qn=n=>mo(n)==="[object Map]",go=n=>mo(n)==="[object Set]",Ya=n=>mo(n)==="[object Date]",rh=n=>mo(n)==="[object RegExp]",ke=n=>typeof n=="function",Je=n=>typeof n=="string",Ht=n=>typeof n=="symbol",Fe=n=>n!==null&&typeof n=="object",Sd=n=>(Fe(n)||ke(n))&&ke(n.then)&&ke(n.catch),Pd=Object.prototype.toString,mo=n=>Pd.call(n),ih=n=>mo(n).slice(8,-1),Od=n=>mo(n)==="[object Object]",Yl=n=>Je(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Vo=ql(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),vr=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},lh=/-(\w)/g,rn=vr(n=>n.replace(lh,(t,e)=>e?e.toUpperCase():"")),ah=/\B([A-Z])/g,an=vr(n=>n.replace(ah,"-$1").toLowerCase()),Td=vr(n=>n.charAt(0).toUpperCase()+n.slice(1)),Br=vr(n=>n?`on${Td(n)}`:""),bt=(n,t)=>!Object.is(n,t),eo=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},$d=(n,t,e,o=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:o,value:e})},Ws=n=>{const t=parseFloat(n);return isNaN(t)?n:t},uh=n=>{const t=Je(n)?Number(n):NaN;return isNaN(t)?n:t};let Ga;const gr=()=>Ga||(Ga=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function et(n){if(me(n)){const t={};for(let e=0;e<n.length;e++){const o=n[e],s=Je(o)?ph(o):et(o);if(s)for(const r in s)t[r]=s[r]}return t}else if(Je(n)||Fe(n))return n}const ch=/;(?![^(]*\))/g,dh=/:([^]+)/,fh=/\/\*[^]*?\*\//g;function ph(n){const t={};return n.replace(fh,"").split(ch).forEach(e=>{if(e){const o=e.split(dh);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function Ne(n){let t="";if(Je(n))t=n;else if(me(n))for(let e=0;e<n.length;e++){const o=Ne(n[e]);o&&(t+=o+" ")}else if(Fe(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}const hh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",vh=ql(hh);function jd(n){return!!n||n===""}function gh(n,t){if(n.length!==t.length)return!1;let e=!0;for(let o=0;e&&o<n.length;o++)e=ds(n[o],t[o]);return e}function ds(n,t){if(n===t)return!0;let e=Ya(n),o=Ya(t);if(e||o)return e&&o?n.getTime()===t.getTime():!1;if(e=Ht(n),o=Ht(t),e||o)return n===t;if(e=me(n),o=me(t),e||o)return e&&o?gh(n,t):!1;if(e=Fe(n),o=Fe(t),e||o){if(!e||!o)return!1;const s=Object.keys(n).length,r=Object.keys(t).length;if(s!==r)return!1;for(const i in n){const l=n.hasOwnProperty(i),a=t.hasOwnProperty(i);if(l&&!a||!l&&a||!ds(n[i],t[i]))return!1}}return String(n)===String(t)}function Gl(n,t){return n.findIndex(e=>ds(e,t))}const Rd=n=>!!(n&&n.__v_isRef===!0),Oe=n=>Je(n)?n:n==null?"":me(n)||Fe(n)&&(n.toString===Pd||!ke(n.toString))?Rd(n)?Oe(n.value):JSON.stringify(n,Ad,2):String(n),Ad=(n,t)=>Rd(t)?Ad(n,t.value):Qn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[o,s],r)=>(e[Er(o,r)+" =>"]=s,e),{})}:go(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Er(e))}:Ht(t)?Er(t):Fe(t)&&!me(t)&&!Od(t)?String(t):t,Er=(n,t="")=>{var e;return Ht(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ct;class mh{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ct,!t&&Ct&&(this.index=(Ct.scopes||(Ct.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Ct;try{return Ct=this,t()}finally{Ct=e}}}on(){Ct=this}off(){Ct=this.parent}stop(t){if(this._active){this._active=!1;let e,o;for(e=0,o=this.effects.length;e<o;e++)this.effects[e].stop();for(this.effects.length=0,e=0,o=this.cleanups.length;e<o;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,o=this.scopes.length;e<o;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function bh(){return Ct}let qe;const Lr=new WeakSet;class Id{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ct&&Ct.active&&Ct.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lr.has(this)&&(Lr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Dd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Ka(this),Bd(this);const t=qe,e=Lt;qe=this,Lt=!0;try{return this.fn()}finally{Ed(this),qe=t,Lt=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Zl(t);this.deps=this.depsTail=void 0,Ka(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){bl(this)&&this.run()}get dirty(){return bl(this)}}let Md=0,Fo,Uo;function Dd(n,t=!1){if(n.flags|=8,t){n.next=Uo,Uo=n;return}n.next=Fo,Fo=n}function Kl(){Md++}function Jl(){if(--Md>0)return;if(Uo){let t=Uo;for(Uo=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let n;for(;Fo;){let t=Fo;for(Fo=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(o){n||(n=o)}t=e}}if(n)throw n}function Bd(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ed(n){let t,e=n.depsTail,o=e;for(;o;){const s=o.prevDep;o.version===-1?(o===e&&(e=s),Zl(o),yh(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=s}n.deps=t,n.depsTail=e}function bl(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ld(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function Ld(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===ts))return;n.globalVersion=ts;const t=n.dep;if(n.flags|=2,t.version>0&&!n.isSSR&&n.deps&&!bl(n)){n.flags&=-3;return}const e=qe,o=Lt;qe=n,Lt=!0;try{Bd(n);const s=n.fn(n._value);(t.version===0||bt(s,n._value))&&(n._value=s,t.version++)}catch(s){throw t.version++,s}finally{qe=e,Lt=o,Ed(n),n.flags&=-3}}function Zl(n,t=!1){const{dep:e,prevSub:o,nextSub:s}=n;if(o&&(o.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=o,n.nextSub=void 0),e.subs===n&&(e.subs=o,!o&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Zl(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function yh(n){const{prevDep:t,nextDep:e}=n;t&&(t.nextDep=e,n.prevDep=void 0),e&&(e.prevDep=t,n.nextDep=void 0)}let Lt=!0;const Nd=[];function _n(){Nd.push(Lt),Lt=!1}function xn(){const n=Nd.pop();Lt=n===void 0?!0:n}function Ka(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const e=qe;qe=void 0;try{t()}finally{qe=e}}}let ts=0;class wh{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class mr{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!qe||!Lt||qe===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==qe)e=this.activeLink=new wh(qe,this),qe.deps?(e.prevDep=qe.depsTail,qe.depsTail.nextDep=e,qe.depsTail=e):qe.deps=qe.depsTail=e,Hd(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const o=e.nextDep;o.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=o),e.prevDep=qe.depsTail,e.nextDep=void 0,qe.depsTail.nextDep=e,qe.depsTail=e,qe.deps===e&&(qe.deps=o)}return e}trigger(t){this.version++,ts++,this.notify(t)}notify(t){Kl();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Jl()}}}function Hd(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let o=t.deps;o;o=o.nextDep)Hd(o)}const e=n.dep.subs;e!==n&&(n.prevSub=e,e&&(e.nextSub=n)),n.dep.subs=n}}const yl=new WeakMap,Mn=Symbol(""),wl=Symbol(""),ns=Symbol("");function dt(n,t,e){if(Lt&&qe){let o=yl.get(n);o||yl.set(n,o=new Map);let s=o.get(e);s||(o.set(e,s=new mr),s.map=o,s.key=e),s.track()}}function tn(n,t,e,o,s,r){const i=yl.get(n);if(!i){ts++;return}const l=a=>{a&&a.trigger()};if(Kl(),t==="clear")i.forEach(l);else{const a=me(n),u=a&&Yl(e);if(a&&e==="length"){const c=Number(o);i.forEach((f,m)=>{(m==="length"||m===ns||!Ht(m)&&m>=c)&&l(f)})}else switch((e!==void 0||i.has(void 0))&&l(i.get(e)),u&&l(i.get(ns)),t){case"add":a?u&&l(i.get("length")):(l(i.get(Mn)),Qn(n)&&l(i.get(wl)));break;case"delete":a||(l(i.get(Mn)),Qn(n)&&l(i.get(wl)));break;case"set":Qn(n)&&l(i.get(Mn));break}}Jl()}function Fn(n){const t=Me(n);return t===n?t:(dt(t,"iterate",ns),Mt(n)?t:t.map(ft))}function br(n){return dt(n=Me(n),"iterate",ns),n}const kh={__proto__:null,[Symbol.iterator](){return Nr(this,Symbol.iterator,ft)},concat(...n){return Fn(this).concat(...n.map(t=>me(t)?Fn(t):t))},entries(){return Nr(this,"entries",n=>(n[1]=ft(n[1]),n))},every(n,t){return Qt(this,"every",n,t,void 0,arguments)},filter(n,t){return Qt(this,"filter",n,t,e=>e.map(ft),arguments)},find(n,t){return Qt(this,"find",n,t,ft,arguments)},findIndex(n,t){return Qt(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return Qt(this,"findLast",n,t,ft,arguments)},findLastIndex(n,t){return Qt(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return Qt(this,"forEach",n,t,void 0,arguments)},includes(...n){return Hr(this,"includes",n)},indexOf(...n){return Hr(this,"indexOf",n)},join(n){return Fn(this).join(n)},lastIndexOf(...n){return Hr(this,"lastIndexOf",n)},map(n,t){return Qt(this,"map",n,t,void 0,arguments)},pop(){return xo(this,"pop")},push(...n){return xo(this,"push",n)},reduce(n,...t){return Ja(this,"reduce",n,t)},reduceRight(n,...t){return Ja(this,"reduceRight",n,t)},shift(){return xo(this,"shift")},some(n,t){return Qt(this,"some",n,t,void 0,arguments)},splice(...n){return xo(this,"splice",n)},toReversed(){return Fn(this).toReversed()},toSorted(n){return Fn(this).toSorted(n)},toSpliced(...n){return Fn(this).toSpliced(...n)},unshift(...n){return xo(this,"unshift",n)},values(){return Nr(this,"values",ft)}};function Nr(n,t,e){const o=br(n),s=o[t]();return o!==n&&!Mt(n)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=e(r.value)),r}),s}const Ch=Array.prototype;function Qt(n,t,e,o,s,r){const i=br(n),l=i!==n&&!Mt(n),a=i[t];if(a!==Ch[t]){const f=a.apply(n,r);return l?ft(f):f}let u=e;i!==n&&(l?u=function(f,m){return e.call(this,ft(f),m,n)}:e.length>2&&(u=function(f,m){return e.call(this,f,m,n)}));const c=a.call(i,u,o);return l&&s?s(c):c}function Ja(n,t,e,o){const s=br(n);let r=e;return s!==n&&(Mt(n)?e.length>3&&(r=function(i,l,a){return e.call(this,i,l,a,n)}):r=function(i,l,a){return e.call(this,i,ft(l),a,n)}),s[t](r,...o)}function Hr(n,t,e){const o=Me(n);dt(o,"iterate",ns);const s=o[t](...e);return(s===-1||s===!1)&&ta(e[0])?(e[0]=Me(e[0]),o[t](...e)):s}function xo(n,t,e=[]){_n(),Kl();const o=Me(n)[t].apply(n,e);return Jl(),xn(),o}const _h=ql("__proto__,__v_isRef,__isVue"),Wd=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ht));function xh(n){Ht(n)||(n=String(n));const t=Me(this);return dt(t,"has",n),t.hasOwnProperty(n)}class Vd{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,o){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return o===(s?r?Mh:zd:r?qd:Ud).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(o)?t:void 0;const i=me(t);if(!s){let a;if(i&&(a=kh[e]))return a;if(e==="hasOwnProperty")return xh}const l=Reflect.get(t,e,ge(t)?t:o);return(Ht(e)?Wd.has(e):_h(e))||(s||dt(t,"get",e),r)?l:ge(l)?i&&Yl(e)?l:l.value:Fe(l)?s?Xd(l):Jt(l):l}}class Fd extends Vd{constructor(t=!1){super(!1,t)}set(t,e,o,s){let r=t[e];if(!this._isShallow){const a=ln(r);if(!Mt(o)&&!ln(o)&&(r=Me(r),o=Me(o)),!me(t)&&ge(r)&&!ge(o))return a?!1:(r.value=o,!0)}const i=me(t)&&Yl(e)?Number(e)<t.length:Ee(t,e),l=Reflect.set(t,e,o,ge(t)?t:s);return t===Me(s)&&(i?bt(o,r)&&tn(t,"set",e,o):tn(t,"add",e,o)),l}deleteProperty(t,e){const o=Ee(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&o&&tn(t,"delete",e,void 0),s}has(t,e){const o=Reflect.has(t,e);return(!Ht(e)||!Wd.has(e))&&dt(t,"has",e),o}ownKeys(t){return dt(t,"iterate",me(t)?"length":Mn),Reflect.ownKeys(t)}}class Sh extends Vd{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const Ph=new Fd,Oh=new Sh,Th=new Fd(!0);const kl=n=>n,ws=n=>Reflect.getPrototypeOf(n);function $h(n,t,e){return function(...o){const s=this.__v_raw,r=Me(s),i=Qn(r),l=n==="entries"||n===Symbol.iterator&&i,a=n==="keys"&&i,u=s[n](...o),c=e?kl:t?Cl:ft;return!t&&dt(r,"iterate",a?wl:Mn),{next(){const{value:f,done:m}=u.next();return m?{value:f,done:m}:{value:l?[c(f[0]),c(f[1])]:c(f),done:m}},[Symbol.iterator](){return this}}}}function ks(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function jh(n,t){const e={get(s){const r=this.__v_raw,i=Me(r),l=Me(s);n||(bt(s,l)&&dt(i,"get",s),dt(i,"get",l));const{has:a}=ws(i),u=t?kl:n?Cl:ft;if(a.call(i,s))return u(r.get(s));if(a.call(i,l))return u(r.get(l));r!==i&&r.get(s)},get size(){const s=this.__v_raw;return!n&&dt(Me(s),"iterate",Mn),Reflect.get(s,"size",s)},has(s){const r=this.__v_raw,i=Me(r),l=Me(s);return n||(bt(s,l)&&dt(i,"has",s),dt(i,"has",l)),s===l?r.has(s):r.has(s)||r.has(l)},forEach(s,r){const i=this,l=i.__v_raw,a=Me(l),u=t?kl:n?Cl:ft;return!n&&dt(a,"iterate",Mn),l.forEach((c,f)=>s.call(r,u(c),u(f),i))}};return ot(e,n?{add:ks("add"),set:ks("set"),delete:ks("delete"),clear:ks("clear")}:{add(s){!t&&!Mt(s)&&!ln(s)&&(s=Me(s));const r=Me(this);return ws(r).has.call(r,s)||(r.add(s),tn(r,"add",s,s)),this},set(s,r){!t&&!Mt(r)&&!ln(r)&&(r=Me(r));const i=Me(this),{has:l,get:a}=ws(i);let u=l.call(i,s);u||(s=Me(s),u=l.call(i,s));const c=a.call(i,s);return i.set(s,r),u?bt(r,c)&&tn(i,"set",s,r):tn(i,"add",s,r),this},delete(s){const r=Me(this),{has:i,get:l}=ws(r);let a=i.call(r,s);a||(s=Me(s),a=i.call(r,s)),l&&l.call(r,s);const u=r.delete(s);return a&&tn(r,"delete",s,void 0),u},clear(){const s=Me(this),r=s.size!==0,i=s.clear();return r&&tn(s,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=$h(s,n,t)}),e}function Ql(n,t){const e=jh(n,t);return(o,s,r)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?o:Reflect.get(Ee(e,s)&&s in o?e:o,s,r)}const Rh={get:Ql(!1,!1)},Ah={get:Ql(!1,!0)},Ih={get:Ql(!0,!1)};const Ud=new WeakMap,qd=new WeakMap,zd=new WeakMap,Mh=new WeakMap;function Dh(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Bh(n){return n.__v_skip||!Object.isExtensible(n)?0:Dh(ih(n))}function Jt(n){return ln(n)?n:ea(n,!1,Ph,Rh,Ud)}function Eh(n){return ea(n,!1,Th,Ah,qd)}function Xd(n){return ea(n,!0,Oh,Ih,zd)}function ea(n,t,e,o,s){if(!Fe(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const r=s.get(n);if(r)return r;const i=Bh(n);if(i===0)return n;const l=new Proxy(n,i===2?o:e);return s.set(n,l),l}function to(n){return ln(n)?to(n.__v_raw):!!(n&&n.__v_isReactive)}function ln(n){return!!(n&&n.__v_isReadonly)}function Mt(n){return!!(n&&n.__v_isShallow)}function ta(n){return n?!!n.__v_raw:!1}function Me(n){const t=n&&n.__v_raw;return t?Me(t):n}function yt(n){return!Ee(n,"__v_skip")&&Object.isExtensible(n)&&$d(n,"__v_skip",!0),n}const ft=n=>Fe(n)?Jt(n):n,Cl=n=>Fe(n)?Xd(n):n;function ge(n){return n?n.__v_isRef===!0:!1}function I(n){return Yd(n,!1)}function Lh(n){return Yd(n,!0)}function Yd(n,t){return ge(n)?n:new Nh(n,t)}class Nh{constructor(t,e){this.dep=new mr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Me(t),this._value=e?t:ft(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,o=this.__v_isShallow||Mt(t)||ln(t);t=o?t:Me(t),bt(t,e)&&(this._rawValue=t,this._value=o?t:ft(t),this.dep.trigger())}}function J(n){return ge(n)?n.value:n}const Hh={get:(n,t,e)=>t==="__v_raw"?n:J(Reflect.get(n,t,e)),set:(n,t,e,o)=>{const s=n[t];return ge(s)&&!ge(e)?(s.value=e,!0):Reflect.set(n,t,e,o)}};function Gd(n){return to(n)?n:new Proxy(n,Hh)}class Wh{constructor(t){this.__v_isRef=!0,this._value=void 0;const e=this.dep=new mr,{get:o,set:s}=t(e.track.bind(e),e.trigger.bind(e));this._get=o,this._set=s}get value(){return this._value=this._get()}set value(t){this._set(t)}}function Vh(n){return new Wh(n)}class Fh{constructor(t,e,o){this.fn=t,this.setter=e,this._value=void 0,this.dep=new mr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ts-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=o}notify(){if(this.flags|=16,!(this.flags&8)&&qe!==this)return Dd(this,!0),!0}get value(){const t=this.dep.track();return Ld(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Uh(n,t,e=!1){let o,s;return ke(n)?o=n:(o=n.get,s=n.set),new Fh(o,s,e)}const Cs={},Vs=new WeakMap;let Rn;function qh(n,t=!1,e=Rn){if(e){let o=Vs.get(e);o||Vs.set(e,o=[]),o.push(n)}}function zh(n,t,e=Ie){const{immediate:o,deep:s,once:r,scheduler:i,augmentJob:l,call:a}=e,u=p=>s?p:Mt(p)||s===!1||s===0?nn(p,1):nn(p);let c,f,m,b,_=!1,y=!1;if(ge(n)?(f=()=>n.value,_=Mt(n)):to(n)?(f=()=>u(n),_=!0):me(n)?(y=!0,_=n.some(p=>to(p)||Mt(p)),f=()=>n.map(p=>{if(ge(p))return p.value;if(to(p))return u(p);if(ke(p))return a?a(p,2):p()})):ke(n)?t?f=a?()=>a(n,2):n:f=()=>{if(m){_n();try{m()}finally{xn()}}const p=Rn;Rn=c;try{return a?a(n,3,[b]):n(b)}finally{Rn=p}}:f=Gt,t&&s){const p=f,P=s===!0?1/0:s;f=()=>nn(p(),P)}const w=bh(),k=()=>{c.stop(),w&&w.active&&Xl(w.effects,c)};if(r&&t){const p=t;t=(...P)=>{p(...P),k()}}let h=y?new Array(n.length).fill(Cs):Cs;const v=p=>{if(!(!(c.flags&1)||!c.dirty&&!p))if(t){const P=c.run();if(s||_||(y?P.some((D,M)=>bt(D,h[M])):bt(P,h))){m&&m();const D=Rn;Rn=c;try{const M=[P,h===Cs?void 0:y&&h[0]===Cs?[]:h,b];a?a(t,3,M):t(...M),h=P}finally{Rn=D}}}else c.run()};return l&&l(v),c=new Id(f),c.scheduler=i?()=>i(v,!1):v,b=p=>qh(p,!1,c),m=c.onStop=()=>{const p=Vs.get(c);if(p){if(a)a(p,4);else for(const P of p)P();Vs.delete(c)}},t?o?v(!0):h=c.run():i?i(v.bind(null,!0),!0):c.run(),k.pause=c.pause.bind(c),k.resume=c.resume.bind(c),k.stop=k,k}function nn(n,t=1/0,e){if(t<=0||!Fe(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,ge(n))nn(n.value,t,e);else if(me(n))for(let o=0;o<n.length;o++)nn(n[o],t,e);else if(go(n)||Qn(n))n.forEach(o=>{nn(o,t,e)});else if(Od(n)){for(const o in n)nn(n[o],t,e);for(const o of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,o)&&nn(n[o],t,e)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fs(n,t,e,o){try{return o?n(...o):n()}catch(s){ps(s,t,e)}}function Wt(n,t,e,o){if(ke(n)){const s=fs(n,t,e,o);return s&&Sd(s)&&s.catch(r=>{ps(r,t,e)}),s}if(me(n)){const s=[];for(let r=0;r<n.length;r++)s.push(Wt(n[r],t,e,o));return s}}function ps(n,t,e,o=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:i}=t&&t.appContext.config||Ie;if(t){let l=t.parent;const a=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${e}`;for(;l;){const c=l.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](n,a,u)===!1)return}l=l.parent}if(r){_n(),fs(r,null,10,[n,a,u]),xn();return}}Xh(n,e,s,o,i)}function Xh(n,t,e,o=!0,s=!1){if(s)throw n;console.error(n)}const gt=[];let qt=-1;const no=[];let vn=null,zn=0;const Kd=Promise.resolve();let Fs=null;function yn(n){const t=Fs||Kd;return n?t.then(this?n.bind(this):n):t}function Yh(n){let t=qt+1,e=gt.length;for(;t<e;){const o=t+e>>>1,s=gt[o],r=os(s);r<n||r===n&&s.flags&2?t=o+1:e=o}return t}function na(n){if(!(n.flags&1)){const t=os(n),e=gt[gt.length-1];!e||!(n.flags&2)&&t>=os(e)?gt.push(n):gt.splice(Yh(t),0,n),n.flags|=1,Jd()}}function Jd(){Fs||(Fs=Kd.then(Qd))}function Gh(n){me(n)?no.push(...n):vn&&n.id===-1?vn.splice(zn+1,0,n):n.flags&1||(no.push(n),n.flags|=1),Jd()}function Za(n,t,e=qt+1){for(;e<gt.length;e++){const o=gt[e];if(o&&o.flags&2){if(n&&o.id!==n.uid)continue;gt.splice(e,1),e--,o.flags&4&&(o.flags&=-2),o(),o.flags&4||(o.flags&=-2)}}}function Zd(n){if(no.length){const t=[...new Set(no)].sort((e,o)=>os(e)-os(o));if(no.length=0,vn){vn.push(...t);return}for(vn=t,zn=0;zn<vn.length;zn++){const e=vn[zn];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}vn=null,zn=0}}const os=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Qd(n){try{for(qt=0;qt<gt.length;qt++){const t=gt[qt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),fs(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;qt<gt.length;qt++){const t=gt[qt];t&&(t.flags&=-2)}qt=-1,gt.length=0,Zd(),Fs=null,(gt.length||no.length)&&Qd()}}let ut=null,ef=null;function Us(n){const t=ut;return ut=n,ef=n&&n.type.__scopeId||null,t}function ne(n,t=ut,e){if(!t||n._n)return n;const o=(...s)=>{o._d&&cu(-1);const r=Us(t);let i;try{i=n(...s)}finally{Us(r),o._d&&cu(1)}return i};return o._n=!0,o._c=!0,o._d=!0,o}function Pe(n,t){if(ut===null)return n;const e=_r(ut),o=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[r,i,l,a=Ie]=t[s];r&&(ke(r)&&(r={mounted:r,updated:r}),r.deep&&nn(i),o.push({dir:r,instance:e,value:i,oldValue:void 0,arg:l,modifiers:a}))}return n}function On(n,t,e,o){const s=n.dirs,r=t&&t.dirs;for(let i=0;i<s.length;i++){const l=s[i];r&&(l.oldValue=r[i].value);let a=l.dir[o];a&&(_n(),Wt(a,e,8,[n.el,l,n,t]),xn())}}const tf=Symbol("_vte"),Kh=n=>n.__isTeleport,qo=n=>n&&(n.disabled||n.disabled===""),Qa=n=>n&&(n.defer||n.defer===""),eu=n=>typeof SVGElement<"u"&&n instanceof SVGElement,tu=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,_l=(n,t)=>{const e=n&&n.to;return Je(e)?t?t(e):null:e},nf={name:"Teleport",__isTeleport:!0,process(n,t,e,o,s,r,i,l,a,u){const{mc:c,pc:f,pbc:m,o:{insert:b,querySelector:_,createText:y,createComment:w}}=u,k=qo(t.props);let{shapeFlag:h,children:v,dynamicChildren:p}=t;if(n==null){const P=t.el=y(""),D=t.anchor=y("");b(P,e,o),b(D,e,o);const M=(O,j)=>{h&16&&(s&&s.isCE&&(s.ce._teleportTarget=O),c(v,O,j,s,r,i,l,a))},g=()=>{const O=t.target=_l(t.props,_),j=of(O,t,y,b);O&&(i!=="svg"&&eu(O)?i="svg":i!=="mathml"&&tu(O)&&(i="mathml"),k||(M(O,j),$s(t,!1)))};k&&(M(e,D),$s(t,!0)),Qa(t.props)?rt(()=>{g(),t.el.__isMounted=!0},r):g()}else{if(Qa(t.props)&&!n.el.__isMounted){rt(()=>{nf.process(n,t,e,o,s,r,i,l,a,u),delete n.el.__isMounted},r);return}t.el=n.el,t.targetStart=n.targetStart;const P=t.anchor=n.anchor,D=t.target=n.target,M=t.targetAnchor=n.targetAnchor,g=qo(n.props),O=g?e:D,j=g?P:M;if(i==="svg"||eu(D)?i="svg":(i==="mathml"||tu(D))&&(i="mathml"),p?(m(n.dynamicChildren,p,O,s,r,i,l),ua(n,t,!0)):a||f(n,t,O,j,s,r,i,l,!1),k)g?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):_s(t,e,P,u,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const F=t.target=_l(t.props,_);F&&_s(t,F,null,u,0)}else g&&_s(t,D,M,u,1);$s(t,k)}},remove(n,t,e,{um:o,o:{remove:s}},r){const{shapeFlag:i,children:l,anchor:a,targetStart:u,targetAnchor:c,target:f,props:m}=n;if(f&&(s(u),s(c)),r&&s(a),i&16){const b=r||!qo(m);for(let _=0;_<l.length;_++){const y=l[_];o(y,t,e,b,!!y.dynamicChildren)}}},move:_s,hydrate:Jh};function _s(n,t,e,{o:{insert:o},m:s},r=2){r===0&&o(n.targetAnchor,t,e);const{el:i,anchor:l,shapeFlag:a,children:u,props:c}=n,f=r===2;if(f&&o(i,t,e),(!f||qo(c))&&a&16)for(let m=0;m<u.length;m++)s(u[m],t,e,2);f&&o(l,t,e)}function Jh(n,t,e,o,s,r,{o:{nextSibling:i,parentNode:l,querySelector:a,insert:u,createText:c}},f){const m=t.target=_l(t.props,a);if(m){const b=qo(t.props),_=m._lpa||m.firstChild;if(t.shapeFlag&16)if(b)t.anchor=f(i(n),t,l(n),e,o,s,r),t.targetStart=_,t.targetAnchor=_&&i(_);else{t.anchor=i(n);let y=_;for(;y;){if(y&&y.nodeType===8){if(y.data==="teleport start anchor")t.targetStart=y;else if(y.data==="teleport anchor"){t.targetAnchor=y,m._lpa=t.targetAnchor&&i(t.targetAnchor);break}}y=i(y)}t.targetAnchor||of(m,t,c,u),f(_&&i(_),t,m,e,o,s,r)}$s(t,b)}return t.anchor&&i(t.anchor)}const oa=nf;function $s(n,t){const e=n.ctx;if(e&&e.ut){let o,s;for(t?(o=n.el,s=n.anchor):(o=n.targetStart,s=n.targetAnchor);o&&o!==s;)o.nodeType===1&&o.setAttribute("data-v-owner",e.uid),o=o.nextSibling;e.ut()}}function of(n,t,e,o){const s=t.targetStart=e(""),r=t.targetAnchor=e("");return s[tf]=r,n&&(o(s,n),o(r,n)),r}const Un=Symbol("_leaveCb"),xs=Symbol("_enterCb");function Zh(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Vt(()=>{n.isMounted=!0}),la(()=>{n.isUnmounting=!0}),n}const $t=[Function,Array],Qh={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$t,onEnter:$t,onAfterEnter:$t,onEnterCancelled:$t,onBeforeLeave:$t,onLeave:$t,onAfterLeave:$t,onLeaveCancelled:$t,onBeforeAppear:$t,onAppear:$t,onAfterAppear:$t,onAppearCancelled:$t};function ev(n,t){const{leavingVNodes:e}=n;let o=e.get(t.type);return o||(o=Object.create(null),e.set(t.type,o)),o}function xl(n,t,e,o,s){const{appear:r,mode:i,persisted:l=!1,onBeforeEnter:a,onEnter:u,onAfterEnter:c,onEnterCancelled:f,onBeforeLeave:m,onLeave:b,onAfterLeave:_,onLeaveCancelled:y,onBeforeAppear:w,onAppear:k,onAfterAppear:h,onAppearCancelled:v}=t,p=String(n.key),P=ev(e,n),D=(O,j)=>{O&&Wt(O,o,9,j)},M=(O,j)=>{const F=j[1];D(O,j),me(O)?O.every(N=>N.length<=1)&&F():O.length<=1&&F()},g={mode:i,persisted:l,beforeEnter(O){let j=a;if(!e.isMounted)if(r)j=w||a;else return;O[Un]&&O[Un](!0);const F=P[p];F&&An(n,F)&&F.el[Un]&&F.el[Un](),D(j,[O])},enter(O){let j=u,F=c,N=f;if(!e.isMounted)if(r)j=k||u,F=h||c,N=v||f;else return;let E=!1;const se=O[xs]=X=>{E||(E=!0,X?D(N,[O]):D(F,[O]),g.delayedLeave&&g.delayedLeave(),O[xs]=void 0)};j?M(j,[O,se]):se()},leave(O,j){const F=String(n.key);if(O[xs]&&O[xs](!0),e.isUnmounting)return j();D(m,[O]);let N=!1;const E=O[Un]=se=>{N||(N=!0,j(),se?D(y,[O]):D(_,[O]),O[Un]=void 0,P[F]===n&&delete P[F])};P[F]=n,b?M(b,[O,E]):E()},clone(O){return xl(O,t,e,o)}};return g}function ro(n,t){n.shapeFlag&6&&n.component?(n.transition=t,ro(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function sf(n,t=!1,e){let o=[],s=0;for(let r=0;r<n.length;r++){let i=n[r];const l=e==null?i.key:String(e)+String(i.key!=null?i.key:r);i.type===ue?(i.patchFlag&128&&s++,o=o.concat(sf(i.children,t,l))):(t||i.type!==Zt)&&o.push(l!=null?Cn(i,{key:l}):i)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}/*! #__NO_SIDE_EFFECTS__ */function xe(n,t){return ke(n)?ot({name:n.name},t,{setup:n}):n}function sa(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function tv(n){const t=Cr(),e=Lh(null);if(t){const s=t.refs===Ie?t.refs={}:t.refs;Object.defineProperty(s,n,{enumerable:!0,get:()=>e.value,set:r=>e.value=r})}return e}function qs(n,t,e,o,s=!1){if(me(n)){n.forEach((_,y)=>qs(_,t&&(me(t)?t[y]:t),e,o,s));return}if(Dn(o)&&!s){o.shapeFlag&512&&o.type.__asyncResolved&&o.component.subTree.component&&qs(n,t,e,o.component.subTree);return}const r=o.shapeFlag&4?_r(o.component):o.el,i=s?null:r,{i:l,r:a}=n,u=t&&t.r,c=l.refs===Ie?l.refs={}:l.refs,f=l.setupState,m=Me(f),b=f===Ie?()=>!1:_=>Ee(m,_);if(u!=null&&u!==a&&(Je(u)?(c[u]=null,b(u)&&(f[u]=null)):ge(u)&&(u.value=null)),ke(a))fs(a,l,12,[i,c]);else{const _=Je(a),y=ge(a);if(_||y){const w=()=>{if(n.f){const k=_?b(a)?f[a]:c[a]:a.value;s?me(k)&&Xl(k,r):me(k)?k.includes(r)||k.push(r):_?(c[a]=[r],b(a)&&(f[a]=c[a])):(a.value=[r],n.k&&(c[n.k]=a.value))}else _?(c[a]=i,b(a)&&(f[a]=i)):y&&(a.value=i,n.k&&(c[n.k]=i))};i?(w.id=-1,rt(w,e)):w()}}}const nu=n=>n.nodeType===8;gr().requestIdleCallback;gr().cancelIdleCallback;function nv(n,t){if(nu(n)&&n.data==="["){let e=1,o=n.nextSibling;for(;o;){if(o.nodeType===1){if(t(o)===!1)break}else if(nu(o))if(o.data==="]"){if(--e===0)break}else o.data==="["&&e++;o=o.nextSibling}}else t(n)}const Dn=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function ou(n){ke(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:o,delay:s=200,hydrate:r,timeout:i,suspensible:l=!0,onError:a}=n;let u=null,c,f=0;const m=()=>(f++,u=null,b()),b=()=>{let _;return u||(_=u=t().catch(y=>{if(y=y instanceof Error?y:new Error(String(y)),a)return new Promise((w,k)=>{a(y,()=>w(m()),()=>k(y),f+1)});throw y}).then(y=>_!==u&&u?u:(y&&(y.__esModule||y[Symbol.toStringTag]==="Module")&&(y=y.default),c=y,y)))};return xe({name:"AsyncComponentWrapper",__asyncLoader:b,__asyncHydrate(_,y,w){const k=r?()=>{const h=r(w,v=>nv(_,v));h&&(y.bum||(y.bum=[])).push(h)}:w;c?k():b().then(()=>!y.isUnmounted&&k())},get __asyncResolved(){return c},setup(){const _=at;if(sa(_),c)return()=>Wr(c,_);const y=v=>{u=null,ps(v,_,13,!o)};if(l&&_.suspense||lo)return b().then(v=>()=>Wr(v,_)).catch(v=>(y(v),()=>o?z(o,{error:v}):null));const w=I(!1),k=I(),h=I(!!s);return s&&setTimeout(()=>{h.value=!1},s),i!=null&&setTimeout(()=>{if(!w.value&&!k.value){const v=new Error(`Async component timed out after ${i}ms.`);y(v),k.value=v}},i),b().then(()=>{w.value=!0,_.parent&&ra(_.parent.vnode)&&_.parent.update()}).catch(v=>{y(v),k.value=v}),()=>{if(w.value&&c)return Wr(c,_);if(k.value&&o)return z(o,{error:k.value});if(e&&!h.value)return z(e)}}})}function Wr(n,t){const{ref:e,props:o,children:s,ce:r}=t.vnode,i=z(n,o,s);return i.ref=e,i.ce=r,delete t.vnode.ce,i}const ra=n=>n.type.__isKeepAlive,ov={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:t}){const e=Cr(),o=e.ctx;if(!o.renderer)return()=>{const h=t.default&&t.default();return h&&h.length===1?h[0]:h};const s=new Map,r=new Set;let i=null;const l=e.suspense,{renderer:{p:a,m:u,um:c,o:{createElement:f}}}=o,m=f("div");o.activate=(h,v,p,P,D)=>{const M=h.component;u(h,v,p,0,l),a(M.vnode,h,v,p,M,l,P,h.slotScopeIds,D),rt(()=>{M.isDeactivated=!1,M.a&&eo(M.a);const g=h.props&&h.props.onVnodeMounted;g&&jt(g,M.parent,h)},l)},o.deactivate=h=>{const v=h.component;Ys(v.m),Ys(v.a),u(h,m,null,1,l),rt(()=>{v.da&&eo(v.da);const p=h.props&&h.props.onVnodeUnmounted;p&&jt(p,v.parent,h),v.isDeactivated=!0},l)};function b(h){Vr(h),c(h,e,l,!0)}function _(h){s.forEach((v,p)=>{const P=pu(v.type);P&&!h(P)&&y(p)})}function y(h){const v=s.get(h);v&&(!i||!An(v,i))?b(v):i&&Vr(i),s.delete(h),r.delete(h)}Xe(()=>[n.include,n.exclude],([h,v])=>{h&&_(p=>Do(h,p)),v&&_(p=>!Do(v,p))},{flush:"post",deep:!0});let w=null;const k=()=>{w!=null&&(Gs(e.subTree.type)?rt(()=>{s.set(w,Ss(e.subTree))},e.subTree.suspense):s.set(w,Ss(e.subTree)))};return Vt(k),ia(k),la(()=>{s.forEach(h=>{const{subTree:v,suspense:p}=e,P=Ss(v);if(h.type===P.type&&h.key===P.key){Vr(P);const D=P.component.da;D&&rt(D,p);return}b(h)})}),()=>{if(w=null,!t.default)return i=null;const h=t.default(),v=h[0];if(h.length>1)return i=null,h;if(!io(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return i=null,v;let p=Ss(v);if(p.type===Zt)return i=null,p;const P=p.type,D=pu(Dn(p)?p.type.__asyncResolved||{}:P),{include:M,exclude:g,max:O}=n;if(M&&(!D||!Do(M,D))||g&&D&&Do(g,D))return p.shapeFlag&=-257,i=p,v;const j=p.key==null?P:p.key,F=s.get(j);return p.el&&(p=Cn(p),v.shapeFlag&128&&(v.ssContent=p)),w=j,F?(p.el=F.el,p.component=F.component,p.transition&&ro(p,p.transition),p.shapeFlag|=512,r.delete(j),r.add(j)):(r.add(j),O&&r.size>parseInt(O,10)&&y(r.values().next().value)),p.shapeFlag|=256,i=p,Gs(v.type)?v:p}}},sv=ov;function Do(n,t){return me(n)?n.some(e=>Do(e,t)):Je(n)?n.split(",").includes(t):rh(n)?(n.lastIndex=0,n.test(t)):!1}function rf(n,t){af(n,"a",t)}function lf(n,t){af(n,"da",t)}function af(n,t,e=at){const o=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(yr(t,o,e),e){let s=e.parent;for(;s&&s.parent;)ra(s.parent.vnode)&&rv(o,t,e,s),s=s.parent}}function rv(n,t,e,o){const s=yr(t,n,o,!0);Sn(()=>{Xl(o[t],s)},e)}function Vr(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Ss(n){return n.shapeFlag&128?n.ssContent:n}function yr(n,t,e=at,o=!1){if(e){const s=e[n]||(e[n]=[]),r=t.__weh||(t.__weh=(...i)=>{_n();const l=vs(e),a=Wt(t,e,n,i);return l(),xn(),a});return o?s.unshift(r):s.push(r),r}}const un=n=>(t,e=at)=>{(!lo||n==="sp")&&yr(n,(...o)=>t(...o),e)},iv=un("bm"),Vt=un("m"),lv=un("bu"),ia=un("u"),la=un("bum"),Sn=un("um"),av=un("sp"),uv=un("rtg"),cv=un("rtc");function dv(n,t=at){yr("ec",n,t)}const fv=Symbol.for("v-ndc");function ze(n,t,e,o){let s;const r=e,i=me(n);if(i||Je(n)){const l=i&&to(n);let a=!1;l&&(a=!Mt(n),n=br(n)),s=new Array(n.length);for(let u=0,c=n.length;u<c;u++)s[u]=t(a?ft(n[u]):n[u],u,void 0,r)}else if(typeof n=="number"){s=new Array(n);for(let l=0;l<n;l++)s[l]=t(l+1,l,void 0,r)}else if(Fe(n))if(n[Symbol.iterator])s=Array.from(n,(l,a)=>t(l,a,void 0,r));else{const l=Object.keys(n);s=new Array(l.length);for(let a=0,u=l.length;a<u;a++){const c=l[a];s[a]=t(n[c],c,a,r)}}else s=[];return s}function Xt(n,t,e={},o,s){if(ut.ce||ut.parent&&Dn(ut.parent)&&ut.parent.ce)return t!=="default"&&(e.name=t),R(),ce(ue,null,[z("slot",e,o)],64);let r=n[t];r&&r._c&&(r._d=!1),R();const i=r&&uf(r(e)),l=e.key||i&&i.key,a=ce(ue,{key:(l&&!Ht(l)?l:`_${t}`)+""},i||[],i&&n._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function uf(n){return n.some(t=>io(t)?!(t.type===Zt||t.type===ue&&!uf(t.children)):!0)?n:null}const Sl=n=>n?$f(n)?_r(n):Sl(n.parent):null,zo=ot(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Sl(n.parent),$root:n=>Sl(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>df(n),$forceUpdate:n=>n.f||(n.f=()=>{na(n.update)}),$nextTick:n=>n.n||(n.n=yn.bind(n.proxy)),$watch:n=>Mv.bind(n)}),Fr=(n,t)=>n!==Ie&&!n.__isScriptSetup&&Ee(n,t),pv={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:o,data:s,props:r,accessCache:i,type:l,appContext:a}=n;let u;if(t[0]!=="$"){const b=i[t];if(b!==void 0)switch(b){case 1:return o[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(Fr(o,t))return i[t]=1,o[t];if(s!==Ie&&Ee(s,t))return i[t]=2,s[t];if((u=n.propsOptions[0])&&Ee(u,t))return i[t]=3,r[t];if(e!==Ie&&Ee(e,t))return i[t]=4,e[t];Pl&&(i[t]=0)}}const c=zo[t];let f,m;if(c)return t==="$attrs"&&dt(n.attrs,"get",""),c(n);if((f=l.__cssModules)&&(f=f[t]))return f;if(e!==Ie&&Ee(e,t))return i[t]=4,e[t];if(m=a.config.globalProperties,Ee(m,t))return m[t]},set({_:n},t,e){const{data:o,setupState:s,ctx:r}=n;return Fr(s,t)?(s[t]=e,!0):o!==Ie&&Ee(o,t)?(o[t]=e,!0):Ee(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(r[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:o,appContext:s,propsOptions:r}},i){let l;return!!e[i]||n!==Ie&&Ee(n,i)||Fr(t,i)||(l=r[0])&&Ee(l,i)||Ee(o,i)||Ee(zo,i)||Ee(s.config.globalProperties,i)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Ee(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}};function zs(n){return me(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}function En(n,t){return!n||!t?n||t:me(n)&&me(t)?n.concat(t):ot({},zs(n),zs(t))}let Pl=!0;function hv(n){const t=df(n),e=n.proxy,o=n.ctx;Pl=!1,t.beforeCreate&&su(t.beforeCreate,n,"bc");const{data:s,computed:r,methods:i,watch:l,provide:a,inject:u,created:c,beforeMount:f,mounted:m,beforeUpdate:b,updated:_,activated:y,deactivated:w,beforeDestroy:k,beforeUnmount:h,destroyed:v,unmounted:p,render:P,renderTracked:D,renderTriggered:M,errorCaptured:g,serverPrefetch:O,expose:j,inheritAttrs:F,components:N,directives:E,filters:se}=t;if(u&&vv(u,o,null),i)for(const A in i){const Y=i[A];ke(Y)&&(o[A]=Y.bind(e))}if(s){const A=s.call(e,e);Fe(A)&&(n.data=Jt(A))}if(Pl=!0,r)for(const A in r){const Y=r[A],He=ke(Y)?Y.bind(e,e):ke(Y.get)?Y.get.bind(e,e):Gt,G=!ke(Y)&&ke(Y.set)?Y.set.bind(e):Gt,le=B({get:He,set:G});Object.defineProperty(o,A,{enumerable:!0,configurable:!0,get:()=>le.value,set:be=>le.value=be})}if(l)for(const A in l)cf(l[A],o,e,A);if(a){const A=ke(a)?a.call(e):a;Reflect.ownKeys(A).forEach(Y=>{pf(Y,A[Y])})}c&&su(c,n,"c");function x(A,Y){me(Y)?Y.forEach(He=>A(He.bind(e))):Y&&A(Y.bind(e))}if(x(iv,f),x(Vt,m),x(lv,b),x(ia,_),x(rf,y),x(lf,w),x(dv,g),x(cv,D),x(uv,M),x(la,h),x(Sn,p),x(av,O),me(j))if(j.length){const A=n.exposed||(n.exposed={});j.forEach(Y=>{Object.defineProperty(A,Y,{get:()=>e[Y],set:He=>e[Y]=He})})}else n.exposed||(n.exposed={});P&&n.render===Gt&&(n.render=P),F!=null&&(n.inheritAttrs=F),N&&(n.components=N),E&&(n.directives=E),O&&sa(n)}function vv(n,t,e=Gt){me(n)&&(n=Ol(n));for(const o in n){const s=n[o];let r;Fe(s)?"default"in s?r=Nt(s.from||o,s.default,!0):r=Nt(s.from||o):r=Nt(s),ge(r)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):t[o]=r}}function su(n,t,e){Wt(me(n)?n.map(o=>o.bind(t.proxy)):n.bind(t.proxy),t,e)}function cf(n,t,e,o){let s=o.includes(".")?xf(e,o):()=>e[o];if(Je(n)){const r=t[n];ke(r)&&Xe(s,r)}else if(ke(n))Xe(s,n.bind(e));else if(Fe(n))if(me(n))n.forEach(r=>cf(r,t,e,o));else{const r=ke(n.handler)?n.handler.bind(e):t[n.handler];ke(r)&&Xe(s,r,n)}}function df(n){const t=n.type,{mixins:e,extends:o}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:i}}=n.appContext,l=r.get(t);let a;return l?a=l:!s.length&&!e&&!o?a=t:(a={},s.length&&s.forEach(u=>Xs(a,u,i,!0)),Xs(a,t,i)),Fe(t)&&r.set(t,a),a}function Xs(n,t,e,o=!1){const{mixins:s,extends:r}=t;r&&Xs(n,r,e,!0),s&&s.forEach(i=>Xs(n,i,e,!0));for(const i in t)if(!(o&&i==="expose")){const l=gv[i]||e&&e[i];n[i]=l?l(n[i],t[i]):t[i]}return n}const gv={data:ru,props:iu,emits:iu,methods:Bo,computed:Bo,beforeCreate:ht,created:ht,beforeMount:ht,mounted:ht,beforeUpdate:ht,updated:ht,beforeDestroy:ht,beforeUnmount:ht,destroyed:ht,unmounted:ht,activated:ht,deactivated:ht,errorCaptured:ht,serverPrefetch:ht,components:Bo,directives:Bo,watch:bv,provide:ru,inject:mv};function ru(n,t){return t?n?function(){return ot(ke(n)?n.call(this,this):n,ke(t)?t.call(this,this):t)}:t:n}function mv(n,t){return Bo(Ol(n),Ol(t))}function Ol(n){if(me(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function ht(n,t){return n?[...new Set([].concat(n,t))]:t}function Bo(n,t){return n?ot(Object.create(null),n,t):t}function iu(n,t){return n?me(n)&&me(t)?[...new Set([...n,...t])]:ot(Object.create(null),zs(n),zs(t??{})):t}function bv(n,t){if(!n)return t;if(!t)return n;const e=ot(Object.create(null),n);for(const o in t)e[o]=ht(n[o],t[o]);return e}function ff(){return{app:null,config:{isNativeTag:oh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yv=0;function wv(n,t){return function(o,s=null){ke(o)||(o=ot({},o)),s!=null&&!Fe(s)&&(s=null);const r=ff(),i=new WeakSet,l=[];let a=!1;const u=r.app={_uid:yv++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:eg,get config(){return r.config},set config(c){},use(c,...f){return i.has(c)||(c&&ke(c.install)?(i.add(c),c.install(u,...f)):ke(c)&&(i.add(c),c(u,...f))),u},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),u},component(c,f){return f?(r.components[c]=f,u):r.components[c]},directive(c,f){return f?(r.directives[c]=f,u):r.directives[c]},mount(c,f,m){if(!a){const b=u._ceVNode||z(o,s);return b.appContext=r,m===!0?m="svg":m===!1&&(m=void 0),n(b,c,m),a=!0,u._container=c,c.__vue_app__=u,_r(b.component)}},onUnmount(c){l.push(c)},unmount(){a&&(Wt(l,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(c,f){return r.provides[c]=f,u},runWithContext(c){const f=oo;oo=u;try{return c()}finally{oo=f}}};return u}}let oo=null;function pf(n,t){if(at){let e=at.provides;const o=at.parent&&at.parent.provides;o===e&&(e=at.provides=Object.create(o)),e[n]=t}}function Nt(n,t,e=!1){const o=at||ut;if(o||oo){const s=oo?oo._context.provides:o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return e&&ke(t)?t.call(o&&o.proxy):t}}const hf={},vf=()=>Object.create(hf),gf=n=>Object.getPrototypeOf(n)===hf;function kv(n,t,e,o=!1){const s={},r=vf();n.propsDefaults=Object.create(null),mf(n,t,s,r);for(const i in n.propsOptions[0])i in s||(s[i]=void 0);e?n.props=o?s:Eh(s):n.type.props?n.props=s:n.props=r,n.attrs=r}function Cv(n,t,e,o){const{props:s,attrs:r,vnode:{patchFlag:i}}=n,l=Me(s),[a]=n.propsOptions;let u=!1;if((o||i>0)&&!(i&16)){if(i&8){const c=n.vnode.dynamicProps;for(let f=0;f<c.length;f++){let m=c[f];if(wr(n.emitsOptions,m))continue;const b=t[m];if(a)if(Ee(r,m))b!==r[m]&&(r[m]=b,u=!0);else{const _=rn(m);s[_]=Tl(a,l,_,b,n,!1)}else b!==r[m]&&(r[m]=b,u=!0)}}}else{mf(n,t,s,r)&&(u=!0);let c;for(const f in l)(!t||!Ee(t,f)&&((c=an(f))===f||!Ee(t,c)))&&(a?e&&(e[f]!==void 0||e[c]!==void 0)&&(s[f]=Tl(a,l,f,void 0,n,!0)):delete s[f]);if(r!==l)for(const f in r)(!t||!Ee(t,f))&&(delete r[f],u=!0)}u&&tn(n.attrs,"set","")}function mf(n,t,e,o){const[s,r]=n.propsOptions;let i=!1,l;if(t)for(let a in t){if(Vo(a))continue;const u=t[a];let c;s&&Ee(s,c=rn(a))?!r||!r.includes(c)?e[c]=u:(l||(l={}))[c]=u:wr(n.emitsOptions,a)||(!(a in o)||u!==o[a])&&(o[a]=u,i=!0)}if(r){const a=Me(e),u=l||Ie;for(let c=0;c<r.length;c++){const f=r[c];e[f]=Tl(s,a,f,u[f],n,!Ee(u,f))}}return i}function Tl(n,t,e,o,s,r){const i=n[e];if(i!=null){const l=Ee(i,"default");if(l&&o===void 0){const a=i.default;if(i.type!==Function&&!i.skipFactory&&ke(a)){const{propsDefaults:u}=s;if(e in u)o=u[e];else{const c=vs(s);o=u[e]=a.call(null,t),c()}}else o=a;s.ce&&s.ce._setProp(e,o)}i[0]&&(r&&!l?o=!1:i[1]&&(o===""||o===an(e))&&(o=!0))}return o}const _v=new WeakMap;function bf(n,t,e=!1){const o=e?_v:t.propsCache,s=o.get(n);if(s)return s;const r=n.props,i={},l=[];let a=!1;if(!ke(n)){const c=f=>{a=!0;const[m,b]=bf(f,t,!0);ot(i,m),b&&l.push(...b)};!e&&t.mixins.length&&t.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!r&&!a)return Fe(n)&&o.set(n,Zn),Zn;if(me(r))for(let c=0;c<r.length;c++){const f=rn(r[c]);lu(f)&&(i[f]=Ie)}else if(r)for(const c in r){const f=rn(c);if(lu(f)){const m=r[c],b=i[f]=me(m)||ke(m)?{type:m}:ot({},m),_=b.type;let y=!1,w=!0;if(me(_))for(let k=0;k<_.length;++k){const h=_[k],v=ke(h)&&h.name;if(v==="Boolean"){y=!0;break}else v==="String"&&(w=!1)}else y=ke(_)&&_.name==="Boolean";b[0]=y,b[1]=w,(y||Ee(b,"default"))&&l.push(f)}}const u=[i,l];return Fe(n)&&o.set(n,u),u}function lu(n){return n[0]!=="$"&&!Vo(n)}const yf=n=>n[0]==="_"||n==="$stable",aa=n=>me(n)?n.map(zt):[zt(n)],xv=(n,t,e)=>{if(t._n)return t;const o=ne((...s)=>aa(t(...s)),e);return o._c=!1,o},wf=(n,t,e)=>{const o=n._ctx;for(const s in n){if(yf(s))continue;const r=n[s];if(ke(r))t[s]=xv(s,r,o);else if(r!=null){const i=aa(r);t[s]=()=>i}}},kf=(n,t)=>{const e=aa(t);n.slots.default=()=>e},Cf=(n,t,e)=>{for(const o in t)(e||o!=="_")&&(n[o]=t[o])},Sv=(n,t,e)=>{const o=n.slots=vf();if(n.vnode.shapeFlag&32){const s=t._;s?(Cf(o,t,e),e&&$d(o,"_",s,!0)):wf(t,o)}else t&&kf(n,t)},Pv=(n,t,e)=>{const{vnode:o,slots:s}=n;let r=!0,i=Ie;if(o.shapeFlag&32){const l=t._;l?e&&l===1?r=!1:Cf(s,t,e):(r=!t.$stable,wf(t,s)),i=t}else t&&(kf(n,t),i={default:1});if(r)for(const l in s)!yf(l)&&i[l]==null&&delete s[l]},rt=Hv;function Ov(n){return Tv(n)}function Tv(n,t){const e=gr();e.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:i,createText:l,createComment:a,setText:u,setElementText:c,parentNode:f,nextSibling:m,setScopeId:b=Gt,insertStaticContent:_}=n,y=(S,T,W,Z=null,K=null,Q=null,L=void 0,$=null,V=!!T.dynamicChildren)=>{if(S===T)return;S&&!An(S,T)&&(Z=oe(S),be(S,K,Q,!0),S=null),T.patchFlag===-2&&(V=!1,T.dynamicChildren=null);const{type:q,ref:re,shapeFlag:ee}=T;switch(q){case kr:w(S,T,W,Z);break;case Zt:k(S,T,W,Z);break;case js:S==null&&h(T,W,Z,L);break;case ue:N(S,T,W,Z,K,Q,L,$,V);break;default:ee&1?P(S,T,W,Z,K,Q,L,$,V):ee&6?E(S,T,W,Z,K,Q,L,$,V):(ee&64||ee&128)&&q.process(S,T,W,Z,K,Q,L,$,V,Se)}re!=null&&K&&qs(re,S&&S.ref,Q,T||S,!T)},w=(S,T,W,Z)=>{if(S==null)o(T.el=l(T.children),W,Z);else{const K=T.el=S.el;T.children!==S.children&&u(K,T.children)}},k=(S,T,W,Z)=>{S==null?o(T.el=a(T.children||""),W,Z):T.el=S.el},h=(S,T,W,Z)=>{[S.el,S.anchor]=_(S.children,T,W,Z,S.el,S.anchor)},v=({el:S,anchor:T},W,Z)=>{let K;for(;S&&S!==T;)K=m(S),o(S,W,Z),S=K;o(T,W,Z)},p=({el:S,anchor:T})=>{let W;for(;S&&S!==T;)W=m(S),s(S),S=W;s(T)},P=(S,T,W,Z,K,Q,L,$,V)=>{T.type==="svg"?L="svg":T.type==="math"&&(L="mathml"),S==null?D(T,W,Z,K,Q,L,$,V):O(S,T,K,Q,L,$,V)},D=(S,T,W,Z,K,Q,L,$)=>{let V,q;const{props:re,shapeFlag:ee,transition:ae,dirs:pe}=S;if(V=S.el=i(S.type,Q,re&&re.is,re),ee&8?c(V,S.children):ee&16&&g(S.children,V,null,Z,K,Ur(S,Q),L,$),pe&&On(S,null,Z,"created"),M(V,S,S.scopeId,L,Z),re){for(const Te in re)Te!=="value"&&!Vo(Te)&&r(V,Te,null,re[Te],Q,Z);"value"in re&&r(V,"value",null,re.value,Q),(q=re.onVnodeBeforeMount)&&jt(q,Z,S)}pe&&On(S,null,Z,"beforeMount");const we=$v(K,ae);we&&ae.beforeEnter(V),o(V,T,W),((q=re&&re.onVnodeMounted)||we||pe)&&rt(()=>{q&&jt(q,Z,S),we&&ae.enter(V),pe&&On(S,null,Z,"mounted")},K)},M=(S,T,W,Z,K)=>{if(W&&b(S,W),Z)for(let Q=0;Q<Z.length;Q++)b(S,Z[Q]);if(K){let Q=K.subTree;if(T===Q||Gs(Q.type)&&(Q.ssContent===T||Q.ssFallback===T)){const L=K.vnode;M(S,L,L.scopeId,L.slotScopeIds,K.parent)}}},g=(S,T,W,Z,K,Q,L,$,V=0)=>{for(let q=V;q<S.length;q++){const re=S[q]=$?gn(S[q]):zt(S[q]);y(null,re,T,W,Z,K,Q,L,$)}},O=(S,T,W,Z,K,Q,L)=>{const $=T.el=S.el;let{patchFlag:V,dynamicChildren:q,dirs:re}=T;V|=S.patchFlag&16;const ee=S.props||Ie,ae=T.props||Ie;let pe;if(W&&Tn(W,!1),(pe=ae.onVnodeBeforeUpdate)&&jt(pe,W,T,S),re&&On(T,S,W,"beforeUpdate"),W&&Tn(W,!0),(ee.innerHTML&&ae.innerHTML==null||ee.textContent&&ae.textContent==null)&&c($,""),q?j(S.dynamicChildren,q,$,W,Z,Ur(T,K),Q):L||Y(S,T,$,null,W,Z,Ur(T,K),Q,!1),V>0){if(V&16)F($,ee,ae,W,K);else if(V&2&&ee.class!==ae.class&&r($,"class",null,ae.class,K),V&4&&r($,"style",ee.style,ae.style,K),V&8){const we=T.dynamicProps;for(let Te=0;Te<we.length;Te++){const _e=we[Te],pt=ee[_e],nt=ae[_e];(nt!==pt||_e==="value")&&r($,_e,pt,nt,K,W)}}V&1&&S.children!==T.children&&c($,T.children)}else!L&&q==null&&F($,ee,ae,W,K);((pe=ae.onVnodeUpdated)||re)&&rt(()=>{pe&&jt(pe,W,T,S),re&&On(T,S,W,"updated")},Z)},j=(S,T,W,Z,K,Q,L)=>{for(let $=0;$<T.length;$++){const V=S[$],q=T[$],re=V.el&&(V.type===ue||!An(V,q)||V.shapeFlag&70)?f(V.el):W;y(V,q,re,null,Z,K,Q,L,!0)}},F=(S,T,W,Z,K)=>{if(T!==W){if(T!==Ie)for(const Q in T)!Vo(Q)&&!(Q in W)&&r(S,Q,T[Q],null,K,Z);for(const Q in W){if(Vo(Q))continue;const L=W[Q],$=T[Q];L!==$&&Q!=="value"&&r(S,Q,$,L,K,Z)}"value"in W&&r(S,"value",T.value,W.value,K)}},N=(S,T,W,Z,K,Q,L,$,V)=>{const q=T.el=S?S.el:l(""),re=T.anchor=S?S.anchor:l("");let{patchFlag:ee,dynamicChildren:ae,slotScopeIds:pe}=T;pe&&($=$?$.concat(pe):pe),S==null?(o(q,W,Z),o(re,W,Z),g(T.children||[],W,re,K,Q,L,$,V)):ee>0&&ee&64&&ae&&S.dynamicChildren?(j(S.dynamicChildren,ae,W,K,Q,L,$),(T.key!=null||K&&T===K.subTree)&&ua(S,T,!0)):Y(S,T,W,re,K,Q,L,$,V)},E=(S,T,W,Z,K,Q,L,$,V)=>{T.slotScopeIds=$,S==null?T.shapeFlag&512?K.ctx.activate(T,W,Z,L,V):se(T,W,Z,K,Q,L,V):X(S,T,V)},se=(S,T,W,Z,K,Q,L)=>{const $=S.component=Yv(S,Z,K);if(ra(S)&&($.ctx.renderer=Se),Gv($,!1,L),$.asyncDep){if(K&&K.registerDep($,x,L),!S.el){const V=$.subTree=z(Zt);k(null,V,T,W)}}else x($,S,T,W,K,Q,L)},X=(S,T,W)=>{const Z=T.component=S.component;if(Lv(S,T,W))if(Z.asyncDep&&!Z.asyncResolved){A(Z,T,W);return}else Z.next=T,Z.update();else T.el=S.el,Z.vnode=T},x=(S,T,W,Z,K,Q,L)=>{const $=()=>{if(S.isMounted){let{next:ee,bu:ae,u:pe,parent:we,vnode:Te}=S;{const mt=_f(S);if(mt){ee&&(ee.el=Te.el,A(S,ee,L)),mt.asyncDep.then(()=>{S.isUnmounted||$()});return}}let _e=ee,pt;Tn(S,!1),ee?(ee.el=Te.el,A(S,ee,L)):ee=Te,ae&&eo(ae),(pt=ee.props&&ee.props.onVnodeBeforeUpdate)&&jt(pt,we,ee,Te),Tn(S,!0);const nt=au(S),Tt=S.subTree;S.subTree=nt,y(Tt,nt,f(Tt.el),oe(Tt),S,K,Q),ee.el=nt.el,_e===null&&Nv(S,nt.el),pe&&rt(pe,K),(pt=ee.props&&ee.props.onVnodeUpdated)&&rt(()=>jt(pt,we,ee,Te),K)}else{let ee;const{el:ae,props:pe}=T,{bm:we,m:Te,parent:_e,root:pt,type:nt}=S,Tt=Dn(T);Tn(S,!1),we&&eo(we),!Tt&&(ee=pe&&pe.onVnodeBeforeMount)&&jt(ee,_e,T),Tn(S,!0);{pt.ce&&pt.ce._injectChildStyle(nt);const mt=S.subTree=au(S);y(null,mt,W,Z,S,K,Q),T.el=mt.el}if(Te&&rt(Te,K),!Tt&&(ee=pe&&pe.onVnodeMounted)){const mt=T;rt(()=>jt(ee,_e,mt),K)}(T.shapeFlag&256||_e&&Dn(_e.vnode)&&_e.vnode.shapeFlag&256)&&S.a&&rt(S.a,K),S.isMounted=!0,T=W=Z=null}};S.scope.on();const V=S.effect=new Id($);S.scope.off();const q=S.update=V.run.bind(V),re=S.job=V.runIfDirty.bind(V);re.i=S,re.id=S.uid,V.scheduler=()=>na(re),Tn(S,!0),q()},A=(S,T,W)=>{T.component=S;const Z=S.vnode.props;S.vnode=T,S.next=null,Cv(S,T.props,Z,W),Pv(S,T.children,W),_n(),Za(S),xn()},Y=(S,T,W,Z,K,Q,L,$,V=!1)=>{const q=S&&S.children,re=S?S.shapeFlag:0,ee=T.children,{patchFlag:ae,shapeFlag:pe}=T;if(ae>0){if(ae&128){G(q,ee,W,Z,K,Q,L,$,V);return}else if(ae&256){He(q,ee,W,Z,K,Q,L,$,V);return}}pe&8?(re&16&&Ue(q,K,Q),ee!==q&&c(W,ee)):re&16?pe&16?G(q,ee,W,Z,K,Q,L,$,V):Ue(q,K,Q,!0):(re&8&&c(W,""),pe&16&&g(ee,W,Z,K,Q,L,$,V))},He=(S,T,W,Z,K,Q,L,$,V)=>{S=S||Zn,T=T||Zn;const q=S.length,re=T.length,ee=Math.min(q,re);let ae;for(ae=0;ae<ee;ae++){const pe=T[ae]=V?gn(T[ae]):zt(T[ae]);y(S[ae],pe,W,null,K,Q,L,$,V)}q>re?Ue(S,K,Q,!0,!1,ee):g(T,W,Z,K,Q,L,$,V,ee)},G=(S,T,W,Z,K,Q,L,$,V)=>{let q=0;const re=T.length;let ee=S.length-1,ae=re-1;for(;q<=ee&&q<=ae;){const pe=S[q],we=T[q]=V?gn(T[q]):zt(T[q]);if(An(pe,we))y(pe,we,W,null,K,Q,L,$,V);else break;q++}for(;q<=ee&&q<=ae;){const pe=S[ee],we=T[ae]=V?gn(T[ae]):zt(T[ae]);if(An(pe,we))y(pe,we,W,null,K,Q,L,$,V);else break;ee--,ae--}if(q>ee){if(q<=ae){const pe=ae+1,we=pe<re?T[pe].el:Z;for(;q<=ae;)y(null,T[q]=V?gn(T[q]):zt(T[q]),W,we,K,Q,L,$,V),q++}}else if(q>ae)for(;q<=ee;)be(S[q],K,Q,!0),q++;else{const pe=q,we=q,Te=new Map;for(q=we;q<=ae;q++){const wt=T[q]=V?gn(T[q]):zt(T[q]);wt.key!=null&&Te.set(wt.key,q)}let _e,pt=0;const nt=ae-we+1;let Tt=!1,mt=0;const _o=new Array(nt);for(q=0;q<nt;q++)_o[q]=0;for(q=pe;q<=ee;q++){const wt=S[q];if(pt>=nt){be(wt,K,Q,!0);continue}let Ft;if(wt.key!=null)Ft=Te.get(wt.key);else for(_e=we;_e<=ae;_e++)if(_o[_e-we]===0&&An(wt,T[_e])){Ft=_e;break}Ft===void 0?be(wt,K,Q,!0):(_o[Ft-we]=q+1,Ft>=mt?mt=Ft:Tt=!0,y(wt,T[Ft],W,null,K,Q,L,$,V),pt++)}const za=Tt?jv(_o):Zn;for(_e=za.length-1,q=nt-1;q>=0;q--){const wt=we+q,Ft=T[wt],Xa=wt+1<re?T[wt+1].el:Z;_o[q]===0?y(null,Ft,W,Xa,K,Q,L,$,V):Tt&&(_e<0||q!==za[_e]?le(Ft,W,Xa,2):_e--)}}},le=(S,T,W,Z,K=null)=>{const{el:Q,type:L,transition:$,children:V,shapeFlag:q}=S;if(q&6){le(S.component.subTree,T,W,Z);return}if(q&128){S.suspense.move(T,W,Z);return}if(q&64){L.move(S,T,W,Se);return}if(L===ue){o(Q,T,W);for(let ee=0;ee<V.length;ee++)le(V[ee],T,W,Z);o(S.anchor,T,W);return}if(L===js){v(S,T,W);return}if(Z!==2&&q&1&&$)if(Z===0)$.beforeEnter(Q),o(Q,T,W),rt(()=>$.enter(Q),K);else{const{leave:ee,delayLeave:ae,afterLeave:pe}=$,we=()=>o(Q,T,W),Te=()=>{ee(Q,()=>{we(),pe&&pe()})};ae?ae(Q,we,Te):Te()}else o(Q,T,W)},be=(S,T,W,Z=!1,K=!1)=>{const{type:Q,props:L,ref:$,children:V,dynamicChildren:q,shapeFlag:re,patchFlag:ee,dirs:ae,cacheIndex:pe}=S;if(ee===-2&&(K=!1),$!=null&&qs($,null,W,S,!0),pe!=null&&(T.renderCache[pe]=void 0),re&256){T.ctx.deactivate(S);return}const we=re&1&&ae,Te=!Dn(S);let _e;if(Te&&(_e=L&&L.onVnodeBeforeUnmount)&&jt(_e,T,S),re&6)tt(S.component,W,Z);else{if(re&128){S.suspense.unmount(W,Z);return}we&&On(S,null,T,"beforeUnmount"),re&64?S.type.remove(S,T,W,Se,Z):q&&!q.hasOnce&&(Q!==ue||ee>0&&ee&64)?Ue(q,T,W,!1,!0):(Q===ue&&ee&384||!K&&re&16)&&Ue(V,T,W),Z&&Re(S)}(Te&&(_e=L&&L.onVnodeUnmounted)||we)&&rt(()=>{_e&&jt(_e,T,S),we&&On(S,null,T,"unmounted")},W)},Re=S=>{const{type:T,el:W,anchor:Z,transition:K}=S;if(T===ue){Ce(W,Z);return}if(T===js){p(S);return}const Q=()=>{s(W),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(S.shapeFlag&1&&K&&!K.persisted){const{leave:L,delayLeave:$}=K,V=()=>L(W,Q);$?$(S.el,Q,V):V()}else Q()},Ce=(S,T)=>{let W;for(;S!==T;)W=m(S),s(S),S=W;s(T)},tt=(S,T,W)=>{const{bum:Z,scope:K,job:Q,subTree:L,um:$,m:V,a:q}=S;Ys(V),Ys(q),Z&&eo(Z),K.stop(),Q&&(Q.flags|=8,be(L,S,T,W)),$&&rt($,T),rt(()=>{S.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&S.asyncDep&&!S.asyncResolved&&S.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Ue=(S,T,W,Z=!1,K=!1,Q=0)=>{for(let L=Q;L<S.length;L++)be(S[L],T,W,Z,K)},oe=S=>{if(S.shapeFlag&6)return oe(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const T=m(S.anchor||S.el),W=T&&T[tf];return W?m(W):T};let ye=!1;const Be=(S,T,W)=>{S==null?T._vnode&&be(T._vnode,null,null,!0):y(T._vnode||null,S,T,null,null,null,W),T._vnode=S,ye||(ye=!0,Za(),Zd(),ye=!1)},Se={p:y,um:be,m:le,r:Re,mt:se,mc:g,pc:Y,pbc:j,n:oe,o:n};return{render:Be,hydrate:void 0,createApp:wv(Be)}}function Ur({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function Tn({effect:n,job:t},e){e?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function $v(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function ua(n,t,e=!1){const o=n.children,s=t.children;if(me(o)&&me(s))for(let r=0;r<o.length;r++){const i=o[r];let l=s[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[r]=gn(s[r]),l.el=i.el),!e&&l.patchFlag!==-2&&ua(i,l)),l.type===kr&&(l.el=i.el)}}function jv(n){const t=n.slice(),e=[0];let o,s,r,i,l;const a=n.length;for(o=0;o<a;o++){const u=n[o];if(u!==0){if(s=e[e.length-1],n[s]<u){t[o]=s,e.push(o);continue}for(r=0,i=e.length-1;r<i;)l=r+i>>1,n[e[l]]<u?r=l+1:i=l;u<n[e[r]]&&(r>0&&(t[o]=e[r-1]),e[r]=o)}}for(r=e.length,i=e[r-1];r-- >0;)e[r]=i,i=t[i];return e}function _f(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:_f(t)}function Ys(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const Rv=Symbol.for("v-scx"),Av=()=>Nt(Rv);function Iv(n,t){return ca(n,null,{flush:"sync"})}function Xe(n,t,e){return ca(n,t,e)}function ca(n,t,e=Ie){const{immediate:o,deep:s,flush:r,once:i}=e,l=ot({},e),a=t&&o||!t&&r!=="post";let u;if(lo){if(r==="sync"){const b=Av();u=b.__watcherHandles||(b.__watcherHandles=[])}else if(!a){const b=()=>{};return b.stop=Gt,b.resume=Gt,b.pause=Gt,b}}const c=at;l.call=(b,_,y)=>Wt(b,c,_,y);let f=!1;r==="post"?l.scheduler=b=>{rt(b,c&&c.suspense)}:r!=="sync"&&(f=!0,l.scheduler=(b,_)=>{_?b():na(b)}),l.augmentJob=b=>{t&&(b.flags|=4),f&&(b.flags|=2,c&&(b.id=c.uid,b.i=c))};const m=zh(n,t,l);return lo&&(u?u.push(m):a&&m()),m}function Mv(n,t,e){const o=this.proxy,s=Je(n)?n.includes(".")?xf(o,n):()=>o[n]:n.bind(o,o);let r;ke(t)?r=t:(r=t.handler,e=t);const i=vs(this),l=ca(s,r.bind(o),e);return i(),l}function xf(n,t){const e=t.split(".");return()=>{let o=n;for(let s=0;s<e.length&&o;s++)o=o[e[s]];return o}}function hs(n,t,e=Ie){const o=Cr(),s=rn(t),r=an(t),i=Sf(n,s),l=Vh((a,u)=>{let c,f=Ie,m;return Iv(()=>{const b=n[s];bt(c,b)&&(c=b,u())}),{get(){return a(),e.get?e.get(c):c},set(b){const _=e.set?e.set(b):b;if(!bt(_,c)&&!(f!==Ie&&bt(b,f)))return;const y=o.vnode.props;y&&(t in y||s in y||r in y)&&(`onUpdate:${t}`in y||`onUpdate:${s}`in y||`onUpdate:${r}`in y)||(c=b,u()),o.emit(`update:${t}`,_),bt(b,_)&&bt(b,f)&&!bt(_,m)&&u(),f=b,m=_}}});return l[Symbol.iterator]=()=>{let a=0;return{next(){return a<2?{value:a++?i||Ie:l,done:!1}:{done:!0}}}},l}const Sf=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${rn(t)}Modifiers`]||n[`${an(t)}Modifiers`];function Dv(n,t,...e){if(n.isUnmounted)return;const o=n.vnode.props||Ie;let s=e;const r=t.startsWith("update:"),i=r&&Sf(o,t.slice(7));i&&(i.trim&&(s=e.map(c=>Je(c)?c.trim():c)),i.number&&(s=e.map(Ws)));let l,a=o[l=Br(t)]||o[l=Br(rn(t))];!a&&r&&(a=o[l=Br(an(t))]),a&&Wt(a,n,6,s);const u=o[l+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[l])return;n.emitted[l]=!0,Wt(u,n,6,s)}}function Pf(n,t,e=!1){const o=t.emitsCache,s=o.get(n);if(s!==void 0)return s;const r=n.emits;let i={},l=!1;if(!ke(n)){const a=u=>{const c=Pf(u,t,!0);c&&(l=!0,ot(i,c))};!e&&t.mixins.length&&t.mixins.forEach(a),n.extends&&a(n.extends),n.mixins&&n.mixins.forEach(a)}return!r&&!l?(Fe(n)&&o.set(n,null),null):(me(r)?r.forEach(a=>i[a]=null):ot(i,r),Fe(n)&&o.set(n,i),i)}function wr(n,t){return!n||!hr(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ee(n,t[0].toLowerCase()+t.slice(1))||Ee(n,an(t))||Ee(n,t))}function au(n){const{type:t,vnode:e,proxy:o,withProxy:s,propsOptions:[r],slots:i,attrs:l,emit:a,render:u,renderCache:c,props:f,data:m,setupState:b,ctx:_,inheritAttrs:y}=n,w=Us(n);let k,h;try{if(e.shapeFlag&4){const p=s||o,P=p;k=zt(u.call(P,p,c,f,b,m,_)),h=l}else{const p=t;k=zt(p.length>1?p(f,{attrs:l,slots:i,emit:a}):p(f,null)),h=t.props?l:Bv(l)}}catch(p){Xo.length=0,ps(p,n,1),k=z(Zt)}let v=k;if(h&&y!==!1){const p=Object.keys(h),{shapeFlag:P}=v;p.length&&P&7&&(r&&p.some(zl)&&(h=Ev(h,r)),v=Cn(v,h,!1,!0))}return e.dirs&&(v=Cn(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(e.dirs):e.dirs),e.transition&&ro(v,e.transition),k=v,Us(w),k}const Bv=n=>{let t;for(const e in n)(e==="class"||e==="style"||hr(e))&&((t||(t={}))[e]=n[e]);return t},Ev=(n,t)=>{const e={};for(const o in n)(!zl(o)||!(o.slice(9)in t))&&(e[o]=n[o]);return e};function Lv(n,t,e){const{props:o,children:s,component:r}=n,{props:i,children:l,patchFlag:a}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&a>=0){if(a&1024)return!0;if(a&16)return o?uu(o,i,u):!!i;if(a&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const m=c[f];if(i[m]!==o[m]&&!wr(u,m))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:o===i?!1:o?i?uu(o,i,u):!0:!!i;return!1}function uu(n,t,e){const o=Object.keys(t);if(o.length!==Object.keys(n).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(t[r]!==n[r]&&!wr(e,r))return!0}return!1}function Nv({vnode:n,parent:t},e){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===n&&(o.el=n.el),o===n)(n=t.vnode).el=e,t=t.parent;else break}}const Gs=n=>n.__isSuspense;function Hv(n,t){t&&t.pendingBranch?me(n)?t.effects.push(...n):t.effects.push(n):Gh(n)}const ue=Symbol.for("v-fgt"),kr=Symbol.for("v-txt"),Zt=Symbol.for("v-cmt"),js=Symbol.for("v-stc"),Xo=[];let xt=null;function R(n=!1){Xo.push(xt=n?null:[])}function Wv(){Xo.pop(),xt=Xo[Xo.length-1]||null}let ss=1;function cu(n,t=!1){ss+=n,n<0&&xt&&t&&(xt.hasOnce=!0)}function Of(n){return n.dynamicChildren=ss>0?xt||Zn:null,Wv(),ss>0&&xt&&xt.push(n),n}function U(n,t,e,o,s,r){return Of(d(n,t,e,o,s,r,!0))}function ce(n,t,e,o,s){return Of(z(n,t,e,o,s,!0))}function io(n){return n?n.__v_isVNode===!0:!1}function An(n,t){return n.type===t.type&&n.key===t.key}const Tf=({key:n})=>n??null,Rs=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?Je(n)||ge(n)||ke(n)?{i:ut,r:n,k:t,f:!!e}:n:null);function d(n,t=null,e=null,o=0,s=null,r=n===ue?0:1,i=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&Tf(t),ref:t&&Rs(t),scopeId:ef,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ut};return l?(da(a,e),r&128&&n.normalize(a)):e&&(a.shapeFlag|=Je(e)?8:16),ss>0&&!i&&xt&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&xt.push(a),a}const z=Vv;function Vv(n,t=null,e=null,o=0,s=null,r=!1){if((!n||n===fv)&&(n=Zt),io(n)){const l=Cn(n,t,!0);return e&&da(l,e),ss>0&&!r&&xt&&(l.shapeFlag&6?xt[xt.indexOf(n)]=l:xt.push(l)),l.patchFlag=-2,l}if(Qv(n)&&(n=n.__vccOpts),t){t=Fv(t);let{class:l,style:a}=t;l&&!Je(l)&&(t.class=Ne(l)),Fe(a)&&(ta(a)&&!me(a)&&(a=ot({},a)),t.style=et(a))}const i=Je(n)?1:Gs(n)?128:Kh(n)?64:Fe(n)?4:ke(n)?2:0;return d(n,t,e,o,s,i,r,!0)}function Fv(n){return n?ta(n)||gf(n)?ot({},n):n:null}function Cn(n,t,e=!1,o=!1){const{props:s,ref:r,patchFlag:i,children:l,transition:a}=n,u=t?qv(s||{},t):s,c={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&Tf(u),ref:t&&t.ref?e&&r?me(r)?r.concat(Rs(t)):[r,Rs(t)]:Rs(t):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:l,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==ue?i===-1?16:i|16:i,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:a,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Cn(n.ssContent),ssFallback:n.ssFallback&&Cn(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return a&&o&&ro(c,a.clone(c)),c}function te(n=" ",t=0){return z(kr,null,n,t)}function Uv(n,t){const e=z(js,null,n);return e.staticCount=t,e}function de(n="",t=!1){return t?(R(),ce(Zt,null,n)):z(Zt,null,n)}function zt(n){return n==null||typeof n=="boolean"?z(Zt):me(n)?z(ue,null,n.slice()):io(n)?gn(n):z(kr,null,String(n))}function gn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Cn(n)}function da(n,t){let e=0;const{shapeFlag:o}=n;if(t==null)t=null;else if(me(t))e=16;else if(typeof t=="object")if(o&65){const s=t.default;s&&(s._c&&(s._d=!1),da(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!gf(t)?t._ctx=ut:s===3&&ut&&(ut.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else ke(t)?(t={default:t,_ctx:ut},e=32):(t=String(t),o&64?(e=16,t=[te(t)]):e=8);n.children=t,n.shapeFlag|=e}function qv(...n){const t={};for(let e=0;e<n.length;e++){const o=n[e];for(const s in o)if(s==="class")t.class!==o.class&&(t.class=Ne([t.class,o.class]));else if(s==="style")t.style=et([t.style,o.style]);else if(hr(s)){const r=t[s],i=o[s];i&&r!==i&&!(me(r)&&r.includes(i))&&(t[s]=r?[].concat(r,i):i)}else s!==""&&(t[s]=o[s])}return t}function jt(n,t,e,o=null){Wt(n,t,7,[e,o])}const zv=ff();let Xv=0;function Yv(n,t,e){const o=n.type,s=(t?t.appContext:n.appContext)||zv,r={uid:Xv++,vnode:n,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new mh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bf(o,s),emitsOptions:Pf(o,s),emit:null,emitted:null,propsDefaults:Ie,inheritAttrs:o.inheritAttrs,ctx:Ie,data:Ie,props:Ie,attrs:Ie,slots:Ie,refs:Ie,setupState:Ie,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Dv.bind(null,r),n.ce&&n.ce(r),r}let at=null;const Cr=()=>at||ut;let Ks,$l;{const n=gr(),t=(e,o)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(o),r=>{s.length>1?s.forEach(i=>i(r)):s[0](r)}};Ks=t("__VUE_INSTANCE_SETTERS__",e=>at=e),$l=t("__VUE_SSR_SETTERS__",e=>lo=e)}const vs=n=>{const t=at;return Ks(n),n.scope.on(),()=>{n.scope.off(),Ks(t)}},du=()=>{at&&at.scope.off(),Ks(null)};function $f(n){return n.vnode.shapeFlag&4}let lo=!1;function Gv(n,t=!1,e=!1){t&&$l(t);const{props:o,children:s}=n.vnode,r=$f(n);kv(n,o,r,t),Sv(n,s,e);const i=r?Kv(n,t):void 0;return t&&$l(!1),i}function Kv(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,pv);const{setup:o}=e;if(o){_n();const s=n.setupContext=o.length>1?Zv(n):null,r=vs(n),i=fs(o,n,0,[n.props,s]),l=Sd(i);if(xn(),r(),(l||n.sp)&&!Dn(n)&&sa(n),l){if(i.then(du,du),t)return i.then(a=>{fu(n,a)}).catch(a=>{ps(a,n,0)});n.asyncDep=i}else fu(n,i)}else jf(n)}function fu(n,t,e){ke(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Fe(t)&&(n.setupState=Gd(t)),jf(n)}function jf(n,t,e){const o=n.type;n.render||(n.render=o.render||Gt);{const s=vs(n);_n();try{hv(n)}finally{xn(),s()}}}const Jv={get(n,t){return dt(n,"get",""),n[t]}};function Zv(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,Jv),slots:n.slots,emit:n.emit,expose:t}}function _r(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Gd(yt(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in zo)return zo[e](n)},has(t,e){return e in t||e in zo}})):n.proxy}function pu(n,t=!0){return ke(n)?n.displayName||n.name:n.name||t&&n.__name}function Qv(n){return ke(n)&&"__vccOpts"in n}const B=(n,t)=>Uh(n,t,lo);function hu(n,t,e){const o=arguments.length;return o===2?Fe(t)&&!me(t)?io(t)?z(n,null,[t]):z(n,t):z(n,null,t):(o>3?e=Array.prototype.slice.call(arguments,2):o===3&&io(e)&&(e=[e]),z(n,t,e))}const eg="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jl;const vu=typeof window<"u"&&window.trustedTypes;if(vu)try{jl=vu.createPolicy("vue",{createHTML:n=>n})}catch{}const Rf=jl?n=>jl.createHTML(n):n=>n,tg="http://www.w3.org/2000/svg",ng="http://www.w3.org/1998/Math/MathML",en=typeof document<"u"?document:null,gu=en&&en.createElement("template"),og={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,o)=>{const s=t==="svg"?en.createElementNS(tg,n):t==="mathml"?en.createElementNS(ng,n):e?en.createElement(n,{is:e}):en.createElement(n);return n==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:n=>en.createTextNode(n),createComment:n=>en.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>en.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,o,s,r){const i=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{gu.innerHTML=Rf(o==="svg"?`<svg>${n}</svg>`:o==="mathml"?`<math>${n}</math>`:n);const l=gu.content;if(o==="svg"||o==="mathml"){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}t.insertBefore(l,e)}return[i?i.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},cn="transition",So="animation",ao=Symbol("_vtc"),Af={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},sg=ot({},Qh,Af),$n=(n,t=[])=>{me(n)?n.forEach(e=>e(...t)):n&&n(...t)},mu=n=>n?me(n)?n.some(t=>t.length>1):n.length>1:!1;function rg(n){const t={};for(const N in n)N in Af||(t[N]=n[N]);if(n.css===!1)return t;const{name:e="v",type:o,duration:s,enterFromClass:r=`${e}-enter-from`,enterActiveClass:i=`${e}-enter-active`,enterToClass:l=`${e}-enter-to`,appearFromClass:a=r,appearActiveClass:u=i,appearToClass:c=l,leaveFromClass:f=`${e}-leave-from`,leaveActiveClass:m=`${e}-leave-active`,leaveToClass:b=`${e}-leave-to`}=n,_=ig(s),y=_&&_[0],w=_&&_[1],{onBeforeEnter:k,onEnter:h,onEnterCancelled:v,onLeave:p,onLeaveCancelled:P,onBeforeAppear:D=k,onAppear:M=h,onAppearCancelled:g=v}=t,O=(N,E,se,X)=>{N._enterCancelled=X,pn(N,E?c:l),pn(N,E?u:i),se&&se()},j=(N,E)=>{N._isLeaving=!1,pn(N,f),pn(N,b),pn(N,m),E&&E()},F=N=>(E,se)=>{const X=N?M:h,x=()=>O(E,N,se);$n(X,[E,x]),bu(()=>{pn(E,N?a:r),Ut(E,N?c:l),mu(X)||yu(E,o,y,x)})};return ot(t,{onBeforeEnter(N){$n(k,[N]),Ut(N,r),Ut(N,i)},onBeforeAppear(N){$n(D,[N]),Ut(N,a),Ut(N,u)},onEnter:F(!1),onAppear:F(!0),onLeave(N,E){N._isLeaving=!0;const se=()=>j(N,E);Ut(N,f),N._enterCancelled?(Ut(N,m),Rl()):(Rl(),Ut(N,m)),bu(()=>{N._isLeaving&&(pn(N,f),Ut(N,b),mu(p)||yu(N,o,w,se))}),$n(p,[N,se])},onEnterCancelled(N){O(N,!1,void 0,!0),$n(v,[N])},onAppearCancelled(N){O(N,!0,void 0,!0),$n(g,[N])},onLeaveCancelled(N){j(N),$n(P,[N])}})}function ig(n){if(n==null)return null;if(Fe(n))return[qr(n.enter),qr(n.leave)];{const t=qr(n);return[t,t]}}function qr(n){return uh(n)}function Ut(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[ao]||(n[ao]=new Set)).add(t)}function pn(n,t){t.split(/\s+/).forEach(o=>o&&n.classList.remove(o));const e=n[ao];e&&(e.delete(t),e.size||(n[ao]=void 0))}function bu(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let lg=0;function yu(n,t,e,o){const s=n._endId=++lg,r=()=>{s===n._endId&&o()};if(e!=null)return setTimeout(r,e);const{type:i,timeout:l,propCount:a}=If(n,t);if(!i)return o();const u=i+"end";let c=0;const f=()=>{n.removeEventListener(u,m),r()},m=b=>{b.target===n&&++c>=a&&f()};setTimeout(()=>{c<a&&f()},l+1),n.addEventListener(u,m)}function If(n,t){const e=window.getComputedStyle(n),o=_=>(e[_]||"").split(", "),s=o(`${cn}Delay`),r=o(`${cn}Duration`),i=wu(s,r),l=o(`${So}Delay`),a=o(`${So}Duration`),u=wu(l,a);let c=null,f=0,m=0;t===cn?i>0&&(c=cn,f=i,m=r.length):t===So?u>0&&(c=So,f=u,m=a.length):(f=Math.max(i,u),c=f>0?i>u?cn:So:null,m=c?c===cn?r.length:a.length:0);const b=c===cn&&/\b(transform|all)(,|$)/.test(o(`${cn}Property`).toString());return{type:c,timeout:f,propCount:m,hasTransform:b}}function wu(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,o)=>ku(e)+ku(n[o])))}function ku(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function Rl(){return document.body.offsetHeight}function ag(n,t,e){const o=n[ao];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const Cu=Symbol("_vod"),ug=Symbol("_vsh"),cg=Symbol(""),dg=/(^|;)\s*display\s*:/;function fg(n,t,e){const o=n.style,s=Je(e);let r=!1;if(e&&!s){if(t)if(Je(t))for(const i of t.split(";")){const l=i.slice(0,i.indexOf(":")).trim();e[l]==null&&As(o,l,"")}else for(const i in t)e[i]==null&&As(o,i,"");for(const i in e)i==="display"&&(r=!0),As(o,i,e[i])}else if(s){if(t!==e){const i=o[cg];i&&(e+=";"+i),o.cssText=e,r=dg.test(e)}}else t&&n.removeAttribute("style");Cu in n&&(n[Cu]=r?o.display:"",n[ug]&&(o.display="none"))}const _u=/\s*!important$/;function As(n,t,e){if(me(e))e.forEach(o=>As(n,t,o));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const o=pg(n,t);_u.test(e)?n.setProperty(an(o),e.replace(_u,""),"important"):n[o]=e}}const xu=["Webkit","Moz","ms"],zr={};function pg(n,t){const e=zr[t];if(e)return e;let o=rn(t);if(o!=="filter"&&o in n)return zr[t]=o;o=Td(o);for(let s=0;s<xu.length;s++){const r=xu[s]+o;if(r in n)return zr[t]=r}return t}const Su="http://www.w3.org/1999/xlink";function Pu(n,t,e,o,s,r=vh(t)){o&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(Su,t.slice(6,t.length)):n.setAttributeNS(Su,t,e):e==null||r&&!jd(e)?n.removeAttribute(t):n.setAttribute(t,r?"":Ht(e)?String(e):e)}function Ou(n,t,e,o,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(n[t]=t==="innerHTML"?Rf(e):e);return}const r=n.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?n.getAttribute("value")||"":n.value,a=e==null?n.type==="checkbox"?"on":"":String(e);(l!==a||!("_value"in n))&&(n.value=a),e==null&&n.removeAttribute(t),n._value=e;return}let i=!1;if(e===""||e==null){const l=typeof n[t];l==="boolean"?e=jd(e):e==null&&l==="string"?(e="",i=!0):l==="number"&&(e=0,i=!0)}try{n[t]=e}catch{}i&&n.removeAttribute(s||t)}function mn(n,t,e,o){n.addEventListener(t,e,o)}function hg(n,t,e,o){n.removeEventListener(t,e,o)}const Tu=Symbol("_vei");function vg(n,t,e,o,s=null){const r=n[Tu]||(n[Tu]={}),i=r[t];if(o&&i)i.value=o;else{const[l,a]=gg(t);if(o){const u=r[t]=yg(o,s);mn(n,l,u,a)}else i&&(hg(n,l,i,a),r[t]=void 0)}}const $u=/(?:Once|Passive|Capture)$/;function gg(n){let t;if($u.test(n)){t={};let o;for(;o=n.match($u);)n=n.slice(0,n.length-o[0].length),t[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):an(n.slice(2)),t]}let Xr=0;const mg=Promise.resolve(),bg=()=>Xr||(mg.then(()=>Xr=0),Xr=Date.now());function yg(n,t){const e=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=e.attached)return;Wt(wg(o,e.value),t,5,[o])};return e.value=n,e.attached=bg(),e}function wg(n,t){if(me(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}const ju=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,kg=(n,t,e,o,s,r)=>{const i=s==="svg";t==="class"?ag(n,o,i):t==="style"?fg(n,e,o):hr(t)?zl(t)||vg(n,t,e,o,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Cg(n,t,o,i))?(Ou(n,t,o),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Pu(n,t,o,i,r,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Je(o))?Ou(n,rn(t),o,r,t):(t==="true-value"?n._trueValue=o:t==="false-value"&&(n._falseValue=o),Pu(n,t,o,i))};function Cg(n,t,e,o){if(o)return!!(t==="innerHTML"||t==="textContent"||t in n&&ju(t)&&ke(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return ju(t)&&Je(e)?!1:t in n}const Mf=new WeakMap,Df=new WeakMap,Js=Symbol("_moveCb"),Ru=Symbol("_enterCb"),_g=n=>(delete n.props.mode,n),xg=_g({name:"TransitionGroup",props:ot({},sg,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=Cr(),o=Zh();let s,r;return ia(()=>{if(!s.length)return;const i=n.moveClass||`${n.name||"v"}-move`;if(!Tg(s[0].el,e.vnode.el,i))return;s.forEach(Sg),s.forEach(Pg);const l=s.filter(Og);Rl(),l.forEach(a=>{const u=a.el,c=u.style;Ut(u,i),c.transform=c.webkitTransform=c.transitionDuration="";const f=u[Js]=m=>{m&&m.target!==u||(!m||/transform$/.test(m.propertyName))&&(u.removeEventListener("transitionend",f),u[Js]=null,pn(u,i))};u.addEventListener("transitionend",f)})}),()=>{const i=Me(n),l=rg(i);let a=i.tag||ue;if(s=[],r)for(let u=0;u<r.length;u++){const c=r[u];c.el&&c.el instanceof Element&&(s.push(c),ro(c,xl(c,l,o,e)),Mf.set(c,c.el.getBoundingClientRect()))}r=t.default?sf(t.default()):[];for(let u=0;u<r.length;u++){const c=r[u];c.key!=null&&ro(c,xl(c,l,o,e))}return z(a,null,r)}}}),Q_=xg;function Sg(n){const t=n.el;t[Js]&&t[Js](),t[Ru]&&t[Ru]()}function Pg(n){Df.set(n,n.el.getBoundingClientRect())}function Og(n){const t=Mf.get(n),e=Df.get(n),o=t.left-e.left,s=t.top-e.top;if(o||s){const r=n.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",n}}function Tg(n,t,e){const o=n.cloneNode(),s=n[ao];s&&s.forEach(l=>{l.split(/\s+/).forEach(a=>a&&o.classList.remove(a))}),e.split(/\s+/).forEach(l=>l&&o.classList.add(l)),o.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(o);const{hasTransform:i}=If(o);return r.removeChild(o),i}const uo=n=>{const t=n.props["onUpdate:modelValue"]||!1;return me(t)?e=>eo(t,e):t};function $g(n){n.target.composing=!0}function Au(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const sn=Symbol("_assign"),Ke={created(n,{modifiers:{lazy:t,trim:e,number:o}},s){n[sn]=uo(s);const r=o||s.props&&s.props.type==="number";mn(n,t?"change":"input",i=>{if(i.target.composing)return;let l=n.value;e&&(l=l.trim()),r&&(l=Ws(l)),n[sn](l)}),e&&mn(n,"change",()=>{n.value=n.value.trim()}),t||(mn(n,"compositionstart",$g),mn(n,"compositionend",Au),mn(n,"change",Au))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:o,trim:s,number:r}},i){if(n[sn]=uo(i),n.composing)return;const l=(r||n.type==="number")&&!/^0\d/.test(n.value)?Ws(n.value):n.value,a=t??"";l!==a&&(document.activeElement===n&&n.type!=="range"&&(o&&t===e||s&&n.value.trim()===a)||(n.value=a))}},jg={deep:!0,created(n,t,e){n[sn]=uo(e),mn(n,"change",()=>{const o=n._modelValue,s=rs(n),r=n.checked,i=n[sn];if(me(o)){const l=Gl(o,s),a=l!==-1;if(r&&!a)i(o.concat(s));else if(!r&&a){const u=[...o];u.splice(l,1),i(u)}}else if(go(o)){const l=new Set(o);r?l.add(s):l.delete(s),i(l)}else i(Bf(n,r))})},mounted:Iu,beforeUpdate(n,t,e){n[sn]=uo(e),Iu(n,t,e)}};function Iu(n,{value:t,oldValue:e},o){n._modelValue=t;let s;if(me(t))s=Gl(t,o.props.value)>-1;else if(go(t))s=t.has(o.props.value);else{if(t===e)return;s=ds(t,Bf(n,!0))}n.checked!==s&&(n.checked=s)}const St={deep:!0,created(n,{value:t,modifiers:{number:e}},o){const s=go(t);mn(n,"change",()=>{const r=Array.prototype.filter.call(n.options,i=>i.selected).map(i=>e?Ws(rs(i)):rs(i));n[sn](n.multiple?s?new Set(r):r:r[0]),n._assigning=!0,yn(()=>{n._assigning=!1})}),n[sn]=uo(o)},mounted(n,{value:t}){Mu(n,t)},beforeUpdate(n,t,e){n[sn]=uo(e)},updated(n,{value:t}){n._assigning||Mu(n,t)}};function Mu(n,t){const e=n.multiple,o=me(t);if(!(e&&!o&&!go(t))){for(let s=0,r=n.options.length;s<r;s++){const i=n.options[s],l=rs(i);if(e)if(o){const a=typeof l;a==="string"||a==="number"?i.selected=t.some(u=>String(u)===String(l)):i.selected=Gl(t,l)>-1}else i.selected=t.has(l);else if(ds(rs(i),t)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!e&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function rs(n){return"_value"in n?n._value:n.value}function Bf(n,t){const e=t?"_trueValue":"_falseValue";return e in n?n[e]:t}const Rg=["ctrl","shift","alt","meta"],Ag={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>Rg.some(e=>n[`${e}Key`]&&!t.includes(e))},he=(n,t)=>{const e=n._withMods||(n._withMods={}),o=t.join(".");return e[o]||(e[o]=(s,...r)=>{for(let i=0;i<t.length;i++){const l=Ag[t[i]];if(l&&l(s,t))return}return n(s,...r)})},Ig={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},it=(n,t)=>{const e=n._withKeys||(n._withKeys={}),o=t.join(".");return e[o]||(e[o]=s=>{if(!("key"in s))return;const r=an(s.key);if(t.some(i=>i===r||Ig[i]===r))return n(s)})},Mg=ot({patchProp:kg},og);let Du;function Dg(){return Du||(Du=Ov(Mg))}const Ef=(...n)=>{const t=Dg().createApp(...n),{mount:e}=t;return t.mount=o=>{const s=Eg(o);if(!s)return;const r=t._component;!ke(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const i=e(s,!1,Bg(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),i},t};function Bg(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Eg(n){return Je(n)?document.querySelector(n):n}const Lg="modulepreload",Ng=function(n,t){return new URL(n,t).href},Bu={},Al=function(t,e,o){let s=Promise.resolve();if(e&&e.length>0){let i=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};const l=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),u=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=i(e.map(c=>{if(c=Ng(c,o),c in Bu)return;Bu[c]=!0;const f=c.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(!!o)for(let y=l.length-1;y>=0;y--){const w=l[y];if(w.href===c&&(!f||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${m}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":Lg,f||(_.as="script"),_.crossOrigin="",_.href=c,u&&_.setAttribute("nonce",u),document.head.appendChild(_),f)return new Promise((y,w)=>{_.addEventListener("load",y),_.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})};function Hg(n){return{all:n=n||new Map,on:function(t,e){var o=n.get(t);o?o.push(e):n.set(t,[e])},off:function(t,e){var o=n.get(t);o&&(e?o.splice(o.indexOf(e)>>>0,1):n.set(t,[]))},emit:function(t,e){var o=n.get(t);o&&o.slice().map(function(s){s(e)}),(o=n.get("*"))&&o.slice().map(function(s){s(t,e)})}}}const Yr=Hg(),je={fire(n){Yr.emit(n.kind,n)},subscribe(n,t){Yr.on(n.kind,t)},unsubscribe(n,t){Yr.off(n.kind,t)}};class Zs{constructor(t){C(this,"kind","AssetFailureEvent");this.path=t}}C(Zs,"kind","AssetFailureEvent");class gs{constructor(t){C(this,"kind","FailureEvent");this.message=t}}C(gs,"kind","FailureEvent");class Lf{constructor(t){C(this,"kind","CustomAssetFailureEvent");this.error=t}}C(Lf,"kind","CustomAssetFailureEvent");class Qs{constructor(){C(this,"kind","InvalidateRenderEvent")}}C(Qs,"kind","InvalidateRenderEvent");const cr=class cr{constructor(){C(this,"kind",cr.kind)}};C(cr,"kind","RenderUpdatedEvent");let er=cr;const dr=class dr{constructor(){C(this,"kind",dr.kind)}};C(dr,"kind","StateLoadingEvent");let tr=dr;class _t{constructor(t){C(this,"kind","ShowMessageEvent");this.message=t}}C(_t,"kind","ShowMessageEvent");class fa{constructor(t,e){C(this,"kind","ResolvableErrorEvent");this.message=t,this.actions=e}}C(fa,"kind","ResolvableErrorEvent");class nr{constructor(t){C(this,"kind","ColorPickedEvent");this.color=t}}C(nr,"kind","ColorPickedEvent");class Nf{constructor(t,e){C(this,"kind","VueErrorEvent");this.error=t,this.info=e}}C(Nf,"kind","VueErrorEvent");function Ot(){return Nt("viewport")}const Eu=new WeakMap,Lu=new WeakMap;function Hf(){const n=Ot(),t=Eu.get(n);if(t)return t;const e=B({get(){return n.value.selection},set(o){n.value.selection=o}});return Eu.set(n,e),e}function Pn(){const n=Ot(),t=Lu.get(n);if(t)return t;console.log("make computed");const e=B(()=>n.value.isVertical);return Lu.set(n,e),e}const Wg={key:0},Vg=["onClick"],Fg=["onClick"],Ug=5e3,Gr=2e4,Nu=100,qg=xe({__name:"message-console",props:{loading:{type:Boolean}},setup(n){const t=n,e=I([]),o=I([]),s=I([]),r=I(!1),i=I(0),l=I(0),a=Pn();u(t.loading),je.subscribe(Zs,m=>{e.value.push(`Failed to load asset '${m.path}'`),setTimeout(()=>{e.value.shift()},Ug)}),je.subscribe(Lf,()=>{e.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{e.value.shift()},Gr)}),je.subscribe(gs,m=>{o.value.push(m.message)}),je.subscribe(fa,m=>{s.value.push(m)}),je.subscribe(_t,m=>{e.value.push(m.message),setTimeout(()=>{e.value.shift()},Gr)}),je.subscribe(Nf,m=>{e.value.push(m.error.name),e.value.push(JSON.stringify(m.error.stack)),e.value.push(m.info),setTimeout(()=>{e.value.shift(),e.value.shift(),e.value.shift()},Gr)});function u(m){m?(l.value&&(clearTimeout(l.value),l.value=0),!r.value&&!i.value&&(i.value=setTimeout(()=>{r.value=!0,i.value=0},Nu))):(i.value&&(clearTimeout(i.value),i.value=0),r.value&&!l.value&&(l.value=setTimeout(()=>{r.value=!1,l.value=0},Nu)))}function c(m){o.value.splice(m,1)}async function f(m,b){const _=s.value[m];s.value.splice(m,1),await _.actions.find(w=>w.name===b).exec()}return Xe(()=>t.loading,m=>{u(m)}),(m,b)=>(R(),U("div",{id:"messageConsole",class:Ne({vertical:J(a)})},[r.value?(R(),U("p",Wg,"Loading...")):de("",!0),(R(!0),U(ue,null,ze(e.value,(_,y)=>(R(),U("p",{key:_+"_"+y},Oe(_),1))),128)),(R(!0),U(ue,null,ze(s.value,(_,y)=>(R(),U("p",{class:"error",key:"resolvableError_"+y},[te(Oe(_.message)+" ",1),(R(!0),U(ue,null,ze(_.actions,w=>(R(),U("a",{href:"#",key:"resolvableError_"+y+w.name,onClick:k=>f(y,w.name)},"["+Oe(w.name)+"]",9,Vg))),128))]))),128)),(R(!0),U(ue,null,ze(o.value,(_,y)=>(R(),U("p",{class:"error",key:"error_"+y},[te(Oe(_)+" ",1),d("a",{href:"#",onClick:w=>c(y)},"[Dismiss]",8,Fg)]))),128))],2))}}),De=(n,t)=>{const e=n.__vccOpts||n;for(const[o,s]of t)e[o]=s;return e},zg=De(qg,[["__scopeId","data-v-6b48a3f4"]]),Xg={key:0,id:"submit-options"},Yg=["onClick"],Gg={key:0,id:"submit-options"},Kg=["onClick"],Jg=xe({__name:"modal-dialog",props:{noBaseSize:{type:Boolean,default:!1},options:{default:()=>[]}},emits:["leave","option"],setup(n,{emit:t}){const e=n,o=t,s=typeof HTMLDialogElement<"u",r=I(null);function i(){if(s){const u=r.value;u!=null&&!u.open&&u.showModal()}window.addEventListener("click",a)}function l(){if(s){const u=r.value;u!=null&&u.open&&u.close(),o("leave")}window.removeEventListener("click",a)}function a(u){const c=r.value;c!=null&&c.open?u.target===c&&(l(),u.preventDefault(),u.stopPropagation()):window.removeEventListener("click",a)}return Vt(i),rf(i),lf(l),Sn(l),(u,c)=>s?(R(),U("dialog",{key:0,ref_key:"dialog",ref:r,class:Ne(["native",{"base-size":!e.noBaseSize}]),onCancel:l},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(R(),U("div",Xg,[(R(!0),U(ue,null,ze(u.options,f=>(R(),U("button",{key:f,class:"option",onClick:m=>o("option",f)},Oe(f),9,Yg))),128))])):de("",!0)],34)):(R(),U("div",{key:1,class:"dialog-wrapper",onClick:c[1]||(c[1]=f=>o("leave"))},[d("dialog",{ref_key:"dialog",ref:r,open:"",class:Ne({"base-size":!e.noBaseSize}),onClick:c[0]||(c[0]=he(()=>{},["stop"]))},[Xt(u.$slots,"default",{},void 0,!0),u.options.length>0?(R(),U("div",Gg,[(R(!0),U(ue,null,ze(e.options,f=>(R(),U("button",{key:f,class:"option",onClick:m=>o("option",f)},Oe(f),9,Kg))),128))])):de("",!0)],2)]))}}),Bn=De(Jg,[["__scopeId","data-v-07b9fd71"]]),Zg="./",pa="/dddg-assets/v2/assets/",vt=`${Zg}packs/`,ha=!0,ie=Wf();function Wf(){const n=[];let t=!1;const e=[],o=function(r){return new Promise(i=>{const l=async()=>{try{r.length>0?await r(Wf()):await r(),e.forEach(a=>a())}catch(a){console.log("Error during transaction!: ",a)}finally{t=!1}n.length>0&&n.shift()(),i()};t?n.push(l):l()})};return o.onClear=function(s){e.push(s)},o}async function Kr(n){await ie(async()=>{await(n==null?void 0:n())})}function We(n,t){return n()}const va={"dddg.buildin.backgrounds.nsfw":`${vt}buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${vt}buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${vt}buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${vt}buildin.base.yuri.nsfw.json`},Qg=new Set(Object.keys(va)),em=Object.values(va);var Po={},Hu;function tm(){if(Hu)return Po;Hu=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.normalizeCharacter=void 0;function n(a,u){var c=l("",a.folder||"/",u),f=void 0;return a.chibi&&(f=l(c,a.chibi,u)),f===void 0&&a.internalId&&(f=(u["/"]||"")+"chibis/"+a.internalId),{id:a.id,packId:a.packId,packCredits:a.packCredits,name:a.name,nsfw:!!a.nsfw,chibi:f,eyes:t(a.eyes,c,u),hairs:t(a.hairs,c,u),styles:r(a.styles),heads:e(a.heads,c,u),poses:o(a.poses,c,u)}}Po.normalizeCharacter=n;function t(a,u,c){if(!a)return{};var f={};for(var m in a)a.hasOwnProperty(m)&&(f[m]=l(u,a[m],c));return f}function e(a,u,c){var f={};if(!a)return f;for(var m in a)if(a.hasOwnProperty(m)){var b=a[m],_=void 0;if(b instanceof Array)_={all:s(b,u,c),nsfw:!1,offset:[290,70],size:[380,380]};else{var y=l(u,b.folder,c);_={all:s(b.all,y,c),nsfw:!!b.nsfw,offset:b.offset||[290,70],size:b.size||[380,380]}}f[m]=_}return f}function o(a,u,c){return a?a.map(function(f){var m=l(u,f.folder,c),b={compatibleHeads:f.compatibleHeads||[],headAnchor:f.headAnchor||[0,0],headInForeground:!!f.headInForeground,name:f.name,nsfw:!!f.nsfw,style:f.style,offset:[0,0],size:[960,960]};if("static"in f)b.static=l(m,f.static,c);else if("variant"in f)b.variant=s(f.variant,m,c);else if("left"in f)b.left=s(f.left,m,c),b.right=s(f.right,m,c);else throw new Error("Invalid pose");return b}):[]}function s(a,u,c){return a.map(function(f){return typeof f=="string"?{img:l(u,f,c),nsfw:!1}:{img:l(u,f.img,c),nsfw:f.nsfw||!1}})}function r(a){return a?a.map(function(u){return{name:u.name,label:u.label,nsfw:u.nsfw||!1}}):[]}function i(a){return a.startsWith("blob:")||a.startsWith("http://")||a.startsWith("https://")||a.startsWith("://")}function l(a,u,c){if(!u)return a;for(var f in c)if(u.startsWith(f))return c[f]+u.slice(f.length);return i(u)?u:a+u}return Po}var nm=tm(),kt={},Ye={},lt={},Wu;function Vf(){if(Wu)return lt;Wu=1;var n=lt&&lt.__assign||function(){return n=Object.assign||function(p){for(var P,D=1,M=arguments.length;D<M;D++){P=arguments[D];for(var g in P)Object.prototype.hasOwnProperty.call(P,g)&&(p[g]=P[g])}return p},n.apply(this,arguments)},t=lt&&lt.__values||function(p){var P=typeof Symbol=="function"&&Symbol.iterator,D=P&&p[P],M=0;if(D)return D.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&M>=p.length&&(p=void 0),{value:p&&p[M++],done:!p}}};throw new TypeError(P?"Object is not iterable.":"Symbol.iterator is not defined.")},e=lt&&lt.__read||function(p,P){var D=typeof Symbol=="function"&&p[Symbol.iterator];if(!D)return p;var M=D.call(p),g,O=[],j;try{for(;(P===void 0||P-- >0)&&!(g=M.next()).done;)O.push(g.value)}catch(F){j={error:F}}finally{try{g&&!g.done&&(D=M.return)&&D.call(M)}finally{if(j)throw j.error}}return O},o=lt&&lt.__spread||function(){for(var p=[],P=0;P<arguments.length;P++)p=p.concat(e(arguments[P]));return p};Object.defineProperty(lt,"__esModule",{value:!0}),lt.mapObject=lt.assetWalker=lt.normalizePath=void 0;var s=10;function r(p,P,D,M){for(var g,O,j="",F=0,N=new Map(Array.from(P.entries()).map(function(x){return[new RegExp("{"+x[0]+"}","g"),x[1]]}));j!==p;){if(j=p,++F>s)throw new Error("Maximum replacement recursion exceeded!");try{for(var E=(g=void 0,t(N.entries())),se=E.next();!se.done;se=E.next()){var X=se.value;p=p.replace(X[0],X[1])}}catch(x){g={error:x}}finally{try{se&&!se.done&&(O=E.return)&&O.call(E)}finally{if(g)throw g.error}}p=p.replace(/{format(:.*?:.*?)+}/gi,function(x){x=x.slice(8,-1);for(var A=x.split(":"),Y=0;Y<A.length;Y+=2)if(D.has(A[Y]))return A[Y+1];return""}),p=p.replace(/{lq:(.*?):(.*?)}/gi,function(x){return x.slice(4,-1).split(":")[M?0:1]})}return p}lt.normalizePath=r;function i(p,P){return{packId:p.packId,packCredits:p.packCredits,dependencies:p.dependencies,characters:p.characters.map(function(D){return l(D,P)}),backgrounds:p.backgrounds.map(function(D){return y(D,P)}),fonts:p.fonts.map(function(D){return w(D,P)}),poemStyles:o(p.poemStyles),poemBackgrounds:p.poemBackgrounds.map(function(D){return k(D,P)}),sprites:p.sprites.map(function(D){return h(D,P)}),colors:p.colors}}lt.assetWalker=i;function l(p,P){return{id:p.id,label:p.label,chibi:p.chibi?P(p.chibi,"image"):void 0,heads:b(p.heads,P),styleGroups:p.styleGroups.map(function(D){return a(D,P)}),defaultScale:p.defaultScale,hd:p.hd,size:p.size,sdVersion:p.sdVersion}}function a(p,P){return{id:p.id,styleComponents:p.styleComponents.map(function(D){return c(D,P)}),styles:p.styles.map(function(D){return u(D,P)})}}function u(p,P){return{components:p.components,poses:p.poses.map(function(D){return m(D,P)})}}function c(p,P){return n(n({},p),{variants:f(p.variants,P)})}function f(p,P){var D={};for(var M in p)p.hasOwnProperty(M)&&(D[M]=P(p[M],"image"));return D}function m(p,P){var D,M,g={};try{for(var O=t(Object.keys(p.positions)),j=O.next();!j.done;j=O.next()){var F=j.value,N=p.positions[F];g[F]=N.map(function(E){return E.map(function(se){return P(se,"image")})})}}catch(E){D={error:E}}finally{try{j&&!j.done&&(M=O.return)&&M.call(O)}finally{if(D)throw D.error}}return{compatibleHeads:p.compatibleHeads,id:p.id,previewOffset:p.previewOffset,previewSize:p.previewSize,renderCommands:p.renderCommands.map(function(E){return E.type==="image"?{type:"image",offset:E.offset,images:E.images.map(function(se){return P(se,"image")})}:E}),size:p.size,scale:p.scale,positions:g}}function b(p,P){var D={};for(var M in p)p.hasOwnProperty(M)&&(D[M]=_(p[M],P));return D}function _(p,P){return{previewOffset:p.previewOffset,previewSize:p.previewSize,variants:p.variants.map(function(D){return D.map(function(M){return P(M,"image")})})}}function y(p,P){return{id:p.id,label:p.label,variants:p.variants.map(function(D){return D.map(function(M){return P(M,"image")})}),scaling:p.scaling,sdVersion:p.sdVersion}}function w(p,P){return{id:p.id,label:p.label,files:p.files.map(function(D){return P(D,"font")})}}function k(p,P){return{id:p.id,fontColor:p.fontColor,label:p.label,images:p.images.map(function(D){return P(D,"image")}),sdVersion:p.sdVersion}}function h(p,P){return{id:p.id,label:p.label,variants:p.variants.map(function(D){return D.map(function(M){return P(M,"image")})}),defaultScale:p.defaultScale,hd:p.hd,sdVersion:p.sdVersion}}function v(p,P){var D={};for(var M in p)p.hasOwnProperty(M)&&(D[M]=P(p[M],M));return D}return lt.mapObject=v,lt}var Vu;function Ff(){if(Vu)return Ye;Vu=1;var n=Ye&&Ye.__assign||function(){return n=Object.assign||function(g){for(var O,j=1,F=arguments.length;j<F;j++){O=arguments[j];for(var N in O)Object.prototype.hasOwnProperty.call(O,N)&&(g[N]=O[N])}return g},n.apply(this,arguments)};Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.expandId=Ye.normalizeStyleComponent=Ye.normalizeColor=Ye.normalizeBackground=Ye.normalizeFont=Ye.normalizePoemBackground=Ye.normalizePoemStyles=Ye.normalizeSprite=Ye.mapNormalize=Ye.normalizeContentPack=void 0;var t=Vf();function e(g,O){var j={paths:O,packId:g.packId},F=D("",g.folder||"/",j);return{packId:g.packId,packCredits:g.packCredits,dependencies:g.dependencies||[],characters:o(f,g.characters,F,j),backgrounds:o(a,g.backgrounds,F,j),fonts:o(l,g.fonts,F,j),poemStyles:o(r,g.poemStyles,F,j),poemBackgrounds:o(i,g.poemBackgrounds,F,j),sprites:o(s,g.sprites,F,j),colors:o(u,g.colors,F,j)}}Ye.normalizeContentPack=e;function o(g,O,j,F){return O?O.map(function(N){return g(N,j,F)}):[]}Ye.mapNormalize=o;function s(g,O,j){var F,N=D(O,g.folder,j);return{id:M(j.packId,g.id),label:g.label||g.variants[0][0],variants:g.variants.map(function(E){return c(E,N,j)}),defaultScale:g.defaultScale||[1,1],sdVersion:g.sdVersion,hd:(F=g.hd)!==null&&F!==void 0?F:null}}Ye.normalizeSprite=s;function r(g){return{label:g.label,defaultFont:g.defaultFont||"Aller",fontSize:g.fontSize!==void 0?g.fontSize:30,letterSpacing:g.letterSpacing!==void 0?g.letterSpacing:1,lineSpacing:g.lineSpacing!==void 0?g.lineSpacing:1.2}}Ye.normalizePoemStyles=r;function i(g,O,j){var F=D(O,g.folder,j);return{id:g.id,label:g.label,images:c(g.images,F,j),fontColor:g.fontColor||"black",sdVersion:g.sdVersion}}Ye.normalizePoemBackground=i;function l(g,O,j){var F=D(O,g.folder,j);return{id:M(j.packId,g.id?g.id:g.label?g.label:g.files[0]),label:g.label?g.label:g.id?g.id:g.files[0],files:c(g.files,F,j)}}Ye.normalizeFont=l;function a(g,O,j){var F,N=D(O,g.folder,j);return{id:M(j.packId,g.id),label:g.label?g.label:g.variants[0][0],variants:g.variants.map(function(E){return c(E,N,j)}),scaling:["none","strech","cover"].includes((F=g.scaling)===null||F===void 0?void 0:F.toLowerCase())?g.scaling.toLowerCase():"cover",sdVersion:g.sdVersion}}Ye.normalizeBackground=a;function u(g){return{label:g.label||g.color,color:g.color}}Ye.normalizeColor=u;function c(g,O,j){return g.map(function(F){return D(O,F,j)})}function f(g,O,j){var F,N,E,se=D(O,g.folder,j);return{id:M(j.packId,g.id),label:g.label,chibi:g.chibi?D(se,g.chibi,j):void 0,heads:w(g.heads,se,j),defaultScale:(F=g.defaultScale)!==null&&F!==void 0?F:[.8,.8],size:(N=g.size)!==null&&N!==void 0?N:[960,960],hd:(E=g.hd)!==null&&E!==void 0?E:!1,sdVersion:g.sdVersion,styleGroups:o(m,g.styleGroups,se,j)}}function m(g,O,j){var F=D(O,g.folder,j);return{id:M(j.packId,g.id),styleComponents:o(_,g.styleComponents,F,j),styles:g.styles.map(function(N){return b(N,F,j)})}}function b(g,O,j){var F=D(O,g.folder,j),N={};if(g.components)for(var E in g.components)g.components.hasOwnProperty(E)&&(N[M(j.packId,E)]=g.components[E]);return{components:N,poses:g.poses.map(function(se){return k(se,F,j)})}}function _(g,O,j){return{id:M(j.packId,g.id),label:g.label,variants:y(g.variants,O,j)}}Ye.normalizeStyleComponent=_;function y(g,O,j){if(!g)return{};var F={};for(var N in g)g.hasOwnProperty(N)&&(F[N]=D(O,g[N],j));return F}function w(g,O,j){var F={};if(!g)return F;for(var N in g)if(g.hasOwnProperty(N)){var E=g[N],se=void 0;if(E instanceof Array)se={variants:v(E,O,j),previewOffset:[290,70],previewSize:[380,380]};else{var X=D(O,E.folder,j);se={variants:v(E.variants,X,j),previewOffset:E.previewOffset||[290,70],previewSize:E.previewSize||[380,380]}}F[M(j.packId,N)]=se}return F}function k(g,O,j){var F,N,E=D(O,g.folder,j);return{compatibleHeads:((F=g.compatibleHeads)===null||F===void 0?void 0:F.map(function(se){return M(j.packId,se)}))||[],id:M(j.packId,g.id),previewOffset:g.previewOffset||[0,0],previewSize:g.previewSize||[960,960],size:g.size||[960,960],scale:g.scale||.8,positions:t.mapObject(g.positions||{},function(se){return v(se,E,j)}),renderCommands:((N=g.renderCommands)===null||N===void 0?void 0:N.map(function(se){return h(se,O,j)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function h(g,O,j){if(g.type==="image"){var F=D(O,g.folder,j);return{type:"image",composite:g.composite,offset:g.offset||[0,0],images:p(g.images,F,j)}}else return n(n({},g),{offset:g.offset||[0,0]})}function v(g,O,j){return g.map(function(F){return p(F,O,j)})}function p(g,O,j){return g.map(function(F){return D(O,F,j)})}function P(g){return g.startsWith("blob:")||g.startsWith("http://")||g.startsWith("https://")||g.startsWith("://")}function D(g,O,j){if(!O)return g;for(var F in j.paths)if(O.startsWith(F))return j.paths[F]+O.slice(F.length);return P(O)?O:g+O}function M(g,O){return O.indexOf(":")!==-1?O:g+":"+O}return Ye.expandId=M,Ye}var Fu;function om(){if(Fu)return kt;Fu=1;var n=kt&&kt.__values||function(h){var v=typeof Symbol=="function"&&Symbol.iterator,p=v&&h[v],P=0;if(p)return p.call(h);if(h&&typeof h.length=="number")return{next:function(){return h&&P>=h.length&&(h=void 0),{value:h&&h[P++],done:!h}}};throw new TypeError(v?"Object is not iterable.":"Symbol.iterator is not defined.")},t=kt&&kt.__read||function(h,v){var p=typeof Symbol=="function"&&h[Symbol.iterator];if(!p)return h;var P=p.call(h),D,M=[],g;try{for(;(v===void 0||v-- >0)&&!(D=P.next()).done;)M.push(D.value)}catch(O){g={error:O}}finally{try{D&&!D.done&&(p=P.return)&&p.call(P)}finally{if(g)throw g.error}}return M},e=kt&&kt.__spread||function(){for(var h=[],v=0;v<arguments.length;v++)h=h.concat(t(arguments[v]));return h};Object.defineProperty(kt,"__esModule",{value:!0}),kt.expandOrTranslateId=kt.convert=void 0;var o=Ff();function s(h,v,p){if(!h.packId)throw new Error("");return{packId:h.packId,packCredits:h.packCredits?[h.packCredits]:[],dependencies:i(h.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[l(h,v,p)],colors:[]}}kt.convert=s;var r={"ddlc.monika":w("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":w("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":w("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":w("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":w("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":w("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":w("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":w("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":w("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":w("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function i(h){return[]}function l(h,v,p){var P={characterId:h.id,packId:h.packId,paths:v};return{id:k("character",h.id,P),chibi:h.chibi,label:h.name,heads:b(h.heads,P,p),styleGroups:a(h,P,p),defaultScale:[.8,.8],size:[960,960],hd:!1}}function a(h,v,p){var P,D,M=r[v.characterId],g=[],O=new Map,j=_(h,v),F=j.length===0?M&&M.defaultStyleComponents?u(M.defaultStyleComponents,v):[]:j,N=h.poses.map(function(Y){return Y.style}).filter(function(Y,He,G){return G.indexOf(Y)===He}),E=new Map(h.styles.map(function(Y){return[Y.name,Y]})),se=function(Y){var He,G,le,be,Re=E.get(Y);if(Re&&Re.nsfw&&!p)return"continue";var Ce=Y,tt={};try{for(var Ue=(He=void 0,n(F)),oe=Ue.next();!oe.done;oe=Ue.next()){var ye=oe.value;try{for(var Be=(le=void 0,n(Object.keys(ye.variants))),Se=Be.next();!Se.done;Se=Be.next()){var st=Se.value,S=new RegExp("-"+st+"\\b");if(Ce.match(S)){tt[ye.id]=st,Ce=Ce.replace(S,"");break}}}catch(W){le={error:W}}finally{try{Se&&!Se.done&&(be=Be.return)&&be.call(Be)}finally{if(le)throw le.error}}}}catch(W){He={error:W}}finally{try{oe&&!oe.done&&(G=Ue.return)&&G.call(Ue)}finally{if(He)throw He.error}}Ce=k("styleGroups",Ce,v);var T=O.get(Ce);T||(T={id:Ce,styleComponents:F,styles:[]},O.set(Ce,T),g.push(Ce)),T.styles.push({components:tt,poses:f(h.poses.filter(function(W){return W.style===Y}),v,p)})};try{for(var X=n(N),x=X.next();!x.done;x=X.next()){var A=x.value;se(A)}}catch(Y){P={error:Y}}finally{try{x&&!x.done&&(D=X.return)&&D.call(X)}finally{if(P)throw P.error}}return g.map(function(Y){return O.get(Y)})}function u(h,v){return o.mapNormalize(o.normalizeStyleComponent,h,"",{packId:v.packId,paths:v.paths})}function c(h,v){return h?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:v}]:[{type:"head",offset:v},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function f(h,v,p){return h.map(function(P){return{compatibleHeads:P.compatibleHeads.map(function(D){return k("heads",D.toString(),v)}),id:k("poses",P.name,v),renderCommands:c(P.headInForeground,P.headAnchor),previewOffset:P.offset,previewSize:P.size,size:[960,960],scale:.8,positions:{Static:"static"in P?[[P.static]]:[],Left:"left"in P?m(P.left,p):[],Right:"right"in P?m(P.right,p):[],Variant:"variant"in P?m(P.variant,p):[]}}})}function m(h,v){return h.filter(function(p){return!p.nsfw||v}).map(function(p){return[p.img]})}function b(h,v,p){var P,D,M={};try{for(var g=n(Object.keys(h)),O=g.next();!O.done;O=g.next()){var j=O.value,F=h[j];F.nsfw&&!p||(M[k("heads",j,v)]={previewOffset:F.offset,previewSize:F.size,variants:F.all.filter(function(N){return!N.nsfw||p}).map(function(N){return[N.img]})})}}catch(N){P={error:N}}finally{try{O&&!O.done&&(D=g.return)&&D.call(g)}finally{if(P)throw P.error}}return M}function _(h,v){var p=[],P=[];return Object.keys(h.eyes).length>0&&(Object.keys(h.eyes).forEach(function(D){return P.push(D)}),p.push({label:"Eyes",id:k("eyes","eyes",v),variants:h.eyes})),Object.keys(h.hairs).length>0&&(Object.keys(h.hairs).forEach(function(D){return P.push(D)}),p.push({label:"Hairs",id:k("hairs","hairs",v),variants:h.hairs})),p}function y(h,v){return new Map(v.map(function(p){return[p,h+":"+p]}))}function w(h,v,p){return p.extraHeadAssoc?p.extraHeadAssoc=p.extraHeadAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraHeadAssoc=[],p.extraPoseAssoc?p.extraPoseAssoc=p.extraPoseAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraPoseAssoc=[],p.extraStyleGroupAssoc?p.extraStyleGroupAssoc=p.extraStyleGroupAssoc.map(function(P){return[P[0],h+":"+P[1]]}):p.extraStyleGroupAssoc=[],{character:h+":"+v,eyes:h+":eyes",hairs:h+":hair",defaultStyleComponents:p.defaultStyleComponents||[],heads:new Map(e(y(h,p.heads),p.extraHeadAssoc)),poses:new Map(e(y(h,p.poses),p.extraPoseAssoc)),styleGroups:new Map(e(y(h,p.styleGroups),p.extraStyleGroupAssoc))}}function k(h,v,p){var P=r[p.characterId];if(P){if(h==="character"||h==="hairs"||h==="eyes")return P[h];var D=P[h].get(v);if(D)return D}return o.expandId(p.packId,v)}return kt.expandOrTranslateId=k,kt}var sm=om(),rm=Ff(),Jr=Vf();function im(n,t){return{backgrounds:lm(n.backgrounds,t.backgrounds),characters:um(n.characters,t.characters),dependencies:Il(n.dependencies,t.dependencies),fonts:Yt(n.fonts,t.fonts,e=>e.id,(e,o)=>({...e,files:Il(e.files,o.files)})),poemStyles:Yt(n.poemStyles,t.poemStyles,e=>e.label,()=>{throw new Error}),poemBackgrounds:[...n.poemBackgrounds,...t.poemBackgrounds],sprites:Yt(n.sprites,t.sprites,e=>e.id,(e,o)=>({id:e.id,label:e.label,variants:[...e.variants,...o.variants],defaultScale:e.defaultScale,hd:e.hd,sdVersion:e.sdVersion??o.sdVersion})),colors:Yt(n.colors,t.colors,e=>e.color,e=>e)}}function lm(n,t){return Yt(n,t,e=>e.id,am)}function am(n,t){return{id:n.id,label:n.label,variants:[...n.variants,...t.variants],scaling:n.scaling,sdVersion:n.sdVersion??t.sdVersion}}function um(n,t){return Yt(n,t,e=>e.id,cm)}function cm(n,t){return{chibi:n.chibi,id:n.id,label:n.label,heads:pm(n.heads,t.heads),defaultScale:n.defaultScale,hd:n.hd,size:n.size,sdVersion:n.sdVersion,styleGroups:Yt(n.styleGroups,t.styleGroups,e=>e.id,(e,o)=>({id:e.id,styleComponents:Yt(e.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:dm(s.variants,r.variants)})),styles:Yt(e.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:Yt(s.poses,r.poses,i=>i.id,fm)}))}))}}function dm(n,t){const e={...n};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Object.prototype.hasOwnProperty.call(e,o)||(e[o]=t[o]));return e}function fm(n,t){const e={...n.positions};for(const o in t.positions)e[o]?e[o]=[...e[o],...t.positions[o]]:e[o]=t.positions[o];return{id:n.id,compatibleHeads:Il(n.compatibleHeads,t.compatibleHeads),previewOffset:n.previewOffset,previewSize:n.previewSize,scale:n.scale,size:n.size,renderCommands:n.renderCommands,positions:e}}function pm(n,t){const e={...n};for(const o in t){if(!Object.prototype.hasOwnProperty.call(t,o))continue;const s=t[o];if(e[o]){const r=e[o];e[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else e[o]=s}return e}function Il(n,t){const e=[...n];for(const o of t)e.includes(o)||e.push(o);return e}function Yt(n,t,e,o){const s=[...n],r=new Map(n.map((i,l)=>[e(i),l]));for(const i of t){const l=e(i);if(r.has(l)){const a=r.get(l),u=s[a];s.splice(a,1,o(u,i))}else r.set(l,s.length),s.push(i)}return s}function Eo(n,t,e){let o=t+e;const s=n.length;return o<0&&(o+=s),o>=s&&(o-=s),o}const Et=class Et{constructor(t,e,o,s){this.r=t,this.g=e,this.b=o,this.a=s,Object.freeze(this)}static validCss(t){return this.validCssRgb(t)||this.validHex(t)}static fromCss(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}static validCssRgb(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}static fromCssRgb(t){if(!this.validCssRgb(t))throw new Error("Invalid RGB color format");const e=t.slice(0,-1),o=e.indexOf("("),r=e.slice(o+1).split(",").map(i=>parseFloat(i.trim()));return new Et(r[0],r[1],r[2],r.length===4?r[3]:1)}static validHex(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}static fromHex(t){if(!this.validHex(t))throw new Error("Invalid Hex color format");const e=t.slice(1);if(e.length===3)return new Et(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),1);if(e.length===4)return new Et(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)/255);if(e.length===6)return new Et(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),1);if(e.length===8)return new Et(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),parseInt(e[6]+e[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:t,g:e,b:o}=this;const{a:s}=this;t/=255,e/=255,o/=255;const r=Math.max(t,e,o),i=Math.min(t,e,o);let l,a;const u=(r+i)/2;if(r===i)l=a=0;else{const c=r-i;switch(a=u>.5?c/(2-r-i):c/(r+i),r){case t:l=(e-o)/c+(e<o?6:0);break;case e:l=(o-t)/c+2;break;case o:l=(t-e)/c+4;break}l/=6}return new Ve(l,a,u,s)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};C(Et,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i),C(Et,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i),C(Et,"hexShortEx",/^#[0-9A-F]{3,4}$/i),C(Et,"hexLongEx",/^#[0-9A-F]{6,8}$/i);let Le=Et;class Ve{constructor(t,e,o,s){this.h=t,this.s=e,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(t){let{h:e,s:o,l:s,a:r}=this;return e+=t.h,e>=1?e-=1:e<0&&(e+=1),o+t.s>1?o-=t.s:(o+=t.s,o<0&&(o=0)),s+t.l>1||s+t.l<0?s-=t.l:s+=t.l,r+t.a>1||r+t.a<0?r-=t.a:r+=t.a,new Ve(e,o,s,r)}toRgb(){const{h:t,s:e,l:o,a:s}=this;let r,i,l;if(e===0)r=i=l=o;else{const a=o<.5?o*(1+e):o+e-o*e,u=2*o-a;r=Ve.hue2rgb(u,a,t+1/3),i=Ve.hue2rgb(u,a,t),l=Ve.hue2rgb(u,a,t-1/3)}return new Le(Math.round(r*255),Math.round(i*255),Math.round(l*255),s)}toHSL(){return this}static hue2rgb(t,e,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?t+(e-t)*6*o:o<1/2?e:o<2/3?t+(e-t)*(2/3-o)*6:t}}const xr=1280,ga=720,hm=128,vm=32,gm="rgba(60,60,60,0.8)",mm=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Uf=1,bm=1/1.5,ym=-74,wm=358,km=[200,240,400,493,640,786,880,1040,1080],Cm=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:wm,CloseUpYOffset:ym,WheelBackground:gm,characterPositions:km,hdCharacterScaleFactor:bm,positions:mm,screenHeight:ga,screenWidth:xr,sdCharacterScaleFactor:Uf,wheelInnerRadius:hm,wheelWidth:vm},Symbol.toStringTag,{value:"Module"})),_m=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),xm="#ffe6f4",Sm="#ffbde1",Pm=420,Om=22,Tm=640,qf=270,$m=7,zf=3,jm=Math.ceil(zf/2),Rm=(ga-qf)/2,Am={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Im=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Sm,ChoiceButtonColor:xm,ChoiceButtonWidth:Pm,ChoiceOuterPadding:jm,ChoicePadding:$m,ChoiceSpacing:Om,ChoiceTextStyle:Am,ChoiceX:Tm,ChoiceY:Rm,ChoiceYOffset:qf,Outline:zf,nameboxTextOutlineDelta:_m},Symbol.toStringTag,{value:"Module"})),Xf="#ffa8d2",Mm="#552222",Dm="#ffeef6",ma="#bb5599",Yf=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Gf=new Ve(.002028397565922768,0,.13725490196078438,0),Kf=.82,Jf=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Zf=12,Qf=12,Bm=.6,Em=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Lm=new Ve(0,-.14285714285714296,.3,0),Nm=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Hm=9.5,Wm=47,ep=new Ve(.0023347701149424305,0,.10784313725490202,0),Xn=3,tp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Em,controlDisableColorDelta:Lm,controlsDefaultColor:Mm,dotColorDelta:Nm,dotPatternSize:Wm,dotRadius:Hm,nameColorThreshold:Bm,nameboxBackgroundDelta:Gf,nameboxDefaultColor:Dm,nameboxGradientEndDelta:Jf,nameboxGradientMiddleStopPosition:Kf,nameboxRounding:Zf,nameboxStrokeDefaultColor:ma,nameboxTextOutlineDelta:Yf,textboxDefaultColor:Xf,textboxOutlineColorDelta:ep,textboxOutlineWidth:Xn,textboxRounding:Qf},Symbol.toStringTag,{value:"Module"})),bo=816,ba=900,Sr=146,Vm=0,Fm=29,Um=8,ms=38,Pr=44,qm=6,zm=93,Xm=404,Ym=9,Gm=9,Ln=39,bs=168,ys=34,Or=29,ya=12,wa=-126,ka=-72,Ca=-38,_a=30.75,xa=26,np=426,Ml=58,Sa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Tr={...Sa,fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:6,color:"white",letterSpacing:1},Pa={align:"left",font:"13px aller",fill:{style:"#522"}},op={...Pa,fill:{style:"#a66"}},Km={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Oa={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},yo=xr/2-bo/2,Jm=xr/2-ba/2,Zm=yo+ms,sp=yo+ys,Qm=sp+bs/2,eb=yo+wa,tb=yo+ka,nb=yo+Ca,ob="normal",sb=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:_a,ArrowYBottomOffset:xa,BaseTextStyle:Sa,ControlsTextDisabledStyle:op,ControlsTextStyle:Pa,ControlsXHistory:eb,ControlsXHistoryOffset:wa,ControlsXSkip:tb,ControlsXSkipOffset:ka,ControlsXStuff:nb,ControlsXStuffOffset:Ca,ControlsYBottomOffset:ya,DefaultTextboxStyle:ob,GlowRX:np,GlowRY:Ml,HdSideMargin:Xm,HdSpacing:zm,NameboxHeight:Ln,NameboxTextStyle:Tr,NameboxTextX:Qm,NameboxTextYOffset:Or,NameboxWidth:bs,NameboxX:sp,NameboxXOffset:ys,TextBoxBottomSpacing:qm,TextBoxCorruptedKerning:Um,TextBoxCorruptedStyle:Km,TextBoxCorruptedWidth:ba,TextBoxCorruptedX:Jm,TextBoxHeight:Sr,TextBoxKerning:Vm,TextBoxLineHeight:Fm,TextBoxStyle:Oa,TextBoxTextCorruptedXOffset:Ym,TextBoxTextCorruptedYOffset:Gm,TextBoxTextX:Zm,TextBoxTextXOffset:ms,TextBoxTextYOffset:Pr,TextBoxWidth:bo,TextBoxX:yo},Symbol.toStringTag,{value:"Module"})),rb="#ffe6f4",ib="#ffbde1",lb="rgba(255,255,255,0.6)",ab=40,ub=30,cb={...Sa,fontName:"riffic",fontSize:24,strokeColor:ma,strokeWidth:8,letterSpacing:1,color:"white"},db={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},fb=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:lb,NotificationBackgroundColor:rb,NotificationBorderColor:ib,NotificationOkTextStyle:cb,NotificationPadding:ab,NotificationSpacing:ub,NotificationTextStyle:db},Symbol.toStringTag,{value:"Module"})),rp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],pb=0,hb=0,vb=xr/2,gb=ga/2,mb=33,bb=100,yb=30,wb=800,kb=720,Cb=Uf,_b="#333333bf",xb=480,Sb=180,Pb=3,Ob=7,dn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},ip=[{...dn,name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0},{...dn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:28},{...dn,name:"Monika",fontName:"journal",fontSize:34},{...dn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32},{...dn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8},{...dn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40},{...dn,name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53},{...dn,name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1}],Tb=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:Cb,consoleBackgroundColor:_b,consoleHeight:Sb,consoleWidth:xb,defaultConsoleBackground:Pb,defaultConsoleStyle:Ob,defaultPoemBackground:pb,defaultPoemHeight:kb,defaultPoemStyle:hb,defaultPoemWidth:wb,defaultX:vb,defaultY:gb,poemBackgrounds:rp,poemBottomPadding:bb,poemPadding:yb,poemTextStyles:ip,poemTopPadding:mb},Symbol.toStringTag,{value:"Module"})),$b={Base:Cm,Choices:Im,Notification:fb,Poem:Tb,TextBox:sb,TextBoxCustom:tp},$r=1920,Ta=1080,jb=128,Rb=32,Ab="rgba(60,60,60,0.8)",Ib=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],lp=1.5,Mb=1,Db=-111,Bb=537,Eb=[300,360,600,740,960,1180,1320,1560,1620],Lb=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:Bb,CloseUpYOffset:Db,WheelBackground:Ab,characterPositions:Eb,hdCharacterScaleFactor:Mb,positions:Ib,screenHeight:Ta,screenWidth:$r,sdCharacterScaleFactor:lp,wheelInnerRadius:jb,wheelWidth:Rb},Symbol.toStringTag,{value:"Module"})),Nb=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Hb="#ffe6f4",Wb="#ffbde1",Vb=630,Fb=33,Ub=960,ap=405,qb=10.5,up=4.5,zb=Math.ceil(up/2),Xb=(Ta-ap)/2,Yb={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Gb=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:Wb,ChoiceButtonColor:Hb,ChoiceButtonWidth:Vb,ChoiceOuterPadding:zb,ChoicePadding:qb,ChoiceSpacing:Fb,ChoiceTextStyle:Yb,ChoiceX:Ub,ChoiceY:Xb,ChoiceYOffset:ap,Outline:up,nameboxTextOutlineDelta:Nb},Symbol.toStringTag,{value:"Module"})),cp="#ffa8d2",Kb="#552222",Jb="#ffeef6",$a="#bb5599",dp=new Ve(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),fp=new Ve(.002028397565922768,0,.13725490196078438,0),pp=.82,hp=new Ve(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),vp=15,gp=19,Zb=.6,Qb=new Ve(.08045977011494243,-.5714285714285714,-.5960784313725489,0),ey=new Ve(0,-.14285714285714296,.3,0),ty=new Ve(.004269293924466178,-.01869158878504662,-.039215686274509665,0),ny=9.5*1.5,oy=47*1.5,mp=new Ve(.0023347701149424305,0,.10784313725490202,0),Yn=5,bp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Qb,controlDisableColorDelta:ey,controlsDefaultColor:Kb,dotColorDelta:ty,dotPatternSize:oy,dotRadius:ny,nameColorThreshold:Zb,nameboxBackgroundDelta:fp,nameboxDefaultColor:Jb,nameboxGradientEndDelta:hp,nameboxGradientMiddleStopPosition:pp,nameboxRounding:vp,nameboxStrokeDefaultColor:$a,nameboxTextOutlineDelta:dp,textboxDefaultColor:cp,textboxOutlineColorDelta:mp,textboxOutlineWidth:Yn,textboxRounding:gp},Symbol.toStringTag,{value:"Module"})),ja=1220,yp=900,wp=219,sy=0,ry=29,iy=8,Ra=57,kp=68,ly=54,ay=9,uy=9,Aa=59,Ia=252,Ma=49,Cp=43,_p=12*1.5,xp=-126*1.5,Sp=-72*1.5,Pp=-38*1.5,Op=30.75*1.5,Tp=26*1.5,$p=426*1.5,Dl=58*1.5,Da={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},jp={...Da,fontName:"riffic",fontSize:36,strokeColor:$a,strokeWidth:9,color:"white",letterSpacing:2},or={align:"left",font:"24px aller",fill:{style:"#522"}},Rp={...or,fill:{style:"#a66"}},Ap={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},cy={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},wo=$r/2-ja/2,dy=$r/2-yp/2,fy=wo+Ra,Ip=wo+Ma,py=Ip+Ia/2,hy=wo+xp,vy=wo+Sp,gy=wo+Pp,my="custom_plus",by=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:Op,ArrowYBottomOffset:Tp,BaseTextStyle:Da,ControlsTextDisabledStyle:Rp,ControlsTextStyle:or,ControlsXHistory:hy,ControlsXHistoryOffset:xp,ControlsXSkip:vy,ControlsXSkipOffset:Sp,ControlsXStuff:gy,ControlsXStuffOffset:Pp,ControlsYBottomOffset:_p,DefaultTextboxStyle:my,GlowRX:$p,GlowRY:Dl,NameboxHeight:Aa,NameboxTextStyle:jp,NameboxTextX:py,NameboxTextYOffset:Cp,NameboxWidth:Ia,NameboxX:Ip,NameboxXOffset:Ma,TextBoxBottomSpacing:ly,TextBoxCorruptedKerning:iy,TextBoxCorruptedStyle:cy,TextBoxCorruptedWidth:yp,TextBoxCorruptedX:dy,TextBoxHeight:wp,TextBoxKerning:sy,TextBoxLineHeight:ry,TextBoxStyle:Ap,TextBoxTextCorruptedXOffset:ay,TextBoxTextCorruptedYOffset:uy,TextBoxTextX:fy,TextBoxTextXOffset:Ra,TextBoxTextYOffset:kp,TextBoxWidth:ja,TextBoxX:wo},Symbol.toStringTag,{value:"Module"})),yy="#ffe6f4",wy="#ffbde1",ky="rgba(255,255,255,0.6)",Cy=60,_y=45,xy={...Da,fontName:"riffic",fontSize:36,strokeColor:$a,strokeWidth:12,letterSpacing:1,color:"white"},Sy={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Py=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:ky,NotificationBackgroundColor:yy,NotificationBorderColor:wy,NotificationOkTextStyle:xy,NotificationPadding:Cy,NotificationSpacing:_y,NotificationTextStyle:Sy},Symbol.toStringTag,{value:"Module"})),Oy=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Ty=0,$y=0,jy=$r/2,Ry=Ta/2,Ay=26,Iy=150,My=61,Dy=1200,By=1080,Ey=lp,Ly="#333333bf",Ny=720,Hy=270,Wy=3,Vy=7,fn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},Fy=[{...fn,name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1},{...fn,name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5},{...fn,name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5},{...fn,name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48},{...fn,name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12},{...fn,name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60},{...fn,name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53},{...fn,name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1}],Uy=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:Ey,consoleBackgroundColor:Ly,consoleHeight:Hy,consoleWidth:Ny,defaultConsoleBackground:Wy,defaultConsoleStyle:Vy,defaultPoemBackground:Ty,defaultPoemHeight:By,defaultPoemStyle:$y,defaultPoemWidth:Dy,defaultX:jy,defaultY:Ry,poemBackgrounds:Oy,poemBottomPadding:Iy,poemPadding:My,poemTextStyles:Fy,poemTopPadding:Ay},Symbol.toStringTag,{value:"Module"})),qy={Base:Lb,Choices:Gb,Notification:Py,Poem:Uy,TextBox:by,TextBoxCustom:bp};function fe(){return ve.gameMode==="ddlc_plus"?qy:$b}const is=Jt(Object.seal({lqRendering:!0,nsfw:!1,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,loadSave(n){},getSave(n){return{}},copyObjectToClipboard(n,t){const e=H.panels.panels[n],o=Object.values(e.objects),s=new Set;for(const a of t){const u=e.objects[a];s.add(u),l(u,u)}const r=Array.from(s).map(a=>a.save()),i=JSON.stringify(r);this.clipboard=i,navigator.clipboard.writeText(i);function l(a,u,c=!0){if(!c&&a===u)throw new Error("Recursively linked object");for(const f of o)f.linkedTo===a.id&&(s.add(f),l(f,u,!1))}},async pasteObjects(n){let t;try{const e=await navigator.clipboard.readText();t=JSON.parse(e)}catch{if(is.clipboard==null)return;t=JSON.parse(is.clipboard)}n.pasteObjects(t)}}));function sr(n,t,e){return n>t?n:t>e?e:t}function so(n,t){return(n%t+t)%t}function zy(n,t){return n===null&&t===null?!0:n===null||t===null?!1:n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d&&n.e===t.e&&n.f===t.f}function Mp(n){const{a:t,b:e,c:o,d:s,e:r,f:i}=n,l=t*s-e*o,a={x:r,y:i,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const u=Math.sqrt(t*t+e*e);a.rotation=(e>0?Math.acos(t/u):-Math.acos(t/u))/Math.PI*180,a.scaleX=u,a.scaleY=l/u,a.skewX=Math.atan((t*o+e*s)/(u*u))/Math.PI*180,a.skewY=0}else if(o!=0||s!=0){const u=Math.sqrt(o*o+s*s);a.rotation=(Math.PI/2-(s>0?Math.acos(-o/u):-Math.acos(o/u)))/Math.PI*180,a.scaleX=l/u,a.scaleY=u,a.skewX=0,a.skewY=Math.atan((t*o+e*s)/(u*u))/Math.PI*180}return a}var jn={},Zr={},Uu;function Xy(){return Uu||(Uu=1,Object.defineProperty(Zr,"__esModule",{value:!0})),Zr}var Qr={},qu;function Yy(){return qu||(qu=1,Object.defineProperty(Qr,"__esModule",{value:!0})),Qr}var ei={},zu;function Gy(){return zu||(zu=1,Object.defineProperty(ei,"__esModule",{value:!0})),ei}var ti={},Xu;function Ky(){return Xu||(Xu=1,Object.defineProperty(ti,"__esModule",{value:!0})),ti}var ni={},Yu;function Jy(){return Yu||(Yu=1,Object.defineProperty(ni,"__esModule",{value:!0})),ni}var oi={},Gu;function Zy(){return Gu||(Gu=1,Object.defineProperty(oi,"__esModule",{value:!0})),oi}var si={},Ku;function Qy(){return Ku||(Ku=1,Object.defineProperty(si,"__esModule",{value:!0})),si}var ri={},Ju;function e0(){return Ju||(Ju=1,Object.defineProperty(ri,"__esModule",{value:!0})),ri}var ii={},Zu;function t0(){return Zu||(Zu=1,Object.defineProperty(ii,"__esModule",{value:!0})),ii}var li={},Qu;function n0(){return Qu||(Qu=1,Object.defineProperty(li,"__esModule",{value:!0})),li}var ai={},ec;function o0(){return ec||(ec=1,Object.defineProperty(ai,"__esModule",{value:!0})),ai}var ui={},tc;function s0(){return tc||(tc=1,Object.defineProperty(ui,"__esModule",{value:!0})),ui}var ci={},nc;function r0(){return nc||(nc=1,Object.defineProperty(ci,"__esModule",{value:!0})),ci}var di={},oc;function i0(){return oc||(oc=1,Object.defineProperty(di,"__esModule",{value:!0})),di}var fi={},sc;function l0(){return sc||(sc=1,Object.defineProperty(fi,"__esModule",{value:!0})),fi}var pi={},rc;function a0(){return rc||(rc=1,Object.defineProperty(pi,"__esModule",{value:!0})),pi}var hi={},ic;function u0(){return ic||(ic=1,Object.defineProperty(hi,"__esModule",{value:!0})),hi}var vi={},lc;function c0(){return lc||(lc=1,Object.defineProperty(vi,"__esModule",{value:!0})),vi}var gi={},ac;function d0(){return ac||(ac=1,Object.defineProperty(gi,"__esModule",{value:!0})),gi}var mi={},uc;function f0(){return uc||(uc=1,Object.defineProperty(mi,"__esModule",{value:!0})),mi}var bi={},cc;function p0(){return cc||(cc=1,Object.defineProperty(bi,"__esModule",{value:!0})),bi}var yi={},dc;function h0(){return dc||(dc=1,Object.defineProperty(yi,"__esModule",{value:!0})),yi}var wi={},fc;function v0(){return fc||(fc=1,Object.defineProperty(wi,"__esModule",{value:!0})),wi}var ki={},pc;function g0(){return pc||(pc=1,Object.defineProperty(ki,"__esModule",{value:!0})),ki}var Ci={},hc;function m0(){return hc||(hc=1,Object.defineProperty(Ci,"__esModule",{value:!0})),Ci}var _i={},vc;function b0(){return vc||(vc=1,Object.defineProperty(_i,"__esModule",{value:!0})),_i}var xi={},gc;function y0(){return gc||(gc=1,Object.defineProperty(xi,"__esModule",{value:!0})),xi}var Si={},mc;function w0(){return mc||(mc=1,Object.defineProperty(Si,"__esModule",{value:!0})),Si}var Pi={},bc;function k0(){return bc||(bc=1,Object.defineProperty(Pi,"__esModule",{value:!0})),Pi}var Oi={},yc;function C0(){return yc||(yc=1,Object.defineProperty(Oi,"__esModule",{value:!0})),Oi}var Ti={},wc;function _0(){return wc||(wc=1,Object.defineProperty(Ti,"__esModule",{value:!0})),Ti}var $i={},kc;function x0(){return kc||(kc=1,Object.defineProperty($i,"__esModule",{value:!0})),$i}var ji={},Cc;function S0(){return Cc||(Cc=1,Object.defineProperty(ji,"__esModule",{value:!0})),ji}var Ri={},_c;function P0(){return _c||(_c=1,Object.defineProperty(Ri,"__esModule",{value:!0})),Ri}var Ai={},xc;function O0(){return xc||(xc=1,Object.defineProperty(Ai,"__esModule",{value:!0})),Ai}var Ii={},Sc;function T0(){return Sc||(Sc=1,Object.defineProperty(Ii,"__esModule",{value:!0})),Ii}var Mi={},Pc;function $0(){return Pc||(Pc=1,Object.defineProperty(Mi,"__esModule",{value:!0})),Mi}var Di={},Oc;function j0(){return Oc||(Oc=1,Object.defineProperty(Di,"__esModule",{value:!0})),Di}var Bi={},Tc;function R0(){return Tc||(Tc=1,Object.defineProperty(Bi,"__esModule",{value:!0})),Bi}var Ei={},$c;function A0(){return $c||($c=1,Object.defineProperty(Ei,"__esModule",{value:!0})),Ei}var Li={},jc;function I0(){return jc||(jc=1,Object.defineProperty(Li,"__esModule",{value:!0})),Li}var Ni={},Rc;function M0(){return Rc||(Rc=1,Object.defineProperty(Ni,"__esModule",{value:!0})),Ni}var Hi={},Ac;function D0(){return Ac||(Ac=1,Object.defineProperty(Hi,"__esModule",{value:!0})),Hi}var Wi={},Ic;function B0(){return Ic||(Ic=1,Object.defineProperty(Wi,"__esModule",{value:!0})),Wi}var Vi={},Mc;function E0(){return Mc||(Mc=1,Object.defineProperty(Vi,"__esModule",{value:!0})),Vi}var Fi={},Dc;function L0(){return Dc||(Dc=1,Object.defineProperty(Fi,"__esModule",{value:!0})),Fi}var Ui={},Bc;function N0(){return Bc||(Bc=1,Object.defineProperty(Ui,"__esModule",{value:!0})),Ui}var qi={},Ec;function H0(){return Ec||(Ec=1,Object.defineProperty(qi,"__esModule",{value:!0})),qi}var zi={},Lc;function W0(){return Lc||(Lc=1,Object.defineProperty(zi,"__esModule",{value:!0})),zi}var Xi={},Nc;function V0(){return Nc||(Nc=1,Object.defineProperty(Xi,"__esModule",{value:!0})),Xi}var Yi={},Hc;function F0(){return Hc||(Hc=1,Object.defineProperty(Yi,"__esModule",{value:!0})),Yi}var Gi={},Wc;function U0(){return Wc||(Wc=1,Object.defineProperty(Gi,"__esModule",{value:!0})),Gi}var Ki={},Vc;function q0(){return Vc||(Vc=1,Object.defineProperty(Ki,"__esModule",{value:!0})),Ki}var Ji={},Fc;function z0(){return Fc||(Fc=1,Object.defineProperty(Ji,"__esModule",{value:!0})),Ji}var Zi={},Uc;function X0(){return Uc||(Uc=1,Object.defineProperty(Zi,"__esModule",{value:!0})),Zi}var Qi={},qc;function Y0(){return qc||(qc=1,Object.defineProperty(Qi,"__esModule",{value:!0})),Qi}var el={},zc;function G0(){return zc||(zc=1,Object.defineProperty(el,"__esModule",{value:!0})),el}var tl={},Xc;function K0(){return Xc||(Xc=1,Object.defineProperty(tl,"__esModule",{value:!0})),tl}var nl={},Yc;function J0(){return Yc||(Yc=1,Object.defineProperty(nl,"__esModule",{value:!0})),nl}var ol={},Gc;function Z0(){return Gc||(Gc=1,Object.defineProperty(ol,"__esModule",{value:!0})),ol}var sl={},Kc;function Q0(){return Kc||(Kc=1,Object.defineProperty(sl,"__esModule",{value:!0})),sl}var rl={},Jc;function ew(){return Jc||(Jc=1,Object.defineProperty(rl,"__esModule",{value:!0})),rl}var il={},Zc;function tw(){return Zc||(Zc=1,Object.defineProperty(il,"__esModule",{value:!0})),il}var ll={},Qc;function nw(){return Qc||(Qc=1,Object.defineProperty(ll,"__esModule",{value:!0})),ll}var al={},ed;function ow(){return ed||(ed=1,Object.defineProperty(al,"__esModule",{value:!0})),al}var Oo={},td;function sw(){if(td)return Oo;td=1,Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.UnreachableCaseError=void 0;class n extends Error{constructor(e){super(`Unreachable case: ${e}`)}}return Oo.UnreachableCaseError=n,Oo}var To={},nd;function rw(){if(nd)return To;nd=1,Object.defineProperty(To,"__esModule",{value:!0}),To.assert=void 0;function n(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}return To.assert=n,To}var $o={},od;function iw(){if(od)return $o;od=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.createFactoryWithConstraint=void 0;const n=()=>t=>t;return $o.createFactoryWithConstraint=n,$o}var jo={},sd;function lw(){if(sd)return jo;sd=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.isExact=void 0;const n=()=>t=>t;return jo.isExact=n,jo}var Ro={},rd;function aw(){if(rd)return Ro;rd=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.noop=void 0;function n(...t){}return Ro.noop=n,Ro}var ul={},id;function uw(){return id||(id=1,Object.defineProperty(ul,"__esModule",{value:!0})),ul}var ld;function cw(){return ld||(ld=1,function(n){var t=jn&&jn.__createBinding||(Object.create?function(o,s,r,i){i===void 0&&(i=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,i,l)}:function(o,s,r,i){i===void 0&&(i=r),o[i]=s[r]}),e=jn&&jn.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(n,"__esModule",{value:!0}),e(Xy(),n),e(Yy(),n),e(Gy(),n),e(Ky(),n),e(Jy(),n),e(Zy(),n),e(Qy(),n),e(e0(),n),e(t0(),n),e(n0(),n),e(o0(),n),e(s0(),n),e(r0(),n),e(i0(),n),e(l0(),n),e(a0(),n),e(u0(),n),e(c0(),n),e(d0(),n),e(f0(),n),e(p0(),n),e(h0(),n),e(v0(),n),e(g0(),n),e(m0(),n),e(b0(),n),e(y0(),n),e(w0(),n),e(k0(),n),e(C0(),n),e(_0(),n),e(x0(),n),e(S0(),n),e(P0(),n),e(O0(),n),e(T0(),n),e($0(),n),e(j0(),n),e(R0(),n),e(A0(),n),e(I0(),n),e(M0(),n),e(D0(),n),e(B0(),n),e(E0(),n),e(L0(),n),e(N0(),n),e(H0(),n),e(W0(),n),e(V0(),n),e(F0(),n),e(U0(),n),e(q0(),n),e(z0(),n),e(X0(),n),e(Y0(),n),e(G0(),n),e(K0(),n),e(J0(),n),e(Z0(),n),e(Q0(),n),e(ew(),n),e(tw(),n),e(nw(),n),e(ow(),n),e(sw(),n),e(rw(),n),e(iw(),n),e(lw(),n),e(aw(),n),e(uw(),n)}(jn)),jn}var Kt=cw();const ad=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);class Ba{constructor(){C(this,"_filters",I([]));C(this,"_composite",I("source-over"))}get filters(){return this._filters.value}get composite(){return this._composite.value}set composite(t){this._composite.value,We(()=>void(this._composite.value=t))}addFilter(t,e){let o;switch(t){case"hue-rotate":o=new ls(t,0);break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":o=new ls(t,1);break;case"drop-shadow":o=new jr;break;default:throw new Kt.UnreachableCaseError(t)}const s=this._filters.value;We(()=>void s.splice(e,0,yt(o)))}removeFilter(t){const e=this._filters.value;e[t],We(()=>void e.splice(t,1))}moveFilter(t,e){const o=this._filters.value,s=o[t];We(()=>{o.splice(t,1),o.splice(t+e,0,s)})}}class ls{constructor(t,e=0){C(this,"_value");this.type=t,this._value=I(e)}get value(){return this._value.value}set value(t){this.value,We(()=>void(this._value.value=t))}clone(){return new ls(this.type,this.value)}getSave(){return{type:this.type,value:this.value}}}class jr{constructor(){C(this,"type","drop-shadow");C(this,"_offsetX",I(10));C(this,"_offsetY",I(10));C(this,"_blurRadius",I(0));C(this,"_color",I("#555555"))}get offsetX(){return this._offsetX.value}set offsetX(t){this._offsetX.value,We(()=>void(this._offsetX.value=t))}get offsetY(){return this._offsetY.value}set offsetY(t){this._offsetY.value,We(()=>void(this._offsetY.value=t))}get blurRadius(){return this._blurRadius.value}set blurRadius(t){this._blurRadius.value,We(()=>void(this._blurRadius.value=t))}get color(){return this._color.value}set color(t){this._color.value,We(()=>void(this._color.value=t))}clone(){const t=new jr;return t._offsetX.value=this._offsetX.value,t._offsetY.value=this._offsetY.value,t._blurRadius.value=this._blurRadius.value,t._color.value=this._color.value,t}getSave(){return{type:"drop-shadow",offsetX:this._offsetX.value,offsetY:this._offsetY.value,blurRadius:this._blurRadius.value,color:this._color.value}}}function Ea(n){const t=[];for(const e of n)if(e.type==="drop-shadow"){const o=new jr;o.offsetX=e.offsetX,o.offsetY=e.offsetY,o.blurRadius=e.blurRadius,o.color=e.color,t.push(yt(o))}else{const o=new ls(e.type,e.value);t.push(yt(o))}return t}class ko extends Ba{constructor(e,o,s){super();C(this,"panelId");C(this,"id");C(this,"_onTop",B({get:()=>this.panel.topOrder.includes(this.id),set:e=>{this.panel.setOnTop(this,e)}}));C(this,"_version",I(0));C(this,"_x");C(this,"_y",I(0));C(this,"_width",I(0));C(this,"_height",I(0));C(this,"_preserveRatio",I(!0));C(this,"_ratio",I(1));C(this,"_flip",I(!1));C(this,"_linkedTo",I(null));C(this,"_scaleX",I(1));C(this,"_scaleY",I(1));C(this,"_skewX",I(0));C(this,"_skewY",I(0));C(this,"_rotation",I(0));C(this,"_isTalking",B(()=>!!Object.values(this.panel.objects).find(e=>e.type==="textBox"&&e.talkingObjId===this.id)));C(this,"_localTransform",B(()=>{let e=new DOMMatrix;e=e.translate(this.x,this.y);const o=this.height/2*this.scaleX;return"close"in this&&this.close&&(e=e.translate(0,fe().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&this.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),this.rotation!==0&&(e=e.rotate(0,0,this.rotation)),this.skewX!==0&&(e=e.skewX(this.skewX)),this.skewY!==0&&(e=e.skewY(this.skewY)),this.flip&&(e=e.flipX()),(this.scaleX!==1||this.scaleY!==1)&&(e=e.scale(this.scaleX,this.scaleY)),e}));C(this,"_globalTransform",B(()=>{if(this._linkedTo.value){const e=this.panel.objects[this._linkedTo.value];return e?e.globalTransform.multiply(this.localTransform):this.localTransform}else return this.localTransform}));C(this,"_label",I(null));C(this,"_textboxColor",I(null));C(this,"_enlargeWhenTalking",I(!1));C(this,"_nameboxWidth",I(null));this.panel=e,this.panelId=e.id,s==null&&(s=e.lastObjId+1),this.id=s;const r=fe();this._x=I(r.Base.screenWidth/2),e.insertObject(this,o)}mutate(e,o){this._version.value;const s=this._version.value+1;e.value!==o&&We(()=>{e.value=o,this._version.value=s})}mutateX(e,o){this._version.value;const s=this._version.value+1,r=e.map(i=>i.value);for(let i=0;i<e.length;i++)e[i].value===o[i]&&(e.splice(i,1),o.splice(i,1),r.splice(i,1));e.length!==0&&We(()=>{for(let i=0;i<e.length;i++)e[i].value=o[i];this._version.value=s})}prepareSiblingRemoval(e){this.linkedTo===e.id&&(this.linkedTo=null)}get version(){return this._version.value}get x(){return this._x.value}set x(e){this.mutate(this._x,e)}get y(){return this._y.value}set y(e){this.mutate(this._y,e)}get width(){return this._width.value}set width(e){this.mutate(this._width,e)}get height(){return this._height.value}set height(e){this.mutate(this._height,e)}get preserveRatio(){return this._preserveRatio.value}set preserveRatio(e){this.mutateX([this._preserveRatio,this._ratio],[e,e?this.width/this.height:0])}get ratio(){return this._ratio.value}get flip(){return this._flip.value}set flip(e){this.mutate(this._flip,e)}get onTop(){return this._onTop.value}set onTop(e){this._onTop.value=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){if(this.linkedTo!==e)if(e!==null){if(e===this.id)throw new Error("Object cannot link to itself.");const o=this.panel.objects[e];let s=o;for(;s.linkedTo!==null;){if(s.linkedTo===this.id)throw new Error("Objects cannot be linked recursively.");s=this.panel.objects[s.linkedTo]}const i=o.globalTransform.inverse().multiply(this.globalTransform);this.mutateByMatrix(i),this.mutate(this._linkedTo,e)}else this.mutateByMatrix(this.globalTransform),this.mutate(this._linkedTo,null)}mutateByMatrix(e){const o=Mp(e);this.mutateX([this._scaleX,this._scaleY,this._skewX,this._skewY,this._rotation,this._x,this._y],[ct(o.scaleX),ct(o.scaleY),ct(o.skewX),ct(o.skewY),ct(o.rotation),ct(o.x),ct(o.y)])}get scaleX(){return this._scaleX.value}set scaleX(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[ct(e),ct(e*this.ratio)]):this.mutate(this._scaleX,ct(e))}get scaleY(){return this._scaleY.value}set scaleY(e){this.preserveRatio?this.mutateX([this._scaleX,this._scaleY],[ct(e/this.ratio),ct(e)]):this.mutate(this._scaleY,ct(e))}get skewX(){return this._skewX.value}set skewX(e){this.mutate(this._skewX,ct(so(e,180)))}get skewY(){return this._skewY.value}set skewY(e){this.mutate(this._skewY,ct(so(e,180)))}get rotation(){return this._rotation.value}set rotation(e){this.mutate(this._rotation,ct(so(e,360)))}get isTalking(){return this._isTalking.value}get localTransform(){return this._localTransform.value}get globalTransform(){return this._globalTransform.value}get label(){return this._label.value}set label(e){this.mutate(this._label,e)}get textboxColor(){return this._textboxColor.value}set textboxColor(e){this.mutate(this._textboxColor,e)}get enlargeWhenTalking(){return this._enlargeWhenTalking.value}set enlargeWhenTalking(e){this.mutate(this._enlargeWhenTalking,e)}get nameboxWidth(){return this._nameboxWidth.value}set nameboxWidth(e){this.mutate(this._nameboxWidth,e)}fixContentPackRemoval(e){}moveAllRefs(e,o){for(const[s,r]of Object.entries(e))ge(r)&&(s==="_filters"?o[s].value=r.value.map(i=>yt(i.clone())):s==="_choices"?o[s].value=r.value.map(i=>({...i})):o[s].value=r.value)}loadPropsFromSave(e,o){for(const[s,r]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(s.startsWith("_")){const i=r.value,l=s.substring(1);if(l==="version")continue;l in e&&ge(i)&&!ln(i)&&!("effect"in i)&&(l==="linkedTo"?i.value=o.get(e[l]):l==="filters"?i.value=Ea(e[l]):i.value=e[l])}}save(){const e={id:this.id,type:this.type,panelId:this.panelId,onTop:this.onTop};for(const[o,s]of Object.entries(Object.getOwnPropertyDescriptors(this)))if(o.startsWith("_")){const r=s.value;ge(r)&&!ln(r)&&!("effect"in r)&&(o==="_filters"?e.filters=r.value.map(i=>i.getSave()):e[o.substring(1)]=r.value)}return e}}function ct(n){return Math.round(n*100)/100}let Dp=class Is extends ko{constructor(e,o,s,r){super(e,r??!1,s);C(this,"_freeMove",I(!1));C(this,"_close",I(!1));C(this,"_styleGroupId",I(0));C(this,"_styleId",I(0));C(this,"_poseId",I(0));C(this,"_posePositions",I({}));C(this,"_characterData",B(()=>At.characters.get(this.characterType)));C(this,"_poseData",B(()=>{var e,o,s;return(s=(o=(e=this._characterData.value)==null?void 0:e.styleGroups[this._styleGroupId.value])==null?void 0:o.styles[this._styleId.value])==null?void 0:s.poses[this._poseId.value]}));C(this,"_headData",B(()=>{var o,s;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:(s=this._characterData.value)==null?void 0:s.heads[e[0]]}));C(this,"_availablePartsKeys",B(()=>{const e=this._poseData.value;if(!e)return[];const o=Object.keys(e.positions).filter(s=>e.positions[s].length>1);return e.compatibleHeads.length>0&&o.unshift("head"),o}));C(this,"_heads",B(()=>{var o;const e=(o=this._poseData.value)==null?void 0:o.compatibleHeads;return e==null||e.length===0?null:this._characterData.value.heads[e[this.posePositions.headType||0]]}));this.characterType=o;const i=fe(),l=this.charData,a=l.hd?i.Base.hdCharacterScaleFactor:i.Base.sdCharacterScaleFactor;this._y.value=i.Base.BaseCharacterYPos,this._width.value=l.size[0],this._height.value=l.size[1],this._scaleX.value=l.defaultScale[0]*a,this._scaleY.value=l.defaultScale[1]*a,this._label.value=l.label??l.id,this._enlargeWhenTalking.value=is.defaultCharacterTalkingZoom}get type(){return"character"}static create(e,o){return new Is(e,o)}makeClone(e,o){const s=new Is(e,this.characterType,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Is(e,o.characterType,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.characterType=this.characterType,e}get freeMove(){return this._freeMove.value}set freeMove(e){if(!(!e&&this.linkedTo!=null))if(e)this.mutate(this._freeMove,!0);else{const o=fe();this.mutateX([this._freeMove,this._x,this._y],[!1,o.Base.characterPositions[Ms(this.x)],o.Base.BaseCharacterYPos])}}get x(){return this._x.value}set x(e){this.freeMove||(e=fe().Base.characterPositions[Ms(e)]),super.x=e}get y(){return this._y.value}set y(e){this.freeMove||(e=fe().Base.BaseCharacterYPos),super.y=e}get linkedTo(){return this._linkedTo.value}set linkedTo(e){super.linkedTo=e,this._linkedTo.value!=null&&this.mutate(this._freeMove,!0)}shiftCharacterSlot(e){const o=fe();let r=Ms(this.x)+e;r<0&&(r=0),r>=o.Base.characterPositions.length&&(r=o.Base.characterPositions.length-1),this.x=o.Base.characterPositions[r]}get close(){return this._close.value}set close(e){this.mutate(this._close,e)}get styleId(){return this._styleId.value}set styleId(e){this.mutate(this._styleId,e)}get styleGroupId(){return this._styleGroupId.value}get posePositions(){return this._posePositions.value}get poseId(){return this._poseId.value}setPosePosition(e){this.mutate(this._posePositions,{...this._posePositions.value,...e})}seekPart(e,o){if(e==="head"){this.seekHead(o);return}const s=this._poseData.value;s.positions[e]&&this.setPosePosition({[e]:Eo(s.positions[e],this.posePositions[e]||0,o)})}seekPose(e){const s=this._characterData.value.styleGroups[this._styleGroupId.value].styles[this.styleId].poses;this.mutatePoseAndPositions(r=>{r.poseId=Eo(s,r.poseId,e)})}seekStyle(e){const s=this._characterData.value.styleGroups.flatMap((i,l)=>i.styles.map((a,u)=>({styleGroupIdx:l,styleIdx:u,styleGroupJson:JSON.stringify(a.components)}))).sort((i,l)=>i.styleGroupJson.localeCompare(l.styleGroupJson)),r=s.findIndex(i=>i.styleGroupIdx===this.styleGroupId&&i.styleIdx===this.styleId);this.mutatePoseAndPositions(i=>{const l=Eo(s,r,e),a=s[l];i.styleGroupId=a.styleGroupIdx,i.styleId=a.styleIdx})}seekHead(e){const o=this._characterData.value,s=this._poseData.value,r=this.posePositions;if(s.compatibleHeads.length===0)return null;let i=r.headType||0,l=o.heads[s.compatibleHeads[i]];if(!l)return;let a=(r.head||0)+e;(a<0||a>=l.variants.length)&&(i=Eo(s.compatibleHeads.map(u=>o.heads[u]),i,e),l=o.heads[s.compatibleHeads[i]],a=e===1?0:l.variants.length-1),this.setPosePosition({head:a,headType:i})}setPart(e,o){e==="pose"?this.mutatePoseAndPositions(s=>{s.poseId=o}):e==="style"?this.mutatePoseAndPositions(s=>{s.styleId=o}):this.mutatePoseAndPositions(s=>{s.posePositions[e]=o})}setCharStyle(e,o){this.mutatePoseAndPositions(s=>{s.styleGroupId=e,s.styleId=o})}get charData(){return this._characterData.value}get poseData(){return this._poseData.value}get availablePartsKeys(){return this._availablePartsKeys.value}mutatePoseAndPositions(e){const o=this._characterData.value,s=this.buildPoseAndPositionData();e(s),o.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=o.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const i=r.styles[s.styleId];i.poses[s.poseId]||(s.poseId=0);const l=i.poses[s.poseId];for(const f in l.positions)l.positions[f]&&(l.positions[f][s.posePositions[f]]||(s.posePositions[f]=0));const u=o.styleGroups[this._styleGroupId.value].styles[this.styleId].poses[this._poseId.value].compatibleHeads[this._posePositions.value.headType||0],c=l.compatibleHeads.indexOf(u);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),this.commitPoseAndPositionChanges(s)}commitPoseAndPositionChanges(e){JSON.stringify(e.posePositions)!==JSON.stringify(this._posePositions.value)&&this.mutate(this._posePositions,e.posePositions),this.mutateX([this._styleGroupId,this._styleId,this._poseId],[e.styleGroupId,e.styleId,e.poseId])}buildPoseAndPositionData(){return{styleGroupId:this._styleGroupId.value,styleId:this._styleId.value,poseId:this._poseId.value,posePositions:{...this._posePositions.value}}}get headsData(){return this._heads.value}};function Ms(n){return fe().Base.characterPositions.map((o,s)=>({pos:Math.abs(n-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}let Bp=class Ds extends ko{constructor(e,o,s){super(e,s??!0,o);C(this,"_customColor");C(this,"_choices",I([{selected:!1,text:"Click here to edit choice"}]));C(this,"_choiceDistance");C(this,"_autoWrap",I(!0));const r=fe();this._choiceDistance=I(r.Choices.ChoiceSpacing),this._customColor=I(r.Choices.ChoiceButtonColor),this._y.value=r.Choices.ChoiceY,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"choice"}static create(e){return new Ds(e)}makeClone(e,o){const s=new Ds(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Ds(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get choices(){return this._choices.value}addChoice(e){const o={selected:!1,text:e};We(()=>void this._choices.value.push(o))}removeChoice(e){this._choices.value[e],We(()=>void this._choices.value.splice(e,1))}setChoiceProperty(e,o,s){this._choices.value[e][o];const r=this._version.value;We(()=>{this._choices.value[e][o]=s,this._version.value=r+1})}get choiceDistance(){return this._choiceDistance.value}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}},Ep=class Bs extends ko{constructor(e,o,s){super(e,s??!0,o);C(this,"_text",I("Click here to edit notification"));C(this,"_autoWrap",I(!1));C(this,"_backdrop",I(!0));C(this,"_customColor");const r=fe();this._customColor=I(r.Choices.ChoiceButtonColor),this._y.value=r.Base.screenHeight/2,this._width.value=r.Choices.ChoiceButtonWidth,this._height.value=0}get type(){return"notification"}static create(e){return new Bs(e)}makeClone(e,o){const s=new Bs(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Bs(e,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get backdrop(){return this._backdrop.value}set backdrop(e){this.mutate(this._backdrop,e)}},Bl=class Lo extends ko{constructor(e,o,s,r){super(e,r??!0,s);C(this,"_autoWrap",I(!0));C(this,"_overflow",I(!1));C(this,"_text",I(""));C(this,"_background",I(0));C(this,"_font",I(0));C(this,"_consoleColor",I(null));this.subtype=o;const i=fe();o==="poem"?(this._x.value=i.Poem.defaultX,this._y.value=i.Poem.defaultY,this._height.value=i.Poem.defaultPoemHeight,this._width.value=i.Poem.defaultPoemWidth,this._background.value=i.Poem.defaultPoemBackground,this._font.value=i.Poem.defaultPoemStyle,this._text.value=`New poem

Click here to edit poem`):(this._x.value=i.Poem.consoleWidth/2,this._y.value=i.Poem.consoleHeight/2,this._height.value=i.Poem.consoleHeight,this._width.value=i.Poem.consoleWidth,this._background.value=i.Poem.defaultConsoleBackground,this._font.value=i.Poem.defaultConsoleStyle,this._text.value=`> _
  
  Console command
  Click here to edit`)}get type(){return"poem"}static createPoem(e){return new Lo(e,"poem")}static createConsole(e){return new Lo(e,"console")}makeClone(e,o){const s=new Lo(e,this.subtype,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new Lo(e,o.subtype,s.get(o.id),o.onTop);return r.loadPropsFromSave(o,s),r}save(){const e=super.save();return e.subtype=this.subtype,e}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get background(){return this._background.value}set background(e){this.mutate(this._background,e)}get font(){return this._font.value}set font(e){this.mutate(this._font,e)}get consoleColor(){return this._consoleColor.value}set consoleColor(e){this.mutate(this._consoleColor,e)}};class Nn{constructor(t){C(this,"width");C(this,"height");this.html=t,this.width=t.width,this.height=t.height}paintOnto(t,e={}){const{w:o,h:s}={w:this.width,h:this.height,...e},{x:r,y:i}={x:-o/2,y:-s/2,...e};t.drawImage(this.html,r,i,o,s)}}let La=class Es extends ko{constructor(t,e,o,s,{width:r,height:i}={}){super(t,s??!1,o),this.assets=e,r!=null&&(this._width.value=r),i!=null&&(this._height.value=i);const l=fe();this._y.value=l.Base.screenHeight/2,this._enlargeWhenTalking.value=is.defaultCharacterTalkingZoom}get type(){return"sprite"}static async create(t,e){const o=await Fa(e[0],!1);if(o instanceof Nn)return new Es(t,e,void 0,!1,{width:o.width,height:o.height})}makeClone(t,e){const o=new Es(t,this.assets,e.get(this.id));return this.moveAllRefs(this,o),o}static fromSave(t,e,o){const s=new Es(t,e.assets,o.get(e.id),e.onTop);return s.loadPropsFromSave(e,o),s}save(){const t=super.save();return t.assets=this.assets,t}};const ud=5;class dw{constructor(t){C(this,"pos",0);this.str=t}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-ud),this.pos+ud)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function cd(n,t=!0){const e=[],o=new dw(n);let s=Rr;for(;s!==Ar;){const r=o.pos;try{s=s(e,o)}catch(i){if(t&&s!==El)o.pos=r,s=(l,a)=>El(l,a,!0);else throw i}}return e}function Rr(n,t){return t.current()===void 0?Ar:t.current()==="{"?fw:t.current()===`
`?pw:El}function Ar(){return Ar}function El(n,t,e=!1){const{pos:o}=t;let s="",r=e,i;for(;;){if(t.current()===void 0){i=Ar;break}else if(r)s+=t.current(),r=!1;else if(t.current()==="\\")r=!0;else if(t.current()==="{"||t.current()===`
`){i=Rr;break}else s+=t.current();t.next()}return n.push({type:"text",pos:o,content:s}),i}function cl(n,t){throw new Error(`Error when parsing text at position ${n.pos}: (around: "${n.around}") ${t}`)}function fw(n,t){const{pos:e}=t;if(t.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=t.next()==="/";o&&t.next();let s="",r="",i=!1;for(;t.current()===void 0&&cl(t,"Unexpected end of text inside a command"),t.current()!=="}";)i?r+=t.current():t.current().match(/[a-z]/i)?s+=t.current():t.current()==="="?(o&&cl(t,"Closing commands may not contain arguments"),i=!0):cl(t,`Unexpected character '${t.current()}' in command name.`),t.next();return t.next(),o?n.push({type:"commandClose",commandName:s,pos:e}):n.push({type:"command",pos:e,argument:r,commandName:s}),Rr}function pw(n,t){return n.push({type:"newline",pos:t.pos}),t.next(),Rr}function co(n){n.width=0,n.height=0,Na.delete(n.disposalId||0)}function Hn(){const n=document.createElement("canvas");return vw(n),n}const Na=new Map;let hw=0;function vw(n){n.disposalId=hw++,!(typeof WeakRef>"u")&&Na.set(n.disposalId,new WeakRef(n))}window.addEventListener("unload",()=>{Na.forEach(n=>{const t=n.deref();t&&co(t)})});const dd=new Map([qn("i",n=>({...n,isItalic:!0})),qn("b",n=>({...n,isBold:!0})),qn("u",n=>({...n,isUnderlined:!0})),qn("s",n=>({...n,isStrikethrough:!0})),qn("plain",n=>({...n,isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),qn("edited",n=>({...n,fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),Ps("k",(n,t,e)=>({...n,letterSpacing:t?n.letterSpacing+e:e})),Ps("size",(n,t,e)=>({...n,fontSize:t?n.fontSize+e:e})),Ps("alpha",(n,t,e)=>({...n,alpha:t?n.alpha+e:e})),Ps("stroke",(n,t,e)=>({...n,strokeWidth:t?n.strokeWidth+e:e})),["font",(n,t)=>({...n,fontName:t})],["color",(n,t)=>({...n,color:t})],["outlinecolor",(n,t)=>({...n,strokeColor:t})]]);function qn(n,t){return[n,(e,o)=>{if(o!=="")throw new Error(`Operator '${n}' does not take any arguments.`);return t(e)}]}function Ps(n,t){return[n,(e,o)=>{if(o=="")throw new Error(`Operator '${n}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${n}' needs a numeric argument.`);return t(e,s,r)}]}class Dt{constructor(t,e){C(this,"renderParts");C(this,"tokens");C(this,"loose");C(this,"lastLayoutHeight",null);C(this,"lastLayoutWidth",null);this.str=t,this.baseStyle=e,this.loose=ve.state.looseTextParsing;try{this.tokens=cd(t,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=Dt.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const t=new Set;let e=null;for(const s of this.renderParts)"style"in s&&s.style!==e&&(e=s.style,e.fontName&&t.add(e.fontName));const o=[];for(const s of t){const r=document,i=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(i)||o.push(r.fonts.load(i))}if(o.length!==0)return Promise.all(o).then(()=>{const s=cd(this.str);this.renderParts=Dt.getRenderParts(s,this.baseStyle,this.loose)})}render(t){t.save();let e=null;for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),e.strokeWidth>0&&e.strokeColor>""&&t.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type==="character"&&(o.style!==e&&(e=o.style,Ll(e,t)),t.fillText(o.character,o.x,o.y));t.restore()}quote(){let t;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(t||(t={}));let e=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const i=this.renderParts[r];if(i.type==="character")switch(o){case 0:if(i.character.match(/\s/))continue;i.character==='"'?(o=1,e=r):i.character==="*"?(o=3,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Ao(i.style,'"')}),r++,e=r,o=2);break;case 1:e=r,i.character==='"'&&(o=0);break;case 2:if(i.character.match(/\s/))continue;i.character==="*"&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Ao(i.style,'"')}),o=3,r++),e=r;break;case 3:i.character==="*"&&(o=0),e=r;break;default:throw new Kt.UnreachableCaseError(o)}}const s=this.renderParts[e];s&&o===3&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:Ao(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:Ao(s.style,'"')})}applyLayout(t,e,o,s,r){const i=this.renderParts,l=[];let a=null,u=0,c=0;const f=()=>{a={type:"group",renderParts:[],height:0,width:0},u=s,c=-1,l.push(a)};f();for(const p of i)if(p.type==="newline"||p.type==="alignment")if(l.push(p),p.type==="alignment"&&r){const P=u;f(),u=P}else f();else{if(u<p.width&&r){const P={type:"newline",height:p.height,width:p.height,x:0,y:0};if(p.character===" "){l.push(P),f();continue}else if(c!==-1){const D=a.renderParts.splice(c).slice(1),M=D.reduce((O,j)=>O+j.width,0),g=D.reduce((O,j)=>O>j.height?O:j.height,0);a.width-=M,a.height===g&&(a.height=a.renderParts.reduce((O,j)=>O>j.height?O:j.height,0)),l.push(P),f(),a.renderParts=D,a.width=M,a.height=g,u-=M}}else p.character===" "&&(c=a.renderParts.length);a.renderParts.push(p),a.height=Math.max(a.height,p.height),a.width+=p.width,u-=p.width}const m=[];let b=0;for(const p of l)b=Math.max(b,p.height),p.type==="newline"&&(m.push(b),b=0);m.push(b);let _=0,y=t,w=o,k=0,h=s;for(const p of l){if(p.type==="newline"){w+=m[++_]||0,k=0,h=s;continue}if(p.type==="alignment"){y=p.alignment;continue}switch(y){case"left":v(p,k,w),k+=p.width;break;case"center":v(p,k+(h-k)/2-p.width/2,w);break;case"right":v(p,h-p.width,w),h-=p.width;break}}this.lastLayoutHeight=w,this.lastLayoutWidth=s;function v(p,P,D){let M=P;for(const g of p.renderParts)g.y=D,g.x=e+M,M+=g.width}}getHeight(t){let e=0,o=0;const s=t===0?this.renderParts:Dt.applyLineWrapping(this.renderParts.slice(0),t);for(const r of s)e=Math.max(e,r.height),r.type==="newline"&&(o+=e,e=0);return o+=e,o}getWidth(){let t=0,e=0;for(const o of this.renderParts)t+=o.width,o.type==="newline"&&(e=Math.max(e,t),t=0);return e=Math.max(e,t),e}static getRenderParts(t,e,o){const s=[],r=[],i=[];let l=hd(e),a=e,u=null;function c(f){for(const m of f)s.push({type:"character",character:m,height:l,width:Ao(a,m),style:a,x:0,y:0})}for(const f of t){const m=f.type;switch(m){case"command":if(f.commandName==="align"){const b=f.argument.toLowerCase();if(b!=="left"&&b!=="center"&&b!=="right")if(o){c("{align="+f.argument+"}");continue}else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);s.push({type:"alignment",alignment:b,height:l,width:0,x:0,y:0})}else if(dd.has(f.commandName)){r.push(a),i.push(u);try{a=dd.get(f.commandName)(a,f.argument),l=hd(a),u=f}catch(b){if(o){r.pop(),i.pop(),c("{"+f.commandName+(f.argument?"="+f.argument:"")+"}"),console.error("Parsing error",b);continue}else throw b}}else if(o)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!u)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==u.commandName)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${u}' first. (Opened at position ${u.pos})`);u=i.pop(),a=r.pop();break;case"newline":s.push({height:l,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new Kt.UnreachableCaseError(m)}}return s}static applyLineWrapping(t,e){let o=-1,s=0,r=0;const i=[];for(const l of t)if(l.type==="newline")o=-1,s=0,r=0,i.push(l);else if(l.type==="alignment")console.error("Alignment in context where it's not supported.");else if(l.type==="character")l.character===" "?s>e?(o=-1,s=0,r=0,i.push({type:"newline",height:l.height,width:0,x:0,y:0})):(s+=l.width,r=s,o=i.length,i.push(l)):(s+=l.width,s>e&&o!==-1&&(s-=r,i.splice(o,1,{type:"newline",height:l.height,width:0,x:0,y:0}),o=-1,r=0),i.push(l));else throw new Kt.UnreachableCaseError(l);return i}}const Ha=Hn();Ha.width=0;Ha.height=0;const fd=Ha.getContext("2d");let pd=null;function Ao(n,t){n!==pd&&(Ll(n,fd),pd=n);let e=n.letterSpacing;return(typeof e!="number"||isNaN(e)||!isFinite(e))&&(e=0),fd.measureText(t).width+e}const dl=new Map;function hd(n){const t=n.fontSize+" "+n.fontName;if(dl.has(t))return dl.get(t)*n.lineSpacing;const e=document.createElement("span");e.innerHTML="Hg",e.style.fontFamily=n.fontName,e.style.fontSize=`${n.fontSize}px`,e.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=n.fontName,o.style.fontSize=`${n.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(e),document.body.appendChild(o);try{const s=o.offsetHeight;return dl.set(t,s),s*n.lineSpacing}finally{o.remove()}}function Ll(n,t){t.textAlign="left",t.font=(n.isItalic?"italic ":"")+(n.isBold?"bold ":"")+n.fontSize+"px "+n.fontName,t.lineJoin="round",n.strokeWidth>0&&n.strokeColor>""?(t.strokeStyle=n.strokeColor,t.lineWidth=n.strokeWidth):(t.strokeStyle="",t.lineWidth=0),t.globalAlpha=n.alpha||0,t.fillStyle=n.color}var on=(n=>(n[n.None=0]="None",n[n.Selected=1]="Selected",n[n.Focused=2]="Focused",n[n.Indirectly=4]="Indirectly",n))(on||{});const gw={0:void 0,1:"#f00",2:"#00f",3:"#f0f",4:"#f66",6:"#f6f"};function Lp(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.arcTo(t+o,e+s,t,e+s,r),n.arcTo(t,e+s,t,e,r),n.arcTo(t,e,t+o,e,r),n.closePath()}function Np(n,t,e,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),n.moveTo(t+r,e),n.arcTo(t+o,e,t+o,e+s,r),n.lineTo(t+o,e+s),n.lineTo(t,e+s),n.arcTo(t,e,t+o,e,r),n.closePath()}function wn(n,t){n.save();try{t()}finally{n.restore()}}function Yo(n,t){t.align&&(n.textAlign=t.align),t.font!=null&&(n.font=t.font),t.fill&&(n.fillStyle=t.fill.style),t.outline&&(n.strokeStyle=t.outline.style,n.lineWidth=t.outline.width)}function mw(n,t){if("filter"in n){let e="";for(const o of t)o.type==="drop-shadow"?e+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?e+=` hue-rotate(${o.value}deg)`:o.type==="blur"?e+=` blur(${o.value}px)`:e+=` ${o.type}(${o.value*100}%)`;n.filter=(n.filter==="none"?"":n.filter)+e.trimStart()}else{let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);n.globalAlpha*=e}}class Hp{constructor(t){C(this,"lastVersion",null);C(this,"localCanvasInvalid",!0);C(this,"lastHit",null);C(this,"lastLocalTransform",null);C(this,"transformOverride",null);C(this,"hitDetectionFallback",!1);C(this,"localCanvas",null);this.obj=t}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let t=new DOMMatrix;const e=this.obj;t=t.translate(this.x,this.y);const o=this.height/2*e.scaleX;return"close"in e&&e.close&&(t=t.translate(0,fe().Base.CloseUpYOffset),t=t.translate(0,-o),t=t.scale(2,2),t=t.translate(0,o)),this.isTalking&&e.enlargeWhenTalking&&(t=t.translate(0,+o),t=t.scale(1.05,1.05),t=t.translate(0,-o)),(e.flip||e.rotation!==0||e.scaleX!==1||e.scaleY!==1||e.skewX!==0||e.skewY!==0)&&(e.rotation!==0&&(t=t.rotate(0,0,e.rotation)),e.skewX!==0&&(t=t.skewX(e.skewX)),e.skewY!==0&&(t=t.skewY(e.skewY)),e.flip&&(t=t.flipX()),(e.scaleX!==1||e.scaleY!==1)&&(t=t.scale(e.scaleX,e.scaleY))),t}getLocalSize(){if(this.transformIsLocal){const t=fe();return new DOMPointReadOnly(t.Base.screenWidth,t.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.obj.isTalking}get linkedTo(){return this.obj.linkedTo}get transform(){return this.transformOverride!=null?this.transformOverride:this.obj.globalTransform}prepareRender(t){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const e=this.transform;zy(e,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=e)}else this.lastLocalTransform=null}render(t,e,o,s,r){o||(e=on.None),(!this.canSkipLocal||e!==on.None)&&(r=!1);const i=this.getLocalSize(),l=this.transform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==i.x||this.localCanvas.height!==i.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=Hn()),this.localCanvas.width=i.x,this.localCanvas.height=i.y;const u=this.localCanvas.getContext("2d");if(!u)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&u.setTransform(l),this.renderLocal(u,s),this.localCanvasInvalid=!1,u.resetTransform()}const a=gw[e];wn(t,()=>{a!=null&&(t.shadowColor=a,t.shadowBlur=20),(!this.transformIsLocal||r)&&t.setTransform(l),t.globalCompositeOperation=this.obj.composite??"source-over",mw(t,this.obj.filters),r?this.renderLocal(t,s):this.localCanvas&&this.localCanvas.height!==0&&this.localCanvas.width!==0&&t.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(t){const e=t.matrixTransform(this.transform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(e.x<0||e.y<0||e.x>o.x||e.y>o.y)return console.log("Hitbox text",e),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?t:e;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}class Ir extends Hp{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const t=this.obj.globalTransform;return"overflow"in this.obj&&this.obj.overflow?!0:ve.supports.limitedCanvasSpace?!1:!(t.a===1&&t.b===0&&t.c===0&&t.d===1)}}class Wa{constructor(t){C(this,"nextArrow",null);this.base=t}static get defaultWidth(){return bo}static get defaultHeight(){return Sr+Ln}static get defaultX(){return fe().Base.screenWidth/2}static get defaultY(){return fe().Base.screenHeight-this.defaultHeight/2-fe().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Pa}getControlsDisabledStyle(){return op}get textboxStyle(){return Oa}renderControls(t,e){const s=this.width/2,r=this.getControlsStyle();Yo(t,r),t.fillText("History",s+wa,e),Yo(t,this.base.obj.skip?r:this.getControlsDisabledStyle()),t.fillText("Skip",s+ka,e),Yo(t,r),t.fillText("Auto   Save   Load   Settings",s+Ca,e)}prepare(){if(!(this.nextArrow instanceof Nn))return(async()=>{this.nextArrow=await us("next")})()}}class Kn extends Wa{constructor(){super(...arguments);C(this,"backgroundImage","textbox");C(this,"xOffset",0);C(this,"nameBoxAsset",null);C(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return Sr+Ln}get width(){return bo}get nameboxWidth(){return bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}renderNamebox(e,o,s){var r;(r=this.nameBoxAsset)==null||r.paintOnto(e,{x:o,y:s})}renderBackdrop(e,o,s){var r;o+=this.xOffset,(r=this.backdropAsset)==null||r.paintOnto(e,{x:o,y:s})}render(e){var l;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,i=r-ya;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&((l=this.nextArrow)==null||l.paintOnto(e,{x:o-_a,y:r-xa}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof Nn?void 0:(async()=>{this.backdropAsset=await us(this.backgroundImage)})(),this.nameBoxAsset instanceof Nn?void 0:(async()=>{this.nameBoxAsset=await us("namebox")})()])}}C(Kn,"id","normal"),C(Kn,"label","Normal"),C(Kn,"priority",0),C(Kn,"gameMode","ddlc");class No extends Kn{constructor(){super(...arguments);C(this,"backgroundImage","textbox_monika");C(this,"xOffset",(bo-ba)/2)}}C(No,"id","corrupt"),C(No,"label","Corrupted"),C(No,"priority",1),C(No,"gameMode","ddlc");class Jn extends Wa{constructor(){super(...arguments);C(this,"_dotPattern",null);C(this,"_lastColor",null);C(this,"backgroundImage","textbox");C(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){const e=this.refObject.value;return e&&e.nameboxWidth!==null?e.nameboxWidth:this.obj.customNameboxWidth??bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return{...Tr,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return ms}get textOffsetY(){return Pr}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject.value;return e!=null&&e.textboxColor!=null?e.textboxColor:Xf}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(Yf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(Gf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Np(e,o,s,r,i,Zf),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Le.fromCss(this.nameboxBackgroundColor),u=new Le(a.r,a.g,a.b,.95),c=u.toHSL().shift(Jf).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(Kf,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=Le.fromCss(this.customColor),r=s.toHSL(),i=this.obj.height-o,l=this.obj.width,a=()=>Lp(e,Xn/2,o+Xn/2,l-Xn,i-Xn,Qf);wn(e,()=>{e.beginPath(),a(),e.clip();const c=e.createLinearGradient(0,o,0,i);c.addColorStop(0,s.toCss()),c.addColorStop(1,`rgba(${s.r},${s.g},${s.b},0.6667)`),e.fillStyle=c,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,l,i),wn(e,()=>{e.translate(0,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,0,l,i)});const f=e.createLinearGradient(0,o+i-Ml,0,o+i);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(l/2,o+i,np,Ml,0,0,2*Math.PI),e.closePath(),e.fill()});const u=r.shift(ep).toRgb().toCss();e.strokeStyle=u,e.lineWidth=Xn,e.beginPath(),a(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-ya;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-_a,y:r-xa})}getDotPattern(e=tp){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;this._lastColor=this.customColor;const{dotPatternSize:o,dotColorDelta:s,dotRadius:r}=e,i=Le.fromCss(this.customColor).toHSL(),l=Hn();l.height=o,l.width=o;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=i.shift(s).toRgb().toCss();function u(f,m){a.beginPath(),a.ellipse(f,m,r,r,0,0,2*Math.PI),a.closePath(),a.fill()}u(0,0),u(o,0),u(0,o),u(o,o),u(o/2,o/2);const c=a.createPattern(l,"repeat");if(!c)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=c,c}}C(Jn,"id","custom"),C(Jn,"label","Custom"),C(Jn,"priority",0),C(Jn,"gameMode","ddlc");const fr=class fr{constructor(t){C(this,"nextArrow",null);this.base=t}static get resizable(){return!1}static get defaultWidth(){return ja}static get defaultHeight(){return wp+Aa}static get defaultX(){return fe().Base.screenWidth/2}static get defaultY(){return fe().Base.screenHeight-this.defaultHeight/2-fe().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return or}getControlsDisabledStyle(){return Rp}renderControls(t,e){const o=this.width,s=o/2,i=s-s,l=this.getControlsStyle(),a=["History","Skip","Auto","Save","Load","Settings"],u=[];let c=0;for(const b of a){const _=fr.controlWidth(t,b);u.push(_),c+=_}const f=Math.min((o-c)/(a.length+2),78);let m=i+(o-c-f*(a.length-1))/2;for(let b=0;b<a.length;++b){const _=a[b],y=u[b],w=_==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():l;Yo(t,w),t.fillText(_,m,e),m+=y+f}}static controlWidth(t,e){if(this.widthCache[e])return this.widthCache[e];Yo(t,or);const o=t.measureText(e).width;return this.widthCache[e]=o,o}prepare(){if(!(this.nextArrow instanceof Nn))return(async()=>{this.nextArrow=await us("next_plus")})()}};C(fr,"widthCache",{});let Nl=fr;class Ho extends Nl{constructor(){super(...arguments);C(this,"_lastColor",null);C(this,"_dotPattern",null);C(this,"backgroundImage","textbox");C(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){const e=this.refObject.value;return e&&e.nameboxWidth!=null?e.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ia}get nameboxHeight(){return Aa}get nameboxOffsetX(){return Ma}get nameboxOffsetY(){return Cp}get nameboxStyle(){return{...jp,strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"}}get textOffsetX(){return Ra}get textOffsetY(){return kp}get textboxStyle(){return Ap}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject.value;return e!=null&&e.textboxColor!=null?e.textboxColor:cp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(dp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Le.fromCss(this.customColor).toHSL().shift(fp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,o,s){wn(e,()=>{const r=this.nameboxWidth,i=this.nameboxHeight;e.beginPath(),Np(e,o,s,r,i,vp),e.clip();const l=e.createLinearGradient(o,s,o,s+i),a=Le.fromCss(this.nameboxBackgroundColor),u=new Le(a.r,a.g,a.b,.95),c=u.toHSL().shift(hp).toRgb();l.addColorStop(0,u.toCss()),l.addColorStop(pp,u.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(o,s,this.obj.width,i)})}renderBackdrop(e,o){const s=this.obj.height-o,r=this.obj.width,i=Le.fromCss(this.customColor).toHSL(),l=()=>Lp(e,Yn/2,o+Yn/2,r-Yn,s-Yn,gp);wn(e,()=>{e.beginPath(),l(),e.clip();const u=e.createLinearGradient(0,o,0,o+s),c=Le.fromHex(this.customColor);u.addColorStop(0,c.toCss()),u.addColorStop(1,`rgba(${c.r},${c.g},${c.b},0.6667)`),e.fillStyle=u,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,o,r,s),e.strokeRect(0,o,r,s),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,o,r,s);const f=e.createLinearGradient(0,o+s-Dl,0,o+s);f.addColorStop(0,"rgba(255,255,255,0.3137)"),f.addColorStop(.5,"rgba(255,255,255,0.0627)"),f.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=f,e.beginPath(),e.ellipse(r/2,o+s,$p,Dl,0,0,2*Math.PI),e.closePath(),e.fill()});const a=i.shift(mp).toRgb().toCss();e.strokeStyle=a,e.lineWidth=Yn,e.beginPath(),l(),e.stroke()}render(e){const o=this.obj.height,s=this.obj.width;this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const r=o,i=r-_p;this.obj.controls&&this.renderControls(e,i),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:s-Op,y:r-Tp})}getDotPattern(){return Jn.prototype.getDotPattern.call(this,bp)}}C(Ho,"id","custom_plus"),C(Ho,"label","Custom (Plus)"),C(Ho,"priority",0),C(Ho,"gameMode","ddlc_plus");class Wo extends Wa{static get resizable(){return!0}get height(){return Sr+Ln}get width(){return bo}get nameboxWidth(){return bs}get nameboxHeight(){return Ln}get nameboxOffsetX(){return ys}get nameboxOffsetY(){return Or}get nameboxStyle(){return Tr}get textOffsetX(){return ms}get textOffsetY(){return Pr}get textboxStyle(){return Oa}async render(){}}C(Wo,"id","none"),C(Wo,"label","None"),C(Wo,"priority",0),C(Wo,"gameMode","ddlc");const bw=[Kn,No,Jn,Wo,Ho],Go=(()=>{const n={};for(const t of bw)n[t.id]=t;return n})();class yw extends Ir{constructor(){super(...arguments);C(this,"nbTextRenderer",null);C(this,"textRenderer",null);C(this,"_lastRefVars",null);C(this,"refObject",B(()=>{var e;return this.obj.talkingObjId==null?null:((e=H.panels.panels[this.obj.panelId])==null?void 0:e.objects[+this.obj.talkingObjId])??null}));C(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject.value;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:((e=this.refObject.value)==null?void 0:e.label)??"Missing name"}get canSkipLocal(){var e;return super.canSkipLocal&&(((e=this._lastRenderer)==null?void 0:e.allowSkippingLocal)??!0)}prepareRender(e){const o=super.prepareRender(e),s=this.textboxRenderer.prepare(),r=this.getRefVars();r!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=r),this.nbTextRenderer=new Dt(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new Dt(this.obj.text,this.textboxRenderer.textboxStyle);const i=this.nbTextRenderer.loadFonts(),l=this.textRenderer.loadFonts();if(!(!o&&!s&&!i&&!l))return Promise.all([o,s,i,l])}renderLocal(e){const o=this.textboxRenderer,s=o.width;if(!this.obj.overflow){const r=new Path2D;r.rect(0,0,o.width,this.height),e.clip(r)}o.render(e),this.obj.talkingObjId!==null&&this.renderName(e),this.renderText(e,0,0,s)}renderName(e){const o=this.textboxRenderer,s=o.nameboxWidth,r=o.nameboxOffsetX,i=o.nameboxOffsetX/2;console.log("rendering name",e.getTransform()),this.nbTextRenderer.applyLayout("center",r+i,o.nameboxOffsetY,s-i*2,!1),this.nbTextRenderer.render(e)}renderText(e,o,s,r){const i=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.applyLayout("left",o+i.textOffsetX,s+i.nameboxHeight+i.textOffsetY,r-i.textOffsetX*2,this.obj.autoWrap),l.render(e)}get forcedStyle(){const e=this.refObject.value;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,o=Go[e];if(this._lastRenderer&&this._lastRenderer.constructor===o)return this._lastRenderer;const s=new o(this);return this._lastRenderer=s,s}}const vd=4;class bn extends ko{constructor(e,o,s,{text:r,resetBounds:i,style:l}={}){super(e,s??!0,o);C(this,"_text",I("Click here to edit the textbox"));C(this,"_talkingObjId",I(null));C(this,"_talkingOther",I(""));C(this,"_autoQuoting",I(!0));C(this,"_overflow",I(!1));C(this,"_style",I("normal"));C(this,"_overrideColor",I(!1));C(this,"_customColor");C(this,"_deriveCustomColors",I(!0));C(this,"_customControlsColor");C(this,"_customNameboxColor");C(this,"_customNameboxStroke");C(this,"_customNameboxWidth",I(null));C(this,"_resetBounds");C(this,"_controls",I(!0));C(this,"_skip",I(!0));C(this,"_autoWrap",I(!0));C(this,"_continue",I(!0));const a=fe();l??(l=a.TextBox.DefaultTextboxStyle);const u=Go[l];this._resetBounds=I(i??{x:u.defaultX,y:u.defaultY,width:u.defaultWidth,height:u.defaultHeight,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0}),this._customColor=I(a.TextBoxCustom.textboxDefaultColor),this._customControlsColor=I(a.TextBoxCustom.controlsDefaultColor),this._customNameboxColor=I(a.TextBoxCustom.nameboxDefaultColor),this._customNameboxStroke=I(a.TextBoxCustom.nameboxStrokeDefaultColor),this.applyResetBounds(),this._style.value=l,r&&(this._text.value=r)}get type(){return"textBox"}static create(e,o){return new bn(e,void 0,void 0,{text:o})}makeClone(e,o){const s=new bn(e,o.get(this.id));return this.moveAllRefs(this,s),s}static fromSave(e,o,s){const r=new bn(e,s.get(o.id),o.onTop);return o.panelId!==e.id&&!s.has(o.talkingObjId)?o.talkingObjId=null:o.talkingObjId=s.get(o.talkingObjId)??o.talkingObjId,o.talkingObjId=o.talkingObjId??null,r.loadPropsFromSave(o,s),r}prepareSiblingRemoval(e){e.id===this.talkingObjId&&(this.talkingObjId=null),super.prepareSiblingRemoval(e)}get text(){return this._text.value}set text(e){this.mutate(this._text,e)}get talkingObjId(){return this._talkingObjId.value}set talkingObjId(e){this.mutate(this._talkingObjId,e)}get talkingOther(){return this._talkingOther.value}set talkingOther(e){this.talkingObjId==="$other$"?this.mutate(this._talkingOther,e):this.mutateX([this._talkingObjId,this._talkingOther],["$other$",e])}get autoQuoting(){return this._autoQuoting.value}set autoQuoting(e){this.mutate(this._autoQuoting,e)}get overflow(){return this._overflow.value}set overflow(e){this.mutate(this._overflow,e)}get style(){return this._style.value}set style(e){const o=fe(),s=this.style,r=this.x,i=this.y,l=this.width,a=this.height,u=Go[s],c=Go[e];let f=r,m=i,b=l,_=a;const y=10;c.resizable?(u.defaultWidth!==c.defaultWidth&&(b=Math.max(b+c.defaultWidth-u.defaultWidth,y)),u.defaultHeight!==c.defaultHeight&&(_=Math.max(_+c.defaultHeight-u.defaultHeight,y))):(b=c.defaultWidth,_=c.defaultHeight),u.defaultX!==c.defaultX&&(f=sr(-b+y,f+c.defaultX-u.defaultX,o.Base.screenWidth-y)),u.defaultY!==c.defaultY&&(m=sr(-_+y,m+c.defaultY-u.defaultY,o.Base.screenHeight-y)),this.mutateX([this._x,this._y,this._height,this._width,this._style],[f,m,_,b,e])}get overrideColor(){return this._overrideColor.value}set overrideColor(e){this.mutate(this._overrideColor,e)}get customColor(){return this._customColor.value}set customColor(e){this.mutate(this._customColor,e)}get deriveCustomColors(){return this._deriveCustomColors.value}set deriveCustomColors(e){this.mutate(this._deriveCustomColors,e)}get customControlsColor(){return this._customControlsColor.value}set customControlsColor(e){this.mutate(this._customControlsColor,e)}get customNameboxColor(){return this._customNameboxColor.value}set customNameboxColor(e){this.mutate(this._customNameboxColor,e)}get customNameboxStroke(){return this._customNameboxStroke.value}set customNameboxStroke(e){this.mutate(this._customNameboxStroke,e)}get customNameboxWidth(){return this._customNameboxWidth.value}set customNameboxWidth(e){this.mutate(this._customNameboxWidth,e)}applyResetBounds(){const e=this._resetBounds.value;this.mutateX([this._x,this._y,this._height,this._width,this._rotation,this._skewX,this._skewY,this._scaleX,this._scaleY],[e.x,e.y,e.height,e.width,e.rotation,e.skewX,e.skewY,e.scaleX,e.scaleY])}splitTextbox(){const e=(this.width-vd)/2,o=e/2+vd/2,s=this.localTransform,r=s.transformPoint(new DOMPointReadOnly(-o,0)),i=s.transformPoint(new DOMPointReadOnly(o,0)),l={x:r.x,y:r.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY};this.mutate(this._resetBounds,l),this.applyResetBounds();const a=this.style==="custom_plus"?"custom_plus":"custom";this.mutate(this._style,a);const u=new bn(this.panel,void 0,this.onTop,{resetBounds:{x:i.x,y:i.y,width:e,height:this.height,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY},style:a});this.flip&&(u.flip=!0),this.mutate(u._linkedTo,this._linkedTo.value)}get controls(){return this._controls.value}set controls(e){this.mutate(this._controls,e)}get skip(){return this._skip.value}set skip(e){this.mutate(this._skip,e)}get autoWrap(){return this._autoWrap.value}set autoWrap(e){this.mutate(this._autoWrap,e)}get continue(){return this._continue.value}set continue(e){this.mutate(this._continue,e)}}const Ls=new class{constructor(){C(this,"_panels",I({}));C(this,"_order",I([]));C(this,"_lastPanelId",-1);Object.seal(this)}get panels(){return this._panels.value}get order(){return this._order.value}get lastPanelId(){return this._lastPanelId}createPanel(){const e=this._lastPanelId+1,o=new Ko(e);return We(()=>{this._lastPanelId=e,this._panels.value[o.id]=yt(o),this._order.value.push(o.id)}),o}duplicatePanel(t){const o=this._lastPanelId+1,s=Ko.fromExisting(t,o),r=this._order.value.indexOf(t.id);return We(()=>{this._lastPanelId=o,this._panels.value[o]=yt(s),this._order.value.splice(r+1,0,o)}),s}deletePanel(t){const e=this._order.value.indexOf(t.id);e!==-1&&We(()=>{delete this._panels.value[t.id],this._order.value.splice(e,1)})}movePanel(t,e){const o=this._order.value.indexOf(t.id);o!==-1&&We(()=>{this._order.value.splice(o,1),this._order.value.splice(o+e,0,t.id)})}fixContentPackRemoval(t){for(const e of Object.values(this._panels))e.fixContentPackRemoval(t)}getSave(){return{lastPanelId:this._lastPanelId,panelOrder:[...this._order.value],currentPanel:H.viewports.list[0].currentPanel,panels:Object.fromEntries(Object.values(this._panels.value).map(t=>[t.id,t.getSave()]))}}loadSave(t){const e=t.panelOrder,o={};let s=-1;for(const r of e){const i=t.panels[r],l=new Ko(+r);l.loadSave(i),o[l.id]=yt(l),s=Math.max(s,l.id)}this._order.value=e,this._panels.value=o,this._lastPanelId=s}},es=class es extends Ba{constructor(e){super();C(this,"background",new kw);C(this,"_lastObjId",-1);C(this,"_lowerOrder",I([]));C(this,"_topOrder",I([]));C(this,"_objects",I({}));C(this,"_lastRender",I(null));this.id=e}static fromExisting(e,o){const s=new es(o);let r=-1;const i={},l=new Map;for(const a in e.objects)l.set(+a,++r);for(const a in e.objects){if(!Object.prototype.hasOwnProperty.call(e.objects,a))continue;const c=e.objects[a].makeClone(s,l);i[c.id]=c}return s._lastObjId=r,s._lowerOrder.value=e._lowerOrder.value.map(a=>l.get(a)),s._topOrder.value=e._topOrder.value.map(a=>l.get(a)),s._objects.value=i,s._lastRender.value=e._lastRender.value,s._composite.value=e._composite.value,s._filters.value=e._filters.value.map(a=>yt(a.clone())),s.background.fromExisting(e.background),s}loadSave(e){this.background.loadSave(e.background),this._filters.value=Ea(e.filters),this._composite.value=e.composite;const o=[];for(const s of[...e.order,...e.onTopOrder]){const r=e.objects[s];r!=null&&o.push(r)}this.pasteObjects(o)}getSave(){return{id:this.id,background:this.background.getSave(),composite:this._composite.value,filters:this._filters.value.map(e=>e.getSave()),order:[...this._lowerOrder.value],onTopOrder:[...this._topOrder.value],lastObjId:this._lastObjId,objects:Object.fromEntries(Object.entries(this.objects).map(([e,o])=>[e,o.save()]))}}get lowerOrder(){return this._lowerOrder.value}get topOrder(){return this._topOrder.value}get objects(){return this._objects.value}get lastRender(){return this._lastRender.value}set lastRender(e){this._lastRender.value=e}get lastObjId(){return this._lastObjId}fixContentPackRemoval(e){this.background.fixContentPackRemoval(e);for(const o in this.objects)this.objects[o].fixContentPackRemoval(e)}insertObject(e,o){const s=o?this._topOrder.value:this._lowerOrder.value,r=this._lastObjId,i=Math.max(r,e.id);We(()=>{this.objects[e.id]=yt(e),this._lastObjId=i,s.push(e.id)})}removeObject(e){const o=e.onTop?this._topOrder.value:this._lowerOrder.value,s=o.indexOf(e.id);for(const r of Object.values(this._objects.value))r!==e&&r.prepareSiblingRemoval(e);for(const r of H.viewports.list)r.currentPanel===this.id&&r.selection===e.id&&(r.selection=null);We(()=>{o.splice(s,1),delete this._objects.value[e.id]})}setOnTop(e,o){const s=o?this._lowerOrder.value:this._topOrder.value,r=o?this._topOrder.value:this._lowerOrder.value,i=s.indexOf(e.id);i!==-1&&We(()=>{s.splice(i,1),r.push(e.id)})}shiftLayer(e,o){const s=e.onTop?this._topOrder.value:this._lowerOrder.value,r=s.indexOf(e.id),i=Math.max(r+o,0);r!==i&&We(()=>{s.splice(r,1),s.splice(i,0,e.id)})}pasteObjects(e){const o=new Map;let s=this.lastObjId;for(const r of e)o.set(+r.id,++s);for(const r of e){const i=es.objectClassTable[r.type];if(!i)throw new Error(`Unknown object type: ${r.type}`);i.fromSave(this,r,o)}}};C(es,"objectClassTable",{character:Dp,choice:Bp,notification:Ep,poem:Bl,sprite:La,textBox:bn});let Ko=es;const ww="buildin.transparent";var Ns=(n=>(n[n.None=0]="None",n[n.Stretch=1]="Stretch",n[n.Cover=2]="Cover",n))(Ns||{});class kw extends Ba{constructor(){super();C(this,"_current",I(ww));C(this,"_color",I("#000000"));C(this,"_flipped",I(!1));C(this,"_variant",I(0));C(this,"_scaling",I(0))}fromExisting(e){this._current.value=e.current,this._color.value=e.color,this._flipped.value=e.flipped,this._variant.value=e.variant,this._scaling.value=e.scaling,this._composite.value=e.composite,this._filters.value=e.filters.map(o=>yt(o.clone()))}getSave(){return{current:this.current,color:this.color,flipped:this.flipped,variant:this.variant,scaling:this.scaling,composite:this.composite,filters:this._filters.value.map(e=>e.getSave())}}loadSave(e){this.current=e.current,this.color=e.color,this.flipped=e.flipped,this.variant=e.variant,this.scaling=e.scaling,this._composite.value=e.composite,this._filters.value=Ea(e.filters)}get current(){return this._current.value}set current(e){this._current.value,this._variant.value,We(()=>{this._current.value=e,this._variant.value=0})}get color(){return this._color.value}set color(e){this._color.value,We(()=>void(this._color.value=e))}get flipped(){return this._flipped.value}set flipped(e){this._flipped.value,We(()=>void(this._flipped.value=e))}get variant(){return this._variant.value}set variant(e){this._variant.value,We(()=>void(this._variant.value=e))}get scaling(){return this._scaling.value}set scaling(e){this._scaling.value,We(()=>void(this._scaling.value=e))}seekBackgroundVariant(e){const s=At.backgrounds.get(this.current);if(!s)return;const r=Eo(s.variants,this.variant,e);this.variant,We(()=>void(this.variant=r))}fixContentPackRemoval(e){const o=e.backgrounds.find(l=>l.id===this.current);if(!o)return;const s=At.backgrounds.get(this.current);if(!s){At.current.backgrounds.length>0?this.current=At.current.backgrounds[0].id:this.current="buildin.transparent";return}const r=JSON.stringify(o.variants[this.variant]),i=s.variants.findIndex(l=>JSON.stringify(l)===r);i!==this.variant&&(this.variant=i===-1?0:i)}}const Cw={dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},At=new class{constructor(){C(this,"_contentPacks",I([]));C(this,"_current",B(()=>this._contentPacks.value.length===0?Cw:this._contentPacks.value.reduce((t,e)=>im(t,e))));C(this,"_characters",B(()=>{const t=new Map;for(const e of this.current.characters)t.set(e.id,e);return t}));C(this,"_backgrounds",B(()=>{const t=new Map;for(const e of this.current.backgrounds)t.set(e.id,e);return t}))}get contentPacks(){return this._contentPacks.value}get current(){return this._current.value}removeContentPacks(t){const e=JSON.parse(JSON.stringify(this.current)),o=this.contentPacks.filter(s=>!t.has(s.packId));Kr(()=>{this._contentPacks.value=o,Ls.fixContentPackRemoval(e)})}async replaceContentPack(t){const e=t.processed?t.contentPack:await Os(t.contentPack);let o=this._contentPacks.value;const s=o.findIndex(r=>r.packId===t.contentPack.packId);s===-1?o.push(e):o.splice(s,1,e),o=o,Kr(()=>{this._contentPacks.value=o})}async loadContentPacks(t){typeof t=="string"&&(t=[t]);const e=await Promise.all(t.map(async r=>await fl(r))),o=await Promise.all(e.map(r=>Os(r))),s=new Set(this.contentPacks.map(r=>r.packId));for(const r of o)for(const i of r.dependencies)if(!s.has(i))throw new Error(`Missing dependency '${i}'. Refusing to install ${r.packId}`);await Kr(async()=>{this._contentPacks.value=[...this.contentPacks,...o]})}get characters(){return this._characters.value}get backgrounds(){return this._backgrounds.value}async loadSave(t){const e=await Wn.getInstance(),o=new Set,s=await Promise.allSettled(t.map(async r=>{if(typeof r!="string")return r;let i=null,l;if(r.indexOf(";")>=0?[l,i]=r.split(";"):l=r,o.has(l))return null;o.add(l);const a=At.contentPacks.find(f=>f.packId===l);if(a)return a;if(r.startsWith("dddg.buildin.")&&r.endsWith(".nsfw")){const f=await fl(va[r]);return await Os(f)}i!=null&&!e.hasPack(l)&&await e.loadTempPack(i);const u=e.getPack(l);if(!u)return console.warn(`Pack Id ${r} not found!`),null;const c=await fl(u.dddg2Path||u.dddg1Path);return await Os(c)}));for(const r of s)r.status==="rejected"&&(je.fire(new gs(""+r.reason)),console.error(r.reason));At._contentPacks.value=[...At._contentPacks.value.filter(r=>{var i;return(i=r.packId)==null?void 0:i.startsWith("dddg.buildin.")}),...s.filter(r=>r.status==="fulfilled").map(r=>r.value).filter(r=>r!==null)]}async getSave(t){const e=At._contentPacks.value.filter(s=>{var r,i;return!((r=s.packId)!=null&&r.startsWith("dddg.buildin."))||((i=s.packId)==null?void 0:i.endsWith(".nsfw"))}),o=await Wn.getInstance();return t?e.map(s=>{var i;let r=(i=s.packId)!=null&&i.startsWith("dddg.uploads.")?s:s.packId;if(s.packId!=null){const l=o.getPack(s.packId);l&&l.repoUrl!=null&&(r+=`;${l.repoUrl}`)}return r}):e}};function _w(n){return n.split("/").slice(0,-1).join("/")+"/"}const gd=new Set(["png","gif","bmp","svg"]);async function fl(n){const t=await fetch(n);if(!t.ok)throw new Error(`Could not load content pack. Server responded with: ${t.statusText}`);let e;try{e=await t.json()}catch{throw new Error("Content pack is not valid json!")}try{const o={"./":_w(n),"/":pa};return e.version==="2.0"?rm.normalizeContentPack(e,o):sm.convert(nm.normalizeCharacter(e,o),o,!1)}catch{throw new Error("Content pack is not in a valid format!")}}async function Os(n){const t=new Set(await fo()?["webp",...gd]:gd),e=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Jr.assetWalker(n,o=>{const s=Jr.normalizePath(o,e,t,!1),r=Jr.normalizePath(o,e,t,!0);return{hq:s,lq:r,sourcePack:n.packId??"buildIn"}})}function xw(n){var e,o,s;const t=Object.values(n.panels.panels);if(!t.find(r=>Object.values(r.objects).find(i=>"scaleX"in i)))for(const r of t)for(const i of Object.values(r.objects)){i.scaleX=i.zoom??1,i.scaleY=i.zoom??1,i.skewX=0,i.skewY=0,i.linkedTo=null;const l=fe();if(i.type==="character"){const a=i,u=n.content.current.characters.find(f=>f.id===a.characterType),c=((s=(o=(e=u==null?void 0:u.styleGroups[a.styleGroupId])==null?void 0:e.styles[a.styleId])==null?void 0:o.poses[a.poseId])==null?void 0:s.size)??[960,960];Va(a,i.zoom??1,c)}i.type==="textBox"&&(i.height+=l.TextBox.NameboxHeight,i.y+=i.height/2),i.type==="sprite"&&(i.requireFixing25=!0,n.requireFixing25=!0),delete i.zoom}}function Va(n,t,e){let o=new DOMMatrixReadOnly().translate(n.x,n.y+n.height/2);o=o.translate(0,-n.height/2).scale(n.width/e[0],n.height/e[1]).translate(0,e[1]/2),o=o.rotate(n.flip?-n.rotation:n.rotation),o=o.translate(0,e[1]/2).scale(t).translate(0,-e[1]/2);const s=n.rotation;Object.assign(n,Mp(o)),n.rotation=n.flip?360-s:s,n.skewX=0,n.skewY=0,n.width=e[0],n.height=e[1]}function Wp(n){for(const t of Object.values(H.panels.panels))for(const e of Object.values(t.objects)){if(e.type!=="sprite"||!e.requireFixing25||e.scaleX!==e.scaleY)continue;const o=e;o.assets.length===1&&o.assets[0].hq===n.url&&(Va(o,e.scaleX,n.size),delete e.requireFixing25)}}async function Vp(n){if("requireFixing25"in H){const t=await po(n);Wp({url:n,size:[t.width,t.height]})}}function Fp(n){return!n.requireFixing25}const Sw=Object.freeze(Object.defineProperty({__proto__:null,adjustObjectSize2_5:Va,afterImageUpload2_5:Vp,allowScaleModification:Fp,fixSprites2_5:Wp,migrateSave2_5:xw},Symbol.toStringTag,{value:"Module"})),pl=Jt(Object.seal({urls:{},async add(n,t){if(this.urls[n])throw new Error(`There is already an uploaded file called "${n}"`);const e="uploads:"+n;return this.urls[n]=t,zp(e,t),await Vp(e),e},getSave(n){return Object.keys(this.urls)},loadSave(n){this.urls={}}})),Io=192,Mo=16/9,rr=Jt(new class{constructor(){C(this,"_list",{});C(this,"_currentViewportCount",0);Object.seal(this)}get list(){return Object.values(this._list)}setUpViewport(t){if(t.body.dataset.viewportId!=null)return yt(this.list[+t.body.dataset.viewportId]);const e=this._currentViewportCount++,o=new Pw(t);return this._list[e]=yt(o),t.defaultView.addEventListener("close",s=>{this.removeViewport(s.target)}),t.body.dataset.viewportId=e.toString(),yt(o)}removeViewport(t){if(t.body.dataset.viewportId==null)return;const e=+t.body.dataset.viewportId;e!=null&&delete this._list[e]}loadSave(t){if(t.currentPanel!=null){const o=this._list[0];if(!o)return;o.currentPanel=t.currentPanel}const e=H.panels.panels[0];for(const o of this.list)H.panels.panels[o.currentPanel]||(o.currentPanel=e.id),H.panels.panels[o.currentPanel].objects[o.selection]===void 0&&(o.selection=null)}});class Pw{constructor(t){C(this,"_selection",I(null));C(this,"_pickColor",I(!1));C(this,"_currentPanel",I(null));C(this,"_width");C(this,"_height");var e;this.doc=t,this._width=I(t.documentElement.clientWidth),this._height=I(t.documentElement.clientHeight),((e=rr.list[0])==null?void 0:e.currentPanel)!=null&&(this._currentPanel.value=rr.list[0].currentPanel),t.defaultView.addEventListener("resize",()=>{this._width.value=t.documentElement.clientWidth,this._height.value=t.documentElement.clientHeight})}get width(){return this._width.value}get height(){return this._height.value}get selection(){return this._selection.value}set selection(t){this._selection.value=t}get currentPanel(){return this._currentPanel.value}set currentPanel(t){this._currentPanel.value=t}get pickColor(){return this._pickColor.value}set pickColor(t){this._pickColor.value=t}get isVertical(){const t=this.height;return(this.width+Io)/t>=Mo}get canvasWidth(){if(this.isVertical){const t=this.width-Io,e=this.height*Mo;return Math.min(t,e)}else{const t=this.width,e=(this.height-Io)*Mo;return Math.min(t,e)}}get canvasHeight(){if(this.isVertical){const t=this.height,e=(this.width-Io)/Mo;return Math.min(t,e)}else{const t=this.height-Io,e=this.width/Mo;return Math.min(t,e)}}}const H=Object.freeze({ui:is,panels:Ls,content:At,uploadUrls:pl,viewports:rr,unsafe:!1,async loadSave(n){const t=JSON.parse(n);(t.version==null||t.version<2.5)&&(await Al(()=>Promise.resolve().then(()=>Sw),void 0,import.meta.url)).migrateSave2_5(t),await At.loadSave(t.content),pl.loadSave(t.uploadUrls),Ls.loadSave(t.panels),rr.loadSave(t.panels)},async getSave(n){return JSON.stringify({version:2.5,panels:Ls.getSave(),content:await At.getSave(n),uploadUrls:pl.getSave(n),unsafe:!1},void 0,"	")}}),Ow="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",Rt=class Rt{constructor(t,e){C(this,"onlineRepo");C(this,"localRepo");C(this,"tempRepo",Jt({authors:{},packs:[]}));C(this,"combinedList");C(this,"authors");window.repo=this,t||(t={authors:{},packs:[]},je.fire(new _t("Couldn't load remote repository."))),e||(e={authors:{},packs:[]},ve.supports.localRepo&&je.fire(new _t("Couldn't load local repository."))),this.onlineRepo=I(t),this.localRepo=I(e),this.combinedList=B(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.packs)??[],r=new Map(s.map(w=>[w.id,w])),i=this.localRepo.value,l=(i==null?void 0:i.packs)??[],a=new Map(l.map(w=>[w.id,w])),c=this.tempRepo.packs,f=new Map(c.map(w=>[w.id,w])),m=new Set(ve.state.autoAdd),b=H.content.contentPacks.map(w=>w.packId).filter(w=>w!=null),_=new Set(b),y=new Set;return[...b,...l.map(w=>w.id),...s.map(w=>w.id),...c.map(w=>w.id)].filter(w=>w.startsWith("dddg.buildin.")||w.startsWith("dddg.uploads.")||w.startsWith("dddg.desktop.")||w==="concept_femc.shido_draws.edave64"||y.has(w)?!1:(y.add(w),!0)).map(w=>({...r.get(w)??{characters:[],kind:[],authors:[]},...a.get(w),...f.get(w),autoloading:m.has(w),installed:a.has(w),online:r.has(w)||f.has(w),loaded:_.has(w)}))}),this.authors=B(()=>{const o=this.onlineRepo.value,s=(o==null?void 0:o.authors)??{},r=this.localRepo.value,i=(r==null?void 0:r.authors)??{};return{...s,...i}}),Object.freeze(this)}static getInstance(){return Rt.instance||(Rt.instance=this.createInstance()),Rt.instance}static async createInstance(){const t=Rt.loadRepo(Ow),e=ve.supports.localRepo?await Rt.loadRepo(ve.localRepositoryUrl):null,[o,s]=await Promise.all([t,e]);return new Rt(o,s)}static async loadRepo(t){try{const[e,o]=await Promise.all([Rt.fetchJSON(t+"repo.json"),Rt.fetchJSON(t+"people.json")]);return{packs:e,authors:o}}catch{return null}}static async fetchJSON(t){const e=await fetch(t);if(!e.ok)throw new Error("Could not load json");return await e.json()}async reloadLocalRepo(){this.localRepo.value=ve.supports.localRepo?await Rt.loadRepo(ve.localRepositoryUrl):null}getPacks(){return this.combinedList.value}hasPack(t,e=!1){var o;return e?!!((o=this.onlineRepo.value)!=null&&o.packs.find(s=>s.id===t)):!!this.getPacks().find(s=>s.id===t)}getPack(t){return this.getPacks().find(e=>e.id===t)??null}getAuthor(t){return this.authors.value[t]||null}getAuthors(){return this.authors.value}async loadTempPack(t){const e=fetch(t);let o;try{o=await e}catch{throw new Error(`Failed to load '${t}'`)}if(!o.ok)throw o.status===404?new Error(`The pack '${t}' does not exist anymore.`):new Error(`Failed to load '${t}': ${o.statusText||o.status}`);let s;try{s=await o.json()}catch(i){throw new Error(`The contents of '${t}' is not a valid JSON: ${i.message}`)}if(!s.pack&&(!s.packs||s.packs.length===0))throw new Error(`The json file '${t}' does not contain any packages`);if(s.authors)for(const i in s.authors)this.tempRepo.authors[i]&&(this.tempRepo.authors[i]=s.authors[i]);let r=null;if(s.pack&&(this.addTempPack(s.pack,t),r=s.pack.id),s.packs)for(const i of s.packs)this.addTempPack(i,t),r===null&&(r=i.id);return r}addTempPack(t,e){if(t.repoUrl=e,t.dddg1Path&&(t.dddg1Path=new URL(t.dddg1Path,e).toString()),t.dddg2Path&&(t.dddg2Path=new URL(t.dddg2Path,e).toString()),t.preview)for(let o=0;o<t.preview.length;++o)t.preview[o]=new URL(t.preview[o],e).toString();this.tempRepo.packs.find(o=>o.id===t.id)||this.tempRepo.packs.push(t)}};C(Rt,"instance");let Wn=Rt;const ir=navigator.userAgent,Tw=!!ir.match(/iPad/i)||!!ir.match(/iPhone/i),$w=!!ir.match(/WebKit/i),md=Tw&&$w&&!ir.match(/CriOS/i);class Up{constructor(){C(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder",hasTemplate:!1}));C(this,"supports");C(this,"_gameMode",null);C(this,"isSavingEnabled",I(!1));C(this,"localRepositoryUrl","");C(this,"loading");C(this,"creatingDB");C(this,"loadingContentPacksAllowed");C(this,"loadContentPacks");C(this,"updateProgress",null);const t=Qe.canSave(),e=this.isSavingEnabled;window.addEventListener("beforeunload",o=>{o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise(o=>{this.loadContentPacks=()=>o()}),this.supports=Jt({optionalSaving:t,get autoLoading(){return t&&e.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!md,allowWebP:!0,limitedCanvasSpace:md}),t?this.loading=(async()=>{this.savingEnabled=await Qe.doesDbExists()})():this.loading=Promise.resolve(),this.loading.then(async()=>{if(await this.loadingContentPacksAllowed,this.creatingDB&&await this.creatingDB,this.savingEnabled){const o=await Qe.loadAutoload()??[];this.state.autoAdd=o;const s=await Wn.getInstance(),r=await Promise.all(o.map(async i=>{const[l,a]=i.split(";",2);a!=null&&!s.hasPack(l)&&await s.loadTempPack(a);const u=s.getPack(l);return u.dddg2Path??u.dddg1Path}));await ie(async()=>{await H.content.loadContentPacks(r)})}})}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(t){t?(localStorage.setItem("saving","true"),this.creatingDB=Qe.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=Qe.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}async loadGameMode(){const e=new URLSearchParams(location.search).get("mode");if(e==="ddlc"||e==="ddlc_plus"){this._gameMode=e;return}await this.loading,await this.creatingDB;let o="";this.isSavingEnabled.value&&(o=await Qe.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s}async setGameMode(t){this.isSavingEnabled.value&&await Qe.saveGameMode(t);const e=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${e}?mode=${t}`}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(){throw new Error("Method not implemented.")}openNewWindow(){const t=window.open(void 0,"_blank","left=100,top=100");return!t||t.closed?null:t}async saveToFile(t,e,o="image/png",s=1){const r=document.createElement("a");r.setAttribute("download",e);const i=await this.createObjectURL(t,o,s);return r.setAttribute("href",i),document.body.appendChild(r),r.click(),document.body.removeChild(r),i}localRepoInstall(){return Promise.reject(new Error("This environment does not support a local repository"))}localRepoUninstall(){throw new Error("This environment does not support a local repository")}async autoLoadAdd(t){await this.loading,await this.creatingDB,await Qe.saveAutoload([...this.state.autoAdd,t]),this.state.autoAdd.push(t)}async autoLoadRemove(t){await this.loading,await this.creatingDB;const e=this.normalizePackId(t);await Qe.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=e));const o=this.state.autoAdd.indexOf(t);this.state.autoAdd.splice(o,1)}normalizePackId(t){const e=t.split(";");return e.length===1?e[0]:e[e.length-1]}async loadSettings(){await this.loading,await this.creatingDB;const t={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?{...t,...await Qe.loadSettings()}:t}async saveSettings(t){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&await Qe.saveSettings(t)}async loadDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return!1;const t=await Qe.loadTemplate();return t==null?!1:(this.state.hasTemplate=!0,await H.loadSave(t),!0)}async saveDefaultTemplate(){if(await this.loading,await this.creatingDB,!this.isSavingEnabled.value)return;const t=await H.getSave(!0);Qe.saveTemplate(t),this.state.hasTemplate=!0}async clearDefaultTemplate(){await this.loading,await this.creatingDB,this.isSavingEnabled.value&&(await Qe.saveTemplate(null),this.state.hasTemplate=!1)}async isInitialized(){await this.loading,await this.creatingDB}prompt(t,e){return new Promise(o=>{o(prompt(t,e))})}onPanelChange(){}createObjectURL(t,e,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(t.toDataURL(e,o));if(t.toBlob!=null)t.toBlob(l=>{if(!l){r();return}s(URL.createObjectURL(l))},e,o);else{const l=t.toDataURL(e,o),a=this.dataURItoBlob(l,e);s(URL.createObjectURL(a))}})}dataURItoBlob(t,e){const o=atob(t.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let i=0;i<s;i++)r[i]=o.charCodeAt(i);return new Blob([r],{type:e})}}const Qe={indexedDB:(()=>{try{return window.indexedDB??window.mozIndexedDB??window.webkitIndexedDB??window.msIndexedDB??null}catch{return null}})(),transaction:(()=>{try{return window.IDBTransaction??window.mozIDBTransaction??window.webkitIDBTransaction??window.msIDBTransaction??null}catch{return null}})(),db:null,canSave(){return!!(Qe.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return Qe.db?Qe.db:Qe.db=new Promise((n,t)=>{const e=Qe.indexedDB.open("dddg",3);e.onerror=o=>{t(o)},e.onupgradeneeded=o=>{const s=e.result,r=o.oldVersion??o.version;r<1&&s.createObjectStore("settings"),r===1&&(s.deleteObjectStore("settings"),s.createObjectStore("settings"))},e.onsuccess=()=>{n(e.result)}})},clearDB(){return new Promise((n,t)=>{if(!Qe.db){n();return}const e=Qe.indexedDB.deleteDatabase("dddg");Qe.db=null,e.onerror=o=>{t(o)},e.onsuccess=()=>{n()}})},loadAutoload(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("autoload")))},saveAutoload(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put([...n],"autoload"))})},loadGameMode(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("gameMode")))},saveGameMode(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put(n,"gameMode"))})},saveTemplate(n){return this.objectStorePromise("readwrite",async t=>{n==null?await this.reqPromise(t.delete("template")):await this.reqPromise(t.put(n,"template"))})},loadTemplate(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("template")))},saveSettings(n){return this.objectStorePromise("readwrite",async t=>{await this.reqPromise(t.put({...n},"settings"))})},loadSettings(){return this.objectStorePromise("readonly",async n=>await this.reqPromise(n.get("settings")))},async objectStorePromise(n,t){const e=await this.db;if(!e)throw new Error("No database");const s=e.transaction(["settings"],n).objectStore("settings");return await t(s)},reqPromise(n){return new Promise((t,e)=>{n.onerror=o=>{e(o)},n.onsuccess=()=>{t(n.result)}})}};class jw extends Up{saveToFile(t,e,o="image/png",s=1){let r=t.toDataURL(o,s);const i=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,e),Promise.resolve(r)}}class Rw{constructor(){C(this,"state",Jt({looseTextParsing:!0,autoAdd:[],downloadLocation:"",hasTemplate:!1}));C(this,"localRepositoryUrl","/repo/");C(this,"_gameMode",null);C(this,"electron",window);C(this,"bgInvalidation",null);C(this,"loadingContentPacksAllowed");C(this,"loadContentPacks");C(this,"updateProgress",I("wait"));C(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1});C(this,"savingEnabled",!0);this.loadingContentPacksAllowed=new Promise(e=>{this.loadContentPacks=()=>e()}),this.electron.ipcRenderer.on("add-persistent-content-pack",async e=>{await this.loadingContentPacksAllowed,await ie(async()=>{await H.content.loadContentPacks(e)})}),this.electron.ipcRenderer.on("add-persistent-background",async e=>{const o="persistentBg-"+e,s=e.split("/");zp(o,e),bd.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()}),this.electron.ipcRenderer.on("push-message",e=>{je.fire(new _t(e))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",e=>{this.state.downloadLocation=e}),this.electron.ipcRenderer.onConversation("load-packs",async e=>{const o=await Wn.getInstance(),s=await Promise.all(e.map(async r=>{const[i,l]=r.split(";",2);l!=null&&!o.hasPack(i)&&await o.loadTempPack(l);const a=o.getPack(i);return a.dddg2Path||a.dddg1Path}));await ie(async()=>{await H.content.loadContentPacks(s)})}),this.electron.ipcRenderer.onConversation("auto-load.changed",e=>{this.state.autoAdd=e}),this.electron.ipcRenderer.onConversation("reload-repo",async()=>{await(await Wn.getInstance()).reloadLocalRepo()}),this.electron.ipcRenderer.onConversation("replace-pack",async e=>{const o={processed:!1,contentPack:e};await ie(async()=>{await H.content.replaceContentPack(o)})}),this.electron.ipcRenderer.onConversation("resolvable-error",(e,o)=>new Promise(s=>{je.fire(new fa(e,o.map(r=>({exec:()=>s(r),name:r}))))}));let t=!1;this.electron.ipcRenderer.on("update.progress",e=>{this.updateProgress.value=e,e==="done"?(t=!1,je.fire(new _t("An update is downloaded and will be installed once DDDG closes."))):t||(t=!0,je.fire(new _t("An update was found and will download in the background.")))}),this.electron.ipcRenderer.on("update.checkStopped",()=>{this.updateProgress.value="none"}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}loadDefaultTemplate(){throw new Error("Method not implemented.")}saveDefaultTemplate(){throw new Error("Method not implemented.")}clearDefaultTemplate(){throw new Error("Method not implemented.")}storeSaveFile(t,e){const o=document.createElement("a"),s=URL.createObjectURL(t);return o.setAttribute("download",e),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(t){this.electron.ipcRenderer.send("open-folder",t)}onPanelChange(){}async saveSettings(t){await this.electron.ipcRenderer.sendConvo("config.set","nsfw",t.nsfw),await this.electron.ipcRenderer.sendConvo("config.set","darkMode",t.darkMode??void 0),await this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",t.defaultCharacterTalkingZoom)}async loadGameMode(){this._gameMode=await this.electron.ipcRenderer.sendConvo("config.get","gameMode")||"ddlc"}async setGameMode(t){await this.electron.ipcRenderer.sendConvo("config.set","gameMode",t),this.electron.ipcRenderer.send("reload")}async loadSettings(){return{lq:!1,nsfw:await this.electron.ipcRenderer.sendConvo("config.get","nsfw")??!1,darkMode:await this.electron.ipcRenderer.sendConvo("config.get","darkMode")??void 0,defaultCharacterTalkingZoom:await this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom")??void 0}}async localRepoInstall(t,e,o){await this.electron.ipcRenderer.sendConvo("repo.install",t,e,o)}async localRepoUninstall(t){await this.electron.ipcRenderer.sendConvo("repo.uninstall",t)}async autoLoadAdd(t){await this.electron.ipcRenderer.sendConvo("auto-load.add",t)}async autoLoadRemove(t){await this.electron.ipcRenderer.sendConvo("auto-load.remove",t)}saveToFile(t,e,o="image/png",s=1){return new Promise((r,i)=>{t.toBlob(async l=>{if(!l){i();return}const a=await l.arrayBuffer();await this.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(a)),r(URL.createObjectURL(l))},o,s)})}async prompt(t,e){return await this.electron.ipcRenderer.sendConvo("show-prompt",t,e)}openNewWindow(){return window.open(void 0,"_blank","left=100,top=100")}invalidateInstalledBGs(){this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),ie(async()=>{await H.content.replaceContentPack({contentPack:bd,processed:!1})})}}const bd={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};function Aw(){return window.isElectron?new Rw:"msSaveOrOpenBlob"in window.navigator?new jw:new Up}const ve=Aw(),qp="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!--%20Source:%20https://fonts.google.com/icons?selected=Material%2520Icons%2520Round%253Awarning%253A%20--%3e%3csvg%20fill='%23FFFFFF'%20version='1.1'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cfilter%20id='a'%20x='-.07126'%20y='-.079384'%20width='1.1425'%20height='1.1597'%20color-interpolation-filters='sRGB'%3e%3cfeGaussianBlur%20stdDeviation='0.36070242'/%3e%3c/filter%3e%3c/defs%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23fff'%20filter='url(%23a)'%20stroke='%23fff'/%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23000'/%3e%3c/svg%3e";let Hl=null;setTimeout(()=>po(qp).then(n=>{n instanceof Nn&&(Hl=n)}),0);class as{constructor(){C(this,"width",300);C(this,"height",300)}paintOnto(t,e={}){Hl&&Hl.paintOnto(t,e)}}let hl;function fo(){if(hl)return hl;if(!ve.supports.allowWebP)return Promise.resolve(!1);const n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",t="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return hl=(async()=>{const e=await Promise.all([Wl(n,1,2),Wl(t,720,1280)]);return e[0]&&e[1]})()}function Wl(n,t,e){return new Promise(o=>{const s=document.createElement("img");s.addEventListener("load",()=>{o(s.width===e&&s.height===t)}),s.addEventListener("error",()=>{o(!1)}),s.src=n})}let vl;function Iw(){return vl||(vl=(async()=>await Wl("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2))())}class Mw{constructor(){C(this,"cache",new Map)}get(t){const e=this.cache.get(t);if(e)return e;const o=ar(t);return this.cache.set(t,o),o}remove(t){this.cache.delete(t)}}class Dw{constructor(){C(this,"cache",new Map)}get(t){var s;const e=(s=this.cache.get(t))==null?void 0:s.deref();if(e)return e;const o=Ew(t);return this.cache.set(t,new WeakRef(o)),o}remove(t){this.cache.delete(t)}}let gl=null;function lr(){return gl||(window.assetCache=gl=ve.supports.assetCaching||typeof WeakRef>"u"?new Mw:new Dw)}const Vn={};function Fa(n,t=!0){return po(ve.supports.lq&&!t?n.lq:n.hq)}function kn(n,t=!0){const e=ve.supports.lq&&ha&&!t?n.lq:n.hq;return Vn[e]?Vn[e]:e}function po(n){return Vn[n]&&(n=Vn[n]),lr().get(n)}async function us(n,t=!0){const e=`${pa}${n}${ve.supports.lq&&ha&&!t?".lq":""}${await fo()?".webp":".png"}`.replace(/\/+/,"/");return await lr().get(e)}async function Bw(n,t=!0){return`${pa}${n}${ve.supports.lq&&ha&&!t?".lq":""}${await fo()?".webp":".png"}`.replace(/\/+/,"/")}function zp(n,t){Vn[n]=t}async function Ew(n){const t=!!Vn[n];return t&&(n=Vn[n]),await(async()=>{try{return await ar(n)}catch{if(n.endsWith(".webp")&&!t)try{return await ar(n.replace(/\.webp$/,".png"))}catch{return je.fire(new Zs(n)),lr().remove(n),new as}else return je.fire(new Zs(n)),lr().remove(n),new as}})()}function ar(n,t=!1){return new Promise(e=>{const o=new Image;o.addEventListener("load",()=>{e(new Nn(o)),(t||!ve.supports.assetCaching)&&document.body.removeChild(o)}),o.addEventListener("error",()=>{e(new as),(t||!ve.supports.assetCaching)&&document.body.removeChild(o)}),o.crossOrigin="Anonymous",o.src=n,o.style.display="none",document.body.appendChild(o)})}class Gn{}class ho{constructor(t,e,o,s){C(this,"aborted",!1);this.canvas=t,this.fsCtx=e,this.hq=o,this.preview=s}static make(t,e,o){return new ho(t,t.getContext("2d"),e,o)}static makeWithContext(t,e,o,s){return new ho(t,e,o,s)}drawText(t){if(this.aborted)throw new Gn;this.fsCtx.save();const{font:e,align:o,x:s=0,y:r=0,text:i=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(i,s,r)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(i,s,r)),this.fsCtx.restore()}measureText(t){if(this.aborted)throw new Gn;this.fsCtx.save();const{font:e,align:o,text:s=""}={font:"20px aller",align:"left",...t};this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=e,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(t){if(this.aborted)throw new Gn;const{image:e,flip:o,x:s,y:r,w:i,h:l,filters:a,composite:u}={flip:!1,w:t.image.width,h:t.image.height,composite:"source-over",...t};if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=u,a)if("filter"in this.fsCtx){const c=[];for(const f of a)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of a)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(t.shadow){const c=t.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(t.rotation!=null&&t.rotation!==0){const c=t.rotationAnchor?t.rotationAnchor.x:0,f=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+i/2,r+l/2),this.fsCtx.scale(o?-1:1,1),e.paintOnto(this.fsCtx,{x:-i/2,y:-l/2,w:i,h:l}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:t,y:e,w:o,h:s,outline:r,fill:i,composition:l,rotation:a,rotationAnchor:u}){if(this.aborted)throw new Gn;if(this.fsCtx.save(),a!=null&&a!==0){const c=u?u.x:0,f=u?u.y:0;u&&this.fsCtx.translate(c,f),this.fsCtx.rotate(a),u&&this.fsCtx.translate(-c,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(t,e,o,s),l&&(this.fsCtx.globalCompositeOperation=l),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:t,fill:e,path:o}){if(this.aborted)throw new Gn;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),e&&(this.fsCtx.fillStyle=e.style,this.fsCtx.fill()),t&&(this.fsCtx.strokeStyle=t.style,this.fsCtx.lineWidth=t.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(t,e="repeat"){return t instanceof Xp&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}async customTransform(t,e){this.fsCtx.save(),await t(this.fsCtx),await e(this),this.fsCtx.restore()}linearGradient(t,e,o,s){return this.fsCtx.createLinearGradient(t,e,o,s)}applyFilters(t){if(t.length===0)return;this.fsCtx.save();let e=1;for(const o of t)o.type==="opacity"&&(e*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of t)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),e!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${e})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}class Xp{constructor(t,e){C(this,"previewCanvas");C(this,"runningContext",null);C(this,"_disposed",!1);const o=fe();this.previewCanvas=Hn(),this.previewCanvas.width=t??o.Base.screenWidth,this.previewCanvas.height=e??o.Base.screenHeight}get disposed(){return this._disposed}async render(t,e=!0,o=!0){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=ho.makeWithContext(this.previewCanvas,s,e,o);try{await t(this.runningContext)}catch(i){if(i instanceof Gn)return!1;throw i}finally{r===this.runningContext&&(this.runningContext=null)}return!0}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(t,e){e.w!=null&&e.h!=null?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}async download(t,e){const o=await this.drawToCanvas(t);return await ve.saveToFile(o,e)}async renderToBlob(t){const e=await this.drawToCanvas(t);return await new Promise((o,s)=>{e.toBlob(r=>{r?o(r):s()})})}async drawToCanvas(t){const e=Hn();e.width=this.previewCanvas.width,e.height=this.previewCanvas.height;const o=e.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),await t(ho.makeWithContext(e,o,!0,!1)),e}dispose(){this.runningContext&&this.runningContext.abort(),co(this.previewCanvas),this._disposed=!0}getDataAt(t,e){return this.previewCanvas.getContext("2d").getImageData(t,e,1,1).data}}class Lw{constructor(t,e,o,s,r,i){this.id=t,this.assets=e,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=i}async render(t){const{screenWidth:e,screenHeight:o}=fe().Base,s=await Promise.all(this.assets.map(r=>Fa(r,t.hq)));for(const r of s){let i=0,l=0,a=r.width,u=r.height;const c=this.scale;switch(c){case Ns.None:i=e/2-a/2,l=o/2-u/2;break;case Ns.Stretch:a=e,u=o;break;case Ns.Cover:{const f=a/u,m=e/o;f>m?(u=o,a=u*f):(a=e,u=a/f),i=e/2-a/2,l=o/2-u/2;break}default:throw new Kt.UnreachableCaseError(c)}t.drawImage({image:r,x:i,y:l,w:a,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters})}}}const yd={id:"buildin.static-color",name:"Static color",color:"#000000",render(n){const{screenWidth:t,screenHeight:e}=fe().Base;return n.drawRect({x:0,y:0,w:t,h:e,fill:{style:this.color}}),Promise.resolve()}};class Yp extends Hp{constructor(){super(...arguments);C(this,"lastUploadCount",0);C(this,"lastHq",null);C(this,"missingAsset",!1);C(this,"_canSkipLocal",!1);C(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareRender(e){super.prepareRender(e);let o=!1;if(this.missingAsset){const s=Object.keys(H.uploadUrls).length;s!==this.lastUploadCount&&(this.lastHq=null),this.lastUploadCount=s}if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),o||(o=!!this.assetList.find(s=>!("loadedAssets"in s)||s.hasMissing))),!e!==this.lastHq)for(let s=0;s<this.assetList.length;++s){const r=this.assetList[s];"loadedAssets"in r&&!r.assets.every(i=>i.hq===i.lq)&&(this.assetList[s]={assets:r.assets,offset:r.offset,composite:r.composite},o=!0)}if(this.lastHq=!e,!!o)return this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!e)}getAssetsSize(){let e=0,o=0;for(const s of this.assetList)if("loadedAssets"in s)for(const r of s.loadedAssets)e=Math.max(e,s.offset[0]+r.width),o=Math.max(o,s.offset[1]+r.height);return new DOMPointReadOnly(e,o)}loadAssets(e){const o=[];this.missingAsset=!1;for(const s of this.assetList)"loadedAssets"in s&&!s.hasMissing||o.push((async r=>{const i=await Promise.all(r.assets.map(a=>Fa(a,e))),l=r;l.loadedAssets=i,l.hasMissing=i.some(a=>a instanceof as),this.missingAsset||(this.missingAsset=l.hasMissing)})(s));if(o.length!==0)return Promise.all(o)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e){console.log("rerendering local");for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=o.composite??"source-over"),s instanceof as?s.paintOnto(e,{x:o.offset[0],y:o.offset[1],h:this.height,w:this.width}):s.paintOnto(e,{x:o.offset[0],y:o.offset[1]})}}class Nw extends Yp{constructor(e){super(e);C(this,"data");this.data=H.content.characters.get(this.obj.characterType)}prepareRender(e){return super.prepareRender(e)}isAssetListOutdated(){return!0}getAssetList(){const e=this.obj.poseData,o=this.obj.headsData,s=[],r=this.assetList??[];for(const i of e.renderCommands){let l=null;switch(i.type){case"head":{if(!o)continue;const a=o.variants[this.obj.posePositions.head||0];if(a==null)continue;l=a;break}case"image":l=i.images;break;case"pose-part":{const a=e.positions[i.part];if(!a||a.length===0)break;const u=a[this.obj.posePositions[i.part]||0];if(!u)break;l=u;break}}if(l){const a=r.find(u=>u.assets===l);a?s.push({...a,offset:i.offset,composite:i.composite}):s.push({assets:l,offset:i.offset,composite:i.composite})}}return s}}class Hw extends Ir{constructor(){super(...arguments);C(this,"_height",0);C(this,"choiceRenderers",[])}get height(){const e=fe().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=fe().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e){const o=fe().Choices,s=this.obj.width,r=o.ChoiceOuterPadding;let i=o.ChoiceOuterPadding;for(const l of this.choiceRenderers){const a=l.getHeight(this.obj.autoWrap?s:0);e.strokeStyle=o.ChoiceButtonBorderColor,e.lineWidth=o.Outline,e.fillStyle=o.ChoiceButtonColor,e.fillRect(r,i,s,a+o.ChoicePadding*2),e.strokeRect(r,i,s,a+o.ChoicePadding*2),l.applyLayout("center",r+o.ChoicePadding,i+o.ChoiceSpacing*1.25,s-o.ChoicePadding*2,this.obj.autoWrap),l.render(e),i+=a+o.ChoicePadding*2+o.ChoiceSpacing}}prepareRender(e){const o=fe();this.choiceRenderers=this.obj.choices.map(i=>new Dt(i.text||" ",o.Choices.ChoiceTextStyle));const s=()=>(this._height=this.choiceRenderers.reduce((i,l)=>i+l.getHeight(this.obj.autoWrap?this.obj.width:0)+o.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e)),r=this.choiceRenderers.map(i=>i.loadFonts()).filter(i=>i!==void 0);if(r.length===0)s();else return Promise.all(r).then(s)}}class Ww extends Ir{constructor(){super(...arguments);C(this,"_height",0);C(this,"_width",0);C(this,"_textRenderer",null);C(this,"_buttonRenderer",null)}get height(){const e=fe().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=fe().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e){const o=super.prepareRender(e),s=fe().Notification,r=this._textRenderer=new Dt(this.obj.text,s.NotificationTextStyle),i=this._buttonRenderer=new Dt("OK",s.NotificationOkTextStyle),l=r.loadFonts(),a=i.loadFonts(),u=()=>{const c=this.obj.autoWrap?this.obj.width-s.NotificationPadding*2:0,f=this.obj.autoWrap?c:r.getWidth(),m=r.getHeight(c),b=this.obj.autoWrap?c:i.getWidth(),_=i.getHeight(c);this._width=Math.max(f,b)+s.NotificationPadding*2,this._height=m+s.NotificationPadding*2+s.NotificationSpacing+_};if(o||l||a)return Promise.all([o,l,a]).then(u);u()}render(e,o,s,r,i){return this.obj.backdrop&&wn(e,()=>{const l=fe();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,o,s,r,i)}renderLocal(e){const o=fe(),s=this._textRenderer,r=this._buttonRenderer,i=this._width,l=this._height,a=o.Choices.ChoiceOuterPadding;e.fillStyle=o.Choices.ChoiceButtonColor,e.strokeStyle=o.Choices.ChoiceButtonBorderColor,e.lineWidth=o.Choices.Outline,e.fillRect(a,a,i,l),e.strokeRect(a,a,i,l),s.applyLayout("center",a+o.Notification.NotificationPadding,a+o.Notification.NotificationPadding*1.5,i-o.Notification.NotificationPadding*2,!1),s.render(e),r.applyLayout("center",a,a+l-o.Notification.NotificationPadding,i+a,!1),r.render(e)}}const Vw=-2,Fw=26,Uw=10,qw=10;class zw extends Ir{constructor(){super(...arguments);C(this,"_paperHeight",null);C(this,"_paperWidth",null);C(this,"_paper",null);C(this,"_lastPaperUrl",null)}get height(){return this._paperHeight??this.obj.height}get width(){return this._paperWidth??this.obj.width}prepareRender(e){const o=super.prepareRender(e),s=fe().Poem,r=s.poemBackgrounds[this.obj.background],i=s.poemTextStyles[this.obj.font],a=new Dt(this.obj.text,i).loadFonts();let u;if(r.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==r.file&&(u=(async()=>{this._paper=await po(`assets/poemBackgrounds/${r.file}`),this._lastPaperUrl=r.file,this._paperHeight=this._paper.height*s.backgroundScale,this._paperWidth=this._paper.width*s.backgroundScale})()),o||a||u)return Promise.all([o,a,u])}renderLocal(e){const o=fe().Poem,s=o.poemBackgrounds[this.obj.background],r=this.width,i=this.height;let l=o.poemPadding,a=o.poemTopPadding,u=l*2;if(s.file==="internal:console")e.fillStyle=this.obj.consoleColor||o.consoleBackgroundColor,e.fillRect(0,0,r,i),l=Vw,a=Fw,u=Uw;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:r,h:i}),!this.obj.overflow)){const m=new Path2D;m.rect(0,0,r,i),e.clip(m)}const c=o.poemTextStyles[this.obj.font],f=new Dt(this.obj.text,c);f.applyLayout("left",qw+l,l+a,this.width-u,this.obj.autoWrap),f.render(e)}}class Xw extends Yp{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}const pr=class pr{constructor(t,e,o,s){C(this,"renderObjectCache",new Map);C(this,"renderer");C(this,"_disposed",!1);this._panelId=t,this.canvasWidth=e,this.canvasHeight=o,this.viewport=s,this.renderer=new Xp(e,o)}get panelId(){return this._panelId}setPanelId(t){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==t&&(this._panelId=t,this.renderObjectCache.forEach(e=>{e.dispose()}),this.renderObjectCache.clear())}render(t,e,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),t,e):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const t=new Date,e=`panel-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),e)}paintOnto(t,e){this.renderer.paintOnto(t,e)}objectsAt(t,e){const o=new DOMPointReadOnly(t,e);return this.getRenderObjects().filter(s=>s.hitTest(o)).map(s=>s.id)}getLastRenderObject(t){return this.renderObjectCache.get(t)??null}async renderCallback(t,e){var u,c,f;if(this._disposed)throw new Error("Disposed scene-renderer called");e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",await((u=this.getBackgroundRenderer())==null?void 0:u.render(e));const o=this.getRenderObjects(),s=o.map(m=>m.prepareRender(!e.hq)).filter(m=>m!==void 0);s.length>0&&await Promise.all(s);const r=((c=this.viewport)==null?void 0:c.selection)??null,i=new Set;r!==null&&a(r,i);const l=(f=document.querySelector(pr.FocusProp))==null?void 0:f.getAttribute("data-obj-id");for(const m of o){const b=r===m.id,_=l===""+m.id;m.render(e.fsCtx,(b?on.Selected:i.has(m.id)?on.Indirectly:on.None)+(_?on.Focused:on.None),e.preview,e.hq,t)}e.applyFilters([...this.panel.filters]),e.preview&&e.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:await us("backgrounds/transparent")});function a(m,b){b.add(m);for(const _ of o.filter(y=>y.linkedTo===m))a(_.id,b)}}getRenderObjects(){const t=H.panels.panels[this.panelId],e=[...t.lowerOrder,...t.topOrder],o=t.objects,s=Array.from(this.renderObjectCache.keys()).filter(r=>!e.includes(r));for(const r of s)this.renderObjectCache.get(r).dispose(),this.renderObjectCache.delete(r);return e.map(r=>{let i=this.renderObjectCache.get(r);if(!i){const l=o[r],a=l.type;switch(a){case"sprite":i=new Xw(l);break;case"character":{i=new Nw(l);break}case"textBox":i=new yw(l);break;case"choice":i=new Hw(l);break;case"notification":i=new Ww(l);break;case"poem":i=new zw(l);break;default:throw new Kt.UnreachableCaseError(a)}this.renderObjectCache.set(r,i)}return i})}get panel(){return H.panels.panels[this.panelId]}getBackgroundRenderer(){const t=this.panel;switch(t.background.current){case"buildin.static-color":return yd.color=t.background.color,yd;default:{const o=H.content.backgrounds.get(t.background.current);if(!o)return null;const s=o.variants[t.background.variant];return new Lw(t.background.current,s,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}drawDebugZoom(t,e,o,s,r,i=7){const l=t.fsCtx.getImageData(e,o,s,r),a=document.createElement("canvas");a.width=s,a.height=r,a.getContext("2d").putImageData(l,0,0),t.fsCtx.imageSmoothingEnabled=!1,t.fsCtx.drawImage(a,0,0,s*i,r*i)}};C(pr,"FocusProp",typeof CSS<"u"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let cs=pr;const Vl=new WeakMap;window.asdwefweg=Vl;function ur(n){let t=Vl.get(n);if(t==null||t.disposed){if(n.currentPanel===-1)return null;const e=fe().Base;t=new cs(n.currentPanel,e.screenWidth,e.screenHeight,n),Vl.set(n,t)}return t}function Yw(n){if(n===null)return!1;if(n instanceof HTMLInputElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return n instanceof t.defaultView.HTMLInputElement}return!1}function Gw(n){if(n===null)return!1;if(n instanceof HTMLTextAreaElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLTextAreaElement:!1}return!1}function Kw(n){if(n instanceof HTMLElement)return!0;if("ownerDocument"in n){const t=n.ownerDocument;return t?n instanceof t.defaultView.HTMLElement:!1}return!1}function Jo(n){if(n instanceof MouseEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.MouseEvent:!1}function Jw(n){if(n instanceof TouchEvent)return!0;const t=n.target.ownerDocument;return t?n instanceof t.defaultView.TouchEvent:!1}const Zw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Qw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",e1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e",t1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e";async function vo(n,t){try{await t()}catch(e){n1(n,e)}}function n1(n,t){console.error("Error in promise",n,t),je.fire(new gs("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+n+'", '+o1(t)))}function o1(n){if(n instanceof Error){if(n.stack!=null){const t=n.stack.split(`
`);return t[0].includes(n.name)&&t[0].includes(n.message)?t[0]+`
<br />`+t[1]:n.name+": "+n.message+`
<br />`+t[0]}return n.name+": "+n.message}return n instanceof Object?JSON.stringify(n):""+n}const hn=window.devicePixelRatio??1;class s1{constructor(t){C(this,"dragData",null);C(this,"grabbies",[new Jp,new Kp]);this.viewport=t}paint(t,e){const o=r1(e),s=this.viewport.value;if(t.save(),this.dragData&&this.dragData.viewport===s)r(e,this.dragData.lastPos),this.dragData.grabby.paint(t,this.dragData),t.translate(this.dragData.lastPos.x,this.dragData.lastPos.y),t.scale(hn,hn),this.dragData.grabby.drawGrabby(t,new DOMPointReadOnly);else{const i=fe();t.translate(o.x,o.y),t.scale(hn,hn),e.x>i.Base.screenWidth/2&&t.scale(-1,1),e.y>i.Base.screenHeight/2&&t.scale(1,-1);for(let l=0;l<this.grabbies.length;l++){const a=this.grabbies[l];a.pos||(a.pos=l1(i1*(l+1))),a.drawGrabby(t,a.pos)}}t.restore();function r(i,l){t.save();try{t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(l.x,l.y),t.setLineDash([5*hn,5*hn]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}onDown(t){const e=this.viewport.value,o=fe(),s=this.grabbies.find(r=>{const i=r.lastDrawPos;return i?Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))<=o.Base.wheelWidth/2*hn:!1});return s?(this.dragData={lastPos:t,started:!1,grabby:s,center:null,renderObj:null,viewport:e},!0):!1}onMove(t,e){var l;if(!this.dragData)return!1;const o=this.viewport.value,i=H.panels.panels[o.currentPanel].objects[o.selection];if(!this.dragData.started){this.dragData.started=!0;const a=ur(o),u=a.getLastRenderObject(i.id),c=((l=a==null?void 0:a.getLastRenderObject(i.linkedTo))==null?void 0:l.transform)??new DOMMatrixReadOnly;this.dragData.renderObj=u,this.dragData.center=c.transformPoint(new DOMPointReadOnly(i.x,i.y)),this.dragData.grabby.onStartMove(i,this.dragData)}return this.dragData.lastPos=t,this.dragData.grabby.onMove(i,e,this.dragData),!0}onDrop(){return this.dragData?(this.dragData=null,!0):!1}}const Mr=2*Math.PI;class Gp{constructor(){C(this,"pos",null);C(this,"lastDrawPos",null)}drawGrabby(t,e){var i;const o=fe();t.save(),t.translate(e.x,e.y),this.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,o.Base.wheelWidth/2,o.Base.wheelWidth/2,0,0,Mr),t.closePath();const s=getComputedStyle(document.body);t.fillStyle=s.getPropertyValue("--accent-background"),t.strokeStyle=s.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const r=document.body.classList.contains("dark-theme")?this.iconDark:this.icon;(i=Fl.get(r))==null||i.paintOnto(t),t.restore()}}class Kp extends Gp{constructor(){super(...arguments);C(this,"icon",e1);C(this,"iconDark",t1);C(this,"pos",null);C(this,"lastDrawPos",null)}paint(e,{lastPos:o,center:s,initialDragAngle:r}){const{angle:i}=Hs(Zo(s,o)),l=fe().Base,a=so(r-i,Mr);e.beginPath(),e.moveTo(s.x,s.y);let u=r-Math.PI,c=u+i-r;if(a<=Math.PI){const f=c;c=u,u=f}e.arc(s.x,s.y,l.wheelInnerRadius,u,c),e.lineTo(s.x,s.y),e.globalCompositeOperation="difference",e.fillStyle="rgba(255, 255, 255, 1)",e.fill(),e.globalCompositeOperation="source-over"}onStartMove(e,o){o.initalObjRotation=e.rotation;const{angle:s}=Hs(Zo(o.center,o.lastPos));o.initialDragAngle=s}onMove(e,o,{center:s,initalObjRotation:r,initialDragAngle:i,lastPos:l}){const{angle:a}=Hs(Zo(s,l));let u=so(r+(a-i)/Math.PI*180,360);o&&(u=Math.round(u/22.5)*22.5),e.rotation!==u&&ie(()=>{H.panels.panels[e.panelId].objects[e.id].rotation=u})}}class Jp extends Gp{constructor(){super(...arguments);C(this,"icon",Zw);C(this,"iconDark",Qw);C(this,"pos",null);C(this,"lastDrawPos",null)}paint(e,{renderObj:o,originalObjTransform:s}){if(s!=null)try{o.transformOverride=s,wn(e,()=>{e.globalAlpha=.5,o.render(e,on.None,!0,!1,!0),e.globalAlpha=1})}finally{o.transformOverride=null}}onStartMove(e,o){o.originalObjTransform=o.renderObj.obj.globalTransform,o.initialScaleX=e.scaleX,o.initialScaleY=e.scaleY,o.initialDelta=Zo(o.center,o.lastPos)}onMove(e,o,{initialScaleX:s,initialScaleY:r,initialDelta:i,center:l,lastPos:a}){const u=fe(),c=Zo(l,a);let f=c.x/i.x*s,m=c.y/i.y*r;if(o){let b=c;l.x>u.Base.screenWidth/2&&(b=new DOMPointReadOnly(-b.x,b.y)),l.y>u.Base.screenHeight/2&&(b=new DOMPointReadOnly(b.x,-b.y));const{angle:_}=Hs(b),y=Math.round(_/Mr*11),w=(Math.abs(c.x)/Math.abs(i.x)+Math.abs(c.y)/Math.abs(i.y))/2;y===0||y===11?m=r:y===1?(f=-w*s,m=-w*r):y===2||y===3?f=s:y===4?(f=w*s,m=-w*r):y===5||y===6?m=r:y===7?(f=w*s,m=w*r):y===8||y===9?f=s:y===10&&(f=-w*s,m=w*r)}e.scaleX===f&&e.scaleY===m||ie(()=>{H.panels.panels[e.panelId].objects[e.id].scaleX=f,H.panels.panels[e.panelId].objects[e.id].scaleY=m})}}const Fl=new Map;for(const n of[Jp,Kp])vo("Loading grabby icon",async()=>{const t=new n;Fl.set(t.icon,await po(t.icon)),Fl.set(t.iconDark,await po(t.iconDark))});function r1(n){const t=fe(),e=t.Base.wheelWidth+t.Base.wheelInnerRadius*hn;return new DOMPointReadOnly(sr(e,n.x,t.Base.screenWidth-e),sr(e,n.y,t.Base.screenHeight-e))}const i1=Math.PI/6;function l1(n){const t=fe().Base;return new DOMPointReadOnly(t.wheelInnerRadius*Math.cos(n),t.wheelInnerRadius*Math.sin(n))}function Zo(n,t){return new DOMPointReadOnly(n.x-t.x,n.y-t.y)}function Hs(n){const t=Math.atan2(n.y,n.x);return{angle:so(t,Mr),distance:Math.sqrt(n.x*n.x+n.y*n.y)}}const a1=["height","width"],u1=xe({__name:"preview-render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean,default:!1}},setup(n,{expose:t}){const e=n,o=I(null),s=I(null),r=I(null),i=I(!1),l=I(!1),a=Ot(),u=B(()=>H.panels.panels[a.value.currentPanel]),c=new s1(a),f=Hf(),m=B(()=>H.panels.panels[a.value.currentPanel]),b=B(()=>H.ui.lqRendering);function _(){if(e.preLoading)return null;const oe=ur(a.value);return oe==null||oe.setPanelId(a.value.currentPanel),oe}const y=B(()=>(e.preLoading,fe().Base.screenHeight)),w=B(()=>(e.preLoading,fe().Base.screenWidth));function k(){r.value==null&&(r.value=requestAnimationFrame(h))}async function h(){var oe;if(r.value!=null&&(cancelAnimationFrame(r.value),r.value=null),!e.preLoading&&!H.unsafe){try{await((oe=_())==null?void 0:oe.render(!b.value,!0,!0))}catch(ye){console.log(ye)}p(),je.fire(new er)}}function v(){const oe=document.createElement("canvas");oe.height=y.value,oe.width=w.value;try{ho.make(oe,!0,!1).drawText({text:"Starting...",x:oe.width/2,y:oe.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),s.value.drawImage(oe,e.canvasWidth,e.canvasHeight)}finally{co(oe)}}function p(){const oe=_();i.value=!1,oe==null||oe.paintOnto(s.value,{x:0,y:0,w:w.value,h:y.value});const ye=oe==null?void 0:oe.getLastRenderObject(f.value);ye&&c.paint(s.value,ye.transform.transformPoint(new DOMPoint(0,0))),M.value=!1}function P(oe,ye,Be){const Se=o.value,st=oe-Se.offsetLeft,S=ye-Se.offsetTop;let T=st/Se.offsetWidth*Se.width,W=S/Se.offsetWidth*Se.width;if(Be){const Z=Be.transformPoint(new DOMPointReadOnly(T,W));T=Z.x,W=Z.y}return[T,W]}function D(oe){const[ye,Be]=P(oe.clientX,oe.clientY);if(F(ye,Be))return;if(l.value){l.value=!1;return}const Se=_().objectsAt(ye,Be),st=f.value,S=Se.findIndex(W=>W===st);let T;S===0?T=null:S!==-1?T=Se[S-1]:T=Se[Se.length-1]??null,ie(()=>{a.value.selection!==T&&(a.value.selection=T)})}window.redraw=function(){je.fire(new Qs)},Xe(()=>[e.canvasWidth,e.canvasHeight],()=>p()),je.subscribe(Qs,k),je.subscribe(tr,()=>{const oe=_();oe&&oe.setPanelId(-1)}),ie.onClear(()=>{k()}),Xe(()=>[f.value,a.value.currentPanel],()=>{k()}),Vt(()=>{s.value=o.value.getContext("2d"),v(),k()}),Sn(()=>{_().dispose()});const M=I(!1);async function g(oe){if(M.value)h(),M.value=!1;else{const ye=await ar(oe,!0);s.value.clearRect(0,0,o.value.width,o.value.height),ye.paintOnto(s.value,{x:0,y:0}),M.value=!0}}const O=B(()=>a.value.pickColor),j=B(()=>O.value?"crosshair":"default");function F(oe,ye){if(O.value){const Be=s.value.getImageData(oe,ye,1,1).data,Se=`rgba(${Be[0].toString()},${Be[1].toString()},${Be[2].toString()},${(Be[3]/255).toString()})`;return ie(()=>{a.value.pickColor=!1,je.fire(new nr(Se))}),!0}return!1}async function N(){const oe=await _().download(),ye=H.ui.lastDownload;H.ui.lastDownload=oe,ye!=null&&URL.revokeObjectURL(ye)}let E=null,se=null,X=0,x=0,A=0,Y=0;function He(oe){oe.preventDefault(),le(oe.clientX,oe.clientY)}function G(oe){le(oe.touches[0].clientX,oe.touches[0].clientY)}function le(oe,ye){var S,T;const Be=f.value;if(Be===null)return;E=m.value.objects[Be],se=((T=(S=ur(a.value).getLastRenderObject(E.linkedTo))==null?void 0:S.transform)==null?void 0:T.inverse())??new DOMMatrixReadOnly;const[Se,st]=P(oe,ye,se);Be!=null&&c.onDown(new DOMPointReadOnly(...P(oe,ye)))||(X=Se-E.x,x=st-E.y,A=E.x,Y=E.y)}function be(oe){oe.stopPropagation(),oe.preventDefault(),oe.dataTransfer.dropEffect="copy"}function Re(oe){if(!E)return;oe.preventDefault();const ye=Jo(oe)?oe.clientX:oe.touches[0].clientX,Be=Jo(oe)?oe.clientY:oe.touches[0].clientY;let[Se,st]=P(ye,Be,se);if(c.onMove(new DOMPointReadOnly(...P(ye,Be)),oe.shiftKey)){k();return}Se-=X,st-=x;const S=Math.abs(Se-A),T=Math.abs(st-Y);S+T>1&&(l.value=!0),oe.shiftKey&&(S>T?st=Y:Se=A),ie(async()=>{const W=H.panels.panels[E.panelId].objects[E.id];ie(()=>{W.x=Se,W.y=st})})}async function Ce(oe){if(oe.stopPropagation(),oe.preventDefault(),!!oe.dataTransfer){for(const ye of oe.dataTransfer.items)if(ye.kind==="file"&&ye.type.match(/image.*/)){const Be=ye.getAsFile(),Se=URL.createObjectURL(Be);try{const st=await H.uploadUrls.add(Be.name,Se);await ie(async()=>{await La.create(u.value,[{hq:st,lq:st,sourcePack:"dddg.uploaded.sprites"}])})}catch{URL.revokeObjectURL(Se)}}}}function tt(oe){if(c.onDrop()){k(),oe.preventDefault(),E=null,l.value=!0;return}E&&("TouchEvent"in window&&Jw(oe)&&(l.value=!1),E=null)}function Ue(oe){oe.buttons!==1&&(E=null,c.onDrop()&&k())}return t({download:N,blendOver:g}),(oe,ye)=>(R(),U("canvas",{id:"scaled_display",ref_key:"sd",ref:o,height:y.value,width:w.value,style:et({width:oe.canvasWidth+"px",height:oe.canvasHeight+"px",cursor:j.value}),draggable:"true",onClick:D,onTouchstart:G,onDragstart:He,onTouchmove:Re,onMousemove:Re,onTouchend:tt,onMouseup:tt,onDragover:be,onDrop:Ce,onMouseenter:Ue,onContextmenu:ye[0]||(ye[0]=he(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,a1))}}),c1=["disabled","title","aria-label"],d1={key:0,class:"material-icons","aria-hidden":"true"},f1={class:"content"},p1={key:1,class:"shortcut-popup"},h1=xe({__name:"d-button",props:{icon:{},iconPos:{default:"left"},disabled:{type:Boolean,default:!1},shortcut:{},title:{}},setup(n){const t=n,e=I(null),o=B(()=>t.shortcut!=null&&!t.shortcut.startsWith("!")),s=B(()=>{const i=t.shortcut;return i==null?"":i.startsWith("!")?i.substring(1):i});function r(i){t.disabled||i.key===t.shortcut&&i.ctrlKey&&!i.altKey&&!i.metaKey&&!i.shiftKey&&(e.value.focus({focusVisible:!1}),e.value.click(),i.preventDefault(),i.stopPropagation())}return Vt(()=>{t.shortcut!=null&&window.addEventListener("keydown",r)}),Sn(()=>{window.removeEventListener("keydown",r)}),(i,l)=>(R(),U("button",{class:Ne([i.iconPos]),disabled:i.disabled,title:i.title,"aria-label":i.title,style:et(i.icon?"height: auto":""),ref_key:"btn",ref:e},[i.icon?(R(),U("div",d1,Oe(i.icon),1)):de("",!0),d("div",f1,[Xt(i.$slots,"default",{},void 0,!0)]),o.value?(R(),U("div",p1,Oe(s.value),1)):de("",!0)],14,c1))}}),$e=De(h1,[["__scopeId","data-v-bbb09c0d"]]),v1={methods:{verticalScrollRedirect:Zp}};function Zp(n){if(n.type!=="wheel"||!n.currentTarget)return;const t=n.currentTarget,e=getComputedStyle(t),o=n;if(o.deltaY===0)return;if(e.overflowY==="auto"){if(o.deltaY>0){if(t.scrollHeight>t.scrollTop+t.clientHeight){n.stopPropagation();return}}else if(t.scrollTop>0){n.stopPropagation();return}}const s=t.scrollLeft;t.scrollLeft+=o.deltaY,t.scrollLeft!==s&&n.stopPropagation()}function Bt(n){const t=Pn();function e(){const s=n.value;return s==null?null:s.$el?s.$el:s}function o(){n.value!=null&&e().classList.toggle("vertical",t.value)}return Xe(()=>t.value,o),Vt(()=>{o(),e().addEventListener("wheel",s=>{t.value||Zp(s)},{passive:!0})}),{vertical:t,getRoot:e}}const g1=["title","onClick","onKeypress"],m1=["src","alt"],b1=xe({__name:"characters-tab",emits:["show-dialog"],setup(n,{emit:t}){const e=t,o=Ot(),s=B(()=>H.content.current.characters),r=B(()=>H.panels.panels[o.value.currentPanel]);function i(a){return a.chibi?ve.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){ie(async()=>{Dp.create(r.value,a)})}return(a,u)=>(R(),U(ue,null,[(R(!0),U(ue,null,ze(s.value,c=>(R(),U("div",{class:"character",tabindex:"0",key:c.id,title:c.label,onClick:he(f=>l(c.id),["left"]),onKeypress:[it(he(f=>l(c.id),["prevent","stop"]),["enter"]),it(he(f=>l(c.id),["prevent","stop"]),["space"])]},[d("img",{src:i(c),alt:c.label},null,8,m1)],40,g1))),128)),z($e,{class:"custom-sprite",icon:"extension",onClick:u[0]||(u[0]=c=>e("show-dialog","type: Characters"))},{default:ne(()=>u[1]||(u[1]=[te(" Search in content packs ")])),_:1})],64))}}),y1=De(b1,[["__scopeId","data-v-13d7a68a"]]),w1=xe({__name:"drop-target",emits:["drop"],setup(n,{expose:t,emit:e}){const o=e,s=I(!1),r=Pn();function i(){s.value=!0}function l(){s.value=!1}function a(u){if(l(),u.stopPropagation(),u.preventDefault(),!!u.dataTransfer){for(const c of u.dataTransfer.items)if(c.kind==="file"&&c.type.match(/image.*/)){const f=c.getAsFile();f!=null&&o("drop",f)}}}return t({show:i,hide:l}),(u,c)=>s.value?(R(),U("div",{key:0,onDragleave:c[0]||(c[0]=f=>s.value=!1),onDrop:a,class:Ne({vertical:J(r)})},[Xt(u.$slots,"default",{},void 0,!0)],34)):de("",!0)}}),Qp=De(w1,[["__scopeId","data-v-43b59d3a"]]),k1=["title","onClick","onKeypress"],C1=["title","onClick","onKeypress"],_1=xe({__name:"sprites-tab",emits:["show-dialog"],setup(n,{expose:t,emit:e}){const o=e,s=Ot(),r=B(()=>H.panels.panels[s.value.currentPanel]),i=B(()=>H.content.current.sprites.map(M=>{let g=null;const O=M.variants[0].map(j=>{const F=kn(j,!1);return F.startsWith("uploads:")?(Object.keys(H.uploadUrls),g=F,qp):F});return{...M,missing:g,urls:O}})),l=B(()=>ve.supports.openableFolders.has("sprites"));function a(M){return M.variants[0].map(g=>`url('${kn(g,!1)}')`).join(",")}async function u(M){await ie(async()=>{await La.create(r.value,M.variants[0])})}function c(){ve.openFolder("sprites")}const f=I(null);async function m(){const M=f.value,g=M.uploadingSprite;if(!M.files)return;if(M.files.length!==1){console.error("More than one file uploaded!");return}const O=M.files[0];await ie(async()=>{const j=URL.createObjectURL(O);await H.uploadUrls.add(g,j)})}function b(M){const g=f.value;g.uploadingSprite=kn(M.variants[0][0]).substring(8),g.click()}const _={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},y=I(null);function w(){const M=y.value;if(M.files)for(const g of M.files)h(g)}async function k(){const M=prompt("Enter the URL of the image");if(M==null)return;const g=M.split("/").slice(-1)[0];await v(g,M)}async function h(M){await ie(async g=>{const O=URL.createObjectURL(M),j=await H.uploadUrls.add(M.name,O);await v(M.name,j,g)})}async function v(M,g,O=ie){const j=H.content.contentPacks.find(N=>N.packId===_.packId)||_,F={...j,sprites:[...j.sprites,{id:g,label:M,variants:[[{lq:g,hq:g,sourcePack:_.packId}]],defaultScale:[1,1],hd:null}]};await O(async()=>{await H.content.replaceContentPack({contentPack:F,processed:!0})})}const p=I(null);function P(M){M.dataTransfer&&(M.dataTransfer.effectAllowed="none",Array.from(M.dataTransfer.items).find(g=>g.type.match(/^image.*$/))&&(M.dataTransfer.effectAllowed="link",p.value.show()))}function D(){p.value.hide()}return t({showDropTarget:P,hideDropTarget:D}),(M,g)=>(R(),U(ue,null,[z(Qp,{ref_key:"spriteDt",ref:p,class:"drop-target",onDrop:h},{default:ne(()=>g[2]||(g[2]=[te("Drop here to add as a new sprite ")])),_:1},512),(R(!0),U(ue,null,ze(i.value,O=>(R(),U(ue,null,[O.missing!==null?(R(),U("div",{class:"sprite",tabindex:"0",key:`${O.label}_missing`,title:O.label,style:et({background:a(O)}),onClick:j=>b(O),onKeypress:[it(he(j=>b(O),["prevent","stop"]),["enter"]),it(he(j=>b(O),["prevent","stop"]),["space"])]},Oe(O.label),45,k1)):(R(),U("div",{class:"sprite",tabindex:"0",key:O.label,title:O.label,style:et({background:a(O)}),onClick:j=>u(O),onKeypress:[it(he(j=>u(O),["prevent","stop"]),["enter"]),it(he(j=>u(O),["prevent","stop"]),["space"])]},Oe(O.label),45,C1))],64))),256)),z($e,{class:"custom-sprite v-w100",icon:"publish",onClick:g[0]||(g[0]=O=>y.value.click())},{default:ne(()=>[g[3]||(g[3]=te(" Upload new sprite ")),d("input",{type:"file",ref_key:"spriteUpload",ref:y,onChange:w,multiple:""},null,544)]),_:1}),z($e,{icon:"insert_link",onClick:k},{default:ne(()=>g[4]||(g[4]=[te(" New sprite from URL ")])),_:1}),z($e,{icon:"extension",onClick:g[1]||(g[1]=O=>o("show-dialog","type: Sprites"))},{default:ne(()=>g[5]||(g[5]=[te(" Search in content packs ")])),_:1}),l.value?(R(),ce($e,{key:0,icon:"folder",onClick:c},{default:ne(()=>g[6]||(g[6]=[te(" Open sprites folder ")])),_:1})):de("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:f,onChange:m},null,544)],64))}}),x1=De(_1,[["__scopeId","data-v-a1d39080"]]),S1=xe({__name:"ui-tab",setup(n){const t=Ot(),e=B(()=>H.panels.panels[t.value.currentPanel]);async function o(){ie(()=>{bn.create(e.value)})}async function s(){ie(()=>{Bp.create(e.value)})}async function r(){ie(()=>{Ep.create(e.value)})}async function i(){ie(()=>{Bl.createPoem(e.value)})}async function l(){ie(()=>{Bl.createConsole(e.value)})}return(a,u)=>(R(),U(ue,null,[d("button",{class:"v-w100",onClick:o},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:i},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:r},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:s},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}}),P1=["innerHTML"],O1=["disabled"],T1=xe({__name:"add-tool",setup(n){const t={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},e=I(null),o=I("characters"),s=I(null),{vertical:r}=Bt(e),i=B(()=>H.ui.clipboard!=null),l=Ot();function a(){ie(async()=>{H.ui.pasteObjects(H.panels.panels[l.value.currentPanel])})}return(u,c)=>(R(),U("div",{class:"panel",ref_key:"root",ref:e,onDragenter:c[2]||(c[2]=(...f)=>{var m,b;return((m=s.value)==null?void 0:m.showDropTarget)&&((b=s.value)==null?void 0:b.showDropTarget(...f))}),onMouseleave:c[3]||(c[3]=(...f)=>{var m,b;return((m=s.value)==null?void 0:m.hideDropTarget)&&((b=s.value)==null?void 0:b.hideDropTarget(...f))})},[c[4]||(c[4]=d("h1",null,"Add",-1)),d("div",{class:Ne({"group-selector":!0,vertical:J(r)})},[(R(),U(ue,null,ze(t,(f,m)=>z($e,{key:m,class:Ne({active:o.value===m,"v-bl0":m!=="characters","h-bt0":m!=="characters"}),"icon-pos":"top",icon:f.icon,shortcut:f.shortcut,onClick:b=>o.value=m},{default:ne(()=>[d("span",{innerHTML:f.text},null,8,P1)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:Ne({"item-grid":!0,vertical:J(r)})},[o.value==="characters"?(R(),ce(y1,{key:0,onShowDialog:c[0]||(c[0]=f=>u.$emit("show-dialog",f))})):o.value==="sprites"?(R(),ce(x1,{key:1,ref_key:"sprites",ref:s,onShowDialog:c[1]||(c[1]=f=>u.$emit("show-dialog",f))},null,512)):o.value==="ui"?(R(),ce(S1,{key:2})):de("",!0),d("button",{class:"v-w100",onClick:a,disabled:!i.value}," Paste ",8,O1)],2)],544))}}),$1=De(T1,[["__scopeId","data-v-ec062df1"]]),j1=["href"],Ze=xe({__name:"external-link",props:{to:{}},setup(n){const t=n,e=I(null),o=B(()=>{let s=t.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,i)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+i.replaceAll(" ","-")),s});return(s,r)=>(R(),U("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[Xt(s.$slots,"default")],8,j1))}}),R1=xe({__name:"app-credits",setup(n){const t=I(null);return Bt(t),(e,o)=>(R(),U("div",{class:"panel",ref_key:"root",ref:t},[o[35]||(o[35]=d("h1",null,"Help and Credits",-1)),z(Ze,{class:"btn",to:"wiki://Dokumentation"},{default:ne(()=>o[0]||(o[0]=[te("Help")])),_:1}),z(Ze,{class:"btn",to:"github://"},{default:ne(()=>o[1]||(o[1]=[te("Fork me on GitHub")])),_:1}),z(Ze,{class:"btn",to:"wiki://Privacy Statement"},{default:ne(()=>o[2]||(o[2]=[te("Privacy Statement")])),_:1}),o[36]||(o[36]=d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),o[37]||(o[37]=d("p",null,[te(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),te("Based on gemdude46's DDLC Shitpost generator ")],-1)),d("p",null,[o[4]||(o[4]=te(" Unused House Background by ")),z(Ze,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:ne(()=>o[3]||(o[3]=[te(" Fatelogic ")])),_:1})]),d("p",null,[o[6]||(o[6]=te(" Aller Font by ")),z(Ze,{to:"https://www.daltonmaag.com/library/aller"},{default:ne(()=>o[5]||(o[5]=[te("Dalton Maag Ltd")])),_:1})]),d("p",null,[o[8]||(o[8]=te(" Riffic Bold Font by ")),z(Ze,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:ne(()=>o[7]||(o[7]=[te("InkyType")])),_:1})]),d("p",null,[o[10]||(o[10]=te(" Verily Serif Mono Font by ")),z(Ze,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:ne(()=>o[9]||(o[9]=[te("Stephen G. Hartke")])),_:1})]),d("p",null,[o[12]||(o[12]=te(" F25 Bank Printer Font by ")),z(Ze,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:ne(()=>o[11]||(o[11]=[te("F25 Digital Typeface Design")])),_:1})]),d("p",null,[o[14]||(o[14]=te(" Journal Font by ")),z(Ze,{to:"https://www.dafont.com/journal.font"},{default:ne(()=>o[13]||(o[13]=[te("Fontourist")])),_:1})]),d("p",null,[o[16]||(o[16]=te(" Hashtag Font by ")),z(Ze,{to:"https://www.dafont.com/hashtag.font"},{default:ne(()=>o[15]||(o[15]=[te(" TitanVex")])),_:1})]),d("p",null,[o[18]||(o[18]=te(" JP Hand Slanted Font by ")),z(Ze,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:ne(()=>o[17]||(o[17]=[te("Jonathan Paterson")])),_:1})]),d("p",null,[o[20]||(o[20]=te(" As I Lay Dying Font by ")),z(Ze,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:ne(()=>o[19]||(o[19]=[te("Moises Esqueda")])),_:1})]),d("p",null,[o[22]||(o[22]=te(" Damagrafik Script Font by ")),z(Ze,{to:"https://www.dafont.com/damagrafik-script.font"},{default:ne(()=>o[21]||(o[21]=[te("Davide Terenzi")])),_:1})]),d("p",null,[o[24]||(o[24]=te(" Ammy's Handwriting Font by ")),z(Ze,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:ne(()=>o[23]||(o[23]=[te("Ammy K.")])),_:1})]),d("p",null,[o[26]||(o[26]=te(" Halogen Font by ")),z(Ze,{to:"https://www.dafont.com/halogen.font"},{default:ne(()=>o[25]||(o[25]=[te("JLH Fonts")])),_:1})]),o[38]||(o[38]=d("p",null,[te(" MC Sprite by Childish-N "),d("br"),te("MC Casual Sprite by SlightlySimple "),d("br"),te("MC Chibi by SlightlySimple ")],-1)),d("p",null,[z(Ze,{to:"https://www.reddit.com/r/DDLCMods/comments/1hhmu77/"},{default:ne(()=>o[27]||(o[27]=[te("Concept MC")])),_:1}),o[29]||(o[29]=te(" by StormBlazed76, ")),z(Ze,{to:"https://www.reddit.com/ofof3o"},{default:ne(()=>o[28]||(o[28]=[te("chibi")])),_:1}),o[30]||(o[30]=te(" by Hadrosaur838 "))]),o[39]||(o[39]=d("p",null,[te(" MC Chad Sprite by Cylent-Nite "),d("br"),te("MC Chad Poses and expressions by SlightlySimple "),d("br"),te("MC Chad Poses and chibi by Meddy-sin ")],-1)),o[40]||(o[40]=d("p",null,[te(" FeMC Sprite by Meddy-sin "),d("br"),te("FeMC Casual Sprite by SlightlySimple ")],-1)),d("p",null,[z(Ze,{to:"https://www.reddit.com/oizaow"},{default:ne(()=>o[31]||(o[31]=[te("Concept FeMC")])),_:1}),o[33]||(o[33]=te(" by ShidoDraws, ")),z(Ze,{to:"https://www.reddit.com/oosuxu"},{default:ne(()=>o[32]||(o[32]=[te("additional poses, expressions and chibi")])),_:1}),o[34]||(o[34]=te(" by SlightlySimple "))]),o[41]||(o[41]=d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),o[42]||(o[42]=d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),o[43]||(o[43]=d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1))],512))}}),A1=De(R1,[["__scopeId","data-v-deba67a0"]]);let Ul=0;typeof BigInt<"u"&&(Ul=BigInt(0));function Ua(){const n=Ul;return Ul++,n+""}const I1={class:"toggle_box"},M1=["id"],D1=["for"],B1=["for"],Ge=xe({__name:"d-toggle",props:En({label:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=hs(n,"modelValue"),e=Ua(),o=I(null);return(s,r)=>(R(),U("div",I1,[Pe(d("input",{id:J(e),type:"checkbox",ref_key:"checkbox",ref:o,"onUpdate:modelValue":r[0]||(r[0]=i=>t.value=i)},null,8,M1),[[jg,t.value]]),d("label",{for:J(e),class:"switch"},null,8,D1),d("label",{for:J(e),class:"toggle_label"},Oe(s.label),9,B1)]))}}),E1={class:"modal-scroll-area"},L1={class:"modal-scroll-area"},N1={key:0},H1={key:1},W1={key:2},V1={key:3,disabled:""},F1={class:"v-w100"},U1={key:7,class:"downloadTable"},q1=xe({__name:"app-settings",setup(n){const t=I(null),e=ve.updateProgress;Bt(t);function o(){ve.saveSettings({lq:H.ui.lqRendering,nsfw:H.ui.nsfw,darkMode:H.ui.useDarkTheme??void 0,looseTextParsing:ve.state.looseTextParsing,defaultCharacterTalkingZoom:H.ui.defaultCharacterTalkingZoom})}const s=B(()=>ve.supports.optionalSaving),r=I(!1),i=I(!1),l=I(!1),a=B({get(){return ve.savingEnabled},set(N){l.value=!0,ve.savingEnabled=N,o()}});function u(N){r.value=!1,N==="Allow"&&(a.value=!0)}function c(N){i.value=!1,N==="Deny"&&(a.value=!1)}Xe(()=>a.value,()=>l.value=!1);const f=I(!1),m=B(()=>ve.gameMode==="ddlc_plus");function b(N){vo("changing modes",async()=>{N==="Enter Classic Mode"?await ve.setGameMode("ddlc"):N==="Enter Plus mode"?await ve.setGameMode("ddlc_plus"):f.value=!1})}const _=B(()=>ve.supports.lq),y=B({get(){return H.ui.lqRendering},set(N){ie(()=>{H.ui.lqRendering=N}),o()}}),w=B({get(){return!!H.ui.nsfw},set(N){ie(()=>{H.ui.nsfw=N,o()})}}),k=B({get(){return!!H.ui.defaultCharacterTalkingZoom},set(N){ie(()=>{H.ui.defaultCharacterTalkingZoom=N,o()})}}),h=B({get(){return ve.state.looseTextParsing},set(N){ve.state.looseTextParsing=N,o()}}),v=B({get(){return H.ui.useDarkTheme},set(N){ie(()=>{H.ui.useDarkTheme=N,o()})}}),p=B(()=>ve.supports.setDownloadFolder),P=B(()=>ve.state.downloadLocation);function D(){ve.updateDownloadFolder()}function M(){ve.openFolder("downloads")}const g=B(()=>ve.state.hasTemplate);function O(){ve.saveDefaultTemplate()}function j(){ve.clearDefaultTemplate()}function F(){const N=ve.openNewWindow();if(!N){je.fire(new gs("Failed to open new window. You may need to enable popups."));return}const E=N.document.createElement("div");N.document.body.appendChild(E);for(const X of document.head.querySelectorAll("style,link[rel=stylesheet]"))N.document.head.appendChild(X.cloneNode(!0));document.body.classList.contains("dark-theme")&&N.document.body.classList.add("dark-theme");const se=N.document.createElement("title");N.document.title="DDLC child",N.document.head.appendChild(se),Ef(eh).mount(E)}return(N,E)=>(R(),U("div",{class:"panel",ref_key:"root",ref:t},[E[26]||(E[26]=d("h1",null,"Settings",-1)),(R(),ce(oa,{to:"#modal-messages"},[r.value?(R(),ce(Bn,{key:0,options:["Allow","Deny"],onLeave:E[0]||(E[0]=se=>u("Deny")),onOption:u,"no-base-size":""},{default:ne(()=>[d("div",E1,[E[14]||(E[14]=d("p",null," Do you want to allow DDDG to save settings on your device? ",-1)),E[15]||(E[15]=d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),E[16]||(E[16]=d("p",null,"You can revoke this permission at any time.",-1)),d("p",null,[E[12]||(E[12]=te(" Our usual ")),z(Ze,{to:"wiki://Privacy Statement"},{default:ne(()=>E[11]||(E[11]=[te("privacy policy")])),_:1}),E[13]||(E[13]=te(" still applies. "))])])]),_:1})):de("",!0),i.value?(R(),ce(Bn,{key:1,options:["Deny","Cancle"],onLeave:E[1]||(E[1]=se=>c("Cancel")),onOption:c,"no-base-size":""},{default:ne(()=>[d("div",L1,[E[20]||(E[20]=d("p",null," Do you want to deny DDDG from saving settings on your device? ",-1)),E[21]||(E[21]=d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),d("p",null,[E[18]||(E[18]=te(" Our usual ")),z(Ze,{to:"wiki://Privacy Statement"},{default:ne(()=>E[17]||(E[17]=[te("privacy policy")])),_:1}),E[19]||(E[19]=te(" still applies. "))])])]),_:1})):de("",!0),f.value?(R(),ce(Bn,{key:2,options:[m.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:E[2]||(E[2]=se=>f.value=!1),onOption:b,"no-base-size":""},{default:ne(()=>E[22]||(E[22]=[d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)])),_:1},8,["options"])):de("",!0)])),J(e)==="done"?(R(),U("p",N1," Update is successfully downloaded. It will be installed once the application is closed. ")):de("",!0),J(e)==="wait"?(R(),U("p",H1,"Checking for updates...")):de("",!0),typeof J(e)=="number"?(R(),U("p",W1," Downloading update ("+Oe(J(e))+"%) ",1)):de("",!0),l.value?(R(),U("button",V1,"Applying...")):!a.value&&s.value?(R(),U("button",{key:4,onClick:E[3]||(E[3]=se=>r.value=!0)}," Allow saving options ")):a.value&&s.value?(R(),U("button",{key:5,onClick:E[4]||(E[4]=se=>i.value=!0)}," Deny saving options ")):de("",!0),d("button",{onClick:E[5]||(E[5]=se=>f.value=!0),class:Ne(s.value?"bt0":"")},[m.value?(R(),U(ue,{key:0},[te(" Enter Classic Mode ")],64)):(R(),U(ue,{key:1},[te(" Enter DDLC Plus Mode ")],64))],2),d("button",{class:"bt0",onClick:F,style:{height:"auto"}}," Open additional window "),_.value?(R(),ce(Ge,{key:6,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:y.value,"onUpdate:modelValue":E[6]||(E[6]=se=>y.value=se)},null,8,["modelValue"])):de("",!0),z(Ge,{label:"NSFW Mode?",modelValue:w.value,"onUpdate:modelValue":E[7]||(E[7]=se=>w.value=se)},null,8,["modelValue"]),z(Ge,{label:"Enlarge talking objects? (Default value)",modelValue:k.value,"onUpdate:modelValue":E[8]||(E[8]=se=>k.value=se)},null,8,["modelValue"]),z(Ge,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:h.value,"onUpdate:modelValue":E[9]||(E[9]=se=>h.value=se)},null,8,["modelValue"]),d("table",F1,[d("tbody",null,[d("tr",null,[E[24]||(E[24]=d("td",null,[d("label",null,"Theme:")],-1)),d("td",null,[Pe(d("select",{"onUpdate:modelValue":E[10]||(E[10]=se=>v.value=se),class:"v-w100"},E[23]||(E[23]=[d("option",{value:null},"System",-1),d("option",{value:!1},"Light",-1),d("option",{value:!0},"Dark",-1)]),512),[[St,v.value]])])])])]),p.value?(R(),U("table",U1,[d("tbody",null,[d("tr",null,[E[25]||(E[25]=d("td",null,[d("label",null,"Download folder:")],-1)),d("td",null,Oe(P.value),1),d("td",null,[d("button",{onClick:D},"Set"),d("button",{onClick:M},"Open")])])])])):de("",!0),a.value?(R(),U(ue,{key:8},[d("button",{onClick:O},"Save as template"),g.value?(R(),U("button",{key:0,onClick:j}," Clear template ")):de("",!0)],64)):de("",!0)],512))}}),z1=De(q1,[["__scopeId","data-v-acdd373d"]]),X1=xe({mixins:[v1],inject:["viewport"],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.viewport.isVertical?"vertical":"horizontal":this.direction==="inverted"?this.viewport.isVertical?"horizontal":"vertical":this.direction}},render(){const n=this.noWraping?"no-wraping":"wraping",t=hu("div",{class:["d-flow",this.finalDirection,n],style:{gap:this.gap}},this.$slots.default());if(this.maxSize!==void 0){const e=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return hu("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:e}},[t])}return t},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}}),It=De(X1,[["__scopeId","data-v-592e1a80"]]),Y1=["for"],G1=["id","x1","x2"],K1=["offset"],J1=["fill"],Z1=["d"],Q1=["id","max","value"],Ts=255,ml=8,ek=xe({__name:"color-slider",props:En({label:{},gradientStops:{},maxValue:{},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=Ua(),s=Pn(),r=I(null),i=B(()=>{const b=e.value/t.maxValue*Ts;return`M${b} 0L${b+14} 0L${b+7} 12Z`}),l=B(()=>!t.shiftGradient||e.value===0?0:e.value/t.maxValue);function a(b){e.value=parseFloat(b.target.value)}const u=I(!1);function c(b){u.value=!0,f(b),Jo(b)&&(window.addEventListener("mousemove",f),window.addEventListener("mouseup",m)),b.preventDefault()}function f(b){if(!u.value)return;const _=r.value;if(Jo(b)&&b.buttons===0){m();return}b.preventDefault();const y=_.getBoundingClientRect(),w=y.width/(ml+Ts+ml),h=((Jo(b)?b.clientX:b.touches[0].clientX)-y.x)/w,v=Math.max(Math.min(h-ml,Ts),0)/Ts*t.maxValue;e.value=v,b.preventDefault()}function m(){u.value=!1,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",m)}return(b,_)=>(R(),U("div",{class:Ne({slider:!0,vertical:J(s)}),onKeydown:_[1]||(_[1]=he(()=>{},["stop"]))},[b.noInput?de("",!0):(R(),U("label",{key:0,for:J(o)},Oe(b.label),9,Y1)),d("div",null,[(R(),U("svg",{ref_key:"svg",ref:r,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:c,onTouchstart:c,onTouchmove:f,onTouchend:m},[d("defs",null,[d("linearGradient",{id:`gradient${J(o)}`,x1:l.value*100+"%",y1:"0%",x2:(l.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(R(!0),U(ue,null,ze(b.gradientStops,(y,w)=>(R(),U("stop",{key:w,offset:w/(b.gradientStops.length-1)*100+"%",style:et("stop-color:"+y)},null,12,K1))),128))],8,G1)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${J(o)})`},null,8,J1),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,Z1)])],544))]),b.noInput?de("",!0):(R(),U("input",{key:1,id:J(o),class:"sliderInput",min:"0",max:b.maxValue,value:e.value,type:"number",onInput:a,onKeydown:_[0]||(_[0]=he(()=>{},["stop"]))},null,40,Q1))],34))}}),In=De(ek,[["__scopeId","data-v-7d9ad553"]]),tk=xe({__name:"slider-group",props:En({mode:{default:"hsla"},relative:{type:Boolean,default:!1}},{modelValue:{required:!0,validator:n=>!!n.match(/^#[0-9a-f]{6,8}$/i)},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const t=n,e=hs(n,"modelValue"),o=I(null),s=I(0),r=I(0),i=I(0),l=I(0),a=w({rgba:{label:"Red",stops(){const k=t.relative?r.value:0,h=t.relative?i.value:0;return[new Le(0,k,h,1),new Le(255,k,h,1)]}},hsla:{label:"Hue",max:360,stops(){const k=t.relative?r.value/100:1,h=t.relative?i.value/100:.5;return y(v=>new Ve(v,k,h,1))}}}),u=w({rgba:{label:"Green",stops(){const k=t.relative?s.value:0,h=t.relative?i.value:0;return[new Le(k,0,h,1),new Le(k,255,h,1)]}},hsla:{label:"Saturation",stops(){const k=t.relative?s.value/360:0,h=t.relative?i.value/100:.5;return y(v=>new Ve(k,v,h,1))}}}),c=w({rgba:{label:"Blue",stops(){const k=t.relative?s.value:0,h=t.relative?r.value:0;return[new Le(k,h,0,1),new Le(k,h,255,1)]}},hsla:{label:"Luminosity",stops(){const k=t.relative?s.value/360:0,h=t.relative?r.value/100:.5;return y(v=>new Ve(k,h,v,1))}}}),f=B(()=>{const k=Le.fromHex(e.value);return[new Le(k.r,k.g,k.b,0).toCss(),new Le(k.r,k.g,k.b,1).toCss()]});function m(){e.value!==o.value&&_()}function b(){let k;t.mode==="rgba"?k=new Le(s.value,r.value,i.value,l.value/255):k=new Ve(s.value/360,r.value/100,i.value/100,l.value/255);const h=k.toRgb().toHex();if(o.value!==h){if(h.length!==9)throw new Error(`Invalid color code: ${h}`);o.value=h,e.value=h}}function _(){const k=Le.fromHex(e.value);if(o.value=k.toHex(),l.value=k.a*255,t.mode==="hsla"){const h=k.toHSL();s.value=h.h*360,r.value=h.s*100,i.value=h.l*100}else s.value=k.r,r.value=k.g,i.value=k.b}function y(k){const h=[];for(let v=0;v<=8;++v)h.push(k(v/8));return h}Xe(()=>e.value,m),Xe(()=>t.mode,_,{immediate:!0}),Xe(()=>[s.value,r.value,i.value,l.value],b);function w({rgba:k,hsla:h}){const v=B(()=>t.mode==="rgba"?255:h.max??100),p=B(()=>t.mode==="rgba"?k.label:h.label),P=B(()=>(t.mode==="rgba"?k.stops():h.stops()).map(M=>M.toRgb().toCss()));return{maxValue:v,label:p,stops:P}}return(k,h)=>(R(),U("div",null,[z(In,{label:J(a).label.value,modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=v=>s.value=v),"max-value":J(a).maxValue.value,"gradient-stops":J(a).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),z(In,{label:J(u).label.value,modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=v=>r.value=v),"max-value":J(u).maxValue.value,"gradient-stops":J(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),z(In,{label:J(c).label.value,modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=v=>i.value=v),"max-value":J(c).maxValue.value,"gradient-stops":J(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),z(In,{label:"Alpha",modelValue:l.value,"onUpdate:modelValue":h[3]||(h[3]=v=>l.value=v),"max-value":255,"gradient-stops":f.value},null,8,["modelValue","gradient-stops"])]))}}),nk=De(tk,[["__scopeId","data-v-0d496402"]]),ok={class:"v-w100 h-h100"},sk={class:"hex-selector"},rk=["for"],ik=["id","value"],lk=["title","onClick"],wd="dddg.generated.colors",ak=xe({inheritAttrs:!1,__name:"color-picker",props:En({title:{default:""},format:{default:"hex"}},{modelValue:{required:!0},modelModifiers:{}}),emits:En(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=n,o=hs(n,"modelValue"),s=t,r=Ua(),i=I("hsla"),l=Pn(),a=B({get(){return e.format==="rgb"?Le.fromCss(o.value).toHex():o.value},set(y){if(e.format==="rgb"){const w=Le.fromCss(y);o.value=w.toCss()}else o.value=y}});function u(y){const w=y.target.value;Le.validHex(w)&&(w.length===7||w.length===9)&&(a.value=w)}const c=B(()=>H.content.current.colors);function f(){if(c.value.find(k=>k.color===a.value))return;const y=H.content.contentPacks.find(k=>k.packId===wd)||{packId:wd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},w={...y,colors:[...y.colors,{label:a.value,color:a.value}]};ie(async()=>{await H.content.replaceContentPack({contentPack:w,processed:!0})})}const m=Ot();function b(){ie(()=>{m.value.pickColor=!0})}function _(y){a.value=Le.fromCss(y.color).toHex()}return Vt(()=>{je.subscribe(nr,_)}),Sn(()=>{je.unsubscribe(nr,_)}),(y,w)=>(R(),U("div",{class:Ne([{color:!0,vertical:J(l)},"v-w100 h-h100"])},[d("h2",null,Oe(y.title),1),d("button",{onClick:w[0]||(w[0]=k=>s("leave"))},"OK"),d("table",null,[d("tbody",null,[d("tr",null,[d("td",null,[d("button",{onClick:w[1]||(w[1]=k=>i.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:w[2]||(w[2]=k=>i.value="rgba")},"RGBA")])])])]),d("div",ok,[z(nk,{mode:i.value,modelValue:a.value,"onUpdate:modelValue":w[3]||(w[3]=k=>a.value=k),relative:!0},null,8,["mode","modelValue"]),d("div",sk,[d("label",{class:"hex-label",for:`hex_${J(r)}`},"Hex",8,rk),d("input",{id:`hex_${J(r)}`,value:a.value,onInput:u,onKeydown:w[4]||(w[4]=he(()=>{},["stop"]))},null,40,ik)]),z(It,{direction:"global",class:"color-tools"},{default:ne(()=>[d("button",{onClick:f},"Add as swatch"),z($e,{class:"h-bl0 v-bt0",icon:"colorize",onClick:b},{default:ne(()=>w[5]||(w[5]=[te("Pick color")])),_:1})]),_:1})]),d("div",{id:"color-swatches",class:Ne({vertical:J(l)})},[(R(!0),U(ue,null,ze(c.value,k=>(R(),U("button",{class:"swatch",key:k.color,style:et({backgroundColor:k.color}),title:k.label,onClick:h=>{a.value=k.color,s("leave")}},null,12,lk))),128))],2)],2))}}),Dr=De(ak,[["__scopeId","data-v-808c5333"]]),uk={class:"fieldset_wrapper"},ck={key:0},dk={class:"fieldset_contents"},fk=xe({__name:"d-fieldset",props:{title:{}},setup(n){const t=n;return(e,o)=>(R(),U("div",uk,[d("fieldset",null,[e.title>""?(R(),U("legend",ck,Oe(t.title),1)):de("",!0),d("div",dk,[Xt(e.$slots,"default",{},void 0,!0)])])]))}}),Pt=De(fk,[["__scopeId","data-v-bca80d0b"]]),pk={class:"column ok-col"},hk={key:0,class:"column"},vk=["value"],gk=["disabled"],mk=["disabled"],bk=["disabled"],yk=["disabled"],wk=["onClick","onKeydown"],kk={key:0,class:"value-input-table"},Ck=["value","max","min"],_k={key:0},xk={colspan:"2"},Sk=["value","max","min"],Pk={key:0},Ok={colspan:"2"},Tk=xe({__name:"image-options",props:{type:{},id:{},panelId:{},noComposition:{type:Boolean}},emits:["leave"],setup(n,{emit:t}){const e=n,o=t,s=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),r=(()=>{try{const X=Hn();X.width=0,X.height=0;const A="filter"in X.getContext("2d");if(co(X),A)return Array.from(s.keys()).sort()}catch{}return["opacity"]})(),i=I(null),l=I(0),a=B(()=>{switch(e.type){case"object":return H.panels.panels[e.panelId].objects[e.id];case"background":return H.panels.panels[e.panelId].background;case"panel":return H.panels.panels[e.panelId];default:throw new Kt.UnreachableCaseError(e.type)}}),u=B({get(){return a.value.composite},set(X){ie(()=>{a.value.composite=X})}}),c=B(()=>a.value.filters),f=B(()=>c.value[l.value]??null),m=B(()=>{const X=f.value;return X==null?!1:ad.has(X.type)}),b=B(()=>{const X=f.value;if(X!=null){if(X.type==="hue-rotate")return 360;if(X.type==="grayscale"||X.type==="sepia"||X.type==="opacity"||X.type==="invert")return 100}}),_=B(()=>{const X=f.value;if(X!=null)switch(X.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function y(X){return s.get(X)}function w(X){return ad.has(X.type)?`${s.get(X.type)} ${(X.value*100).toFixed()}%`:X.type==="hue-rotate"?`${s.get(X.type)} ${X.value.toFixed()}`:X.type==="blur"?`${s.get(X.type)} ${X.value.toFixed()}px`:s.get(X.type)}function k(){ie(()=>{const X=i.value;X!=null&&a.value.addFilter(X,l.value+1)})}function h(X){l.value=X}function v(){ie(()=>{a.value.removeFilter(l.value),l.value>=a.value.filters.length&&(l.value=a.value.filters.length-1)})}function p(X){ie(async()=>{a.value.moveFilter(l.value,X),l.value+=X})}function P(X){let x=Number(X.target.value);m.value&&(x=x/100),D(x)}function D(X){const x=a.value.filters[l.value];ie(()=>{x.value=X})}const M=B(()=>g(x=>new Ve(x,1,.5,1)).map(x=>x.toRgb().toCss()));function g(X){const x=[];for(let A=0;A<=8;++A)x.push(X(A/8));return x}const O=I(!1),j=se("color"),F=se("offsetX"),N=se("offsetY"),E=se("blurRadius");function se(X){return B({get(){const x=f.value;if(x==null||!(X in x))throw new Error("Tried reading shadow prop on a non shadow object");return x[X]},set(x){ie(()=>{const A=a.value.filters[l.value];A[X]=x})}})}return(X,x)=>O.value?(R(),ce(Dr,{key:0,modelValue:J(j),"onUpdate:modelValue":x[0]||(x[0]=A=>ge(j)?j.value=A:null),format:"rgb",onLeave:x[1]||(x[1]=A=>O.value=!1)},null,8,["modelValue"])):(R(),ce(It,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:ne(()=>[x[35]||(x[35]=d("h2",null,"Image options",-1)),d("div",pk,[d("button",{onClick:x[2]||(x[2]=A=>o("leave"))},"Back")]),X.noComposition?de("",!0):(R(),U("div",hk,[x[26]||(x[26]=d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),z(Ze,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:ne(()=>x[24]||(x[24]=[te("[?] ")])),_:1}),Pe(d("select",{id:"compositionSelect","onUpdate:modelValue":x[3]||(x[3]=A=>u.value=A),onKeydown:x[4]||(x[4]=he(()=>{},["stop"]))},x[25]||(x[25]=[d("option",{value:"source-over"},"Normal",-1),d("option",{value:"source-atop"},"source-atop",-1),d("option",{value:"destination-over"},"destination-over",-1),d("option",{value:"destination-in"},"destination-in",-1),d("option",{value:"destination-in"},"destination-out",-1),d("option",{value:"destination-in"},"destination-atop",-1),d("option",{value:"lighter"},"lighter",-1),d("option",{value:"xor"},"xor",-1),d("option",{value:"multiply"},"multiply",-1),d("option",{value:"screen"},"screen",-1),d("option",{value:"overlay"},"overlay",-1),d("option",{value:"darken"},"darken",-1),d("option",{value:"lighten"},"lighten",-1),d("option",{value:"color-dodge"},"color-dodge",-1),d("option",{value:"color-burn"},"color-burn",-1),d("option",{value:"hard-light"},"hard-light",-1),d("option",{value:"soft-light"},"soft-light",-1),d("option",{value:"difference"},"difference",-1),d("option",{value:"exclusion"},"exclusion",-1),d("option",{value:"hue"},"hue",-1),d("option",{value:"saturation"},"saturation",-1),d("option",{value:"color"},"color",-1),d("option",{value:"luminosity"},"luminosity",-1)]),544),[[St,u.value]])])),z(Pt,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:ne(()=>[z(It,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:ne(()=>[z(It,{direction:"vertical","no-wraping":""},{default:ne(()=>[x[27]||(x[27]=d("label",{for:"addEffect"},"Add new effect",-1)),Pe(d("select",{id:"addEffect","onUpdate:modelValue":x[5]||(x[5]=A=>i.value=A),onKeydown:x[6]||(x[6]=he(()=>{},["stop"]))},[(R(!0),U(ue,null,ze(J(r),A=>(R(),U("option",{key:A,value:A},Oe(y(A)),9,vk))),128))],544),[[St,i.value]]),d("button",{disabled:i.value===null,onClick:k,onKeydown:x[7]||(x[7]=he(()=>{},["stop"]))}," Add ",40,gk),d("button",{disabled:!f.value,onClick:v,onKeydown:x[8]||(x[8]=he(()=>{},["stop"]))}," Remove ",40,mk),d("button",{disabled:l.value===0,onClick:x[9]||(x[9]=A=>p(-1)),onKeydown:x[10]||(x[10]=he(()=>{},["stop"]))}," Move up ",40,bk),d("button",{disabled:l.value===c.value.length-1||c.value.length===0,onClick:x[11]||(x[11]=A=>p(1)),onKeydown:x[12]||(x[12]=he(()=>{},["stop"]))}," Move down ",40,yk)]),_:1}),z(It,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:ne(()=>[(R(!0),U(ue,null,ze(c.value,(A,Y)=>(R(),U("div",{key:Y,class:Ne({choiceBtn:!0,active:Y===l.value}),tabindex:"0",onClick:He=>h(Y),onKeydown:[it(He=>h(Y),["enter"]),it(he(He=>h(Y),["prevent"]),["space"])]},Oe(w(A)),43,wk))),128))]),_:1}),f.value?(R(),U("table",kk,[d("tbody",null,[f.value.type==="drop-shadow"?(R(),U(ue,{key:0},[d("tr",null,[x[28]||(x[28]=d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:et({background:J(j)}),onClick:x[13]||(x[13]=A=>O.value=!0)},"  ",4)])]),d("tr",null,[x[29]||(x[29]=d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),d("td",null,[Pe(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":x[14]||(x[14]=A=>ge(F)?F.value=A:null),onKeydown:x[15]||(x[15]=he(()=>{},["stop"]))},null,544),[[Ke,J(F),void 0,{number:!0}]])])]),d("tr",null,[x[30]||(x[30]=d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),d("td",null,[Pe(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":x[16]||(x[16]=A=>ge(N)?N.value=A:null),onKeydown:x[17]||(x[17]=he(()=>{},["stop"]))},null,544),[[Ke,J(N),void 0,{number:!0}]])])]),d("tr",null,[x[31]||(x[31]=d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),d("td",null,[Pe(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":x[18]||(x[18]=A=>ge(E)?E.value=A:null),onKeydown:x[19]||(x[19]=he(()=>{},["stop"]))},null,544),[[Ke,J(E),void 0,{number:!0}]])])])],64)):m.value?(R(),U(ue,{key:1},[d("tr",null,[x[33]||(x[33]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:(f.value.value*100).toFixed(),type:"number",max:b.value,min:_.value,onInput:P,onKeydown:x[20]||(x[20]=he(()=>{},["stop"]))},null,40,Ck),x[32]||(x[32]=te("% "))])]),_.value===0&&b.value!==void 0?(R(),U("tr",_k,[d("td",xk,[z(In,{gradientStops:["#000000","#ffffff"],label:"",maxValue:b.value,modelValue:f.value.value*100,"no-input":"","onUpdate:modelValue":x[21]||(x[21]=A=>D(Math.round(A)/100))},null,8,["maxValue","modelValue"])])])):de("",!0)],64)):(R(),U(ue,{key:2},[d("tr",null,[x[34]||(x[34]=d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),d("td",null,[d("input",{id:"filter_value",value:f.value.value,type:"number",max:b.value,min:_.value,onInput:P,onKeydown:x[22]||(x[22]=he(()=>{},["stop"]))},null,40,Sk)])]),_.value===0&&b.value!==void 0?(R(),U("tr",Pk,[d("td",Ok,[z(In,{gradientStops:M.value,label:"",maxValue:b.value,modelValue:f.value.value,"no-input":"","onUpdate:modelValue":x[23]||(x[23]=A=>D(Math.round(A)))},null,8,["gradientStops","maxValue","modelValue"]),z(In,{gradientStops:M.value,label:"",maxValue:b.value,modelValue:f.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):de("",!0)],64))])])):de("",!0)]),_:1})]),_:1})]),_:1}))}}),qa=De(Tk,[["__scopeId","data-v-05583125"]]),$k=["title"],jk=["title"],Rk=xe({__name:"bg-button",props:{backgroundId:{}},setup(n){const t=n,e=Ot(),o=B(()=>{const m=e.value.currentPanel;return H.panels.panels[m].background}),s=I(null),r=B(()=>{Object.keys(H.uploadUrls);const m=i.value;if(!m)return null;for(const b of m.variants)for(const _ of b){const y=kn(_,!1);if(y.startsWith("uploads:"))return Object.keys(H.uploadUrls),y.substring(8)}return null}),i=B(()=>H.content.backgrounds.get(t.backgroundId)||null),l=B(()=>t.backgroundId===o.value.current),a=B(()=>{switch(t.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return i.value.label??""}),u=B(()=>{var _;switch(t.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let m=!1;const b=(_=i.value)==null?void 0:_.variants[0].map(y=>{const w=kn(y,!1);return w.startsWith("uploads:")&&(m=!0),`url('${w}')`}).join(",");return m&&Object.keys(H.uploadUrls),{backgroundImage:b??""}});function c(){s.value.click()}async function f(){const m=s.value,b=r.value;if(!m.files)return;if(m.files.length!==1){console.error("More than one file uploaded!");return}const _=m.files[0];await ie(async()=>{const y=URL.createObjectURL(_);H.uploadUrls.add(b,y)})}return(m,b)=>r.value!==null?(R(),U("div",{key:0,class:Ne({background:!0,active:l.value}),title:a.value,style:et(u.value),tabindex:"0",onClick:b[0]||(b[0]=_=>c()),onKeypress:[b[1]||(b[1]=it(he(_=>c(),["prevent","stop"]),["enter"])),b[2]||(b[2]=it(he(_=>c(),["prevent","stop"]),["space"]))]},[te(Oe(a.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,$k)):(R(),U("div",{key:1,class:Ne({background:!0,active:l.value}),title:a.value,style:et(u.value),tabindex:"0",onClick:b[3]||(b[3]=_=>m.$emit("input",m.backgroundId)),onKeydown:[b[4]||(b[4]=it(_=>m.$emit("input",m.backgroundId),["enter"])),b[5]||(b[5]=it(he(_=>m.$emit("input",m.backgroundId),["prevent"]),["space"]))]},Oe(a.value),47,jk))}}),Ak=De(Rk,[["__scopeId","data-v-7d07eaaf"]]),Ik={key:1},Mk={colspan:"3"},Dk={key:0},Bk={class:"arrow-col"},Ek={class:"arrow-col"},Lk={colspan:"3"},Nk={colspan:"3"},Hk=xe({__name:"bg-settings",emits:["open-image-options","change-color"],setup(n,{emit:t}){const e=t,o=Ot(),s=Pn(),r=B(()=>{const y=o.value.currentPanel;return H.panels.panels[y].background}),i=B({get(){return r.value.flipped},set(y){ie(()=>{H.panels.panels[o.value.currentPanel].background.flipped=y})}}),l=B({get(){return r.value.scaling.toString()},set(y){ie(()=>{H.panels.panels[o.value.currentPanel].background.scaling=parseInt(y,10)})}}),a=B(()=>r.value.current),u=B(()=>H.content.current.backgrounds.find(y=>y.id===a.value)||null),c=B(()=>a.value==="buildin.static-color"),f=B({get(){return r.value.color},set(y){ie(()=>{H.panels.panels[o.value.currentPanel].background.color=y})}}),m=B(()=>!!u.value),b=B(()=>u.value?u.value.variants.length>1:!1);function _(y){ie(async()=>{H.panels.panels[o.value.currentPanel].background.seekBackgroundVariant(y)})}return(y,w)=>(R(),ce(Pt,{class:Ne({"bg-settings":!0,vertical:J(s)}),title:"Settings:"},{default:ne(()=>[c.value?(R(),U(ue,{key:0},[w[7]||(w[7]=d("label",{for:"bg_color"},"Color:",-1)),d("button",{id:"bg_color",class:"color-button",style:et({background:f.value}),onClick:w[0]||(w[0]=k=>e("change-color"))},null,4)],64)):de("",!0),m.value?(R(),U("table",Ik,[d("tbody",null,[d("tr",null,[d("td",Mk,[z(Ge,{modelValue:i.value,"onUpdate:modelValue":w[1]||(w[1]=k=>i.value=k),label:"Flipped?"},null,8,["modelValue"])])]),b.value?(R(),U("tr",Dk,[d("td",Bk,[d("button",{class:"small-button",onClick:w[2]||(w[2]=k=>_(-1))}," < ")]),w[8]||(w[8]=d("td",{style:{"text-align":"center"}},"Variant",-1)),d("td",Ek,[d("button",{class:"small-button",onClick:w[3]||(w[3]=k=>_(1))}," > ")])])):de("",!0),d("tr",null,[d("td",Lk,[Pe(d("select",{"onUpdate:modelValue":w[4]||(w[4]=k=>l.value=k),onKeydown:w[5]||(w[5]=he(()=>{},["stop"]))},w[9]||(w[9]=[d("option",{value:"0"},"None",-1),d("option",{value:"1"},"Stretch",-1),d("option",{value:"2"},"Cover",-1)]),544),[[St,l.value]])])]),d("tr",null,[d("td",Nk,[d("button",{id:"image_options_button",class:"v-w100",onClick:w[6]||(w[6]=k=>e("open-image-options"))}," Image options ")])])])])):de("",!0)]),_:1},8,["class"]))}}),Wk=De(Hk,[["__scopeId","data-v-eacb0b71"]]),Vk=xe({__name:"backgrounds-tool",setup(n){const t={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},e=I(null);Bt(e);const o=Ot(),s=I(!1),r=I(!1),i=B({get(){return H.panels.panels[o.value.currentPanel].background.color},set(h){ie(()=>{H.panels.panels[o.value.currentPanel].background.color=h})}}),l=B(()=>[...H.content.current.backgrounds.map(h=>h.id),"buildin.static-color","buildin.transparent"]),a=B(()=>ve.supports.openableFolders.has("backgrounds"));function u(h){ie(()=>{H.panels.panels[o.value.currentPanel].background.current=h})}function c(){ve.openFolder("backgrounds")}const f=I(null);function m(){const h=f.value;if(h.files)for(const v of h.files)b(v)}async function b(h){await ie(async()=>{const v=URL.createObjectURL(h),p=await H.uploadUrls.add(h.name,v);await y(h.name,h.name,p)})}function _(){const h=prompt("Enter the URL of the image");if(h==null)return;const v=h.split("/").slice(-1)[0];y(v,v,h)}async function y(h,v,p){const P=H.content.contentPacks.find(M=>M.packId===t.packId)||t,D={...P,backgrounds:[...P.backgrounds,{id:h,label:v,variants:[[{hq:p,lq:p,sourcePack:t.packId}]],scaling:"none"}]};await ie(async()=>{await H.content.replaceContentPack({contentPack:D,processed:!0}),u(h)})}const w=I(null);function k(h){h.dataTransfer&&(h.dataTransfer.effectAllowed="none",Array.from(h.dataTransfer.items).find(v=>v.type.match(/^image.*$/))&&(h.dataTransfer.effectAllowed="link",w.value.show()))}return(h,v)=>(R(),U("div",{class:"panel",ref_key:"root",ref:e,onDragenter:k,onMouseleave:v[7]||(v[7]=p=>w.value.hide())},[z(Qp,{ref_key:"dt",ref:w,class:"drop-target",onDrop:b},{default:ne(()=>v[8]||(v[8]=[te("Drop here to add as a new background ")])),_:1},512),v[13]||(v[13]=d("h1",null,"Background",-1)),s.value?(R(),ce(Dr,{key:0,modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=p=>i.value=p),onLeave:v[1]||(v[1]=p=>s.value=!1)},null,8,["modelValue"])):r.value?(R(),ce(qa,{key:1,type:"background",title:"","panel-id":J(o).currentPanel,"no-composition":"",onLeave:v[2]||(v[2]=p=>r.value=!1)},null,8,["panel-id"])):(R(),U(ue,{key:2},[z(Wk,{onChangeColor:v[3]||(v[3]=p=>s.value=!0),onOpenImageOptions:v[4]||(v[4]=p=>r.value=!0)}),z($e,{icon:"upload",class:"upload-background",onClick:v[5]||(v[5]=p=>f.value.click())},{default:ne(()=>[v[9]||(v[9]=te(" Upload ")),d("input",{type:"file",ref_key:"upload",ref:f,onChange:m,multiple:""},null,544)]),_:1}),z($e,{icon:"link",class:"upload-background",onClick:_},{default:ne(()=>v[10]||(v[10]=[te(" Add by URL ")])),_:1}),z($e,{icon:"extension",class:"upload-background",onClick:v[6]||(v[6]=p=>h.$emit("show-dialog","type: Backgrounds"))},{default:ne(()=>v[11]||(v[11]=[te(" Search in content packs ")])),_:1}),a.value?(R(),ce($e,{key:0,icon:"folder",class:"upload-background",onClick:c},{default:ne(()=>v[12]||(v[12]=[te(" Open backgrounds folder ")])),_:1})):de("",!0),(R(!0),U(ue,null,ze(l.value,p=>(R(),ce(Ak,{key:p,backgroundId:p,onInput:P=>u(p)},null,8,["backgroundId","onInput"]))),128))],64))],544))}}),Fk=De(Vk,[["__scopeId","data-v-68dabeb4"]]);function Ae(n,t){return B({get(){return n.value[t]},set(e){ie(()=>{n.value[t]=e})}})}function Qo(n,t){return(...e)=>{ie(()=>{n.value[t](...e)})}}const Uk=["onKeydown"],kd=960,qk=xe({__name:"part-button",props:{part:{},size:{default:150}},emits:["click","quick-click"],setup(n,{emit:t}){const e=n,o=t,s=I([]),r=B(()=>e.size/e.part.size[0]),i=B(()=>e.size/e.part.size[1]),l=B(()=>`${Math.floor(kd*r.value)}px ${Math.floor(kd*i.value)}px`),a=B(()=>{let m="";const b=l.value,_=e.part.offset??[0,0],y=e.part.images.length-1;for(let w=0;w<=y;++w){const k=e.part.images[y-w],h=s.value[y-w];if(!h)continue;w>0&&(m+=", ");const v=k.offset??[0,0],p=`${Math.floor((_[0]-v[0])*-r.value)}px ${Math.floor((_[1]-v[1])*-i.value)}px`;m+=`url('${h.replace("'","\\'")}') ${p} / ${b}`}return m}),u=B(()=>({height:e.size+"px",width:e.size+"px",background:a.value}));function c(m){m.preventDefault(),o("quick-click")}async function f(){s.value=await Promise.all(e.part.images.map(m=>typeof m.asset=="string"?Bw(m.asset,!1):kn(m.asset,!1)))}return vo("Initialization of parts button",f),(m,b)=>{var _;return R(),U("div",{class:Ne({part:!0,active:(_=m.part)==null?void 0:_.active}),style:et(u.value),tabindex:"0",onClick:b[0]||(b[0]=y=>o("click")),onContextmenu:c,onKeydown:[b[1]||(b[1]=it(he(y=>o("click"),["prevent"]),["enter"])),it(he(c,["prevent"]),["space"])]},null,46,Uk)}}}),Cd=De(qk,[["__scopeId","data-v-a09133e4"]]),zk=xe({__name:"part-selection",props:{character:{},part:{}},emits:["leave","show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=n,o=t,s=I(null),r=I([]),i=B(()=>{switch(e.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),l=B(()=>e.character.charData),a=B(()=>{if(e.part!=="style")return[];const k=l.value.styleGroups[e.character.styleGroupId];return k.styleComponents.map(h=>{const v={};for(const p in h.variants){if(!h.variants.hasOwnProperty(p))continue;const P=h.variants[p];v[p]={size:k.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:P}],active:!1}}return{label:h.label,name:h.id,buttons:v}})}),u=B(()=>{const k={};let h,v,p;const P=l.value,D=e.character.poseData;switch(e.part){case"head":{const g=e.character.posePositions.headType||0,O=e.character.posePositions.head||0;for(let j=0;j<D.compatibleHeads.length;++j){const F=D.compatibleHeads[j],N=P.heads[F];for(let E=0;E<N.variants.length;++E){const se=N.variants[E];k[`${j}_${E}`]={size:N.previewSize,offset:N.previewOffset,images:se.map(X=>({asset:X,offset:[0,0]})),active:O===E&&g===j}}}return k}case"pose":const M=P.styleGroups[e.character.styleGroupId].styles[e.character.styleId];for(let g=0;g<M.poses.length;++g){const O=M.poses[g],j=f(O);k[g]=j,j.active=g===e.character.poseId}return k;case"style":for(let g=0;g<P.styleGroups.length;++g){const O=P.styleGroups[g],j=f(O.styles[0].poses[0]);k[O.id]=j,j.active=g===e.character.styleGroupId}return k;default:h=D.positions[e.part],p=D.previewSize,v=D.previewOffset;break}for(let M=0;M<h.length;++M){const g=h[M];k[M]={images:g.map(O=>({offset:[0,0],asset:O})),size:p,offset:v,active:M===(e.character.posePositions[e.part]||0)}}return k});function c(){const k=l.value.styleGroups[e.character.styleGroupId].styles[e.character.styleId];r.value=Object.keys(k.components).map(h=>[h,k.components[h]])}function f(k){const h=l.value;let v=[];for(const p of k.renderCommands)switch(p.type){case"pose-part":const P=k.positions[p.part];if(P==null||P.length===0)break;v=v.concat(P[0].map(D=>({asset:D,offset:p.offset})));break;case"head":{const D=h.heads[k.compatibleHeads[0]];if(k.compatibleHeads.length===0)break;const M=D.variants[0];v=v.concat(M.map(g=>({asset:g,offset:p.offset})));break}case"image":v=v.concat(p.images.map(D=>({asset:D,offset:p.offset})));break}return{images:v,size:k.previewSize,offset:k.previewOffset,active:!1}}function m(k){k==null&&(k=e.character.styleGroupId);const v=l.value.styleGroups[k];let p=v.styles;for(const P of r.value){const D=p.filter(M=>M.components[P[0]]===P[1]);D.length>0&&(p=D)}ie(async()=>{e.character.setCharStyle(k,v.styles.indexOf(p[0]))})}function b(k){if(e.part==="style")m(l.value.styleGroups.findIndex(h=>h.id===k));else if(e.part==="head"){const[h,v]=(""+k).split("_",2).map(p=>parseInt(p,10));ie(()=>{e.character.setPosePosition({headType:h,head:v})})}else w(e.part,parseInt(""+k,10))}function _(k,h){const v=r.value.findIndex(p=>p[0]===k);r.value.splice(v,1),r.value.unshift([k,""+h]),m()}function y(k){(k.key==="Backspace"||k.key==="Escape")&&(o("leave"),k.preventDefault(),k.stopPropagation())}function w(k,h){ie(async()=>{e.character.setPart(k,h)})}return vo("Initializing parts data",async()=>{s.value=await fo()}),Xe(()=>e.character,c,{immediate:!0}),(k,h)=>(R(),ce(It,{"no-wraping":"",onKeydown:y},{default:ne(()=>[d("button",{onClick:h[0]||(h[0]=v=>o("leave")),class:"h-h100"},"Back"),z(It,{direction:"vertical",class:"parts-fnc-btns"},{default:ne(()=>[z($e,{icon:"extension",class:"h-bl0 v-w100 v-bt0",onClick:h[1]||(h[1]=v=>o("show-dialog",`type: ${i.value} character: ${l.value.label}`))},{default:ne(()=>h[3]||(h[3]=[te(" Search in content packs ")])),_:1}),k.part==="head"?(R(),ce($e,{key:0,icon:"extension",class:"h-bl0 h-bt0 v-w100 v-bt0",onClick:h[2]||(h[2]=v=>o("show-expression-dialog",{character:k.character.characterType}))},{default:ne(()=>h[4]||(h[4]=[te(" Create new expressions ")])),_:1})):de("",!0)]),_:1}),(R(!0),U(ue,null,ze(u.value,(v,p)=>(R(),ce(Cd,{key:p,value:p,part:v,onClick:P=>{b(p),o("leave")},onQuickClick:P=>b(p)},null,8,["value","part","onClick","onQuickClick"]))),128)),(R(!0),U(ue,null,ze(a.value,v=>(R(),ce(Pt,{key:v.name,title:v.label,class:"h-h100"},{default:ne(()=>[z(It,{noWraping:""},{default:ne(()=>[(R(!0),U(ue,null,ze(v.buttons,(p,P)=>(R(),ce(Cd,{size:130,key:P,value:P,part:p,onClick:D=>_(v.name,P)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}}),Xk=De(zk,[["__scopeId","data-v-21ad448a"]]),Yk=xe({__name:"delete-btn",props:{obj:{}},setup(n){const t=n;function e(){ie(async()=>{H.panels.panels[t.obj.panelId].removeObject(t.obj)})}return(o,s)=>(R(),U("button",{onClick:e},"Delete"))}}),Gk=xe({__name:"layer-btns",props:{object:{}},setup(n){const t=n,e=B(()=>t.object),o=B(()=>H.panels.panels[t.object.panelId]),s=Ae(e,"onTop");function r(i){ie(async()=>{o.value.shiftLayer(t.object,i)})}return(i,l)=>(R(),ce(Pt,{id:"layerfs",title:"Layer:"},{default:ne(()=>[z(It,{class:"layer_flow",direction:"horizontal"},{default:ne(()=>[z($e,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>r(-1/0)),title:"Move to back"}),z($e,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>r(-1)),title:"Move backwards"}),z($e,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>r(1)),title:"Move forwards"}),z($e,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>r(1/0)),title:"Move to front"})]),_:1}),z(Ge,{modelValue:J(s),"onUpdate:modelValue":l[4]||(l[4]=a=>ge(s)?s.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}}),Kk=De(Gk,[["__scopeId","data-v-2b245c52"]]),Jk={class:"v-w100"},Zk={colspan:"2"},Qk={key:0},eC={colspan:"2"},tC={class:"v-w100 button-tbl"},nC={class:"arrow-col"},oC=["disabled"],sC=["value"],rC={class:"arrow-col"},iC=["disabled"],lC={class:"v-w50"},aC={class:"v-w50"},uC={class:"v-w50"},cC={class:"v-w50"},dC=xe({__name:"position-and-size",props:{obj:{}},setup(n){const t=n,e=B(()=>t.obj),o=B({get(){const y=fe().TextBox;return t.obj.height-(i.value?y.NameboxHeight:0)},set(y){const w=fe().TextBox;ie(()=>{t.obj.height=y+(i.value?w.NameboxHeight:0)})}}),s=Ae(e,"width"),r=B(()=>{const y=t.obj;if(y.type==="textBox")return Go[y.style].resizable;const w=fe().Poem;return y.type==="poem"?w.poemBackgrounds[y.background].file.startsWith("internal:"):!1}),i=B(()=>t.obj.type==="textBox"&&location.search.includes("alex")),l=B(()=>"freeMove"in t.obj&&t.obj.linkedTo==null),a=B(()=>fe().Base.positions),u=B(()=>f.value===0),c=B(()=>f.value===fe().Base.positions.length-1),f=B({get(){return Ms(t.obj.x)},set(y){ie(async()=>{t.obj.x=fe().Base.characterPositions[y]})}}),m=B({get(){return!!t.obj.freeMove},set(y){ie(()=>{t.obj.freeMove=y})}}),b=Ae(e,"x"),_=Ae(e,"y");return(y,w)=>(R(),ce(Pt,{title:"Position"+(r.value?"/Size":"")},{default:ne(()=>[d("table",Jk,[d("tbody",null,[d("tr",null,[d("td",Zk,[l.value?(R(),ce(Ge,{key:0,modelValue:m.value,"onUpdate:modelValue":w[0]||(w[0]=k=>m.value=k),label:"Move freely?"},null,8,["modelValue"])):de("",!0)])]),l.value&&!m.value?(R(),U("tr",Qk,[d("td",eC,[d("table",tC,[d("tbody",null,[d("tr",null,[d("td",nC,[d("button",{onClick:w[1]||(w[1]=k=>--f.value),disabled:u.value}," < ",8,oC)]),d("td",null,[Pe(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":w[2]||(w[2]=k=>f.value=k)},[(R(!0),U(ue,null,ze(a.value,(k,h)=>(R(),U("option",{key:h,value:h},Oe(k),9,sC))),128))],512),[[St,f.value,void 0,{number:!0}]])]),d("td",rC,[d("button",{onClick:w[3]||(w[3]=k=>++f.value),disabled:c.value}," > ",8,iC)])])])])])])):(R(),U(ue,{key:1},[d("tr",null,[w[12]||(w[12]=d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),d("td",lC,[Pe(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":w[4]||(w[4]=k=>ge(b)?b.value=k:null),onKeydown:w[5]||(w[5]=he(()=>{},["stop"]))},null,544),[[Ke,J(b),void 0,{number:!0}]])])]),d("tr",null,[w[13]||(w[13]=d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),d("td",aC,[Pe(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":w[6]||(w[6]=k=>ge(_)?_.value=k:null),onKeydown:w[7]||(w[7]=he(()=>{},["stop"]))},null,544),[[Ke,J(_),void 0,{number:!0}]])])])],64)),r.value?(R(),U(ue,{key:2},[d("tr",null,[w[14]||(w[14]=d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),d("td",uC,[Pe(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":w[8]||(w[8]=k=>ge(s)?s.value=k:null),onKeydown:w[9]||(w[9]=he(()=>{},["stop"]))},null,544),[[Ke,J(s),void 0,{number:!0}]])])]),d("tr",null,[w[15]||(w[15]=d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),d("td",cC,[Pe(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":w[10]||(w[10]=k=>o.value=k),onKeydown:w[11]||(w[11]=he(()=>{},["stop"]))},null,544),[[Ke,o.value,void 0,{number:!0}]])])])],64)):de("",!0)])])]),_:1},8,["title"]))}}),fC=De(dC,[["__scopeId","data-v-3be3f0bb"]]),pC={class:"column ok-col"},hC={class:"column"},vC=["value"],gC={key:0,class:"column error-col"},mC={class:"column"},bC={class:"column"},yC={class:"column"},wC={class:"column"},kC=xe({inheritAttrs:!1,__name:"text-formatting",props:En({title:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:En(["leave"],["update:modelValue"]),setup(n,{emit:t}){const e=hs(n,"modelValue"),o=t,s=I(null),r=I(""),i=I(""),l=I("#000000"),a=I(""),u=I(0),c=I(0),f=I(""),m=Pn();Xe(()=>m.value,()=>{const h=s.value;h!=null&&(h.style.height="",h.style.width="")}),Xe(()=>i.value,()=>{i.value!==""&&(k("font",i.value),i.value="")}),Xe(()=>a.value,()=>{if(a.value==="")return;const h=s.value,v=h==null?void 0:h.selectionStart,p=h==null?void 0:h.selectionEnd;h&&(h.selectionEnd=h.selectionStart);const P=`{align=${a.value}}`;w(P),h&&(h.selectionStart=v+P.length,h.selectionEnd=p+P.length),a.value=""});function b(){const h=fe(),v=s.value.value;try{new Dt(v,h.TextBox.NameboxTextStyle),f.value=""}catch(p){f.value=p.message}e.value=v}function _(h){const v=s.value;r.value=h,u.value=v.selectionStart,c.value=v.selectionEnd}function y(){const h=l.value,v=r.value,p=()=>{const P=s.value;if(P==null){yn(p);return}P.selectionStart=u.value,P.selectionEnd=c.value,k(v==="text"?"color":"outlinecolor",h)};yn(p),l.value="#000000",r.value=""}function w(h){const v=s.value,p=v.value,P=v.selectionStart,D=v.selectionEnd;v.value=p.slice(0,P)+h+p.slice(D),v.selectionStart=v.selectionEnd=P+h.length,v.focus(),b()}function k(h,v){const p=s.value,P=p.value,D=p.selectionStart,M=p.selectionEnd,g=P.slice(D,M),O=P.slice(0,D),j=P.slice(M);let F=h;v!=null&&(F+="="+v),p.value=`${O}{${F}}${g}{/${h}}${j}`,p.selectionStart=D+F.length+2,p.selectionEnd=p.selectionStart+g.length,p.focus(),b()}return(h,v)=>r.value?(R(),ce(Dr,{key:0,modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=p=>l.value=p),onLeave:y},null,8,["modelValue"])):(R(),U("div",{key:1,class:Ne({"text-subpanel":!0,vertical:J(m)})},[d("h2",null,Oe(h.title),1),d("div",pC,[d("button",{onClick:v[1]||(v[1]=p=>o("leave"))},"OK")]),d("div",hC,[d("textarea",{class:"v-w100",ref_key:"textArea",ref:s,value:e.value,onInput:b,onKeydown:v[2]||(v[2]=he(()=>{},["stop"])),onKeypress:v[3]||(v[3]=he(()=>{},["stop"]))},null,40,vC)]),f.value?(R(),U("div",gC,Oe(f.value),1)):de("",!0),d("div",mC,[d("button",{onClick:v[4]||(v[4]=p=>w("\\\\")),class:"style-button"}," Insert \\ "),d("button",{onClick:v[5]||(v[5]=p=>w("\\{")),class:"style-button"}," Insert { "),d("button",{onClick:v[6]||(v[6]=p=>w("\\}")),class:"style-button"}," Insert } ")]),v[20]||(v[20]=d("p",{class:"hint-col"},"Apply style to selected text:",-1)),d("div",bC,[d("button",{onClick:v[7]||(v[7]=p=>k("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:v[8]||(v[8]=p=>k("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:v[9]||(v[9]=p=>k("plain")),class:"style-button"}," Plain "),d("button",{onClick:v[10]||(v[10]=p=>k("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:v[11]||(v[11]=p=>k("k",2)),class:"style-button",style:{"letter-spacing":"5px","padding-right":"0"}}," Kerning ")]),d("div",yC,[d("button",{onClick:v[12]||(v[12]=p=>k("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",wC,[d("button",{onClick:v[13]||(v[13]=p=>k("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Pe(d("select",{"onUpdate:modelValue":v[14]||(v[14]=p=>i.value=p),class:"style-button"},v[18]||(v[18]=[Uv('<option value data-v-e10386b2>Font</option><option value="aller" style="font-family:aller;" data-v-e10386b2> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-e10386b2> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-e10386b2> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-e10386b2> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-e10386b2> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-e10386b2> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-e10386b2> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-e10386b2> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-e10386b2> Halogen (MC) </option>',10)]),512),[[St,i.value]]),Pe(d("select",{"onUpdate:modelValue":v[15]||(v[15]=p=>a.value=p),class:"style-button"},v[19]||(v[19]=[d("option",{value:""},"Alignment",-1),d("option",{value:"left",style:{"text-align":"left"}},"Left",-1),d("option",{value:"right",style:{"text-align":"right"}},"Right",-1),d("option",{value:"center",style:{"text-align":"center"}}," Center ",-1)]),512),[[St,a.value]]),d("button",{onClick:v[16]||(v[16]=p=>_("text")),class:"style-button"}," Text color "),d("button",{onClick:v[17]||(v[17]=p=>_("outline")),class:"style-button"}," Outline color ")])],2))}}),CC=De(kC,[["__scopeId","data-v-e10386b2"]]),_C={class:"modal-text"},xC=["value"],SC={class:"input-table v-w100"},PC={for:"zoom",class:"v-w100"},OC={key:0},TC={key:0,colspan:"2"},$C={key:0},jC=["placeholder"],RC=xe({__name:"object-tool",props:{object:{},title:{},textHandler:{},colorHandler:{},showAltPanel:{type:Boolean,default:!1}},setup(n){const t=n,e=I(null);Bt(e);const o=B(()=>t.object),s=Ae(o,"linkedTo"),r=I(!1),i=I(""),l=I(!1),a=I(null),u=Ae(o,"flip"),c=Ae(o,"rotation"),f=Ae(o,"enlargeWhenTalking"),m=B(()=>Fp(t.object)),b=B(()=>H.panels.panels[t.object.panelId]),_=B(()=>{const X=b.value,x=[];for(const A of[...X.lowerOrder,...X.topOrder]){const Y=X.objects[A];Y.label===null||Y===t.object||x.push([A,Y.label])}return x}),y=location.search.includes("alex"),w=Ae(o,"preserveRatio"),k=B({get(){return t.object.nameboxWidth},set(X){ie(()=>{o.value.nameboxWidth=X===""?null:X})}}),h=B({get(){return t.object.scaleX*100},set(X){ie(()=>{o.value.scaleX=X/100})}}),v=B({get(){return t.object.scaleY*100},set(X){ie(()=>{o.value.scaleY=X/100})}}),p=Ae(o,"skewX"),P=Ae(o,"skewY"),D=B(()=>fe().TextBox.NameboxWidth),M=B(()=>a.value||t.colorHandler||null),g=B(()=>t.object.label!==null),O=B(()=>t.object.label??t.title??"Object"),j=B({get(){return t.object.textboxColor!==null},set(X){ie(()=>{o.value.textboxColor=X?fe().TextBoxCustom.textboxDefaultColor:null})}});function F(){ie(async()=>{H.ui.copyObjectToClipboard(t.object.panelId,[t.object.id])})}function N(){i.value=t.object.label??"",l.value=!0}function E(X){l.value=!1,X==="Apply"&&ie(()=>{o.value.label=i.value})}function se(){a.value={title:"Textbox color",get:()=>t.object.textboxColor,set:X=>{ie(()=>{o.value.textboxColor=X})},leave:()=>{a.value=null}}}return(X,x)=>(R(),U("div",{class:"panel",ref_key:"root",ref:e},[d("h1",{style:et({fontStyle:g.value?"italic":"normal"}),onClick:N},[te(Oe(O.value)+" ",1),x[26]||(x[26]=d("span",{class:"icon material-icons"},"edit",-1))],4),(R(),ce(oa,{to:"#modal-messages"},[l.value?(R(),ce(Bn,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:E,onLeave:x[2]||(x[2]=A=>E("Cancel"))},{default:ne(()=>[x[27]||(x[27]=d("p",{class:"modal-text"},"Enter the new name",-1)),d("p",_C,[Pe(d("input",{"onUpdate:modelValue":x[0]||(x[0]=A=>i.value=A),style:{width:"100%"},onKeydown:x[1]||(x[1]=it(he(A=>E("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Ke,i.value]])])]),_:1})):de("",!0)])),X.textHandler?(R(),ce(CC,{key:0,title:X.textHandler.title,modelValue:X.textHandler.get(),"onUpdate:modelValue":x[3]||(x[3]=A=>X.textHandler.set(A)),onLeave:x[4]||(x[4]=A=>X.textHandler.leave())},null,8,["title","modelValue"])):M.value?(R(),ce(Dr,{key:1,title:M.value.title,modelValue:M.value.get(),"onUpdate:modelValue":x[5]||(x[5]=A=>M.value.set(A)),onLeave:x[6]||(x[6]=A=>M.value.leave())},null,8,["title","modelValue"])):r.value?(R(),ce(qa,{key:2,type:"object","panel-id":o.value.panelId,id:o.value.id,onLeave:x[7]||(x[7]=A=>r.value=!1)},null,8,["panel-id","id"])):X.showAltPanel?Xt(X.$slots,"alt-panel",{key:3},void 0,!0):(R(),U(ue,{key:4},[Xt(X.$slots,"default",{},void 0,!0),z(fC,{obj:o.value},null,8,["obj"]),z(Kk,{object:o.value},null,8,["object"]),z(Pt,{title:"Transform",class:"transforms"},{default:ne(()=>[z(Ge,{modelValue:J(u),"onUpdate:modelValue":x[8]||(x[8]=A=>ge(u)?u.value=A:null),label:"Flip?"},null,8,["modelValue"]),x[33]||(x[33]=d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),Pe(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":x[9]||(x[9]=A=>ge(s)?s.value=A:null),onKeydown:x[10]||(x[10]=he(()=>{},["stop"]))},[x[28]||(x[28]=d("option",{value:""},"None",-1)),(R(!0),U(ue,null,ze(_.value,([A,Y])=>(R(),U("option",{key:A,value:A},Oe(Y),9,xC))),128))],544),[[St,J(s)]]),d("table",SC,[d("tbody",null,[d("tr",null,[x[29]||(x[29]=d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation:")],-1)),d("td",null,[Pe(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":x[11]||(x[11]=A=>ge(c)?c.value=A:null),onKeydown:x[12]||(x[12]=he(()=>{},["stop"]))},null,544),[[Ke,J(c)]])])]),m.value?(R(),U(ue,{key:0},[d("tr",null,[d("td",null,[d("label",PC,Oe(J(y)?"Zoom":"Scale X"),1)]),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":x[13]||(x[13]=A=>h.value=A),onKeydown:x[14]||(x[14]=he(()=>{},["stop"]))},null,544),[[Ke,h.value]])])]),J(y)?de("",!0):(R(),U("tr",OC,[x[30]||(x[30]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":x[15]||(x[15]=A=>v.value=A),onKeydown:x[16]||(x[16]=he(()=>{},["stop"]))},null,544),[[Ke,v.value]])])]))],64)):de("",!0),d("tr",null,[x[31]||(x[31]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":x[17]||(x[17]=A=>ge(p)?p.value=A:null),onKeydown:x[18]||(x[18]=he(()=>{},["stop"]))},null,544),[[Ke,J(p)]])])]),d("tr",null,[x[32]||(x[32]=d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),d("td",null,[Pe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":x[19]||(x[19]=A=>ge(P)?P.value=A:null),onKeydown:x[20]||(x[20]=he(()=>{},["stop"]))},null,544),[[Ke,J(P)]])])]),d("tr",null,[J(y)?de("",!0):(R(),U("td",TC,[z(Ge,{modelValue:J(w),"onUpdate:modelValue":x[21]||(x[21]=A=>ge(w)?w.value=A:null),label:"Lock scale ratio?"},null,8,["modelValue"])]))])])]),Xt(X.$slots,"transform",{},void 0,!0)]),_:3}),Xt(X.$slots,"options",{},void 0,!0),g.value?(R(),ce(Pt,{key:0,title:"Textbox settings"},{default:ne(()=>[o.value.type==="character"||o.value.type==="sprite"?(R(),ce(Ge,{key:0,label:"Enlarge when talking",modelValue:J(f),"onUpdate:modelValue":x[22]||(x[22]=A=>ge(f)?f.value=A:null)},null,8,["modelValue"])):de("",!0),z(Ge,{label:"Own textbox color",modelValue:j.value,"onUpdate:modelValue":x[23]||(x[23]=A=>j.value=A)},null,8,["modelValue"]),d("table",null,[d("tbody",null,[j.value?(R(),U("tr",$C,[x[34]||(x[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:et({background:o.value.textboxColor??""}),onClick:se},null,4)])])):de("",!0),d("tr",null,[x[35]||(x[35]=d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),d("td",null,[Pe(d("input",{id:"namebox_width",type:"number",placeholder:D.value+"","onUpdate:modelValue":x[24]||(x[24]=A=>k.value=A)},null,8,jC),[[Ke,k.value]])])])])])]),_:1})):de("",!0),d("button",{onClick:x[25]||(x[25]=A=>r.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:F},"Copy"),z(Yk,{class:"v-bt0",obj:o.value},null,8,["obj"])],64))],512))}}),Co=De(RC,[["__scopeId","data-v-a1b871fb"]]),AC={class:"warning"},IC={style:{"word-wrap":"break-word"}},MC={class:"button-tbl"},DC={key:0},BC={class:"arrow-col"},EC={class:"arrow-col"},LC={key:1},NC={class:"arrow-col"},HC={class:"arrow-col"},WC={class:"arrow-col"},VC=["onClick"],FC=["onClick"],UC={class:"arrow-col"},qC=["onClick"],zC=xe({__name:"character-tool",emits:["show-dialog","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=I(null),s=I(null);Bt(o);const r=I(null),i=Nt("viewport"),l=B(()=>H.panels.panels[i.value.currentPanel]),a=B(()=>i.value.selection),u=B(()=>{const M=l.value.objects[a.value];if(M.type==="character")return M}),c=Ae(u,"close"),f=Qo(u,"seekStyle"),m=Qo(u,"seekPart"),b=Qo(u,"seekPose"),_=B(()=>{const g=u.value.headsData;if(!g)return null;for(const O of g.variants){const j=kn(O[0],!1);if(j.startsWith("uploads:"))return j.substring(8)}return null}),y=B(()=>H.content.characters.get(u.value.characterType)),w=B(()=>y.value.label??""),k=B(()=>u.value.availablePartsKeys),h=B(()=>y.value.styleGroups[u.value.styleGroupId].styles.length>1||y.value.styleGroups.length>1),v=B(()=>y.value.styleGroups[u.value.styleGroupId].styles[u.value.styleId].poses.length>1);function p(){s.value.click()}async function P(){const M=s.value;if(!M.files)return;if(M.files.length!==1){console.error("More than one file uploaded!");return}const g=M.files[0];await ie(async()=>{const O=URL.createObjectURL(g);H.uploadUrls.add(_.value,O)})}function D(M){return M.charAt(0).toUpperCase()+M.substring(1)}return Xe(()=>a.value,()=>{r.value=null}),(M,g)=>(R(),ce(Co,{ref_key:"root",ref:o,object:u.value,title:w.value,showAltPanel:!!r.value},{"alt-panel":ne(()=>[r.value?(R(),ce(Xk,{key:0,character:u.value,part:r.value,onLeave:g[0]||(g[0]=O=>r.value=null),onShowDialog:g[1]||(g[1]=O=>e("show-dialog",O)),onShowExpressionDialog:g[2]||(g[2]=O=>e("show-expression-dialog",O))},null,8,["character","part"])):de("",!0)]),default:ne(()=>[_.value?(R(),U(ue,{key:0},[d("p",AC,[g[11]||(g[11]=te(" MISSING Head sprite! Click below to re-upload ")),d("span",IC,'"'+Oe(_.value)+'"',1),g[12]||(g[12]=te(". "))]),d("button",{onClick:g[3]||(g[3]=O=>p())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:s,onChange:P},null,544)],64)):de("",!0),v.value||k.value.length>0||h.value?(R(),ce(Pt,{key:1,class:"pose-list",title:"Pose:"},{default:ne(()=>[d("table",MC,[d("tbody",null,[h.value?(R(),U("tr",DC,[d("td",BC,[d("button",{onClick:g[4]||(g[4]=O=>J(f)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:g[5]||(g[5]=O=>r.value="style")}," Style ")]),d("td",EC,[d("button",{onClick:g[6]||(g[6]=O=>J(f)(1))},">")])])):de("",!0),v.value?(R(),U("tr",LC,[d("td",NC,[d("button",{onClick:g[7]||(g[7]=O=>J(b)(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:g[8]||(g[8]=O=>r.value="pose")}," Pose ")]),d("td",HC,[d("button",{onClick:g[9]||(g[9]=O=>J(b)(1))},">")])])):de("",!0),(R(!0),U(ue,null,ze(k.value,O=>(R(),U("tr",{key:O},[d("td",WC,[d("button",{onClick:j=>J(m)(O,-1)}," < ",8,VC)]),d("td",null,[d("button",{class:"middle-button",onClick:j=>r.value=O},Oe(D(O)),9,FC)]),d("td",UC,[d("button",{onClick:j=>J(m)(O,1)},">",8,qC)])]))),128))])])]),_:1})):de("",!0)]),transform:ne(()=>[z(Ge,{modelValue:J(c),"onUpdate:modelValue":g[10]||(g[10]=O=>ge(c)?c.value=O:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}}),XC=De(zC,[["__scopeId","data-v-8c562c62"]]),YC=["onClick"],GC=xe({__name:"choice-tool",setup(n){const t=I(null),e=Nt("viewport");Bt(t);const o=B(()=>H.panels.panels[e.value.currentPanel]),s=B(()=>{const y=o.value.objects[e.value.selection];if(y.type==="choice")return y}),r=I(0),i=I(!1),l=Ae(s,"autoWrap"),a=_("text"),u=B(()=>s.value.choices),c=B(()=>{if(i.value)return{title:"Text",get:()=>a.value,set:y=>{a.value=y},leave:()=>{i.value=!1}}});function f(y){r.value=y}function m(){ie(async()=>{s.value.addChoice("")})}function b(){ie(async()=>{r.value===s.value.choices.length-1&&r.value>0&&f(r.value-1),s.value.removeChoice(r.value)})}function _(y){return B({get(){return s.value.choices[r.value][y]},set(w){ie(()=>{s.value.setChoiceProperty(r.value,y,w)})}})}return(y,w)=>(R(),ce(Co,{ref_key:"root",ref:t,object:s.value,title:"Choice",textHandler:c.value},{default:ne(()=>[z(Pt,{class:"buttons",title:"Buttons:"},{default:ne(()=>[z(It,{maxSize:"100%",direction:"vertical",noWraping:""},{default:ne(()=>[(R(!0),U(ue,null,ze(u.value,(k,h)=>(R(),U("div",{class:Ne({choiceBtn:!0,active:h===r.value}),key:h,onClick:v=>f(h)},Oe(k.text.trim()===""?"[Empty]":k.text),11,YC))),128))]),_:1})]),_:1}),z(Pt,{class:"current_button",title:"Current button:"},{default:ne(()=>[d("table",null,[d("tbody",null,[w[4]||(w[4]=d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),d("tr",null,[d("td",null,[Pe(d("input",{id:"choice-button-input","onUpdate:modelValue":w[0]||(w[0]=k=>ge(a)?a.value=k:null),onKeydown:w[1]||(w[1]=he(()=>{},["stop"]))},null,544),[[Ke,J(a)]])]),d("td",null,[d("button",{onClick:w[2]||(w[2]=k=>i.value=!0)},"...")])])])])]),_:1}),d("button",{onClick:m},"Add"),d("button",{onClick:b},"Remove"),z(Ge,{label:"Auto line wrap?",modelValue:J(l),"onUpdate:modelValue":w[3]||(w[3]=k=>ge(l)?l.value=k:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),KC=De(GC,[["__scopeId","data-v-f58a4f6c"]]),JC={id:"notification_text_wrapper"},ZC=xe({__name:"notification-tool",setup(n){const t=I(null);Bt(t);const e=Nt("viewport"),o=B(()=>H.panels.panels[e.value.currentPanel]),s=B(()=>{const u=o.value.objects[e.value.selection];if(u.type==="notification")return u}),r=Ae(s,"text"),i=Ae(s,"backdrop"),l=I(!1),a=B(()=>{if(l.value)return{title:"Text",get:()=>r.value,set:u=>{r.value=u},leave:()=>{l.value=!1}}});return(u,c)=>(R(),ce(Co,{ref_key:"root",ref:t,object:s.value,title:"Notification",textHandler:a.value},{default:ne(()=>[d("div",JC,[c[4]||(c[4]=d("label",{for:"notification_text"},"Text:",-1)),Pe(d("textarea",{"onUpdate:modelValue":c[0]||(c[0]=f=>ge(r)?r.value=f:null),id:"notification_text",onKeydown:c[1]||(c[1]=he(()=>{},["stop"]))},null,544),[[Ke,J(r)]]),d("button",{onClick:c[2]||(c[2]=f=>l.value=!0)},"Formatting")])]),options:ne(()=>[z(Ge,{modelValue:J(i),"onUpdate:modelValue":c[3]||(c[3]=f=>ge(i)?i.value=f:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),QC=De(ZC,[["__scopeId","data-v-c6c0f92a"]]),e_=["onClick","onKeydown"],t_={class:"panel_text"},n_={class:"panel_nr"},o_={class:"column"},s_={class:"v-w100"},r_={colspan:"2"},i_={key:0,value:"image/webp"},l_={key:1,value:"image/heif"},a_={key:0},u_={for:"export_ppi"},c_={key:0},d_={for:"export_pages"},f_={key:0},p_={colspan:"2"},h_={class:"column"},v_={class:"modal-text"},g_=100,m_=90,_d=70,xd=1/4,b_=.5,y_=xe({__name:"panels-tool",setup(n){const t=I(null),{vertical:e,getRoot:o}=Bt(t),s=I(ve.supports.limitedCanvasSpace?10:0),r=I(""),i=I("image/png"),l=I(m_),a=I(!1),u=I(!1),c=I(null),f=I(null),m=fe().Base,b=window.showDirectoryPicker!==void 0&&"webkitRelativePath"in((File==null?void 0:File.prototype)??{}),_=B(()=>H.panels.panels[ye.value.currentPanel]),y=B(()=>i.value!=="image/png"),w=B(()=>F.value.length>1);function k(L){return L===""}const h=I(!1),v=I(""),p=I(null);function P(L){var $;h.value=!1,L==="Yes"&&(($=p.value)==null||$.call(p,!0))}function D(L){return new Promise($=>{v.value=L,h.value=!0,p.value=$})}const M=I(!1),g=I(!1);Promise.allSettled([fo(),Iw()]).then(([L,$])=>{L.status==="fulfilled"&&(M.value=L.value),$.status==="fulfilled"&&(g.value=$.value)});const O=B(()=>H.panels.order.indexOf(_.value.id)>0),j=B(()=>{const L=H.panels.order;return L.indexOf(_.value.id)<L.length-1}),F=B(()=>H.panels.order.map($=>{const V=H.panels.panels[$],q=[...V.lowerOrder,...V.topOrder].map(re=>V.objects[re]).map(N);return{id:V.id,image:V.lastRender,text:q.reduce((re,ee)=>re.length>ee.length?re:ee,"")}}));function N(L){switch(L.type){case"textBox":return L.text;case"notification":return L.text;case"poem":return L.text;case"choice":return L.choices.map($=>`[${$.text}]`).join(`
`)}return""}function E(){const L=o().querySelector(".panel_button.active");L!=null&&se(L)}function se(L){const $=L.parentElement.parentElement;e.value?($.scrollTop=L.offsetTop-$.clientHeight/2,$.scrollLeft=0):($.scrollLeft=L.offsetLeft-$.clientWidth/2,$.scrollTop=0)}Vt(()=>{E()});function X(){const L=new Date;return`cd-${[L.getFullYear(),`${L.getMonth()+1}`.padStart(2,"0"),`${L.getDate()}`.padStart(2,"0"),`${L.getHours()}`.padStart(2,"0"),`${L.getMinutes()}`.padStart(2,"0"),`${L.getSeconds()}`.padStart(2,"0")].join("-")}`}async function x(){await vo("export image",async()=>{const L=He(),$=i.value.split("/")[1],V=i.value,q=l.value,re=a.value,ee=X();await A(L,!0,re,async(ae,pe)=>{await ve.saveToFile(pe,`${ee}_${ae}.${$}`,V,q/g_)})})}async function A(L,$,V,q){const re=fe().Base,ee=[],ae=V?re.screenWidth:0,pe=V?0:re.screenHeight;for(let we=0;we<L.length;++we){const Te=L[we],_e=document.createElement("canvas");_e.width=V?re.screenWidth*Te.length:re.screenWidth,_e.height=V?re.screenHeight:re.screenHeight*Te.length;try{const pt=_e.getContext("2d");for(let nt=0;nt<Te.length;++nt){const Tt=Te[nt],mt=new cs(Tt,re.screenWidth,re.screenHeight);try{await mt.render($,!1,!0),mt.paintOnto(pt,{x:ae*nt,y:pe*nt,w:re.screenWidth,h:re.screenHeight})}finally{mt.dispose()}}ee.push(await q(we,_e))}finally{co(_e)}}return ee}function Y(){const L=H.panels.order.length-1,$=0,V=r.value.split(","),q=[];let re=!1;for(const ee of V){const ae=ee.trim(),pe=ae.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!pe){ae!==""&&je.fire(new _t(`Could not read '${ee}' in the page list.`));continue}if(re=!0,pe[2])q.push(parseInt(pe[2],10)-1);else{const we=Math.max(parseInt(pe[3],10)-1,$),Te=Math.min(parseInt(pe[4],10)-1,L);if(we==null||Te==null||we>Te)continue;for(let _e=we;_e<=Te;++_e)q.push(_e)}}return re?q.sort((ee,ae)=>ee-ae).filter((ee,ae,pe)=>pe[ae-1]!==ee).map(ee=>H.panels.panels[ee].id):H.panels.order}function He(){const L=Y();if(isNaN(s.value)&&(s.value=0),s.value===0)return[L];const $=[];for(let V=0;V<L.length/s.value;++V){const q=V*s.value,re=q+s.value;$.push(L.slice(q,re))}return $}async function G(){ie(async()=>{H.panels.duplicatePanel(H.panels.panels[ye.value.currentPanel]),ye.value.currentPanel=H.panels.lastPanelId}),await yn(),E()}function le(L){ie(()=>{ye.value.currentPanel=L}),yn(()=>{E()})}function be(){ie(async()=>{H.panels.deletePanel(H.panels.panels[ye.value.currentPanel])}),yn(()=>{E()})}function Re(){ie(()=>{H.panels.movePanel(H.panels.panels[ye.value.currentPanel],-1)})}function Ce(){ie(()=>{H.panels.movePanel(H.panels.panels[ye.value.currentPanel],1)})}const tt=Hn();tt.width=m.screenWidth*xd,tt.height=m.screenHeight*xd;const Ue=tt.getContext("2d"),oe=I(!1),ye=Ot(),Be=B(()=>H.panels.order.filter(L=>H.panels.panels[L].lastRender==null));async function Se(){const L=await window.showDirectoryPicker();if(!L)return;const $=await Array.fromAsync(L.values());if($.some(q=>q.kind==="file"&&q.name==="save.dddg")){if(!await D("A save file already exists in this folder. Do you want to overwrite it?"))return}else if($.length>0&&!await D("This folder already contains files. They might get overwritten. Do you want to continue?"))return;const V=[(async()=>{const q=await L.getFileHandle("save.dddg",{create:!0}),re=new Blob([await H.getSave(!1)],{type:"text/plain"}),ee=await q.createWritable();await ee.write(re),await ee.close()})()];for(const[q,re]of Object.entries(H.uploadUrls.urls))V.push((async()=>{const ae=await(await L.getFileHandle(q,{create:!0})).createWritable(),we=await(await fetch(re)).blob();await ae.write(we),await ae.close()})())}async function st(L){const $=L.target.files;$&&(await ie(async()=>{for(const V of $){const q=V.name;if(q==="save.dddg"){const ee=await V.text();await H.loadSave(ee)}const re=URL.createObjectURL(V);H.uploadUrls.add(q,re)}}),await S(),ve.supports.limitedCanvasSpace?je.fire(new _t("To prevent running out of memory, thumbnails will not be automatically restored in the background.")):setTimeout(()=>{W()},1e3))}async function S(){const L=ur(ye.value);L&&await T(L)}async function T(L){await vo("render thumbnail",async()=>{const $=L.panelId;L.paintOnto(Ue,{x:0,y:0,w:Ue.canvas.width,h:Ue.canvas.height}),Ue.canvas.toBlob(V=>{if(!V)return;const q=H.panels.panels[$];if(!q)return;const re=URL.createObjectURL(V);q.lastRender=re},await fo()?"image/webp":"image/jpeg",b_)})}async function W(){try{const L=fe().Base;if(!oe.value||ve.supports.limitedCanvasSpace)return;const $=Be.value;if($.length===0)return;const V=$[0],q=new cs(V,L.screenWidth,L.screenHeight);await q.render(!1,!1,!0),await T(q)}catch(L){console.error(L)}setTimeout(()=>{W()},100)}Vt(()=>{oe.value=!0,requestAnimationFrame(()=>S().catch(()=>{}))}),Sn(()=>{oe.value=!1,co(Ue.canvas)}),je.subscribe(er,()=>requestAnimationFrame(S));async function Z(){const L=await H.getSave(!0),$=new Blob([L],{type:"text/plain"}),V=new Date,q=`save-${[V.getFullYear(),`${V.getMonth()+1}`.padStart(2,"0"),`${V.getDate()}`.padStart(2,"0"),`${V.getHours()}`.padStart(2,"0"),`${V.getMinutes()}`.padStart(2,"0"),`${V.getSeconds()}`.padStart(2,"0")].join("-")}`;ve.storeSaveFile($,`${q}.dddg`)}async function K(){await ie(async()=>{const L=c.value;if(!L.files)return;je.fire(new tr);const $=await Q(L.files[0]);await H.loadSave($)}),await S(),ve.supports.limitedCanvasSpace?je.fire(new _t("To prevent running out of memory, thumbnails will not be automatically restored in the background.")):setTimeout(()=>{W()},1e3)}function Q(L){return new Promise(($,V)=>{const q=new FileReader;q.onload=function(){$(q.result)},q.onerror=function(re){V(re)},q.readAsText(L)})}return Xe(()=>l.value,(L,$)=>{if(L===100){je.fire(new _t("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if($>_d&&L<=_d){je.fire(new _t("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),Xe(()=>s.value,(L,$)=>{if(ve.supports.limitedCanvasSpace&&($<=10&&L>10||L===0&&F.value.length>10)){je.fire(new _t("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(L,$)=>(R(),U(ue,null,[d("div",{class:"panel",ref_key:"root",ref:t},[$[32]||($[32]=d("h1",null,"Panels",-1)),u.value?(R(),ce(qa,{key:0,type:"panel",title:"","panel-id":_.value.id,"no-composition":"",onLeave:$[0]||($[0]=V=>{u.value=!1,S()})},null,8,["panel-id"])):(R(),U(ue,{key:1},[z(Pt,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:ne(()=>[z(It,{"no-wraping":"",maxSize:"350px"},{default:ne(()=>[(R(!0),U(ue,null,ze(F.value,(V,q)=>(R(),U("div",{key:V.id,class:Ne({panel_button:!0,active:V.id===_.value.id}),style:et(`background-image: url('${V.image}')`),tabindex:"0",onClick:re=>le(V.id),onKeydown:[it(re=>le(V.id),["enter"]),it(he(re=>le(V.id),["prevent"]),["space"])]},[d("div",t_,[d("p",null,Oe(V.text),1)]),d("div",n_,Oe(q+1),1)],46,e_))),128))]),_:1})]),_:1}),d("div",o_,[z($e,{icon:"add_to_queue",onClick:G},{default:ne(()=>$[13]||($[13]=[te(" Add new")])),_:1}),z($e,{icon:"remove_from_queue",class:"bt0",onClick:be,disabled:!w.value},{default:ne(()=>$[14]||($[14]=[te(" Delete panel ")])),_:1},8,["disabled"]),z($e,{icon:"arrow_upward",class:"bt0",onClick:Re,disabled:!O.value},{default:ne(()=>$[15]||($[15]=[te(" Move ahead ")])),_:1},8,["disabled"]),z($e,{icon:"arrow_downward",class:"bt0",onClick:Ce,disabled:!j.value},{default:ne(()=>$[16]||($[16]=[te(" Move behind ")])),_:1},8,["disabled"]),z($e,{class:"bt0",icon:"color_lens",onClick:$[1]||($[1]=V=>u.value=!0)},{default:ne(()=>$[17]||($[17]=[te(" Image options ")])),_:1})]),z(Pt,{title:"Export",class:"h-h100 export_settings"},{default:ne(()=>[d("table",s_,[d("tbody",null,[d("tr",null,[d("td",r_,[z($e,{icon:"photo_camera",class:"w100",onClick:x},{default:ne(()=>$[18]||($[18]=[te(" Download ")])),_:1})])]),d("tr",null,[$[22]||($[22]=d("td",null,[d("label",{for:"export_format"},"Format")],-1)),d("td",null,[Pe(d("select",{id:"export_format","onUpdate:modelValue":$[2]||($[2]=V=>i.value=V)},[$[19]||($[19]=d("option",{value:"image/png"}," PNG (lossless) ",-1)),M.value?(R(),U("option",i_," WebP (lossy) ")):de("",!0),g.value?(R(),U("option",l_," HEIF (lossy) ")):de("",!0),$[20]||($[20]=d("option",{value:"image/jpeg"}," JPEG (lossy) ",-1)),$[21]||($[21]=d("option",{value:"image/jpeg"}," WebM (lossy, video) ",-1))],512),[[St,i.value]])])]),y.value?(R(),U("tr",a_,[$[23]||($[23]=d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),d("td",null,[Pe(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":$[3]||($[3]=V=>l.value=V),onKeydown:$[4]||($[4]=he(()=>{},["stop"]))},null,544),[[Ke,l.value,void 0,{number:!0}]])])])):de("",!0),d("tr",null,[d("td",null,[d("label",u_,[$[25]||($[25]=te(" Panels per image: ")),!y.value||J(e)?(R(),U("small",c_,$[24]||($[24]=[d("br",null,null,-1),te("(0 for one single image)")]))):de("",!0)])]),d("td",null,[Pe(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":$[5]||($[5]=V=>s.value=V),onKeydown:$[6]||($[6]=he(()=>{},["stop"])),onBlur:$[7]||($[7]=V=>{k(s.value)&&(s.value=0)})},null,544),[[Ke,s.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",d_,[$[27]||($[27]=te(" Panels to export: ")),!y.value||J(e)?(R(),U("small",f_,$[26]||($[26]=[d("br",null,null,-1),te("(Leave empty for all)")]))):de("",!0)])]),d("td",null,[Pe(d("input",{id:"export_pages","onUpdate:modelValue":$[8]||($[8]=V=>r.value=V),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Ke,r.value]])])]),d("tr",null,[d("td",p_,[z(Ge,{modelValue:a.value,"onUpdate:modelValue":$[9]||($[9]=V=>a.value=V),label:"Horizontal arrangement?",title:"Order panels side by side instead of top to bottom"},null,8,["modelValue"])])])])])]),_:1}),d("div",h_,[z($e,{icon:"save",onClick:Z},{default:ne(()=>$[28]||($[28]=[te("Save")])),_:1}),J(b)?(R(),ce($e,{key:0,icon:"save",onClick:Se},{default:ne(()=>$[29]||($[29]=[te("Save Folder ")])),_:1})):de("",!0),z($e,{class:"bt0",icon:"folder_open",onClick:$[10]||($[10]=V=>c.value.click())},{default:ne(()=>[$[30]||($[30]=te(" Load ")),d("input",{type:"file",ref_key:"loadUpload",ref:c,onChange:K},null,544)]),_:1}),J(b)?(R(),ce($e,{key:1,icon:"folder_open",onClick:$[11]||($[11]=V=>f.value.click())},{default:ne(()=>[$[31]||($[31]=te("Load Folder ")),d("input",{type:"file",ref_key:"loadOpenFolder",ref:f,onChange:st,webkitdirectory:""},null,544)]),_:1})):de("",!0)])],64))],512),(R(),ce(oa,{to:"#modal-messages"},[h.value?(R(),ce(Bn,{key:0,options:["No","Yes"],"no-base-size":"",class:"modal-rename",onOption:P,onLeave:$[12]||($[12]=V=>P("No"))},{default:ne(()=>[d("p",v_,Oe(v.value),1)]),_:1})):de("",!0)]))],64))}}),w_=De(y_,[["__scopeId","data-v-74bf828d"]]),k_={id:"poem_text",class:"v-w100"},C_=["value"],__=["value"],x_={key:1},S_={class:"v-w100"},P_=xe({__name:"poem-tool",setup(n){const t=I(null),e=I(null),{vertical:o}=Bt(t),s=I(!1),r=I("");Xe(()=>o.value,()=>{e.value.style.height="",e.value.style.width=""});const i=Nt("viewport"),l=B(()=>H.panels.panels[i.value.currentPanel]),a=B(()=>{const w=l.value.objects[i.value.selection];if(w.type==="poem")return w}),u=B(()=>{if(s.value)return{title:"Text",get:()=>f.value,set:w=>{f.value=w},leave:()=>{s.value=!1}}}),c=B(()=>{if(r.value)return{title:"Color",get:()=>{switch(r.value){case"":return"#000000";case"base":const w=fe().Poem;return a.value.consoleColor??w.consoleBackgroundColor;default:throw new Kt.UnreachableCaseError(r.value)}},set:w=>{ie(()=>{w!==void 0&&(a.value.consoleColor=w)})},leave:()=>{r.value=""}}}),f=Ae(a,"text"),m=Ae(a,"autoWrap"),b=Ae(a,"font"),_=Ae(a,"overflow"),y=Ae(a,"background");return(w,k)=>(R(),ce(Co,{ref_key:"root",ref:t,object:a.value,title:a.value.subtype==="poem"?"Poem":"Console",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("div",k_,[k[10]||(k[10]=d("label",{for:"poem_text"},"Text:",-1)),Pe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":k[0]||(k[0]=h=>ge(f)?f.value=h:null),onKeydown:k[1]||(k[1]=he(()=>{},["stop"]))},null,544),[[Ke,J(f)]]),d("button",{class:"w100 bt0",onClick:k[2]||(k[2]=h=>s.value=!0)}," Formatting ")]),z(Ge,{label:"Auto line wrap?",modelValue:J(m),"onUpdate:modelValue":k[3]||(k[3]=h=>ge(m)?m.value=h:null)},null,8,["modelValue"]),z(Ge,{label:"Allow overflow?",modelValue:J(_),"onUpdate:modelValue":k[4]||(k[4]=h=>ge(_)?_.value=h:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),a.value.subtype==="poem"?(R(),U(ue,{key:0},[Pe(d("select",{"onUpdate:modelValue":k[5]||(k[5]=h=>ge(y)?y.value=h:null),onKeydown:k[6]||(k[6]=he(()=>{},["stop"]))},[(R(!0),U(ue,null,ze(J(rp),(h,v)=>(R(),U("option",{value:v,key:v},Oe(h.name),9,C_))),128))],544),[[St,J(y)]]),Pe(d("select",{"onUpdate:modelValue":k[7]||(k[7]=h=>ge(b)?b.value=h:null),onKeydown:k[8]||(k[8]=he(()=>{},["stop"]))},[(R(!0),U(ue,null,ze(J(ip),(h,v)=>(R(),U("option",{value:v,key:v},Oe(h.name),9,__))),128))],544),[[St,J(b)]])],64)):(R(),U("table",x_,[d("tbody",null,[d("tr",null,[k[11]||(k[11]=d("td",{style:{width:"0"}},"Color:",-1)),d("td",S_,[d("button",{id:"console_color",class:"w100",style:et([{background:a.value.consoleColor},{"min-width":"64px"}]),onClick:k[9]||(k[9]=h=>r.value="base")},null,4)])])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}}),O_=De(P_,[["__scopeId","data-v-459fc793"]]),T_={class:"warning"},$_={style:{"word-wrap":"break-word"}},j_=xe({__name:"sprite-tool",setup(n){const t=I(null),e=I(null);Bt(t);const o=Nt("viewport"),s=B(()=>{for(const u of i.value.assets){const c=kn(u,!1);if(console.log(c),c.startsWith("uploads:"))return c.substring(8)}return null}),r=B(()=>H.panels.panels[o.value.currentPanel]),i=B(()=>{const u=r.value.objects[o.value.selection];if(u.type==="sprite")return u});function l(){e.value.click()}async function a(){const u=e.value;if(!u.files)return;if(u.files.length!==1){console.error("More than one file uploaded!");return}const c=u.files[0];ie(()=>{const f=URL.createObjectURL(c);H.uploadUrls.add(s.value,f)})}return(u,c)=>(R(),ce(Co,{ref_key:"root",ref:t,object:i.value,title:"Custom Sprite"},{default:ne(()=>[s.value?(R(),U(ue,{key:0},[d("p",T_,[c[1]||(c[1]=te(" MISSING SPRITE! Click below to re-upload ")),d("span",$_,'"'+Oe(s.value)+'"',1),c[2]||(c[2]=te(". "))]),d("button",{onClick:c[0]||(c[0]=f=>l())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:e,onChange:a},null,544)],64)):de("",!0)]),_:1},8,["object"]))}}),R_=De(j_,[["__scopeId","data-v-e15e7e5e"]]),A_={class:"upper-combos"},I_={colspan:"2"},M_=["value"],D_=["disabled"],B_={id:"dialog_text_wrapper",class:"v-w100"},E_={key:0},L_=["placeholder"],N_={colspan:"2"},H_={key:0},W_={key:1},V_={colspan:"2"},F_=xe({__name:"textbox-tool",setup(n){const t=I(null),e=I(null),{vertical:o}=Bt(t),s=I(""),r=I("");Xe(()=>o.value,()=>{const x=e.value;x!=null&&(x.style.height="",x.style.width="")});const i=Nt("viewport"),l=B(()=>H.panels.panels[i.value.currentPanel]),a=B(()=>{const x=l.value.objects[i.value.selection];if(x.type==="textBox")return x}),u=B(()=>{if(s.value)return{title:_.value,get(){return s.value==="name"?a.value.talkingOther:s.value==="body"?v.value:""},set(x){s.value==="name"?m.value=x:s.value==="body"&&(v.value=x)},leave(){s.value=""}}}),c=B(()=>{if(r.value)return{title:y.value,get:()=>{switch(r.value){case"":return"#000000";case"base":return a.value.customColor;case"controls":return a.value.customControlsColor;case"namebox":return a.value.customNameboxColor;case"nameboxStroke":return a.value.customNameboxStroke;default:throw new Kt.UnreachableCaseError(r.value)}},set:x=>{ie(()=>{const A={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[r.value];x!==void 0&&ie(()=>{a.value[A]=x})})},leave:()=>{r.value=""}}}),f=B({get(){return a.value.talkingObjId??"$null$"},set(x){ie(()=>{a.value.talkingObjId=x==="$null$"?null:x})}}),m=Ae(a,"talkingOther"),b=B(()=>{const x=l.value,A=[];for(const Y of[...x.lowerOrder,...x.topOrder]){const He=x.objects[Y];He.label!==null&&A.push([Y,He.label])}return A}),_=B(()=>s.value==="name"?"Name":s.value==="body"?"Dialog":""),y=B(()=>{switch(r.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Kt.UnreachableCaseError(r.value)}}),w=Ae(a,"autoQuoting"),k=Ae(a,"autoWrap"),h=Ae(a,"overflow"),v=Ae(a,"text"),p=B(()=>P.value.startsWith("custom")),P=Ae(a,"style"),D=Ae(a,"controls"),M=Ae(a,"skip"),g=Ae(a,"continue"),O=Ae(a,"overrideColor"),j=Ae(a,"deriveCustomColors"),F=Ae(a,"customNameboxWidth"),N=B(()=>fe().TextBox.NameboxWidth),E=Qo(a,"splitTextbox"),se=Qo(a,"applyResetBounds");function X(){ie(()=>{const x=f.value;i.value.selection=x==="$other$"||x==="$null$"?null:x})}return(x,A)=>(R(),ce(Co,{ref_key:"root",ref:t,object:a.value,title:"Textbox",textHandler:u.value,colorHandler:c.value},{default:ne(()=>[d("table",A_,[d("tbody",null,[d("tr",null,[A[27]||(A[27]=d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),d("td",I_,[Pe(d("select",{id:"text_style","onUpdate:modelValue":A[0]||(A[0]=Y=>ge(P)?P.value=Y:null),onKeydown:A[1]||(A[1]=he(()=>{},["stop"]))},A[26]||(A[26]=[d("option",{value:"normal"},"Normal",-1),d("option",{value:"corrupt"},"Corrupt",-1),d("option",{value:"custom"},"Custom",-1),d("option",{value:"custom_plus"}," Custom (Plus) ",-1),d("option",{value:"none"},"None",-1)]),544),[[St,J(P)]])])]),d("tr",null,[A[30]||(A[30]=d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),d("td",null,[Pe(d("select",{id:"current_talking","onUpdate:modelValue":A[2]||(A[2]=Y=>f.value=Y),onKeydown:A[3]||(A[3]=he(()=>{},["stop"]))},[A[28]||(A[28]=d("option",{value:"$null$"},"No-one",-1)),(R(!0),U(ue,null,ze(b.value,([Y,He])=>(R(),U("option",{key:Y,value:Y},Oe(He),9,M_))),128)),A[29]||(A[29]=d("option",{value:"$other$"},"Other",-1))],544),[[St,f.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:X,disabled:f.value==="$null$"||f.value==="$other$"}," > ",8,D_)])]),d("tr",null,[A[31]||(A[31]=d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),d("td",null,[Pe(d("input",{id:"custom_name","onUpdate:modelValue":A[4]||(A[4]=Y=>ge(m)?m.value=Y:null),onKeydown:A[5]||(A[5]=he(()=>{},["stop"]))},null,544),[[Ke,J(m)]])]),d("td",null,[d("button",{onClick:A[6]||(A[6]=Y=>s.value="name")},"...")])])])]),z(Ge,{label:"Auto quoting?",modelValue:J(w),"onUpdate:modelValue":A[7]||(A[7]=Y=>ge(w)?w.value=Y:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),z(Ge,{label:"Auto line wrap?",modelValue:J(k),"onUpdate:modelValue":A[8]||(A[8]=Y=>ge(k)?k.value=Y:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),z(Ge,{label:"Allow overflow?",modelValue:J(h),"onUpdate:modelValue":A[9]||(A[9]=Y=>ge(h)?h.value=Y:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",B_,[A[32]||(A[32]=d("label",{for:"dialog_text"},"Dialog:",-1)),Pe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:e,"onUpdate:modelValue":A[10]||(A[10]=Y=>ge(v)?v.value=Y:null),id:"dialog_text",onKeydown:A[11]||(A[11]=he(()=>{},["stop"]))},null,544),[[Ke,J(v)]]),d("button",{class:"w100 bt0",onClick:A[12]||(A[12]=Y=>s.value="body")}," Formatting ")])]),options:ne(()=>[z(Pt,{title:"Customization:",class:Ne(p.value?"customization-set":"")},{default:ne(()=>[z(It,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:ne(()=>[z(Ge,{label:"Controls visible?",modelValue:J(D),"onUpdate:modelValue":A[13]||(A[13]=Y=>ge(D)?D.value=Y:null)},null,8,["modelValue"]),z(Ge,{label:"Able to skip?",modelValue:J(M),"onUpdate:modelValue":A[14]||(A[14]=Y=>ge(M)?M.value=Y:null)},null,8,["modelValue"]),z(Ge,{label:"Continue arrow?",modelValue:J(g),"onUpdate:modelValue":A[15]||(A[15]=Y=>ge(g)?g.value=Y:null)},null,8,["modelValue"]),p.value?(R(),U("table",E_,[d("tbody",null,[d("tr",null,[A[33]||(A[33]=d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),d("td",null,[Pe(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:N.value+"","onUpdate:modelValue":A[16]||(A[16]=Y=>ge(F)?F.value=Y:null),onKeydown:A[17]||(A[17]=he(()=>{},["stop"]))},null,40,L_),[[Ke,J(F),void 0,{number:!0}]])])]),d("tr",null,[d("td",N_,[z(Ge,{modelValue:J(O),"onUpdate:modelValue":A[18]||(A[18]=Y=>ge(O)?O.value=Y:null),label:"Override color"},null,8,["modelValue"])])]),J(O)?(R(),U("tr",H_,[A[34]||(A[34]=d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:et({background:a.value.customColor}),onClick:A[19]||(A[19]=Y=>r.value="base")},null,4)])])):de("",!0),J(O)?(R(),U("tr",W_,[d("td",V_,[z(Ge,{id:"derive_custom_colors",modelValue:J(j),"onUpdate:modelValue":A[20]||(A[20]=Y=>ge(j)?j.value=Y:null),label:"Derive other colors"},null,8,["modelValue"])])])):de("",!0),J(O)&&!J(j)?(R(),U(ue,{key:2},[d("tr",null,[A[35]||(A[35]=d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:et({background:a.value.customControlsColor}),onClick:A[21]||(A[21]=Y=>r.value="controls")},null,4)])]),d("tr",null,[A[36]||(A[36]=d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:et({background:a.value.customNameboxColor}),onClick:A[22]||(A[22]=Y=>r.value="namebox")},null,4)])]),d("tr",null,[A[37]||(A[37]=d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:et({background:a.value.customNameboxStroke}),onClick:A[23]||(A[23]=Y=>r.value="nameboxStroke")},null,4)])])],64)):de("",!0)])])):de("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:A[24]||(A[24]=(...Y)=>J(se)&&J(se)(...Y))},"Reset position"),d("button",{class:"bt0",onClick:A[25]||(A[25]=(...Y)=>J(E)&&J(E)(...Y))},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}}),U_=De(F_,[["__scopeId","data-v-3720aae2"]]),q_={id:"toolbar"},z_={id:"toolbar-end"},X_=xe({__name:"tool-box",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(n,{emit:t}){const e=t,o=I(null),s=I("add"),r=B(()=>H.panels.panels[i.value.currentPanel]),i=Ot(),l=Pn(),a=Hf(),u=B(()=>{if(s.value==="selection")if(a.value===null)s.value="add";else return r.value.objects[a.value].type;return s.value}),c=B(()=>H.ui.lastDownload!==null);function f(b){b===s.value&&(b="add"),s.value=b,a.value!==null&&(i.value.selection=null)}function m(){Kw(o.value)&&(o.value.scrollTop=0,o.value.scrollLeft=0)}return Xe(()=>a.value,b=>{if(console.log("selection changed",b),b!=null){s.value="selection";return}s.value==="selection"&&(s.value="add")}),ve.onPanelChange(b=>{s.value=b}),(b,_)=>(R(),U("div",{id:"panels",class:Ne({vertical:J(l)}),onScroll:m,ref_key:"panels",ref:o},[d("div",q_,[z($e,{icon:"add_box","icon-pos":"top",class:Ne({active:u.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:_[0]||(_[0]=y=>f("add"))},null,8,["class"]),z($e,{icon:"panorama","icon-pos":"top",class:Ne({active:u.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:_[1]||(_[1]=y=>f("backgrounds"))},null,8,["class"]),z($e,{icon:"view_module","icon-pos":"top",class:Ne({active:u.value==="panels"}),title:"Panels",shortcut:"d",onClick:_[2]||(_[2]=y=>f("panels"))},null,8,["class"]),z($e,{icon:"settings_applications","icon-pos":"top",class:Ne({active:u.value==="settings"}),title:"Settings",shortcut:"f",onClick:_[3]||(_[3]=y=>f("settings"))},null,8,["class"])]),u.value==="settings"?(R(),ce(z1,{key:0})):u.value==="backgrounds"?(R(),ce(Fk,{key:1,onShowDialog:_[4]||(_[4]=y=>e("show-dialog",y))})):u.value==="help_credits"?(R(),ce(A1,{key:2})):u.value==="character"?(R(),ce(XC,{key:3,onShowDialog:_[5]||(_[5]=y=>e("show-dialog",y)),onShowExpressionDialog:_[6]||(_[6]=y=>e("show-expression-dialog",y))})):u.value==="sprite"?(R(),ce(R_,{key:4})):u.value==="textBox"?(R(),ce(U_,{key:5})):u.value==="choice"?(R(),ce(KC,{key:6})):u.value==="panels"?(R(),ce(w_,{key:7})):u.value==="notification"?(R(),ce(QC,{key:8})):u.value==="poem"?(R(),ce(O_,{key:9})):(R(),ce($1,{key:10,onShowDialog:_[7]||(_[7]=y=>e("show-dialog",y))})),d("div",z_,[z($e,{icon:"help","icon-pos":"top",class:Ne({active:u.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:_[8]||(_[8]=y=>f("help_credits"))},null,8,["class"]),z($e,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:_[9]||(_[9]=y=>e("show-dialog"))}),z($e,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:_[10]||(_[10]=y=>e("show-prev-render")),disabled:!c.value},null,8,["disabled"]),z($e,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:_[11]||(_[11]=y=>e("download"))})])],34))}}),Y_={class:"hidden-selectors"},G_=["data-obj-id","onKeydown"],K_=20,J_=50,eh=xe({__name:"app",setup(n){const t=tv("app"),e=ou(()=>Al(()=>import("./single-box-D09kBSou.js"),__vite__mapDeps([0,1]),import.meta.url)),o=ou(()=>Al(()=>import("./expression-builder-x1snTv9q.js"),__vite__mapDeps([2,3]),import.meta.url)),s=I(!0),r=I(null);function i(){const G=H.ui.lastDownload;G!=null&&r.value.blendOver(G)}const l=I(H.viewports.setUpViewport(document));pf("viewport",l),Xe(()=>{var G;return(G=t.value)==null?void 0:G.ownerDocument},(G,le)=>{G!=null&&(G!==document&&(l.value=H.viewports.setUpViewport(G)),le!=null&&_(le),b(G))},{immediate:!0});const a=Symbol("capturing"),u=new Map;function c(G,le,be=!1){if(be){const tt=le;le=Ue=>tt(Ue),le[a]=!0}const Re=u.get(G);Re==null?u.set(G,[le]):Re.push(le);const Ce=t.value;Ce!=null&&Ce.ownerDocument.addEventListener(G,le,be)}const f=new Map;function m(G,le,be=!1){if(be){const tt=le;le=Ue=>tt(Ue),le[a]=!0}const Re=f.get(G);Re==null?f.set(G,[le]):Re.push(le);const Ce=t.value;Ce!=null&&Ce.ownerDocument.defaultView.addEventListener(G,le)}function b(G){var le;for(const[be,Re]of u)for(const Ce of Re)G.addEventListener(be,Ce);for(const[be,Re]of f)for(const Ce of Re)(le=G.defaultView)==null||le.addEventListener(be,Ce)}function _(G){var le;for(const[be,Re]of u)for(const Ce of Re)G.removeEventListener(be,Ce);for(const[be,Re]of f)for(const Ce of Re)(le=G.defaultView)==null||le.removeEventListener(be,Ce)}Sn(()=>{const G=l.value.doc;_(G)});const y=B(()=>{const le=H.panels.panels[l.value.currentPanel];return le==null?[]:[...le.lowerOrder,...le.topOrder]});function w(G){G.preventDefault()}c("drop",w,!0),c("dragover",w,!0);const k=I(!1),h=B(()=>H.ui.useDarkTheme);if(Xe(()=>h.value??k.value,G=>{l.value.doc.body.classList.toggle("dark-theme",G)},{immediate:!0}),window.matchMedia!=null){const G=window.matchMedia("(prefers-color-scheme: dark)");k.value=G.matches;const le=be=>k.value=be.matches;G.addEventListener?G.addEventListener("change",le):G.addListener(le)}const v=I(!1),p=I(""),P=I(void 0);function D(G){v.value=!0,p.value=G.character,P.value=G.headGroup}const M=I(null),g=I(!1);function O(G){if(g.value=!0,G==null)return;const le=()=>{M.value?M.value.setSearch(G):setTimeout(le,J_)};yn(le)}const j=B(()=>H.ui.nsfw);Xe(()=>j.value,async G=>{G?H.content.loadContentPacks(em):H.content.removeContentPacks(Qg)});let F=null;function N(){F==null&&(F=requestAnimationFrame(()=>{F=null,je.fire(new Qs)}))}function E(G){if(Yw(G.target)||Gw(G.target)){console.log("skip keydown on potential target");return}ie(async()=>{const le=(G.ctrlKey||G.metaKey)&&!G.altKey&&!G.shiftKey,be=!G.ctrlKey&&!G.altKey&&!G.metaKey&&!G.shiftKey;if(le&&G.key==="v"){await H.ui.pasteObjects(H.panels.panels[l.value.currentPanel]),G.preventDefault();return}if(be&&G.key==="Escape"){if(l.value.selection===null)return;l.value.selection=null;return}const Re=H.panels.panels[l.value.currentPanel],Ce=Re.objects[l.value.selection];if(Ce!=null){if(le){if(G.key==="c"||G.key==="x"){H.ui.copyObjectToClipboard(Re.id,[Ce.id]),G.key==="x"&&Re.removeObject(Ce),G.preventDefault();return}}else if(be){if(G.key==="Delete"){H.panels.panels[l.value.currentPanel].removeObject(Ce);return}if(G.key==="/"||G.key==="*"){let Ue=G.key==="/"?-10:10;G.shiftKey&&(Ue/=Math.abs(Ue)),Ce.rotation+=Ue,G.stopPropagation(),G.preventDefault();return}if(Ce.type==="character"&&!Ce.freeMove){if(G.key==="ArrowLeft"){Ce.shiftCharacterSlot(-1);return}if(G.key==="ArrowRight"){Ce.shiftCharacterSlot(1);return}}const tt=G.shiftKey?1:K_;switch(G.key){case"ArrowLeft":Ce.x-=tt;break;case"ArrowRight":Ce.x+=tt;break;case"ArrowUp":Ce.y-=tt;break;case"ArrowDown":Ce.y+=tt;break;default:return}}}})}m("keydown",E);let se=null,X=!1;function x(G){G.ctrlKey?!X&&se===null&&(se=setTimeout(A)):Y()}function A(){document.body.classList.add("ctrl-key"),X=!0}function Y(){se!==null&&(clearTimeout(se),se=null),document.body.classList.remove("ctrl-key"),X=!1}m("keydown",x,!0),m("keyup",x,!0),m("mousemove",x,!0),m("blur",Y);function He(G){ie(()=>{l.value.selection!==G&&(l.value.selection=G)})}return Xe(()=>l.value.selection,G=>{var le,be;((le=document.activeElement)==null?void 0:le.getAttribute("data-obj-id"))!==""+G&&((be=document.querySelector(`*[data-obj-id='${G}']`))==null||be.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),window.store=H,window.env=ve,Vt(async()=>{await ve.loadGameMode(),s.value=!1;const G=await ve.loadSettings();H.panels.lastPanelId===-1&&await ie(async()=>{if(ve.state.looseTextParsing=G.looseTextParsing||!0,H.ui.lqRendering=G.lq??!1,H.ui.useDarkTheme=G.darkMode??null,H.ui.defaultCharacterTalkingZoom=G.defaultCharacterTalkingZoom??!0,await H.content.loadContentPacks([`${vt}buildin.base.backgrounds.json`,`${vt}buildin.base.monika.json`,`${vt}buildin.base.sayori.json`,`${vt}buildin.base.natsuki.json`,`${vt}buildin.base.yuri.json`,`${vt}buildin.extra.mc.json`,`${vt}buildin.extra.concept_mc_v2.json`,`${vt}buildin.extra.mc_chad.json`,`${vt}buildin.extra.femc.json`,`${vt}buildin.extra.concept_femc.json`,`${vt}buildin.extra.amy.json`]),!await ve.loadDefaultTemplate()){ve.loadContentPacks();const le=H.panels.createPanel();l.value.currentPanel=le.id,Object.keys(le.objects).length===0&&bn.create(le,`Hi! Click here to edit this textbox! ${l.value.isVertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`),le.background.current="dddg.buildin.backgrounds:ddlc.clubroom",H.ui.nsfw=G.nsfw??!1}})}),(G,le)=>(R(),U(ue,null,[d("div",{id:"app",ref_key:"app",ref:t},[d("div",Y_,[(R(!0),U(ue,null,ze(y.value,be=>(R(),U("div",{key:be,tabindex:"0","data-obj-id":be,onFocus:le[0]||(le[0]=Re=>N()),onBlur:le[1]||(le[1]=Re=>N()),onKeydown:[it(he(Re=>He(be),["prevent"]),["enter"]),it(he(Re=>He(be),["prevent"]),["space"])]},null,40,G_))),128))]),z(u1,{ref_key:"renderer",ref:r,canvasWidth:l.value.canvasWidth,canvasHeight:l.value.canvasHeight,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),z(zg),z(X_,{onShowPrevRender:i,onDownload:le[2]||(le[2]=be=>r.value.download()),onShowDialog:O,onShowExpressionDialog:D}),(R(),ce(sv,null,[g.value?(R(),ce(Bn,{key:0,ref:"dialog",onLeave:le[4]||(le[4]=be=>g.value=!1)},{default:ne(()=>[z(J(e),{ref_key:"packDialog",ref:M,onLeave:le[3]||(le[3]=be=>g.value=!1)},null,512)]),_:1},512)):de("",!0)],1024)),v.value?(R(),ce(Bn,{key:0,ref:"dialog",onLeave:le[6]||(le[6]=be=>v.value=!1)},{default:ne(()=>[z(J(o),{character:p.value,initHeadGroup:P.value,onLeave:le[5]||(le[5]=be=>v.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):de("",!0)],512),le[7]||(le[7]=d("div",{id:"modal-messages"},null,-1))],64))}});Ef(eh).mount("#main_wrapper");export{Vt as A,Sn as B,Pe as C,Ke as D,Uv as E,ue as F,rf as G,vo as H,je as I,Jt as J,Xt as K,kn as L,po as M,Xp as N,Dp as O,Ko as P,Qp as Q,Wn as R,Zp as S,Q_ as T,St as U,Nf as V,Pt as W,Nw as X,on as Y,ie as Z,Ze as _,U as a,d as b,B as c,xe as d,ve as e,de as f,te as g,z as h,ne as i,ce as j,Ge as k,ze as l,n1 as m,et as n,R as o,De as p,Xe as q,I as r,H as s,Oe as t,J as u,Ne as v,he as w,yn as x,En as y,hs as z};
