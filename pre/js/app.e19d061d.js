(function(t){function e(e){for(var r,a,c=e[0],s=e[1],u=e[2],l=0,d=[];l<c.length;l++)a=c[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);p&&p(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},a={app:0},o={app:0},i=[];function c(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-17912fef":"d43e4845","chunk-4d2ed890":"20351ba2"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-17912fef":1,"chunk-4d2ed890":1};a[t]?e.push(a[t]):0!==a[t]&&n[t]&&e.push(a[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-17912fef":"be517e7d","chunk-4d2ed890":"5bc816f9"}[t]+".css",o=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===o))return e()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){u=d[c],l=u.getAttribute("data-href");if(l===r||l===o)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var r=e&&e.target&&e.target.src||o,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete a[t],p.parentNode.removeChild(p),n(i)},p.href=o;var h=document.getElementsByTagName("head")[0];h.appendChild(p)})).then((function(){a[t]=0})));var r=o[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=o[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(p);var n=o[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",d.name="ChunkLoadError",d.type=r,d.request=a,n[1](d)}o[t]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var p=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"02e0":function(t,e,n){"use strict";n("7592")},"032b":function(t,e,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf");var r=n("1da1"),a=n("d4ec"),o=n("bee2"),i=n("262e"),c=n("2caf"),s=(n("ac1f"),n("25f0"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("5530")),u=n("7a23"),l=function(){function t(){var e=this;Object(a["a"])(this,t),this.state=Object(u["s"])({installed:[],autoAdd:[]}),this.isSavingEnabled=Object(u["t"])(!1),this.localRepositoryUrl="";var n=this,o=d.canSave();window.addEventListener("beforeunload",(function(t){t.preventDefault(),t.returnValue="Are you sure you want to leave? All your progress will be lost!"}));var i=Object(u["s"])({optionalSaving:o,get autoLoading(){return o&&n.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0});this.supports=i,this.loading=o?Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d.doesDbExists();case 2:n=t.sent,e.savingEnabled=n;case 4:case"end":return t.stop()}}),t)})))():Promise.resolve()}return Object(o["a"])(t,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,a,o,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",a=c.length>3&&void 0!==c[3]?c[3]:1,o=document.createElement("a"),o.setAttribute("download",n),t.next=6,this.createObjectURL(e,r,a);case 6:return i=t.sent,o.setAttribute("href",i),document.body.appendChild(o),o.click(),document.body.removeChild(o),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"localRepoInstall",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"localRepoUninstall",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"autoLoadAdd",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"autoLoadRemove",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0},this.isSavingEnabled.value){t.next=7;break}return t.abrupt("return",e);case 7:return t.t0=s["a"],t.t1=Object(s["a"])({},e),t.next=11,d.loadSettings();case 11:return t.t2=t.sent,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(this.isSavingEnabled.value){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,d.saveSettings(e);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"isInitialized",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t,e,n){var r=this;return new Promise((function(a,o){var i=!(!window.URL||!window.URL.createObjectURL);if(!i)return a(t.toDataURL(e,n));if(t.toBlob)t.toBlob((function(t){t?a(URL.createObjectURL(t)):o()}),e,n);else{var c=t.toDataURL(e,n),s=r.dataURItoBlob(c,e);a(URL.createObjectURL(s))}}))}},{key:"dataURItoBlob",value:function(t,e){for(var n=atob(t.split(",")[1]),r=n.length,a=new Uint8Array(r),o=0;o<r;o++)a[o]=n.charCodeAt(o);return new Blob([a],{type:e})}},{key:"savingEnabled",get:function(){return this.isSavingEnabled.value},set:function(t){var e=this;t?(localStorage.setItem("saving","true"),this.creatingDB=d.createDB(),this.creatingDB.then((function(){e.creatingDB=void 0,e.isSavingEnabled.value=!0})).catch((function(){}))):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=d.clearDB().then((function(){e.creatingDB=void 0})).catch((function(){})))}}]),t}(),d={indexedDB:window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,transaction:window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,db:null,canSave:function(){return!(!d.indexedDB||!window.localStorage)},doesDbExists:function(){var t=localStorage.getItem("saving");return"true"===t?Promise.resolve(!0):Promise.resolve(!1)},createDB:function(){return d.db?d.db:d.db=new Promise((function(t,e){var n=d.indexedDB.open("dddg",1);n.onerror=function(t){e(t)},n.onupgradeneeded=function(t){var e,n=t.target.result,r=null!==(e=t.oldVersion)&&void 0!==e?e:t.version;r<1&&n.createObjectStore("settings")},n.onsuccess=function(e){t(n.result)}}))},clearDB:function(){return new Promise((function(t,e){if(d.db){var n=d.indexedDB.deleteDatabase("dddg");d.db=null,n.onerror=function(t){e(t)},n.onsuccess=function(e){t()}}else t()}))},saveSettings:function(t){var e=this;return this.db?new Promise(function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r,a){var o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.db;case 2:o=n.sent.transaction(["settings"],"readwrite"),i=o.objectStore("settings"),c=i.put(Object(s["a"])({},t),0),c.onerror=function(t){a(t)},c.onsuccess=function(){r()};case 7:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()):Promise.reject("No database")},loadSettings:function(){var t=this;return this.db?new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n,r){var a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.db;case 2:a=e.sent.transaction(["settings"],"readonly"),o=a.objectStore("settings"),i=o.get(0),i.onerror=function(t){r(t)},i.onsuccess=function(t){n(i.result||{})};case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()):Promise.reject("No database")}},p=function(t){Object(i["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,a,o,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",a=c.length>3&&void 0!==c[3]?c[3]:1,o=e.toDataURL(r,a),i=this.dataURItoBlob(o,r),window.URL&&window.URL.createObjectURL&&(o=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,n),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),n}(l),h=(n("2ca0"),n("5947")),b=n("0c0f"),f={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},v=function(){function t(){var e=this;Object(a["a"])(this,t),this.state=Object(u["s"])({autoAdd:[],installed:[]}),this.localRepositoryUrl="/repo/repo.json",this.electron=window,this.vuexHistory=null,this.$store=null,this.bgInvalidation=null,this.pendingContentPacks=[],this.supports={autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1},this.savingEnabled=!0,this.electron.ipcRenderer.on("add-persistent-content-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store&&e.vuexHistory){t.next=3;break}return e.pendingContentPacks.push(a),t.abrupt("return");case 3:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",a);case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a="persistentBg-"+r,o=r.split("/"),Object(h["g"])(a,r),f.backgrounds.push({id:a,variants:[[a]],label:o[o.length-1]}),e.invalidateInstalledBGs();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:b["f"].fire(new b["d"](n));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.send("find-customs")}return Object(o["a"])(t,[{key:"onPanelChange",value:function(t){}},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw);case 2:return t.next=4,this.electron.ipcRenderer.sendConvo("config.set","darkMode",null!==(n=e.darkMode)&&void 0!==n?n:void 0);case 4:return t.next=6,this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.get","nsfw");case 2:if(t.t1=e=t.sent,t.t0=null!==t.t1,!t.t0){t.next=6;break}t.t0=void 0!==e;case 6:if(!t.t0){t.next=10;break}t.t2=e,t.next=11;break;case 10:t.t2=!1;case 11:return t.t3=t.t2,t.next=14,this.electron.ipcRenderer.sendConvo("config.get","darkMode");case 14:if(t.t5=n=t.sent,t.t4=null!==t.t5,!t.t4){t.next=18;break}t.t4=void 0!==n;case 18:if(!t.t4){t.next=22;break}t.t6=n,t.next=23;break;case 22:t.t6=void 0;case 23:return t.t7=t.t6,t.next=26,this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom");case 26:if(t.t9=r=t.sent,t.t8=null!==t.t9,!t.t8){t.next=30;break}t.t8=void 0!==r;case 30:if(!t.t8){t.next=34;break}t.t10=r,t.next=35;break;case 34:t.t10=void 0;case 35:return t.t11=t.t10,t.abrupt("return",{lq:!1,nsfw:t.t3,darkMode:t.t7,defaultCharacterTalkingZoom:t.t11});case 37:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"localRepoInstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.install",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"localRepoUninstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.uninstall",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadAdd",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.add",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadRemove",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.remove",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"saveToFile",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise((function(i,c){t.toBlob(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return c(),t.abrupt("return");case 3:return t.next=5,r.arrayBuffer();case 5:return a=t.sent,t.next=8,n.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(a));case 8:i(URL.createObjectURL(r));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),a,o)}))}},{key:"installBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.uploadedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(h["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch(n.src);case 11:return r=t.sent,t.t0=Uint8Array,t.next=15,r.arrayBuffer();case 15:t.t1=t.sent,a=new t.t0(t.t1),this.electron.ipcRenderer.send("install-background",a);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.installedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(h["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:if(n.src.startsWith("blob:")){t.next=18;break}return t.next=12,fetch(n.src);case 12:return r=t.sent,t.next=15,r.blob();case 15:a=t.sent,o=URL.createObjectURL(a),Object(h["g"])(e.assets[0].hq,o);case 18:this.electron.ipcRenderer.send("uninstall-background",e.id);case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("show-prompt",e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"connectToStore",value:function(t,e){var n=this;this.vuexHistory=t,this.$store=e,this.invalidateInstalledBGs(),this.pendingContentPacks.length>0&&this.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("content/loadContentPacks",n.pendingContentPacks);case 2:case"end":return t.stop()}}),t)}))))}},{key:"invalidateInstalledBGs",value:function(){var t=this;this.vuexHistory&&this.$store&&null===this.bgInvalidation&&(this.bgInvalidation=requestAnimationFrame((function(){t.updateInstalledBGs()})))}},{key:"updateInstalledBGs",value:function(){var t=this;this.bgInvalidation&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.vuexHistory&&this.$store&&this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:f})}))}}]),t}();function m(){return window.isElectron?new v:void 0!==window.navigator.msSaveOrOpenBlob?new p:new l}var j=m();window.toast=j;e["a"]=j},"0416":function(t,e,n){},"06af":function(t,e,n){},"0741":function(t,e,n){"use strict";n("9084")},"0c0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return l}));var r=n("d4ec"),a=n("14b7"),o=Object(a["a"])();e["f"]={fire:function(t){o.emit(t.kind,t)},subscribe:function(t,e){o.on(t.kind,e)},unsubscribe:function(t,e){o.off(t.kind,e)}};var i=function t(e){Object(r["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};i.kind="AssetFailureEvent";var c=function t(e){Object(r["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};c.kind="CustomAssetFailureEvent";var s=function t(){Object(r["a"])(this,t),this.kind="InvalidateRenderEvent"};s.kind="InvalidateRenderEvent";var u=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="ShowMessageEvent"};u.kind="ShowMessageEvent";var l=function t(e,n){Object(r["a"])(this,t),this.error=e,this.info=n,this.kind="VueErrorEvent"};l.kind="VueErrorEvent"},"0f13":function(t,e,n){"use strict";n("32a3")},"13f8":function(t,e,n){"use strict";n("d7eb")},"1a7b":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("b85c"),a=n("d4ec"),o=n("bee2"),i=n("45eb"),c=n("7e84"),s=n("262e"),u=n("2caf"),l=n("ba37"),d=n("4a6f"),p=function(t){Object(s["a"])(n,t);var e=Object(u["a"])(n);function n(t,r){var o;return Object(a["a"])(this,n),o=e.call(this,t),o.data=r,o.scaleable=!0,o}return Object(o["a"])(n,[{key:"updatedContent",value:function(t,e){Object(i["a"])(Object(c["a"])(n.prototype),"updatedContent",this).call(this,t,e),this.data=Object(l["e"])(t,this.obj)}},{key:"getAssetList",value:function(){var t,e=Object(l["h"])(this.data,this.obj),n=Object(l["f"])(this.data,this.obj),a=[],o=Object(r["a"])(e.renderCommands);try{for(o.s();!(t=o.n()).done;){var i=t.value;switch(i.type){case"head":a.push({offset:i.offset,composite:i.composite,assets:n?n.variants[this.obj.posePositions.head||0]:[]});break;case"image":a.push({offset:i.offset,composite:i.composite,assets:i.images});break;case"pose-part":var c=e.positions[i.part];if(!c||0===c.length)break;var s=c[this.obj.posePositions[i.part]||0];if(!s)break;a.push({offset:i.offset,composite:i.composite,assets:s});break}console.log(i,JSON.stringify(a))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"canvasHeight",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[1]}},{key:"canvasWidth",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[0]}},{key:"zoom",get:function(){var t=1;return this.obj.close&&(t*=2),t}},{key:"width",get:function(){return this.obj.width*this.zoom}},{key:"height",get:function(){return this.obj.height*this.zoom}}]),n}(d["a"])},"1b86":function(t,e,n){"use strict";n("3f8f")},"1c59":function(t,e,n){"use strict";n("d2ab")},2130:function(t,e,n){},2284:function(t,e,n){},"251f":function(t,e,n){},"25d4":function(t,e,n){"use strict";n("f526")},"28de":function(t,e,n){"use strict";n("2130")},"2c10":function(t,e,n){"use strict";n("afc0")},"32a3":function(t,e,n){},3742:function(t,e,n){"use strict";n("859a")},"39b7":function(t,e,n){"use strict";var r=n("7a23");function a(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("a",{target:"_blank",rel:"noopener noreferrer",href:t.href},[Object(r["v"])(t.$slots,"default")],8,["href"])}n("ac1f"),n("5319");var o=n("aacd"),i=Object(r["m"])({mixins:[o["a"]],props:{to:{type:String,required:!0}},computed:{href:function(){var t=this.to;return t=t.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),t=t.replace(/^wiki:\/\/(.*)/,(function(t,e){return"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+e.replaceAll(" ","-")})),t}}});i.render=a;e["a"]=i},"3f8f":function(t,e,n){},4265:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("d3b7");var r=n("3835"),a=(n("96cf"),n("1da1")),o=n("d4ec"),i=n("bee2"),c=n("fd0b"),s=n("8cae"),u=function(){function t(e){Object(o["a"])(this,t),this.obj=e,this.localRenderer=null,this.lastVersion=null,this.hitDetectionFallback=!1,this.renderable=!1,this.lastHq=!1,this.ready=Promise.resolve()}return Object(i["a"])(t,[{key:"updateLocalCanvas",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ready;case 2:if(n=this.canvasWidth,r=this.canvasHeight,0!==r||0!==n){t.next=7;break}return this.renderable=!1,t.abrupt("return");case 7:return this.renderable=!0,this.localRenderer=new c["a"](n,r),this.lastHq=e,t.next=12,this.localRenderer.render(this.renderLocal.bind(this));case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"needsRedraw",value:function(){return null===this.localRenderer||this.lastVersion!==this.version}},{key:"getRenderRotation",value:function(){return[this.flip?-this.rotation:this.rotation,{x:this.x,y:this.y+this.height/2}]}},{key:"render",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var a,o,i,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=this.lastHq!==n.hq||this.needsRedraw(),!a){t.next=4;break}return t.next=4,this.updateLocalCanvas(!n.hq);case 4:if(this.lastVersion=this.version,this.renderable){t.next=7;break}return t.abrupt("return");case 7:o=this.getRenderRotation(),i=Object(r["a"])(o,2),c=i[0],s=i[1],n.drawImage({image:this.localRenderer,x:this.canvasDrawPosX,y:this.canvasDrawPosY,w:this.canvasDrawWidth,h:this.canvasDrawHeight,rotation:c,rotationAnchor:s,flip:this.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,composite:this.composite,filters:this.filters});case 9:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getHitbox(),a=n.x0+(n.x1-n.x0)/2,o=n.y0+(n.y1-n.y0)/2,i=Object(s["a"])(t,e,a,o,this.flip?this.rotation:-this.rotation),c=Object(r["a"])(i,2),u=c[0],l=c[1],d=u>=n.x0&&u<=n.x1&&l>=n.y0&&l<=n.y1;if(!d)return!1;if(this.hitDetectionFallback)return!0;try{return this.pixelPerfectHitTest(t,e)}catch(p){this.hitDetectionFallback=!0}return!0}},{key:"pixelPerfectHitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getRenderRotation(),a=Object(r["a"])(n,2),o=a[0],i=a[1],c=i?Object(s["a"])(t,e,i.x,i.y,-o):[t,e],u=Object(r["a"])(c,2),l=u[0],d=u[1],p=Math.round(l-this.canvasDrawPosX),h=Math.round(d-this.canvasDrawPosY),b=this.canvasDrawWidth,f=this.canvasDrawHeight;if(p>=0&&p<=b&&h>=0&&h<=f){var v=this.flip?this.canvasDrawWidth-p:p,m=this.canvasWidth/this.canvasDrawWidth,j=this.canvasHeight/this.canvasDrawHeight,g=this.localRenderer.getDataAt(Math.round(v*m),Math.round(h*j));return 0!==g[3]}return!1}},{key:"getHitbox",value:function(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}},{key:"updatedContent",value:function(t,e){}},{key:"id",get:function(){return this.obj.id}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return this.obj.y}},{key:"version",get:function(){return this.obj.version}},{key:"flip",get:function(){return this.obj.flip}},{key:"rotation",get:function(){return this.obj.rotation/180*Math.PI}},{key:"composite",get:function(){return this.obj.composite}},{key:"filters",get:function(){return this.obj.filters}},{key:"width",get:function(){return this.obj.width}},{key:"height",get:function(){return this.obj.height}}]),t}()},4328:function(t,e,n){},4918:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n("99af"),n("4de4"),n("7db0"),n("d81d"),n("4ec9"),n("dca8"),n("d3b7"),n("6062"),n("3ca3"),n("2ca0"),n("ddb0");var r=n("3835"),a=(n("96cf"),n("1da1")),o=n("5530"),i=n("2909"),c=n("d4ec"),s=n("bee2"),u=n("032b"),l=n("0c0f"),d=n("7a23"),p="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",h=function(){function t(e,n,r){var a=this;Object(c["a"])(this,t),this.$store=r,e||(e={authors:{},packs:[]},l["f"].fire(new l["d"]("Couldn't load remote repository."))),n||(n={authors:{},packs:[]},u["a"].supports.localRepo&&l["f"].fire(new l["d"]("Couldn't load local repository."))),this.onlineRepo=Object(d["t"])(e),this.localRepo=Object(d["t"])(n),this.combinedList=Object(d["e"])((function(){var t,e,n,r,c=a.onlineRepo.value,s=null!==(t=null===c||void 0===c?void 0:c.packs)&&void 0!==t?t:[],l=(e=null===c||void 0===c?void 0:c.authors,new Map(s.map((function(t){return[t.id,t]})))),d=a.localRepo.value,p=null!==(n=null===d||void 0===d?void 0:d.packs)&&void 0!==n?n:[],h=(r=null===d||void 0===d?void 0:d.authors,new Map(p.map((function(t){return[t.id,t]})))),b=new Set(u["a"].state.autoAdd),f=a.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})),v=new Set(f),m=new Set;return[].concat(Object(i["a"])(f),Object(i["a"])(p.map((function(t){return t.id}))),Object(i["a"])(s.map((function(t){return t.id})))).filter((function(t){return!t.startsWith("dddg.buildin.")&&(!m.has(t)&&(m.add(t),!0))})).map((function(t){var e,n;return Object(o["a"])(Object(o["a"])(Object(o["a"])({},null!==(e=l.get(t))&&void 0!==e?e:{}),null!==(n=h.get(t))&&void 0!==n?n:{}),{},{autoloading:b.has(t),installed:h.has(t),online:l.has(t),loaded:v.has(t)})}))})),this.authors=Object(d["e"])((function(){var t,e,n=a.onlineRepo.value,r=null!==(t=null===n||void 0===n?void 0:n.authors)&&void 0!==t?t:{},i=a.localRepo.value,c=null!==(e=null===i||void 0===i?void 0:i.authors)&&void 0!==e?e:{};return Object(o["a"])(Object(o["a"])({},r),c)})),Object.freeze(this)}return Object(s["a"])(t,[{key:"getPacks",value:function(){return this.combinedList.value}},{key:"getPack",value:function(t){return this.getPacks().find((function(e){return e.id===t}))}},{key:"getAuthor",value:function(t){return this.authors.value[t]||null}},{key:"getAuthors",value:function(){return this.authors.value}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=this.createInstance()),t.instance}},{key:"createInstance",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var n,a,o,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loadRepo(p),a=u["a"].supports.localRepo?t.loadRepo(u["a"].localRepositoryUrl):null,e.next=4,Promise.all([n,a,t.$store]);case 4:return o=e.sent,i=Object(r["a"])(o,3),c=i[0],s=i[1],l=i[2],e.abrupt("return",new t(c,s,l));case 10:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()},{key:"loadRepo",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n){var a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.fetchJSON(n+"repo.json"),t.fetchJSON(n+"people.json")]);case 3:return a=e.sent,o=Object(r["a"])(a,2),i=o[0],c=o[1],e.abrupt("return",{packs:i,authors:c});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));function n(t){return e.apply(this,arguments)}return n}()},{key:"fetchJSON",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();h.$store=new Promise((function(t,e){h.setStore=t}))},"4a6f":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));n("99af"),n("4de4"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("96cf");var r=n("1da1"),a=n("b85c"),o=n("2909"),i=n("d4ec"),c=n("bee2"),s=n("262e"),u=n("2caf"),l=n("5947"),d=n("4265"),p=function(t){Object(s["a"])(n,t);var e=Object(u["a"])(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.refTextbox=null,t}return Object(c["a"])(n,[{key:"updatedContent",value:function(t,e){var n=t.state.objects.panels[e],r=[].concat(Object(o["a"])(n.order),Object(o["a"])(n.onTopOrder));this.refTextbox=null;var i,c=Object(a["a"])(r);try{for(c.s();!(i=c.n()).done;){var s=i.value,u=t.state.objects.objects[s];if("textBox"===u.type&&u.talkingObjId===this.obj.id)return void(this.refTextbox=u)}}catch(l){c.e(l)}finally{c.f()}}},{key:"renderLocal",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.getAssetList(),t.next=3,Promise.all(n.filter((function(t){return t.assets})).map((function(t){return h(t,e.hq)})));case 3:r=t.sent,o=Object(a["a"])(r);try{for(o.s();!(i=o.n()).done;){c=i.value,s=Object(a["a"])(c.assets);try{for(s.s();!(u=s.n()).done;)l=u.value,e.drawImage({image:l,composite:c.composite,x:c.offset[0],y:c.offset[1]})}catch(d){s.e(d)}finally{s.f()}}}catch(d){o.e(d)}finally{o.f()}case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"canvasDrawWidth",get:function(){return this.width*this.textboxZoom}},{key:"canvasDrawHeight",get:function(){return this.height*this.textboxZoom}},{key:"canvasDrawPosX",get:function(){return this.x-this.width/2+(this.height-this.canvasDrawHeight)/2}},{key:"canvasDrawPosY",get:function(){return this.y+(this.height-this.canvasDrawHeight)}},{key:"textboxZoom",get:function(){return this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1}}]),n}(d["a"]);function h(t,e){return b.apply(this,arguments)}function b(){return b=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!("loaded"in e)){t.next=2;break}return t.abrupt("return",e);case 2:return t.t0=e.offset,t.next=5,Promise.all(e.assets.map((function(t){return Object(l["a"])(t,n)})));case 5:return t.t1=t.sent,t.t2=e.composite,t.abrupt("return",{loaded:!0,offset:t.t0,assets:t.t1,composite:t.t2});case 8:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}},"4ad0":function(t,e,n){"use strict";n("a63c")},"50ef":function(t,e,n){"use strict";n("2284")},"51b0":function(t,e,n){"use strict";n("9e5a")},5947:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return j})),n.d(e,"f",(function(){return O})),n.d(e,"g",(function(){return k}));n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf");var r,a,o=n("1da1"),i=n("0c0f"),c=n("9be5"),s=n("032b");function u(){return r||(r=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),r}function l(){return a||(a=new Promise((function(t,e){var n="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",r=document.createElement("img");r.addEventListener("load",(function(){console.log("Heif no error. "+(2===r.width&&1===r.height)),t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){console.log("Heif not supported"),t(!1)})),r.src=n}))),a}var d={},p={};function h(t){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],t.abrupt("return",f(s["a"].supports.lq&&!n?e.lq:e.hq));case 2:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function f(t){return v.apply(this,arguments)}function v(){return v=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d[e]||(d[e]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(){i["f"].fire(new i["a"](e)),d[e]=void 0,t(new c["a"])})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))),t.abrupt("return",d[e]);case 2:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}var m=".";function j(t){return g.apply(this,arguments)}function g(){return g=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,r,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(a.length>1&&void 0!==a[1])||a[1],!p[e]){t.next=3;break}return t.abrupt("return",p[e]);case 3:return t.t0="".concat(m,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,u();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),t.abrupt("return",f(r));case 14:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function O(t,e){var n=URL.createObjectURL(e);return p[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["f"].fire(new i["b"](t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function k(t,e){return p[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["f"].fire(new i["b"](t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}},"5b30":function(t,e,n){"use strict";n("63f9")},"5c35":function(t,e,n){"use strict";n("61be")},"5dec":function(t,e,n){"use strict";n("4328")},"614d":function(t,e,n){},"61be":function(t,e,n){},6289:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("fec4");function a(){return{flip:!1,rotation:0,version:0,opacity:100,x:r["d"]/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null}}},"63f9":function(t,e,n){},"6a18":function(t,e,n){"use strict";n("6ceb")},"6ae4":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n("99af"),n("cb29"),n("4de4"),n("a15b"),n("96cf");var r=n("1da1"),a=n("b85c"),o=n("5530"),i=n("d4ec"),c=n("bee2"),s=n("73e5"),u=n("fd0b"),l=n("9be5"),d=function(){function t(e,n,r,a){Object(i["a"])(this,t),this.canvas=e,this.fsCtx=n,this.hq=r,this.preview=a,this.aborted=!1}return Object(c["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(o["a"])(Object(o["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,a=e.x,i=void 0===a?0:a,c=e.y,u=void 0===c?0:c,l=e.text,d=void 0===l?"":l;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(d,i,u)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(d,i,u)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(o["a"])(Object(o["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,a=e.text,i=void 0===a?"":a;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var c=this.fsCtx.measureText(i);return this.fsCtx.restore(),c}},{key:"drawImage",value:function(t){if(this.aborted)throw new s["a"];if(!(t.image instanceof l["a"])){var e=Object(o["a"])({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t),n=e.image,r=e.flip,i=e.x,c=e.y,d=e.w,p=e.h,h=e.filters,b=e.composite;if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=b,h)if("filter"in this.fsCtx){var f,v=[],m=Object(a["a"])(h);try{for(m.s();!(f=m.n()).done;){var j=f.value;"drop-shadow"===j.type?v.push("drop-shadow(".concat(j.offsetX,"px ").concat(j.offsetY,"px ").concat(j.blurRadius,"px ").concat(j.color,")")):"hue-rotate"===j.type?v.push("hue-rotate(".concat(j.value,"deg)")):"blur"===j.type?v.push("blur(".concat(j.value,"px)")):v.push("".concat(j.type,"(").concat(100*j.value,"%)"))}}catch(S){m.e(S)}finally{m.f()}this.fsCtx.filter=v.join(" ")}else{var g,O=1,k=Object(a["a"])(h);try{for(k.s();!(g=k.n()).done;){var y=g.value;"opacity"===y.type&&(O*=y.value)}}catch(S){k.e(S)}finally{k.f()}this.fsCtx.globalAlpha=O}if(t.shadow){var w=t.shadow;w.color&&(this.fsCtx.shadowColor=w.color),w.blur&&(this.fsCtx.shadowBlur=w.blur),w.offsetX&&(this.fsCtx.shadowOffsetX=w.offsetX),w.offsetY&&(this.fsCtx.shadowOffsetY=w.offsetY)}if(t.rotation){var x=t.rotationAnchor?t.rotationAnchor.x:0,C=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(x,C),this.fsCtx.fillRect(-10,-1,21,3),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-x,-C)}this.fsCtx.translate(i+d/2,c+p/2),this.fsCtx.scale(r?-1:1,1),n instanceof u["a"]?n.paintOnto(this.fsCtx,{x:-d/2,y:-p/2,w:d,h:p}):this.fsCtx.drawImage(n,-d/2,-p/2,d,p),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,a=t.h,o=t.outline,i=t.fill,c=t.composition;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,a),c&&(this.fsCtx.globalCompositeOperation=c),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),o&&(this.fsCtx.strokeStyle=o.style,this.fsCtx.lineWidth=o.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof u["a"]&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.fsCtx.save(),t.next=3,e(this.fsCtx);case 3:return t.next=5,n(this);case 5:this.fsCtx.restore();case 6:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"applyFilters",value:function(t){if(0!==t.length){this.fsCtx.save();var e,n=1,r=Object(a["a"])(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;"opacity"===o.type&&(n*=o.value)}}catch(l){r.e(l)}finally{r.f()}if("filter"in this.fsCtx){var i,c=[],s=Object(a["a"])(t);try{for(s.s();!(i=s.n()).done;){var u=i.value;"opacity"!==u.type&&("drop-shadow"===u.type?c.push("drop-shadow(".concat(u.offsetX,"px ").concat(u.offsetY,"px ").concat(u.blurRadius,"px ").concat(u.color,")")):"hue-rotate"===u.type?c.push("hue-rotate(".concat(u.value,"deg)")):"blur"===u.type?c.push("blur(".concat(u.value,"px)")):c.push("".concat(u.type,"(").concat(100*u.value,"%)")))}}catch(l){s.e(l)}finally{s.f()}this.fsCtx.filter=c.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),1!==n&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle="rgba(0,0,0,".concat(n,")"),this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}}},{key:"abort",value:function(){this.aborted=!0}}],[{key:"make",value:function(e,n,r){return new t(e,e.getContext("2d"),n,r)}},{key:"makeWithContext",value:function(e,n,r,a){return new t(e,n,r,a)}}]),t}()},"6ceb":function(t,e,n){},"6cff":function(t,e,n){},"6f08":function(t,e,n){"use strict";n("e3f7")},"71ca":function(t,e,n){"use strict";n("614d")},"73e5":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("d4ec"),a=function t(){Object(r["a"])(this,t)}},7592:function(t,e,n){},"76bd":function(t,e,n){},"77e2":function(t,e,n){"use strict";n("98ff")},7894:function(t,e,n){"use strict";n("fb68")},"7e59":function(t,e,n){},"81ec":function(t,e,n){"use strict";n("251f")},"859a":function(t,e,n){},"85e7":function(t,e,n){"use strict";n("76bd")},"866c":function(t,e,n){},"8cae":function(t,e,n){"use strict";function r(t,e,n,r,a){var o=Math.cos(a),i=Math.sin(a),c=t-n,s=e-r,u=o*c-i*s+n,l=i*c+o*s+r;return[u,l]}n.d(e,"a",(function(){return r}))},"8f50":function(t,e,n){"use strict";n("06af")},9084:function(t,e,n){},9566:function(t,e,n){"use strict";n("a070")},"98ff":function(t,e,n){},"9be5":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("d4ec"),a=function t(){Object(r["a"])(this,t)}},"9e3d":function(t,e,n){"use strict";n("f317")},"9e5a":function(t,e,n){},a070:function(t,e,n){},a582:function(t,e,n){},a63c:function(t,e,n){},a6d1:function(t,e,n){},aacd:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=25,a={methods:{verticalScrollRedirect:function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget,n=getComputedStyle(e),a=t;if(0!==a.deltaY){if("auto"===n.overflowY)if(a.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight)return void t.stopPropagation()}else if(e.scrollTop>0)return void t.stopPropagation();var o=e.scrollLeft;a.mozInputSource?e.scrollLeft+=a.deltaY*r:e.scrollLeft+=a.deltaY,e.scrollLeft!==o&&t.stopPropagation()}}}}}},ae6d:function(t,e,n){"use strict";n("a582")},afc0:function(t,e,n){},b3d7:function(t,e,n){"use strict";var r=n("7a23"),a=Object(r["F"])("data-v-36ffea9a");Object(r["r"])("data-v-36ffea9a");var o={class:"fieldset_wrapper"},i={key:0},c={class:"fieldset_contents"};Object(r["q"])();var s=a((function(t,e,n,a,s,u){return Object(r["p"])(),Object(r["g"])("div",o,[Object(r["k"])("fieldset",null,[t.title>""?(Object(r["p"])(),Object(r["g"])("legend",i,Object(r["x"])(t.title),1)):Object(r["h"])("",!0),Object(r["k"])("div",c,[Object(r["v"])(t.$slots,"default")])])])})),u=Object(r["m"])({props:{title:{required:!0,type:String}}});n("25d4");u.render=s,u.__scopeId="data-v-36ffea9a";e["a"]=u},ba37:function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"e",(function(){return h})),n.d(e,"h",(function(){return f})),n.d(e,"g",(function(){return v})),n.d(e,"f",(function(){return m})),n.d(e,"c",(function(){return j})),n.d(e,"a",(function(){return O})),n.d(e,"d",(function(){return k}));n("99af"),n("4de4"),n("7db0"),n("c740"),n("5db7"),n("c975"),n("d81d"),n("73d9"),n("b64b"),n("d3b7"),n("ddb0"),n("96cf");var r=n("1da1"),a=n("ade3"),o=n("2909"),i=n("5530"),c=n("fec4"),s=n("c837"),u=n("6289"),l=-74,d=-26,p={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup:function(t,e){var n=e.id,r=e.styleGroupId,a=t.objects[n];a.styleGroupId=r,++a.version},setCharStyle:function(t,e){var n=e.id,r=e.styleId,a=t.objects[n];a.styleId=r,++a.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=Object(i["a"])(Object(i["a"])({},n.posePositions),e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];n.freeMove=e.freeMove,n.freeMove||(n.x=c["a"][j(n.x)],n.y=d)}};function h(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function b(t,e){var n=t["content/getCharacters"];return n.get(e)}function f(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function v(t,e){var n=f(t,e),r=Object(o["a"])(Object.keys(n.positions).filter((function(t){return n.positions[t].length>1})));return n.compatibleHeads.length>0&&r.unshift("head"),r}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType||0,r=f(t,e).compatibleHeads;if(!r||0===r.length)return null;var a=t.heads[r[n]];return a}function j(t){var e=c["a"].map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return e[0].idx}var g=0,O={createCharacters:function(t,e){var n=t.rootState,r=t.rootGetters,a=t.commit,o=b(r,e.characterType);a("create",{object:Object(i["a"])(Object(i["a"])({},Object(u["a"])()),{},{id:"characters_"+ ++g,panelId:n.panels.currentPanel,onTop:!1,type:"character",y:d,preserveRatio:!0,ratio:1,height:768,width:768,characterType:e.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:o.label||o.id,enlargeWhenTalking:n.ui.defaultCharacterTalkingZoom})})},seekPart:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,i=t.rootGetters,c=e.delta,u=e.id,l=e.part;if("head"!==l){var d=n.objects[u],p=f(b(i,d.characterType),d);p.positions[l]&&r("setPosePosition",{id:u,posePositions:Object(a["a"])({},l,Object(s["a"])(p.positions[l],d.posePositions[l]||0,c))})}else o("seekHead",{id:u,delta:c})},seekPose:function(t,e){var n=t.state,r=t.commit,a=t.rootGetters,o=e.id,i=e.delta,c=n.objects[o],u=b(a,c.characterType),l=u.styleGroups[c.styleGroupId].styles[c.styleId].poses;C(r,c,u,(function(t){t.poseId=Object(s["a"])(l,t.poseId,i)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,a=t.rootGetters,o=e.id,i=e.delta,c=n.objects[o],u=b(a,c.characterType),l=u.styleGroups.flatMap((function(t,e){return t.styles.map((function(t,n){return{styleGroupIdx:e,styleIdx:n,styleGroupJson:JSON.stringify(t.components)}}))})).sort((function(t,e){return t.styleGroupJson.localeCompare(e.styleGroupJson)})),d=l.findIndex((function(t){return t.styleGroupIdx===c.styleGroupId&&t.styleIdx===c.styleId}));C(r,c,u,(function(t){var e=Object(s["a"])(l,d,i),n=l[e];t.styleGroupId=n.styleGroupIdx,t.styleId=n.styleIdx}))},seekHead:function(t,e){var n=t.state,r=t.commit,a=t.rootGetters,o=e.id,i=e.delta,c=n.objects[o],u=b(a,c.characterType),l=f(u,c),d=m(u,c);if(d){var p=(c.posePositions.head||0)+i,h=c.posePositions.headType||0;(p<0||p>=d.variants.length)&&(h=Object(s["a"])(l.compatibleHeads.map((function(t){return u.heads[t]})),h,i),d=m(u,c,h),p=1===i?0:d.variants.length-1),r("setPosePosition",{id:o,posePositions:{head:p,headType:h}})}},setPart:function(t,e){var n=t.state,r=t.commit,a=t.rootGetters,o=e.id,i=e.part,c=e.val,s=n.objects[o],u=b(a,s.characterType);C(r,s,u,"pose"===i?function(t){t.poseId=c}:"style"===i?function(t){t.styleId=c}:function(t){t.posePositions[i]=c})},setCharStyle:function(t,e){var n=t.state,r=t.commit,a=t.rootGetters,o=e.id,i=e.styleGroupId,c=e.styleId,s=n.objects[o],u=b(a,s.characterType);C(r,s,u,(function(t){t.styleGroupId=i,t.styleId=c}))},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,a=e.id,o=e.x,i=e.y,s=n.objects[a];s.freeMove?r("setPosition",{id:a,x:o,y:i}):r("setPosition",{id:a,x:c["a"][j(o)],y:d+(s.close?l:0)})},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,a=e.id,o=e.delta,i=n.objects[a],s=j(i.x),u=s+o;u<0&&(u=0),u>=c["a"].length&&(u=c["a"].length-1),r("setPosition",{id:a,x:c["a"][u],y:i.y})}};function k(t,e,n){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){var a,o,i,c,s,u,l,d,p,h,b,f,v,m,j,g,O,k,y,C,S,R;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.state.objects[n],o=r.characters.find((function(t){return t.id===a.characterType})),o){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(i=w(a),c=o.styleGroups[a.styleGroupId],s=c.styles[i.styleId],u=s.poses[i.poseId],l=e.rootState.content.current.characters.find((function(t){return t.id===o.id})),l){t.next=15;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 15:d=l.styleGroups.findIndex((function(t){return t.id===c.id})),i.styleGroupId=-1===d?0:d,p=l.styleGroups[i.styleGroupId],h=JSON.stringify(s.components),b=p.styles.findIndex((function(t){return JSON.stringify(t.components)===h})),i.styleId=-1===b?0:b,f=p.styles[i.styleId],v=f.poses.findIndex((function(t){return t.id===u.id})),i.poseId=-1===v?0:v,m=f.poses[i.poseId],j={},t.t0=regeneratorRuntime.keys(m.positions);case 27:if((t.t1=t.t0()).done){t.next=35;break}if(g=t.t1.value,m.positions.hasOwnProperty(g)){t.next=31;break}return t.abrupt("continue",27);case 31:O=m.positions[g],u.positions[g]?(k=i.posePositions[g],k>=0&&k<O.length?j[g]=k:j[g]=0):j[g]=0,t.next=27;break;case 35:y=u.compatibleHeads[a.posePositions.headType],C=m.compatibleHeads.indexOf(y),-1===C?(i.posePositions.headType=0,i.posePositions.head=0):(C!==a.posePositions.headType&&(i.posePositions.headType=C),S=JSON.stringify(o.heads[y].variants[a.posePositions.head]),R=l.heads[y].variants.findIndex((function(t){return JSON.stringify(t)===S})),i.posePositions.head=-1===R?0:R),x(e.commit,a,i);case 39:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function w(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Object(i["a"])({},t.posePositions)}}function x(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function C(t,e,n,r){var a=w(e);r(a),n.styleGroups[a.styleGroupId]||(a.styleGroupId=0);var o=n.styleGroups[a.styleGroupId];o.styles[a.styleId]||(a.styleId=0);var i=o.styles[a.styleId];i.poses[a.poseId]||(a.poseId=0);var c=i.poses[a.poseId];for(var s in c.positions)c.positions[s]&&(c.positions[s][a.posePositions[s]]||(a.posePositions[s]=0));var u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId],l=u.compatibleHeads[e.posePositions.headType||0],d=c.compatibleHeads.indexOf(l);d>=0?a.posePositions.headType=d:(a.posePositions.headType=0,a.posePositions.head=0),x(t,e,a)}},c02d:function(t,e,n){"use strict";n("da86")},c4e5:function(t,e,n){"use strict";var r=n("7a23"),a={class:"toggle_box"};function o(t,e,n,o,i,c){return Object(r["p"])(),Object(r["g"])("div",a,[Object(r["D"])(Object(r["k"])("input",{id:t._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.value=e})},null,8,["id"]),[[r["y"],t.value]]),Object(r["k"])("label",{for:t._.uid,class:"switch"},null,8,["for"]),Object(r["k"])("label",{for:t._.uid,class:"toggle_label"},Object(r["x"])(t.label),9,["for"])])}var i=Object(r["m"])({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get:function(){return this.modelValue},set:function(t){this.$emit("update:modelValue",t)}},checkbox:function(){return this.$refs.checkbox}}});n("85e7");i.render=o;e["a"]=i},c53c:function(t,e,n){"use strict";n("0416")},c837:function(t,e,n){"use strict";function r(t,e,n){var r=e+n,a=t.length;return r<0&&(r+=a),r>=a&&(r-=a),r}n.d(e,"a",(function(){return r}))},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a={key:0},o={key:1,id:"app"},i={id:"container"},c=Object(r["k"])("div",{id:"modal-messages"},null,-1);function s(t,e,n,s,u,l){var d=Object(r["w"])("render"),p=Object(r["w"])("message-console"),h=Object(r["w"])("tool-box"),b=Object(r["w"])("single-box"),f=Object(r["w"])("modal-dialog"),v=Object(r["w"])("expression-builder");return Object(r["p"])(),Object(r["g"])(r["a"],null,[t.canvasTooSmall&&t.isSafari?(Object(r["p"])(),Object(r["g"])("div",a," Protrait mode is not supported by safari. Please turn the device sideways. ")):(Object(r["p"])(),Object(r["g"])("div",o,[Object(r["k"])("div",i,[Object(r["k"])(d,{ref:"render",canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight},null,8,["canvasWidth","canvasHeight"])]),Object(r["k"])(p),Object(r["k"])(h,{"onShow-prev-render":t.drawLastDownload,onDownload:e[1]||(e[1]=function(e){return t.$refs.render.download()}),"onShow-dialog":t.showDialog,"onShow-expression-dialog":t.showExpressionDialog},null,8,["onShow-prev-render","onShow-dialog","onShow-expression-dialog"]),(Object(r["p"])(),Object(r["g"])(r["b"],null,[t.dialogVisable?Object(r["k"])(f,{key:0,ref:"dialog",onLeave:e[3]||(e[3]=function(e){return t.dialogVisable=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(b,{ref:"packDialog",onLeave:e[2]||(e[2]=function(e){return t.dialogVisable=!1})},null,512)]})),_:1},512):Object(r["h"])("",!0)],1024)),t.expressionBuilderVisible?Object(r["k"])(f,{key:0,ref:"dialog",onLeave:e[5]||(e[5]=function(e){return t.expressionBuilderVisible=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(v,{character:t.expressionBuilderCharacter,initHeadGroup:t.expressionBuilderHeadGroup,onLeave:e[4]||(e[4]=function(e){return t.expressionBuilderVisible=!1})},null,8,["character","initHeadGroup"])]})),_:1},512):Object(r["h"])("",!0)])),c],64)}n("b64b"),n("d3b7"),n("07ac"),n("6062"),n("3ca3"),n("ddb0"),n("96cf");var u=n("1da1"),l=n("3835"),d={id:"toolbar"},p=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"add_box",-1),h=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"panorama",-1),b=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"view_module",-1),f=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"settings_applications",-1),v={id:"toolbar-end"},m=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"help",-1),j=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"extension",-1),g=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"flip_to_back",-1),O=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"photo_camera",-1);function k(t,e,n,a,o,i){var c=Object(r["w"])("settings-panel"),s=Object(r["w"])("content-packs-panel"),u=Object(r["w"])("backgrounds-panel"),l=Object(r["w"])("credits-panel"),k=Object(r["w"])("character-panel"),y=Object(r["w"])("sprite-panel"),w=Object(r["w"])("text-box-panel"),x=Object(r["w"])("choice-panel"),C=Object(r["w"])("panels-panel"),S=Object(r["w"])("notification-panel"),R=Object(r["w"])("poem-panel"),P=Object(r["w"])("add-panel");return Object(r["p"])(),Object(r["g"])("div",{id:"panels",class:{vertical:t.vertical}},[Object(r["k"])("div",d,[Object(r["k"])("button",{class:{active:"add"===t.panel},onClick:e[1]||(e[1]=function(e){return t.setPanel("add")}),title:"Add new objects to the scene","aria-label":"Add new objects to the scene"},[p],2),Object(r["k"])("button",{class:{active:"backgrounds"===t.panel},onClick:e[2]||(e[2]=function(e){return t.setPanel("backgrounds")}),"aria-label":"Change the current background",title:"Change the current background"},[h],2),Object(r["k"])("button",{class:{active:"panels"===t.panel},title:"Panels","aria-label":"Panels",onClick:e[3]||(e[3]=function(e){return t.setPanel("panels")})},[b],2),Object(r["k"])("button",{class:{active:"settings"===t.panel},title:"Settings","aria-label":"Settings",onClick:e[4]||(e[4]=function(e){return t.setPanel("settings")})},[f],2)]),"settings"===t.panel?Object(r["k"])(c,{key:0}):"packs"===t.panel?Object(r["k"])(s,{key:1}):"backgrounds"===t.panel?Object(r["k"])(u,{key:2,"onShow-dialog":e[5]||(e[5]=function(e){return t.$emit("show-dialog",e)})}):"help_credits"===t.panel?Object(r["k"])(l,{key:3}):"character"===t.panel?Object(r["k"])(k,{key:4,"onShow-dialog":e[6]||(e[6]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[7]||(e[7]=function(e){return t.$emit("show-expression-dialog",e)})}):"sprite"===t.panel?Object(r["k"])(y,{key:5}):"textBox"===t.panel?Object(r["k"])(w,{key:6}):"choice"===t.panel?Object(r["k"])(x,{key:7}):"panels"===t.panel?Object(r["k"])(C,{key:8}):"notification"===t.panel?Object(r["k"])(S,{key:9}):"poem"===t.panel?Object(r["k"])(R,{key:10}):Object(r["k"])(P,{key:11,"onShow-dialog":e[8]||(e[8]=function(e){return t.$emit("show-dialog",e)})}),Object(r["k"])("div",v,[Object(r["k"])("button",{class:{active:"help_credits"===t.panel},onClick:e[9]||(e[9]=function(e){return t.setPanel("help_credits")}),title:"Help & Credits","aria-label":"Help & Credits"},[m],2),Object(r["k"])("button",{class:{active:"packs"===t.panel},onClick:e[10]||(e[10]=function(e){return t.$emit("show-dialog")}),title:"Content packs","aria-label":"Content packs"},[j],2),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.$emit("show-prev-render")}),title:"Show last downloaded panel","aria-label":"Show last downloaded panel",disabled:!t.hasPrevRender},[g],8,["disabled"]),Object(r["k"])("button",{title:"Take a screenshot of the current scene","aria-label":"Take a screenshot of the current scene",onClick:e[12]||(e[12]=function(e){return t.$emit("download")})},[O])])],2)}var y=Object(r["F"])("data-v-ba6b5c3e");Object(r["r"])("data-v-ba6b5c3e");var w={class:"panel"},x=Object(r["k"])("h1",null,"Settings",-1),C={class:"modal-scroll-area"},S=Object(r["k"])("p",null," Do you want to allow DDDG to save settings on your device? ",-1),R=Object(r["k"])("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1),P=Object(r["k"])("p",null," You can revoke this permission at any time. ",-1),I=Object(r["j"])(" Our usual "),T=Object(r["j"])("privacy policy"),A=Object(r["j"])(" still applies. "),_={class:"modal-scroll-area"},D=Object(r["k"])("p",null," Do you want to deny DDDG from saving settings on your device? ",-1),$=Object(r["k"])("p",null," This will cause all your settings to reset when leaving the page. ",-1),H=Object(r["j"])(" Our usual "),V=Object(r["j"])("privacy policy"),B=Object(r["j"])(" still applies. "),E={key:0,disabled:""},F=Object(r["k"])("td",null,[Object(r["k"])("label",null,"Theme:")],-1),L=Object(r["k"])("option",{value:null},"System",-1),M=Object(r["k"])("option",{value:!1},"Light",-1),N=Object(r["k"])("option",{value:!0},"Dark",-1);Object(r["q"])();var W=y((function(t,e,n,a,o,i){var c=Object(r["w"])("l"),s=Object(r["w"])("modal-dialog"),u=Object(r["w"])("toggle");return Object(r["p"])(),Object(r["g"])("div",w,[x,(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.allowSavesModal?Object(r["k"])(s,{key:0,options:["Allow","Deny"],onLeave:e[1]||(e[1]=function(e){return t.allowSaves("Deny")}),onOption:t.allowSaves,"no-base-size":""},{default:y((function(){return[Object(r["k"])("div",C,[S,R,P,Object(r["k"])("p",null,[I,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:y((function(){return[T]})),_:1}),A])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0),t.denySavesModal?Object(r["k"])(s,{key:1,options:["Deny","Cancle"],onLeave:e[2]||(e[2]=function(e){return t.denySaves("Cancle")}),onOption:t.denySaves,"no-base-size":""},{default:y((function(){return[Object(r["k"])("div",_,[D,$,Object(r["k"])("p",null,[H,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:y((function(){return[V]})),_:1}),B])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0)])),t.waitOnSaveChange?(Object(r["p"])(),Object(r["g"])("button",E," Applying... ")):!t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.allowSavesModal=!0})}," Allow saving options ")):t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.denySavesModal=!0})}," Deny saving options ")):Object(r["h"])("",!0),t.lqAllowed?Object(r["k"])(u,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:t.lqRendering,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.lqRendering=e})},null,8,["modelValue"]):Object(r["h"])("",!0),Object(r["k"])(u,{label:"NSFW Mode?",modelValue:t.nsfw,"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.nsfw=e})},null,8,["modelValue"]),Object(r["k"])(u,{label:"Enlarge talking objects? (Default value)",modelValue:t.defaultCharacterTalkingZoom,"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.defaultCharacterTalkingZoom=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[F,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.theme=e})},[L,M,N],512),[[r["z"],t.theme]])])])])])})),U=n("c4e5"),z=n("aacd"),q={mixins:[z["a"]],computed:{vertical:function(){return this.$store.state.ui.vertical}},mounted:function(){var t=this;this.updateVertical(),this.$el.addEventListener("wheel",(function(e){t.vertical||t.verticalScrollRedirect(e)}),{passive:!0})},methods:{updateVertical:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical:function(){this.updateVertical()}}},G=n("032b"),Y=Object(r["F"])("data-v-64aeb4c5");Object(r["r"])("data-v-64aeb4c5");var K={key:0,id:"submit-options"};Object(r["q"])();var X=Y((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("div",{class:"dialog-wrapper",onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},[Object(r["k"])("dialog",{open:"",class:{"base-size":!t.noBaseSize},onClick:e[1]||(e[1]=Object(r["E"])((function(){}),["stop"]))},[Object(r["v"])(t.$slots,"default"),t.options.length>0?(Object(r["p"])(),Object(r["g"])("div",K,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.options,(function(e){return Object(r["p"])(),Object(r["g"])("button",{key:e,class:"option",onClick:function(n){return t.$emit("option",e)}},Object(r["x"])(e),9,["onClick"])})),128))])):Object(r["h"])("",!0)],2)])})),J=Object(r["m"])({props:{noBaseSize:Boolean,options:{type:Array,default:[]}}});n("c02d");J.render=X,J.__scopeId="data-v-64aeb4c5";var Q=J,Z=n("39b7"),tt=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ModalDialog:Q,L:Z["a"]},data:function(){return{allowSavesModal:!1,denySavesModal:!1,waitOnSaveChange:!1}},computed:{savesAllowed:{get:function(){return G["a"].savingEnabled},set:function(t){this.waitOnSaveChange=!0,G["a"].savingEnabled=t,this.saveSettings()}},savesEnabledInEnv:function(){return G["a"].supports.optionalSaving},lqAllowed:function(){return G["a"].supports.lq},lqRendering:{get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)})))),this.saveSettings()}},nsfw:{get:function(){return!!this.$store.state.ui.nsfw},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setNsfw",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},defaultCharacterTalkingZoom:{get:function(){return!!this.$store.state.ui.defaultCharacterTalkingZoom},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDefaultCharacterTalkingZoom",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},theme:{get:function(){return this.$store.state.ui.useDarkTheme},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDarkTheme",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}}},watch:{savesAllowed:function(){this.waitOnSaveChange=!1}},methods:{allowSaves:function(t){this.allowSavesModal=!1,"Allow"===t&&(this.savesAllowed=!0)},denySaves:function(t){this.denySavesModal=!1,"Deny"===t&&(this.savesAllowed=!1)},saveSettings:function(){var t;G["a"].saveSettings({lq:this.$store.state.ui.lqRendering,nsfw:this.$store.state.ui.nsfw,darkMode:null!==(t=this.$store.state.ui.useDarkTheme)&&void 0!==t?t:void 0,defaultCharacterTalkingZoom:this.$store.state.ui.defaultCharacterTalkingZoom})}}});n("9566");tt.render=W,tt.__scopeId="data-v-ba6b5c3e";var et=tt,nt=Object(r["F"])("data-v-5f8bbaab");Object(r["r"])("data-v-5f8bbaab");var rt=Object(r["j"])("Drop here to add as a new sprite"),at=Object(r["k"])("h1",null,"Add",-1),ot=Object(r["j"])(" Characters "),it=Object(r["j"])(" Sprites "),ct=Object(r["j"])(" UI "),st=Object(r["j"])(" Search in content packs "),ut=Object(r["j"])(" Upload new sprite "),lt=Object(r["j"])(" New sprite from URL "),dt=Object(r["j"])(" Search in content packs ");Object(r["q"])();var pt=nt((function(t,e,n,a,o,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("d-button");return void 0!==t.isWebPSupported?(Object(r["p"])(),Object(r["g"])("div",{key:0,class:"panel",onDragenter:e[14]||(e[14]=function(){return t.showDropTarget.apply(t,arguments)}),onMouseleave:e[15]||(e[15]=function(){return t.hideDropTarget.apply(t,arguments)})},[Object(r["k"])(c,{ref:"spriteDt",class:"drop-target",onDrop:t.addCustomSpriteFile},{default:nt((function(){return[rt]})),_:1},8,["onDrop"]),at,Object(r["k"])("div",{class:{"group-selector":!0,vertical:t.vertical}},[Object(r["k"])(s,{class:{active:"characters"===t.group},"icon-pos":"top",icon:"emoji_people",onClick:e[1]||(e[1]=function(e){return t.group="characters"})},{default:nt((function(){return[ot]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"sprites"===t.group},"icon-pos":"top",icon:"change_history",onClick:e[2]||(e[2]=function(e){return t.group="sprites"})},{default:nt((function(){return[it]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"ui"===t.group},"icon-pos":"top",icon:"view_quilt",onClick:e[3]||(e[3]=function(e){return t.group="ui"})},{default:nt((function(){return[ct]})),_:1},8,["class"])],2),Object(r["k"])("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.characters,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"character",key:e.id,title:e.label,onClick:function(n){return t.onChosen(e.id.toLowerCase())}},[Object(r["k"])("img",{src:t.assetPath(e),alt:e.label},null,8,["src","alt"])],8,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"extension",onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Characters")})},{default:nt((function(){return[st]})),_:1})],64)):Object(r["h"])("",!0),"sprites"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.sprites,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"sprite",key:e.label,title:e.label,style:{background:t.assetSpriteBackground(e)},onClick:function(n){return t.addSpriteToScene(e)}},Object(r["x"])(e.label),13,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"publish",onClick:e[6]||(e[6]=function(e){return t.$refs.spriteUpload.click()})},{default:nt((function(){return[ut,Object(r["k"])("input",{type:"file",ref:"spriteUpload",onChange:e[5]||(e[5]=function(){return t.onSpriteFileUpload.apply(t,arguments)})},null,544)]})),_:1}),Object(r["k"])(s,{icon:"insert_link",onClick:t.uploadFromURL},{default:nt((function(){return[lt]})),_:1},8,["onClick"]),Object(r["k"])(s,{icon:"extension",onClick:e[7]||(e[7]=function(e){return t.$emit("show-dialog","type: Sprites")})},{default:nt((function(){return[dt]})),_:1})],64)):Object(r["h"])("",!0),"ui"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("button",{onClick:e[8]||(e[8]=function(){return t.addTextBox.apply(t,arguments)})},"Textbox"),Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.addPoem.apply(t,arguments)})},"Poem"),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(){return t.addDialog.apply(t,arguments)})},"Notification"),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(){return t.addChoice.apply(t,arguments)})},"Choice"),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(){return t.addConsole.apply(t,arguments)})},"Console")],64)):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(){return t.paste.apply(t,arguments)}),disabled:!t.hasClipboardContent}," Paste ",8,["disabled"])],2)],32)):Object(r["h"])("",!0)})),ht=(n("7db0"),n("a630"),n("a15b"),n("d81d"),n("fb6a"),n("b0c0"),n("ac1f"),n("466d"),n("1276"),n("2b3d"),n("b85c")),bt=n("5947"),ft=n("dc61"),vt=Object(r["F"])("data-v-465f5994");Object(r["r"])("data-v-465f5994");var mt={class:"material-icons","aria-hidden":"true"},jt={class:"content"};Object(r["q"])();var gt=vt((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("button",{class:[t.iconPos],disabled:t.disabled},[Object(r["k"])("div",mt,Object(r["x"])(t.icon),1),Object(r["k"])("div",jt,[Object(r["v"])(t.$slots,"default")])],10,["disabled"])})),Ot=Object(r["m"])({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1}}});n("4ad0");Ot.render=gt,Ot.__scopeId="data-v-465f5994";var kt=Ot,yt={packId:"dddg.buildin.uploadedSprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},wt=Object(r["m"])({mixins:[q],components:{DropTarget:ft["a"],DButton:kt},data:function(){return{isWebPSupported:null,customAssetCount:0,group:"characters"}},computed:{characters:function(){return this.$store.state.content.current.characters},sprites:function(){return this.$store.state.content.current.sprites},hasClipboardContent:function(){return!!this.$store.state.ui.clipboard}},methods:{assetSpriteBackground:function(t){return t.variants[0].map((function(t){return"url('".concat(t.lq,"')")})).join(",")},assetPath:function(t){return t.chibi?G["a"].supports.lq?t.chibi.lq:t.chibi.hq:""},showDropTarget:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link","sprites"===this.group&&this.$refs.spriteDt.show()))},hideDropTarget:function(){"sprites"===this.group&&this.$refs.spriteDt.hide()},onSpriteFileUpload:function(){var t=this.$refs.spriteUpload;if(t.files){var e,n=Object(ht["a"])(t.files);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.addCustomSpriteFile(r)}}catch(a){n.e(a)}finally{n.f()}}},uploadFromURL:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=prompt("Enter the URL of the image"),n){e.next=3;break}return e.abrupt("return");case 3:r=n.split("/").slice(-1)[0],t.addNewCustomSprite(r,n);case 5:case"end":return e.stop()}}),e)})))()},addSpriteToScene:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("objects/createSprite",{assets:t.variants[0]});case 2:case"end":return n.stop()}}),n)}))));case 1:case"end":return n.stop()}}),n)})))()},addTextBox:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createTextBox",{});case 1:case"end":return e.stop()}}),e)}))))},addChoice:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createChoice",{});case 1:case"end":return e.stop()}}),e)}))))},addDialog:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createNotification",{});case 1:case"end":return e.stop()}}),e)}))))},addPoem:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createPoem",{});case 1:case"end":return e.stop()}}),e)}))))},addConsole:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createConsole",{});case 1:case"end":return e.stop()}}),e)}))))},paste:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/pasteObjectFromClipboard",{});case 1:case"end":return e.stop()}}),e)}))))},onChosen:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.dispatch("objects/createCharacters",{characterType:t});case 1:case"end":return n.stop()}}),n)}))))},addCustomSpriteFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomSprite(t.name,e)},addNewCustomSprite:function(t,e){var n=this;yt.sprites.push({id:e,label:t,variants:[[e]]}),this.vuexHistory.transaction((function(){n.$store.dispatch("content/replaceContentPack",{contentPack:yt,processed:!1})}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(bt["e"])();case 2:t.isWebPSupported=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("50ef");wt.render=pt,wt.__scopeId="data-v-5f8bbaab";var xt=wt,Ct=Object(r["F"])("data-v-47403597");Object(r["r"])("data-v-47403597");var St={key:0},Rt={class:"arrow-col"},Pt={class:"arrow-col"},It={key:1},Tt={class:"arrow-col"},At={class:"arrow-col"},_t={class:"arrow-col"},Dt={class:"arrow-col"};Object(r["q"])();var $t=Ct((function(t,e,n,a,o,i){var c=Object(r["w"])("parts"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:t.label,showAltPanel:t.panelForParts},{"alt-panel":Ct((function(){return[t.panelForParts?Object(r["k"])(c,{key:0,character:t.object,part:t.panelForParts,onLeave:e[1]||(e[1]=function(e){return t.panelForParts=null}),"onShow-dialog":e[2]||(e[2]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[3]||(e[3]=function(e){return t.$emit("show-expression-dialog",e)})},null,8,["character","part"]):Object(r["h"])("",!0)]})),default:Ct((function(){return[t.hasMultiplePoses||t.parts.length>0?Object(r["k"])(s,{key:0,class:"pose-list",title:"Pose:"},{default:Ct((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[t.hasMultipleStyles?(Object(r["p"])(),Object(r["g"])("tr",St,[Object(r["k"])("td",Rt,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.seekStyle(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[5]||(e[5]=function(e){return t.panelForParts="style"})}," Style ")]),Object(r["k"])("td",Pt,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.seekStyle(1)})},">")])])):Object(r["h"])("",!0),t.hasMultiplePoses?(Object(r["p"])(),Object(r["g"])("tr",It,[Object(r["k"])("td",Tt,[Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.seekPose(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[8]||(e[8]=function(e){return t.panelForParts="pose"})}," Pose ")]),Object(r["k"])("td",At,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.seekPose(1)})},">")])])):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e){return Object(r["p"])(),Object(r["g"])("tr",{key:e},[Object(r["k"])("td",_t,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,-1)}},"<",8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:function(n){return t.panelForParts=e}},Object(r["x"])(t.captialize(e)),9,["onClick"])]),Object(r["k"])("td",Dt,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,1)}},">",8,["onClick"])])])})),128))])])]})),_:1}):Object(r["h"])("",!0)]})),options:Ct((function(){return[Object(r["k"])(u,{modelValue:t.closeUp,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.closeUp=e}),label:"Close up?"},null,8,["modelValue"])]})),_:1},8,["object","title","showAltPanel"])})),Ht=n("ba37"),Vt=n("b3d7"),Bt=Object(r["F"])("data-v-47f2e1e8");Object(r["r"])("data-v-47f2e1e8");var Et=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Ft=Object(r["k"])("span",{class:"text-block"},"Create new expressions",-1),Lt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Mt=Object(r["k"])("span",{class:"text-block"},"Search in content packs",-1),Nt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Wt=Object(r["k"])("span",null,"Search in content packs",-1),Ut=Object(r["k"])("i",{class:"material-icons"},"extension",-1),zt=Object(r["k"])("span",null,"Search in content packs",-1);Object(r["q"])();var qt=Bt((function(t,e,n,a,o,i){var c=Object(r["w"])("part-button"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{"no-wraping":""},{default:Bt((function(){return[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"Back"),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(e){return t.$emit("show-expression-dialog",{character:t.character.characterType})}),class:"icon-button"},[Et,Ft])):Object(r["h"])("",!0),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.$emit("show-dialog","type: Expressions character: "+t.charData.label)}),class:"icon-button"},[Lt,Mt])):"style"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Styles character: "+t.charData.label)}),class:"icon-button"},[Nt,Wt])):(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(e){return t.$emit("show-dialog","type: Poses character: "+t.charData.label)}),class:"icon-button"},[Ut,zt])),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e,n){return Object(r["p"])(),Object(r["g"])(c,{key:n,value:n,part:e,onClick:function(e){t.choose(n),t.$emit("leave")}},null,8,["value","part","onClick"])})),128)),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.styleComponents,(function(e){return Object(r["p"])(),Object(r["g"])(u,{key:e.name,title:e.label},{default:Bt((function(){return[Object(r["k"])(s,{noWraping:""},{default:Bt((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(e.buttons,(function(n,a){return Object(r["p"])(),Object(r["g"])(c,{size:130,key:a,value:a,part:n,onClick:function(n){return t.choose_component(e.name,a)}},null,8,["value","part","onClick"])})),128))]})),_:2},1024)]})),_:2},1032,["title"])})),128))]})),_:1})})),Gt=(n("99af"),n("4de4"),n("c740"),n("c975"),n("a434"),Object(r["F"])("data-v-7d67a652")),Yt=Gt((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("div",{class:{part:!0,active:!1},style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("click")})},null,4)})),Kt=(n("a9e3"),n("5319"),960),Xt=Object(r["m"])({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:function(){return{lookups:[],loaded:!1}},computed:{scaleX:function(){return this.size/this.part.size[0]},scaleY:function(){return this.size/this.part.size[1]},backgroundSize:function(){return"".concat(Math.floor(Kt*this.scaleX),"px ").concat(Math.floor(Kt*this.scaleY),"px")},backgroundPosition:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")},style:function(){var t=this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")}));return{backgroundImage:t.join(","),height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.part.images.map((function(t){return"string"===typeof t.asset?Object(bt["b"])(t.asset,!1):Object(bt["a"])(t.asset,!1)})));case 2:t.lookups=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("ddde");Xt.render=Yt,Xt.__scopeId="data-v-7d67a652";var Jt=Xt,Qt=n("ade3"),Zt=n("5530"),te=Object(r["m"])({mixins:[z["a"]],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection:function(){return"global"===this.direction?this.$store.state.ui.vertical?"vertical":"horizontal":"inverted"===this.direction?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render:function(){var t=this.noWraping?"no-wraping":"wraping",e={},n=Object(r["n"])("div",Object(Zt["a"])(Object(Zt["a"])({},e),{},{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize){var a=this.maxSize instanceof Array?this.maxSize["horizontal"===this.finalDirection?0:1]:this.maxSize;return Object(r["n"])("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:Object(Qt["a"])({},"horizontal"===this.finalDirection?"maxWidth":"maxHeight",a)},[n])}return n},mounted:function(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});n("9e3d");te.__scopeId="data-v-64adfc9c";var ee=te,ne=Object(r["m"])({components:{PartButton:Jt,DFieldset:Vt["a"],DFlow:ee},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:function(){return{isWebPSupported:null,stylePriorities:[]}},computed:{vertical:function(){return this.$store.state.ui.vertical},styleComponents:function(){if("style"!==this.part)return[];var t=this.charData.styleGroups[this.character.styleGroupId];return t.styleComponents.map((function(e){var n={};for(var r in e.variants)if(e.variants.hasOwnProperty(r)){var a=e.variants[r];n[r]={size:t.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:a}]}}return{label:e.label,name:e.id,buttons:n}}))},parts:function(){var t,e,n,r={},a=this.charData,o=Object(Ht["h"])(a,this.character);switch(this.part){case"head":for(var i=0;i<o.compatibleHeads.length;++i)for(var c=o.compatibleHeads[i],s=a.heads[c],u=0;u<s.variants.length;++u){var l=s.variants[u];r["".concat(i,"_").concat(u)]={size:s.previewSize,offset:s.previewOffset,images:l.map((function(t){return{asset:t,offset:[0,0]}}))}}return r;case"pose":for(var d=a.styleGroups[this.character.styleGroupId].styles[this.character.styleId],p=0;p<d.poses.length;++p){var h=d.poses[p];r[p]=this.generatePosePreview(h)}return r;case"style":var b,f=Object(ht["a"])(a.styleGroups);try{for(f.s();!(b=f.n()).done;){var v=b.value;r[v.id]=this.generatePosePreview(v.styles[0].poses[0])}}catch(g){f.e(g)}finally{f.f()}return r;default:t=o.positions[this.part],n=o.previewSize,e=o.previewOffset;break}for(var m=0;m<t.length;++m){var j=t[m];r[m]={images:j.map((function(t){return{offset:[0,0],asset:t}})),size:n,offset:e}}return r},charData:function(){return Object(Ht["e"])(this.$store,this.character)}},methods:{updateStyleData:function(){var t=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(t.components).map((function(e){return[e,t.components[e]]}))},generatePosePreview:function(t){var e,n=this.charData,r=n.heads[t.compatibleHeads[0]],a=r?r.variants[0]:null,o=[],i=Object(ht["a"])(t.renderCommands);try{for(i.s();!(e=i.n()).done;){var c=e.value;switch(c.type){case"pose-part":var s=t.positions[c.part];if(!s||0===s.length)break;o=o.concat(s[0]);break;case"head":a&&(o=o.concat(a));break;case"image":o=o.concat(c.images);break}}}catch(u){i.e(u)}finally{i.f()}return{images:o.map((function(t){return{asset:t,offset:[0,0]}})),size:t.previewSize,offset:t.previewOffset}},updatePose:function(t){var e=this;void 0===t&&(t=this.character.styleGroupId);var n,r=this.charData,a=r.styleGroups[t],o=a.styles,i=Object(ht["a"])(this.stylePriorities);try{var c=function(){var t=n.value,e=o.filter((function(e){return e.components[t[0]]===t[1]}));e.length>0&&(o=e)};for(i.s();!(n=i.n()).done;)c()}catch(s){i.e(s)}finally{i.f()}this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setCharStyle",{id:e.character.id,styleGroupId:t,styleId:a.styles.indexOf(o[0])})}))},choose:function(t){if("style"===this.part)this.updatePose(this.charData.styleGroups.findIndex((function(e){return e.id===t})));else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(l["a"])(e,2),r=n[0],a=n[1];this.$store.commit("objects/setPosePosition",{id:this.character.id,posePositions:{headType:r,head:a}})}else this.setPart(this.part,parseInt(t,10))},choose_component:function(t,e){var n=this.stylePriorities.findIndex((function(e){return e[0]===t}));this.stylePriorities.splice(n,1),this.stylePriorities.unshift([t,e]),this.updatePose()},setPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateStyleData(),e.next=3,Object(bt["e"])();case 3:t.isWebPSupported=e.sent;case 4:case"end":return e.stop()}}),e)})))()},watch:{character:function(){this.updateStyleData()}}});n("1c59");ne.render=qt,ne.__scopeId="data-v-47f2e1e8";var re=ne;function ae(){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object[t]},set:function(r){var a=this;this.vuexHistory.transaction((function(){a.$store[n?"dispatch":"commit"](e,Object(Qt["a"])({id:a.object.id},t,r))}))}}}}var oe=Object(r["F"])("data-v-b5267b6a");Object(r["r"])("data-v-b5267b6a");var ie={class:"panel"},ce=Object(r["k"])("span",{class:"icon material-icons"},"edit",-1),se=Object(r["k"])("p",{class:"modal-text"}," Enter the new name ",-1),ue={class:"modal-text"},le={class:"roation-besides"},de=Object(r["k"])("label",{for:"rotation"},"Rotation: ",-1),pe={key:0},he=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),be=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"namebox_width"},"Namebox width:")],-1);Object(r["q"])();var fe=oe((function(t,e,n,a,o,i){var c=Object(r["w"])("modal-dialog"),s=Object(r["w"])("text-editor"),u=Object(r["w"])("color"),l=Object(r["w"])("image-options"),d=Object(r["w"])("position-and-size"),p=Object(r["w"])("layers"),h=Object(r["w"])("toggle"),b=Object(r["w"])("d-fieldset"),f=Object(r["w"])("delete");return Object(r["p"])(),Object(r["g"])("div",ie,[Object(r["k"])("h1",{style:{fontStyle:this.hasLabel?"italic":"normal"},onClick:e[1]||(e[1]=function(){return t.enableNameEdit.apply(t,arguments)})},[Object(r["j"])(Object(r["x"])(t.heading)+" ",1),ce]),(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.showRename?Object(r["k"])(c,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:t.renameOption,onLeave:e[3]||(e[3]=function(e){return t.renameOption("Cancel")})},{default:oe((function(){return[se,Object(r["k"])("p",ue,[Object(r["D"])(Object(r["k"])("input",{"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.modalNameInput=e}),style:{width:"100%"}},null,512),[[r["A"],t.modalNameInput]])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0)])),t.textHandler?Object(r["k"])(s,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.textHandler.set(e)}),onLeave:e[5]||(e[5]=function(e){return t.textHandler.leave()})},null,8,["title","modelValue"]):t.finalColorHandler?Object(r["k"])(u,{key:1,title:t.finalColorHandler.title,modelValue:t.finalColorHandler.get(),"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.finalColorHandler.set(e)}),onLeave:e[7]||(e[7]=function(e){return t.finalColorHandler.leave()})},null,8,["title","modelValue"]):t.imageOptionsOpen?Object(r["k"])(l,{key:2,type:"object",id:t.object.id,onLeave:e[8]||(e[8]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):t.showAltPanel?Object(r["v"])(t.$slots,"alt-panel",{key:3}):(Object(r["p"])(),Object(r["g"])(r["a"],{key:4},[Object(r["v"])(t.$slots,"default"),Object(r["k"])(d,{obj:t.object},null,8,["obj"]),Object(r["k"])(p,{object:t.object},null,8,["object"]),Object(r["k"])(h,{modelValue:t.flip,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["k"])("div",le,[de,Object(r["D"])(Object(r["k"])("input",{id:"rotation",type:"number","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.rotation=e}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.rotation]])]),Object(r["v"])(t.$slots,"options"),t.hasLabel?Object(r["k"])(b,{key:0,title:"Textbox settings"},{default:oe((function(){return["character"===t.object.type||"sprite"===t.object.type?Object(r["k"])(h,{key:0,label:"Enlarge when talking",modelValue:t.enlargeWhenTalking,"onUpdate:modelValue":e[12]||(e[12]=function(e){return t.enlargeWhenTalking=e})},null,8,["modelValue"]):Object(r["h"])("",!0),Object(r["k"])(h,{label:"Use custom textbox color",modelValue:t.useCustomTextboxColor,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.useCustomTextboxColor=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[t.useCustomTextboxColor?(Object(r["p"])(),Object(r["g"])("tr",pe,[he,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.textboxColor},onClick:e[14]||(e[14]=function(){return t.selectTextboxColor.apply(t,arguments)})},null,4)])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[be,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"namebox_width",type:"number",placeholder:t.defaultNameboxWidth,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.nameboxWidth=e})},null,8,["placeholder"]),[[r["A"],t.nameboxWidth,void 0,{lazy:!0}]])])])])]})),_:1}):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[16]||(e[16]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["k"])("button",{onClick:e[17]||(e[17]=function(){return t.copy.apply(t,arguments)})},"Copy"),Object(r["k"])(f,{obj:t.object},null,8,["obj"])],64))])})),ve=(n("498a"),Object(r["F"])("data-v-7f101752"));Object(r["r"])("data-v-7f101752");var me={colspan:"2"},je={key:0},ge={colspan:"2"},Oe={class:"arrow-col"},ke={class:"arrow-col"},ye=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_x"},"X:")],-1),we=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_y"},"Y:")],-1),xe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_w"},"Width:")],-1),Ce=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_h"},"Height:")],-1),Se={colspan:"2"};Object(r["q"])();var Re=ve((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{title:"Position"+(t.allowSize?"/Size":"")},{default:ve((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",me,[t.allowStepMove?Object(r["k"])(c,{key:0,modelValue:t.freeMove,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.freeMove=e}),label:"Move freely?"},null,8,["modelValue"]):Object(r["h"])("",!0)])]),t.allowStepMove&&!t.freeMove?(Object(r["p"])(),Object(r["g"])("tr",je,[Object(r["k"])("td",ge,[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",Oe,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return--t.pos}),disabled:t.isFirstPos},"<",8,["disabled"])]),Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.pos=e})},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.positionNames,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t),9,["value"])})),128))],512),[[r["z"],t.pos,void 0,{number:!0}]])]),Object(r["k"])("td",ke,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return++t.pos}),disabled:t.isLastPos},">",8,["disabled"])])])])])])):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[ye,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_x",type:"number","onUpdate:modelValue":e[5]||(e[5]=function(e){return t.x=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.x,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[we,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_y",type:"number","onUpdate:modelValue":e[7]||(e[7]=function(e){return t.y=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.y,void 0,{number:!0}]])])])],64)),t.allowSize?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[xe,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":e[9]||(e[9]=function(e){return t.width=e}),onKeydown:e[10]||(e[10]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.width,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Ce,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":e[11]||(e[11]=function(e){return t.height=e}),onKeydown:e[12]||(e[12]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.height,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Se,[Object(r["k"])(c,{modelValue:t.preserveRatio,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.preserveRatio=e}),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):Object(r["h"])("",!0)])]})),_:1},8,["title"])})),Pe=n("fec4"),Ie=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},props:{obj:{required:!0}},computed:{freeMove:{get:function(){return this.obj.freeMove},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},preserveRatio:{get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}},pos:{get:function(){return Object(Ht["c"])(this.obj.x)},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:Pe["a"][t],y:e.obj.y})}))}},x:{get:function(){return this.obj.x},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},y:{get:function(){return this.obj.y},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},height:{get:function(){return this.obj.height},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},width:{get:function(){return this.obj.width},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},allowSize:function(){var t=this.obj;return("textBox"!==t.type||"custom"===t.style)&&!("character"===t.type&&!t.freeMove)},allowStepMove:function(){return"freeMove"in this.obj},positionNames:function(){return Pe["b"]},isFirstPos:function(){return 0===this.pos},isLastPos:function(){return this.pos===Pe["b"].length-1}}});n("3742");Ie.render=Re,Ie.__scopeId="data-v-7f101752";var Te=Ie,Ae=Object(r["F"])("data-v-90b83fd8");Object(r["r"])("data-v-90b83fd8");var _e=Object(r["k"])("i",{class:"material-icons"},"vertical_align_bottom",-1),De=Object(r["k"])("i",{class:"material-icons"},"arrow_downward",-1),$e=Object(r["k"])("i",{class:"material-icons"},"arrow_upward",-1),He=Object(r["k"])("i",{class:"material-icons"},"vertical_align_top",-1);Object(r["q"])();var Ve=Ae((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{id:"layerfs",title:"Layer:"},{default:Ae((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.shiftLayer(-1/0)}),title:"Move to back"},[_e])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.shiftLayer(-1)}),title:"Move backwards"},[De])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.shiftLayer(1)}),title:"Move forwards"},[$e])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.shiftLayer(1/0)}),title:"Move to front"},[He])])])])]),Object(r["k"])(c,{modelValue:t.onTop,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.onTop=e}),label:"In front?"},null,8,["modelValue"])]})),_:1})})),Be=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},props:{object:{required:!0}},computed:{onTop:ae()("onTop","objects/setOnTop",!0)},methods:{shiftLayer:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.object.id,delta:t})}))}}});n("71ca");Be.render=Ve,Be.__scopeId="data-v-90b83fd8";var Ee=Be;function Fe(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("button",{onClick:e[1]||(e[1]=function(){return t.onClick.apply(t,arguments)})},"Delete")}var Le=Object(r["m"])({props:{obj:{required:!0}},methods:{onClick:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}}});Le.render=Fe;var Me=Le,Ne=(n("b680"),Object(r["F"])("data-v-60fb61c1"));Object(r["r"])("data-v-60fb61c1");var We=Object(r["k"])("h2",null,"Image options",-1),Ue={class:"column ok-col"},ze={key:0,class:"column"},qe=Object(r["k"])("label",{for:"compositionSelect"},"Compositing Mode:",-1),Ge=Object(r["j"])("[?]"),Ye=Object(r["i"])('<option value="source-over" data-v-60fb61c1>source-over</option><option value="source-atop" data-v-60fb61c1>source-atop</option><option value="destination-over" data-v-60fb61c1>destination-over</option><option value="destination-in" data-v-60fb61c1>destination-in</option><option value="destination-in" data-v-60fb61c1>destination-out</option><option value="destination-in" data-v-60fb61c1>destination-atop</option><option value="lighter" data-v-60fb61c1>lighter</option><option value="xor" data-v-60fb61c1>xor</option><option value="multiply" data-v-60fb61c1>multiply</option><option value="screen" data-v-60fb61c1>screen</option><option value="overlay" data-v-60fb61c1>overlay</option><option value="darken" data-v-60fb61c1>darken</option><option value="lighten" data-v-60fb61c1>lighten</option><option value="color-dodge" data-v-60fb61c1>color-dodge</option><option value="color-burn" data-v-60fb61c1>color-burn</option><option value="hard-light" data-v-60fb61c1>hard-light</option><option value="soft-light" data-v-60fb61c1>soft-light</option><option value="difference" data-v-60fb61c1>difference</option><option value="exclusion" data-v-60fb61c1>exclusion</option><option value="hue" data-v-60fb61c1>hue</option><option value="saturation" data-v-60fb61c1>saturation</option><option value="color" data-v-60fb61c1>color</option><option value="luminosity" data-v-60fb61c1>luminosity</option>',23),Ke=Object(r["k"])("label",{for:"addEffect"},"Add new effect",-1),Xe={key:0,class:"value-input-table"},Je=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"shadow_color"},"Color:")],-1),Qe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_x"},"X:")],-1),Ze=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_y"},"Y:")],-1),tn=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_blur"},"Blur:")],-1),en=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),nn=Object(r["j"])("% "),rn={key:0},an={colspan:"2"},on=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),cn={key:0},sn={colspan:"2"};Object(r["q"])();var un=Ne((function(t,e,n,a,o,i){var c=Object(r["w"])("color"),s=Object(r["w"])("l"),u=Object(r["w"])("d-flow"),l=Object(r["w"])("slider"),d=Object(r["w"])("d-fieldset");return t.showShadowColor?Object(r["k"])(c,{key:0,modelValue:t.shadowColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.shadowColor=e}),format:"rgb",onLeave:e[2]||(e[2]=function(e){return t.showShadowColor=!1})},null,8,["modelValue"]):Object(r["k"])(u,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:Ne((function(){return[We,Object(r["k"])("div",Ue,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.$emit("leave")})},"Back")]),t.noComposition?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("div",ze,[qe,Object(r["k"])(s,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:Ne((function(){return[Ge]})),_:1}),Object(r["D"])(Object(r["k"])("select",{id:"compositionSelect","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.compositionMode=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},[Ye],544),[[r["z"],t.compositionMode]])])),Object(r["k"])(d,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:Ne((function(){return[Object(r["k"])(u,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:Ne((function(){return[Object(r["k"])(u,{direction:"vertical","no-wraping":""},{default:Ne((function(){return[Ke,Object(r["D"])(Object(r["k"])("select",{id:"addEffect","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.addEffectSelection=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filterTypes,(function(e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t.getFilterLabel(e)),9,["value"])})),128))],544),[[r["z"],t.addEffectSelection]]),Object(r["k"])("button",{disabled:""===t.addEffectSelection,onClick:e[8]||(e[8]=function(){return t.addFilter.apply(t,arguments)}),onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))}," Add ",40,["disabled"]),Object(r["k"])("button",{disabled:!t.currentFilter,onClick:e[10]||(e[10]=function(){return t.removeFilter.apply(t,arguments)}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))}," Remove ",40,["disabled"]),Object(r["k"])("button",{disabled:0===t.currentFilterIdx,onClick:e[12]||(e[12]=function(e){return t.moveFilter(-1)}),onKeydown:e[13]||(e[13]=Object(r["E"])((function(){}),["stop"]))}," Move up ",40,["disabled"]),Object(r["k"])("button",{disabled:t.currentFilterIdx===t.filters.length-1||0===t.filters.length,onClick:e[14]||(e[14]=function(e){return t.moveFilter(1)}),onKeydown:e[15]||(e[15]=Object(r["E"])((function(){}),["stop"]))}," Move down ",40,["disabled"])]})),_:1}),Object(r["k"])(u,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:Ne((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filters,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:n,class:{choiceBtn:!0,active:n===t.currentFilterIdx},onClick:function(e){return t.selectFilter(n)}},Object(r["x"])(t.getFilterText(e)),11,["onClick"])})),128))]})),_:1}),t.currentFilter?(Object(r["p"])(),Object(r["g"])("table",Xe,["drop-shadow"===t.currentFilter.type?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["k"])("tr",null,[Je,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"shadow_color",class:"color-button",style:{background:t.shadowColor},onClick:e[16]||(e[16]=function(e){return t.showShadowColor=!0})},"  ",4)])]),Object(r["k"])("tr",null,[Qe,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_x",type:"number","onUpdate:modelValue":e[17]||(e[17]=function(e){return t.shadowX=e}),onKeydown:e[18]||(e[18]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowX,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Ze,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_y",type:"number","onUpdate:modelValue":e[19]||(e[19]=function(e){return t.shadowY=e}),onKeydown:e[20]||(e[20]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowY,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[tn,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_blur",type:"number","onUpdate:modelValue":e[21]||(e[21]=function(e){return t.shadowBlur=e}),onKeydown:e[22]||(e[22]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowBlur,void 0,{number:!0}]])])])],64)):t.isPercentFilter?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[en,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:(100*t.currentFilter.value).toFixed(),type:"number",max:t.maxValue,min:t.minValue,onInput:e[23]||(e[23]=function(e){return t.setValue({value:Number(e.target.value/100)})}),onKeydown:e[24]||(e[24]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"]),nn])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",rn,[Object(r["k"])("td",an,[Object(r["k"])(l,{gradientStops:["#000000","#ffffff"],label:"",maxValue:t.maxValue,modelValue:100*t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[25]||(e[25]=function(e){return t.setValue({value:Math.round(e)/100})})},null,8,["maxValue","modelValue"])])])):Object(r["h"])("",!0)],64)):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[on,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:t.currentFilter.value,type:"number",max:t.maxValue,min:t.minValue,onInput:e[26]||(e[26]=function(e){return t.setValue({value:Number(e.target.value)})}),onKeydown:e[27]||(e[27]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"])])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",cn,[Object(r["k"])("td",sn,[Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[28]||(e[28]=function(e){return t.setValue({value:Math.round(e)})})},null,8,["gradientStops","maxValue","modelValue"]),Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):Object(r["h"])("",!0)],64))])):Object(r["h"])("",!0)]})),_:1})]})),_:1})]})),_:1})})),ln=(n("4ec9"),Object(r["F"])("data-v-f14035dc")),dn=ln((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("div",{class:{slider:!0,vertical:t.vertical},onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))},[t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("label",{key:0,for:t._.uid},Object(r["x"])(t.label),9,["for"])),Object(r["k"])("div",null,[(Object(r["p"])(),Object(r["g"])("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:e[1]||(e[1]=function(){return t.enterSlide.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.enterSlide.apply(t,arguments)}),onMousemove:e[3]||(e[3]=function(){return t.moveSlide.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.moveSlide.apply(t,arguments)}),onMouseup:e[5]||(e[5]=function(){return t.exitSlide.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.exitSlide.apply(t,arguments)})},[Object(r["k"])("defs",null,[Object(r["k"])("linearGradient",{id:"gradient".concat(t._.uid),x1:100*t.gradientOffset+"%",y1:"0%",x2:100*(t.gradientOffset+1)+"%",y2:"0%",spreadMethod:"repeat"},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.gradientStops,(function(e,n){return Object(r["p"])(),Object(r["g"])("stop",{key:n,offset:n/(t.gradientStops.length-1)*100+"%",style:"stop-color:"+e},null,12,["offset"])})),128))],8,["id","x1","x2"])]),Object(r["k"])("g",null,[Object(r["k"])("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:"url(#gradient".concat(t._.uid,")")},null,8,["fill"]),Object(r["k"])("path",{d:t.pointerPath,"stroke-width":"2",class:"slider-pointer"},null,8,["d"])])],544))]),t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("input",{key:1,id:t._.uid,class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:e[7]||(e[7]=function(e){return t.$emit("update:modelValue",parseFloat(e.target.value))}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","max","value"]))],34)})),pn=255,hn=8,bn=Object(r["m"])({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},data:function(){return{slideActive:!1}},computed:{vertical:function(){return this.$store.state.ui.vertical},pointerPath:function(){var t=this.modelValue/this.maxValue*pn;return"M".concat(t," 0L").concat(t+14," 0L").concat(t+7," 12Z")},gradientOffset:function(){return this.shiftGradient?0===this.modelValue?0:this.modelValue/this.maxValue:0}},methods:{enterSlide:function(t){this.slideActive=!0,this.moveSlide(t)},moveSlide:function(t){if(this.slideActive){var e=this.$refs.svg;if(e.contains(t.target)||t.target===e)if(t instanceof MouseEvent&&1!==t.which)this.slideActive=!1;else{var n=e.getBoundingClientRect(),r=n.width/(hn+pn+hn),a=(t instanceof MouseEvent?t.clientX:t.touches[0].clientX)-n.x,o=a/r;t.preventDefault();var i=Math.max(Math.min(o-hn,pn),0)/pn*this.maxValue;this.$emit("update:modelValue",i)}}},exitSlide:function(){this.slideActive=!1}}});n("ae6d");bn.render=dn,bn.__scopeId="data-v-f14035dc";var fn=bn,vn=Object(r["F"])("data-v-3da2fed6");Object(r["r"])("data-v-3da2fed6");var mn={class:"column"},jn={class:"hex-selector"};Object(r["q"])();var gn=vn((function(t,e,n,a,o,i){var c=Object(r["w"])("slider-group");return Object(r["p"])(),Object(r["g"])("div",{class:{color:!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"OK"),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.mode="hsla"})},"HSLA")]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.mode="rgba"})},"RGBA")])])]),Object(r["k"])("div",mn,[Object(r["k"])(c,{mode:t.mode,modelValue:t.color,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.color=e}),relative:!0},null,8,["mode","modelValue"]),Object(r["k"])("div",jn,[Object(r["k"])("label",{class:"hex-label",for:"hex_".concat(t._.uid)},"Hex",8,["for"]),Object(r["k"])("input",{id:"hex_".concat(t._.uid),value:t.color,onInput:e[5]||(e[5]=function(){return t.updateHex.apply(t,arguments)}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","value"])]),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(){return t.addSwatch.apply(t,arguments)})},"Add as swatch")]),Object(r["k"])("div",{id:"color-swatches",class:{vertical:t.vertical}},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.swatches,(function(e){return Object(r["p"])(),Object(r["g"])("button",{class:"swatch",key:e.color,style:{backgroundColor:e.color},title:e.label,onClick:function(n){t.color=e.color,t.$emit("leave")}},null,12,["title","onClick"])})),128))],2)],2)})),On=n("2909"),kn=Object(r["F"])("data-v-24b7dbc3"),yn=kn((function(t,e,n,a,o,i){var c=Object(r["w"])("slider");return Object(r["p"])(),Object(r["g"])("div",null,[Object(r["k"])(c,{label:t.label1,modelValue:t.v1,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.v1=e}),"max-value":t.maxValue1,"gradient-stops":t.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label2,modelValue:t.v2,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.v2=e}),"max-value":t.maxValue2,"gradient-stops":t.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label3,modelValue:t.v3,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.v3=e}),"max-value":t.maxValue3,"gradient-stops":t.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:"Alpha",modelValue:t.a,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.a=e}),"max-value":255,"gradient-stops":t.stopsAlpha},null,8,["modelValue","gradient-stops"])])})),wn=(n("25f0"),n("4d90"),n("d4ec")),xn=n("bee2"),Cn=(n("dca8"),function(){function t(e,n,r,a){Object(wn["a"])(this,t),this.h=e,this.s=n,this.l=r,this.a=a,Object.freeze(this)}return Object(xn["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,a=this.l,o=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1?r-=e.s:(r+=e.s,r<0&&(r=0)),a+e.l>1||a+e.l<0?a-=e.l:a+=e.l,o+e.a>1||o+e.a<0?o-=e.a:o+=e.a,new t(n,r,a,o)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,a=this.s,o=this.l,i=this.a;if(0===a)t=e=n=o;else{var c=o<.5?o*(1+a):o+a-o*a,s=2*o-c;t=this.hue2rgb(s,c,r+1/3),e=this.hue2rgb(s,c,r),n=this.hue2rgb(s,c,r-1/3)}return new Sn(Math.round(255*t),Math.round(255*e),Math.round(255*n),i)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}()),Sn=function(){function t(e,n,r,a){Object(wn["a"])(this,t),this.r=e,this.g=n,this.b=r,this.a=a}return Object(xn["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toHex",value:function(){return"#".concat(Math.round(this.r).toString(16).padStart(2,"0")).concat(Math.round(this.g).toString(16).padStart(2,"0")).concat(Math.round(this.b).toString(16).padStart(2,"0")).concat(Math.round(255*this.a).toString(16).padStart(2,"0"))}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var a,o,i=Math.max(t,e,n),c=Math.min(t,e,n),s=(i+c)/2;if(i===c)a=o=0;else{var u=i-c;switch(o=s>.5?u/(2-i-c):u/(i+c),i){case t:a=(e-n)/u+(e<n?6:0);break;case e:a=(n-t)/u+2;break;case n:a=(t-e)/u+4;break}a/=6}return new Cn(a,o,s,r)}},{key:"luminance",get:function(){return Math.sqrt(Math.pow(this.r/255*.299,2)+Math.pow(this.g/255*.587,2)+Math.pow(this.b/255*.114,2))}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),a=n.slice(r+1),o=a.split(",").map((function(t){return parseFloat(t.trim())}));return new t(o[0],o[1],o[2],4===o.length?o[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();Sn.rgbEx=/^rgb\((\d*?),(\d*?),(\d*?)\)$/i,Sn.rgbaEx=/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i,Sn.hexShortEx=/^#[0-9A-Z]{3,4}$/i,Sn.hexLongEx=/^#[0-9A-Z]{6,8}$/i;var Rn=Object(r["m"])({components:{Slider:fn},props:{modelValue:{type:String,validator:function(t){return!!t.match(/^#[0-9a-f]{6,8}$/i)}},mode:{type:String},relative:Boolean},data:function(){return{lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}},computed:{vertical:function(){return this.$store.state.ui.vertical},maxValue1:function(){return"rgba"===this.mode?255:360},label1:function(){return"rgba"===this.mode?"Red":"Hue"},stops1:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v2:0,n=this.relative?this.v3:0;t=[new Sn(0,e,n,1),new Sn(255,e,n,1)]}else{var r=this.relative?this.v2/100:1,a=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Cn(t,r,a,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue2:function(){return"rgba"===this.mode?255:100},label2:function(){return"rgba"===this.mode?"Green":"Saturation"},stops2:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v3:0;t=[new Sn(e,0,n,1),new Sn(e,255,n,1)]}else{var r=this.relative?this.v1/360:0,a=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Cn(r,t,a,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue3:function(){return"rgba"===this.mode?255:100},label3:function(){return"rgba"===this.mode?"Blue":"Luminosity"},stops3:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v2:0;t=[new Sn(e,n,0,1),new Sn(e,n,255,1)]}else{var r=this.relative?this.v1/360:0,a=this.relative?this.v2/100:.5;t=this.eightsStops((function(t){return new Cn(r,a,t,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},stopsAlpha:function(){var t=Sn.fromHex(this.modelValue);return[new Sn(t.r,t.g,t.b,0).toCss(),new Sn(t.r,t.g,t.b,1).toCss()]}},created:function(){this.initValues()},methods:{valueChanged:function(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue:function(){var t;t="rgba"===this.mode?new Sn(this.v1,this.v2,this.v3,this.a/255):new Cn(this.v1/360,this.v2/100,this.v3/100,this.a/255);var e=t.toRgb().toHex();if(this.lastRGBEmit!==e){if(9!==e.length)throw new Error("Invalid color code: ".concat(e));this.lastRGBEmit=e,this.$emit("update:modelValue",e)}},initValues:function(){var t=Sn.fromHex(this.modelValue);if(this.lastRGBEmit=t.toHex(),this.a=255*t.a,"hsla"===this.mode){var e=t.toHSL();this.v1=360*e.h,this.v2=100*e.s,this.v3=100*e.l}else this.v1=t.r,this.v2=t.g,this.v3=t.b},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}},watch:{value:function(){this.valueChanged()},v1:function(){this.updateValue()},v2:function(){this.updateValue()},v3:function(){this.updateValue()},a:function(){this.updateValue()},mode:function(){this.initValues()}}});n("02e0");Rn.render=yn,Rn.__scopeId="data-v-24b7dbc3";var Pn=Rn,In="dddg.generated.colors",Tn=Object(r["m"])({components:{SliderGroup:Pn},inheritAttrs:!1,emits:["leave","update:modelValue"],props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:function(){return{mode:"hsla",relative:!0}},computed:{vertical:function(){return this.$store.state.ui.vertical},swatches:function(){return this.$store.state.content.current.colors},color:{get:function(){if("rgb"===this.format){var t=Sn.fromCss(this.modelValue);return t.toHex()}return this.modelValue},set:function(t){if("rgb"===this.format){var e=Sn.fromCss(t);this.$emit("update:modelValue",e.toCss())}else this.$emit("update:modelValue",t)}}},methods:{updateHex:function(t){var e=t.target.value;!Sn.validHex(e)||7!==e.length&&9!==e.length||(this.color=e)},addSwatch:function(){var t=this;if(!this.swatches.find((function(e){return e.color===t.color}))){var e=this.$store.state.content.contentPacks.find((function(t){return"generatedPackId"===t.packId}))||{packId:In,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},n=Object(Zt["a"])(Object(Zt["a"])({},e),{},{colors:[].concat(Object(On["a"])(e.colors),[{label:this.color,color:this.color}])});this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!0})}))}}}});n("0741");Tn.render=gn,Tn.__scopeId="data-v-3da2fed6";var An=Tn;function _n(t){throw new Error('Unexpected value "'.concat(t,'"'))}var Dn=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function $n(t,e,n){var r,a=e(t.id),o=Object(On["a"])(a.filters);switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:_n(t.type)}o.splice(t.idx,0,r),n({id:t.id,filters:o})}function Hn(t,e,n){var r=e(t.id),a=Object(On["a"])(r.filters);a.splice(t.idx,1),n({id:t.id,filters:a})}function Vn(t,e,n){var r=e(t.id),a=Object(On["a"])(r.filters),o=a[t.idx];a.splice(t.idx,1),a.splice(t.idx+t.moveBy,0,o),n({id:t.id,filters:a})}function Bn(t,e,n){var r=e(t.id),a=Object(On["a"])(r.filters),o=Object(Zt["a"])({},a[t.idx]);a[t.idx]=o,"drop-shadow"===o.type?(void 0!==t.blurRadius&&(o.blurRadius=t.blurRadius),void 0!==t.color&&(o.color=t.color),void 0!==t.offsetX&&(o.offsetX=t.offsetX),void 0!==t.offsetY&&(o.offsetY=t.offsetY)):o.value=t.value,n({id:t.id,filters:a})}var En=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),Fn=Array.from(En.keys()).sort(),Ln=Object(r["m"])({components:{DFlow:ee,DFieldset:Vt["a"],Color:An,Slider:fn,L:Z["a"]},props:{type:{type:String,required:!0},title:{type:String},id:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],data:function(){return{addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}},computed:{object:function(){switch(this.type){case"object":return this.$store.state.objects.objects[this.id];case"background":return this.$store.state.panels.panels[this.id].background;case"panel":return this.$store.state.panels.panels[this.id];default:return _n(this.type),null}},compositionMode:{get:function(){return this.object.composite},set:function(t){var e=this;this.vuexHistory.transaction((function(){switch(e.type){case"object":e.$store.commit("objects/setComposition",{id:e.id,composite:t});break;case"background":break;case"panel":break;default:_n(e.type);break}}))}},filters:function(){return this.object.filters},filterTypes:function(){try{var t=document.createElement("canvas"),e=t.getContext("2d");if("filter"in e)return Fn}catch(n){}return["opacity"]},currentFilter:function(){return this.filters[this.currentFilterIdx]||null},isPercentFilter:function(){var t=this.currentFilter;return!!t&&Dn.has(t.type)},maxValue:function(){var t=this.currentFilter;if(t)return"hue-rotate"===t.type?360:"grayscale"===t.type||"sepia"===t.type||"opacity"===t.type||"invert"===t.type?100:void 0},minValue:function(){var t=this.currentFilter;if(t)switch(t.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get:function(){var t=this.currentFilter;if(t&&"color"in t)return t.color},set:function(t){this.setValue({color:t})}},shadowX:{get:function(){var t=this.currentFilter;if(t&&"offsetX"in t)return t.offsetX},set:function(t){this.setValue({offsetX:t})}},shadowY:{get:function(){var t=this.currentFilter;if(t&&"offsetY"in t)return t.offsetY},set:function(t){this.setValue({offsetY:t})}},shadowBlur:{get:function(){var t=this.currentFilter;if(t&&"blurRadius"in t)return t.blurRadius},set:function(t){this.setValue({blurRadius:t})}},hueStops:function(){var t=this.eightsStops((function(t){return new Cn(t,1,.5,1)}));return t.map((function(t){return t.toRgb().toCss()}))}},methods:{getFilterLabel:function(t){return En.get(t)},getFilterText:function(t){return Dn.has(t.type)?"".concat(En.get(t.type)," ").concat((100*t.value).toFixed(),"%"):"hue-rotate"===t.type?"".concat(En.get(t.type)," ").concat(t.value.toFixed(),""):"blur"===t.type?"".concat(En.get(t.type)," ").concat(t.value.toFixed(),"px"):En.get(t.type)},objectTypeScope:function(t){switch(this.type){case"object":return"objects/"+t;case"background":return"panels/background"+t[0].toUpperCase()+t.slice(1);case"panel":return"panels/"+t}},addFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("addFilter"),{id:t.id,type:t.addEffectSelection,idx:t.currentFilterIdx+1})}))},selectFilter:function(t){this.currentFilterIdx=t},removeFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("removeFilter"),{id:t.id,idx:t.currentFilterIdx})}))},moveFilter:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("moveFilter"),{id:e.id,idx:e.currentFilterIdx,moveBy:t}),e.currentFilterIdx+=t}))},setValue:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("setFilter"),Object(Zt["a"])({id:e.id,idx:e.currentFilterIdx},t))}))},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}}});n("7894");Ln.render=un,Ln.__scopeId="data-v-60fb61c1";var Mn=Ln,Nn=Object(r["F"])("data-v-e81e39ea");Object(r["r"])("data-v-e81e39ea");var Wn={class:"column ok-col"},Un={class:"column"},zn={key:0,class:"column error-col"},qn={class:"column"},Gn=Object(r["k"])("p",{class:"hint-col"},"Apply style to selected text:",-1),Yn={class:"column"},Kn={class:"column"},Xn={class:"column"},Jn=Object(r["i"])('<option value data-v-e81e39ea>Font</option><option value="aller" style="font-family:aller;" data-v-e81e39ea>Aller (Textbox)</option><option value="riffic" style="font-family:riffic;" data-v-e81e39ea>Riffic (Bold text)</option><option value="hashtag" style="font-family:hashtag;" data-v-e81e39ea>Hashtag (Sayori)</option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-e81e39ea>Ammy&#39;s Handwriting (Natsuki)</option><option value="journal" style="font-family:journal;" data-v-e81e39ea>Journal (Monika)</option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-e81e39ea>JP Hand Slanted (Yuri)</option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-e81e39ea>Damagrafik (Yuri, Act 2)</option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-e81e39ea>As I Lay Dying (Yuri, Act Unused)</option><option value="halogen" style="font-family:halogen;" data-v-e81e39ea>Halogen (MC)</option>',10);Object(r["q"])();var Qn=Nn((function(t,e,n,a,o,i){var c=Object(r["w"])("color");return t.colorSelector?Object(r["k"])(c,{key:0,modelValue:t.selectedColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.selectedColor=e}),onLeave:t.applyColor},null,8,["modelValue","onLeave"]):(Object(r["p"])(),Object(r["g"])("div",{key:1,class:{"text-subpanel":!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("div",Wn,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},"OK")]),Object(r["k"])("div",Un,[Object(r["k"])("textarea",{ref:"textArea",value:t.modelValue,onInput:e[3]||(e[3]=function(){return t.onValueChanged.apply(t,arguments)}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"])),onKeypress:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,40,["value"])]),t.error?(Object(r["p"])(),Object(r["g"])("div",zn,Object(r["x"])(t.error),1)):Object(r["h"])("",!0),Object(r["k"])("div",qn,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.insertText("\\\\")}),class:"style-button"},"Insert \\"),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.insertText("\\{")}),class:"style-button"},"Insert {"),Object(r["k"])("button",{onClick:e[8]||(e[8]=function(e){return t.insertText("\\}")}),class:"style-button"},"Insert }")]),Gn,Object(r["k"])("div",Yn,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.insertCommand("b")}),class:"style-button",style:{"font-weight":"bold"}}," Bold "),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(e){return t.insertCommand("i")}),class:"style-button",style:{"font-style":"italic"}}," Italics "),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.insertCommand("plain")}),class:"style-button"}," Plain "),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(e){return t.insertCommand("edited")}),class:"style-button edited-style"}," Edited "),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(e){return t.insertCommand("k",2)}),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),Object(r["k"])("div",Kn,[Object(r["k"])("button",{onClick:e[14]||(e[14]=function(e){return t.insertCommand("alpha",.5)}),class:"style-button"}," Alpha ")]),Object(r["k"])("div",Xn,[Object(r["k"])("button",{onClick:e[15]||(e[15]=function(e){return t.insertCommand("size",12)}),class:"style-button",style:{"font-size":"20px"}}," Font size "),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.selectedFont=e}),class:"style-button"},[Jn],512),[[r["z"],t.selectedFont]]),Object(r["k"])("button",{onClick:e[17]||(e[17]=function(e){return t.selectColor("text")}),class:"style-button"}," Text color "),Object(r["k"])("button",{onClick:e[18]||(e[18]=function(e){return t.selectColor("outline")}),class:"style-button"}," Outline color ")])],2))})),Zn=5,tr=function(){function t(e){Object(wn["a"])(this,t),this.str=e,this.i=0}return Object(xn["a"])(t,[{key:"current",value:function(){return this.str[this.i]}},{key:"next",value:function(){return++this.i,this.current()}},{key:"pos",get:function(){return this.i}},{key:"around",get:function(){return this.str.slice(Math.max(0,this.i-Zn),this.i+Zn)}},{key:"ahead",get:function(){return this.str[this.i+1]}},{key:"behind",get:function(){return this.str[this.i+1]}}]),t}();function er(t){var e=[],n=new tr(t),r=nr;while(r!==rr)r=r(e,n);return e}function nr(t,e){return void 0===e.current()?rr:"{"===e.current()?ir:"\n"===e.current()?cr:ar}function rr(){return rr}function ar(t,e){var n,r=e.pos,a="",o=!1;while(1){if(void 0===e.current()){n=rr;break}if(o)a+=e.current(),o=!1;else if("\\"===e.current())o=!0;else{if("{"===e.current()||"\n"===e.current()){n=nr;break}a+=e.current()}e.next()}return t.push({type:"text",pos:r,content:a}),n}function or(t,e){throw new Error("Error at position ".concat(t.pos,": (around: ").concat(t.around,") ").concat(e))}function ir(t,e){var n=e.pos;if("{"!==e.current())throw new Error("Parser error: Command does not start with {");var r="/"===e.next();r&&e.next();var a="",o="",i=!1;while(1){if(void 0===e.current()&&or(e,"Unexpected end of text inside a command"),"}"===e.current())break;i?o+=e.current():e.current().match(/[a-z]/i)?a+=e.current():"="===e.current()?(r&&or(e,"Closing commands may not contain arguments"),i=!0):or(e,"Unexpected character in command name."),e.next()}return e.next(),r?t.push({type:"commandClose",commandName:a,pos:n}):t.push({type:"command",pos:n,argument:o,commandName:a}),nr}function cr(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),nr}var sr=new Map([ur("i",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{isItalic:!0})})),ur("b",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{isBold:!0})})),ur("u",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{isUnderlined:!0})})),ur("s",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{isStrikethrough:!0})})),ur("plain",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})})),ur("edited",(function(t){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})})),lr("k",(function(t,e,n){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{letterSpacing:e?t.letterSpacing+n:n})})),lr("size",(function(t,e,n){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{fontSize:e?t.fontSize+n:n})})),lr("alpha",(function(t,e,n){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{alpha:e?t.alpha+n:n})})),lr("stroke",(function(t,e,n){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{strokeWidth:e?t.strokeWidth+n:n})})),["font",function(t,e){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{fontName:e})}],["color",function(t,e){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{color:e})}],["outlinecolor",function(t,e){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{strokeColor:e})}]]);function ur(t,e){return[t,function(n,r){if(r)throw new Error("Operator '".concat(t,"' does not take any arguments."));return e(n)}]}function lr(t,e){return[t,function(n,r){if(!r)throw new Error("Operator '".concat(t,"' needs an argument."));var a="+"===r[0]||"-"===r[0],o=Number(r);if(isNaN(o))throw new Error("Operator '".concat(t,"' needs a numeric argument."));return e(n,a,o)}]}var dr=function(){function t(e,n){Object(wn["a"])(this,t),this.str=e,this.baseStyle=n,this.tokens=er(e),this.rebuildParts()}return Object(xn["a"])(t,[{key:"rebuildParts",value:function(){this.renderParts=this.getRenderParts(this.tokens,this.baseStyle)}},{key:"loadFonts",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,o,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("fonts"in document){t.next=2;break}return t.abrupt("return");case 2:e=new Set,n=null,r=Object(ht["a"])(this.renderParts),t.prev=5,r.s();case 7:if((a=r.n()).done){t.next=14;break}if(o=a.value,"style"in o){t.next=11;break}return t.abrupt("continue",12);case 11:o.style!==n&&(n=o.style,n.fontName&&e.add(n.fontName));case 12:t.next=7;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:i=!1,c=Object(ht["a"])(e),t.prev=24,c.s();case 26:if((s=c.n()).done){t.next=36;break}if(u=s.value,l=document,d="8px ".concat(u),l.fonts.check(d)){t.next=34;break}return i=!0,t.next=34,l.fonts.load(d);case 34:t.next=26;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t["catch"](24),c.e(t.t1);case 41:return t.prev=41,c.f(),t.finish(41);case 44:i&&(p=er(this.str),this.renderParts=this.getRenderParts(p,this.baseStyle));case 45:case"end":return t.stop()}}),t,this,[[5,16,19,22],[24,38,41,44]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(t){t.save();var e,n=null,r=Object(ht["a"])(this.renderParts);try{for(r.s();!(e=r.n()).done;){var a=e.value;"newline"!==a.type&&(a.style!==n&&(n=a.style,mr(n,t)),n.strokeWidth>0&&n.strokeColor>""&&t.strokeText(a.character,a.x,a.y))}}catch(s){r.e(s)}finally{r.f()}var o,i=Object(ht["a"])(this.renderParts);try{for(i.s();!(o=i.n()).done;){var c=o.value;"newline"!==c.type&&(c.style!==n&&(n=c.style,mr(n,t)),t.fillText(c.character,c.x,c.y))}}catch(s){i.e(s)}finally{i.f()}t.restore()}},{key:"quote",value:function(){var t;(function(t){t[t["None"]=0]="None",t[t["ExplictQuote"]=1]="ExplictQuote",t[t["ImplictQuote"]=2]="ImplictQuote",t[t["Star"]=3]="Star"})(t||(t={}));for(var e=-1,n=t.None,r=0;r<this.renderParts.length;++r){var a=this.renderParts[r];if("character"===a.type)switch(n){case t.None:if(a.character.match(/\s/))continue;'"'===a.character?(n=t.ExplictQuote,e=r):"*"===a.character?(n=t.Star,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:br(a.style,'"')}),r++,e=r,n=t.ImplictQuote);break;case t.ExplictQuote:e=r,'"'===a.character&&(n=t.None);break;case t.ImplictQuote:if(a.character.match(/\s/))continue;"*"===a.character&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:br(a.style,'"')}),n=t.Star,r++),e=r;break;case t.Star:"*"===a.character&&(n=t.None),e=r;break}}var o=this.renderParts[e];o&&n===t.Star&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:o.style,character:"*",height:o.height,width:br(o.style,'"')}),!o||n!==t.ExplictQuote&&n!==t.ImplictQuote||this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:br(o.style,'"')})}},{key:"fixAlignment",value:function(t,e,n,r,a){var o=0,i=[];function c(){var r=e;"center"===t?r=e+(n-e)/2-o/2:"right"===t&&(r=n-o);var a,c=Object(ht["a"])(i);try{for(c.s();!(a=c.n()).done;){var s=a.value;s.x=r,r+=s.width}}catch(u){c.e(u)}finally{c.f()}}var s=this.renderParts;a>0&&(s=this.applyLineWrapping(this.renderParts.slice(0),a));var u,l=r,d=[],p=0,h=Object(ht["a"])(s);try{for(h.s();!(u=h.n()).done;){var b=u.value;p=Math.max(p,b.height),"newline"===b.type&&(d.push(p),p=0)}}catch(O){h.e(O)}finally{h.f()}d.push(p);var f,v=0,m=Object(ht["a"])(s);try{for(m.s();!(f=m.n()).done;){var j=f.value;if(p=Math.max(p,j.height),j.y=l,i.push(j),o+=j.width,"newline"===j.type)c(),l+=d[++v]||0,o=0,p=0,i=[];else if("character"===j.type){var g=i[i.length-1];"character"===g.type&&(o+=g.style.letterSpacing,g.width+=g.style.letterSpacing)}}}catch(O){m.e(O)}finally{m.f()}c()}},{key:"getHeight",value:function(t){var e,n=0,r=0,a=0===t?this.renderParts:this.applyLineWrapping(this.renderParts.slice(0),t),o=Object(ht["a"])(a);try{for(o.s();!(e=o.n()).done;){var i=e.value;n=Math.max(n,i.height),"newline"===i.type&&(r+=n,n=0)}}catch(c){o.e(c)}finally{o.f()}return r+=n,r}},{key:"getWidth",value:function(){var t,e=0,n=0,r=null,a=Object(ht["a"])(this.renderParts);try{for(a.s();!(t=a.n()).done;){var o=t.value;e+=o.width,"newline"===o.type?(n=Math.max(n,e),e=0,r=null):"character"===o.type&&(r&&"character"===r.type&&(e+=r.style.letterSpacing),r=o)}}catch(i){a.e(i)}finally{a.f()}return n=Math.max(n,e),n}},{key:"getRenderParts",value:function(e,n){var r,a=[],o=[],i=[],c=vr(n),s=n,u=null,l=Object(ht["a"])(e);try{for(l.s();!(r=l.n()).done;){var d=r.value;switch(d.type){case"command":if(!t.textCommands.has(d.commandName))throw new Error("There is no text command called '".concat(d.commandName,"' at position ").concat(d.pos,"."));o.push(s),i.push(u),s=t.textCommands.get(d.commandName)(s,d.argument),c=vr(s),u=d;break;case"commandClose":if(!u)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', but no commands are currently open."));if(d.commandName!==u.commandName)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', expected to close '").concat(u,"' first. (Opened at position ").concat(u.pos,")"));u=i.pop(),s=o.pop();break;case"newline":a.push({height:c,width:0,x:0,y:0,type:"newline"});break;case"text":var p,h=Object(ht["a"])(d.content);try{for(h.s();!(p=h.n()).done;){var b=p.value;a.push({type:"character",character:b,height:c,width:br(s,b),style:s,x:0,y:0})}}catch(f){h.e(f)}finally{h.f()}}}}catch(f){l.e(f)}finally{l.f()}return a}},{key:"applyLineWrapping",value:function(t,e){var n,r=-1,a=0,o=0,i=[],c=Object(ht["a"])(t);try{for(c.s();!(n=c.n()).done;){var s=n.value;if("newline"===s.type)r=-1,a=0,o=0,i.push(s);else if("character"===s.type)if(" "===s.character){if(a>e){r=-1,a=0,o=0,i.push({type:"newline",height:s.height,width:0,x:0,y:0});continue}a+=s.width,o=a,r=i.length,i.push(s)}else a+=s.width,a>e&&-1!==r?(a-=o,i.splice(r,1,{type:"newline",height:s.height,width:0,x:0,y:0}),r=-1,o=0,i.push(s)):i.push(s);else _n(s)}}catch(u){c.e(u)}finally{c.f()}return i}}]),t}();dr.textCommands=sr;var pr=document.createElement("canvas").getContext("2d"),hr=null;function br(t,e){return t!==hr&&(mr(t,pr),hr=t),pr.measureText(e).width}var fr=new Map;function vr(t){var e=t.fontSize+" "+t.fontName;if(fr.has(e))return fr.get(e)*t.lineSpacing;var n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize="".concat(t.fontSize,"px"),n.style.lineHeight="1";var r=document.createElement("div");r.style.opacity="0",r.style.fontFamily=t.fontName,r.style.fontSize="".concat(t.fontSize,"px"),r.style.lineHeight="1",r.style.position="absolute",r.style.top="0",r.style.left="0",r.appendChild(n),document.body.appendChild(r);try{var a=r.offsetHeight;return fr.set(e,a),a*t.lineSpacing}finally{r.remove()}}function mr(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}var jr="#ffa8d2",gr="#552222",Or="#ffeef6",kr="#bb5599",yr=new Cn(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),wr=new Cn(.002028397565922768,0,.13725490196078438,0),xr=.82,Cr=new Cn(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Sr=12,Rr=12,Pr=1.5,Ir=new Cn(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Tr=new Cn(0,-.14285714285714296,.3,0),Ar=new Cn(.004269293924466178,-.01869158878504662,-.039215686274509665,0),_r=9.5,Dr=47,$r=new Cn(.0023347701149424305,0,.10784313725490202,0),Hr=816,Vr=900,Br=146,Er=568,Fr=38,Lr=50,Mr=39,Nr=168,Wr=34,Ur=29,zr=12,qr=-126,Gr=-72,Yr=-38,Kr=30.75,Xr=26,Jr=426,Qr=58,Zr={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},ta=Object(Zt["a"])(Object(Zt["a"])({},Zr),{},{fontName:"riffic",fontSize:24,strokeColor:kr,strokeWidth:6,color:"white",letterSpacing:1}),ea={align:"left",font:"13px aller",fill:{style:"#522"}},na=Object(Zt["a"])(Object(Zt["a"])({},ea),{},{fill:{style:"#a66"}}),ra=(Pe["d"],Pe["d"],Er-Mr),aa=Object(r["m"])({inheritAttrs:!1,components:{Color:An},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:function(){return{colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}},computed:{vertical:function(){return this.$store.state.ui.vertical}},watch:{selectedFont:function(){""!==this.selectedFont&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged:function(){var t=this.$refs.textArea.value;try{new dr(t,ta),this.error=""}catch(e){this.error=e.message}this.$emit("update:modelValue",t)},selectColor:function(t){var e=this.$refs.textArea;this.colorSelector=t,this.rememberedStart=e.selectionStart,this.rememberedEnd=e.selectionEnd},applyColor:function(){var t=this,e=this.selectedColor,n=this.colorSelector,r=function r(){var a=t.$refs.textArea;a?(a.selectionStart=t.rememberedStart,a.selectionEnd=t.rememberedEnd,t.insertCommand("text"===n?"color":"outlinecolor",e)):t.$nextTick(r)};this.$nextTick(r),this.selectedColor="#000000",this.colorSelector=""},insertText:function(t){var e=this.$refs.textArea,n=e.value,r=e.selectionStart,a=e.selectionEnd;e.value=n.slice(0,r)+t+n.slice(a),e.selectionStart=e.selectionEnd=r+t.length,e.focus(),this.onValueChanged()},insertCommand:function(t,e){var n=this.$refs.textArea,r=n.value,a=n.selectionStart,o=n.selectionEnd,i=r.slice(a,o),c=r.slice(0,a),s=r.slice(o),u=t;e&&(u+="="+e),n.value="".concat(c,"{").concat(u,"}").concat(i,"{/").concat(t,"}").concat(s),n.selectionStart=a+u.length+2,n.selectionEnd=n.selectionStart+i.length,n.focus(),this.onValueChanged()}}});n("0f13");aa.render=Qn,aa.__scopeId="data-v-e81e39ea";var oa=aa,ia=ae(),ca=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],PositionAndSize:Te,Layers:Ee,Delete:Me,TextEditor:oa,ImageOptions:Mn,Color:An,ModalDialog:Q,DFieldset:Vt["a"]},props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},data:function(){return{imageOptionsOpen:!1,canEdit:!0,modalNameInput:"",showRename:!1,localColorHandler:null}},computed:{flip:ia("flip","objects/setFlip"),rotation:ia("rotation","objects/setRotation"),enlargeWhenTalking:ia("enlargeWhenTalking","objects/setEnlargeWhenTalking"),nameboxWidth:{get:function(){var t=this.object.nameboxWidth;return null===t?"":t+""},set:function(t){var e=this,n=""===t.trim()?null:parseInt(t);this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setObjectNameboxWidth",{id:e.object.id,nameboxWidth:n});case 1:case"end":return t.stop()}}),t)}))))}},defaultNameboxWidth:function(){return Nr},finalColorHandler:function(){return this.localColorHandler||this.colorHandler||null},hasLabel:function(){return null!==this.object.label},heading:function(){return console.log("heading",this.object.label,this.title,"Object"),this.object.label||this.title||"Object"},useCustomTextboxColor:{get:function(){return null!==this.object.textboxColor},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("objects/setTextboxColor",{id:e.object.id,textboxColor:t?jr:null});case 1:case"end":return n.stop()}}),n)}))))}}},methods:{copy:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/copyObjectToClipboard",{id:t.object.id});case 1:case"end":return e.stop()}}),e)}))))},enableNameEdit:function(){this.modalNameInput=this.object.label||"",this.showRename=!0},renameOption:function(t){var e=this;this.showRename=!1,"Apply"===t&&this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setLabel",{id:e.object.id,label:e.modalNameInput});case 1:case"end":return t.stop()}}),t)}))))},selectTextboxColor:function(){var t=this;this.localColorHandler={title:"Textbox color",get:function(){return t.object.textboxColor},set:function(e){t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$store.commit("objects/setTextboxColor",{id:t.object.id,textboxColor:e});case 1:case"end":return n.stop()}}),n)}))))},leave:function(){t.localColorHandler=null}}}}});n("81ec"),n("5dec");ca.render=fe,ca.__scopeId="data-v-b5267b6a";var sa=ca,ua=ae(),la=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],Parts:re,DFieldset:Vt["a"],ObjectTool:sa},data:function(){return{panelForParts:null}},computed:{flip:ua("flip","objects/setFlip"),closeUp:ua("close","objects/setClose"),selection:function(){return this.$store.state.ui.selection},object:function(){var t=this.$store.state.objects.objects[this.selection];if("character"===t.type)return t},charData:function(){return Object(Ht["e"])(this.$store,this.object)},label:function(){return this.charData.label||""},parts:function(){return Object(Ht["g"])(this.charData,this.object)},hasMultipleStyles:function(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses:function(){var t=this.charData.styleGroups[this.object.styleGroupId],e=t.styles[this.object.styleId];return e.poses.length>1}},methods:{seekPose:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.object.id,delta:t})}))},seekStyle:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.object.id,delta:t})}))},seekPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.object.id,delta:e,part:t})}))},captialize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},watch:{selection:function(){this.panelForParts=null}}});n("dd24");la.render=$t,la.__scopeId="data-v-47403597";var da=la;function pa(t,e,n,a,o,i){var c=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(c,{object:t.object,title:"Custom Sprite"},null,8,["object"])}var ha=Object(r["m"])({mixins:[q],components:{ObjectTool:sa},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t}}});ha.render=pa;var ba=ha,fa=Object(r["F"])("data-v-6e9ccc56");Object(r["r"])("data-v-6e9ccc56");var va={class:"upper-combos"},ma=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"text_style"},"Style:")],-1),ja=Object(r["k"])("option",{value:"normal"},"Normal",-1),ga=Object(r["k"])("option",{value:"corrupt"},"Corrupt",-1),Oa=Object(r["k"])("option",{value:"custom"},"Custom",-1),ka=Object(r["k"])("option",{value:"none"},"None",-1),ya=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"current_talking"},"Person talking:")],-1),wa=Object(r["k"])("option",{value:"$null$"},"No-one",-1),xa=Object(r["k"])("option",{value:"$other$"},"Other",-1),Ca=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_name"},"Other name:")],-1),Sa={id:"dialog_text_wrapper"},Ra=Object(r["k"])("label",{for:"dialog_text"},"Dialog:",-1),Pa={key:0},Ia=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_width"},"Namebox width:")],-1),Ta={colspan:"2"},Aa={key:0},_a=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),Da={key:1},$a={colspan:"2"},Ha=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_controls_color"},"Controls Color:")],-1),Va=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_color"},"Namebox Color:")],-1),Ba=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1);Object(r["q"])();var Ea=fa((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),d=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(d,{object:t.object,title:"Textbox",textHandler:t.textHandler,colorHandler:t.colorHandler},{default:fa((function(){return[Object(r["k"])("table",va,[Object(r["k"])("tr",null,[ma,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"text_style","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.textBoxStyle=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},[ja,ga,Oa,ka],544),[[r["z"],t.textBoxStyle]])])]),Object(r["k"])("tr",null,[ya,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.talkingObjId=e}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"]))},[wa,(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.nameList,(function(t){var e=Object(l["a"])(t,2),n=e[0],a=e[1];return Object(r["p"])(),Object(r["g"])("option",{key:n,value:n},Object(r["x"])(a),9,["value"])})),128)),xa],544),[[r["z"],t.talkingObjId]])])]),Object(r["k"])("tr",null,[Ca,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_name","onUpdate:modelValue":e[5]||(e[5]=function(e){return t.talkingOther=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.talkingOther]]),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.textEditor="name"})},"...")])])]),Object(r["k"])(c,{label:"Auto quoting?",modelValue:t.autoQuoting,"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.autoQuoting=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["k"])("div",Sa,[Ra,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.dialog=e}),id:"dialog_text",onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.dialog]]),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(e){return t.textEditor="body"})},"Formatting")])]})),options:fa((function(){return[Object(r["k"])(u,{title:"Customization:",class:"custom"===t.textBoxStyle?"customization-set":""},{default:fa((function(){return[Object(r["k"])(s,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:fa((function(){return[Object(r["k"])(c,{label:"Controls visible?",modelValue:t.showControls,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.showControls=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Able to skip?",modelValue:t.allowSkipping,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.allowSkipping=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Continue arrow?",modelValue:t.showContinueArrow,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.showContinueArrow=e})},null,8,["modelValue"]),"custom"===t.textBoxStyle?(Object(r["p"])(),Object(r["g"])("table",Pa,[Object(r["k"])("tr",null,[Ia,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.customNameboxWidth=e}),disabled:t.overrideColor,onKeydown:e[17]||(e[17]=Object(r["E"])((function(){}),["stop"]))},null,40,["disabled"]),[[r["A"],t.customNameboxWidth,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Ta,[Object(r["k"])(c,{modelValue:t.overrideColor,"onUpdate:modelValue":e[18]||(e[18]=function(e){return t.overrideColor=e}),label:"Override color"},null,8,["modelValue"])])]),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",Aa,[_a,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.customColor},onClick:e[19]||(e[19]=function(e){return t.colorSelect="base"})},null,4)])])):Object(r["h"])("",!0),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",Da,[Object(r["k"])("td",$a,[Object(r["k"])(c,{id:"derive_custom_colors",modelValue:t.deriveCustomColors,"onUpdate:modelValue":e[20]||(e[20]=function(e){return t.deriveCustomColors=e}),label:"Derive other colors"},null,8,["modelValue"])])])):Object(r["h"])("",!0),t.overrideColor&&!t.deriveCustomColors?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[Ha,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_controls_color",class:"color-button",style:{background:t.object.customControlsColor},onClick:e[21]||(e[21]=function(e){return t.colorSelect="controls"})},null,4)])]),Object(r["k"])("tr",null,[Va,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_color",class:"color-button",style:{background:t.object.customNameboxColor},onClick:e[22]||(e[22]=function(e){return t.colorSelect="namebox"})},null,4)])]),Object(r["k"])("tr",null,[Ba,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_stroke",class:"color-button",style:{background:t.object.customNameboxStroke},onClick:e[23]||(e[23]=function(e){return t.colorSelect="nameboxStroke"})},null,4)])])],64)):Object(r["h"])("",!0)])):Object(r["h"])("",!0)]})),_:1})]})),_:1},8,["class"]),Object(r["k"])("button",{onClick:e[24]||(e[24]=function(){return t.resetPosition.apply(t,arguments)})},"Reset position"),Object(r["k"])("button",{onClick:e[25]||(e[25]=function(){return t.splitTextbox.apply(t,arguments)})},"Split textbox")]})),_:1},8,["object","textHandler","colorHandler"])})),Fa=ae(),La=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"],ObjectTool:sa,DFlow:ee},mixins:[q],data:function(){return{textEditor:"",colorSelect:""}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:this.textEditorName,get:function(){return"name"===t.textEditor?t.object.talkingOther:"body"===t.textEditor?t.dialog:""},set:function(e){"name"===t.textEditor?t.talkingOther=e:"body"===t.textEditor&&(t.dialog=e)},leave:function(){t.textEditor=""}}},colorHandler:function(){var t=this;if(this.colorSelect)return{title:this.colorName,get:function(){switch(t.colorSelect){case"":return"#000000";case"base":return t.object.customColor;case"controls":return t.object.customControlsColor;case"namebox":return t.object.customNameboxColor;case"nameboxStroke":return t.object.customNameboxStroke;default:return _n(t.colorSelect),""}},set:function(e){t.vuexHistory.transaction((function(){switch(t.colorSelect){case"":return;case"base":return void t.$store.commit("objects/setCustomColor",{id:t.object.id,color:e});case"controls":return void t.$store.commit("objects/setControlsColor",{id:t.object.id,customControlsColor:e});case"namebox":return void t.$store.commit("objects/setNameboxColor",{id:t.object.id,customNameboxColor:e});case"nameboxStroke":return void t.$store.commit("objects/setNameboxStroke",{id:t.object.id,customNameboxStroke:e})}}))},leave:function(){t.colorSelect=""}}},talkingObjId:{get:function(){return this.object.talkingObjId||"$null$"},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setTalkingObject",{id:e.object.id,talkingObjId:"$null$"===t?null:t})}))}},talkingOther:Fa("talkingOther","objects/setTalkingOther"),showControls:Fa("controls","objects/setControlsVisible"),allowSkipping:Fa("skip","objects/setSkipable"),autoQuoting:Fa("autoQuoting","objects/setAutoQuoting"),autoWrap:Fa("autoWrap","objects/setAutoWrapping"),showContinueArrow:Fa("continue","objects/setContinueArrow"),dialog:Fa("text","objects/setText"),textBoxStyle:Fa("style","objects/setStyle"),overrideColor:Fa("overrideColor","objects/setColorOverride"),deriveCustomColors:Fa("deriveCustomColors","objects/setDeriveCustomColors"),customNameboxWidth:Fa("customNameboxWidth","objects/setNameboxWidth"),nameList:function(){for(var t=this.$store.state.objects.panels[this.$store.state.panels.currentPanel],e=[],n=0,r=[].concat(Object(On["a"])(t.order),Object(On["a"])(t.onTopOrder));n<r.length;n++){var a=r[n],o=this.$store.state.objects.objects[a];null!==o.label&&e.push([a,o.label])}return e},textEditorName:function(){return"name"===this.textEditor?"Name":"body"===this.textEditor?"Dialog":""},customControlsColor:function(){return this.object.customControlsColor},colorName:function(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:return _n(this.colorSelect),""}}},methods:{splitTextbox:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.object.id})}))},resetPosition:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/resetTextboxBounds",{id:t.object.id})}))}}});n("77e2");La.render=Ea,La.__scopeId="data-v-6e9ccc56";var Ma=La,Na=Object(r["F"])("data-v-6218d3d4");Object(r["r"])("data-v-6218d3d4");var Wa=Object(r["k"])("tr",null,[Object(r["k"])("td",{colspan:"2"},[Object(r["k"])("label",{for:"choice-button-input"},"Text")])],-1);Object(r["q"])();var Ua=Na((function(t,e,n,a,o,i){var c=Object(r["w"])("d-flow"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:"Choice",textHandler:t.textHandler},{default:Na((function(){return[Object(r["k"])(s,{class:"buttons",title:"Buttons:"},{default:Na((function(){return[Object(r["k"])(c,{maxSize:"100%",direction:"vertical",noWraping:""},{default:Na((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.buttons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{class:{choiceBtn:!0,active:n===t.currentIdx},key:n,onClick:function(e){return t.select(n)}},Object(r["x"])(""===e.text.trim()?"[Empty]":e.text),11,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])(s,{class:"current_button",title:"Current button:"},{default:Na((function(){return[Object(r["k"])("table",null,[Wa,Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"choice-button-input","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.buttonText=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.buttonText]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"...")])])])]})),_:1}),Object(r["k"])("button",{onClick:e[4]||(e[4]=function(){return t.addChoice.apply(t,arguments)})},"Add"),Object(r["k"])("button",{onClick:e[5]||(e[5]=function(){return t.removeChoice.apply(t,arguments)})},"Remove"),Object(r["k"])(u,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.autoWrap=e})},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),za=ae(),qa=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],DFieldset:Vt["a"],DFlow:ee,ObjectTool:sa},data:function(){return{currentIdx:0,textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("choice"===t.type)return t},autoWrap:za("autoWrap","objects/setAutoWrapping"),buttonText:Ga("text","objects/setChoiceText",!0),buttons:function(){return this.object.choices},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.buttonText},set:function(e){t.buttonText=e},leave:function(){t.textEditor=!1}}}},methods:{select:function(t){this.currentIdx=t},addChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addChoice",{id:t.object.id,text:""})}))},removeChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.currentIdx===t.object.choices.length-1&&t.currentIdx>0&&t.select(t.currentIdx-1),t.$store.dispatch("objects/removeChoice",{id:t.object.id,choiceIdx:t.currentIdx})}))}}});function Ga(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object.choices[this.currentIdx][t]},set:function(r){var a=this;this.vuexHistory.transaction((function(){a.$store[n?"dispatch":"commit"](e,Object(Qt["a"])({id:a.object.id,choiceIdx:a.currentIdx},t,r))}))}}}n("5c35");qa.render=Ua,qa.__scopeId="data-v-6218d3d4";var Ya=qa,Ka=Object(r["F"])("data-v-753d2b9a");Object(r["r"])("data-v-753d2b9a");var Xa={class:"panel"},Ja=Object(r["k"])("h1",null,"Help and Credits",-1),Qa=Object(r["j"])("Help"),Za=Object(r["j"])("Fork me on GitHub"),to=Object(r["j"])("Privacy Statement"),eo=Object(r["k"])("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1),no=Object(r["k"])("p",null,[Object(r["j"])(" Doki Doki Dialog Generator developed by EDave64 "),Object(r["k"])("br"),Object(r["j"])("Based on gemdude46's DDLC Shitpost generator ")],-1),ro=Object(r["j"])(" Unused House Background by "),ao=Object(r["j"])(" Fatelogic "),oo=Object(r["j"])(" Aller Font by "),io=Object(r["j"])("Dalton Maag Ltd"),co=Object(r["j"])(" Riffic Bold Font by "),so=Object(r["j"])("InkyType"),uo=Object(r["j"])(" Verily Serif Mono Font by "),lo=Object(r["j"])("Stephen G. Hartke"),po=Object(r["j"])(" F25 Bank Printer Font by "),ho=Object(r["j"])("F25 Digital Typeface Design"),bo=Object(r["j"])(" Journal Font by "),fo=Object(r["j"])("Fontourist"),vo=Object(r["j"])(" Hashtag Font by "),mo=Object(r["j"])(" TitanVex"),jo=Object(r["j"])(" JP Hand Slanted Font by "),go=Object(r["j"])("Jonathan Paterson"),Oo=Object(r["j"])(" As I Lay Dying Font by "),ko=Object(r["j"])("Moises Esqueda"),yo=Object(r["j"])(" Damagrafik Script Font by "),wo=Object(r["j"])("Davide Terenzi"),xo=Object(r["j"])(" Ammy's Handwriting Font by "),Co=Object(r["j"])("Ammy K."),So=Object(r["j"])(" Halogen Font by "),Ro=Object(r["j"])("JLH Fonts"),Po=Object(r["i"])("<p data-v-753d2b9a> MC Classic Sprite by Childish-N <br data-v-753d2b9a>MC Classic Chibi by GyleToTheRescue </p><p data-v-753d2b9a> MC Sprite by Childish-N <br data-v-753d2b9a>MC Casual Sprite by SlightlySimple <br data-v-753d2b9a>MC Chibi by SlightlySimple </p><p data-v-753d2b9a> MC Chad Sprite by Cylent-Nite <br data-v-753d2b9a>MC Chad Poses and expressions by SlightlySimple <br data-v-753d2b9a>MC Chad Poses and chibi by Meddy-sin </p><p data-v-753d2b9a> FeMC Sprite by Meddy-sin <br data-v-753d2b9a>FeMC Casual Sprite by SlightlySimple </p><p data-v-753d2b9a>Classic Amy Sprite by Meddy-sin</p><p data-v-753d2b9a>Amy Sprite by Meddy-sin and SlightlySimple</p><p data-v-753d2b9a>Special thanks to SlightlySimple for testing and technical help</p><p data-v-753d2b9a> Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing </p>",8);Object(r["q"])();var Io=Ka((function(t,e,n,a,o,i){var c=Object(r["w"])("l");return Object(r["p"])(),Object(r["g"])("div",Xa,[Ja,Object(r["k"])(c,{class:"btn",to:"wiki://Dokumentation"},{default:Ka((function(){return[Qa]})),_:1}),Object(r["k"])(c,{class:"btn",to:"github://"},{default:Ka((function(){return[Za]})),_:1}),Object(r["k"])(c,{class:"btn",to:"wiki://Privacy Statement"},{default:Ka((function(){return[to]})),_:1}),eo,no,Object(r["k"])("p",null,[ro,Object(r["k"])(c,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:Ka((function(){return[ao]})),_:1})]),Object(r["k"])("p",null,[oo,Object(r["k"])(c,{to:"https://www.daltonmaag.com/library/aller"},{default:Ka((function(){return[io]})),_:1})]),Object(r["k"])("p",null,[co,Object(r["k"])(c,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:Ka((function(){return[so]})),_:1})]),Object(r["k"])("p",null,[uo,Object(r["k"])(c,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:Ka((function(){return[lo]})),_:1})]),Object(r["k"])("p",null,[po,Object(r["k"])(c,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:Ka((function(){return[ho]})),_:1})]),Object(r["k"])("p",null,[bo,Object(r["k"])(c,{to:"https://www.dafont.com/journal.font"},{default:Ka((function(){return[fo]})),_:1})]),Object(r["k"])("p",null,[vo,Object(r["k"])(c,{to:"https://www.dafont.com/hashtag.font"},{default:Ka((function(){return[mo]})),_:1})]),Object(r["k"])("p",null,[jo,Object(r["k"])(c,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:Ka((function(){return[go]})),_:1})]),Object(r["k"])("p",null,[Oo,Object(r["k"])(c,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:Ka((function(){return[ko]})),_:1})]),Object(r["k"])("p",null,[yo,Object(r["k"])(c,{to:"https://www.dafont.com/damagrafik-script.font"},{default:Ka((function(){return[wo]})),_:1})]),Object(r["k"])("p",null,[xo,Object(r["k"])(c,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:Ka((function(){return[Co]})),_:1})]),Object(r["k"])("p",null,[So,Object(r["k"])(c,{to:"https://www.dafont.com/halogen.font"},{default:Ka((function(){return[Ro]})),_:1})]),Po])})),To=Object(r["m"])({mixins:[q],components:{L:Z["a"]}});n("6a18");To.render=Io,To.__scopeId="data-v-753d2b9a";var Ao=To,_o=Object(r["F"])("data-v-4594b0c3");Object(r["r"])("data-v-4594b0c3");var Do=Object(r["j"])("Drop here to add as a new background"),$o=Object(r["k"])("h1",null,"Background",-1),Ho=Object(r["j"])(" Upload "),Vo=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Bo=Object(r["j"])(" Search in content packs ");Object(r["q"])();var Eo=_o((function(t,e,n,a,o,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("color"),u=Object(r["w"])("image-options"),l=Object(r["w"])("background-settings"),d=Object(r["w"])("background-button");return Object(r["p"])(),Object(r["g"])("div",{class:"panel",onDragenter:e[10]||(e[10]=function(){return t.dragEnter.apply(t,arguments)}),onMouseleave:e[11]||(e[11]=function(e){return t.$refs.dt.hide()})},[Object(r["k"])(c,{ref:"dt",class:"drop-target",onDrop:t.addImageFile},{default:_o((function(){return[Do]})),_:1},8,["onDrop"]),$o,t.colorSelect?Object(r["k"])(s,{key:0,modelValue:t.bgColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.bgColor=e}),onLeave:e[2]||(e[2]=function(e){return t.colorSelect=!1})},null,8,["modelValue"]):t.imageOptions?Object(r["k"])(u,{key:1,type:"background",title:"",id:t.$store.state.panels.currentPanel,"no-composition":"",onLeave:e[3]||(e[3]=function(e){return t.imageOptions=!1})},null,8,["id"]):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])(l,{"onChange-color":e[4]||(e[4]=function(e){return t.colorSelect=!0}),"onOpen-image-options":e[5]||(e[5]=function(e){return t.imageOptions=!0})}),Object(r["k"])("div",{class:"btn upload-background",onClick:e[7]||(e[7]=function(e){return t.$refs.upload.click()})},[Ho,Object(r["k"])("input",{type:"file",ref:"upload",onChange:e[6]||(e[6]=function(){return t.onFileUpload.apply(t,arguments)})},null,544)]),Object(r["k"])("button",{class:"upload-background",onClick:e[8]||(e[8]=function(){return t.addByUrl.apply(t,arguments)})},"Add by URL"),Object(r["k"])("button",{class:"upload-background",title:"Not yet implemented",onClick:e[9]||(e[9]=function(e){return t.$emit("show-dialog","type: Backgrounds")})},[Vo,Bo]),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(e){return Object(r["p"])(),Object(r["g"])(d,{key:e,backgroundId:e,onInput:function(n){return t.setBackground(e)}},null,8,["backgroundId","onInput"])})),128))],64))],32)})),Fo=Object(r["F"])("data-v-09138076"),Lo=Fo((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("div",{class:{background:!0,active:t.isActive},title:t.title,style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("input",t.backgroundId)})},Object(r["x"])(t.title),15,["title"])})),Mo=Object(r["m"])({props:{backgroundId:{type:String,required:!0}},data:function(){return{isWebPSupported:null,assets:[]}},computed:{background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.backgroundId)||null},isActive:function(){return this.backgroundId===this.background.current},title:function(){switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label||""},style:function(){switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.bgData){e.next=4;break}return e.next=3,Promise.all(t.bgData.variants[0].map((function(t){return Object(bt["a"])(t,!1)})));case 3:t.assets=e.sent;case 4:case"end":return e.stop()}}),e)})))()}});n("6f08");Mo.render=Lo,Mo.__scopeId="data-v-09138076";var No=Mo,Wo=Object(r["F"])("data-v-99a6545a");Object(r["r"])("data-v-99a6545a");var Uo=Object(r["k"])("label",{for:"bg_color"},"Color:",-1),zo={key:1},qo={colspan:"3"},Go={key:0},Yo={class:"arrow-col"},Ko=Object(r["k"])("td",{style:{"text-align":"center"}},"Variant",-1),Xo={class:"arrow-col"},Jo={colspan:"3"},Qo=Object(r["k"])("option",{value:"0"},"None",-1),Zo=Object(r["k"])("option",{value:"1"},"Stretch",-1),ti=Object(r["k"])("option",{value:"2"},"Cover",-1),ei={colspan:"3"};Object(r["q"])();var ni=Wo((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{class:{"bg-settings":!0,vertical:t.vertical},title:"Settings:"},{default:Wo((function(){return[t.isColor?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Uo,Object(r["k"])("button",{id:"bg_color",class:"color-button",style:{background:t.color},onClick:e[1]||(e[1]=function(e){return t.$emit("change-color")})},null,4)],64)):Object(r["h"])("",!0),t.isVariant?(Object(r["p"])(),Object(r["g"])("table",zo,[Object(r["k"])("tr",null,[Object(r["k"])("td",qo,[Object(r["k"])(c,{modelValue:t.flipped,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.flipped=e}),label:"Flipped?"},null,8,["modelValue"])])]),t.hasVariants?(Object(r["p"])(),Object(r["g"])("tr",Go,[Object(r["k"])("td",Yo,[Object(r["k"])("button",{class:"small-button",onClick:e[3]||(e[3]=function(e){return t.seekVariant(-1)})},"<")]),Ko,Object(r["k"])("td",Xo,[Object(r["k"])("button",{class:"small-button",onClick:e[4]||(e[4]=function(e){return t.seekVariant(1)})},">")])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Object(r["k"])("td",Jo,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.scaling=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[Qo,Zo,ti],544),[[r["z"],t.scaling]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",ei,[Object(r["k"])("button",{id:"image_options_button",onClick:e[7]||(e[7]=function(e){return t.$emit("open-image-options")})}," Image options ")])])])):Object(r["h"])("",!0)]})),_:1},8,["class"])})),ri=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},computed:{vertical:function(){return this.$store.state.ui.vertical},color:{get:function(){return this.background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},flipped:{get:function(){return this.background.flipped},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundFlipped",{flipped:t,panelId:e.$store.state.panels.currentPanel})}))}},scaling:{get:function(){return this.background.scaling.toString()},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(t,10),panelId:e.$store.state.panels.currentPanel})}))}},currentBackgroundId:function(){return this.background.current},background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.id===t.currentBackgroundId}))||null},isColor:function(){return"buildin.static-color"===this.currentBackgroundId},isVariant:function(){return!!this.bgData},hasVariants:function(){return!!this.bgData&&this.bgData.variants.length>1}},methods:{seekVariant:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("panels/seekBackgroundVariant",{delta:t,panelId:e.$store.state.panels.currentPanel})}))}}});n("5b30");ri.render=ni,ri.__scopeId="data-v-99a6545a";var ai=ri,oi={packId:"dddg.buildin.uploadedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},ii=Object(r["m"])({mixins:[q],components:{BackgroundButton:No,BackgroundSettings:ai,DropTarget:ft["a"],Color:An,ImageOptions:Mn},data:function(){return{colorSelect:!1,imageOptions:!1}},computed:{bgColor:{get:function(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},backgrounds:function(){return[].concat(Object(On["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.id}))),["buildin.static-color","buildin.transparent"])}},methods:{setBackground:function(t){this.$store.commit("panels/setCurrentBackground",{current:t,panelId:this.$store.state.panels.currentPanel})},onFileUpload:function(t){var e=this.$refs.upload;if(e.files){var n,r=Object(ht["a"])(e.files);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.addImageFile(a)}}catch(o){r.e(o)}finally{r.f()}}},addImageFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomBackground(t.name,t.name,e)},addByUrl:function(){var t=prompt("Enter the URL of the image");if(t){var e=t.split("/").slice(-1)[0];this.addNewCustomBackground(e,e,t)}},addNewCustomBackground:function(t,e,n){var r=this;oi.backgrounds.push({id:t,label:e,variants:[[n]]}),this.vuexHistory.transaction((function(){r.$store.dispatch("content/replaceContentPack",{contentPack:oi}),r.setBackground(t)}))},dragEnter:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link",this.$refs.dt.show()))}}});n("1b86");ii.render=Eo,ii.__scopeId="data-v-4594b0c3";var ci=ii,si=Object(r["F"])("data-v-cf19b12c");Object(r["r"])("data-v-cf19b12c");var ui={class:"panel"},li=Object(r["k"])("h1",null,"Content Packs",-1),di={class:"list"},pi=Object(r["k"])("label",{for:"pack_name"},"Name:",-1),hi=Object(r["k"])("label",{for:"pack_credits"},"Credits:",-1),bi={key:4},fi=Object(r["j"])(" The tool need restart for changes to take effect. ");Object(r["q"])();var vi=si((function(t,e,n,a,o,i){var c=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])("div",ui,[li,Object(r["k"])("button",{onClick:e[1]||(e[1]=function(){return t.addNew.apply(t,arguments)})},"Add new Pack"),Object(r["k"])(c,{title:"Installed Packs:"},{default:si((function(){return[Object(r["k"])("div",di,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.packs,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:{active:e.name===t.name},key:e.name,onClick:function(n){return t.select(e.name)}},Object(r["x"])(e.name),11,["onClick"])})),128))])]})),_:1}),pi,Object(r["k"])("input",{id:"pack_name",value:t.name,readonly:""},null,8,["value"]),hi,Object(r["k"])("div",{id:"pack_credits",innerHTML:t.credits},null,8,["innerHTML"]),t.activatable?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(){return t.activate.apply(t,arguments)})},"Activate")):Object(r["h"])("",!0),t.deactivatable?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(){return t.deactivate.apply(t,arguments)})},"Deactivate")):Object(r["h"])("",!0),t.installable?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(){return t.install.apply(t,arguments)})},"Install")):Object(r["h"])("",!0),t.uninstallable?(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(){return t.uninstall.apply(t,arguments)})},"Uninstall")):Object(r["h"])("",!0),t.needRestart?(Object(r["p"])(),Object(r["g"])("div",bi,[fi,Object(r["k"])("button",{onClick:e[6]||(e[6]=function(){return t.restart.apply(t,arguments)})},"Restart Now")])):Object(r["h"])("",!0)])})),mi=(n("2ca0"),Object(r["m"])({mixins:[q],components:{DFieldset:Vt["a"]},data:function(){return{selectedPack:null,needRestart:!1}},computed:{packs:function(){var t=this.$store.state.content.contentPacks;return t.filter((function(t){return t.packId&&!t.packId.startsWith("dddg.buildin.")})).map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))},name:function(){return this.selectedPack?this.selectedPack.name:""},credits:function(){return this.selectedPack?this.selectedPack.credits:[""]},activatable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))},deactivatable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))},installable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))},uninstallable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}},methods:{select:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null},addNew:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,G["a"].prompt("Enter the URL of the character pack:");case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.$store.dispatch("content/loadContentPacks",n);case 7:case"end":return e.stop()}}),e)})))()},restart:function(){location.reload(!0)},install:function(){this.selectedPack&&(G["a"].localRepoInstall(this.selectedPack.url),this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)},uninstall:function(){this.selectedPack&&(G["a"].localRepoUninstall(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)},activate:function(){this.selectedPack&&(G["a"].autoLoadAdd(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)},deactivate:function(){this.selectedPack&&(G["a"].autoLoadRemove(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}}}));n("2c10");mi.render=vi,mi.__scopeId="data-v-cf19b12c";var ji=mi,gi=Object(r["F"])("data-v-2ffec108");Object(r["r"])("data-v-2ffec108");var Oi={class:"panel"},ki=Object(r["k"])("h1",null,"Panels",-1),yi={class:"panel_text"},wi={class:"panel_nr"},xi={class:"column"},Ci=Object(r["j"])(" Add new "),Si=Object(r["j"])(" Delete panel "),Ri=Object(r["j"])(" Move ahead "),Pi=Object(r["j"])(" Move behind "),Ii=Object(r["j"])(" Image options "),Ti=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_format"},"Format")],-1),Ai=Object(r["k"])("option",{value:"image/png"},"PNG (lossless)",-1),_i={key:0,value:"image/webp"},Di={key:1,value:"image/heif"},$i=Object(r["k"])("option",{value:"image/jpeg"},"JPEG (lossy)",-1),Hi={key:0},Vi=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_quality"},"Quality:")],-1),Bi=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_ppi"},[Object(r["j"])(" Panels per image: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(0 for one single image)")])],-1),Ei=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_pages"},[Object(r["j"])(" Panels to export: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(Leave empty for all)")])],-1),Fi=Object(r["j"])(" Download ");Object(r["q"])();var Li,Mi=gi((function(t,e,n,a,o,i){var c=Object(r["w"])("image-options"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),l=Object(r["w"])("d-button");return Object(r["p"])(),Object(r["g"])("div",Oi,[ki,t.imageOptions?Object(r["k"])(c,{key:0,type:"panel",title:"",id:t.currentPanel,"no-composition":"",onLeave:e[1]||(e[1]=function(e){t.imageOptions=!1,t.renderThumbnail()})},null,8,["id"]):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])(u,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:gi((function(){return[Object(r["k"])(s,{"no-wraping":"",maxSize:"350px"},{default:gi((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.panelButtons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:e.id,class:{panel_button:!0,active:e.id===t.currentPanel},style:"background-image: url('".concat(e.image,"')"),onClick:function(n){return t.updateCurrentPanel(e.id)}},[Object(r["k"])("div",yi,[Object(r["k"])("p",null,Object(r["x"])(e.text),1)]),Object(r["k"])("div",wi,Object(r["x"])(n+1),1)],14,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])("div",xi,[Object(r["k"])(l,{icon:"add_to_queue",onClick:t.addNewPanel},{default:gi((function(){return[Ci]})),_:1},8,["onClick"]),Object(r["k"])(l,{icon:"remove_from_queue",onClick:t.deletePanel,disabled:!t.canDeletePanel},{default:gi((function(){return[Si]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_upward",onClick:t.moveAhead,disabled:!t.canMoveAhead},{default:gi((function(){return[Ri]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_downward",onClick:t.moveBehind,disabled:!t.canMoveBehind},{default:gi((function(){return[Pi]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"color_lens",onClick:e[2]||(e[2]=function(e){return t.imageOptions=!0})},{default:gi((function(){return[Ii]})),_:1})]),Object(r["k"])(u,{title:"Export"},{default:gi((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Ti,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"export_format","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.format=e})},[Ai,t.webpSupport?(Object(r["p"])(),Object(r["g"])("option",_i,"WebP (lossy)")):Object(r["h"])("",!0),t.heifSupport?(Object(r["p"])(),Object(r["g"])("option",Di,"HEIF (lossy)")):Object(r["h"])("",!0),$i],512),[[r["z"],t.format]])])]),t.isLossy?(Object(r["p"])(),Object(r["g"])("tr",Hi,[Vi,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.quality=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.quality,void 0,{number:!0}]])])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Bi,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.ppi=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.ppi,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Ei,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_pages","onUpdate:modelValue":e[8]||(e[8]=function(e){return t.pages=e}),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[r["A"],t.pages]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])(l,{icon:"photo_camera",onClick:t.download},{default:gi((function(){return[Fi]})),_:1},8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.estimateExportSize.apply(t,arguments)})},"Estimate filesizes")])])])]})),_:1})],64))])})),Ni=(n("13d5"),n("caad"),n("2532"),n("53ca")),Wi=n("c837");(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(Li||(Li={}));var Ui="buildin.transparent",zi=0,qi={panelToUrl:new Map,urlToPanel:new Map,register:function(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister:function(t,e){if(this.urlToPanel.has(e)){var n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),0===n.length&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},Gi={namespaced:!0,state:{panels:{},panelOrder:[],currentPanel:null},mutations:{setCurrentPanel:function(t,e){var n=e.panelId;t.currentPanel=n},setPanelPreview:function(t,e){var n=e.panelId,r=e.url;t.panels[n].lastRender=r,qi.register(n,r)},createPanel:function(t,e){var n=e.panel;t.panels[n.id]=n},setPanelOrder:function(t,e){var n=e.panelOrder;t.panelOrder=Object(On["a"])(n)},setCurrentBackground:function(t,e){var n=e.current,r=e.panelId,a=t.panels[r];a.background.current=n,a.background.variant=0},setBackgroundColor:function(t,e){var n=e.color,r=e.panelId,a=t.panels[r];a.background.color=n},setBackgroundFlipped:function(t,e){var n=e.flipped,r=e.panelId,a=t.panels[r];a.background.flipped=n},setBackgroundVariant:function(t,e){var n=e.variant,r=e.panelId,a=t.panels[r];a.background.variant=n},setBackgroundScaling:function(t,e){var n=e.scaling,r=e.panelId,a=t.panels[r];a.background.scaling=n},deletePanel:function(t,e){var n=e.panelId;qi.unregister(n,qi.panelToUrl.get(n)),delete t.panels[n]},setComposition:function(t,e){var n=t.panels[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.panels[e.id];n.filters=e.filters},backgroundSetComposition:function(t,e){var n=t.panels[e.id];n.background.composite=e.composite},backgroundSetFilters:function(t,e){var n=t.panels[e.id];n.background.filters=e.filters}},actions:{createPanel:function(t){var e=t.state,n=t.commit,r="panel"+ ++zi;n("createPanel",{panel:{id:r,background:{color:"#000000",current:Ui,flipped:!1,scaling:Li.None,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[]}}),e.panelOrder?n("setPanelOrder",{panelOrder:[].concat(Object(On["a"])(e.panelOrder),[r])}):n("setPanelOrder",{panelOrder:[r]}),n("setCurrentPanel",{panelId:r})},duplicatePanel:function(t,e){var n=t.state,r=t.commit,a=t.dispatch,o=e.panelId,i=n.panels[o],c="panel"+ ++zi;qi.register(c,i.lastRender),r("createPanel",{panel:{id:c,background:JSON.parse(JSON.stringify(i.background)),lastRender:i.lastRender,composite:i.composite,filters:JSON.parse(JSON.stringify(i.filters))}}),a("objects/copyObjects",{sourcePanelId:o,targetPanelId:c},{root:!0});var s=n.panelOrder.indexOf(o);r("setPanelOrder",{panelOrder:[].concat(Object(On["a"])(n.panelOrder.slice(0,s+1)),[c],Object(On["a"])(n.panelOrder.slice(s+1)))}),r("setCurrentPanel",{panelId:c})},seekBackgroundVariant:function(t,e){var n=t.state,r=t.rootGetters,a=t.commit,o=e.delta,i=n.panels[n.currentPanel],c=r["content/getBackgrounds"],s=c.get(i.background.current);s&&a("setBackgroundVariant",{panelId:n.currentPanel,variant:Object(Wi["a"])(s.variants,i.background.variant,o)})},delete:function(t,e){var n=t.state,r=t.dispatch,a=t.commit,o=e.panelId;if(!(n.panelOrder.length<=1)){var i,c=n.panelOrder.indexOf(o);i=c===n.panelOrder.length-1?c-1:c+1,a("setCurrentPanel",{panelId:n.panelOrder[i]}),a("setPanelOrder",{panelOrder:[].concat(Object(On["a"])(n.panelOrder.slice(0,c)),Object(On["a"])(n.panelOrder.slice(c+1)))}),r("objects/deleteAllOfPanel",{panelId:o},{root:!0}),a("deletePanel",{panelId:o})}},fixContentPackRemoval:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c,s,u,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.state,a=t.rootGetters,o=t.commit,i=t.rootState,c=function(){var t=u[s],n=e.backgrounds.find((function(e){return e.id===t.background.current}));if(!n)return{v:void 0};var r=a["content/getBackgrounds"].get(t.background.current);if(!r)return i.content.current.backgrounds[0]?o("setCurrentBackground",{current:i.content.current.backgrounds[0].id,panelId:t.id}):o("setCurrentBackground",{current:"buildin.transparent",panelId:t.id}),{v:void 0};var c=JSON.stringify(n.variants[t.background.variant]),l=r.variants.findIndex((function(t){return JSON.stringify(t)===c}));l!==t.background.variant&&o("setBackgroundVariant",{variant:-1===l?0:l,panelId:t.id})},s=0,u=Object.values(r.panels);case 3:if(!(s<u.length)){n.next=10;break}if(l=c(),"object"!==Object(Ni["a"])(l)){n.next=7;break}return n.abrupt("return",l.v);case 7:s++,n.next=3;break;case 10:case"end":return n.stop()}}),n)})))()},move:function(t,e){var n=t.state,r=t.commit,a=e.panelId,o=e.delta,i=Object(On["a"])(n.panelOrder),c=i.indexOf(a);i.splice(c,1);var s=Math.max(c+o,0);i.splice(s,0,a),r("setPanelOrder",{panelOrder:i})},addFilter:function(t,e){var n=t.state,r=t.commit;$n(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;Hn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;Vn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},backgroundAddFilter:function(t,e){var n=t.state,r=t.commit;$n(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundRemoveFilter:function(t,e){var n=t.state,r=t.commit;Hn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundMoveFilter:function(t,e){var n=t.state,r=t.commit;Vn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundSetFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))}}},Yi=function(){function t(e,n,r,a,o,i){Object(wn["a"])(this,t),this.id=e,this.assets=n,this.flip=r,this.scale=a,this.compositeMode=o,this.filters=i}return Object(xn["a"])(t,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.assets.map((function(t){return Object(bt["a"])(t,e.hq)})));case 2:n=t.sent,r=Object(ht["a"])(n),t.prev=4,r.s();case 6:if((a=r.n()).done){t.next=31;break}if(o=a.value,o instanceof HTMLImageElement){t.next=10;break}return t.abrupt("return");case 10:i=0,c=0,s=o.width,u=o.height,t.t0=this.scale,t.next=t.t0===Li.None?17:t.t0===Li.Stretch?20:t.t0===Li.Cover?23:28;break;case 17:return i=Pe["d"]/2-s/2,c=Pe["c"]/2-u/2,t.abrupt("break",28);case 20:return s=Pe["d"],u=Pe["c"],t.abrupt("break",28);case 23:l=s/u,d=Pe["d"]/Pe["c"],l>d?(u=Pe["c"],s=u*l):(s=Pe["d"],u=s/l),i=Pe["d"]/2-s/2,c=Pe["c"]/2-u/2;case 28:e.drawImage({image:o,x:i,y:c,w:s,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters});case 29:t.next=6;break;case 31:t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](4),r.e(t.t1);case 36:return t.prev=36,r.f(),t.finish(36);case 39:case"end":return t.stop()}}),t,this,[[4,33,36,39]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),Ki={id:"buildin.static-color",name:"Static color",color:"#000000",render:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.drawRect({x:0,y:0,w:Pe["d"],h:Pe["c"],fill:{style:e.color}});case 1:case"end":return n.stop()}}),n)})))()}},Xi=n("262e"),Ji=n("2caf"),Qi=n("4a6f"),Zi=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(t){var r;return Object(wn["a"])(this,n),r=e.call(this,t),r.canvasHeight=0,r.canvasWidth=0,r.init(),r}return Object(xn["a"])(n,[{key:"init",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.ready=new Promise((function(t,n){e=t})),t.next=3,Promise.all(this.obj.assets.map((function(t){return Object(bt["a"])(t)})));case 3:n=t.sent,r=0,a=0,o=Object(ht["a"])(n);try{for(o.s();!(i=o.n()).done;)c=i.value,c instanceof HTMLImageElement&&(c.height>a&&(a=c.height),c.width>r&&(r=c.width))}catch(s){o.e(s)}finally{o.f()}this.canvasWidth=r,this.canvasHeight=a,this.assets=[{loaded:!0,assets:n,offset:[0,0]}],e();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAssetList",value:function(){return this.assets||[]}},{key:"version",get:function(){return null===this.assets?-1:this.obj.version}},{key:"zoom",get:function(){return this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1}},{key:"width",get:function(){return this.obj.width}},{key:"height",get:function(){return this.obj.height}}]),n}(Qi["a"]),tc=n("1a7b"),ec=n("45eb"),nc=n("7e84"),rc=n("fd0b");function ac(t,e,n,r,a,o){r<0&&(r=0),a<0&&(a=0),r<2*o&&(o=r/2),a<2*o&&(o=a/2),t.moveTo(e+o,n),t.arcTo(e+r,n,e+r,n+a,o),t.arcTo(e+r,n+a,e,n+a,o),t.arcTo(e,n+a,e,n,o),t.arcTo(e,n,e+r,n,o),t.closePath()}function oc(t,e,n,r,a,o){r<0&&(r=0),a<0&&(a=0),r<2*o&&(o=r/2),a<2*o&&(o=a/2),t.moveTo(e+o,n),t.arcTo(e+r,n,e+r,n+a,o),t.lineTo(e+r,n+a),t.lineTo(e,n+a),t.arcTo(e,n,e+r,n,o),t.closePath()}var ic=n("4265"),cc=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(){var t;return Object(wn["a"])(this,n),t=e.apply(this,arguments),t.lastWidth=-1,t.lastHeight=-1,t.lastX=-1,t.lastY=-1,t.lastFlip=null,t.canvasHeight=Pe["c"],t.canvasWidth=Pe["d"],t.canvasDrawHeight=Pe["c"],t.canvasDrawWidth=Pe["d"],t.canvasDrawPosX=0,t.canvasDrawPosY=0,t}return Object(xn["a"])(n,[{key:"getRenderRotation",value:function(){return[0,void 0]}},{key:"needsRedraw",value:function(){return!!Object(ec["a"])(Object(nc["a"])(n.prototype),"needsRedraw",this).call(this)||(this.width!==this.lastWidth||this.height!==this.lastHeight||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip)}},{key:"updateLocalCanvas",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip,t.next=7,Object(ec["a"])(Object(nc["a"])(n.prototype),"updateLocalCanvas",this).call(this,e);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderLocal",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.rotation){t.next=2;break}return t.abrupt("return",this.draw(e));case 2:return t.next=4,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var r,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.getHitbox(),a=r.x0+(r.x1-r.x0)/2,o=r.y0+(r.y1-r.y0)/2,i=n.flip?Pe["d"]-a:a,e.translate(i,o),e.rotate(n.rotation),e.translate(-i,-o);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.draw.bind(this));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getHitbox",value:function(){var t=this.centeredVertically,e=this.width/2,n=this.height/2;return{x0:this.x-e,x1:this.x+e,y0:t?this.y-n:this.y,y1:t?this.y+n:this.y+this.height}}},{key:"centeredVertically",get:function(){return!1}}]),n}(ic["a"]),sc=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(){var t;return Object(wn["a"])(this,n),t=e.apply(this,arguments),t.refObject=null,t}return Object(xn["a"])(n,[{key:"updatedContent",value:function(t,e){Object(ec["a"])(Object(nc["a"])(n.prototype),"updatedContent",this).call(this,t,e);var r=this.obj.talkingObjId;if(null!==r&&"$other$"!==r){var a=t.state.objects.objects[r];if(a)return void(this.refObject=a)}this.refObject=null}},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.width,r=this.height,a=n/2,o=this.flip?Pe["d"]-this.obj.x:this.obj.x,i=o-a,c=this.obj.y,t.next=8,this.renderBackdrop(e,i,c+Mr);case 8:if(null===this.obj.talkingObjId){t.next=12;break}return u="$other$"===this.obj.talkingObjId?this.obj.talkingOther:(null===(s=this.refObject)||void 0===s?void 0:s.label)||"Missing name",t.next=12,this.renderNamebox(e,i+Wr,c,u);case 12:return t.next=14,this.renderText(e,i,c,this.obj.autoWrap?n:0);case 14:if(l=c+r,d=l-zr,p=i+n/2,this.obj.controls&&(e.drawText(Object(Zt["a"])({text:"History",x:p+qr,y:d},this.controlsStyle)),e.drawText(Object(Zt["a"])({text:"Skip",x:p+Gr,y:d},this.obj.skip?this.controlsStyle:this.controlsDisableStyle)),e.drawText(Object(Zt["a"])({text:"Auto   Save   Load   Settings",x:p+Yr,y:d},this.controlsStyle))),!this.obj.continue){t.next=27;break}return t.t0=e,t.next=22,Object(bt["b"])("next");case 22:t.t1=t.sent,t.t2=i+n-Kr,t.t3=l-Xr,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 27:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderNamebox",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,a){var o,i,c,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=Mr,c=ta,"custom"!==this.forcedStyle){t.next=9;break}return c=Object(Zt["a"])(Object(Zt["a"])({},c),{},{strokeColor:this.nameboxOutlineColor,strokeWidth:6,color:"#FFFFFF"}),o=this.nameboxWidth,t.next=7,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),oc(e,n,r,o,i,Sr),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var a,o,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.linearGradient(n,r,n,r+Mr),o=Sn.fromCss(l.nameboxBackgroundColor),c=new Sn(o.r,o.g,o.b,.95),s=c.toHSL().shift(Cr).toRgb(),a.addColorStop(0,c.toCss()),a.addColorStop(xr,c.toCss()),a.addColorStop(1,s.toCss()),e.drawRect({x:n,y:r,w:l.obj.width,h:i,fill:{style:a}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:t.next=22;break;case 9:if("none"===this.forcedStyle){t.next=21;break}return o=this.nameboxWidth,t.t0=e,t.next=14,Object(bt["b"])("namebox");case 14:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4),t.next=22;break;case 21:o=this.nameboxWidth;case 22:return s=new dr(a,c),t.next=25,s.loadFonts();case 25:s.fixAlignment("center",n,n+o,r+Ur,0),s.render(e.fsCtx);case 27:case"end":return t.stop()}}),t,this)})));function e(e,n,r,a){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var a,o,i,c,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("custom"!==this.forcedStyle){t.next=10;break}return a=Sn.fromCss(this.customColor).toHSL(),o=new rc["a"](Dr,Dr),o.render(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,_r,_r,0,0,2*Math.PI)},fill:n})},n={style:a.shift(Ar).toRgb().toCss()},r(0,0),r(Dr,0),r(0,Dr),r(Dr,Dr),r(Dr/2,Dr/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),t.next=6,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),ac(e,n+Pr,r+Pr,s.obj.width-2*Pr,s.obj.height-2*Pr,Rr),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var a,i,c,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=s.obj.height,i=s.obj.width,c=e.linearGradient(n,r,n,r+a),l=Sn.fromHex(s.customColor),c.addColorStop(0,l.toCss()),c.addColorStop(1,"rgba(".concat(l.r,",").concat(l.g,",").concat(l.b,",0.6667)")),e.drawRect({x:n,y:r,w:i,h:a,fill:{style:c},outline:{style:"#ffdfee",width:6}}),t.next=9,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.translate(n,r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.patternFrom(o),e.drawRect({x:0,y:0,w:i,h:a,fill:{style:r},composition:"source-atop"});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:d=e.linearGradient(n,r+a-Qr,n,r+a),d.addColorStop(0,"rgba(255,255,255,0.3137)"),d.addColorStop(.5,"rgba(255,255,255,0.0627)"),d.addColorStop(1,"rgba(255,255,255,0)"),e.drawPath({path:function(t){t.ellipse(n+i/2,r+a,Jr,Qr,0,0,2*Math.PI)},fill:{style:d}});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:i=a.shift($r).toRgb().toCss(),e.drawPath({path:function(t){ac(t,n+Pr,r+Pr,s.obj.width-2*Pr,s.obj.height-2*Pr,Rr)},outline:{style:i,width:3}}),t.next=16;break;case 10:if("none"===this.forcedStyle){t.next=16;break}return"corrupt"===this.forcedStyle&&(n+=(Hr-Vr)/2),t.next=14,Object(bt["b"])("corrupt"===this.forcedStyle?"textbox_monika":"textbox");case 14:c=t.sent,e.drawImage({image:c,x:n,y:r});case 16:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,a){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=new dr(this.obj.text,{alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2}),this.obj.autoQuoting&&null!==this.obj.talkingObjId&&o.quote(),t.next=4,o.loadFonts();case 4:o.fixAlignment("left",n+Fr,0,r+Mr+Lr,a-Fr-Fr),o.render(e.fsCtx);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n,r,a){return t.apply(this,arguments)}return e}()},{key:"width",get:function(){return"custom"===this.obj.style?this.obj.width:Hr}},{key:"height",get:function(){return("custom"===this.obj.style?this.obj.height:Br)+Mr}},{key:"forcedStyle",get:function(){return"normal"===this.obj.style&&this.refObject&&(this.refObject.textboxColor||null!==this.refObject.nameboxWidth)?"custom":this.obj.style}},{key:"customColor",get:function(){return this.obj.overrideColor?this.obj.customColor:this.refObject&&this.refObject.textboxColor?this.refObject.textboxColor:jr}},{key:"controlColor",get:function(){if(this.obj.deriveCustomColors){var t=Sn.fromCss(this.customColor).toHSL();return t.shift(Ir).toRgb().toCss()}return this.obj.customControlsColor}},{key:"controlsStyle",get:function(){return"custom"!==this.forcedStyle?ea:Object(Zt["a"])(Object(Zt["a"])({},ea),{},{fill:{style:this.controlColor}})}},{key:"controlsDisableStyle",get:function(){if("custom"!==this.forcedStyle)return na;var t=Sn.fromCss(this.controlColor).toHSL(),e=t.shift(Tr).toRgb().toCss();return Object(Zt["a"])(Object(Zt["a"])({},ea),{},{fill:{style:e}})}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=Sn.fromCss(this.customColor).toHSL();return t.shift(yr).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=Sn.fromCss(this.customColor).toHSL();return t.shift(wr).toRgb().toCss()}return this.obj.customNameboxColor}},{key:"nameboxWidth",get:function(){return"custom"!==this.forcedStyle?Nr:this.refObject&&null!==this.refObject.nameboxWidth?this.refObject.nameboxWidth:null!==this.obj.customNameboxWidth?this.obj.customNameboxWidth:Nr}}]),n}(cc),uc=(new Cn(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),"#ffe6f4"),lc="#ffbde1",dc=420,pc=22,hc=270,bc=7,fc=(Pe["c"]-hc)/2,vc={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},mc=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(){var t;return Object(wn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t.choiceRenderers=[],t}return Object(xn["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.updateChoiceBounds();case 2:console.log("rerender choice"),n=this.obj.width,r=this.height,a=n/2,o=this.flip?Pe["d"]-this.obj.x:this.obj.x,i=o-a,c=this.obj.y-r/2,s=Object(ht["a"])(this.choiceRenderers),t.prev=10,s.s();case 12:if((u=s.n()).done){t.next=23;break}return l=u.value,t.next=16,l.loadFonts();case 16:d=l.getHeight(this.obj.autoWrap?this.obj.width:0),e.drawRect({x:i,y:c,w:n,h:d+2*bc,outline:{style:lc,width:3},fill:{style:uc}}),l.fixAlignment("center",i,i+n,c+1.25*pc,this.obj.autoWrap?n:0),l.render(e.fsCtx),c+=d+2*bc+pc;case 21:t.next=12;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](10),s.e(t.t0);case 28:return t.prev=28,s.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[10,25,28,31]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateChoiceBounds",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.choiceRenderers=this.obj.choices.map((function(t){return new dr(t.text||" ",vc)})),this._height=this.choiceRenderers.reduce((function(t,n){return t+n.getHeight(e.obj.autoWrap?e.obj.width:0)+2*bc}),0)+this.obj.choiceDistance*(this.obj.choices.length-1);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"centeredVertically",get:function(){return!0}}]),n}(cc),jc="rgba(255,255,255,0.6)",gc=40,Oc=30,kc=Object(Zt["a"])(Object(Zt["a"])({},Zr),{},{fontName:"riffic",fontSize:24,strokeColor:kr,strokeWidth:8,letterSpacing:1,color:"white"}),yc={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},wc=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(){var t;return Object(wn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(xn["a"])(n,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.obj.backdrop&&r.drawRect({x:0,y:0,w:Pe["d"],h:Pe["c"],fill:{style:jc}}),t.next=3,Object(ec["a"])(Object(nc["a"])(n.prototype),"render",this).call(this,e,r);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,s,u,l,d,p,h,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new dr(this.obj.text,yc),r=new dr("OK",kc),t.next=4,n.loadFonts();case 4:return t.next=6,r.loadFonts();case 6:a=this.obj.autoWrap?this.obj.width-2*gc:0,o=this.obj.autoWrap?a:n.getWidth(),i=n.getHeight(a),c=this.obj.autoWrap?a:r.getWidth(),s=r.getHeight(a),u=this._width=Math.max(o,c)+2*gc,l=this._height=i+2*gc+Oc+s,d=u/2,p=this.flip?Pe["d"]-this.obj.x:this.obj.x,h=p-d,b=this.obj.y-l/2,e.drawRect({x:h,y:b,w:u,h:l,outline:{style:lc,width:3},fill:{style:uc}}),n.fixAlignment("center",h,h+u,b+1.5*gc,a),n.render(e.fsCtx),r.fixAlignment("center",h,h+u,b+l-gc,a),r.render(e.fsCtx);case 22:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}},{key:"id",get:function(){return this.obj.id}}]),n}(cc),xc=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Cc=0,Sc=0,Rc=Pe["d"]/2,Pc=Pe["c"]/2,Ic=33,Tc=30,Ac=800,_c=720,Dc="rgba(51,51,51,0.75)",$c=480,Hc=180,Vc=3,Bc=7,Ec={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Fc=[Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Monika",fontName:"journal",fontSize:34}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),Object(Zt["a"])(Object(Zt["a"])({},Ec),{},{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],Lc=-2,Mc=26,Nc=10,Wc=10,Uc=function(t){Object(Xi["a"])(n,t);var e=Object(Ji["a"])(n);function n(){var t;return Object(wn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(xn["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c,s,u,l,d,p,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=xc[this.obj.background],r=this.flip?Pe["d"]-this.obj.x:this.obj.x,a=this.obj.y,o=r+Wc,i=Tc,c=Ic,s=2*i,"internal:console"!==n.file){t.next=16;break}u=this._height=this.obj.height,l=this._width=this.obj.width,e.drawRect({x:r-l/2,y:this.obj.y-u/2,h:u,w:l,fill:{style:Dc}}),i=Lc,c=Mc,s=Nc,t.next=25;break;case 16:if("internal:transparent"!==n.file){t.next=21;break}this._height=this.obj.height,this._width=this.obj.width,t.next=25;break;case 21:return t.next=23,Object(bt["c"])("assets/poemBackgrounds/".concat(n.file));case 23:d=t.sent,d instanceof HTMLImageElement&&(e.drawImage({image:d,x:r-d.width/2,y:this.obj.y-d.height/2}),this._height=d.height,this._width=d.width);case 25:return a-=this.height/2,o-=this.width/2,p=Fc[this.obj.font],h=new dr(this.obj.text,p),t.next=31,h.loadFonts();case 31:h.fixAlignment("left",o+i,o+i,a+c+i,this.obj.autoWrap?this.width-s:0),h.render(e.fsCtx);case 33:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}}]),n}(cc),zc=function(){function t(e,n,r,a){Object(wn["a"])(this,t),this.store=e,this.panelId=n,this.canvasWidth=r,this.canvasHeight=a,this.renderObjectCache=new Map,this.lCurrentlyRendering=!1,this.renderer=new rc["a"](r,a)}return Object(xn["a"])(t,[{key:"render",value:function(t,e){return this.panel?this.renderer.render(this.renderCallback.bind(this),t,e):Promise.resolve(!1)}},{key:"download",value:function(){var t=new Date,e="panel-".concat([t.getFullYear(),"".concat(t.getMonth()+1).padStart(2,"0"),"".concat(t.getDate()).padStart(2,"0"),"".concat(t.getHours()).padStart(2,"0"),"".concat(t.getMinutes()).padStart(2,"0"),"".concat(t.getSeconds()).padStart(2,"0")].join("-"),".png");return this.renderer.download(this.renderCallback.bind(this),e)}},{key:"paintOnto",value:function(t,e){this.renderer.paintOnto(t,e)}},{key:"objectsAt",value:function(t,e){return this.getRenderObjects().filter((function(n){return n.hitTest(t,e)})).map((function(t){return t.id}))}},{key:"renderCallback",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lCurrentlyRendering=!0,t.prev=1,e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",t.next=6,null===(n=this.getBackgroundRenderer())||void 0===n?void 0:n.render(e);case 6:r=this.store.state.ui.selection,a=Object(ht["a"])(this.getRenderObjects()),t.prev=8,a.s();case 10:if((o=a.n()).done){t.next=18;break}return i=o.value,c=!1,i instanceof ic["a"]&&(i.updatedContent(this.store,this.panelId),c=r===i.id),t.next=16,i.render(c,e);case 16:t.next=10;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](8),a.e(t.t0);case 23:return t.prev=23,a.f(),t.finish(23);case 26:if(e.applyFilters(Object(On["a"])(this.panel.filters)),!e.preview){t.next=34;break}return t.t1=e,t.next=31,Object(bt["b"])("backgrounds/transparent");case 31:t.t2=t.sent,t.t3={x:0,y:0,composite:"destination-over",image:t.t2},t.t1.drawImage.call(t.t1,t.t3);case 34:return t.prev=34,this.lCurrentlyRendering=!1,t.finish(34);case 37:case"end":return t.stop()}}),t,this,[[1,,34,37],[8,20,23,26]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRenderObjects",value:function(){var t,e=this,n=this.store.state.objects.panels[this.panelId],r=n?[].concat(Object(On["a"])(n.order),Object(On["a"])(n.onTopOrder)):[],a=this.store.state.objects.objects,o=Object.keys(this.renderObjectCache).filter((function(t){return!r.includes(t)})),i=Object(ht["a"])(o);try{for(i.s();!(t=i.n()).done;){var c=t.value;this.renderObjectCache.delete(c)}}catch(s){i.e(s)}finally{i.f()}return r.map((function(t){var n=e.renderObjectCache.get(t);if(!n){var r=a[t];switch(r.type){case"sprite":n=new Zi(r);break;case"character":var o=r;n=new tc["a"](o,Object(Ht["e"])(e.store,o));break;case"textBox":n=new sc(r);break;case"choice":n=new mc(r);break;case"notification":n=new wc(r);break;case"poem":n=new Uc(r);break}e.renderObjectCache.set(t,n)}return n}))}},{key:"getBackgroundRenderer",value:function(){var t=this.panel;switch(t.background.current){case"buildin.static-color":return Ki.color=t.background.color,Ki;default:var e=this.store.getters["content/getBackgrounds"],n=e.get(t.background.current);if(!n)return null;var r=n.variants[t.background.variant];return r?new Yi(t.background.current,r,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters):null}}},{key:"currentlyRendering",get:function(){return this.lCurrentlyRendering}},{key:"panel",get:function(){return this.store.state.panels.panels[this.panelId]}}]),t}(),qc=n("0c0f"),Gc=1.5,Yc=1/4,Kc=.5,Xc=100,Jc=90,Qc=70,Zc=Object(r["m"])({mixins:[q],components:{DFieldset:Vt["a"],DFlow:ee,DButton:kt,ImageOptions:Mn},data:function(){return{webpSupport:!1,heifSupport:!1,ppi:0,pages:"",format:"image/png",quality:Jc,imageOptions:!1}},computed:{currentPanel:function(){return this.$store.state.panels.currentPanel},isLossy:function(){return"image/png"!==this.format},canDeletePanel:function(){return this.panelButtons.length>1},panelButtons:function(){var t=this,e=this.$store.state.panels.panelOrder;return e.map((function(e){var n=t.$store.state.panels.panels[e],r=t.$store.state.objects.panels[e],a=r?[].concat(r.order,r.onTopOrder).map((function(e){return t.$store.state.objects.objects[e]})).map(t.extractObjectText):[];return{id:e,image:n.lastRender,text:a.reduce((function(t,e){return t.length>e.length?t:e}),"")}}))},canMoveAhead:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e>0},canMoveBehind:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e<t.length-1}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(bt["e"])(),Object(bt["d"])()]);case 2:n=e.sent,r=Object(l["a"])(n,2),t.webpSupport=r[0],t.heifSupport=r[1];case 6:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.moveFocusToActivePanel(),t.renderThumbnail();case 2:case"end":return e.stop()}}),e)})))()},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=new Date,a="cd-".concat([r.getFullYear(),"".concat(r.getMonth()+1).padStart(2,"0"),"".concat(r.getDate()).padStart(2,"0"),"".concat(r.getHours()).padStart(2,"0"),"".concat(r.getMinutes()).padStart(2,"0"),"".concat(r.getSeconds()).padStart(2,"0")].join("-")),o=t.format.split("/")[1],i=t.format,c=t.quality,e.next=8,t.renderObjects(n,!0,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:G["a"].saveToFile(n,"".concat(a,"_").concat(e,".").concat(o),i,c/Xc);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))()},estimateExportSize:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=t.format||"image/png",a=t.quality||Jc,e.next=5,t.renderObjects(n,!1,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,o){n.toBlob((function(n){n?t(n.size):o("Image ".concat(e+1," could not be rendered."))}),r,a/Xc)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 5:o=e.sent,i=o.map((function(t){return(t*Gc/1024/1024).toFixed(2)+"MiB"})),c=i.length>1?"files":"file",s=i.length>1?"These":"It",l=i.length>1?"sizes":"size",qc["f"].fire(new qc["d"]("This would export ".concat(i.length," ").concat(c,". ").concat(s," would have the following (aproximate) ").concat(l,": ").concat(i.join(","))));case 11:case"end":return e.stop()}}),e)})))()},renderObjects:function(t,e,n){var r=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(t.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(a,o){var i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=document.createElement("canvas"),i.width=Pe["d"],i.height=Pe["c"]*a.length,c=i.getContext("2d"),t.next=6,Promise.all(a.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n,o){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new zc(r.$store,a[o],Pe["d"],Pe["c"]),t.next=3,i.render(e,!1);case 3:i.paintOnto(c,{x:0,y:Pe["c"]*o,w:Pe["d"],h:Pe["c"]});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:return t.next=8,n(o,i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))()},getLimitedPanelList:function(){var t,e=this,n=this.$store.state.panels.panelOrder.length-1,r=0,a=this.pages.split(","),o=[],i=!1,c=Object(ht["a"])(a);try{for(c.s();!(t=c.n()).done;){var s=t.value,u=s.trim(),l=u.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(l)if(i=!0,l[2])o.push(parseInt(l[2],10)-1);else{var d=Math.max(parseInt(l[3],10)-1,r),p=Math.min(parseInt(l[4],10)-1,n);if(void 0===d||void 0===p||d>p)continue;for(var h=d;h<=p;++h)o.push(h)}else""!==u&&qc["f"].fire(new qc["d"]("Could not read '".concat(s,"' in the page list.")))}}catch(b){c.e(b)}finally{c.f()}return i?o.sort((function(t,e){return t-e})).filter((function(t,e,n){return n[e-1]!==t})).map((function(t){return e.$store.state.panels.panelOrder[t]})):this.$store.state.panels.panelOrder},getPanelDistibution:function(){var t=this.getLimitedPanelList();if(0===this.ppi)return[t];for(var e=[],n=0;n<t.length/this.ppi;++n){var r=n*this.ppi,a=r+this.ppi;e.push(Object(On["a"])(t.slice(r,a)))}return e},moveFocusToActivePanel:function(){var t=this.$el.querySelector(".panel_button.active");t&&this.scrollIntoView(t)},scrollIntoView:function(t){var e=t.parentElement.parentElement,n=Array.from(t.parentElement.children).indexOf(t);if(this.$store.state.ui.vertical){var r=n*t.clientHeight-e.clientHeight/2+t.clientHeight/2;e.scrollTop=r,e.scrollLeft=0}else{var a=n*t.clientWidth-e.clientWidth/2+t.clientWidth/2;e.scrollLeft=a,e.scrollTop=0}},extractObjectText:function(t){switch(t.type){case"textBox":return t.text;case"notification":return t.text;case"poem":return t.text;case"choice":return t.choices.map((function(t){return"[".concat(t.text,"]")})).join("\n")}return""},addNewPanel:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/duplicatePanel",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)}))));case 2:t.$nextTick((function(){t.moveFocusToActivePanel()}));case 3:case"end":return e.stop()}}),e)})))()},updateCurrentPanel:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("panels/setCurrentPanel",{panelId:t});case 1:case"end":return n.stop()}}),n)})))),this.$nextTick((function(){e.moveFocusToActivePanel()}))},deletePanel:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/delete",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)})))),this.$nextTick((function(){t.moveFocusToActivePanel()}))},moveAhead:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:-1})}))},moveBehind:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:1})}))},renderThumbnail:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new zc(t.$store,t.currentPanel,Pe["d"],Pe["c"]),e.next=3,n.render(!1,!0);case 3:return r=document.createElement("canvas"),r.width=Pe["d"]*Yc,r.height=Pe["c"]*Yc,n.paintOnto(r.getContext("2d"),{x:0,y:0,w:r.width,h:r.height}),e.t0=r,e.t1=function(e){if(e){var n=URL.createObjectURL(e);t.vuexHistory.transaction((function(){t.$store.commit("panels/setPanelPreview",{panelId:t.$store.state.panels.currentPanel,url:n})}))}},e.next=11,Object(bt["e"])();case 11:if(!e.sent){e.next=15;break}e.t2="image/webp",e.next=16;break;case 15:e.t2="image/jpeg";case 16:e.t3=e.t2,e.t4=Kc,e.t0.toBlob.call(e.t0,e.t1,e.t3,e.t4);case 19:case"end":return e.stop()}}),e)})))()}},watch:{quality:function(t,e){t!==Xc?e>Qc&&t<=Qc&&qc["f"].fire(new qc["d"]("Note: A quality level below 70% might be very noticable and impair legibility of text.")):qc["f"].fire(new qc["d"]("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."))}}});n("51b0");Zc.render=Mi,Zc.__scopeId="data-v-2ffec108";var ts=Zc,es=Object(r["F"])("data-v-618f75f2");Object(r["r"])("data-v-618f75f2");var ns={id:"notification_text"},rs=Object(r["k"])("label",{for:"notification_text"},"Text:",-1);Object(r["q"])();var as=es((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"Notification",textHandler:t.textHandler},{default:es((function(){return[Object(r["k"])("div",ns,[rs,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),id:"notification_text",onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")])]})),options:es((function(){return[Object(r["k"])(c,{modelValue:t.renderBackdrop,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.renderBackdrop=e}),label:"Show backdrop?"},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),os=ae(),is=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ObjectTool:sa},data:function(){return{textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("notification"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:os("text","objects/setNotificationText"),autoWrap:os("autoWrap","objects/setAutoWrapping"),renderBackdrop:os("backdrop","objects/setNotificationBackdrop")}});n("28de");is.render=as,is.__scopeId="data-v-618f75f2";var cs=is,ss=Object(r["F"])("data-v-2a8686c0");Object(r["r"])("data-v-2a8686c0");var us={id:"poem_text"},ls=Object(r["k"])("label",{for:"poem_text"},"Text:",-1);Object(r["q"])();var ds=ss((function(t,e,n,a,o,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"poem"===t.object.subType?"Poem":"Console",textHandler:t.textHandler},{default:ss((function(){return[Object(r["k"])("div",us,[ls,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),"poem"===t.object.subType?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.poemBackground=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemBackground]]),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.poemStyle=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.poemTextStyles,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemStyle]])],64)):Object(r["h"])("",!0)]})),_:1},8,["object","title","textHandler"])})),ps=ae(),hs=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ObjectTool:sa},data:function(){return{textEditor:!1}},computed:{backgrounds:function(){return xc},poemTextStyles:function(){return Fc},object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("poem"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:ps("text","objects/setPoemText"),autoWrap:ps("autoWrap","objects/setAutoWrapping"),poemStyle:ps("font","objects/setPoemFont"),poemBackground:ps("background","objects/setPoemBackground")}});n("dddf");hs.render=ds,hs.__scopeId="data-v-2a8686c0";var bs=hs,fs=Object(r["m"])({components:{SettingsPanel:et,AddPanel:xt,BackgroundsPanel:ci,CreditsPanel:Ao,CharacterPanel:da,TextBoxPanel:Ma,ChoicePanel:Ya,SpritePanel:ba,ContentPacksPanel:ji,PanelsPanel:ts,NotificationPanel:cs,PoemPanel:bs},data:function(){return{panelSelection:"add"}},computed:{vertical:function(){return this.$store.state.ui.vertical},selection:function(){return this.$store.state.ui.selection},panel:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection="add"}return this.panelSelection},hasPrevRender:function(){return null!==this.$store.state.ui.lastDownload}},methods:{create:function(){var t=this;G["a"].onPanelChange((function(e){t.panelSelection=e}))},setPanel:function(t){if(t===this.panelSelection&&(t="add"),this.panelSelection=t,this.selection){if(null===this.$store.state.ui.selection)return;this.$store.commit("ui/setSelection",null)}}},watch:{selection:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="add")}}});n("c53c");fs.render=k;var vs=fs,ms=Object(r["F"])("data-v-51633a54");Object(r["r"])("data-v-51633a54");var js={key:0};Object(r["q"])();var gs=ms((function(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("div",{id:"messageConsole",class:{vertical:t.vertical}},[t.showLoading?(Object(r["p"])(),Object(r["g"])("p",js,"Loading...")):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.messages,(function(t,e){return Object(r["p"])(),Object(r["g"])("p",{key:t+"_"+e},Object(r["x"])(t),1)})),128))],2)})),Os=5e3,ks=2e4,ys=100,ws=Object(r["m"])({props:{loading:{default:!1,type:Boolean}},data:function(){return{messages:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}},computed:{vertical:function(){return this.$store.state.ui.vertical}},created:function(){var t=this;this.onLoadingChange(this.loading),qc["f"].subscribe(qc["a"],(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.shift()}),Os)})),qc["f"].subscribe(qc["b"],(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.shift()}),ks)})),qc["f"].subscribe(qc["d"],(function(e){t.messages.push(e.message),setTimeout((function(){t.messages.shift()}),ks)})),qc["f"].subscribe(qc["e"],(function(e){t.messages.push(e.error.name),t.messages.push(JSON.stringify(e.error.stack)),t.messages.push(e.info),setTimeout((function(){t.messages.shift(),t.messages.shift(),t.messages.shift()}),ks)}))},methods:{onLoadingChange:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),ys))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),ys)))}},watch:{loading:function(t){this.onLoadingChange(t)}}});n("13f8");ws.render=gs,ws.__scopeId="data-v-51633a54";var xs=ws;function Cs(t,e,n,a,o,i){return Object(r["p"])(),Object(r["g"])("canvas",{id:"scaled_display",ref:"sd",height:t.bitmapHeight,width:t.bitmapWidth,style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px"},draggable:"true",onClick:e[1]||(e[1]=function(){return t.onUiClick.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.onTouchStart.apply(t,arguments)}),onDragstart:e[3]||(e[3]=function(){return t.onDragStart.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onMousemove:e[5]||(e[5]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.onSpriteDrop.apply(t,arguments)}),onMouseup:e[7]||(e[7]=function(){return t.onSpriteDrop.apply(t,arguments)}),onDragover:e[8]||(e[8]=function(){return t.onDragOver.apply(t,arguments)}),onDrop:e[9]||(e[9]=function(){return t.onDrop.apply(t,arguments)}),onMouseenter:e[10]||(e[10]=function(){return t.onMouseEnter.apply(t,arguments)})},"HTML5 is required to use the Doki Doki Dialog Generator.",44,["height","width"])}var Ss=n("6ae4"),Rs=Object(r["m"])({props:{canvasWidth:{default:0},canvasHeight:{default:0}},data:function(){return{sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0}},computed:{selection:function(){return this.$store.state.ui.selection},lqRendering:function(){return this.$store.state.ui.lqRendering},sceneRender:function(){return new zc(this.$store,this.$store.state.panels.currentPanel,this.bitmapWidth,this.bitmapHeight)},bitmapHeight:function(){return Pe["c"]},bitmapWidth:function(){return Pe["d"]}},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.sceneRender.download();case 2:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.$store.state.ui.lastDownload,t.$store.commit("ui/setLastDownload",n),r&&URL.revokeObjectURL(r);case 3:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})))()},invalidateRender:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))},render_:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.queuedRender&&(cancelAnimationFrame(t.queuedRender),t.queuedRender=null),!t.$store.state.unsafe){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.sceneRender.render(!t.lqRendering,!0);case 5:t.display();case 6:case"end":return e.stop()}}),e)})))()},renderLoadingScreen:function(){if(this.sdCtx){var t=document.createElement("canvas");t.height=this.bitmapHeight,t.width=this.bitmapWidth;var e=Ss["a"].make(t,!0,!1);e.drawText({text:"Starting...",x:t.width/2,y:t.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(t,this.canvasWidth,this.canvasHeight)}},display:function(){this.sdCtx&&(this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,{x:0,y:0,w:this.bitmapWidth,h:this.bitmapHeight}))},toRendererCoordinate:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,a=e-n.offsetTop,o=r/n.offsetWidth*n.width,i=a/n.offsetWidth*n.width;return[o,i]},onUiClick:function(t){var e=this;if(this.dropPreventClick)this.dropPreventClick=!1;else{var n,r=this.toRendererCoordinate(t.clientX,t.clientY),a=Object(l["a"])(r,2),o=a[0],i=a[1],c=this.sceneRender.objectsAt(o,i),s=c.findIndex((function(t){return t===e.selection}));n=0===s?null:-1!==s?c[s-1]:c[c.length-1]||null,this.$store.state.ui.selection!==n&&this.$store.commit("ui/setSelection",n)}},onDragStart:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(l["a"])(e,2),r=n[0],a=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=a-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onTouchStart:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(l["a"])(e,2),r=n[0],a=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=a-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},onSpriteDragMove:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(l["a"])(n,2),a=r[0],o=r[1];a-=this.dragXOffset,o-=this.dragYOffset;var i=Math.abs(a-this.dragXOriginal),c=Math.abs(o-this.dragYOriginal);i+c>1&&(this.dropPreventClick=!0),t.shiftKey&&(i>c?o=this.dragYOriginal:a=this.dragXOriginal),this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:a,y:o})}))}},onDrop:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer){n.next=4;break}return n.abrupt("return");case 4:r=Object(ht["a"])(t.dataTransfer.items);try{for(r.s();!(a=r.n()).done;)o=a.value,"file"===o.kind&&o.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++e.dropSpriteCount,n=Object(bt["f"])(t,o.getAsFile());e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("objects/createSprite",{assets:[{hq:n,lq:n,sourcePack:"dddg.generated.uploaded-sprites"}]});case 2:case"end":return t.stop()}}),t)}))))}()}catch(i){r.e(i)}finally{r.f()}case 6:case"end":return n.stop()}}),n)})))()},onSpriteDrop:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter:function(t){1!==t.buttons&&(this.draggedObject=null)}},watch:{canvasWidth:function(){this.display()},canvasHeight:function(){this.display()}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:qc["f"].subscribe(qc["c"],(function(){return t.invalidateRender()})),t.$store.subscribe((function(e){"panels/setPanelPreview"!==e.type&&"panels/currentPanel"!==e.type&&t.invalidateRender()}));case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()}});Rs.render=Cs;var Ps=Rs,Is=n("4918"),Ts=16/9,As=20,_s=50,Ds=200,$s={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},Hs=new Set(Object.keys($s)),Vs=Object.values($s),Bs=Object(r["m"])({components:{ToolBox:vs,MessageConsole:xs,Render:Ps,ModalDialog:Q,SingleBox:Object(r["l"])((function(){return n.e("chunk-4d2ed890").then(n.bind(null,"dcb9"))})),ExpressionBuilder:Object(r["l"])((function(){return n.e("chunk-17912fef").then(n.bind(null,"d785"))}))},data:function(){return{canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0,systemPrefersDarkMode:!1}},computed:{isSafari:function(){return!1},useDarkTheme:function(){var t;return null!==(t=this.userPrefersDarkMode)&&void 0!==t?t:this.systemPrefersDarkMode},userPrefersDarkMode:function(){return this.$store.state.ui.useDarkTheme},nsfw:function(){return this.$store.state.ui.nsfw}},methods:{drawLastDownload:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)},setBlendOver:function(){this.blendOver=this.$store.state.ui.lastDownload},optimum:function(t,e){var n=t/Ts,r=e*Ts;return n>e?n=e:r=t,[r,n]},optimizeWithMenu:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return!this.isSafari&&n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]},updateArea:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(l["a"])(t,3),n=e[0],r=e[1],a=e[2];this.canvasWidth=n,this.canvasHeight=r,this.canvasTooSmall=Math.max(n,r)<Ds,this.$store.state.ui.vertical!==a&&this.$store.commit("ui/setVertical",a)},showDialog:function(t){var e=this;if(this.dialogVisable=!0,t){var n=function n(){e.$refs.packDialog&&e.$refs.packDialog.$refs.packDialog?e.$refs.packDialog.$refs.packDialog.setSearch(t):setTimeout(n,_s)};this.$nextTick(n)}},showExpressionDialog:function(t){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=t.character,this.expressionBuilderHeadGroup=t.headGroup},onKeydown:function(t){var e=this;t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement?console.log("skip keydown on potential target"):this.vuexHistory.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(t.ctrlKey){if("z"===t.key)return void t.preventDefault();if("y"===t.key)return void t.preventDefault();if("v"===t.key)return e.$store.dispatch("objects/pasteObjectFromClipboard",{}),void t.preventDefault()}if(n)if("Delete"!==t.key){if("c"===t.key||"x"===t.key)return e.$store.dispatch("objects/copyObjectToClipboard",{id:n.id}),"x"===t.key&&e.$store.dispatch("objects/removeObject",{id:n.id}),void t.preventDefault();if("character"===n.type){var r=n;if(r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var a=n.x,o=n.y;if("ArrowLeft"===t.key)a-=t.shiftKey?1:As;else if(n&&"ArrowRight"===t.key)a+=t.shiftKey?1:As;else if(n&&"ArrowUp"===t.key)o-=t.shiftKey?1:As;else{if(!n||"ArrowDown"!==t.key)return;o+=t.shiftKey?1:As}e.$store.dispatch("objects/setPosition",{id:n.id,x:a,y:o})}else e.$store.dispatch("objects/removeObject",{id:n.id})}))},destroyed:function(){window.removeEventListener("keydown",this.onKeydown)},applyTheme:function(){document.body.classList.toggle("dark-theme",this.useDarkTheme)}},watch:{systemPrefersDarkMode:function(){this.applyTheme()},userPrefersDarkMode:function(){this.applyTheme()},nsfw:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",Vs);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:Hs});case 7:case"end":return n.stop()}}),n)})))()}},mounted:function(){var t=this;if(window.addEventListener("keypress",(function(e){"Escape"===e.key&&t.vuexHistory.transaction((function(){null!==t.$store.state.ui.selection&&t.$store.commit("ui/setSelection",null)}))})),window.matchMedia){var e=window.matchMedia("(prefers-color-scheme: dark)");this.systemPrefersDarkMode=e.matches,e.addListener((function(e){t.systemPrefersDarkMode=e.matches}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateArea(),Is["a"].setStore(t.$store),window.addEventListener("resize",t.updateArea),window.removeEventListener("keydown",t.onKeydown),window.addEventListener("keydown",t.onKeydown),window.app=t,window.store=t.$store,window.env=G["a"],document.body.addEventListener("drop",(function(t){t.preventDefault()}),!0),document.body.addEventListener("dragover",(function(t){t.preventDefault()}),!0),e.next=12,G["a"].loadSettings();case 12:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r,a,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.commit("ui/setLqRendering",null!==(r=n.lq)&&void 0!==r&&r),t.$store.commit("ui/setDarkTheme",null!==(a=n.darkMode)&&void 0!==a?a:null),t.$store.commit("ui/setDefaultCharacterTalkingZoom",null===(o=n.defaultCharacterTalkingZoom)||void 0===o||o),e.next=5,t.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 5:return e.next=7,t.$store.dispatch("panels/createPanel");case 7:return 0===Object.keys(t.$store.state.objects.objects).length&&t.$store.dispatch("objects/createTextBox",{}),e.next=10,t.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:t.$store.state.panels.currentPanel});case 10:return e.next=12,t.$store.commit("ui/setNsfw",null!==(i=n.nsfw)&&void 0!==i&&i);case 12:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}}),e)})))()}});n("8f50");Bs.render=s;var Es=Bs,Fs=n("5502"),Ls=n("6289"),Ms={},Ns=0,Ws={createSprite:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.rootState,n.next=3,Object(bt["a"])(e.assets[0],!1);case 3:if(o=n.sent,o instanceof HTMLImageElement){n.next=6;break}return n.abrupt("return");case 6:r("create",{object:Object(Zt["a"])(Object(Zt["a"])({},Object(Ls["a"])()),{},{assets:e.assets,height:o.height,width:o.width,id:"sprite_"+ ++Ns,panelId:a.panels.currentPanel,onTop:!1,preserveRatio:!0,ratio:o.width/o.height,type:"sprite",y:0,enlargeWhenTalking:a.ui.defaultCharacterTalkingZoom})});case 7:case"end":return n.stop()}}),n)})))()}},Us={setChoices:function(t,e){var n=t.objects[e.id];n.choices=e.choices,++n.version},setChoiceColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setChoiceDistance:function(t,e){var n=t.objects[e.id];n.choiceDistance=e.choiceDistance,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},zs=0,qs={createChoice:function(t,e){var n=t.commit,r=t.rootState,a="choice_"+ ++zs;return n("create",{object:Object(Zt["a"])(Object(Zt["a"])({},Object(Ls["a"])()),{},{y:fc,width:dc,height:0,panelId:r.panels.currentPanel,id:a,onTop:!0,autoWrap:!0,type:"choice",preserveRatio:!1,ratio:Hr/Br,choiceDistance:pc,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:uc})}),a},addChoice:function(t,e){var n=t.state,r=t.commit,a=n.objects[e.id];r("setChoices",{id:e.id,choices:[].concat(Object(On["a"])(a.choices),[{selected:!1,text:e.text}])})},removeChoice:function(t,e){var n=t.state,r=t.commit,a=n.objects[e.id],o=Object(On["a"])(a.choices);o[e.choiceIdx]&&(o.splice(e.choiceIdx,1),0===o.length&&o.push({selected:!1,text:""}),r("setChoices",{id:e.id,choices:o}))},setChoiceText:function(t,e){var n=t.state,r=t.commit,a=n.objects[e.id],o=Object(On["a"])(a.choices);o[e.choiceIdx]&&(o[e.choiceIdx].text=e.text,r("setChoices",{id:e.id,choices:o}))}},Gs=n("8cae"),Ys=4,Ks={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingObject:function(t,e){var n=t.objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version},setResetBounds:function(t,e){var n=t.objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,++n.version},setColorOverride:function(t,e){var n=t.objects[e.id];n.overrideColor=e.overrideColor,++n.version}},Xs=0,Js={createTextBox:function(t,e){var n=t.commit,r=t.rootState,a="textBox_"+ ++Xs,o=e.resetBounds||{x:Pe["d"]/2,y:ra,width:Hr,height:Br,rotation:0};return n("create",{object:Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])({},Object(Ls["a"])()),o),{},{panelId:r.panels.currentPanel,id:a,onTop:!0,type:"textBox",preserveRatio:!1,ratio:Hr/Br,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:"normal",overrideColor:!1,customColor:jr,deriveCustomColors:!0,customControlsColor:gr,customNameboxColor:Or,customNameboxWidth:168,customNameboxStroke:kr,talkingObjId:null,talkingOther:"",text:"",resetBounds:o})}),a},setStyle:function(t,e){var n=t.commit;n("setStyle",{id:e.id,style:e.style})},resetTextboxBounds:function(t,e){var n=t.commit,r=t.state,a=r.objects[e.id];n("setPosition",{id:e.id,x:a.resetBounds.x,y:a.resetBounds.y}),n("setSize",{id:e.id,height:a.resetBounds.height,width:a.resetBounds.width}),n("setRotation",{id:e.id,rotation:a.resetBounds.rotation})},splitTextbox:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.state,o=t.dispatch,i=a.objects[e.id],c=(i.width-Ys)/2,s=c/2+Ys/2,u=[i.x,i.y],l=[i.x-s,i.y],d=[i.x+s,i.y],0!==i.rotation&&(l=Object(Gs["a"])(l[0],l[1],u[0],u[1],i.rotation/180*Math.PI),d=Object(Gs["a"])(d[0],d[1],u[0],u[1],i.rotation/180*Math.PI)),r("setResetBounds",{id:e.id,resetBounds:{x:l[0],y:l[1],width:c,height:i.height,rotation:i.rotation}}),r("setStyle",{id:e.id,style:"custom"}),n.next=12,o("createTextBox",{resetBounds:{x:d[0],y:d[1],width:c,height:i.height,rotation:i.rotation}});case 12:p=n.sent,r("setStyle",{id:p,style:"custom"}),i.flip&&r("setFlip",{id:p,flip:i.flip});case 15:case"end":return n.stop()}}),n)})))()}},Qs={setNotificationColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setNotificationText:function(t,e){var n=e.id,r=e.text,a=t.objects[n];a.text=r,++a.version},setNotificationBackdrop:function(t,e){var n=e.id,r=e.backdrop,a=t.objects[n];a.backdrop=r,++a.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Zs=0,tu={createNotification:function(t,e){var n=t.commit,r=t.rootState,a="notification_"+ ++Zs;return n("create",{object:Object(Zt["a"])(Object(Zt["a"])({},Object(Ls["a"])()),{},{y:Pe["c"]/2,width:dc,height:0,panelId:r.panels.currentPanel,autoWrap:!1,id:a,onTop:!0,type:"notification",preserveRatio:!1,ratio:Hr/Br,customColor:uc,text:"Click here to edit notification",backdrop:!0})}),a}},eu={setPoemBackground:function(t,e){var n=e.id,r=e.background,a=t.objects[n];a.background=r,++a.version},setPoemFont:function(t,e){var n=e.id,r=e.font,a=t.objects[n];a.font=r,++a.version},setPoemText:function(t,e){var n=e.id,r=e.text,a=t.objects[n];a.text=r,++a.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},nu=0,ru={createPoem:function(t,e){var n=t.commit,r=t.rootState,a="poem_"+ ++nu;return n("create",{object:{subType:"poem",x:Rc,y:Pc,width:Ac,height:_c,panelId:r.panels.currentPanel,flip:!1,rotation:0,id:a,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:Ac/_c,background:Cc,font:Sc,text:"New poem\n\nClick here to edit poem",composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null}}),a},createConsole:function(t,e){var n=t.commit,r=t.rootState,a="poem_"+ ++nu;return n("create",{object:Object(Zt["a"])(Object(Zt["a"])({},Object(Ls["a"])()),{},{subType:"console",x:$c/2,y:Hc/2,width:$c,height:Hc,panelId:r.panels.currentPanel,id:a,onTop:!0,type:"poem",preserveRatio:!1,ratio:$c/Hc,background:Vc,font:Bc,text:"> _\n  \n  Console command\n  Click here to edit",autoWrap:!0})}),a}},au=0,ou={namespaced:!0,state:{objects:{},panels:{}},mutations:Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])({create:function(t,e){var n=e.object;t.panels[n.panelId]||(t.panels[n.panelId]={id:n.panelId,onTopOrder:[],order:[]});var r=t.panels[n.panelId],a=n.onTop?r.onTopOrder:r.order;t.objects[n.id]=n,a.push(n.id)},removeFromList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],a=e.onTop?r.onTopOrder:r.order,o=a.indexOf(e.id);a.splice(o,1)},addToList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],a=e.onTop?r.onTopOrder:r.order;a.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},setRotation:function(t,e){var n=t.objects[e.id];n.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject:function(t,e){var n=t.objects[e.id];delete t.objects[e.id];var r=t.panels[n.panelId];0===r.onTopOrder.length&&0===r.order.length&&delete t.panels[n.panelId]},setComposition:function(t,e){var n=t.objects[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.objects[e.id];n.filters=e.filters},setLabel:function(t,e){var n=t.objects[e.id];n.label=e.label},setTextboxColor:function(t,e){var n=t.objects[e.id];n.textboxColor=e.textboxColor},setEnlargeWhenTalking:function(t,e){var n=t.objects[e.id];n.enlargeWhenTalking=e.enlargeWhenTalking,++n.version},setObjectNameboxWidth:function(t,e){var n=t.objects[e.id];n.nameboxWidth=e.nameboxWidth,++n.version}},Ms),Ht["b"]),Ks),Us),Qs),eu),actions:Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])(Object(Zt["a"])({removeObject:function(t,e){var n=t.state,r=t.commit,a=t.rootState,o=n.objects[e.id],i=n.panels[o.panelId];a.ui.selection===e.id&&r("ui/setSelection",null,{root:!0});for(var c=0,s=[].concat(Object(On["a"])(i.onTopOrder),Object(On["a"])(i.order));c<s.length;c++){var u=s[c],l=n.objects[u];o.id!==u&&"textBox"===l.type&&(l.talkingObjId===o.id&&r("setTalkingOther",{id:l.id,talkingOther:o.label||""}))}r("removeFromList",{id:e.id,onTop:o.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,a=t.dispatch,o=n.objects[e.id];"character"===o.type?a("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,a=n.objects[e.id],o=n.panels[a.panelId];a.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:a.onTop}),r("addToList",{id:e.id,position:(e.onTop?o.onTopOrder:o.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,a=n.objects[e.id],o=n.panels[a.panelId],i=a.onTop?o.onTopOrder:o.order,c=i.indexOf(a.id),s=c+e.delta;s<0&&(s=0),s>i.length&&(s=i.length),r("removeFromList",{id:e.id,onTop:a.onTop}),r("addToList",{id:e.id,position:s,onTop:a.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,a=r.objects[e.id],o=e.preserveRatio?a.width/a.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:o})},setWidth:function(t,e){var n=t.commit,r=t.state,a=r.objects[e.id],o=a.preserveRatio?e.width/a.ratio:a.height;n("setSize",{id:e.id,height:o,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,a=r.objects[e.id],o=a.preserveRatio?e.height*a.ratio:a.width;n("setSize",{id:e.id,height:e.height,width:o})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Object(Ht["d"])(t,n.id,e);case"sprite":return;case"textBox":return}}))},copyObjects:function(t,e){var n=t.commit,r=t.state,a=e.sourcePanelId,o=e.targetPanelId,i=r.panels[a];if(i){var c,s=[].concat(Object(On["a"])(i.onTopOrder),Object(On["a"])(i.order)),u=new Map,l=Object(ht["a"])(s);try{for(l.s();!(c=l.n()).done;){var d=c.value,p="copy_".concat(++au);u.set(d,p)}}catch(g){l.e(g)}finally{l.f()}var h,b=Object(ht["a"])(s);try{for(b.s();!(h=b.n()).done;){var f=h.value,v=r.objects[f],m=JSON.parse(JSON.stringify(v));if("talkingObjId"in m){var j=m;null!==j.talkingObjId&&u.has(j.talkingObjId)&&(j.talkingObjId=u.get(j.talkingObjId))}n("create",{object:Object(Zt["a"])(Object(Zt["a"])({},m),{},{id:u.get(f),panelId:o})})}}catch(g){b.e(g)}finally{b.f()}}},copyObjectToClipboard:function(t,e){var n=t.commit,r=t.state,a=e.id,o=r.objects[a];n("ui/setClipboard",JSON.stringify(o),{root:!0})},pasteObjectFromClipboard:function(t){var e=t.commit,n=t.rootState;if(n.ui.clipboard){var r=JSON.parse(n.ui.clipboard);e("create",{object:Object(Zt["a"])(Object(Zt["a"])({},r),{},{id:"copy_".concat(++au),panelId:n.panels.currentPanel})})}},deleteAllOfPanel:function(t,e){for(var n=t.state,r=t.dispatch,a=e.panelId,o=n.panels[a],i=0,c=[].concat(Object(On["a"])(o.onTopOrder),Object(On["a"])(o.order));i<c.length;i++){var s=c[i];r("removeObject",{id:s})}},addFilter:function(t,e){var n=t.state,r=t.commit;$n(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;Hn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;Vn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))}},Ws),Ht["a"]),Js),qs),tu),ru)},iu={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e},setClipboard:function(t,e){t.clipboard=e},setDarkTheme:function(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom:function(t,e){t.defaultCharacterTalkingZoom=e}}},cu=n("0a94"),su=n("5311"),uu=n("77e3"),lu=n("b3a0");function du(t,e){return{backgrounds:pu(t.backgrounds,e.backgrounds),characters:bu(t.characters,e.characters),dependencies:gu(t.dependencies,e.dependencies),fonts:Ou(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Object(Zt["a"])(Object(Zt["a"])({},t),{},{files:gu(t.files,e.files)})})),poemStyles:Ou(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),poemBackgrounds:[].concat(Object(On["a"])(t.poemBackgrounds),Object(On["a"])(e.poemBackgrounds)),sprites:Ou(t.sprites,e.sprites,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(On["a"])(t.variants),Object(On["a"])(e.variants))}})),colors:Ou(t.colors,e.colors,(function(t){return t.color}),(function(t){return t}))}}function pu(t,e){return Ou(t,e,(function(t){return t.id}),hu)}function hu(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(On["a"])(t.variants),Object(On["a"])(e.variants))}}function bu(t,e){return Ou(t,e,(function(t){return t.id}),fu)}function fu(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:ju(t.heads,e.heads),styleGroups:Ou(t.styleGroups,e.styleGroups,(function(t){return t.id}),(function(t,e){return{id:t.id,styleComponents:Ou(t.styleComponents,e.styleComponents,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:vu(t.variants,e.variants)}})),styles:Ou(t.styles,e.styles,(function(t){return JSON.stringify(t.components)}),(function(t,e){return{components:t.components,poses:Ou(t.poses,e.poses,(function(t){return t.id}),mu)}}))}}))}}function vu(t,e){var n=Object(Zt["a"])({},t);for(var r in e)e.hasOwnProperty(r)&&(n.hasOwnProperty(r)||(n[r]=e[r]));return n}function mu(t,e){var n=Object(Zt["a"])({},t.positions);for(var r in e.positions)n[r]?n[r]=[].concat(Object(On["a"])(n[r]),Object(On["a"])(e.positions[r])):n[r]=e.positions[r];return{id:t.id,compatibleHeads:gu(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function ju(t,e){var n=Object(Zt["a"])({},t);for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];if(n[r]){var o=n[r];n[r]={previewOffset:o.previewOffset,previewSize:o.previewSize,variants:[].concat(Object(On["a"])(o.variants),Object(On["a"])(a.variants))}}else n[r]=a}return n}function gu(t,e){var n,r=Object(On["a"])(t),a=Object(ht["a"])(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.includes(o)||r.push(o)}}catch(i){a.e(i)}finally{a.f()}return r}function Ou(t,e,n,r){var a,o=Object(On["a"])(t),i=new Map(t.map((function(t,e){return[n(t),e]}))),c=Object(ht["a"])(e);try{for(c.s();!(a=c.n()).done;){var s=a.value,u=n(s);if(i.has(u)){var l=i.get(u),d=o[l];o.splice(l,1,r(d,s))}else i.set(u,o.length),o.push(s)}}catch(p){c.e(p)}finally{c.f()}return o}function ku(t){return t.split("/").slice(0,-1).join("/")+"/"}var yu=new Set(["png","gif","bmp","svg"]),wu={namespaced:!0,state:{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,a=t.state,n.next=3,Cu(e);case 3:o=n.sent,i=new Set(a.contentPacks.map((function(t){return t.packId}))),c=Object(ht["a"])(e.dependencies),n.prev=6,c.s();case 8:if((s=c.n()).done){n.next=14;break}if(u=s.value,i.has(u)){n.next=12;break}throw new Error("Missing dependency '".concat(u,"'. Refusing to install ").concat(e.packId));case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),c.e(n.t0);case 19:return n.prev=19,c.f(),n.finish(19);case 22:r("setContentPacks",[].concat(Object(On["a"])(a.contentPacks),[o])),r("setCurrentContent",du(a.current,o));case 24:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()},removeContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,a=t.state,o=xu(a.contentPacks.filter((function(t){return!e.has(t.packId)}))),r("setContentPacks",o),r("setCurrentContent",o.reduce((function(t,e){return du(t,e)})));case 4:case"end":return n.stop()}}),n)})))()},replaceContentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,a=t.state,!e.processed){n.next=5;break}n.t0=e.contentPack,n.next=8;break;case 5:return n.next=7,Cu(e.contentPack);case 7:n.t0=n.sent;case 8:o=n.t0,i=a.contentPacks,c=i.findIndex((function(t){return t.packId===e.contentPack.packId})),-1===c?i.push(o):i.splice(c,1,o),i=xu(i),r("setContentPacks",i),r("setCurrentContent",i.reduce((function(t,e){return du(t,e)})));case 15:case"end":return n.stop()}}),n)})))()},loadContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,"string"===typeof e&&(e=[e]),n.next=4,Promise.all(e.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,n.ok||Ru("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),Ru("Content pack is not valid json!");case 13:try{o={"./":ku(e),"/":ku(location.href)+"assets/"},a="2.0"===r.version?Object(su["normalizeContentPack"])(r,o):Object(uu["convert"])(Object(lu["normalizeCharacter"])(r,o),o,!1)}catch(i){Ru("Content pack is not in a valid format!",i)}return t.abrupt("return",a);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:a=n.sent,o=Object(ht["a"])(a),n.prev=6,o.s();case 8:if((i=o.n()).done){n.next=14;break}return c=i.value,n.next=12,r("contentPack",c);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),o.e(n.t0);case 19:return n.prev=19,o.f(),n.finish(19);case 22:return n.abrupt("return",a.map((function(t){return t.packId})));case 23:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()}},getters:{getCharacters:function(t){var e,n=t.current,r=new Map,a=Object(ht["a"])(n.characters);try{for(a.s();!(e=a.n()).done;){var o=e.value;r.set(o.id,o)}}catch(i){a.e(i)}finally{a.f()}return r},getBackgrounds:function(t){var e,n=t.current,r=new Map,a=Object(ht["a"])(n.backgrounds);try{for(a.s();!(e=a.n()).done;){var o=e.value;r.set(o.id,o)}}catch(i){a.e(i)}finally{a.f()}return r}}};function xu(t){return t}function Cu(t){return Su.apply(this,arguments)}function Su(){return Su=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Object(bt["e"])();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(On["a"])(yu)),t.next=8;break;case 7:t.t1=yu;case 8:return t.t2=t.t1,n=new t.t0(t.t2),r=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),a=Object(cu["assetWalker"])(e,(function(t,a){var o=Object(cu["normalizePath"])(t,r,n,!1),i=Object(cu["normalizePath"])(t,r,n,!0);return{hq:o,lq:i,sourcePack:e.packId||"buildIn"}})),t.abrupt("return",a);case 13:case"end":return t.stop()}}),t)}))),Su.apply(this,arguments)}function Ru(t,e){throw console.error(t,e),new Error(t)}var Pu=Object(Fs["a"])({state:{unsafe:!1},mutations:{setUnsafe:function(t,e){t.unsafe=e}},actions:{removePacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,a=t.commit,o=t.state,i=e.packs,c=JSON.parse(JSON.stringify(o.content.current)),a("setUnsafe",!0),n.next=6,r("content/removeContentPacks",i);case 6:return n.next=8,r("panels/fixContentPackRemoval",c);case 8:return n.next=10,r("objects/fixContentPackRemoval",c);case 10:a("setUnsafe",!1);case 11:case"end":return n.stop()}}),n)})))()}},modules:{objects:ou,ui:iu,panels:Gi,content:wu}}),Iu=(n("4160"),n("159b"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.config.globalProperties.$store)throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={});var n=t.config.globalProperties.$store;function a(t,e){var r={};switch(Object(Ni["a"])(e.payload)){case"object":e.payload instanceof Array&&(r=[]),n.commit("".concat(e.type),Object.assign(r,e.payload));break;default:n.commit("".concat(e.type),e.payload)}}function o(t,e){return i.apply(this,arguments)}function i(){return i=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){a(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(t){return s.apply(this,arguments)}function s(){return s=Object(u["a"])(regeneratorRuntime.mark((function t(r){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=r.data.done.slice(0),r.data.done=[],n.commit(e.resetStateMutation),i=0;case 4:if(!(i<a.length)){t.next=10;break}return t.next=7,o(r,a[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}var l={};function d(t){if(!l[t]){var n,r=t.split("/"),a={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},o="",i=Object(ht["a"])(r);try{for(i.s();!(n=i.n()).done;){var c=n.value;e.mutations[o+"*"]&&Object.assign(a,e.mutations[o+"*"]),o+=c+"/"}}catch(s){i.e(s)}finally{i.f()}e.mutations[t]&&Object.assign(a,e.mutations[t]),l[t]=a}return l[t]}var p={data:Object(r["s"])({done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}),initialize:function(){p.initialized||(p.initialized=!0,n.subscribe((function(t){var n=function(){t.type===e.resetStateMutation||d(t.type).ignore(t)||(p.currentTransaction.push(t),p.newMutation&&(p.data.undone=[]))};p.currentTransaction?n():p.transaction((function(){n()}))})))},redo:function(){if(!(p.data.undone.length<=0)){var t=p.data.undone.pop();p.newMutation=!1,o(p,t),p.newMutation=!0}},undo:function(){return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(p.data.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return p.data.undone.push(p.data.done.pop()),p.newMutation=!1,t.next=6,c(p);case 6:p.newMutation=!0;case 7:case"end":return t.stop()}}),t)})))()},transaction:function(t){return new Promise((function(e,n){var r=function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return p.currentTransaction=[],n.prev=1,n.next=4,t();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.log("Error during transaction!: ",n.t0);case 9:r=p.data.done[p.data.done.length-1],1===p.currentTransaction.length&&r&&1===r.length&&(a=d(p.currentTransaction[0].type),a.combinable(r[0],p.currentTransaction[0])&&(o=a.combinator(r[0],p.currentTransaction[0]),p.data.done.pop(),p.currentTransaction=o?[o]:[])),p.currentTransaction.length>0&&p.data.done.push(p.currentTransaction),p.currentTransaction=null,p.data.transactionQueue.length>0&&p.data.transactionQueue.pop()(),e();case 15:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();p.currentTransaction?p.data.transactionQueue.push(r):r()}))}};t.config.globalProperties.vuexHistory=p,p.initialize()}});Object(r["f"])(Es).use(Pu).use(Iu).mount("#app")},d2ab:function(t,e,n){},d7eb:function(t,e,n){},da86:function(t,e,n){},dc61:function(t,e,n){"use strict";var r=n("7a23"),a=Object(r["F"])("data-v-0c92f421"),o=a((function(t,e,n,a,o,i){return t.visible?(Object(r["p"])(),Object(r["g"])("div",{key:0,onDragleave:e[1]||(e[1]=function(e){return t.visible=!1}),onDrop:e[2]||(e[2]=function(){return t.drop.apply(t,arguments)}),class:{vertical:t.vertical}},[Object(r["v"])(t.$slots,"default")],34)):Object(r["h"])("",!0)})),i=(n("ac1f"),n("466d"),n("b85c")),c=Object(r["m"])({computed:{vertical:function(){return this.$store.state.ui.vertical}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},drop:function(t){if(this.hide(),t.stopPropagation(),t.preventDefault(),t.dataTransfer){var e,n=Object(i["a"])(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var r=e.value;"file"===r.kind&&r.type.match(/image.*/)&&this.$emit("drop",r.getAsFile())}}catch(a){n.e(a)}finally{n.f()}}}}});n("fc0e");c.render=o,c.__scopeId="data-v-0c92f421";e["a"]=c},dd24:function(t,e,n){"use strict";n("6cff")},ddde:function(t,e,n){"use strict";n("a6d1")},dddf:function(t,e,n){"use strict";n("866c")},e3f7:function(t,e,n){},f317:function(t,e,n){},f526:function(t,e,n){},fb68:function(t,e,n){},fc0e:function(t,e,n){"use strict";n("7e59")},fd0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("d3b7"),n("96cf");var r=n("1da1"),a=n("d4ec"),o=n("bee2"),i=n("6ae4"),c=n("73e5"),s=n("032b"),u=n("fec4"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u["d"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u["c"];Object(a["a"])(this,t),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=e,this.previewCanvas.height=n}return Object(o["a"])(t,[{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],r=!(s.length>2&&void 0!==s[2])||s[2],this.runningContext&&this.runningContext.abort(),a=this.previewCanvas.getContext("2d"),a.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),o=this.runningContext=i["a"].makeWithContext(this.previewCanvas,a,n,r),t.prev=6,t.next=9,e(this.runningContext);case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t["catch"](6),!(t.t0 instanceof c["a"])){t.next=15;break}return t.abrupt("return",!1);case 15:throw t.t0;case 16:return t.prev=16,o===this.runningContext&&(this.runningContext=null),t.finish(16);case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this,[[6,11,16,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e){e.w&&e.h?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}},{key:"download",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,a=r.getContext("2d"),a.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(r,a,!0,!1));case 7:return t.abrupt("return",s["a"].saveToFile(r,n));case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderToBlob",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,r=n.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(n,r,!0,!1));case 7:return t.next=9,new Promise((function(t,e){n.toBlob((function(n){n?t(n):e()}))}));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}()},fec4:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));var r=1280,a=720,o=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],i=[200,240,400,493,640,786,880,1040,1080]}});
//# sourceMappingURL=app.e19d061d.js.map