(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],l=0,d=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);b&&b(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a={app:0},i=[];function c(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-7799a822":"71555152","chunk-ab09dd9e":"34ec6f95"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-7799a822":1,"chunk-ab09dd9e":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-7799a822":"8e9a32db","chunk-ab09dd9e":"a5b1d338"}[t]+".css",a=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){u=d[c],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.onload=e,b.onerror=function(e){var r=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete o[t],b.parentNode.removeChild(b),n(i)},b.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(b)})).then((function(){o[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(b);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,n[1](d)}a[t]=void 0}};var b=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var b=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"014c":function(t,e,n){"use strict";n("e2ee")},"02e0":function(t,e,n){"use strict";n("632f")},"032b":function(t,e,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("262e"),c=n("2caf"),s=(n("ac1f"),n("25f0"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("7a23")),u=function(){function t(){Object(o["a"])(this,t),this.allowLQ=!0,this.isLocalRepoSupported=!1,this.isAutoLoadingSupported=!1,this.isBackgroundInstallingSupported=!1,this.vueState=Object(s["r"])({active:[],inactive:[],tempInstalled:[],tempUninstalled:[]}),this.localRepositoryUrl=""}return Object(a["a"])(t,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=document.createElement("a"),a.setAttribute("download",n),t.next=6,this.createObjectURL(e,r,o);case 6:return i=t.sent,a.setAttribute("href",i),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"localRepoAdd",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"localRepoRemove",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"autoLoadAdd",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"autoLoadRemove",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t,e,n){var r=this;return new Promise((function(o,a){if(t.toBlob&&window.URL&&window.URL.createObjectURL)t.toBlob((function(t){t?o(URL.createObjectURL(t)):a()}),e,n);else if(window.URL&&window.URL.createObjectURL){var i=t.toDataURL(),c=r.dataURItoBlob(i,e);o(URL.createObjectURL(c))}else o(t.toDataURL())}))}},{key:"dataURItoBlob",value:function(t,e){for(var n=atob(t.split(",")[1]),r=n.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.charCodeAt(a);return new Blob([o],{type:e})}}]),t}(),l=function(t){Object(i["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(o["a"])(this,n),e.apply(this,arguments)}return Object(a["a"])(n,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=e.toDataURL(r,o),i=this.dataURItoBlob(a,r),window.URL&&window.URL.createObjectURL&&(a=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,n),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),n}(u),d=(n("2ca0"),n("5947")),b=n("0c0f"),p={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},f=function(){function t(){var e=this;Object(o["a"])(this,t),this.allowLQ=!1,this.vueState=Object(s["r"])({active:[],inactive:[],tempInstalled:[],tempUninstalled:[]}),this.localRepositoryUrl="/repo/repo.json",this.isBackgroundInstallingSupported=!0,this.isLocalRepoSupported=!0,this.isAutoLoadingSupported=!0,this.electron=window,this.promptCache={},this.lastPrompt=0,this.vuexHistory=null,this.$store=null,this.bgInvalidation=null,this.pendingContentPacks=[],this.electron.ipcRenderer.on("add-persistent-content-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store&&e.vuexHistory){t.next=3;break}return e.pendingContentPacks.push(o),t.abrupt("return");case 3:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",o);case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o="persistentBg-"+r,a=r.split("/"),Object(d["g"])(o,r),p.backgrounds.push({id:o,variants:[[o]],label:a[a.length-1]}),e.invalidateInstalledBGs();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:b["f"].fire(new b["d"](n));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("prompt-answered",(function(t,n,r){e.promptCache[n](r)})),this.electron.ipcRenderer.on("update-ready",(function(t){})),this.electron.ipcRenderer.send("find-customs")}return Object(a["a"])(t,[{key:"localRepoAdd",value:function(t){console.log("installContentPack",t),this.electron.ipcRenderer.send("install-content-pack",t)}},{key:"localRepoRemove",value:function(t){console.log("uninstallContentPack",t),this.electron.ipcRenderer.send("uninstall-content-pack",t)}},{key:"autoLoadAdd",value:function(t){console.log("activateContentPack",t),this.electron.ipcRenderer.send("activate-content-pack",t)}},{key:"autoLoadRemove",value:function(t){console.log("deactivateContentPack",t),this.electron.ipcRenderer.send("deactivate-content-pack",t)}},{key:"saveToFile",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise((function(i,c){t.toBlob(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return c(),t.abrupt("return");case 3:return t.next=5,r.arrayBuffer();case 5:o=t.sent,n.electron.ipcRenderer.send("save-file",e,new Uint8Array(o)),i(URL.createObjectURL(r));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o,a)}))}},{key:"installBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.uploadedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(d["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch(n.src);case 11:return r=t.sent,t.t0=Uint8Array,t.next=15,r.arrayBuffer();case 15:t.t1=t.sent,o=new t.t0(t.t1),this.electron.ipcRenderer.send("install-background",o);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.installedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(d["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:if(n.src.startsWith("blob:")){t.next=18;break}return t.next=12,fetch(n.src);case 12:return r=t.sent,t.next=15,r.blob();case 15:o=t.sent,a=URL.createObjectURL(o),Object(d["g"])(e.assets[0].hq,a);case 18:this.electron.ipcRenderer.send("uninstall-background",e.id);case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(t,e){var n=this;return new Promise((function(r,o){n.promptCache[++n.lastPrompt]=r,n.electron.ipcRenderer.send("show-prompt",n.lastPrompt,t,e)}))}},{key:"onPanelChange",value:function(t){this.electron.ipcRenderer.on("open-panel",(function(e,n){t(n)}))}},{key:"connectToStore",value:function(t,e){var n=this;this.vuexHistory=t,this.$store=e,this.invalidateInstalledBGs(),this.pendingContentPacks.length>0&&this.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("content/loadContentPacks",n.pendingContentPacks);case 2:case"end":return t.stop()}}),t)}))))}},{key:"invalidateInstalledBGs",value:function(){var t=this;this.vuexHistory&&this.$store&&null===this.bgInvalidation&&(this.bgInvalidation=requestAnimationFrame((function(){t.updateInstalledBGs()})))}},{key:"updateInstalledBGs",value:function(){var t=this;this.bgInvalidation&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.vuexHistory&&this.$store&&this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:p})}))}}]),t}();function h(){return window.isElectron?new f:void 0!==window.navigator.msSaveOrOpenBlob?new l:new u}var j=h();window.toast=j;e["a"]=j},"0783":function(t,e,n){"use strict";n("3aae")},"0834":function(t,e,n){"use strict";n("dc32")},"0c0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return l}));var r=n("d4ec"),o=n("14b7"),a=Object(o["a"])();e["f"]={fire:function(t){a.emit(t.kind,t)},subscribe:function(t,e){a.on(t.kind,e)},unsubscribe:function(t,e){a.off(t.kind,e)}};var i=function t(e){Object(r["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};i.kind="AssetFailureEvent";var c=function t(e){Object(r["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};c.kind="CustomAssetFailureEvent";var s=function t(){Object(r["a"])(this,t),this.kind="InvalidateRenderEvent"};s.kind="InvalidateRenderEvent";var u=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="ShowMessageEvent"};u.kind="ShowMessageEvent";var l=function t(e,n){Object(r["a"])(this,t),this.error=e,this.info=n,this.kind="VueErrorEvent"};l.kind="VueErrorEvent"},"0c80":function(t,e,n){},1181:function(t,e,n){},"13f8":function(t,e,n){"use strict";n("0c80")},1416:function(t,e,n){"use strict";n("27f9")},"1a7b":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("b85c"),o=n("d4ec"),a=n("bee2"),i=n("262e"),c=n("2caf"),s=n("ba37"),u=n("4a6f"),l=function(t){Object(i["a"])(n,t);var e=Object(c["a"])(n);function n(t,r){var a;return Object(o["a"])(this,n),a=e.call(this,t),a.data=r,a.scaleable=!0,a}return Object(a["a"])(n,[{key:"updatedContent",value:function(t){this.data=Object(s["e"])(t,this.obj)}},{key:"getAssetList",value:function(){var t,e=Object(s["h"])(this.data,this.obj),n=Object(s["f"])(this.data,this.obj),o=[],a=Object(r["a"])(e.renderCommands);try{for(a.s();!(t=a.n()).done;){var i=t.value;switch(i.type){case"head":o.push({offset:i.offset,composite:i.composite,assets:n?n.variants[this.obj.posePositions.head||0]:[]});break;case"image":o.push({offset:i.offset,composite:i.composite,assets:i.images});break;case"pose-part":var c=e.positions[i.part];if(!c||0===c.length)break;var u=c[this.obj.posePositions[i.part]||0];if(!u)break;o.push({offset:i.offset,composite:i.composite,assets:u});break}console.log(i,JSON.stringify(o))}}catch(l){a.e(l)}finally{a.f()}return o}},{key:"canvasHeight",get:function(){var t=Object(s["h"])(this.data,this.obj);return t.size[1]}},{key:"canvasWidth",get:function(){var t=Object(s["h"])(this.data,this.obj);return t.size[0]}},{key:"width",get:function(){var t=this.obj.close?2:1;return this.obj.width*t}},{key:"height",get:function(){var t=this.obj.close?2:1;return this.obj.height*t}}]),n}(u["a"])},"1c59":function(t,e,n){"use strict";n("ec4d")},"27f9":function(t,e,n){},"2fb1":function(t,e,n){"use strict";n("426c")},3742:function(t,e,n){"use strict";n("1181")},3970:function(t,e,n){"use strict";n("efa1")},3997:function(t,e,n){"use strict";n("d55d")},"3aa2":function(t,e,n){},"3aae":function(t,e,n){},"3dcd":function(t,e,n){"use strict";n("fcd6")},"408f":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("d4ec"),o=n("bee2"),a=n("262e"),i=n("2caf"),c=(n("caad"),n("2532"),n("96cf"),n("1da1")),s=n("fd0b"),u=n("fec4"),l=function(){function t(){Object(r["a"])(this,t),this.hq=!1,this.localRenderer=null,this.lastVersion=null,this.hitDetectionFallback=!1,this.renderable=!1,this.lastWidth=-1,this.lastHeight=-1,this.lastX=-1,this.lastY=-1,this.lastFlip=null}return Object(o["a"])(t,[{key:"updateLocalCanvas",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.canvasWidth,r=this.canvasHeight,0!==r||0!==n){t.next=5;break}return this.renderable=!1,t.abrupt("return");case 5:return this.renderable=!0,this.localRenderer=new s["a"](n,r),this.hq=e,t.next=10,this.localRenderer.render(this.renderLocal.bind(this));case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=null===this.localRenderer||this.lastVersion!==this.version||this.hq!==n.hq,this.scaleable||(r=r||this.width!==this.lastWidth||this.height!==this.lastHeight||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip,this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip),!r){t.next=5;break}return t.next=5,this.updateLocalCanvas(!n.hq);case 5:if(this.hq=n.hq,this.lastVersion=this.version,this.renderable){t.next=9;break}return t.abrupt("return");case 9:o=this.scaleable?this.width:u["d"],a=this.scaleable?this.height:u["c"],i=this.scaleable?this.x-o/2:0,c=this.scaleable?this.y:0,n.drawImage({image:this.localRenderer,x:i,y:c,w:o,h:a,flip:this.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,composite:this.composite,filters:this.filters});case 14:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=t-(this.x-this.width/2),r=e-(this.centeredVertically?this.y-this.height/2:this.y);if(n<0||n>this.width)return!1;if(r<0||r>this.height)return!1;if(!this.hitDetectionFallback)try{if(this.scaleable){var o=this.flip?this.width-n:n,a=this.localRenderer.width/this.width,i=this.localRenderer.height/this.height,c=this.localRenderer.getDataAt(Math.round(o*a),Math.round(r*i));return 0!==c[3]}var s=this.localRenderer.getDataAt(Math.round(this.flip?u["d"]-t:t),Math.round(e));return 0!==s[3]}catch(l){if(!(l instanceof DOMException&&l.message.includes("cross-origin")))throw l;this.hitDetectionFallback=!0}return!0}},{key:"getHitbox",value:function(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}},{key:"centeredVertically",get:function(){return!1}},{key:"width",get:function(){return this.canvasWidth}},{key:"height",get:function(){return this.canvasHeight}}]),t}(),d=function(t){Object(a["a"])(n,t);var e=Object(i["a"])(n);function n(t){var o;return Object(r["a"])(this,n),o=e.call(this),o.obj=t,o}return Object(o["a"])(n,[{key:"updatedContent",value:function(t){}},{key:"id",get:function(){return this.obj.id}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return this.obj.y}},{key:"version",get:function(){return this.obj.version}},{key:"flip",get:function(){return this.obj.flip}},{key:"composite",get:function(){return this.obj.composite}},{key:"filters",get:function(){return this.obj.filters}}]),n}(l)},4217:function(t,e,n){},4219:function(t,e,n){},"426c":function(t,e,n){},"47d7":function(t,e,n){"use strict";n("f982")},"480b":function(t,e,n){},"4a6f":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n("4de4"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("b85c"),o=(n("96cf"),n("1da1")),a=n("d4ec"),i=n("bee2"),c=n("262e"),s=n("2caf"),u=n("5947"),l=n("408f"),d=function(t){Object(c["a"])(n,t);var e=Object(s["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return Object(i["a"])(n,[{key:"renderLocal",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.getAssetList(),t.next=3,Promise.all(n.filter((function(t){return t.assets})).map((function(t){return b(t,e.hq)})));case 3:o=t.sent,a=Object(r["a"])(o);try{for(a.s();!(i=a.n()).done;){c=i.value,s=Object(r["a"])(c.assets);try{for(s.s();!(u=s.n()).done;)l=u.value,e.drawImage({image:l,composite:c.composite,x:c.offset[0],y:c.offset[1]})}catch(d){s.e(d)}finally{s.f()}}}catch(d){a.e(d)}finally{a.f()}case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),n}(l["a"]);function b(t,e){return p.apply(this,arguments)}function p(){return p=Object(o["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!("loaded"in e)){t.next=2;break}return t.abrupt("return",e);case 2:return t.t0=e.offset,t.next=5,Promise.all(e.assets.map((function(t){return Object(u["a"])(t,n)})));case 5:return t.t1=t.sent,t.t2=e.composite,t.abrupt("return",{loaded:!0,offset:t.t0,assets:t.t1,composite:t.t2});case 8:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}},"4b87":function(t,e,n){"use strict";n("9aad")},"4ffd":function(t,e,n){"use strict";n("4219")},5947:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return m})),n.d(e,"f",(function(){return O})),n.d(e,"g",(function(){return y}));n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf");var r,o,a=n("1da1"),i=n("0c0f"),c=n("9be5"),s=n("032b");function u(){return r||(r=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),r}function l(){return o||(o=new Promise((function(t,e){var n="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",r=document.createElement("img");r.addEventListener("load",(function(){console.log("Heif no error. "+(2===r.width&&1===r.height)),t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){console.log("Heif not supported"),t(!1)})),r.src=n}))),o}var d={},b={};function p(t){return f.apply(this,arguments)}function f(){return f=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],t.abrupt("return",h(s["a"].allowLQ&&!n?e.lq:e.hq));case 2:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function h(t){return j.apply(this,arguments)}function j(){return j=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d[e]||(d[e]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(){i["f"].fire(new i["a"](e)),d[e]=void 0,t(new c["a"])})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))),t.abrupt("return",d[e]);case 2:case"end":return t.stop()}}),t)}))),j.apply(this,arguments)}var v=".";function m(t){return g.apply(this,arguments)}function g(){return g=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],!b[e]){t.next=3;break}return t.abrupt("return",b[e]);case 3:return t.t0="".concat(v,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,u();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),t.abrupt("return",h(r));case 14:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function O(t,e){var n=URL.createObjectURL(e);return b[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["f"].fire(new i["b"](t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function y(t,e){return b[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["f"].fire(new i["b"](t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}},"60ee":function(t,e,n){},"61ea":function(t,e,n){"use strict";function r(t){throw new Error('Unexpected value "'.concat(t,'"'))}n.d(e,"a",(function(){return r}))},"632f":function(t,e,n){},"6ae4":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("99af"),n("cb29"),n("4de4"),n("a15b");var r=n("b85c"),o=n("5530"),a=n("d4ec"),i=n("bee2"),c=n("73e5"),s=n("fd0b"),u=n("9be5"),l=function(){function t(e,n,r){Object(a["a"])(this,t),this.fsCtx=e,this.hq=n,this.preview=r,this.aborted=!1}return Object(i["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new c["a"];this.fsCtx.save();var e=Object(o["a"])(Object(o["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,a=e.x,i=void 0===a?0:a,s=e.y,u=void 0===s?0:s,l=e.text,d=void 0===l?"":l;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(d,i,u)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(d,i,u)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new c["a"];this.fsCtx.save();var e=Object(o["a"])(Object(o["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,a=e.text,i=void 0===a?"":a;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var s=this.fsCtx.measureText(i);return this.fsCtx.restore(),s}},{key:"drawImage",value:function(t){if(this.aborted)throw new c["a"];if(!(t.image instanceof u["a"])){var e=Object(o["a"])({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t),n=e.image,a=e.flip,i=e.x,l=e.y,d=e.w,b=e.h,p=e.filters,f=e.composite;if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=f,p)if("filter"in this.fsCtx){var h,j=[],v=Object(r["a"])(p);try{for(v.s();!(h=v.n()).done;){var m=h.value;"drop-shadow"===m.type?j.push("drop-shadow(".concat(m.offsetX,"px ").concat(m.offsetY,"px ").concat(m.blurRadius,"px ").concat(m.color,")")):"hue-rotate"===m.type?j.push("hue-rotate(".concat(m.value,"deg)")):"blur"===m.type?j.push("blur(".concat(m.value,"px)")):j.push("".concat(m.type,"(").concat(100*m.value,"%)"))}}catch(w){v.e(w)}finally{v.f()}this.fsCtx.filter=j.join(" ")}else{var g,O=1,y=Object(r["a"])(p);try{for(y.s();!(g=y.n()).done;){var k=g.value;"opacity"===k.type&&(O*=k.value)}}catch(w){y.e(w)}finally{y.f()}this.fsCtx.globalAlpha=O}if(t.shadow){var x=t.shadow;x.color&&(this.fsCtx.shadowColor=x.color),x.blur&&(this.fsCtx.shadowBlur=x.blur),x.offsetX&&(this.fsCtx.shadowOffsetX=x.offsetX),x.offsetY&&(this.fsCtx.shadowOffsetY=x.offsetY)}this.fsCtx.translate(i+d/2,l+b/2),this.fsCtx.scale(a?-1:1,1),n instanceof s["a"]?n.paintOnto(this.fsCtx,-d/2,-b/2,d,b):this.fsCtx.drawImage(n,-d/2,-b/2,d,b),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,o=t.h,a=t.outline,i=t.fill,s=t.composition;if(this.aborted)throw new c["a"];this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,o),s&&(this.fsCtx.globalCompositeOperation=s),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),a&&(this.fsCtx.strokeStyle=a.style,this.fsCtx.lineWidth=a.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new c["a"];this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof s["a"]&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(t,e){this.fsCtx.save(),t(this.fsCtx),e(this),this.fsCtx.restore()}},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"abort",value:function(){this.aborted=!0}}]),t}()},"6ed0":function(t,e,n){"use strict";n("60ee")},"71ca":function(t,e,n){"use strict";n("7766")},"73e5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},7766:function(t,e,n){},8056:function(t,e,n){},"8f65":function(t,e,n){},"8f7f":function(t,e,n){"use strict";n("c992")},"9aad":function(t,e,n){},"9be5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},"9cdc":function(t,e,n){"use strict";n("d673")},a485:function(t,e,n){"use strict";n("ae67")},aacd:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=25,o={methods:{verticalScrollRedirect:function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget,n=getComputedStyle(e),o=t;if(0!==o.deltaY){if("auto"===n.overflowY)if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight)return void t.stopPropagation()}else if(e.scrollTop>0)return void t.stopPropagation();var a=e.scrollLeft;o.mozInputSource?e.scrollLeft+=o.deltaY*r:e.scrollLeft+=o.deltaY,e.scrollLeft!==a&&t.stopPropagation()}}}}}},ae67:function(t,e,n){},b3d7:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["D"])("data-v-779c4f22");Object(r["q"])("data-v-779c4f22");var a={class:"fieldset_wrapper"},i={key:0},c={class:"fieldset_contents"};Object(r["p"])();var s=o((function(t,e,n,o,s,u){return Object(r["o"])(),Object(r["f"])("div",a,[Object(r["j"])("fieldset",null,[t.title>""?(Object(r["o"])(),Object(r["f"])("legend",i,Object(r["v"])(t.title),1)):Object(r["g"])("",!0),Object(r["j"])("div",c,[Object(r["t"])(t.$slots,"default")])])])})),u=Object(r["l"])({props:{title:{required:!0,type:String}}});n("ea98");u.render=s,u.__scopeId="data-v-779c4f22";e["a"]=u},b5c3:function(t,e,n){},b6f6:function(t,e,n){"use strict";n("c360")},b704:function(t,e,n){},b9be:function(t,e,n){"use strict";n("3aa2")},ba37:function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return b})),n.d(e,"h",(function(){return f})),n.d(e,"g",(function(){return h})),n.d(e,"f",(function(){return j})),n.d(e,"c",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"d",(function(){return O}));n("99af"),n("4de4"),n("7db0"),n("c740"),n("5db7"),n("c975"),n("d81d"),n("73d9"),n("b64b"),n("d3b7"),n("ddb0"),n("96cf");var r=n("1da1"),o=n("ade3"),a=n("2909"),i=n("5530"),c=n("fec4"),s=n("c837"),u=-74,l=-26,d={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup:function(t,e){var n=e.id,r=e.styleGroupId,o=t.objects[n];o.styleGroupId=r,++o.version},setCharStyle:function(t,e){var n=e.id,r=e.styleId,o=t.objects[n];o.styleId=r,++o.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=Object(i["a"])(Object(i["a"])({},n.posePositions),e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];n.freeMove=e.freeMove,n.freeMove||(n.x=c["a"][v(n.x)],n.y=l)}};function b(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function p(t,e){var n=t["content/getCharacters"];return n.get(e.characterType)}function f(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function h(t,e){var n=f(t,e),r=Object(a["a"])(Object.keys(n.positions).filter((function(t){return n.positions[t].length>1})));return n.compatibleHeads.length>0&&r.unshift("head"),r}function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType||0,r=f(t,e).compatibleHeads;if(!r||0===r.length)return null;var o=t.heads[r[n]];return o}function v(t){var e=c["a"].map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return e[0].idx}var m=0,g={createCharacters:function(t,e){var n=t.rootState,r=t.commit;r("create",{object:{flip:!1,id:"characters_"+ ++m,panelId:n.panels.currentPanel,onTop:!1,opacity:100,type:"character",x:640,y:l,preserveRatio:!0,ratio:1,height:768,width:768,characterType:e.characterType,close:!1,freeMove:!1,version:0,poseId:0,styleId:0,styleGroupId:0,posePositions:{},composite:"source-over",filters:[]}})},seekPart:function(t,e){var n=t.state,r=t.commit,a=t.dispatch,i=t.rootGetters,c=e.delta,u=e.id,l=e.part;if("head"!==l){var d=n.objects[u],b=f(p(i,d),d);b.positions[l]&&r("setPosePosition",{id:u,posePositions:Object(o["a"])({},l,Object(s["a"])(b.positions[l],d.posePositions[l]||0,c))})}else a("seekHead",{id:u,delta:c})},seekPose:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=p(o,c),l=u.styleGroups[c.styleGroupId].styles[c.styleId].poses;w(r,c,u,(function(t){t.poseId=Object(s["a"])(l,t.poseId,i)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=p(o,c),l=u.styleGroups.flatMap((function(t,e){return t.styles.map((function(t,n){return{styleGroupIdx:e,styleIdx:n,styleGroupJson:JSON.stringify(t.components)}}))})).sort((function(t,e){return t.styleGroupJson.localeCompare(e.styleGroupJson)})),d=l.findIndex((function(t){return t.styleGroupIdx===c.styleGroupId&&t.styleIdx===c.styleId}));w(r,c,u,(function(t){var e=Object(s["a"])(l,d,i),n=l[e];t.styleGroupId=n.styleGroupIdx,t.styleId=n.styleIdx}))},seekHead:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=p(o,c),l=f(u,c),d=j(u,c);if(d){var b=(c.posePositions.head||0)+i,h=c.posePositions.headType||0;(b<0||b>=d.variants.length)&&(h=Object(s["a"])(l.compatibleHeads.map((function(t){return u.heads[t]})),h,i),d=j(u,c,h),b=1===i?0:d.variants.length-1),r("setPosePosition",{id:a,posePositions:{head:b,headType:h}})}},setPart:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.part,c=e.val,s=n.objects[a],u=p(o,s);w(r,s,u,"pose"===i?function(t){t.poseId=c}:"style"===i?function(t){t.styleId=c}:function(t){t.posePositions[i]=c})},setCharStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.styleGroupId,c=e.styleId,s=n.objects[a],u=p(o,s);w(r,s,u,(function(t){t.styleGroupId=i,t.styleId=c}))},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.x,i=e.y,s=n.objects[o];s.freeMove?r("setPosition",{id:o,x:a,y:i}):r("setPosition",{id:o,x:c["a"][v(a)],y:l+(s.close?u:0)})},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.delta,i=n.objects[o],s=v(i.x),u=s+a;u<0&&(u=0),u>=c["a"].length&&(u=c["a"].length-1),r("setPosition",{id:o,x:c["a"][u],y:i.y})}};function O(t,e,n){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c,s,u,l,d,b,p,f,h,j,v,m,g,O,y,w,C,S,P;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.state.objects[n],a=r.characters.find((function(t){return t.id===o.characterType})),a){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(i=k(o),c=a.styleGroups[o.styleGroupId],s=c.styles[i.styleId],u=s.poses[i.poseId],l=e.rootState.content.current.characters.find((function(t){return t.id===a.id})),l){t.next=15;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 15:d=l.styleGroups.findIndex((function(t){return t.id===c.id})),i.styleGroupId=-1===d?0:d,b=l.styleGroups[i.styleGroupId],p=JSON.stringify(s.components),f=b.styles.findIndex((function(t){return JSON.stringify(t.components)===p})),i.styleId=-1===f?0:f,h=b.styles[i.styleId],j=h.poses.findIndex((function(t){return t.id===u.id})),i.poseId=-1===j?0:j,v=h.poses[i.poseId],m={},t.t0=regeneratorRuntime.keys(v.positions);case 27:if((t.t1=t.t0()).done){t.next=35;break}if(g=t.t1.value,v.positions.hasOwnProperty(g)){t.next=31;break}return t.abrupt("continue",27);case 31:O=v.positions[g],u.positions[g]?(y=i.posePositions[g],y>=0&&y<O.length?m[g]=y:m[g]=0):m[g]=0,t.next=27;break;case 35:w=u.compatibleHeads[o.posePositions.headType],C=v.compatibleHeads.indexOf(w),-1===C?(i.posePositions.headType=0,i.posePositions.head=0):(C!==o.posePositions.headType&&(i.posePositions.headType=C),S=JSON.stringify(a.heads[w].variants[o.posePositions.head]),P=l.heads[w].variants.findIndex((function(t){return JSON.stringify(t)===S})),i.posePositions.head=-1===P?0:P),x(e.commit,o,i);case 39:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function k(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Object(i["a"])({},t.posePositions)}}function x(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function w(t,e,n,r){var o=k(e);r(o),n.styleGroups[o.styleGroupId]||(o.styleGroupId=0);var a=n.styleGroups[o.styleGroupId];a.styles[o.styleId]||(o.styleId=0);var i=a.styles[o.styleId];i.poses[o.poseId]||(o.poseId=0);var c=i.poses[o.poseId];for(var s in c.positions)c.positions[s]&&(c.positions[s][o.posePositions[s]]||(o.posePositions[s]=0));var u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId],l=u.compatibleHeads[e.posePositions.headType||0],d=c.compatibleHeads.indexOf(l);d>=0?o.posePositions.headType=d:(o.posePositions.headType=0,o.posePositions.head=0),x(t,e,o)}},c360:function(t,e,n){},c4e5:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["D"])("data-v-5ca7fb80"),a=o((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",null,[Object(r["B"])(Object(r["j"])("input",{id:t._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.value=e})},null,8,["id"]),[[r["w"],t.value]]),Object(r["j"])("label",{for:t._.uid,class:"switch"},null,8,["for"]),Object(r["j"])("label",{for:t._.uid},Object(r["v"])(t.label),9,["for"])])})),i=Object(r["l"])({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get:function(){return this.modelValue},set:function(t){this.$emit("update:modelValue",t)}},checkbox:function(){return this.$refs.checkbox}}});n("47d7");i.render=a,i.__scopeId="data-v-5ca7fb80";e["a"]=i},c837:function(t,e,n){"use strict";function r(t,e,n){var r=e+n,o=t.length;return r<0&&(r+=o),r>=o&&(r-=o),r}n.d(e,"a",(function(){return r}))},c992:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o={key:0},a={key:1,id:"app"},i={id:"container"};function c(t,e,n,c,s,u){var l=Object(r["u"])("render"),d=Object(r["u"])("message-console"),b=Object(r["u"])("tool-box"),p=Object(r["u"])("single-box"),f=Object(r["u"])("modal-dialog"),h=Object(r["u"])("expression-builder");return t.canvasTooSmall&&t.isSafari?(Object(r["o"])(),Object(r["f"])("div",o," Protrait mode is not supported by safari. Please turn the device sideways. ")):(Object(r["o"])(),Object(r["f"])("div",a,[Object(r["j"])("div",i,[Object(r["j"])(l,{ref:"render",canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight},null,8,["canvasWidth","canvasHeight"])]),Object(r["j"])(d),Object(r["j"])(b,{"onShow-prev-render":t.drawLastDownload,onDownload:e[1]||(e[1]=function(e){return t.$refs.render.download()}),"onShow-dialog":t.showDialog,"onShow-expression-dialog":t.showExpressionDialog},null,8,["onShow-prev-render","onShow-dialog","onShow-expression-dialog"]),(Object(r["o"])(),Object(r["f"])(r["b"],null,[t.dialogVisable?Object(r["j"])(f,{key:0,ref:"dialog",onLeave:e[3]||(e[3]=function(e){return t.dialogVisable=!1})},{default:Object(r["A"])((function(){return[Object(r["j"])(p,{ref:"packDialog",onLeave:e[2]||(e[2]=function(e){return t.dialogVisable=!1})},null,512)]})),_:1},512):Object(r["g"])("",!0)],1024)),t.expressionBuilderVisible?Object(r["j"])(f,{key:0,ref:"dialog",onLeave:e[5]||(e[5]=function(e){return t.expressionBuilderVisible=!1})},{default:Object(r["A"])((function(){return[Object(r["j"])(h,{character:t.expressionBuilderCharacter,initHeadGroup:t.expressionBuilderHeadGroup,onLeave:e[4]||(e[4]=function(e){return t.expressionBuilderVisible=!1})},null,8,["character","initHeadGroup"])]})),_:1},512):Object(r["g"])("",!0)]))}n("b64b"),n("d3b7"),n("96cf");var s=n("1da1"),u=n("3835"),l={id:"toolbar"},d=Object(r["j"])("i",{class:"material-icons"},"add_box",-1),b=Object(r["j"])("i",{class:"material-icons"},"panorama",-1),p=Object(r["j"])("i",{class:"material-icons"},"view_module",-1),f=Object(r["j"])("i",{class:"material-icons"},"settings_applications",-1),h={id:"toolbar-end"},j=Object(r["j"])("i",{class:"material-icons"},"help",-1),v=Object(r["j"])("i",{class:"material-icons"},"extension",-1),m=Object(r["j"])("i",{class:"material-icons"},"flip_to_back",-1),g=Object(r["j"])("i",{class:"material-icons"},"photo_camera",-1);function O(t,e,n,o,a,i){var c=Object(r["u"])("settings-panel"),s=Object(r["u"])("content-packs-panel"),u=Object(r["u"])("backgrounds-panel"),O=Object(r["u"])("credits-panel"),y=Object(r["u"])("character-panel"),k=Object(r["u"])("sprite-panel"),x=Object(r["u"])("text-box-panel"),w=Object(r["u"])("choice-panel"),C=Object(r["u"])("panels-panel"),S=Object(r["u"])("notification-panel"),P=Object(r["u"])("poem-panel"),R=Object(r["u"])("add-panel");return Object(r["o"])(),Object(r["f"])("div",{id:"panels",class:{vertical:t.vertical}},[Object(r["j"])("div",l,[Object(r["j"])("button",{class:{active:"add"===t.panel},onClick:e[1]||(e[1]=function(e){return t.setPanel("add")}),title:"Add new objects to the scene"},[d],2),Object(r["j"])("button",{class:{active:"backgrounds"===t.panel},onClick:e[2]||(e[2]=function(e){return t.setPanel("backgrounds")}),title:"Change the current background"},[b],2),Object(r["j"])("button",{class:{active:"panels"===t.panel},title:"Panels",onClick:e[3]||(e[3]=function(e){return t.setPanel("panels")})},[p],2),Object(r["j"])("button",{class:{active:"settings"===t.panel},title:"Settings",onClick:e[4]||(e[4]=function(e){return t.setPanel("settings")})},[f],2)]),"settings"===t.panel?Object(r["j"])(c,{key:0}):"packs"===t.panel?Object(r["j"])(s,{key:1}):"backgrounds"===t.panel?Object(r["j"])(u,{key:2,"onShow-dialog":e[5]||(e[5]=function(e){return t.$emit("show-dialog",e)})}):"help_credits"===t.panel?Object(r["j"])(O,{key:3}):"character"===t.panel?Object(r["j"])(y,{key:4,"onShow-dialog":e[6]||(e[6]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[7]||(e[7]=function(e){return t.$emit("show-expression-dialog",e)})}):"sprite"===t.panel?Object(r["j"])(k,{key:5}):"textBox"===t.panel?Object(r["j"])(x,{key:6}):"choice"===t.panel?Object(r["j"])(w,{key:7}):"panels"===t.panel?Object(r["j"])(C,{key:8}):"notification"===t.panel?Object(r["j"])(S,{key:9}):"poem"===t.panel?Object(r["j"])(P,{key:10}):Object(r["j"])(R,{key:11,"onShow-dialog":e[8]||(e[8]=function(e){return t.$emit("show-dialog",e)})}),Object(r["j"])("div",h,[Object(r["j"])("button",{class:{active:"help_credits"===t.panel},onClick:e[9]||(e[9]=function(e){return t.setPanel("help_credits")}),title:"Help & Credits"},[j],2),Object(r["j"])("button",{class:{active:"packs"===t.panel},onClick:e[10]||(e[10]=function(e){return t.$emit("show-dialog")}),title:"Content packs"},[v],2),Object(r["j"])("button",{onClick:e[11]||(e[11]=function(e){return t.$emit("show-prev-render")}),title:"Show last downloaded panel",disabled:!t.hasPrevRender},[m],8,["disabled"]),Object(r["j"])("button",{title:"Take a screenshot of the current scene",onClick:e[12]||(e[12]=function(e){return t.$emit("download")})},[g])])],2)}var y=Object(r["D"])("data-v-4dea3924");Object(r["q"])("data-v-4dea3924");var k={class:"panel"},x=Object(r["j"])("h1",null,"Settings",-1);Object(r["p"])();var w=y((function(t,e,n,o,a,i){var c=Object(r["u"])("toggle");return Object(r["o"])(),Object(r["f"])("div",k,[x,t.lqAllowed?Object(r["j"])(c,{key:0,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:t.lqRendering,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.lqRendering=e})},null,8,["modelValue"]):Object(r["g"])("",!0),Object(r["j"])(c,{label:"NSFW Mode?",modelValue:t.nsfw,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.nsfw=e})},null,8,["modelValue"])])})),C=(n("4de4"),n("7db0"),n("d81d"),n("07ac"),n("6062"),n("3ca3"),n("ddb0"),n("c4e5")),S=n("aacd"),P={mixins:[S["a"]],computed:{vertical:function(){return this.$store.state.ui.vertical}},mounted:function(){var t=this;this.updateVertical(),this.$el.addEventListener("wheel",(function(e){t.vertical||t.verticalScrollRedirect(e)}),{passive:!0})},methods:{updateVertical:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical:function(){this.updateVertical()}}},R=n("032b"),I={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},T=new Set(Object.keys(I)),A=Object.values(I),_=Object(r["l"])({mixins:[P],components:{Toggle:C["a"]},computed:{lqAllowed:function(){return R["a"].allowLQ},lqRendering:{get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)}))))}},nsfw:{get:function(){return!!this.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})).find((function(t){return T.has(t)}))},set:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",A);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:T});case 7:case"end":return n.stop()}}),n)}))))}}}});n("b9be");_.render=w,_.__scopeId="data-v-4dea3924";var $=_,B=Object(r["D"])("data-v-1d4627bd");Object(r["q"])("data-v-1d4627bd");var V=Object(r["i"])("Drop here to add as a new sprite"),D=Object(r["j"])("h1",null,"Add",-1),L=Object(r["i"])(" CharÂ­acters "),F=Object(r["i"])(" Sprites "),H=Object(r["i"])(" UI "),E=Object(r["i"])(" Search in content packs "),M=Object(r["i"])(" Upload new sprite "),U=Object(r["i"])(" New sprite from URL "),N=Object(r["i"])(" Search in content packs ");Object(r["p"])();var W=B((function(t,e,n,o,a,i){var c=Object(r["u"])("drop-target"),s=Object(r["u"])("d-button");return void 0!==t.isWebPSupported?(Object(r["o"])(),Object(r["f"])("div",{key:0,class:"panel",onDragenter:e[13]||(e[13]=function(){return t.showDropTarget.apply(t,arguments)}),onMouseleave:e[14]||(e[14]=function(){return t.hideDropTarget.apply(t,arguments)})},[Object(r["j"])(c,{ref:"spriteDt",class:"drop-target",onDrop:t.addCustomSpriteFile},{default:B((function(){return[V]})),_:1},8,["onDrop"]),D,Object(r["j"])("div",{class:{"group-selector":!0,vertical:t.vertical}},[Object(r["j"])(s,{class:{active:"characters"===t.group},"icon-pos":"top",icon:"emoji_people",onClick:e[1]||(e[1]=function(e){return t.group="characters"})},{default:B((function(){return[L]})),_:1},8,["class"]),Object(r["j"])(s,{class:{active:"sprites"===t.group},"icon-pos":"top",icon:"change_history",onClick:e[2]||(e[2]=function(e){return t.group="sprites"})},{default:B((function(){return[F]})),_:1},8,["class"]),Object(r["j"])(s,{class:{active:"ui"===t.group},"icon-pos":"top",icon:"view_quilt",onClick:e[3]||(e[3]=function(e){return t.group="ui"})},{default:B((function(){return[H]})),_:1},8,["class"])],2),Object(r["j"])("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?(Object(r["o"])(),Object(r["f"])(r["a"],{key:0},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.characters,(function(e){return Object(r["o"])(),Object(r["f"])("div",{class:"character",key:e.id,title:e.label,onClick:function(n){return t.onChosen(e.id.toLowerCase())}},[Object(r["j"])("img",{src:t.assetPath(e),alt:e.label},null,8,["src","alt"])],8,["title","onClick"])})),128)),Object(r["j"])(s,{class:"custom-sprite",icon:"extension",onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Characters")})},{default:B((function(){return[E]})),_:1})],64)):Object(r["g"])("",!0),"sprites"===t.group?(Object(r["o"])(),Object(r["f"])(r["a"],{key:1},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.sprites,(function(e){return Object(r["o"])(),Object(r["f"])("div",{class:"sprite",key:e.label,title:e.label,style:{background:t.assetSpriteBackground(e)},onClick:function(n){return t.addSpriteToScene(e)}},Object(r["v"])(e.label),13,["title","onClick"])})),128)),Object(r["j"])(s,{class:"custom-sprite",icon:"publish",onClick:e[6]||(e[6]=function(e){return t.$refs.spriteUpload.click()})},{default:B((function(){return[M,Object(r["j"])("input",{type:"file",ref:"spriteUpload",onChange:e[5]||(e[5]=function(){return t.onSpriteFileUpload.apply(t,arguments)})},null,544)]})),_:1}),Object(r["j"])(s,{icon:"insert_link",onClick:t.uploadFromURL},{default:B((function(){return[U]})),_:1},8,["onClick"]),Object(r["j"])(s,{icon:"extension",onClick:e[7]||(e[7]=function(e){return t.$emit("show-dialog","type: Sprites")})},{default:B((function(){return[N]})),_:1})],64)):Object(r["g"])("",!0),"ui"===t.group?(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[Object(r["j"])("button",{onClick:e[8]||(e[8]=function(){return t.addTextBox.apply(t,arguments)})},"Textbox"),Object(r["j"])("button",{onClick:e[9]||(e[9]=function(){return t.addPoem.apply(t,arguments)})},"Poem"),Object(r["j"])("button",{onClick:e[10]||(e[10]=function(){return t.addDialog.apply(t,arguments)})},"Notification"),Object(r["j"])("button",{onClick:e[11]||(e[11]=function(){return t.addChoice.apply(t,arguments)})},"Choice"),Object(r["j"])("button",{onClick:e[12]||(e[12]=function(){return t.addConsole.apply(t,arguments)})},"Console")],64)):Object(r["g"])("",!0)],2)],32)):Object(r["g"])("",!0)})),q=(n("a630"),n("a15b"),n("fb6a"),n("b0c0"),n("ac1f"),n("466d"),n("1276"),n("2b3d"),n("b85c")),z=n("5947"),G=n("dc61"),Y=Object(r["D"])("data-v-5803ca69");Object(r["q"])("data-v-5803ca69");var K={class:"material-icons"},X={class:"content"};Object(r["p"])();var Q=Y((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("button",{class:[t.iconPos],disabled:t.disabled},[Object(r["j"])("div",K,Object(r["v"])(t.icon),1),Object(r["j"])("div",X,[Object(r["t"])(t.$slots,"default")])],10,["disabled"])})),J=Object(r["l"])({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1}}});n("fa82");J.render=Q,J.__scopeId="data-v-5803ca69";var Z=J,tt={packId:"dddg.buildin.uploadedSprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},et=Object(r["l"])({mixins:[P],components:{DropTarget:G["a"],DButton:Z},data:function(){return{isWebPSupported:null,customAssetCount:0,group:"characters"}},computed:{characters:function(){return this.$store.state.content.current.characters},sprites:function(){return this.$store.state.content.current.sprites}},methods:{assetSpriteBackground:function(t){return t.variants[0].map((function(t){return"url('".concat(t.lq,"')")})).join(",")},assetPath:function(t){return t.chibi?R["a"].allowLQ?t.chibi.lq:t.chibi.hq:""},showDropTarget:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link","sprites"===this.group&&this.$refs.spriteDt.show()))},hideDropTarget:function(){"sprites"===this.group&&this.$refs.spriteDt.hide()},onSpriteFileUpload:function(){var t=this.$refs.spriteUpload;if(t.files){var e,n=Object(q["a"])(t.files);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.addCustomSpriteFile(r)}}catch(o){n.e(o)}finally{n.f()}}},uploadFromURL:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=prompt("Enter the URL of the image"),n){e.next=3;break}return e.abrupt("return");case 3:r=n.split("/").slice(-1)[0],t.addNewCustomSprite(r,n);case 5:case"end":return e.stop()}}),e)})))()},addSpriteToScene:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("objects/createSprite",{assets:t.variants[0]});case 2:case"end":return n.stop()}}),n)}))));case 1:case"end":return n.stop()}}),n)})))()},addTextBox:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createTextBox",{});case 1:case"end":return e.stop()}}),e)}))))},addChoice:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createChoice",{});case 1:case"end":return e.stop()}}),e)}))))},addDialog:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createNotification",{});case 1:case"end":return e.stop()}}),e)}))))},addPoem:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createPoem",{});case 1:case"end":return e.stop()}}),e)}))))},addConsole:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createConsole",{});case 1:case"end":return e.stop()}}),e)}))))},onChosen:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.dispatch("objects/createCharacters",{characterType:t});case 1:case"end":return n.stop()}}),n)}))))},addCustomSpriteFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomSprite(t.name,e)},addNewCustomSprite:function(t,e){var n=this;tt.sprites.push({id:e,label:t,variants:[[e]]}),this.vuexHistory.transaction((function(){n.$store.dispatch("content/replaceContentPack",{contentPack:tt,processed:!1})}))}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(z["e"])();case 2:t.isWebPSupported=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("e650");et.render=W,et.__scopeId="data-v-1d4627bd";var nt=et,rt=Object(r["D"])("data-v-6d0ef99f");Object(r["q"])("data-v-6d0ef99f");var ot={class:"panel"},at={key:0},it={class:"arrow-col"},ct={class:"arrow-col"},st={key:1},ut={class:"arrow-col"},lt={class:"arrow-col"},dt={class:"arrow-col"},bt={class:"arrow-col"};Object(r["p"])();var pt=rt((function(t,e,n,o,a,i){var c=Object(r["u"])("parts"),s=Object(r["u"])("image-options"),u=Object(r["u"])("d-fieldset"),l=Object(r["u"])("position-and-size"),d=Object(r["u"])("layers"),b=Object(r["u"])("toggle"),p=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",ot,[Object(r["j"])("h1",null,Object(r["v"])(t.label),1),t.panelForParts?Object(r["j"])(c,{key:0,character:t.object,part:t.panelForParts,onLeave:e[1]||(e[1]=function(e){return t.panelForParts=null}),"onShow-dialog":e[2]||(e[2]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[3]||(e[3]=function(e){return t.$emit("show-expression-dialog",e)})},null,8,["character","part"]):t.imageOptionsOpen?Object(r["j"])(s,{key:1,type:"object",title:t.label,id:t.object.id,onLeave:e[4]||(e[4]=function(e){return t.imageOptionsOpen=!1})},null,8,["title","id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[t.hasMultiplePoses||t.parts.length>0?Object(r["j"])(u,{key:0,class:"pose-list",title:"Pose:"},{default:rt((function(){return[Object(r["j"])("table",null,[Object(r["j"])("tbody",null,[t.hasMultipleStyles?(Object(r["o"])(),Object(r["f"])("tr",at,[Object(r["j"])("td",it,[Object(r["j"])("button",{onClick:e[5]||(e[5]=function(e){return t.seekStyle(-1)})},"<")]),Object(r["j"])("td",null,[Object(r["j"])("button",{class:"middle-button",onClick:e[6]||(e[6]=function(e){return t.panelForParts="style"})}," Style ")]),Object(r["j"])("td",ct,[Object(r["j"])("button",{onClick:e[7]||(e[7]=function(e){return t.seekStyle(1)})},">")])])):Object(r["g"])("",!0),t.hasMultiplePoses?(Object(r["o"])(),Object(r["f"])("tr",st,[Object(r["j"])("td",ut,[Object(r["j"])("button",{onClick:e[8]||(e[8]=function(e){return t.seekPose(-1)})},"<")]),Object(r["j"])("td",null,[Object(r["j"])("button",{class:"middle-button",onClick:e[9]||(e[9]=function(e){return t.panelForParts="pose"})}," Pose ")]),Object(r["j"])("td",lt,[Object(r["j"])("button",{onClick:e[10]||(e[10]=function(e){return t.seekPose(1)})},">")])])):Object(r["g"])("",!0),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.parts,(function(e){return Object(r["o"])(),Object(r["f"])("tr",{key:e},[Object(r["j"])("td",dt,[Object(r["j"])("button",{onClick:function(n){return t.seekPart(e,-1)}},"<",8,["onClick"])]),Object(r["j"])("td",null,[Object(r["j"])("button",{class:"middle-button",onClick:function(n){return t.panelForParts=e}},Object(r["v"])(t.captialize(e)),9,["onClick"])]),Object(r["j"])("td",bt,[Object(r["j"])("button",{onClick:function(n){return t.seekPart(e,1)}},">",8,["onClick"])])])})),128))])])]})),_:1}):Object(r["g"])("",!0),Object(r["j"])(l,{obj:t.object},null,8,["obj"]),Object(r["j"])(d,{object:t.object},null,8,["object"]),Object(r["j"])(b,{modelValue:t.closeUp,"onUpdate:modelValue":e[11]||(e[11]=function(e){return t.closeUp=e}),label:"Close up?"},null,8,["modelValue"]),Object(r["j"])(b,{modelValue:t.flip,"onUpdate:modelValue":e[12]||(e[12]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])("button",{onClick:e[13]||(e[13]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(p,{obj:t.object},null,8,["obj"])],64))])})),ft=n("ba37"),ht=Object(r["D"])("data-v-7f101752");Object(r["q"])("data-v-7f101752");var jt={colspan:"2"},vt={key:0},mt={colspan:"2"},gt={class:"arrow-col"},Ot={class:"arrow-col"},yt=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"sprite_x"},"X:")],-1),kt=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"sprite_y"},"Y:")],-1),xt=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"sprite_w"},"Width:")],-1),wt=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"sprite_h"},"Height:")],-1),Ct={colspan:"2"};Object(r["p"])();var St=ht((function(t,e,n,o,a,i){var c=Object(r["u"])("toggle"),s=Object(r["u"])("d-fieldset");return Object(r["o"])(),Object(r["f"])(s,{title:"Position"+(t.allowSize?"/Size":"")},{default:ht((function(){return[Object(r["j"])("table",null,[Object(r["j"])("tr",null,[Object(r["j"])("td",jt,[t.allowStepMove?Object(r["j"])(c,{key:0,modelValue:t.freeMove,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.freeMove=e}),label:"Move freely?"},null,8,["modelValue"]):Object(r["g"])("",!0)])]),t.allowStepMove&&!t.freeMove?(Object(r["o"])(),Object(r["f"])("tr",vt,[Object(r["j"])("td",mt,[Object(r["j"])("table",null,[Object(r["j"])("tr",null,[Object(r["j"])("td",gt,[Object(r["j"])("button",{onClick:e[2]||(e[2]=function(e){return--t.pos}),disabled:t.isFirstPos},"<",8,["disabled"])]),Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.pos=e})},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.positionNames,(function(t,e){return Object(r["o"])(),Object(r["f"])("option",{key:e,value:e},Object(r["v"])(t),9,["value"])})),128))],512),[[r["x"],t.pos,void 0,{number:!0}]])]),Object(r["j"])("td",Ot,[Object(r["j"])("button",{onClick:e[4]||(e[4]=function(e){return++t.pos}),disabled:t.isLastPos},">",8,["disabled"])])])])])])):(Object(r["o"])(),Object(r["f"])(r["a"],{key:1},[Object(r["j"])("tr",null,[yt,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"sprite_x",type:"number","onUpdate:modelValue":e[5]||(e[5]=function(e){return t.x=e}),onKeydown:e[6]||(e[6]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.x,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[kt,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"sprite_y",type:"number","onUpdate:modelValue":e[7]||(e[7]=function(e){return t.y=e}),onKeydown:e[8]||(e[8]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.y,void 0,{number:!0}]])])])],64)),t.allowSize?(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[Object(r["j"])("tr",null,[xt,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":e[9]||(e[9]=function(e){return t.width=e}),onKeydown:e[10]||(e[10]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.width,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[wt,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":e[11]||(e[11]=function(e){return t.height=e}),onKeydown:e[12]||(e[12]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.height,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[Object(r["j"])("td",Ct,[Object(r["j"])(c,{modelValue:t.preserveRatio,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.preserveRatio=e}),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):Object(r["g"])("",!0)])]})),_:1},8,["title"])})),Pt=n("b3d7"),Rt=n("fec4"),It=Object(r["l"])({components:{Toggle:C["a"],DFieldset:Pt["a"]},props:{obj:{required:!0}},computed:{freeMove:{get:function(){return this.obj.freeMove},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},preserveRatio:{get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}},pos:{get:function(){return Object(ft["c"])(this.obj.x)},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:Rt["a"][t],y:e.obj.y})}))}},x:{get:function(){return this.obj.x},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},y:{get:function(){return this.obj.y},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},height:{get:function(){return this.obj.height},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},width:{get:function(){return this.obj.width},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},allowSize:function(){var t=this.obj;return("textBox"!==t.type||"custom"===t.style)&&!("character"===t.type&&!t.freeMove)},allowStepMove:function(){return"freeMove"in this.obj},positionNames:function(){return Rt["b"]},isFirstPos:function(){return 0===this.pos},isLastPos:function(){return this.pos===Rt["b"].length-1}}});n("3742");It.render=St,It.__scopeId="data-v-7f101752";var Tt=It,At=Object(r["D"])("data-v-90b83fd8");Object(r["q"])("data-v-90b83fd8");var _t=Object(r["j"])("i",{class:"material-icons"},"vertical_align_bottom",-1),$t=Object(r["j"])("i",{class:"material-icons"},"arrow_downward",-1),Bt=Object(r["j"])("i",{class:"material-icons"},"arrow_upward",-1),Vt=Object(r["j"])("i",{class:"material-icons"},"vertical_align_top",-1);Object(r["p"])();var Dt=At((function(t,e,n,o,a,i){var c=Object(r["u"])("toggle"),s=Object(r["u"])("d-fieldset");return Object(r["o"])(),Object(r["f"])(s,{id:"layerfs",title:"Layer:"},{default:At((function(){return[Object(r["j"])("table",null,[Object(r["j"])("tbody",null,[Object(r["j"])("tr",null,[Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[1]||(e[1]=function(e){return t.shiftLayer(-1/0)}),title:"Move to back"},[_t])]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[2]||(e[2]=function(e){return t.shiftLayer(-1)}),title:"Move backwards"},[$t])]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[3]||(e[3]=function(e){return t.shiftLayer(1)}),title:"Move forwards"},[Bt])]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[4]||(e[4]=function(e){return t.shiftLayer(1/0)}),title:"Move to front"},[Vt])])])])]),Object(r["j"])(c,{modelValue:t.onTop,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.onTop=e}),label:"In front?"},null,8,["modelValue"])]})),_:1})})),Lt=n("ade3");function Ft(){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object[t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(Lt["a"])({id:o.object.id},t,r))}))}}}}var Ht=Object(r["l"])({components:{Toggle:C["a"],DFieldset:Pt["a"]},props:{object:{required:!0}},computed:{onTop:Ft()("onTop","objects/setOnTop",!0)},methods:{shiftLayer:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.object.id,delta:t})}))}}});n("71ca");Ht.render=Dt,Ht.__scopeId="data-v-90b83fd8";var Et=Ht;function Mt(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("button",{onClick:e[1]||(e[1]=function(){return t.onClick.apply(t,arguments)})},"Delete")}var Ut=Object(r["l"])({props:{obj:{required:!0}},methods:{onClick:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}}});Ut.render=Mt;var Nt=Ut,Wt=(n("a9e3"),n("b680"),Object(r["D"])("data-v-79b6e46b"));Object(r["q"])("data-v-79b6e46b");var qt=Object(r["j"])("h2",null,"Image options",-1),zt={class:"column ok-col"},Gt={class:"column"},Yt=Object(r["j"])("label",{for:"compositionSelect"},"Compositing Mode:",-1),Kt=Object(r["j"])("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types",target:"_blank",rel:"noopener noreferrer"},"[?]",-1),Xt=Object(r["h"])('<option value="source-over" data-v-79b6e46b>source-over</option><option value="source-atop" data-v-79b6e46b>source-atop</option><option value="destination-over" data-v-79b6e46b>destination-over</option><option value="destination-in" data-v-79b6e46b>destination-in</option><option value="destination-in" data-v-79b6e46b>destination-out</option><option value="destination-in" data-v-79b6e46b>destination-atop</option><option value="lighter" data-v-79b6e46b>lighter</option><option value="xor" data-v-79b6e46b>xor</option><option value="multiply" data-v-79b6e46b>multiply</option><option value="screen" data-v-79b6e46b>screen</option><option value="overlay" data-v-79b6e46b>overlay</option><option value="darken" data-v-79b6e46b>darken</option><option value="lighten" data-v-79b6e46b>lighten</option><option value="color-dodge" data-v-79b6e46b>color-dodge</option><option value="color-burn" data-v-79b6e46b>color-burn</option><option value="hard-light" data-v-79b6e46b>hard-light</option><option value="soft-light" data-v-79b6e46b>soft-light</option><option value="difference" data-v-79b6e46b>difference</option><option value="exclusion" data-v-79b6e46b>exclusion</option><option value="hue" data-v-79b6e46b>hue</option><option value="saturation" data-v-79b6e46b>saturation</option><option value="color" data-v-79b6e46b>color</option><option value="luminosity" data-v-79b6e46b>luminosity</option>',23),Qt=Object(r["j"])("label",{for:"addEffect"},"Add new effect",-1),Jt={key:0,class:"value-input-table"},Zt=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"shadow_color"},"Color:")],-1),te=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"filter_x"},"X:")],-1),ee=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"filter_y"},"Y:")],-1),ne=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"filter_blur"},"Blur:")],-1),re={key:1},oe=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"filter_value"},"Value:")],-1),ae=Object(r["i"])("% "),ie={key:2},ce=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"filter_value"},"Value:")],-1);Object(r["p"])();var se=Wt((function(t,e,n,o,a,i){var c=Object(r["u"])("color"),s=Object(r["u"])("d-flow"),u=Object(r["u"])("d-fieldset");return t.showShadowColor?Object(r["j"])(c,{key:0,modelValue:t.shadowColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.shadowColor=e}),format:"rgb",onLeave:e[2]||(e[2]=function(e){return t.showShadowColor=!1})},null,8,["modelValue"]):Object(r["j"])(s,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:Wt((function(){return[qt,Object(r["j"])("div",zt,[Object(r["j"])("button",{onClick:e[3]||(e[3]=function(e){return t.$emit("leave")})},"Back")]),Object(r["j"])("div",Gt,[Yt,Kt,Object(r["B"])(Object(r["j"])("select",{id:"compositionSelect","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.compositionMode=e}),onKeydown:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},[Xt],544),[[r["x"],t.compositionMode]])]),Object(r["j"])(u,{title:"Effects"},{default:Wt((function(){return[Object(r["j"])(s,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:Wt((function(){return[Object(r["j"])(s,{direction:"vertical","no-wraping":""},{default:Wt((function(){return[Qt,Object(r["B"])(Object(r["j"])("select",{id:"addEffect","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.addEffectSelection=e}),onKeydown:e[7]||(e[7]=Object(r["C"])((function(){}),["stop"]))},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.filterTypes,(function(e){return Object(r["o"])(),Object(r["f"])("option",{key:e,value:e},Object(r["v"])(t.getFilterLabel(e)),9,["value"])})),128))],544),[[r["x"],t.addEffectSelection]]),Object(r["j"])("button",{disabled:""===t.addEffectSelection,onClick:e[8]||(e[8]=function(){return t.addFilter.apply(t,arguments)}),onKeydown:e[9]||(e[9]=Object(r["C"])((function(){}),["stop"]))}," Add ",40,["disabled"]),Object(r["j"])("button",{disabled:!t.currentFilter,onClick:e[10]||(e[10]=function(){return t.removeFilter.apply(t,arguments)}),onKeydown:e[11]||(e[11]=Object(r["C"])((function(){}),["stop"]))}," Remove ",40,["disabled"]),Object(r["j"])("button",{disabled:0===t.currentFilterIdx,onClick:e[12]||(e[12]=function(e){return t.moveFilter(-1)}),onKeydown:e[13]||(e[13]=Object(r["C"])((function(){}),["stop"]))}," Move up ",40,["disabled"]),Object(r["j"])("button",{disabled:t.currentFilterIdx===t.filters.length-1,onClick:e[14]||(e[14]=function(e){return t.moveFilter(1)}),onKeydown:e[15]||(e[15]=Object(r["C"])((function(){}),["stop"]))}," Move down ",40,["disabled"])]})),_:1}),Object(r["j"])(s,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:Wt((function(){return[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.filters,(function(e,n){return Object(r["o"])(),Object(r["f"])("div",{key:n,class:{choiceBtn:!0,active:n===t.currentFilterIdx},onClick:function(e){return t.selectFilter(n)}},Object(r["v"])(t.getFilterText(e)),11,["onClick"])})),128))]})),_:1}),t.currentFilter?(Object(r["o"])(),Object(r["f"])("table",Jt,["drop-shadow"===t.currentFilter.type?(Object(r["o"])(),Object(r["f"])(r["a"],{key:0},[Object(r["j"])("tr",null,[Zt,Object(r["j"])("td",null,[Object(r["j"])("button",{id:"shadow_color",class:"color-button",style:{background:t.shadowColor},onClick:e[16]||(e[16]=function(e){return t.showShadowColor=!0})}," Â  ",4)])]),Object(r["j"])("tr",null,[te,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"filter_x",type:"number","onUpdate:modelValue":e[17]||(e[17]=function(e){return t.shadowX=e}),onKeydown:e[18]||(e[18]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.shadowX,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[ee,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"filter_y",type:"number","onUpdate:modelValue":e[19]||(e[19]=function(e){return t.shadowY=e}),onKeydown:e[20]||(e[20]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.shadowY,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[ne,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"filter_blur",type:"number","onUpdate:modelValue":e[21]||(e[21]=function(e){return t.shadowBlur=e}),onKeydown:e[22]||(e[22]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.shadowBlur,void 0,{number:!0}]])])])],64)):t.isPercentFilter?(Object(r["o"])(),Object(r["f"])("tr",re,[oe,Object(r["j"])("td",null,[Object(r["j"])("input",{id:"filter_value",value:(100*t.currentFilter.value).toFixed(),type:"number",max:t.maxValue,min:t.minValue,onInput:e[23]||(e[23]=function(e){return t.setValue({value:Number(e.target.value/100)})}),onKeydown:e[24]||(e[24]=Object(r["C"])((function(){}),["stop"]))},null,40,["value","max","min"]),ae])])):(Object(r["o"])(),Object(r["f"])("tr",ie,[ce,Object(r["j"])("td",null,[Object(r["j"])("input",{id:"filter_value",value:t.currentFilter.value,type:"number",max:t.maxValue,min:t.minValue,onInput:e[25]||(e[25]=function(e){return t.setValue({value:Number(e.target.value)})}),onKeydown:e[26]||(e[26]=Object(r["C"])((function(){}),["stop"]))},null,40,["value","max","min"])])]))])):Object(r["g"])("",!0)]})),_:1})]})),_:1})]})),_:1})})),ue=(n("99af"),n("4ec9"),n("5530")),le=Object(r["l"])({mixins:[S["a"]],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection:function(){return"global"===this.direction?this.$store.state.ui.vertical?"vertical":"horizontal":"inverted"===this.direction?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render:function(){var t=this.noWraping?"no-wraping":"wraping",e={},n=Object(r["m"])("div",Object(ue["a"])(Object(ue["a"])({},e),{},{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize){var o=this.maxSize instanceof Array?this.maxSize["horizontal"===this.finalDirection?0:1]:this.maxSize;return Object(r["m"])("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:Object(Lt["a"])({},"horizontal"===this.finalDirection?"maxWidth":"maxHeight",o)},[n])}return n},mounted:function(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});n("4ffd");le.__scopeId="data-v-01fb80b6";var de=le,be=Object(r["D"])("data-v-5ae5bdec");Object(r["q"])("data-v-5ae5bdec");var pe={class:"column"},fe={class:"hex-selector"};Object(r["p"])();var he=be((function(t,e,n,o,a,i){var c=Object(r["u"])("slider-group");return Object(r["o"])(),Object(r["f"])("div",{class:{color:!0,vertical:t.vertical}},[Object(r["j"])("h2",null,Object(r["v"])(t.title),1),Object(r["j"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"OK"),Object(r["j"])("table",null,[Object(r["j"])("tr",null,[Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[2]||(e[2]=function(e){return t.mode="hsla"})},"HSLA")]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[3]||(e[3]=function(e){return t.mode="rgba"})},"RGBA")])])]),Object(r["j"])("div",pe,[Object(r["j"])(c,{mode:t.mode,modelValue:t.color,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.color=e}),relative:!0},null,8,["mode","modelValue"]),Object(r["j"])("div",fe,[Object(r["j"])("label",{class:"hex-label",for:"hex_".concat(t._.uid)},"Hex",8,["for"]),Object(r["j"])("input",{id:"hex_".concat(t._.uid),modelValue:t.color,onInput:e[5]||(e[5]=function(){return t.updateHex.apply(t,arguments)})},null,40,["id","modelValue"])]),Object(r["j"])("button",{onClick:e[6]||(e[6]=function(){return t.addSwatch.apply(t,arguments)})},"Add as swatch")]),Object(r["j"])("div",{id:"color-swatches",class:{vertical:t.vertical}},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.swatches,(function(e){return Object(r["o"])(),Object(r["f"])("button",{class:"swatch",key:e.color,style:{backgroundColor:e.color},title:e.label,onClick:function(n){t.color=e.color,t.$emit("leave")}},null,12,["title","onClick"])})),128))],2)],2)})),je=n("2909"),ve=Object(r["D"])("data-v-24b7dbc3"),me=ve((function(t,e,n,o,a,i){var c=Object(r["u"])("slider");return Object(r["o"])(),Object(r["f"])("div",null,[Object(r["j"])(c,{label:t.label1,modelValue:t.v1,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.v1=e}),"max-value":t.maxValue1,"gradient-stops":t.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["j"])(c,{label:t.label2,modelValue:t.v2,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.v2=e}),"max-value":t.maxValue2,"gradient-stops":t.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["j"])(c,{label:t.label3,modelValue:t.v3,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.v3=e}),"max-value":t.maxValue3,"gradient-stops":t.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["j"])(c,{label:"Alpha",modelValue:t.a,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.a=e}),"max-value":255,"gradient-stops":t.stopsAlpha},null,8,["modelValue","gradient-stops"])])})),ge=(n("c975"),n("25f0"),n("4d90"),n("498a"),n("d4ec")),Oe=n("bee2"),ye=function(){function t(e,n,r,o){Object(ge["a"])(this,t),this.h=e,this.s=n,this.l=r,this.a=o}return Object(Oe["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,o=this.l,a=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1?r-=e.s:(r+=e.s,r<0&&(r=0)),o+e.l>1||o+e.l<0?o-=e.l:o+=e.l,a+e.a>1||a+e.a<0?a-=e.a:a+=e.a,new t(n,r,o,a)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,o=this.s,a=this.l,i=this.a;if(0===o)t=e=n=a;else{var c=a<.5?a*(1+o):a+o-a*o,s=2*a-c;t=this.hue2rgb(s,c,r+1/3),e=this.hue2rgb(s,c,r),n=this.hue2rgb(s,c,r-1/3)}return new ke(Math.round(255*t),Math.round(255*e),Math.round(255*n),i)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}(),ke=function(){function t(e,n,r,o){Object(ge["a"])(this,t),this.r=e,this.g=n,this.b=r,this.a=o}return Object(Oe["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toHex",value:function(){return"#".concat(Math.round(this.r).toString(16).padStart(2,"0")).concat(Math.round(this.g).toString(16).padStart(2,"0")).concat(Math.round(this.b).toString(16).padStart(2,"0")).concat(Math.round(255*this.a).toString(16).padStart(2,"0"))}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var o,a,i=Math.max(t,e,n),c=Math.min(t,e,n),s=(i+c)/2;if(i===c)o=a=0;else{var u=i-c;switch(a=s>.5?u/(2-i-c):u/(i+c),i){case t:o=(e-n)/u+(e<n?6:0);break;case e:o=(n-t)/u+2;break;case n:o=(t-e)/u+4;break}o/=6}return new ye(o,a,s,r)}},{key:"luminance",get:function(){return Math.sqrt(Math.pow(this.r/255*.299,2)+Math.pow(this.g/255*.587,2)+Math.pow(this.b/255*.114,2))}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),o=n.slice(r+1),a=o.split(",").map((function(t){return parseFloat(t.trim())}));return new t(a[0],a[1],a[2],4===a.length?a[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();ke.rgbEx=/^rgb\((\d*?)\,(\d*?)\,(\d*?)\)$/i,ke.rgbaEx=/^rgba\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\,([\d\.]+)\)$/i,ke.hexShortEx=/^\#[0-9A-Z]{3,4}$/i,ke.hexLongEx=/^\#[0-9A-Z]{6,8}$/i;var xe=Object(r["D"])("data-v-cbe5aa08");Object(r["q"])("data-v-cbe5aa08");var we={stroke:"#ffbde1"};Object(r["p"])();var Ce=xe((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",{class:{slider:!0,vertical:t.vertical},onKeydown:e[9]||(e[9]=Object(r["C"])((function(){}),["stop"]))},[Object(r["j"])("label",{for:t._.uid},Object(r["v"])(t.label),9,["for"]),Object(r["j"])("div",null,[(Object(r["o"])(),Object(r["f"])("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:e[1]||(e[1]=function(){return t.enterSlide.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.enterSlide.apply(t,arguments)}),onMousemove:e[3]||(e[3]=function(){return t.moveSlide.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.moveSlide.apply(t,arguments)}),onMouseup:e[5]||(e[5]=function(){return t.exitSlide.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.exitSlide.apply(t,arguments)})},[Object(r["j"])("defs",null,[Object(r["j"])("linearGradient",{id:"gradient".concat(t._.uid),x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.gradientStops,(function(e,n){return Object(r["o"])(),Object(r["f"])("stop",{key:n,offset:n/(t.gradientStops.length-1)*100+"%",style:"stop-color:"+e},null,12,["offset"])})),128))],8,["id"])]),Object(r["j"])("g",we,[Object(r["j"])("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:"url(#gradient".concat(t._.uid,")")},null,8,["fill"]),Object(r["j"])("path",{d:t.pointerPath,"stroke-width":"2",fill:"#000000"},null,8,["d"])])],544))]),Object(r["j"])("input",{id:t._.uid,class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:e[7]||(e[7]=function(e){return t.$emit("input",parseFloat(e.target.value))}),onKeydown:e[8]||(e[8]=Object(r["C"])((function(){}),["stop"]))},null,40,["id","max","value"])],34)})),Se=255,Pe=8,Re=Object(r["l"])({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0}},data:function(){return{slideActive:!1}},computed:{vertical:function(){return this.$store.state.ui.vertical},pointerPath:function(){var t=this.modelValue/this.maxValue*Se;return"M".concat(t," 0L").concat(t+14," 0L").concat(t+7," 12Z")}},methods:{enterSlide:function(t){this.slideActive=!0,this.gradientStops,this.moveSlide(t)},moveSlide:function(t){if(this.slideActive){var e=this.$refs.svg;if(e.contains(t.target)||t.target===e)if(t instanceof MouseEvent&&1!==t.which)this.slideActive=!1;else{var n=e.getBoundingClientRect(),r=n.width/(Pe+Se+Pe),o=(t instanceof MouseEvent?t.clientX:t.touches[0].clientX)-n.x,a=o/r;t.preventDefault();var i=Math.max(Math.min(a-Pe,Se),0)/Se*this.maxValue;this.$emit("update:modelValue",i)}}},exitSlide:function(){this.slideActive=!1}}});n("3997");Re.render=Ce,Re.__scopeId="data-v-cbe5aa08";var Ie=Re,Te=Object(r["l"])({components:{Slider:Ie},props:{modelValue:{type:String,validator:function(t){return!!t.match(/^#[0-9a-f]{6,8}$/i)}},mode:{type:String},relative:Boolean},data:function(){return{lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}},computed:{vertical:function(){return this.$store.state.ui.vertical},maxValue1:function(){return"rgba"===this.mode?255:360},label1:function(){return"rgba"===this.mode?"Red":"Hue"},stops1:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v2:0,n=this.relative?this.v3:0;t=[new ke(0,e,n,1),new ke(255,e,n,1)]}else{var r=this.relative?this.v2/100:1,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new ye(t,r,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue2:function(){return"rgba"===this.mode?255:100},label2:function(){return"rgba"===this.mode?"Green":"Saturation"},stops2:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v3:0;t=[new ke(e,0,n,1),new ke(e,255,n,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new ye(r,t,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue3:function(){return"rgba"===this.mode?255:100},label3:function(){return"rgba"===this.mode?"Blue":"Luminosity"},stops3:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v2:0;t=[new ke(e,n,0,1),new ke(e,n,255,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v2/100:.5;t=this.eightsStops((function(t){return new ye(r,o,t,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},stopsAlpha:function(){var t=ke.fromHex(this.modelValue);return[new ke(t.r,t.g,t.b,0).toCss(),new ke(t.r,t.g,t.b,1).toCss()]}},created:function(){this.initValues()},methods:{valueChanged:function(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue:function(){var t;t="rgba"===this.mode?new ke(this.v1,this.v2,this.v3,this.a/255):new ye(this.v1/360,this.v2/100,this.v3/100,this.a/255);var e=t.toRgb().toHex();if(this.lastRGBEmit!==e){if(9!==e.length)throw new Error("Invalid color code: ".concat(e));this.lastRGBEmit=e,this.$emit("update:modelValue",e)}},initValues:function(){var t=ke.fromHex(this.modelValue);if(this.lastRGBEmit=t.toHex(),this.a=255*t.a,"hsla"===this.mode){var e=t.toHSL();this.v1=360*e.h,this.v2=100*e.s,this.v3=100*e.l}else this.v1=t.r,this.v2=t.g,this.v3=t.b},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}},watch:{value:function(){this.valueChanged()},v1:function(){this.updateValue()},v2:function(){this.updateValue()},v3:function(){this.updateValue()},a:function(){this.updateValue()},mode:function(){this.initValues()}}});n("02e0");Te.render=me,Te.__scopeId="data-v-24b7dbc3";var Ae=Te,_e="dddg.generated.colors",$e=Object(r["l"])({components:{SliderGroup:Ae},props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:function(){return{mode:"hsla",relative:!0}},computed:{vertical:function(){return this.$store.state.ui.vertical},swatches:function(){return this.$store.state.content.current.colors},color:{get:function(){if("rgb"===this.format){var t=ke.fromCss(this.modelValue);return t.toHex()}return this.modelValue},set:function(t){if("rgb"===this.format){var e=ke.fromCss(t);this.$emit("update:modelValue",e.toCss())}else this.$emit("update:modelValue",t)}}},methods:{updateHex:function(t){var e=t.target.value;!ke.validHex(e)||7!==e.length&&9!==e.length||(this.color=e)},addSwatch:function(){var t=this;if(!this.swatches.find((function(e){return e.color===t.color}))){var e=this.$store.state.content.contentPacks.find((function(t){return"generatedPackId"===t.packId}))||{packId:_e,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},n=Object(ue["a"])(Object(ue["a"])({},e),{},{colors:[].concat(Object(je["a"])(e.colors),[{label:this.color,color:this.color}])});this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!0})}))}}}});n("014c");$e.render=he,$e.__scopeId="data-v-5ae5bdec";var Be=$e,Ve=(n("c740"),n("a434"),n("61ea")),De=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);var Le=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),Fe=Array.from(Le.keys()).sort(),He=Object(r["l"])({components:{DFlow:de,DFieldset:Pt["a"],Color:Be},props:{type:{type:String,required:!0},title:{type:String,required:!0},id:{required:!0}},data:function(){return{addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}},computed:{object:function(){switch(this.type){case"object":return this.$store.state.objects.objects[this.id];case"background":return this.$store.state.panels.panels[this.id].background;case"panel":return this.$store.state.panels.panels[this.id];default:return Object(Ve["a"])(this.type),null}},compositionMode:{get:function(){return this.object.composite},set:function(t){var e=this;this.vuexHistory.transaction((function(){switch(e.type){case"object":e.$store.commit("objects/setComposition",{id:e.id,composite:t});break;case"background":break;case"panel":break;default:Object(Ve["a"])(e.type);break}}))}},filters:function(){return this.object.filters},filterTypes:function(){return Fe},currentFilter:function(){return this.filters[this.currentFilterIdx]||null},isPercentFilter:function(){var t=this.currentFilter;return!!t&&De.has(t.type)},maxValue:function(){var t=this.currentFilter;if(t)return"hue-rotate"===t.type?360:"grayscale"===t.type||"sepia"===t.type||"opacity"===t.type||"invert"===t.type?100:void 0},minValue:function(){var t=this.currentFilter;if(t)switch(t.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get:function(){var t=this.currentFilter;if(t&&"color"in t)return t.color},set:function(t){this.setValue({color:t})}},shadowX:{get:function(){var t=this.currentFilter;if(t&&"offsetX"in t)return t.offsetX},set:function(t){this.setValue({offsetX:t})}},shadowY:{get:function(){var t=this.currentFilter;if(t&&"offsetY"in t)return t.offsetY},set:function(t){this.setValue({offsetY:t})}},shadowBlur:{get:function(){var t=this.currentFilter;if(t&&"blurRadius"in t)return t.blurRadius},set:function(t){this.setValue({blurRadius:t})}}},methods:{getFilterLabel:function(t){return Le.get(t)},getFilterText:function(t){return De.has(t.type)?"".concat(Le.get(t.type)," ").concat((100*t.value).toFixed(),"%"):"hue-rotate"===t.type?"".concat(Le.get(t.type)," ").concat(t.value.toFixed(),"Â°"):"blur"===t.type?"".concat(Le.get(t.type)," ").concat(t.value.toFixed(),"px"):Le.get(t.type)},addFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addFilter",{id:t.id,type:t.addEffectSelection,idx:t.currentFilterIdx+1})}))},selectFilter:function(t){this.currentFilterIdx=t},removeFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeFilter",{id:t.id,idx:t.currentFilterIdx})}))},moveFilter:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/moveFilter",{id:e.id,idx:e.currentFilterIdx,moveBy:t}),e.currentFilterIdx+=t}))},setValue:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setFilter",Object(ue["a"])({id:e.id,idx:e.currentFilterIdx},t))}))}}});n("3970");He.render=se,He.__scopeId="data-v-79b6e46b";var Ee=He,Me=Object(r["D"])("data-v-47f2e1e8");Object(r["q"])("data-v-47f2e1e8");var Ue=Object(r["j"])("i",{class:"material-icons"},"extension",-1),Ne=Object(r["j"])("span",{class:"text-block"},"Create new expressions",-1),We=Object(r["j"])("i",{class:"material-icons"},"extension",-1),qe=Object(r["j"])("span",{class:"text-block"},"Search in content packs",-1),ze=Object(r["j"])("i",{class:"material-icons"},"extension",-1),Ge=Object(r["j"])("span",null,"Search in content packs",-1),Ye=Object(r["j"])("i",{class:"material-icons"},"extension",-1),Ke=Object(r["j"])("span",null,"Search in content packs",-1);Object(r["p"])();var Xe=Me((function(t,e,n,o,a,i){var c=Object(r["u"])("part-button"),s=Object(r["u"])("d-flow"),u=Object(r["u"])("d-fieldset");return Object(r["o"])(),Object(r["f"])(s,{"no-wraping":""},{default:Me((function(){return[Object(r["j"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"Back"),"head"===t.part?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:e[2]||(e[2]=function(e){return t.$emit("show-expression-dialog",{character:t.character.characterType})}),class:"icon-button"},[Ue,Ne])):Object(r["g"])("",!0),"head"===t.part?(Object(r["o"])(),Object(r["f"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.$emit("show-dialog","type: Expressions character: "+t.charData.label)}),class:"icon-button"},[We,qe])):"style"===t.part?(Object(r["o"])(),Object(r["f"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Styles character: "+t.charData.label)}),class:"icon-button"},[ze,Ge])):(Object(r["o"])(),Object(r["f"])("button",{key:3,onClick:e[5]||(e[5]=function(e){return t.$emit("show-dialog","type: Poses character: "+t.charData.label)}),class:"icon-button"},[Ye,Ke])),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.parts,(function(e,n){return Object(r["o"])(),Object(r["f"])(c,{key:n,value:n,part:e,onClick:function(e){t.choose(n),t.$emit("leave")}},null,8,["value","part","onClick"])})),128)),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.styleComponents,(function(e){return Object(r["o"])(),Object(r["f"])(u,{key:e.name,title:e.label},{default:Me((function(){return[Object(r["j"])(s,{noWraping:""},{default:Me((function(){return[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(e.buttons,(function(n,o){return Object(r["o"])(),Object(r["f"])(c,{size:130,key:o,value:o,part:n,onClick:function(n){return t.choose_component(e.name,o)}},null,8,["value","part","onClick"])})),128))]})),_:2},1024)]})),_:2},1032,["title"])})),128))]})),_:1})})),Qe=Object(r["D"])("data-v-002d03a0"),Je=Qe((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",{class:{part:!0,active:!1},style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("click")})},null,4)})),Ze=(n("5319"),960),tn=Object(r["l"])({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:function(){return{lookups:[],loaded:!1}},computed:{scaleX:function(){return this.size/this.part.size[0]},scaleY:function(){return this.size/this.part.size[1]},backgroundSize:function(){return"".concat(Math.floor(Ze*this.scaleX),"px ").concat(Math.floor(Ze*this.scaleY),"px")},backgroundPosition:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")},style:function(){var t=this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")}));return{backgroundImage:t.join(","),height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize}}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.part.images.map((function(t){return"string"===typeof t.asset?Object(z["b"])(t.asset,!1):Object(z["a"])(t.asset,!1)})));case 2:t.lookups=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("f704");tn.render=Je,tn.__scopeId="data-v-002d03a0";var en=tn,nn=Object(r["l"])({components:{PartButton:en,DFieldset:Pt["a"],DFlow:de},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:function(){return{isWebPSupported:null,stylePriorities:[]}},computed:{vertical:function(){return this.$store.state.ui.vertical},styleComponents:function(){if("style"!==this.part)return[];var t=this.charData.styleGroups[this.character.styleGroupId];return t.styleComponents.map((function(e){var n={};for(var r in e.variants)if(e.variants.hasOwnProperty(r)){var o=e.variants[r];n[r]={size:t.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:o}]}}return{label:e.label,name:e.id,buttons:n}}))},parts:function(){var t,e,n,r={},o=this.charData,a=Object(ft["h"])(o,this.character);switch(this.part){case"head":for(var i=0;i<a.compatibleHeads.length;++i)for(var c=a.compatibleHeads[i],s=o.heads[c],u=0;u<s.variants.length;++u){var l=s.variants[u];r["".concat(i,"_").concat(u)]={size:s.previewSize,offset:s.previewOffset,images:l.map((function(t){return{asset:t,offset:[0,0]}}))}}return r;case"pose":for(var d=o.styleGroups[this.character.styleGroupId].styles[this.character.styleId],b=0;b<d.poses.length;++b){var p=d.poses[b];r[b]=this.generatePosePreview(p)}return r;case"style":var f,h=Object(q["a"])(o.styleGroups);try{for(h.s();!(f=h.n()).done;){var j=f.value;r[j.id]=this.generatePosePreview(j.styles[0].poses[0])}}catch(g){h.e(g)}finally{h.f()}return r;default:t=a.positions[this.part],n=a.previewSize,e=a.previewOffset;break}for(var v=0;v<t.length;++v){var m=t[v];r[v]={images:m.map((function(t){return{offset:[0,0],asset:t}})),size:n,offset:e}}return r},charData:function(){return Object(ft["e"])(this.$store,this.character)}},methods:{updateStyleData:function(){var t=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(t.components).map((function(e){return[e,t.components[e]]}))},generatePosePreview:function(t){var e,n=this.charData,r=n.heads[t.compatibleHeads[0]],o=r?r.variants[0]:null,a=[],i=Object(q["a"])(t.renderCommands);try{for(i.s();!(e=i.n()).done;){var c=e.value;switch(c.type){case"pose-part":var s=t.positions[c.part];if(!s||0===s.length)break;a=a.concat(s[0]);break;case"head":o&&(a=a.concat(o));break;case"image":a=a.concat(c.images);break}}}catch(u){i.e(u)}finally{i.f()}return{images:a.map((function(t){return{asset:t,offset:[0,0]}})),size:t.previewSize,offset:t.previewOffset}},updatePose:function(t){var e=this;void 0===t&&(t=this.character.styleGroupId);var n,r=this.charData,o=r.styleGroups[t],a=o.styles,i=Object(q["a"])(this.stylePriorities);try{var c=function(){var t=n.value,e=a.filter((function(e){return e.components[t[0]]===t[1]}));e.length>0&&(a=e)};for(i.s();!(n=i.n()).done;)c()}catch(s){i.e(s)}finally{i.f()}this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setCharStyle",{id:e.character.id,styleGroupId:t,styleId:o.styles.indexOf(a[0])})}))},choose:function(t){if("style"===this.part)this.updatePose(this.charData.styleGroups.findIndex((function(e){return e.id===t})));else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(u["a"])(e,2),r=n[0],o=n[1];this.$store.commit("objects/setPosePosition",{id:this.character.id,posePositions:{headType:r,head:o}})}else this.setPart(this.part,parseInt(t,10))},choose_component:function(t,e){var n=this.stylePriorities.findIndex((function(e){return e[0]===t}));this.stylePriorities.splice(n,1),this.stylePriorities.unshift([t,e]),this.updatePose()},setPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateStyleData(),e.next=3,Object(z["e"])();case 3:t.isWebPSupported=e.sent;case 4:case"end":return e.stop()}}),e)})))()},watch:{character:function(){this.updateStyleData()}}});n("1c59");nn.render=Xe,nn.__scopeId="data-v-47f2e1e8";var rn=nn,on=Ft(),an=Object(r["l"])({mixins:[P],components:{Toggle:C["a"],PositionAndSize:Tt,Layers:Et,Delete:Nt,Parts:rn,DFieldset:Pt["a"],ImageOptions:Ee},data:function(){return{imageOptionsOpen:!1,panelForParts:null}},computed:{flip:on("flip","objects/setFlip"),closeUp:on("close","objects/setClose"),selection:function(){return this.$store.state.ui.selection},object:function(){var t=this.$store.state.objects.objects[this.selection];if("character"===t.type)return t},charData:function(){return Object(ft["e"])(this.$store,this.object)},label:function(){return this.charData.label||""},parts:function(){return Object(ft["g"])(this.charData,this.object)},hasMultipleStyles:function(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses:function(){var t=this.charData.styleGroups[this.object.styleGroupId],e=t.styles[this.object.styleId];return e.poses.length>1}},methods:{seekPose:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.object.id,delta:t})}))},seekStyle:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.object.id,delta:t})}))},seekPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.object.id,delta:e,part:t})}))},captialize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},watch:{selection:function(){this.panelForParts=null}}});n("b6f6");an.render=pt,an.__scopeId="data-v-6d0ef99f";var cn=an,sn={class:"panel"},un=Object(r["j"])("h1",null,"Custom Sprite",-1);function ln(t,e,n,o,a,i){var c=Object(r["u"])("image-options"),s=Object(r["u"])("position-and-size"),u=Object(r["u"])("layers"),l=Object(r["u"])("toggle"),d=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",sn,[t.imageOptionsOpen?Object(r["j"])(c,{key:0,type:"object",title:"Custom Sprite",id:t.object.id,onLeave:e[1]||(e[1]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:1},[un,Object(r["j"])(s,{obj:t.object},null,8,["obj"]),Object(r["j"])(u,{object:t.object},null,8,["object"]),Object(r["j"])(l,{modelValue:t.flip,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])("button",{onClick:e[3]||(e[3]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(d,{obj:t.object},null,8,["obj"])],64))])}var dn=Object(r["l"])({mixins:[P],components:{Toggle:C["a"],PositionAndSize:Tt,Layers:Et,Delete:Nt,ImageOptions:Ee},data:function(){return{imageOptionsOpen:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t},flip:Ft()("flip","objects/setFlip")}});dn.render=ln;var bn=dn,pn=Object(r["D"])("data-v-6a66463a");Object(r["q"])("data-v-6a66463a");var fn={class:"panel"},hn=Object(r["j"])("h1",null,"Textbox",-1),jn={class:"upper-combos"},vn=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"text_style"},"Style:")],-1),mn=Object(r["j"])("option",{value:"normal"},"Normal",-1),gn=Object(r["j"])("option",{value:"corrupt"},"Corrupt",-1),On=Object(r["j"])("option",{value:"custom"},"Custom",-1),yn=Object(r["j"])("option",{value:"none"},"None",-1),kn=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"current_talking"},"Person talking:")],-1),xn=Object(r["h"])('<option value="No-one" data-v-6a66463a>No-one</option><option value="Sayori" data-v-6a66463a>Sayori</option><option value="Yuri" data-v-6a66463a>Yuri</option><option value="Natsuki" data-v-6a66463a>Natsuki</option><option value="Monika" data-v-6a66463a>Monika</option><option value="FeMC" data-v-6a66463a>FeMC</option><option value="MC" data-v-6a66463a>MC</option><option value="Chad" data-v-6a66463a>Chad</option><option value="Amy" data-v-6a66463a>Amy</option><option value="Other" data-v-6a66463a>Other</option>',10),wn=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"custom_name"},"Other name:")],-1),Cn={id:"dialog_text_wrapper"},Sn=Object(r["j"])("label",{for:"dialog_text"},"Dialog:",-1),Pn={key:0},Rn=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"textbox_color"},"Color:")],-1),In=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"custom_namebox_width"},"Namebox width:")],-1),Tn={colspan:"2"},An=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"custom_controls_color"},"Controls Color:")],-1),_n=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"custom_namebox_color"},"Namebox Color:")],-1),$n=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1);Object(r["p"])();var Bn=pn((function(t,e,n,o,a,i){var c=Object(r["u"])("color"),s=Object(r["u"])("text-editor"),u=Object(r["u"])("image-options"),l=Object(r["u"])("toggle"),d=Object(r["u"])("position-and-size"),b=Object(r["u"])("layers"),p=Object(r["u"])("d-fieldset"),f=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",fn,[hn,""!==t.colorSelect?Object(r["j"])(c,{key:0,title:t.colorName,modelValue:t.color,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.color=e}),onLeave:e[2]||(e[2]=function(e){return t.colorSelect=""})},null,8,["title","modelValue"]):""!==t.textEditor?Object(r["j"])(s,{key:1,title:t.textEditorName,modelValue:t.textEditorText,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.textEditorText=e}),onLeave:e[4]||(e[4]=function(e){return t.textEditor=""})},null,8,["title","modelValue"]):t.imageOptionsOpen?Object(r["j"])(u,{key:2,type:"object",title:"Textbox",id:t.object.id,onLeave:e[5]||(e[5]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:3},[Object(r["j"])("table",jn,[Object(r["j"])("tr",null,[vn,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("select",{id:"text_style","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.textBoxStyle=e}),onKeydown:e[7]||(e[7]=Object(r["C"])((function(){}),["stop"]))},[mn,gn,On,yn],544),[[r["x"],t.textBoxStyle]])])]),Object(r["j"])("tr",null,[kn,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("select",{id:"current_talking","onUpdate:modelValue":e[8]||(e[8]=function(e){return t.talkingDefaults=e}),onKeydown:e[9]||(e[9]=Object(r["C"])((function(){}),["stop"]))},[xn],544),[[r["x"],t.talkingDefaults]])])]),Object(r["j"])("tr",null,[wn,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"custom_name","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.talkingOther=e}),onKeydown:e[11]||(e[11]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.talkingOther]]),Object(r["j"])("button",{onClick:e[12]||(e[12]=function(e){return t.textEditor="name"})},"...")])])]),Object(r["j"])(l,{label:"Auto quoting?",modelValue:t.autoQuoting,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.autoQuoting=e})},null,8,["modelValue"]),Object(r["j"])(l,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["j"])("div",Cn,[Sn,Object(r["B"])(Object(r["j"])("textarea",{"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.dialog=e}),id:"dialog_text",onKeydown:e[16]||(e[16]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.dialog]]),Object(r["j"])("button",{onClick:e[17]||(e[17]=function(e){return t.textEditor="body"})},"Formatting")]),Object(r["j"])(d,{obj:t.object},null,8,["obj"]),Object(r["j"])("button",{onClick:e[18]||(e[18]=function(){return t.resetPosition.apply(t,arguments)})},"Reset position"),Object(r["j"])("button",{onClick:e[19]||(e[19]=function(){return t.splitTextbox.apply(t,arguments)})},"Split textbox"),Object(r["j"])(b,{object:t.object},null,8,["object"]),Object(r["j"])(l,{modelValue:t.flip,"onUpdate:modelValue":e[20]||(e[20]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])(p,{title:"Customization:"},{default:pn((function(){return[Object(r["j"])(l,{label:"Controls visible?",modelValue:t.showControls,"onUpdate:modelValue":e[21]||(e[21]=function(e){return t.showControls=e})},null,8,["modelValue"]),Object(r["j"])(l,{label:"Able to skip?",modelValue:t.allowSkipping,"onUpdate:modelValue":e[22]||(e[22]=function(e){return t.allowSkipping=e})},null,8,["modelValue"]),Object(r["j"])(l,{label:"Continue arrow?",modelValue:t.showContinueArrow,"onUpdate:modelValue":e[23]||(e[23]=function(e){return t.showContinueArrow=e})},null,8,["modelValue"]),"custom"===t.textBoxStyle?(Object(r["o"])(),Object(r["f"])("table",Pn,[Object(r["j"])("tr",null,[Rn,Object(r["j"])("td",null,[Object(r["j"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.customColor},onClick:e[24]||(e[24]=function(e){return t.colorSelect="base"})},null,4)])]),Object(r["j"])("tr",null,[In,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},"onUpdate:modelValue":e[25]||(e[25]=function(e){return t.customNameboxWidth=e}),onKeydown:e[26]||(e[26]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.customNameboxWidth,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[Object(r["j"])("td",Tn,[Object(r["j"])(l,{id:"derive_custom_colors",modelValue:t.deriveCustomColors,"onUpdate:modelValue":e[27]||(e[27]=function(e){return t.deriveCustomColors=e}),label:"Derive other colors"},null,8,["modelValue"])])]),t.deriveCustomColors?Object(r["g"])("",!0):(Object(r["o"])(),Object(r["f"])(r["a"],{key:0},[Object(r["j"])("tr",null,[An,Object(r["j"])("td",null,[Object(r["j"])("button",{id:"custom_controls_color",class:"color-button",style:{background:t.object.customControlsColor},onClick:e[28]||(e[28]=function(e){return t.colorSelect="controls"})},null,4)])]),Object(r["j"])("tr",null,[_n,Object(r["j"])("td",null,[Object(r["j"])("button",{id:"custom_namebox_color",class:"color-button",style:{background:t.object.customNameboxColor},onClick:e[29]||(e[29]=function(e){return t.colorSelect="namebox"})},null,4)])]),Object(r["j"])("tr",null,[$n,Object(r["j"])("td",null,[Object(r["j"])("button",{id:"custom_namebox_stroke",class:"color-button",style:{background:t.object.customNameboxStroke},onClick:e[30]||(e[30]=function(e){return t.colorSelect="nameboxStroke"})},null,4)])])],64))])):Object(r["g"])("",!0)]})),_:1}),Object(r["j"])("button",{onClick:e[31]||(e[31]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(f,{obj:t.object},null,8,["obj"])],64))])})),Vn=Object(r["D"])("data-v-7ba8b720");Object(r["q"])("data-v-7ba8b720");var Dn={class:"column ok-col"},Ln={class:"column"},Fn={key:0,class:"column error-col"},Hn={class:"column"},En=Object(r["j"])("p",{class:"hint-col"},"Apply style to selected text:",-1),Mn={class:"column"},Un={class:"column"},Nn={class:"column"},Wn=Object(r["h"])('<option value data-v-7ba8b720>Font</option><option value="aller" style="font-family:aller;" data-v-7ba8b720>Aller (Textbox)</option><option value="riffic" style="font-family:riffic;" data-v-7ba8b720>Riffic (Bold text)</option><option value="hashtag" style="font-family:hashtag;" data-v-7ba8b720>Hashtag (Sayori)</option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-7ba8b720>Ammy&#39;s Handwriting (Natsuki)</option><option value="journal" style="font-family:journal;" data-v-7ba8b720>Journal (Monika)</option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-7ba8b720>JP Hand Slanted (Yuri)</option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-7ba8b720>Damagrafik (Yuri, Act 2)</option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-7ba8b720>As I Lay Dying (Yuri, Act Unused)</option><option value="halogen" style="font-family:halogen;" data-v-7ba8b720>Halogen (MC)</option>',10);Object(r["p"])();var qn=Vn((function(t,e,n,o,a,i){var c=Object(r["u"])("color");return t.colorSelector?Object(r["j"])(c,{key:0,modelValue:t.selectedColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.selectedColor=e}),onLeave:t.applyColor},null,8,["modelValue","onLeave"]):(Object(r["o"])(),Object(r["f"])("div",{key:1,class:{"text-subpanel":!0,vertical:t.vertical}},[Object(r["j"])("h2",null,Object(r["v"])(t.title),1),Object(r["j"])("div",Dn,[Object(r["j"])("button",{onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},"OK")]),Object(r["j"])("div",Ln,[Object(r["j"])("textarea",{ref:"textArea",value:t.modelValue,onInput:e[3]||(e[3]=function(){return t.onValueChanged.apply(t,arguments)}),onKeydown:e[4]||(e[4]=Object(r["C"])((function(){}),["stop"])),onKeypress:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},null,40,["value"])]),t.error?(Object(r["o"])(),Object(r["f"])("div",Fn,Object(r["v"])(t.error),1)):Object(r["g"])("",!0),Object(r["j"])("div",Hn,[Object(r["j"])("button",{onClick:e[6]||(e[6]=function(e){return t.insertText("\\\\")}),class:"style-button"},"Insert \\"),Object(r["j"])("button",{onClick:e[7]||(e[7]=function(e){return t.insertText("\\{")}),class:"style-button"},"Insert {"),Object(r["j"])("button",{onClick:e[8]||(e[8]=function(e){return t.insertText("\\}")}),class:"style-button"},"Insert }")]),En,Object(r["j"])("div",Mn,[Object(r["j"])("button",{onClick:e[9]||(e[9]=function(e){return t.insertCommand("b")}),class:"style-button",style:{"font-weight":"bold"}}," Bold "),Object(r["j"])("button",{onClick:e[10]||(e[10]=function(e){return t.insertCommand("i")}),class:"style-button",style:{"font-style":"italic"}}," Italics "),Object(r["j"])("button",{onClick:e[11]||(e[11]=function(e){return t.insertCommand("plain")}),class:"style-button"}," Plain "),Object(r["j"])("button",{onClick:e[12]||(e[12]=function(e){return t.insertCommand("edited")}),class:"style-button edited-style"}," Edited "),Object(r["j"])("button",{onClick:e[13]||(e[13]=function(e){return t.insertCommand("k",2)}),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),Object(r["j"])("div",Un,[Object(r["j"])("button",{onClick:e[14]||(e[14]=function(e){return t.insertCommand("alpha",.5)}),class:"style-button"}," Alpha ")]),Object(r["j"])("div",Nn,[Object(r["j"])("button",{onClick:e[15]||(e[15]=function(e){return t.insertCommand("size",12)}),class:"style-button",style:{"font-size":"20px"}}," Font size "),Object(r["B"])(Object(r["j"])("select",{"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.selectedFont=e}),class:"style-button"},[Wn],512),[[r["x"],t.selectedFont]]),Object(r["j"])("button",{onClick:e[17]||(e[17]=function(e){return t.selectColor("text")}),class:"style-button"}," Text color "),Object(r["j"])("button",{onClick:e[18]||(e[18]=function(e){return t.selectColor("outline")}),class:"style-button"}," Outline color ")])],2))})),zn=5,Gn=function(){function t(e){Object(ge["a"])(this,t),this.str=e,this.i=0}return Object(Oe["a"])(t,[{key:"current",value:function(){return this.str[this.i]}},{key:"next",value:function(){return++this.i,this.current()}},{key:"pos",get:function(){return this.i}},{key:"around",get:function(){return this.str.slice(Math.max(0,this.i-zn),this.i+zn)}},{key:"ahead",get:function(){return this.str[this.i+1]}},{key:"behind",get:function(){return this.str[this.i+1]}}]),t}();function Yn(t){var e=[],n=new Gn(t),r=Kn;while(r!==Xn)r=r(e,n);return e}function Kn(t,e){return void 0===e.current()?Xn:"{"===e.current()?Zn:"\n"===e.current()?tr:Qn}function Xn(){return Xn}function Qn(t,e){var n,r=e.pos,o="",a=!1;while(1){if(void 0===e.current()){n=Xn;break}if(a)o+=e.current(),a=!1;else if("\\"===e.current())a=!0;else{if("{"===e.current()||"\n"===e.current()){n=Kn;break}o+=e.current()}e.next()}return t.push({type:"text",pos:r,content:o}),n}function Jn(t,e){throw new Error("Error at position ".concat(t.pos,": (around: ").concat(t.around,") ").concat(e))}function Zn(t,e){var n=e.pos;if("{"!==e.current())throw new Error("Parser error: Command does not start with {");var r="/"===e.next();r&&e.next();var o="",a="",i=!1;while(1){if(void 0===e.current()&&Jn(e,"Unexpected end of text inside a command"),"}"===e.current())break;i?a+=e.current():e.current().match(/[a-z]/i)?o+=e.current():"="===e.current()?(r&&Jn(e,"Closing commands may not contain arguments"),i=!0):Jn(e,"Unexpected character in command name."),e.next()}return e.next(),r?t.push({type:"commandClose",commandName:o,pos:n}):t.push({type:"command",pos:n,argument:a,commandName:o}),Kn}function tr(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),Kn}var er=new Map([nr("i",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isItalic:!0})})),nr("b",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isBold:!0})})),nr("u",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isUnderlined:!0})})),nr("s",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isStrikethrough:!0})})),nr("plain",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})})),nr("edited",(function(t){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})})),rr("k",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{letterSpacing:e?t.letterSpacing+n:n})})),rr("size",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontSize:e?t.fontSize+n:n})})),rr("alpha",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{alpha:e?t.alpha+n:n})})),rr("stroke",(function(t,e,n){return Object(ue["a"])(Object(ue["a"])({},t),{},{strokeWidth:e?t.strokeWidth+n:n})})),["font",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{fontName:e})}],["color",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{color:e})}],["outlinecolor",function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{strokeColor:e})}]]);function nr(t,e){return[t,function(n,r){if(r)throw new Error("Operator '".concat(t,"' does not take any arguments."));return e(n)}]}function rr(t,e){return[t,function(n,r){if(!r)throw new Error("Operator '".concat(t,"' needs an argument."));var o="+"===r[0]||"-"===r[0],a=Number(r);if(isNaN(a))throw new Error("Operator '".concat(t,"' needs a numeric argument."));return e(n,o,a)}]}var or=function(){function t(e,n){Object(ge["a"])(this,t),this.str=e,this.baseStyle=n,this.tokens=Yn(e),this.rebuildParts()}return Object(Oe["a"])(t,[{key:"rebuildParts",value:function(){this.renderParts=this.getRenderParts(this.tokens,this.baseStyle)}},{key:"loadFonts",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i,c,s,u,l,d,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("fonts"in document){t.next=2;break}return t.abrupt("return");case 2:e=new Set,n=null,r=Object(q["a"])(this.renderParts),t.prev=5,r.s();case 7:if((o=r.n()).done){t.next=14;break}if(a=o.value,"style"in a){t.next=11;break}return t.abrupt("continue",12);case 11:a.style!==n&&(n=a.style,n.fontName&&e.add(n.fontName));case 12:t.next=7;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:i=!1,c=Object(q["a"])(e),t.prev=24,c.s();case 26:if((s=c.n()).done){t.next=36;break}if(u=s.value,l=document,d="8px ".concat(u),l.fonts.check(d)){t.next=34;break}return i=!0,t.next=34,l.fonts.load(d);case 34:t.next=26;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t["catch"](24),c.e(t.t1);case 41:return t.prev=41,c.f(),t.finish(41);case 44:i&&(b=Yn(this.str),this.renderParts=this.getRenderParts(b,this.baseStyle));case 45:case"end":return t.stop()}}),t,this,[[5,16,19,22],[24,38,41,44]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(t){t.save();var e,n=null,r=Object(q["a"])(this.renderParts);try{for(r.s();!(e=r.n()).done;){var o=e.value;"newline"!==o.type&&(o.style!==n&&(n=o.style,lr(n,t)),n.strokeWidth>0&&n.strokeColor>""&&t.strokeText(o.character,o.x,o.y))}}catch(s){r.e(s)}finally{r.f()}var a,i=Object(q["a"])(this.renderParts);try{for(i.s();!(a=i.n()).done;){var c=a.value;"newline"!==c.type&&(c.style!==n&&(n=c.style,lr(n,t)),t.fillText(c.character,c.x,c.y))}}catch(s){i.e(s)}finally{i.f()}t.restore()}},{key:"quote",value:function(){var t;(function(t){t[t["None"]=0]="None",t[t["ExplictQuote"]=1]="ExplictQuote",t[t["ImplictQuote"]=2]="ImplictQuote",t[t["Star"]=3]="Star"})(t||(t={}));for(var e=-1,n=t.None,r=0;r<this.renderParts.length;++r){var o=this.renderParts[r];if("character"===o.type)switch(n){case t.None:if(o.character.match(/\s/))continue;'"'===o.character?(n=t.ExplictQuote,e=r):"*"===o.character?(n=t.Star,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:cr(o.style,'"')}),r++,e=r,n=t.ImplictQuote);break;case t.ExplictQuote:e=r,'"'===o.character&&(n=t.None);break;case t.ImplictQuote:if(o.character.match(/\s/))continue;"*"===o.character&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:cr(o.style,'"')}),n=t.Star,r++),e=r;break;case t.Star:"*"===o.character&&(n=t.None),e=r;break}}var a=this.renderParts[e];a&&n===t.Star&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:"*",height:a.height,width:cr(a.style,'"')}),!a||n!==t.ExplictQuote&&n!==t.ImplictQuote||this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:cr(a.style,'"')})}},{key:"fixAlignment",value:function(t,e,n,r,o){var a=0,i=[];function c(){var r=e;"center"===t?r=e+(n-e)/2-a/2:"right"===t&&(r=n-a);var o,c=Object(q["a"])(i);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.x=r,r+=s.width}}catch(u){c.e(u)}finally{c.f()}}var s=this.renderParts;o>0&&(s=this.applyLineWrapping(this.renderParts.slice(0),o));var u,l=r,d=[],b=0,p=Object(q["a"])(s);try{for(p.s();!(u=p.n()).done;){var f=u.value;b=Math.max(b,f.height),"newline"===f.type&&(d.push(b),b=0)}}catch(O){p.e(O)}finally{p.f()}d.push(b);var h,j=0,v=Object(q["a"])(s);try{for(v.s();!(h=v.n()).done;){var m=h.value;if(b=Math.max(b,m.height),m.y=l,i.push(m),a+=m.width,"newline"===m.type)c(),l+=d[++j]||0,a=0,b=0,i=[];else if("character"===m.type){var g=i[i.length-1];"character"===g.type&&(a+=g.style.letterSpacing,g.width+=g.style.letterSpacing)}}}catch(O){v.e(O)}finally{v.f()}c()}},{key:"getHeight",value:function(t){var e,n=0,r=0,o=0===t?this.renderParts:this.applyLineWrapping(this.renderParts.slice(0),t),a=Object(q["a"])(o);try{for(a.s();!(e=a.n()).done;){var i=e.value;n=Math.max(n,i.height),"newline"===i.type&&(r+=n,n=0)}}catch(c){a.e(c)}finally{a.f()}return r+=n,r}},{key:"getWidth",value:function(){var t,e=0,n=0,r=null,o=Object(q["a"])(this.renderParts);try{for(o.s();!(t=o.n()).done;){var a=t.value;e+=a.width,"newline"===a.type?(n=Math.max(n,e),e=0,r=null):"character"===a.type&&(r&&"character"===r.type&&(e+=r.style.letterSpacing),r=a)}}catch(i){o.e(i)}finally{o.f()}return n=Math.max(n,e),n}},{key:"getRenderParts",value:function(e,n){var r,o=[],a=[],i=[],c=ur(n),s=n,u=null,l=Object(q["a"])(e);try{for(l.s();!(r=l.n()).done;){var d=r.value;switch(d.type){case"command":if(!t.textCommands.has(d.commandName))throw new Error("There is no text command called '".concat(d.commandName,"' at position ").concat(d.pos,"."));a.push(s),i.push(u),s=t.textCommands.get(d.commandName)(s,d.argument),c=ur(s),u=d;break;case"commandClose":if(!u)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', but no commands are currently open."));if(d.commandName!==u.commandName)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', expected to close '").concat(u,"' first. (Opened at position ").concat(u.pos,")"));u=i.pop(),s=a.pop();break;case"newline":o.push({height:c,width:0,x:0,y:0,type:"newline"});break;case"text":var b,p=Object(q["a"])(d.content);try{for(p.s();!(b=p.n()).done;){var f=b.value;o.push({type:"character",character:f,height:c,width:cr(s,f),style:s,x:0,y:0})}}catch(h){p.e(h)}finally{p.f()}}}}catch(h){l.e(h)}finally{l.f()}return o}},{key:"applyLineWrapping",value:function(t,e){var n,r=-1,o=0,a=0,i=[],c=Object(q["a"])(t);try{for(c.s();!(n=c.n()).done;){var s=n.value;if("newline"===s.type)r=-1,o=0,a=0,i.push(s);else if("character"===s.type)if(" "===s.character){if(o>e){r=-1,o=0,a=0,i.push({type:"newline",height:s.height,width:0,x:0,y:0});continue}o+=s.width,a=o,r=i.length,i.push(s)}else o+=s.width,o>e&&-1!==r?(o-=a,i.splice(r,1,{type:"newline",height:s.height,width:0,x:0,y:0}),r=-1,a=0,i.push(s)):i.push(s);else Object(Ve["a"])(s)}}catch(u){c.e(u)}finally{c.f()}return i}}]),t}();or.textCommands=er;var ar=document.createElement("canvas").getContext("2d"),ir=null;function cr(t,e){return t!==ir&&(lr(t,ar),ir=t),ar.measureText(e).width}var sr=new Map;function ur(t){var e=t.fontSize+" "+t.fontName;if(sr.has(e))return sr.get(e)*t.lineSpacing;var n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize="".concat(t.fontSize,"px"),n.style.lineHeight="1";var r=document.createElement("div");r.style.opacity="0",r.style.fontFamily=t.fontName,r.style.fontSize="".concat(t.fontSize,"px"),r.style.lineHeight="1",r.style.position="absolute",r.style.top="0",r.style.left="0",r.appendChild(n),document.body.appendChild(r);try{var o=r.offsetHeight;return sr.set(e,o),o*t.lineSpacing}finally{r.remove()}}function lr(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}var dr=816,br=900,pr=146,fr=568,hr=38,jr=50,vr=39,mr=168,gr=34,Or=29,yr=12,kr=-126,xr=-72,wr=-38,Cr=30.75,Sr=26,Pr=426,Rr=58,Ir={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Tr=Object(ue["a"])(Object(ue["a"])({},Ir),{},{fontName:"riffic",fontSize:24,strokeColor:"#bb5599",strokeWidth:6,color:"white",letterSpacing:1}),Ar={align:"left",font:"13px aller",fill:{style:"#522"}},_r=Object(ue["a"])(Object(ue["a"])({},Ar),{},{fill:{style:"#a66"}}),$r=(Rt["d"],Rt["d"],fr-vr),Br=Object(r["l"])({components:{Color:Be},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:function(){return{colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}},computed:{vertical:function(){return this.$store.state.ui.vertical}},watch:{selectedFont:function(){""!==this.selectedFont&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged:function(){var t=this.$refs.textArea.value;try{new or(t,Tr),this.error=""}catch(e){this.error=e.message}this.$emit("update:modelValue",t)},selectColor:function(t){var e=this.$refs.textArea;this.colorSelector=t,this.rememberedStart=e.selectionStart,this.rememberedEnd=e.selectionEnd},applyColor:function(){var t=this,e=this.selectedColor,n=this.colorSelector,r=function r(){var o=t.$refs.textArea;o?(o.selectionStart=t.rememberedStart,o.selectionEnd=t.rememberedEnd,t.insertCommand("text"===n?"color":"outlinecolor",e)):t.$nextTick(r)};this.$nextTick(r),this.selectedColor="#000000",this.colorSelector=""},insertText:function(t){var e=this.$refs.textArea,n=e.value,r=e.selectionStart,o=e.selectionEnd;e.value=n.slice(0,r)+t+n.slice(o),e.selectionStart=e.selectionEnd=r+t.length,e.focus(),this.onValueChanged()},insertCommand:function(t,e){var n=this.$refs.textArea,r=n.value,o=n.selectionStart,a=n.selectionEnd,i=r.slice(o,a),c=r.slice(0,o),s=r.slice(a),u=t;e&&(u+="="+e),n.value="".concat(c,"{").concat(u,"}").concat(i,"{/").concat(t,"}").concat(s),n.selectionStart=o+u.length+2,n.selectionEnd=n.selectionStart+i.length,n.focus(),this.onValueChanged()}}});n("0783");Br.render=qn,Br.__scopeId="data-v-7ba8b720";var Vr=Br,Dr=Ft(),Lr=Object(r["l"])({components:{Toggle:C["a"],DFieldset:Pt["a"],PositionAndSize:Tt,Layers:Et,Delete:Nt,Color:Be,TextEditor:Vr,ImageOptions:Ee},mixins:[P],data:function(){return{textEditor:"",colorSelect:"",imageOptionsOpen:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t},textEditorText:{get:function(){return"name"===this.textEditor?this.object.talkingOther:"body"===this.textEditor?this.dialog:""},set:function(t){"name"===this.textEditor?this.talkingOther=t:"body"===this.textEditor&&(this.dialog=t)}},talkingDefaults:Dr("talkingDefault","objects/setTalkingDefault"),talkingOther:Dr("talkingOther","objects/setTalkingOther"),showControls:Dr("controls","objects/setControlsVisible"),allowSkipping:Dr("skip","objects/setSkipable"),autoQuoting:Dr("autoQuoting","objects/setAutoQuoting"),autoWrap:Dr("autoWrap","objects/setAutoWrapping"),showContinueArrow:Dr("continue","objects/setContinueArrow"),dialog:Dr("text","objects/setText"),flip:Dr("flip","objects/setFlip"),textBoxStyle:Dr("style","objects/setStyle"),deriveCustomColors:Dr("deriveCustomColors","objects/setDeriveCustomColors"),customNameboxWidth:Dr("customNameboxWidth","objects/setNameboxWidth"),color:{get:function(){switch(this.colorSelect){case"":return"#000000";case"base":return this.object.customColor;case"controls":return this.object.customControlsColor;case"namebox":return this.object.customNameboxColor;case"nameboxStroke":return this.object.customNameboxStroke;default:return Object(Ve["a"])(this.colorSelect),""}},set:function(t){var e=this;this.vuexHistory.transaction((function(){switch(e.colorSelect){case"":return;case"base":return void e.$store.commit("objects/setCustomColor",{id:e.object.id,color:t});case"controls":return void e.$store.commit("objects/setControlsColor",{id:e.object.id,customControlsColor:t});case"namebox":return void e.$store.commit("objects/setNameboxColor",{id:e.object.id,customNameboxColor:t});case"nameboxStroke":return void e.$store.commit("objects/setNameboxStroke",{id:e.object.id,customNameboxStroke:t})}}))}},textEditorName:function(){return"name"===this.textEditor?"Name":"body"===this.textEditor?"Dialog":""},customControlsColor:function(){return this.object.customControlsColor},colorName:function(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:return Object(Ve["a"])(this.colorSelect),""}}},methods:{splitTextbox:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.object.id})}))},resetPosition:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/resetTextboxBounds",{id:t.object.id})}))}}});n("2fb1");Lr.render=Bn,Lr.__scopeId="data-v-6a66463a";var Fr=Lr,Hr=Object(r["D"])("data-v-6dc05483");Object(r["q"])("data-v-6dc05483");var Er={class:"panel"},Mr=Object(r["j"])("h1",null,"Choice",-1),Ur=Object(r["j"])("tr",null,[Object(r["j"])("td",{colspan:"2"},[Object(r["j"])("label",{for:"choice-button-input"},"Text")])],-1);Object(r["p"])();var Nr=Hr((function(t,e,n,o,a,i){var c=Object(r["u"])("text-editor"),s=Object(r["u"])("image-options"),u=Object(r["u"])("d-flow"),l=Object(r["u"])("d-fieldset"),d=Object(r["u"])("toggle"),b=Object(r["u"])("position-and-size"),p=Object(r["u"])("layers"),f=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",Er,[Mr,t.textEditor?Object(r["j"])(c,{key:0,title:"Button Text",modelValue:t.button_text,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.button_text=e}),onLeave:e[2]||(e[2]=function(e){return t.textEditor=!1})},null,8,["modelValue"]):t.imageOptionsOpen?Object(r["j"])(s,{key:1,type:"object",title:"Choice",id:t.object.id,onLeave:e[3]||(e[3]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[Object(r["j"])(l,{class:"buttons",title:"Buttons:"},{default:Hr((function(){return[Object(r["j"])(u,{maxSize:"100%",direction:"vertical",noWraping:""},{default:Hr((function(){return[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.buttons,(function(e,n){return Object(r["o"])(),Object(r["f"])("div",{class:{choiceBtn:!0,active:n===t.currentIdx},key:n,onClick:function(e){return t.select(n)}},Object(r["v"])(""===e.text.trim()?"[Empty]":e.text),11,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["j"])(l,{class:"current_button",title:"Current button:"},{default:Hr((function(){return[Object(r["j"])("table",null,[Ur,Object(r["j"])("tr",null,[Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"choice-button-input","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.button_text=e}),onKeydown:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.button_text]])]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[6]||(e[6]=function(e){return t.textEditor=!0})},"...")])])])]})),_:1}),Object(r["j"])("button",{onClick:e[7]||(e[7]=function(){return t.addChoice.apply(t,arguments)})},"Add"),Object(r["j"])("button",{onClick:e[8]||(e[8]=function(){return t.removeChoice.apply(t,arguments)})},"Remove"),Object(r["j"])(d,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["j"])(b,{obj:t.object},null,8,["obj"]),Object(r["j"])(p,{object:t.object},null,8,["object"]),Object(r["j"])(d,{modelValue:t.flip,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])("button",{onClick:e[11]||(e[11]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(f,{obj:t.object},null,8,["obj"])],64))])})),Wr=Ft(),qr=Object(r["l"])({mixins:[P],components:{Toggle:C["a"],DFieldset:Pt["a"],DFlow:de,PositionAndSize:Tt,Layers:Et,Delete:Nt,TextEditor:Vr,ImageOptions:Ee},data:function(){return{imageOptionsOpen:!1,currentIdx:0,textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("choice"===t.type)return t},flip:Wr("flip","objects/setFlip"),autoWrap:Wr("autoWrap","objects/setAutoWrapping"),button_text:zr("text","objects/setChoiceText",!0),buttons:function(){return this.object.choices}},methods:{select:function(t){this.currentIdx=t},addChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addChoice",{id:t.object.id,text:""})}))},removeChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.currentIdx===t.object.choices.length-1&&t.currentIdx>0&&t.select(t.currentIdx-1),t.$store.dispatch("objects/removeChoice",{id:t.object.id,choiceIdx:t.currentIdx})}))}}});function zr(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object.choices[this.currentIdx][t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(Lt["a"])({id:o.object.id,choiceIdx:o.currentIdx},t,r))}))}}}n("3dcd");qr.render=Nr,qr.__scopeId="data-v-6dc05483";var Gr=qr,Yr=Object(r["D"])("data-v-8abb847e");Object(r["q"])("data-v-8abb847e");var Kr={class:"panel"},Xr=Object(r["h"])('<h1 data-v-8abb847e>Help and Credits</h1><a class="btn" target="_blank" rel="noopener noreferrer" href="https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-Dokumentation" data-v-8abb847e>Help</a><a class="btn" target="_blank" rel="noopener noreferrer" href="https://github.com/edave64/Doki-Doki-Dialog-Generator/" data-v-8abb847e>Fork me on GitHub</a><p data-v-8abb847e> All assets used are IP of Team Salvato and created by them, unless noted otherwise. </p><p data-v-8abb847e> Doki Doki Dialog Generator developed by EDave64 <br data-v-8abb847e>Based on gemdude46&#39;s DDLC Shitpost generator </p><p data-v-8abb847e> Unused House Background by <a target="_blank" rel="noopener noreferrer" href="https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161" data-v-8abb847e>Fatelogic</a></p><p data-v-8abb847e> Aller Font by <a target="_blank" rel="noopener noreferrer" href="https://www.daltonmaag.com/library/aller" data-v-8abb847e>Dalton Maag Ltd</a></p><p data-v-8abb847e> Riffic Bold Font by <a target="_blank" rel="noopener noreferrer" href="https://www.fontspring.com/fonts/inky-type/riffic" data-v-8abb847e>InkyType</a></p><p data-v-8abb847e> Verily Serif Mono Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/verily-serif-mono.font" data-v-8abb847e>Stephen G. Hartke</a></p><p data-v-8abb847e> F25 Bank Printer Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/f25-bank-printer.font" data-v-8abb847e>F25 Digital Typeface Design</a></p><p data-v-8abb847e> Journal Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/journal.font" data-v-8abb847e>Fontourist</a></p><p data-v-8abb847e> Hashtag Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/hashtag.font" data-v-8abb847e> TitanVex</a></p><p data-v-8abb847e> JP Hand Slanted Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/jp-hand-slanted.font" data-v-8abb847e>Jonathan Paterson</a></p><p data-v-8abb847e> As I Lay Dying Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/as-i-lay-dying.font" data-v-8abb847e>Moises Esqueda</a></p><p data-v-8abb847e> Damagrafik Script Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/damagrafik-script.font" data-v-8abb847e>Davide Terenzi</a></p><p data-v-8abb847e> Ammy&#39;s Handwriting Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/ammys-handwriting.font" data-v-8abb847e>Ammy K.</a></p><p data-v-8abb847e> Halogen Font by <a target="_blank" rel="noopener noreferrer" href="https://www.dafont.com/halogen.font" data-v-8abb847e>JLH Fonts</a></p><p data-v-8abb847e> MC Classic Sprite by Childish-N <br data-v-8abb847e>MC Classic Chibi by GyleToTheRescue </p><p data-v-8abb847e> MC Sprite by Childish-N <br data-v-8abb847e>MC Casual Sprite by SlightlySimple <br data-v-8abb847e>MC Chibi by SlightlySimple </p><p data-v-8abb847e> MC Chad Sprite by Cylent-Nite <br data-v-8abb847e>MC Chad Poses and expressions by SlightlySimple <br data-v-8abb847e>MC Chad Poses and chibi by Meddy-sin </p><p data-v-8abb847e> FeMC Sprite by Meddy-sin <br data-v-8abb847e>FeMC Casual Sprite by SlightlySimple </p><p data-v-8abb847e>Classic Amy Sprite by Meddy-sin</p><p data-v-8abb847e>Amy Sprite by Meddy-sin and SlightlySimple</p><p data-v-8abb847e>Special thanks to SlightlySimple for testing and technical help</p><p data-v-8abb847e> Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing </p>',25);Object(r["p"])();var Qr=Yr((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",Kr,[Xr])})),Jr=Object(r["l"])({mixins:[P]});n("8f7f");Jr.render=Qr,Jr.__scopeId="data-v-8abb847e";var Zr=Jr,to=Object(r["D"])("data-v-43d75d36");Object(r["q"])("data-v-43d75d36");var eo=Object(r["i"])("Drop here to add as a new background"),no=Object(r["j"])("h1",null,"Background",-1),ro=Object(r["i"])(" Upload "),oo=Object(r["j"])("i",{class:"material-icons"},"extension",-1),ao=Object(r["i"])(" Search in content packs ");Object(r["p"])();var io=to((function(t,e,n,o,a,i){var c=Object(r["u"])("drop-target"),s=Object(r["u"])("color"),u=Object(r["u"])("background-settings"),l=Object(r["u"])("background-button");return Object(r["o"])(),Object(r["f"])("div",{class:"panel",onDragenter:e[8]||(e[8]=function(){return t.dragEnter.apply(t,arguments)}),onMouseleave:e[9]||(e[9]=function(e){return t.$refs.dt.hide()})},[Object(r["j"])(c,{ref:"dt",class:"drop-target",onDrop:t.addImageFile},{default:to((function(){return[eo]})),_:1},8,["onDrop"]),no,t.colorSelect?Object(r["j"])(s,{key:0,modelValue:t.bgColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.bgColor=e}),onLeave:e[2]||(e[2]=function(e){return t.colorSelect=!1})},null,8,["modelValue"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:1},[Object(r["j"])(u,{"onChange-color":e[3]||(e[3]=function(e){return t.colorSelect=!0})}),Object(r["j"])("div",{class:"btn upload-background",onClick:e[5]||(e[5]=function(e){return t.$refs.upload.click()})},[ro,Object(r["j"])("input",{type:"file",ref:"upload",onChange:e[4]||(e[4]=function(){return t.onFileUpload.apply(t,arguments)})},null,544)]),Object(r["j"])("button",{class:"upload-background",onClick:e[6]||(e[6]=function(){return t.addByUrl.apply(t,arguments)})},"Add by URL"),Object(r["j"])("button",{class:"upload-background",title:"Not yet implemented",onClick:e[7]||(e[7]=function(e){return t.$emit("show-dialog","type: Backgrounds")})},[oo,ao]),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.backgrounds,(function(e){return Object(r["o"])(),Object(r["f"])(l,{key:e,backgroundId:e,onInput:function(n){return t.setBackground(e)}},null,8,["backgroundId","onInput"])})),128))],64))],32)})),co=Object(r["D"])("data-v-1cae163a"),so=co((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",{class:{background:!0,active:t.isActive},title:t.title,style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("input",t.backgroundId)})},Object(r["v"])(t.title),15,["title"])})),uo=Object(r["l"])({props:{backgroundId:{type:String,required:!0}},data:function(){return{isWebPSupported:null,assets:[]}},computed:{background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.backgroundId)||null},isActive:function(){return this.backgroundId===this.background.current},title:function(){switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label||""},style:function(){switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.bgData){e.next=4;break}return e.next=3,Promise.all(t.bgData.variants[0].map((function(t){return Object(z["a"])(t,!1)})));case 3:t.assets=e.sent;case 4:case"end":return e.stop()}}),e)})))()}});n("e760");uo.render=so,uo.__scopeId="data-v-1cae163a";var lo=uo,bo=Object(r["D"])("data-v-2a0abeea");Object(r["q"])("data-v-2a0abeea");var po=Object(r["j"])("label",{for:"bg_color"},"Color:",-1),fo={key:1},ho={colspan:"3"},jo={key:0},vo={class:"arrow-col"},mo=Object(r["j"])("td",{style:{"text-align":"center"}},"Variant",-1),go={class:"arrow-col"},Oo={colspan:"3"},yo=Object(r["j"])("option",{value:"0"},"None",-1),ko=Object(r["j"])("option",{value:"1"},"Stretch",-1),xo=Object(r["j"])("option",{value:"2"},"Cover",-1);Object(r["p"])();var wo=bo((function(t,e,n,o,a,i){var c=Object(r["u"])("toggle"),s=Object(r["u"])("d-fieldset");return Object(r["o"])(),Object(r["f"])(s,{class:"bg-settings",title:"Settings:"},{default:bo((function(){return[t.isColor?(Object(r["o"])(),Object(r["f"])(r["a"],{key:0},[po,Object(r["j"])("button",{id:"bg_color",class:"color-button",style:{background:t.color},onClick:e[1]||(e[1]=function(e){return t.$emit("change-color")})},null,4)],64)):Object(r["g"])("",!0),t.isVariant?(Object(r["o"])(),Object(r["f"])("table",fo,[Object(r["j"])("tr",null,[Object(r["j"])("td",ho,[Object(r["j"])(c,{modelValue:t.flipped,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.flipped=e}),label:"Flipped?"},null,8,["modelValue"])])]),t.hasVariants?(Object(r["o"])(),Object(r["f"])("tr",jo,[Object(r["j"])("td",vo,[Object(r["j"])("button",{onClick:e[3]||(e[3]=function(e){return t.seekVariant(-1)})},"<")]),mo,Object(r["j"])("td",go,[Object(r["j"])("button",{onClick:e[4]||(e[4]=function(e){return t.seekVariant(1)})},">")])])):Object(r["g"])("",!0),Object(r["j"])("tr",null,[Object(r["j"])("td",Oo,[Object(r["B"])(Object(r["j"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.scaling=e}),onKeydown:e[6]||(e[6]=Object(r["C"])((function(){}),["stop"]))},[yo,ko,xo],544),[[r["x"],t.scaling]])])])])):Object(r["g"])("",!0)]})),_:1})})),Co=Object(r["l"])({components:{Toggle:C["a"],DFieldset:Pt["a"]},computed:{color:{get:function(){return this.background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},flipped:{get:function(){return this.background.flipped},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundFlipped",{flipped:t,panelId:e.$store.state.panels.currentPanel})}))}},scaling:{get:function(){return this.background.scaling.toString()},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(t,10),panelId:e.$store.state.panels.currentPanel})}))}},currentBackgroundId:function(){return this.background.current},background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.id===t.currentBackgroundId}))||null},isColor:function(){return"buildin.static-color"===this.currentBackgroundId},isVariant:function(){return!!this.bgData},hasVariants:function(){return!!this.bgData&&this.bgData.variants.length>1}},methods:{seekVariant:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("panels/seekBackgroundVariant",{delta:t,panelId:e.$store.state.panels.currentPanel})}))}}});n("6ed0");Co.render=wo,Co.__scopeId="data-v-2a0abeea";var So=Co,Po={packId:"dddg.buildin.uploadedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},Ro=Object(r["l"])({mixins:[P],components:{BackgroundButton:lo,BackgroundSettings:So,DropTarget:G["a"],Color:Be},data:function(){return{colorSelect:!1}},computed:{bgColor:{get:function(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},backgrounds:function(){return[].concat(Object(je["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.id}))),["buildin.static-color","buildin.transparent"])}},methods:{setBackground:function(t){this.$store.commit("panels/setCurrentBackground",{current:t,panelId:this.$store.state.panels.currentPanel})},onFileUpload:function(t){var e=this.$refs.upload;if(e.files){var n,r=Object(q["a"])(e.files);try{for(r.s();!(n=r.n()).done;){var o=n.value;this.addImageFile(o)}}catch(a){r.e(a)}finally{r.f()}}},addImageFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomBackground(t.name,t.name,e)},addByUrl:function(){var t=prompt("Enter the URL of the image");if(t){var e=t.split("/").slice(-1)[0];this.addNewCustomBackground(e,e,t)}},addNewCustomBackground:function(t,e,n){var r=this;Po.backgrounds.push({id:t,label:e,variants:[[n]]}),this.vuexHistory.transaction((function(){r.$store.dispatch("content/replaceContentPack",{contentPack:Po}),r.setBackground(t)}))},dragEnter:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link",this.$refs.dt.show()))}}});n("d699");Ro.render=io,Ro.__scopeId="data-v-43d75d36";var Io=Ro,To=Object(r["D"])("data-v-68102184");Object(r["q"])("data-v-68102184");var Ao={class:"panel"},_o=Object(r["j"])("h1",null,"Content Packs",-1),$o={class:"list"},Bo=Object(r["j"])("label",{for:"pack_name"},"Name:",-1),Vo=Object(r["j"])("label",{for:"pack_credits"},"Credits:",-1),Do={key:4},Lo=Object(r["i"])(" The tool need restart for changes to take effect. ");Object(r["p"])();var Fo=To((function(t,e,n,o,a,i){var c=Object(r["u"])("d-fieldset");return Object(r["o"])(),Object(r["f"])("div",Ao,[_o,Object(r["j"])("button",{onClick:e[1]||(e[1]=function(){return t.addNew.apply(t,arguments)})},"Add new Pack"),Object(r["j"])(c,{title:"Installed Packs:"},{default:To((function(){return[Object(r["j"])("div",$o,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.packs,(function(e){return Object(r["o"])(),Object(r["f"])("div",{class:{active:e.name===t.name},key:e.name,onClick:function(n){return t.select(e.name)}},Object(r["v"])(e.name),11,["onClick"])})),128))])]})),_:1}),Bo,Object(r["j"])("input",{id:"pack_name",value:t.name,readonly:""},null,8,["value"]),Vo,Object(r["j"])("div",{id:"pack_credits",innerHTML:t.credits},null,8,["innerHTML"]),t.activatable?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:e[2]||(e[2]=function(){return t.activate.apply(t,arguments)})},"Activate")):Object(r["g"])("",!0),t.deactivatable?(Object(r["o"])(),Object(r["f"])("button",{key:1,onClick:e[3]||(e[3]=function(){return t.deactivate.apply(t,arguments)})},"Deactivate")):Object(r["g"])("",!0),t.installable?(Object(r["o"])(),Object(r["f"])("button",{key:2,onClick:e[4]||(e[4]=function(){return t.install.apply(t,arguments)})},"Install")):Object(r["g"])("",!0),t.uninstallable?(Object(r["o"])(),Object(r["f"])("button",{key:3,onClick:e[5]||(e[5]=function(){return t.uninstall.apply(t,arguments)})},"Uninstall")):Object(r["g"])("",!0),t.needRestart?(Object(r["o"])(),Object(r["f"])("div",Do,[Lo,Object(r["j"])("button",{onClick:e[6]||(e[6]=function(){return t.restart.apply(t,arguments)})},"Restart Now")])):Object(r["g"])("",!0)])})),Ho=(n("2ca0"),Object(r["l"])({mixins:[P],components:{DFieldset:Pt["a"]},data:function(){return{selectedPack:null,needRestart:!1}},computed:{packs:function(){var t=this.$store.state.content.contentPacks;return t.filter((function(t){return t.packId&&!t.packId.startsWith("dddg.buildin.")})).map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))},name:function(){return this.selectedPack?this.selectedPack.name:""},credits:function(){return this.selectedPack?this.selectedPack.credits:[""]},activatable:function(){return!!R["a"].isAutoLoadingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))},deactivatable:function(){return!!R["a"].isAutoLoadingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))},installable:function(){return!!R["a"].isLocalRepoSupported&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))},uninstallable:function(){return!!R["a"].isLocalRepoSupported&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}},methods:{select:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null},addNew:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,R["a"].prompt("Enter the URL of the character pack:");case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.$store.dispatch("content/loadContentPacks",n);case 7:case"end":return e.stop()}}),e)})))()},restart:function(){location.reload(!0)},install:function(){this.selectedPack&&(R["a"].localRepoAdd(this.selectedPack.url),this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)},uninstall:function(){this.selectedPack&&(R["a"].localRepoRemove(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)},activate:function(){this.selectedPack&&(R["a"].autoLoadAdd(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)},deactivate:function(){this.selectedPack&&(R["a"].autoLoadRemove(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}}}));n("0834");Ho.render=Fo,Ho.__scopeId="data-v-68102184";var Eo=Ho,Mo=Object(r["D"])("data-v-71818f1a");Object(r["q"])("data-v-71818f1a");var Uo={class:"panel"},No=Object(r["j"])("h1",null,"Panels",-1),Wo={class:"panel_text"},qo={class:"panel_nr"},zo={class:"column"},Go=Object(r["i"])(" Add new "),Yo=Object(r["i"])(" Delete panel "),Ko=Object(r["i"])(" Move ahead "),Xo=Object(r["i"])(" Move behind "),Qo=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"export_format"},"Format")],-1),Jo=Object(r["j"])("option",{value:"image/png"},"PNG (lossless)",-1),Zo={key:0,value:"image/webp"},ta={key:1,value:"image/heif"},ea=Object(r["j"])("option",{value:"image/jpeg"},"JPEG (lossy)",-1),na={key:0},ra=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"export_quality"},"Quality:")],-1),oa=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"export_ppi"},[Object(r["i"])(" Panels per image: "),Object(r["j"])("br"),Object(r["j"])("small",null,"(0 for one single image)")])],-1),aa=Object(r["j"])("td",null,[Object(r["j"])("label",{for:"export_pages"},[Object(r["i"])(" Panels to export: "),Object(r["j"])("br"),Object(r["j"])("small",null,"(Leave empty for all)")])],-1),ia=Object(r["i"])(" Download ");Object(r["p"])();var ca,sa=Mo((function(t,e,n,o,a,i){var c=Object(r["u"])("d-flow"),s=Object(r["u"])("d-fieldset"),u=Object(r["u"])("d-button");return Object(r["o"])(),Object(r["f"])("div",Uo,[No,Object(r["j"])(s,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:Mo((function(){return[Object(r["j"])(c,{"no-wraping":"",maxSize:"350px"},{default:Mo((function(){return[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.panelButtons,(function(e,n){return Object(r["o"])(),Object(r["f"])("div",{key:e.id,class:{panel_button:!0,active:e.id===t.currentPanel},style:"background-image: url('".concat(e.image,"')"),onClick:function(n){return t.updateCurrentPanel(e.id)}},[Object(r["j"])("div",Wo,[Object(r["j"])("p",null,Object(r["v"])(e.text),1)]),Object(r["j"])("div",qo,Object(r["v"])(n+1),1)],14,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["j"])("div",zo,[Object(r["j"])(u,{icon:"add_to_queue",onClick:t.addNewPanel},{default:Mo((function(){return[Go]})),_:1},8,["onClick"]),Object(r["j"])(u,{icon:"remove_from_queue",onClick:t.deletePanel,disabled:!t.canDeletePanel},{default:Mo((function(){return[Yo]})),_:1},8,["onClick","disabled"]),Object(r["j"])(u,{icon:"arrow_upward",onClick:t.moveAhead,disabled:!t.canMoveAhead},{default:Mo((function(){return[Ko]})),_:1},8,["onClick","disabled"]),Object(r["j"])(u,{icon:"arrow_downward",onClick:t.moveBehind,disabled:!t.canMoveBehind},{default:Mo((function(){return[Xo]})),_:1},8,["onClick","disabled"])]),Object(r["j"])(s,{title:"Export"},{default:Mo((function(){return[Object(r["j"])("table",null,[Object(r["j"])("tr",null,[Qo,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("select",{id:"export_format","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.format=e})},[Jo,t.webpSupport?(Object(r["o"])(),Object(r["f"])("option",Zo,"WebP (lossy)")):Object(r["g"])("",!0),t.heifSupport?(Object(r["o"])(),Object(r["f"])("option",ta,"HEIF (lossy)")):Object(r["g"])("",!0),ea],512),[[r["x"],t.format]])])]),t.isLossy?(Object(r["o"])(),Object(r["f"])("tr",na,[ra,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.quality=e}),onKeydown:e[3]||(e[3]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.quality,void 0,{number:!0}]])])])):Object(r["g"])("",!0),Object(r["j"])("tr",null,[oa,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.ppi=e}),onKeydown:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.ppi,void 0,{number:!0}]])])]),Object(r["j"])("tr",null,[aa,Object(r["j"])("td",null,[Object(r["B"])(Object(r["j"])("input",{id:"export_pages","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.pages=e}),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[r["y"],t.pages]])])]),Object(r["j"])("tr",null,[Object(r["j"])("td",null,[Object(r["j"])(u,{icon:"photo_camera",onClick:t.download},{default:Mo((function(){return[ia]})),_:1},8,["onClick"])]),Object(r["j"])("td",null,[Object(r["j"])("button",{onClick:e[7]||(e[7]=function(){return t.estimateExportSize.apply(t,arguments)})},"Estimate filesizes")])])])]})),_:1})])})),ua=(n("13d5"),n("caad"),n("2532"),n("53ca")),la=n("c837");(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(ca||(ca={}));var da="buildin.transparent",ba=0,pa={panelToUrl:new Map,urlToPanel:new Map,register:function(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister:function(t,e){if(this.urlToPanel.has(e)){var n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),0===n.length&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},fa={namespaced:!0,state:{panels:{},panelOrder:[],currentPanel:null},mutations:{setCurrentPanel:function(t,e){var n=e.panelId;t.currentPanel=n},setPanelPreview:function(t,e){var n=e.panelId,r=e.url;t.panels[n].lastRender=r,pa.register(n,r)},createPanel:function(t,e){var n=e.panel;t.panels[n.id]=n},setPanelOrder:function(t,e){var n=e.panelOrder;t.panelOrder=Object(je["a"])(n)},setCurrentBackground:function(t,e){var n=e.current,r=e.panelId,o=t.panels[r];o.background.current=n,o.background.variant=0},setBackgroundColor:function(t,e){var n=e.color,r=e.panelId,o=t.panels[r];o.background.color=n},setBackgroundFlipped:function(t,e){var n=e.flipped,r=e.panelId,o=t.panels[r];o.background.flipped=n},setBackgroundVariant:function(t,e){var n=e.variant,r=e.panelId,o=t.panels[r];o.background.variant=n},setBackgroundScaling:function(t,e){var n=e.scaling,r=e.panelId,o=t.panels[r];o.background.scaling=n},deletePanel:function(t,e){var n=e.panelId;pa.unregister(n,pa.panelToUrl.get(n)),delete t.panels[n]}},actions:{createPanel:function(t){var e=t.state,n=t.commit,r="panel"+ ++ba;n("createPanel",{panel:{id:r,background:{color:"#000000",current:da,flipped:!1,scaling:ca.None,variant:0},lastRender:""}}),e.panelOrder?n("setPanelOrder",{panelOrder:[].concat(Object(je["a"])(e.panelOrder),[r])}):n("setPanelOrder",{panelOrder:[r]}),n("setCurrentPanel",{panelId:r})},duplicatePanel:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=e.panelId,i=n.panels[a],c="panel"+ ++ba;pa.register(c,i.lastRender),r("createPanel",{panel:{id:c,background:JSON.parse(JSON.stringify(i.background)),lastRender:i.lastRender}}),o("objects/copyObjects",{sourcePanelId:a,targetPanelId:c},{root:!0});var s=n.panelOrder.indexOf(a);r("setPanelOrder",{panelOrder:[].concat(Object(je["a"])(n.panelOrder.slice(0,s+1)),[c],Object(je["a"])(n.panelOrder.slice(s+1)))}),r("setCurrentPanel",{panelId:c})},seekBackgroundVariant:function(t,e){var n=t.state,r=t.rootGetters,o=t.commit,a=e.delta,i=n.panels[n.currentPanel],c=r["content/getBackgrounds"],s=c.get(i.background.current);s&&o("setBackgroundVariant",{panelId:n.currentPanel,variant:Object(la["a"])(s.variants,i.background.variant,a)})},delete:function(t,e){var n=t.state,r=t.dispatch,o=t.commit,a=e.panelId;if(!(n.panelOrder.length<=1)){var i,c=n.panelOrder.indexOf(a);i=c===n.panelOrder.length-1?c-1:c+1,o("setCurrentPanel",{panelId:n.panelOrder[i]}),o("setPanelOrder",{panelOrder:[].concat(Object(je["a"])(n.panelOrder.slice(0,c)),Object(je["a"])(n.panelOrder.slice(c+1)))}),r("objects/deleteAllOfPanel",{panelId:a},{root:!0}),o("deletePanel",{panelId:a})}},fixContentPackRemoval:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.state,o=t.rootGetters,a=t.commit,i=t.rootState,c=function(){var t=u[s],n=e.backgrounds.find((function(e){return e.id===t.background.current}));if(!n)return{v:void 0};var r=o["content/getBackgrounds"].get(t.background.current);if(!r)return i.content.current.backgrounds[0]?a("setCurrentBackground",{current:i.content.current.backgrounds[0].id,panelId:t.id}):a("setCurrentBackground",{current:"buildin.transparent",panelId:t.id}),{v:void 0};var c=JSON.stringify(n.variants[t.background.variant]),l=r.variants.findIndex((function(t){return JSON.stringify(t)===c}));l!==t.background.variant&&a("setBackgroundVariant",{variant:-1===l?0:l,panelId:t.id})},s=0,u=Object.values(r.panels);case 3:if(!(s<u.length)){n.next=10;break}if(l=c(),"object"!==Object(ua["a"])(l)){n.next=7;break}return n.abrupt("return",l.v);case 7:s++,n.next=3;break;case 10:case"end":return n.stop()}}),n)})))()},move:function(t,e){var n=t.state,r=t.commit,o=e.panelId,a=e.delta,i=Object(je["a"])(n.panelOrder),c=i.indexOf(o);i.splice(c,1);var s=Math.max(c+a,0);i.splice(s,0,o),r("setPanelOrder",{panelOrder:i})}}},ha=function(){function t(e,n,r,o){Object(ge["a"])(this,t),this.id=e,this.assets=n,this.flip=r,this.scale=o}return Object(Oe["a"])(t,[{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.assets.map((function(t){return Object(z["a"])(t,e.hq)})));case 2:n=t.sent,r=Object(q["a"])(n),t.prev=4,r.s();case 6:if((o=r.n()).done){t.next=31;break}if(a=o.value,a instanceof HTMLImageElement){t.next=10;break}return t.abrupt("return");case 10:i=0,c=0,s=a.width,u=a.height,t.t0=this.scale,t.next=t.t0===ca.None?17:t.t0===ca.Stretch?20:t.t0===ca.Cover?23:28;break;case 17:return i=Rt["d"]/2-s/2,c=Rt["c"]/2-u/2,t.abrupt("break",28);case 20:return s=Rt["d"],u=Rt["c"],t.abrupt("break",28);case 23:l=s/u,d=Rt["d"]/Rt["c"],l>d?(u=Rt["c"],s=u*l):(s=Rt["d"],u=s/l),i=Rt["d"]/2-s/2,c=Rt["c"]/2-u/2;case 28:e.drawImage({image:a,x:i,y:c,w:s,h:u,flip:this.flip});case 29:t.next=6;break;case 31:t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](4),r.e(t.t1);case 36:return t.prev=36,r.f(),t.finish(36);case 39:case"end":return t.stop()}}),t,this,[[4,33,36,39]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),ja={id:"buildin.static-color",name:"Static color",color:"#000000",render:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.drawRect({x:0,y:0,w:Rt["d"],h:Rt["c"],fill:{style:e.color}});case 1:case"end":return n.stop()}}),n)})))()}},va=n("262e"),ma=n("2caf"),ga=n("4a6f"),Oa=n("0c0f"),ya=function(t){Object(va["a"])(n,t);var e=Object(ma["a"])(n);function n(t){var r;return Object(ge["a"])(this,n),r=e.call(this,t),r.assets=null,r.scaleable=!0,r.canvasHeight=0,r.canvasWidth=0,r.init(),r}return Object(Oe["a"])(n,[{key:"init",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.obj.assets.map((function(t){return Object(z["a"])(t)})));case 2:e=t.sent,n=0,r=0,o=Object(q["a"])(e);try{for(o.s();!(a=o.n()).done;)i=a.value,i instanceof HTMLImageElement&&(i.height>r&&(r=i.height),i.width>n&&(n=i.width))}catch(c){o.e(c)}finally{o.f()}this.canvasWidth=n,this.canvasHeight=r,this.assets=[{loaded:!0,assets:e,offset:[0,0]}],Oa["f"].fire(new Oa["c"]);case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAssetList",value:function(){return this.assets||[]}},{key:"updatedContent",value:function(){}},{key:"version",get:function(){return null===this.assets?-1:this.obj.version}}]),n}(ga["a"]),ka=n("1a7b"),xa=n("fd0b");function wa(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.arcTo(e+r,n+o,e,n+o,a),t.arcTo(e,n+o,e,n,a),t.arcTo(e,n,e+r,n,a),t.closePath()}function Ca(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.lineTo(e+r,n+o),t.lineTo(e,n+o),t.arcTo(e,n,e+r,n,a),t.closePath()}var Sa=new ye(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Pa=new ye(.002028397565922768,0,.13725490196078438,0),Ra=.82,Ia=new ye(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Ta=12,Aa=12,_a=1.5,$a=new ye(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Ba=new ye(0,-.14285714285714296,.3,0),Va=new ye(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Da=9.5,La=47,Fa=new ye(.0023347701149424305,0,.10784313725490202,0),Ha=n("408f"),Ea=function(t){Object(va["a"])(n,t);var e=Object(ma["a"])(n);function n(){var t;return Object(ge["a"])(this,n),t=e.apply(this,arguments),t.scaleable=!1,t.canvasHeight=Rt["c"],t.canvasWidth=Rt["d"],t}return Object(Oe["a"])(n,[{key:"renderLocal",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.width,r=this.height,o=n/2,a=this.flip?Rt["d"]-this.obj.x:this.obj.x,i=a-o,c=this.obj.y,t.next=8,this.renderBackdrop(e,i,c+vr);case 8:if("No-one"===this.obj.talkingDefault){t.next=12;break}return s="Other"===this.obj.talkingDefault?this.obj.talkingOther:this.obj.talkingDefault,t.next=12,this.renderNamebox(e,i+gr,c,s);case 12:return t.next=14,this.renderText(e,i,c,this.obj.autoWrap?n:0);case 14:if(u=c+r,l=u-yr,d=i+n/2,this.obj.controls&&(e.drawText(Object(ue["a"])({text:"History",x:d+kr,y:l},this.controlsStyle)),e.drawText(Object(ue["a"])({text:"Skip",x:d+xr,y:l},this.obj.skip?this.controlsStyle:this.controlsDisableStyle)),e.drawText(Object(ue["a"])({text:"Auto   Save   Load   Settings",x:d+wr,y:l},this.controlsStyle))),!this.obj.continue){t.next=27;break}return t.t0=e,t.next=22,Object(z["b"])("next");case 22:t.t1=t.sent,t.t2=i+n-Cr,t.t3=u-Sr,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 27:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderNamebox",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a,i,c,s,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=vr,c=Tr,"custom"!==this.obj.style){t.next=8;break}c=Object(ue["a"])(Object(ue["a"])({},c),{},{strokeColor:this.nameboxOutlineColor,strokeWidth:6,color:"#FFFFFF"}),a=this.obj.customNameboxWidth,e.customTransform((function(t){t.beginPath(),Ca(t,n,r,a,i,Ta),t.clip()}),(function(t){var e=t.linearGradient(n,r,n,r+vr),o=ke.fromCss(u.nameboxBackgroundColor),a=new ke(o.r,o.g,o.b,.95),c=a.toHSL().shift(Ia).toRgb();e.addColorStop(0,a.toCss()),e.addColorStop(Ra,a.toCss()),e.addColorStop(1,c.toCss()),t.drawRect({x:n,y:r,w:u.obj.width,h:i,fill:{style:e}})})),t.next=21;break;case 8:if("none"===this.obj.style){t.next=20;break}return a=mr,t.t0=e,t.next=13,Object(z["b"])("namebox");case 13:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4),t.next=21;break;case 20:a=mr;case 21:return s=new or(o,c),t.next=24,s.loadFonts();case 24:s.fixAlignment("center",n,n+a,r+Or,0),s.render(e.fsCtx);case 26:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("custom"!==this.obj.style){t.next=9;break}o=ke.fromCss(this.obj.customColor).toHSL(),a=new xa["a"](La,La),a.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,Da,Da,0,0,2*Math.PI)},fill:n})},n={style:o.shift(Va).toRgb().toCss()},r(0,0),r(La,0),r(0,La),r(La,La),r(La/2,La/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),e.customTransform((function(t){t.beginPath(),wa(t,n+_a,r+_a,u.obj.width-2*_a,u.obj.height-2*_a,Aa),t.clip()}),(function(t){var e=u.obj.height,o=u.obj.width,i=t.linearGradient(n,r,n,r+e),c=ke.fromHex(u.obj.customColor);i.addColorStop(0,c.toCss()),i.addColorStop(1,"rgba(".concat(c.r,",").concat(c.g,",").concat(c.b,",0.6667)")),t.drawRect({x:n,y:r,w:o,h:e,fill:{style:i},outline:{style:"#ffdfee",width:6}}),t.customTransform((function(t){t.translate(n,r)}),(function(n){var r=t.patternFrom(a);t.drawRect({x:0,y:0,w:o,h:e,fill:{style:r},composition:"source-atop"})}));var s=t.linearGradient(n,r+e-Rr,n,r+e);s.addColorStop(0,"rgba(255,255,255,0.3137)"),s.addColorStop(.5,"rgba(255,255,255,0.0627)"),s.addColorStop(1,"rgba(255,255,255,0)"),t.drawPath({path:function(t){t.ellipse(n+o/2,r+e,Pr,Rr,0,0,2*Math.PI)},fill:{style:s}})})),i=o.shift(Fa).toRgb().toCss(),e.drawPath({path:function(t){wa(t,n+_a,r+_a,u.obj.width-2*_a,u.obj.height-2*_a,Aa)},outline:{style:i,width:3}}),t.next=15;break;case 9:if("none"===this.obj.style){t.next=15;break}return"corrupt"===this.obj.style&&(n+=(dr-br)/2),t.next=13,Object(z["b"])("corrupt"===this.obj.style?"textbox_monika":"textbox");case 13:c=t.sent,e.drawImage({image:c,x:n,y:r});case 15:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new or(this.obj.text,{alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2}),this.obj.autoQuoting&&"No-one"!==this.obj.talkingDefault&&a.quote(),t.next=4,a.loadFonts();case 4:a.fixAlignment("left",n+hr,0,r+vr+jr,o-hr-hr),a.render(e.fsCtx);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"width",get:function(){return"custom"===this.obj.style?this.obj.width:dr}},{key:"height",get:function(){return("custom"===this.obj.style?this.obj.height:pr)+vr}},{key:"controlColor",get:function(){if(this.obj.deriveCustomColors){var t=ke.fromCss(this.obj.customColor).toHSL();return t.shift($a).toRgb().toCss()}return this.obj.customControlsColor}},{key:"controlsStyle",get:function(){return"custom"!==this.obj.style?Ar:Object(ue["a"])(Object(ue["a"])({},Ar),{},{fill:{style:this.controlColor}})}},{key:"controlsDisableStyle",get:function(){if("custom"!==this.obj.style)return _r;var t=ke.fromCss(this.controlColor).toHSL(),e=t.shift(Ba).toRgb().toCss();return Object(ue["a"])(Object(ue["a"])({},Ar),{},{fill:{style:e}})}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=ke.fromCss(this.obj.customColor).toHSL();return t.shift(Sa).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=ke.fromCss(this.obj.customColor).toHSL();return t.shift(Pa).toRgb().toCss()}return this.obj.customNameboxColor}}]),n}(Ha["a"]),Ma=(new ye(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),"#ffe6f4"),Ua="#ffbde1",Na=420,Wa=22,qa=270,za=7,Ga=(Rt["c"]-qa)/2,Ya={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Ka=function(t){Object(va["a"])(n,t);var e=Object(ma["a"])(n);function n(){var t;return Object(ge["a"])(this,n),t=e.apply(this,arguments),t.scaleable=!1,t.canvasHeight=Rt["c"],t.canvasWidth=Rt["d"],t._height=0,t.choiceRenderers=[],t}return Object(Oe["a"])(n,[{key:"renderLocal",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.updateChoiceBounds();case 2:console.log("rerender choice"),n=this.obj.width,r=this.height,o=n/2,a=this.flip?Rt["d"]-this.obj.x:this.obj.x,i=a-o,c=this.obj.y-r/2,s=Object(q["a"])(this.choiceRenderers),t.prev=10,s.s();case 12:if((u=s.n()).done){t.next=23;break}return l=u.value,t.next=16,l.loadFonts();case 16:d=l.getHeight(this.obj.autoWrap?this.obj.width:0),e.drawRect({x:i,y:c,w:n,h:d+2*za,outline:{style:Ua,width:3},fill:{style:Ma}}),l.fixAlignment("center",i,i+n,c+1.25*Wa,this.obj.autoWrap?n:0),l.render(e.fsCtx),c+=d+2*za+Wa;case 21:t.next=12;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](10),s.e(t.t0);case 28:return t.prev=28,s.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[10,25,28,31]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateChoiceBounds",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.choiceRenderers=this.obj.choices.map((function(t){return new or(t.text||" ",Ya)})),this._height=this.choiceRenderers.reduce((function(t,n){return t+n.getHeight(e.obj.autoWrap?e.obj.width:0)+2*za}),0)+this.obj.choiceDistance*(this.obj.choices.length-1);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"centeredVertically",get:function(){return!0}}]),n}(Ha["a"]),Xa=n("45eb"),Qa=n("7e84"),Ja="rgba(255,255,255,0.6)",Za=40,ti=30,ei=Object(ue["a"])(Object(ue["a"])({},Ir),{},{fontName:"riffic",fontSize:24,strokeColor:"#bb5599",strokeWidth:8,letterSpacing:1,color:"white"}),ni={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},ri=function(t){Object(va["a"])(n,t);var e=Object(ma["a"])(n);function n(){var t;return Object(ge["a"])(this,n),t=e.apply(this,arguments),t.canvasHeight=Rt["c"],t.canvasWidth=Rt["d"],t.scaleable=!1,t._height=0,t._width=0,t}return Object(Oe["a"])(n,[{key:"updatedContent",value:function(){}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.obj.backdrop&&r.drawRect({x:0,y:0,w:Rt["d"],h:Rt["c"],fill:{style:Ja}}),t.next=3,Object(Xa["a"])(Object(Qa["a"])(n.prototype),"render",this).call(this,e,r);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderLocal",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,b,p,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new or(this.obj.text,ni),r=new or("OK",ei),t.next=4,n.loadFonts();case 4:return t.next=6,r.loadFonts();case 6:o=this.obj.autoWrap?this.obj.width-2*Za:0,a=this.obj.autoWrap?o:n.getWidth(),i=n.getHeight(o),c=this.obj.autoWrap?o:r.getWidth(),s=r.getHeight(o),u=this._width=Math.max(a,c)+2*Za,l=this._height=i+2*Za+ti+s,d=u/2,b=this.flip?Rt["d"]-this.obj.x:this.obj.x,p=b-d,f=this.obj.y-l/2,e.drawRect({x:p,y:f,w:u,h:l,outline:{style:Ua,width:3},fill:{style:Ma}}),n.fixAlignment("center",p,p+u,f+1.5*Za,o),n.render(e.fsCtx),r.fixAlignment("center",p,p+u,f+l-Za,o),r.render(e.fsCtx);case 22:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}},{key:"id",get:function(){return this.obj.id}}]),n}(Ha["a"]),oi=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],ai=0,ii=0,ci=Rt["d"]/2,si=Rt["c"]/2,ui=33,li=30,di=800,bi=720,pi="rgba(51,51,51,0.75)",fi=480,hi=180,ji=3,vi=7,mi={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},gi=[Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Monika",fontName:"journal",fontSize:34}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),Object(ue["a"])(Object(ue["a"])({},mi),{},{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],Oi=-2,yi=26,ki=10,xi=10,wi=function(t){Object(va["a"])(n,t);var e=Object(ma["a"])(n);function n(){var t;return Object(ge["a"])(this,n),t=e.apply(this,arguments),t.scaleable=!1,t.canvasHeight=Rt["c"],t.canvasWidth=Rt["d"],t._height=0,t._width=0,t}return Object(Oe["a"])(n,[{key:"renderLocal",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,b,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=oi[this.obj.background],r=this.flip?Rt["d"]-this.obj.x:this.obj.x,o=this.obj.y,a=r+xi,i=li,c=ui,s=2*i,"internal:console"!==n.file){t.next=16;break}u=this._height=this.obj.height,l=this._width=this.obj.width,e.drawRect({x:r-l/2,y:this.obj.y-u/2,h:u,w:l,fill:{style:pi}}),i=Oi,c=yi,s=ki,t.next=25;break;case 16:if("internal:transparent"!==n.file){t.next=21;break}this._height=this.obj.height,this._width=this.obj.width,t.next=25;break;case 21:return t.next=23,Object(z["c"])("assets/poemBackgrounds/".concat(n.file));case 23:d=t.sent,d instanceof HTMLImageElement&&(e.drawImage({image:d,x:r-d.width/2,y:this.obj.y-d.height/2}),this._height=d.height,this._width=d.width);case 25:return o-=this.height/2,a-=this.width/2,b=gi[this.obj.font],p=new or(this.obj.text,b),t.next=31,p.loadFonts();case 31:p.fixAlignment("left",a+i,a+i,o+c+i,this.obj.autoWrap?this.width-s:0),p.render(e.fsCtx);case 33:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}}]),n}(Ha["a"]),Ci=function(){function t(e,n,r,o){Object(ge["a"])(this,t),this.store=e,this.panelId=n,this.canvasWidth=r,this.canvasHeight=o,this.renderObjectCache=new Map,this.lCurrentlyRendering=!1,this.state=e.state,this.renderer=new xa["a"](r,o)}return Object(Oe["a"])(t,[{key:"render",value:function(t,e){return this.panel?this.renderer.render(this.renderCallback.bind(this),t,e):Promise.resolve(!1)}},{key:"download",value:function(){var t=new Date,e="panel-".concat([t.getFullYear(),"".concat(t.getMonth()+1).padStart(2,"0"),"".concat(t.getDate()).padStart(2,"0"),"".concat(t.getHours()).padStart(2,"0"),"".concat(t.getMinutes()).padStart(2,"0"),"".concat(t.getSeconds()).padStart(2,"0")].join("-"),".png");return this.renderer.download(this.renderCallback.bind(this),e)}},{key:"paintOnto",value:function(t,e,n,r,o){this.renderer.paintOnto(t,e,n,r,o)}},{key:"objectsAt",value:function(t,e){return this.getRenderObjects().filter((function(n){return n.hitTest(t,e)})).map((function(t){return t.id}))}},{key:"renderCallback",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lCurrentlyRendering=!0,t.prev=1,t.next=4,null===(n=this.getBackgroundRenderer())||void 0===n?void 0:n.render(e);case 4:r=this.state.ui.selection,o=Object(q["a"])(this.getRenderObjects()),t.prev=6,o.s();case 8:if((a=o.n()).done){t.next=16;break}return i=a.value,c=!1,i instanceof Ha["a"]&&(i.updatedContent(this.store),c=r===i.id),t.next=14,i.render(c,e);case 14:t.next=8;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](6),o.e(t.t0);case 21:return t.prev=21,o.f(),t.finish(21);case 24:if(!e.preview){t.next=31;break}return t.t1=e,t.next=28,Object(z["b"])("backgrounds/transparent");case 28:t.t2=t.sent,t.t3={x:0,y:0,composite:"destination-over",image:t.t2},t.t1.drawImage.call(t.t1,t.t3);case 31:return t.prev=31,this.lCurrentlyRendering=!1,t.finish(31);case 34:case"end":return t.stop()}}),t,this,[[1,,31,34],[6,18,21,24]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRenderObjects",value:function(){var t,e=this,n=this.state.objects.panels[this.panelId],r=n?[].concat(Object(je["a"])(n.order),Object(je["a"])(n.onTopOrder)):[],o=this.state.objects.objects,a=Object.keys(this.renderObjectCache).filter((function(t){return!r.includes(t)})),i=Object(q["a"])(a);try{for(i.s();!(t=i.n()).done;){var c=t.value;this.renderObjectCache.delete(c)}}catch(s){i.e(s)}finally{i.f()}return r.map((function(t){var n=e.renderObjectCache.get(t);if(!n){var r=o[t];switch(r.type){case"sprite":n=new ya(r);break;case"character":var a=r;n=new ka["a"](a,Object(ft["e"])(e.store,a));break;case"textBox":n=new Ea(r);break;case"choice":n=new Ka(r);break;case"notification":n=new ri(r);break;case"poem":n=new wi(r);break}e.renderObjectCache.set(t,n)}return n}))}},{key:"getBackgroundRenderer",value:function(){var t=this.panel;switch(t.background.current){case"buildin.static-color":return ja.color=t.background.color,ja;default:var e=this.store.getters["content/getBackgrounds"],n=e.get(t.background.current);if(!n)return null;var r=n.variants[t.background.variant];return r?new ha(t.background.current,r,t.background.flipped,t.background.scaling):null}}},{key:"currentlyRendering",get:function(){return this.lCurrentlyRendering}},{key:"panel",get:function(){return this.state.panels.panels[this.panelId]}}]),t}(),Si=1.5,Pi=1/4,Ri=.5,Ii=100,Ti=90,Ai=70,_i=Object(r["l"])({mixins:[P],components:{DFieldset:Pt["a"],DFlow:de,DButton:Z},data:function(){return{webpSupport:!1,heifSupport:!1,ppi:0,pages:"",format:"image/png",quality:Ti}},computed:{currentPanel:function(){return this.$store.state.panels.currentPanel},isLossy:function(){return"image/png"!==this.format},canDeletePanel:function(){return this.panelButtons.length>1},panelButtons:function(){var t=this,e=this.$store.state.panels.panelOrder;return e.map((function(e){var n=t.$store.state.panels.panels[e],r=t.$store.state.objects.panels[e],o=r?[].concat(r.order,r.onTopOrder).map((function(e){return t.$store.state.objects.objects[e]})).map(t.extractObjectText):[];return{id:e,image:n.lastRender,text:o.reduce((function(t,e){return t.length>e.length?t:e}),"")}}))},canMoveAhead:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e>0},canMoveBehind:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e<t.length-1}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(z["e"])(),Object(z["d"])()]);case 2:n=e.sent,r=Object(u["a"])(n,2),t.webpSupport=r[0],t.heifSupport=r[1];case 6:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.moveFocusToActivePanel(),n=new Ci(t.$store,t.currentPanel,Rt["d"],Rt["c"]),e.next=4,n.render(!1,!0);case 4:return r=document.createElement("canvas"),r.width=Rt["d"]*Pi,r.height=Rt["c"]*Pi,n.paintOnto(r.getContext("2d"),0,0,r.width,r.height),e.t0=r,e.t1=function(e){if(e){var n=URL.createObjectURL(e);t.vuexHistory.transaction((function(){t.$store.commit("panels/setPanelPreview",{panelId:t.$store.state.panels.currentPanel,url:n})}))}},e.next=12,Object(z["e"])();case 12:if(!e.sent){e.next=16;break}e.t2="image/webp",e.next=17;break;case 16:e.t2="image/jpeg";case 17:e.t3=e.t2,e.t4=Ri,e.t0.toBlob.call(e.t0,e.t1,e.t3,e.t4);case 20:case"end":return e.stop()}}),e)})))()},methods:{download:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=new Date,o="cd-".concat([r.getFullYear(),"".concat(r.getMonth()+1).padStart(2,"0"),"".concat(r.getDate()).padStart(2,"0"),"".concat(r.getHours()).padStart(2,"0"),"".concat(r.getMinutes()).padStart(2,"0"),"".concat(r.getSeconds()).padStart(2,"0")].join("-")),a=t.format.split("/")[1],i=t.format,c=t.quality,e.next=8,t.renderObjects(n,!0,function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:R["a"].saveToFile(n,"".concat(o,"_").concat(e,".").concat(a),i,c/Ii);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))()},estimateExportSize:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=t.format||"image/png",o=t.quality||Ti,e.next=5,t.renderObjects(n,!1,function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){n.toBlob((function(n){n?t(n.size):a("Image ".concat(e+1," could not be rendered."))}),r,o/Ii)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 5:a=e.sent,i=a.map((function(t){return(t*Si/1024/1024).toFixed(2)+"MiB"})),c=i.length>1?"files":"file",u=i.length>1?"These":"It",l=i.length>1?"sizes":"size",Oa["f"].fire(new Oa["d"]("This would export ".concat(i.length," ").concat(c,". ").concat(u," would have the following (aproximate) ").concat(l,": ").concat(i.join(","))));case 11:case"end":return e.stop()}}),e)})))()},renderObjects:function(t,e,n){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(t.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(o,a){var i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=document.createElement("canvas"),i.width=Rt["d"],i.height=Rt["c"]*o.length,c=i.getContext("2d"),t.next=6,Promise.all(o.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n,a){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new Ci(r.$store,o[a],Rt["d"],Rt["c"]),t.next=3,i.render(e,!1);case 3:i.paintOnto(c,0,Rt["c"]*a,Rt["d"],Rt["c"]);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:return t.next=8,n(a,i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),o)})))()},getLimitedPanelList:function(){var t,e=this,n=this.$store.state.panels.panelOrder.length-1,r=0,o=this.pages.split(","),a=[],i=!1,c=Object(q["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value,u=s.trim(),l=u.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(l)if(i=!0,l[2])a.push(parseInt(l[2],10)-1);else{var d=Math.max(parseInt(l[3],10)-1,r),b=Math.min(parseInt(l[4],10)-1,n);if(void 0===d||void 0===b||d>b)continue;for(var p=d;p<=b;++p)a.push(p)}else""!==u&&Oa["f"].fire(new Oa["d"]("Could not read '".concat(s,"' in the page list.")))}}catch(f){c.e(f)}finally{c.f()}return i?a.sort((function(t,e){return t-e})).filter((function(t,e,n){return n[e-1]!==t})).map((function(t){return e.$store.state.panels.panelOrder[t]})):this.$store.state.panels.panelOrder},getPanelDistibution:function(){var t=this.getLimitedPanelList();if(0===this.ppi)return[t];for(var e=[],n=0;n<t.length/this.ppi;++n){var r=n*this.ppi,o=r+this.ppi;e.push(Object(je["a"])(t.slice(r,o)))}return e},moveFocusToActivePanel:function(){var t=this.$el.querySelector(".panel_button.active");t&&this.scrollIntoView(t)},scrollIntoView:function(t){var e=t.parentElement.parentElement,n=Array.from(t.parentElement.children).indexOf(t);if(this.$store.state.ui.vertical){var r=n*t.clientHeight-e.clientHeight/2+t.clientHeight/2;e.scrollTop=r,e.scrollLeft=0}else{var o=n*t.clientWidth-e.clientWidth/2+t.clientWidth/2;e.scrollLeft=o,e.scrollTop=0}},extractObjectText:function(t){switch(t.type){case"textBox":return t.text;case"notification":return t.text;case"poem":return t.text;case"choice":return t.choices.map((function(t){return"[".concat(t.text,"]")})).join("\n")}return""},addNewPanel:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/duplicatePanel",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)}))));case 2:t.$nextTick((function(){t.moveFocusToActivePanel()}));case 3:case"end":return e.stop()}}),e)})))()},updateCurrentPanel:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("panels/setCurrentPanel",{panelId:t});case 1:case"end":return n.stop()}}),n)})))),this.$nextTick((function(){e.moveFocusToActivePanel()}))},deletePanel:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/delete",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)})))),this.$nextTick((function(){t.moveFocusToActivePanel()}))},moveAhead:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:-1})}))},moveBehind:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:1})}))}},watch:{quality:function(t,e){t!==Ii?e>Ai&&t<=Ai&&Oa["f"].fire(new Oa["d"]("Note: A quality level below 70% might be very noticable and impair legibility of text.")):Oa["f"].fire(new Oa["d"]("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."))}}});n("1416");_i.render=sa,_i.__scopeId="data-v-71818f1a";var $i=_i,Bi=Object(r["D"])("data-v-88ed25a2");Object(r["q"])("data-v-88ed25a2");var Vi={class:"panel"},Di=Object(r["j"])("h1",null,"Notification",-1),Li={id:"notification_text"},Fi=Object(r["j"])("label",{for:"notification_text"},"Text:",-1);Object(r["p"])();var Hi=Bi((function(t,e,n,o,a,i){var c=Object(r["u"])("text-editor"),s=Object(r["u"])("image-options"),u=Object(r["u"])("position-and-size"),l=Object(r["u"])("toggle"),d=Object(r["u"])("layers"),b=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",Vi,[Di,t.textEditor?Object(r["j"])(c,{key:0,title:"Notification Text",modelValue:t.text,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),onLeave:e[2]||(e[2]=function(e){return t.textEditor=!1})},null,8,["modelValue"]):t.imageOptionsOpen?Object(r["j"])(s,{key:1,type:"object",title:"Notification",id:t.object.id,onLeave:e[3]||(e[3]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[Object(r["j"])("div",Li,[Fi,Object(r["B"])(Object(r["j"])("textarea",{"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.text=e}),id:"notification_text",onKeydown:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.text]]),Object(r["j"])("button",{onClick:e[6]||(e[6]=function(e){return t.textEditor=!0})},"Formatting")]),Object(r["j"])(u,{obj:t.object},null,8,["obj"]),Object(r["j"])(l,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["j"])(d,{object:t.object},null,8,["object"]),Object(r["j"])(l,{modelValue:t.flip,"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])(l,{modelValue:t.renderBackdrop,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.renderBackdrop=e}),label:"Show backdrop?"},null,8,["modelValue"]),Object(r["j"])("button",{onClick:e[10]||(e[10]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(b,{obj:t.object},null,8,["obj"])],64))])})),Ei=Ft(),Mi=Object(r["l"])({mixins:[P],components:{Toggle:C["a"],PositionAndSize:Tt,Layers:Et,Delete:Nt,TextEditor:Vr,ImageOptions:Ee},data:function(){return{imageOptionsOpen:!1,textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("notification"===t.type)return t},flip:Ei("flip","objects/setFlip"),autoWrap:Ei("autoWrap","objects/setAutoWrapping"),text:Ei("text","objects/setNotificationText"),renderBackdrop:Ei("backdrop","objects/setNotificationBackdrop")}});n("cfdb");Mi.render=Hi,Mi.__scopeId="data-v-88ed25a2";var Ui=Mi,Ni=Object(r["D"])("data-v-51b46526");Object(r["q"])("data-v-51b46526");var Wi={class:"panel"},qi={id:"notification_text"},zi=Object(r["j"])("label",{for:"notification_text"},"Text:",-1);Object(r["p"])();var Gi=Ni((function(t,e,n,o,a,i){var c=Object(r["u"])("text-editor"),s=Object(r["u"])("image-options"),u=Object(r["u"])("toggle"),l=Object(r["u"])("position-and-size"),d=Object(r["u"])("layers"),b=Object(r["u"])("delete");return Object(r["o"])(),Object(r["f"])("div",Wi,[Object(r["j"])("h1",null,Object(r["v"])("poem"===t.object.subType?"Poem":"Console"),1),t.textEditor?Object(r["j"])(c,{key:0,title:"Poem Text",modelValue:t.text,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),onLeave:e[2]||(e[2]=function(e){return t.textEditor=!1})},null,8,["modelValue"]):t.imageOptionsOpen?Object(r["j"])(s,{key:1,type:"object",title:"poem"===t.object.subType?"Poem":"Console",id:t.object.id,onLeave:e[3]||(e[3]=function(e){return t.imageOptionsOpen=!1})},null,8,["title","id"]):(Object(r["o"])(),Object(r["f"])(r["a"],{key:2},[Object(r["j"])("div",qi,[zi,Object(r["B"])(Object(r["j"])("textarea",{"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.text=e}),id:"notification_text",onKeydown:e[5]||(e[5]=Object(r["C"])((function(){}),["stop"]))},null,544),[[r["y"],t.text]]),Object(r["j"])("button",{onClick:e[6]||(e[6]=function(e){return t.textEditor=!0})},"Formatting")]),Object(r["j"])(u,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),"poem"===t.object.subType?(Object(r["o"])(),Object(r["f"])(r["a"],{key:0},[Object(r["B"])(Object(r["j"])("select",{"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.poemBackground=e}),onKeydown:e[9]||(e[9]=Object(r["C"])((function(){}),["stop"]))},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.backgrounds,(function(t,e){return Object(r["o"])(),Object(r["f"])("option",{value:e,key:e},Object(r["v"])(t.name),9,["value"])})),128))],544),[[r["x"],t.poemBackground]]),Object(r["B"])(Object(r["j"])("select",{"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.poemStyle=e}),onKeydown:e[11]||(e[11]=Object(r["C"])((function(){}),["stop"]))},[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.poemTextStyles,(function(t,e){return Object(r["o"])(),Object(r["f"])("option",{value:e,key:e},Object(r["v"])(t.name),9,["value"])})),128))],544),[[r["x"],t.poemStyle]])],64)):Object(r["g"])("",!0),Object(r["j"])(l,{obj:t.object},null,8,["obj"]),Object(r["j"])(d,{object:t.object},null,8,["object"]),Object(r["j"])(u,{modelValue:t.flip,"onUpdate:modelValue":e[12]||(e[12]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["j"])("button",{onClick:e[13]||(e[13]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["j"])(b,{obj:t.object},null,8,["obj"])],64))])})),Yi=Ft(),Ki=Object(r["l"])({mixins:[P],components:{Toggle:C["a"],PositionAndSize:Tt,Layers:Et,Delete:Nt,TextEditor:Vr,ImageOptions:Ee},data:function(){return{textEditor:!1,imageOptionsOpen:!1}},computed:{backgrounds:function(){return oi},poemTextStyles:function(){return gi},object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("poem"===t.type)return t},flip:Yi("flip","objects/setFlip"),text:Yi("text","objects/setPoemText"),autoWrap:Yi("autoWrap","objects/setAutoWrapping"),poemStyle:Yi("font","objects/setPoemFont"),poemBackground:Yi("background","objects/setPoemBackground")}});n("a485");Ki.render=Gi,Ki.__scopeId="data-v-51b46526";var Xi=Ki,Qi=Object(r["l"])({components:{SettingsPanel:$,AddPanel:nt,BackgroundsPanel:Io,CreditsPanel:Zr,CharacterPanel:cn,TextBoxPanel:Fr,ChoicePanel:Gr,SpritePanel:bn,ContentPacksPanel:Eo,PanelsPanel:$i,NotificationPanel:Ui,PoemPanel:Xi},data:function(){return{panelSelection:"add"}},computed:{vertical:function(){return this.$store.state.ui.vertical},selection:function(){return this.$store.state.ui.selection},panel:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection="add"}return this.panelSelection},hasPrevRender:function(){return null!==this.$store.state.ui.lastDownload}},methods:{create:function(){var t=this;R["a"].onPanelChange((function(e){t.panelSelection=e}))},setPanel:function(t){if(t===this.panelSelection&&(t="add"),this.panelSelection=t,this.selection){if(null===this.$store.state.ui.selection)return;this.$store.commit("ui/setSelection",null)}}},watch:{selection:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="add")}}});n("e278");Qi.render=O;var Ji=Qi,Zi=Object(r["D"])("data-v-51633a54");Object(r["q"])("data-v-51633a54");var tc={key:0};Object(r["p"])();var ec=Zi((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",{id:"messageConsole",class:{vertical:t.vertical}},[t.showLoading?(Object(r["o"])(),Object(r["f"])("p",tc,"Loading...")):Object(r["g"])("",!0),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["s"])(t.messages,(function(t,e){return Object(r["o"])(),Object(r["f"])("p",{key:t+"_"+e},Object(r["v"])(t),1)})),128))],2)})),nc=5e3,rc=2e4,oc=100,ac=Object(r["l"])({props:{loading:{default:!1,type:Boolean}},data:function(){return{messages:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}},computed:{vertical:function(){return this.$store.state.ui.vertical}},created:function(){var t=this;this.onLoadingChange(this.loading),Oa["f"].subscribe(Oa["a"],(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.shift()}),nc)})),Oa["f"].subscribe(Oa["b"],(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.shift()}),rc)})),Oa["f"].subscribe(Oa["d"],(function(e){t.messages.push(e.message),setTimeout((function(){t.messages.shift()}),rc)})),Oa["f"].subscribe(Oa["e"],(function(e){t.messages.push(e.error.name),t.messages.push(JSON.stringify(e.error.stack)),t.messages.push(e.info),setTimeout((function(){t.messages.shift(),t.messages.shift(),t.messages.shift()}),rc)}))},methods:{onLoadingChange:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),oc))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),oc)))}},watch:{loading:function(t){this.onLoadingChange(t)}}});n("13f8");ac.render=ec,ac.__scopeId="data-v-51633a54";var ic=ac;function cc(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("canvas",{id:"scaled_display",ref:"sd",height:t.bitmapHeight,width:t.bitmapWidth,style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px"},draggable:"true",onClick:e[1]||(e[1]=function(){return t.onUiClick.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.onTouchStart.apply(t,arguments)}),onDragstart:e[3]||(e[3]=function(){return t.onDragStart.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onMousemove:e[5]||(e[5]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.onSpriteDrop.apply(t,arguments)}),onMouseup:e[7]||(e[7]=function(){return t.onSpriteDrop.apply(t,arguments)}),onDragover:e[8]||(e[8]=function(){return t.onDragOver.apply(t,arguments)}),onDrop:e[9]||(e[9]=function(){return t.onDrop.apply(t,arguments)}),onMouseenter:e[10]||(e[10]=function(){return t.onMouseEnter.apply(t,arguments)})},"HTML5 is required to use the Doki Doki Dialog Generator.",44,["height","width"])}var sc=n("6ae4"),uc=Object(r["l"])({props:{canvasWidth:{default:0},canvasHeight:{default:0}},data:function(){return{sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0}},computed:{selection:function(){return this.$store.state.ui.selection},lqRendering:function(){return this.$store.state.ui.lqRendering},sceneRender:function(){return new Ci(this.$store,this.$store.state.panels.currentPanel,this.bitmapWidth,this.bitmapHeight)},bitmapHeight:function(){return Rt["c"]},bitmapWidth:function(){return Rt["d"]}},methods:{download:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.sceneRender.download();case 2:n=e.sent,t.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.$store.state.ui.lastDownload,t.$store.commit("ui/setLastDownload",n),r&&URL.revokeObjectURL(r);case 3:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})))()},invalidateRender:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))},render_:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.queuedRender&&(cancelAnimationFrame(t.queuedRender),t.queuedRender=null),!t.$store.state.unsafe){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.sceneRender.render(!t.lqRendering,!0);case 5:t.display();case 6:case"end":return e.stop()}}),e)})))()},renderLoadingScreen:function(){if(this.sdCtx){var t=document.createElement("canvas");t.height=this.bitmapHeight,t.width=this.bitmapWidth;var e=new sc["a"](t.getContext("2d"),!0,!1);e.drawText({text:"Starting...",x:t.width/2,y:t.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(t,this.canvasWidth,this.canvasHeight)}},display:function(){this.sdCtx&&(this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,0,0,this.bitmapWidth,this.bitmapHeight))},toRendererCoordinate:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,o=e-n.offsetTop,a=r/n.offsetWidth*n.width,i=o/n.offsetWidth*n.width;return[a,i]},onUiClick:function(t){var e=this;if(this.dropPreventClick)this.dropPreventClick=!1;else{var n,r=this.toRendererCoordinate(t.clientX,t.clientY),o=Object(u["a"])(r,2),a=o[0],i=o[1],c=this.sceneRender.objectsAt(a,i),s=c.findIndex((function(t){return t===e.selection}));n=0===s?null:-1!==s?c[s-1]:c[c.length-1]||null,this.$store.state.ui.selection!==n&&this.$store.commit("ui/setSelection",n)}},onDragStart:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(u["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onTouchStart:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(u["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},onSpriteDragMove:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(u["a"])(n,2),o=r[0],a=r[1];o-=this.dragXOffset,a-=this.dragYOffset;var i=Math.abs(o-this.dragXOriginal),c=Math.abs(a-this.dragYOriginal);i+c>1&&(this.dropPreventClick=!0),t.shiftKey&&(i>c?a=this.dragYOriginal:o=this.dragXOriginal),this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:o,y:a})}))}},onDrop:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer){n.next=4;break}return n.abrupt("return");case 4:r=Object(q["a"])(t.dataTransfer.items);try{for(r.s();!(o=r.n()).done;)a=o.value,"file"===a.kind&&a.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++e.dropSpriteCount,n=Object(z["f"])(t,a.getAsFile());e.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("objects/createSprite",{assets:[{hq:n,lq:n,sourcePack:"dddg.generated.uploaded-sprites"}]});case 2:case"end":return t.stop()}}),t)}))))}()}catch(i){r.e(i)}finally{r.f()}case 6:case"end":return n.stop()}}),n)})))()},onSpriteDrop:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter:function(t){1!==t.buttons&&(this.draggedObject=null)}},watch:{canvasWidth:function(){this.display()},canvasHeight:function(){this.display()}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Oa["f"].subscribe(Oa["c"],(function(){return t.invalidateRender()})),t.$store.subscribe((function(e){"panels/setPanelPreview"!==e.type&&"panels/currentPanel"!==e.type&&t.invalidateRender()}));case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()}});uc.render=cc;var lc=uc,dc=Object(r["D"])("data-v-7f2c764e"),bc=dc((function(t,e,n,o,a,i){return Object(r["o"])(),Object(r["f"])("div",{class:"dialog-wrapper",onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},[Object(r["j"])("dialog",{open:"",onClick:e[1]||(e[1]=Object(r["C"])((function(){}),["stop"]))},[Object(r["t"])(t.$slots,"default")])])})),pc=Object(r["l"])({});n("4b87");pc.render=bc,pc.__scopeId="data-v-7f2c764e";var fc=pc,hc=16/9,jc=20,vc=50,mc=200,gc=Object(r["l"])({components:{ToolBox:Ji,MessageConsole:ic,Render:lc,ModalDialog:fc,SingleBox:Object(r["k"])((function(){return n.e("chunk-7799a822").then(n.bind(null,"dcb9"))})),ExpressionBuilder:Object(r["k"])((function(){return n.e("chunk-ab09dd9e").then(n.bind(null,"d785"))}))},data:function(){return{canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0}},computed:{isSafari:function(){return!1}},methods:{drawLastDownload:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)},setBlendOver:function(){this.blendOver=this.$store.state.ui.lastDownload},optimum:function(t,e){var n=t/hc,r=e*hc;return n>e?n=e:r=t,[r,n]},optimizeWithMenu:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return!this.isSafari&&n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]},updateArea:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(u["a"])(t,3),n=e[0],r=e[1],o=e[2];this.canvasWidth=n,this.canvasHeight=r,this.canvasTooSmall=Math.max(n,r)<mc,this.$store.state.ui.vertical!==o&&this.$store.commit("ui/setVertical",o)},showDialog:function(t){var e=this;if(this.dialogVisable=!0,t){var n=function n(){e.$refs.packDialog&&e.$refs.packDialog.$refs.packDialog?e.$refs.packDialog.$refs.packDialog.setSearch(t):setTimeout(n,vc)};this.$nextTick(n)}},showExpressionDialog:function(t){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=t.character,this.expressionBuilderHeadGroup=t.headGroup},onKeydown:function(t){var e=this;this.vuexHistory.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(n)if("Delete"!==t.key)if("z"===t.key&&t.ctrlKey)t.preventDefault();else if("y"===t.key&&t.ctrlKey)t.preventDefault();else{if("character"===n.type){var r=n;if(r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var o=n.x,a=n.y;if("ArrowLeft"===t.key)o-=t.shiftKey?1:jc;else if(n&&"ArrowRight"===t.key)o+=t.shiftKey?1:jc;else if(n&&"ArrowUp"===t.key)a-=t.shiftKey?1:jc;else{if(!n||"ArrowDown"!==t.key)return;a+=t.shiftKey?1:jc}e.$store.dispatch("objects/setPosition",{id:n.id,x:o,y:a})}else e.$store.dispatch("objects/removeObject",{id:n.id})}))},destroyed:function(){window.removeEventListener("keydown",this.onKeydown)}},mounted:function(){var t=this;window.addEventListener("keypress",(function(e){"Escape"===e.key&&t.vuexHistory.transaction((function(){null!==t.$store.state.ui.selection&&t.$store.commit("ui/setSelection",null)}))}))},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.updateArea(),window.addEventListener("resize",t.updateArea),window.removeEventListener("keydown",t.onKeydown),window.addEventListener("keydown",t.onKeydown),window.app=t,window.store=t.$store,document.body.addEventListener("drop",(function(t){t.preventDefault()}),!0),document.body.addEventListener("dragover",(function(t){t.preventDefault()}),!0),t.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 2:return e.next=4,t.$store.dispatch("panels/createPanel");case 4:return 0===Object.keys(t.$store.state.objects.objects).length&&t.$store.dispatch("objects/createTextBox",{}),e.next=7,t.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:t.$store.state.panels.currentPanel});case 7:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e)})))()}});n("9cdc");gc.render=c;var Oc=gc,yc=n("5502"),kc={},xc=0,wc={createSprite:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.state,r=t.commit,o=t.rootState,n.next=3,Object(z["a"])(e.assets[0],!1);case 3:if(a=n.sent,a instanceof HTMLImageElement){n.next=6;break}return n.abrupt("return");case 6:r("create",{object:{assets:e.assets,flip:!1,height:a.height,width:a.width,id:"sprite_"+ ++xc,panelId:o.panels.currentPanel,onTop:!1,opacity:100,preserveRatio:!0,ratio:a.width/a.height,type:"sprite",version:0,x:640,y:0,composite:"source-over",filters:[]}});case 7:case"end":return n.stop()}}),n)})))()}},Cc={setChoices:function(t,e){var n=t.objects[e.id];n.choices=e.choices,++n.version},setChoiceColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setChoiceDistance:function(t,e){var n=t.objects[e.id];n.choiceDistance=e.choiceDistance,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Sc=0,Pc={createChoice:function(t,e){var n=t.commit,r=t.rootState,o="choice_"+ ++Sc;return n("create",{object:{x:640,y:Ga,width:Na,height:0,panelId:r.panels.currentPanel,flip:!1,id:o,onTop:!0,autoWrap:!0,opacity:100,type:"choice",version:0,preserveRatio:!1,ratio:dr/pr,choiceDistance:Wa,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:Ma,composite:"source-over",filters:[]}}),o},addChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id];r("setChoices",{id:e.id,choices:[].concat(Object(je["a"])(o.choices),[{selected:!1,text:e.text}])})},removeChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(je["a"])(o.choices);a[e.choiceIdx]&&(a.splice(e.choiceIdx,1),0===a.length&&a.push({selected:!1,text:""}),r("setChoices",{id:e.id,choices:a}))},setChoiceText:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(je["a"])(o.choices);a[e.choiceIdx]&&(a[e.choiceIdx].text=e.text,r("setChoices",{id:e.id,choices:a}))}},Rc=4,Ic={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingDefault:function(t,e){var n=t.objects[e.id];n.talkingDefault=e.talkingDefault,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingDefault="Other",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version},setResetBounds:function(t,e){var n=t.objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,++n.version}},Tc=0,Ac={createTextBox:function(t,e){var n=t.commit,r=t.rootState,o="textBox_"+ ++Tc,a=e.resetBounds||{x:640,y:$r,width:dr,height:pr};return n("create",{object:Object(ue["a"])(Object(ue["a"])({},a),{},{panelId:r.panels.currentPanel,flip:!1,id:o,onTop:!0,opacity:100,type:"textBox",version:0,preserveRatio:!1,ratio:dr/pr,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:"normal",customColor:"#ffa8d2",deriveCustomColors:!0,customControlsColor:"#552222",customNameboxColor:"#ffeef6",customNameboxWidth:168,customNameboxStroke:"#bb5599",talkingDefault:"No-one",talkingOther:"",text:"",resetBounds:a,composite:"source-over",filters:[]})}),o},setStyle:function(t,e){var n=t.commit;n("setStyle",{id:e.id,style:e.style})},resetTextboxBounds:function(t,e){var n=t.commit,r=t.state,o=(t.dispatch,r.objects[e.id]);n("setPosition",{id:e.id,x:o.resetBounds.x,y:o.resetBounds.y}),n("setSize",{id:e.id,height:o.resetBounds.height,width:o.resetBounds.width})},splitTextbox:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,a=t.dispatch,i=o.objects[e.id],c=(i.width-Rc)/2,r("setResetBounds",{id:e.id,resetBounds:{x:i.x-c/2,y:i.y,width:c,height:i.height}}),r("setStyle",{id:e.id,style:"custom"}),n.next=7,a("createTextBox",{resetBounds:{x:i.x+c+Rc/2,y:i.y,width:c,height:i.height}});case 7:s=n.sent,r("setStyle",{id:s,style:"custom"}),i.flip&&r("setFlip",{id:s,flip:i.flip});case 10:case"end":return n.stop()}}),n)})))()}},_c={setNotificationColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setNotificationText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setNotificationBackdrop:function(t,e){var n=e.id,r=e.backdrop,o=t.objects[n];o.backdrop=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},$c=0,Bc={createNotification:function(t,e){var n=t.commit,r=t.rootState,o="notification_"+ ++$c;return n("create",{object:{x:Rt["d"]/2,y:Rt["c"]/2,width:Na,height:0,panelId:r.panels.currentPanel,flip:!1,autoWrap:!1,id:o,onTop:!0,opacity:100,type:"notification",version:0,preserveRatio:!1,ratio:dr/pr,customColor:Ma,text:"Click here to edit notification",backdrop:!0,composite:"source-over",filters:[]}}),o}},Vc={setPoemBackground:function(t,e){var n=e.id,r=e.background,o=t.objects[n];o.background=r,++o.version},setPoemFont:function(t,e){var n=e.id,r=e.font,o=t.objects[n];o.font=r,++o.version},setPoemText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Dc=0,Lc={createPoem:function(t,e){var n=t.commit,r=t.rootState,o="poem_"+ ++Dc;return n("create",{object:{subType:"poem",x:ci,y:si,width:di,height:bi,panelId:r.panels.currentPanel,flip:!1,id:o,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:di/bi,background:ai,font:ii,text:"New poem\n\nClick here to edit poem",composite:"source-over",filters:[]}}),o},createConsole:function(t,e){var n=t.commit,r=t.rootState,o="poem_"+ ++Dc;return n("create",{object:{subType:"console",x:fi/2,y:hi/2,width:fi,height:hi,panelId:r.panels.currentPanel,flip:!1,id:o,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,ratio:fi/hi,background:ji,font:vi,text:"> _\n  \n  Console command\n  Click here to edit",composite:"source-over",filters:[],autoWrap:!0}}),o}},Fc=0,Hc={namespaced:!0,state:{objects:{},panels:{}},mutations:Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])({create:function(t,e){var n=e.object;t.panels[n.panelId]||(t.panels[n.panelId]={id:n.panelId,onTopOrder:[],order:[]});var r=t.panels[n.panelId],o=n.onTop?r.onTopOrder:r.order;t.objects[n.id]=n,o.push(n.id)},removeFromList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order,a=o.indexOf(e.id);o.splice(a,1)},addToList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order;o.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},removeObject:function(t,e){var n=t.objects[e.id];delete t.objects[e.id];var r=t.panels[n.panelId];0===r.onTopOrder.length&&0===r.order.length&&delete t.panels[n.panelId]},setComposition:function(t,e){var n=t.objects[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.objects[e.id];n.filters=e.filters}},kc),ft["b"]),Ic),Cc),_c),Vc),actions:Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])(Object(ue["a"])({removeObject:function(t,e){var n=t.state,r=t.commit,o=t.rootState,a=n.objects[e.id];o.ui.selection===e.id&&r("ui/setSelection",null,{root:!0}),r("removeFromList",{id:e.id,onTop:a.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=n.objects[e.id];"character"===a.type?o("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId];o.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:(e.onTop?a.onTopOrder:a.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId],i=o.onTop?a.onTopOrder:a.order,c=i.indexOf(o.id),s=c+e.delta;s<0&&(s=0),s>i.length&&(s=i.length),r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:s,onTop:o.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=e.preserveRatio?o.width/o.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:a})},setWidth:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.width/o.ratio:o.height;n("setSize",{id:e.id,height:a,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.height*o.ratio:o.width;n("setSize",{id:e.id,height:e.height,width:a})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Object(ft["d"])(t,n.id,e);case"sprite":return;case"textBox":return}}))},copyObjects:function(t,e){var n=t.commit,r=t.state,o=e.sourcePanelId,a=e.targetPanelId,i=r.panels[o];if(i)for(var c=0,s=[].concat(Object(je["a"])(i.onTopOrder),Object(je["a"])(i.order));c<s.length;c++){var u=s[c],l=r.objects[u];n("create",{object:Object(ue["a"])(Object(ue["a"])({},JSON.parse(JSON.stringify(l))),{},{id:"copy_".concat(l.id,"_").concat(++Fc),panelId:a})})}},deleteAllOfPanel:function(t,e){for(var n=t.state,r=t.dispatch,o=e.panelId,a=n.panels[o],i=0,c=[].concat(Object(je["a"])(a.onTopOrder),Object(je["a"])(a.order));i<c.length;i++){var s=c[i];r("removeObject",{id:s})}},addFilter:function(t,e){var n,r=t.state,o=t.commit,a=r.objects[e.id],i=Object(je["a"])(a.filters);n="drop-shadow"===e.type?{type:"drop-shadow",blurRadius:0,color:"rgba(0,0,0,0.5)",offsetX:10,offsetY:10}:{type:e.type,value:De.has(e.type)?1:0},i.splice(e.idx,0,n),o("setFilters",{id:e.id,filters:i})},removeFilter:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(je["a"])(o.filters);a.splice(e.idx,1),r("setFilters",{id:e.id,filters:a})},moveFilter:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(je["a"])(o.filters),i=a[e.idx];a.splice(e.idx,1),a.splice(e.idx+e.moveBy,0,i),r("setFilters",{id:e.id,filters:a})},setFilter:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(je["a"])(o.filters),i=a[e.idx];"drop-shadow"===i.type?(void 0!==e.blurRadius&&(i.blurRadius=e.blurRadius),void 0!==e.color&&(i.color=e.color),void 0!==e.offsetX&&(i.offsetX=e.offsetX),void 0!==e.offsetY&&(i.offsetY=e.offsetY)):i.value=e.value,r("setFilters",{id:e.id,filters:a})}},wc),ft["a"]),Ac),Pc),Bc),Lc)},Ec={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e}}},Mc=n("0a94"),Uc=n("5311"),Nc=n("77e3"),Wc=n("b3a0");function qc(t,e){return{backgrounds:zc(t.backgrounds,e.backgrounds),characters:Yc(t.characters,e.characters),dependencies:Zc(t.dependencies,e.dependencies),fonts:ts(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Object(ue["a"])(Object(ue["a"])({},t),{},{files:Zc(t.files,e.files)})})),poemStyles:ts(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),poemBackgrounds:[].concat(Object(je["a"])(t.poemBackgrounds),Object(je["a"])(e.poemBackgrounds)),sprites:ts(t.sprites,e.sprites,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(je["a"])(t.variants),Object(je["a"])(e.variants))}})),colors:ts(t.colors,e.colors,(function(t){return t.color}),(function(t){return t}))}}function zc(t,e){return ts(t,e,(function(t){return t.id}),Gc)}function Gc(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(je["a"])(t.variants),Object(je["a"])(e.variants))}}function Yc(t,e){return ts(t,e,(function(t){return t.id}),Kc)}function Kc(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:Jc(t.heads,e.heads),styleGroups:ts(t.styleGroups,e.styleGroups,(function(t){return t.id}),(function(t,e){return{id:t.id,styleComponents:ts(t.styleComponents,e.styleComponents,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:Xc(t.variants,e.variants)}})),styles:ts(t.styles,e.styles,(function(t){return JSON.stringify(t.components)}),(function(t,e){return{components:t.components,poses:ts(t.poses,e.poses,(function(t){return t.id}),Qc)}}))}}))}}function Xc(t,e){var n=Object(ue["a"])({},t);for(var r in e)e.hasOwnProperty(r)&&(n.hasOwnProperty(r)||(n[r]=e[r]));return n}function Qc(t,e){var n=Object(ue["a"])({},t.positions);for(var r in e.positions)n[r]?n[r]=[].concat(Object(je["a"])(n[r]),Object(je["a"])(e.positions[r])):n[r]=e.positions[r];return{id:t.id,compatibleHeads:Zc(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function Jc(t,e){var n=Object(ue["a"])({},t);for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];if(n[r]){var a=n[r];n[r]={previewOffset:a.previewOffset,previewSize:a.previewSize,variants:[].concat(Object(je["a"])(a.variants),Object(je["a"])(o.variants))}}else n[r]=o}return n}function Zc(t,e){var n,r=Object(je["a"])(t),o=Object(q["a"])(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.includes(a)||r.push(a)}}catch(i){o.e(i)}finally{o.f()}return r}function ts(t,e,n,r){var o,a=Object(je["a"])(t),i=new Map(t.map((function(t,e){return[n(t),e]}))),c=Object(q["a"])(e);try{for(c.s();!(o=c.n()).done;){var s=o.value,u=n(s);if(i.has(u)){var l=i.get(u),d=a[l];a.splice(l,1,r(d,s))}else i.set(u,a.length),a.push(s)}}catch(b){c.e(b)}finally{c.f()}return a}function es(t){return t.split("/").slice(0,-1).join("/")+"/"}var ns=new Set(["png","gif","bmp","svg"]),rs={namespaced:!0,state:{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,n.next=3,as(e);case 3:a=n.sent,i=new Set(o.contentPacks.map((function(t){return t.packId}))),c=Object(q["a"])(e.dependencies),n.prev=6,c.s();case 8:if((s=c.n()).done){n.next=14;break}if(u=s.value,i.has(u)){n.next=12;break}throw new Error("Missing dependency '".concat(u,"'. Refusing to install ").concat(e.packId));case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),c.e(n.t0);case 19:return n.prev=19,c.f(),n.finish(19);case 22:r("setContentPacks",[].concat(Object(je["a"])(o.contentPacks),[a])),r("setCurrentContent",qc(o.current,a));case 24:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()},removeContentPacks:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,o=t.state,a=os(o.contentPacks.filter((function(t){return!e.has(t.packId)}))),r("setContentPacks",a),r("setCurrentContent",a.reduce((function(t,e){return qc(t,e)})));case 4:case"end":return n.stop()}}),n)})))()},replaceContentPack:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,o=t.state,!e.processed){n.next=5;break}n.t0=e.contentPack,n.next=8;break;case 5:return n.next=7,as(e.contentPack);case 7:n.t0=n.sent;case 8:a=n.t0,i=o.contentPacks,c=i.findIndex((function(t){return t.packId===e.contentPack.packId})),-1===c?i.push(a):i.splice(c,1,a),i=os(i),r("setContentPacks",i),r("setCurrentContent",i.reduce((function(t,e){return qc(t,e)})));case 15:case"end":return n.stop()}}),n)})))()},loadContentPacks:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,"string"===typeof e&&(e=[e]),n.next=4,Promise.all(e.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,n.ok||cs("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),cs("Content pack is not valid json!");case 13:try{a={"./":es(e),"/":es(location.href)+"assets/"},o="2.0"===r.version?Object(Uc["normalizeContentPack"])(r,a):Object(Nc["convert"])(Object(Wc["normalizeCharacter"])(r,a),a,!1)}catch(i){cs("Content pack is not in a valid format!",i)}return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:o=n.sent,a=Object(q["a"])(o),n.prev=6,a.s();case 8:if((i=a.n()).done){n.next=14;break}return c=i.value,n.next=12,r("contentPack",c);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:return n.abrupt("return",o.map((function(t){return t.packId})));case 23:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()}},getters:{getCharacters:function(t){var e,n=t.current,r=new Map,o=Object(q["a"])(n.characters);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r},getBackgrounds:function(t){var e,n=t.current,r=new Map,o=Object(q["a"])(n.backgrounds);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r}}};function os(t){return t}function as(t){return is.apply(this,arguments)}function is(){return is=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Object(z["e"])();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(je["a"])(ns)),t.next=8;break;case 7:t.t1=ns;case 8:return t.t2=t.t1,n=new t.t0(t.t2),r=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),o=Object(Mc["assetWalker"])(e,(function(t,o){var a=Object(Mc["normalizePath"])(t,r,n,!1),i=Object(Mc["normalizePath"])(t,r,n,!0);return{hq:a,lq:i,sourcePack:e.packId||"buildIn"}})),t.abrupt("return",o);case 13:case"end":return t.stop()}}),t)}))),is.apply(this,arguments)}function cs(t,e){throw console.error(t,e),new Error(t)}var ss=Object(yc["a"])({state:{unsafe:!1},mutations:{setUnsafe:function(t,e){t.unsafe=e}},actions:{removePacks:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,o=t.commit,a=t.state,i=e.packs,c=JSON.parse(JSON.stringify(a.content.current)),o("setUnsafe",!0),n.next=6,r("content/removeContentPacks",i);case 6:return n.next=8,r("panels/fixContentPackRemoval",c);case 8:return n.next=10,r("objects/fixContentPackRemoval",c);case 10:o("setUnsafe",!1);case 11:case"end":return n.stop()}}),n)})))()}},modules:{objects:Hc,ui:Ec,panels:fa,content:rs}}),us=(n("4160"),n("159b"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.config.globalProperties.$store)throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={});var n=t.config.globalProperties.$store;function o(t,e){var r={};switch(Object(ua["a"])(e.payload)){case"object":e.payload instanceof Array&&(r=[]),n.commit("".concat(e.type),Object.assign(r,e.payload));break;default:n.commit("".concat(e.type),e.payload)}}function a(t,e){return i.apply(this,arguments)}function i(){return i=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){o(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(t){return u.apply(this,arguments)}function u(){return u=Object(s["a"])(regeneratorRuntime.mark((function t(r){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=r.data.done.slice(0),r.data.done=[],n.commit(e.resetStateMutation),i=0;case 4:if(!(i<o.length)){t.next=10;break}return t.next=7,a(r,o[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}var l={};function d(t){if(!l[t]){var n,r=t.split("/"),o={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},a="",i=Object(q["a"])(r);try{for(i.s();!(n=i.n()).done;){var c=n.value;e.mutations[a+"*"]&&Object.assign(o,e.mutations[a+"*"]),a+=c+"/"}}catch(s){i.e(s)}finally{i.f()}e.mutations[t]&&Object.assign(o,e.mutations[t]),l[t]=o}return l[t]}var b={data:Object(r["r"])({done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}),initialize:function(){b.initialized||(b.initialized=!0,n.subscribe((function(t){var n=function(){t.type===e.resetStateMutation||d(t.type).ignore(t)||(b.currentTransaction.push(t),b.newMutation&&(b.data.undone=[]))};b.currentTransaction?n():b.transaction((function(){n()}))})))},redo:function(){if(!(b.data.undone.length<=0)){var t=b.data.undone.pop();b.newMutation=!1,a(b,t),b.newMutation=!0}},undo:function(){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(b.data.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return b.data.undone.push(b.data.done.pop()),b.newMutation=!1,t.next=6,c(b);case 6:b.newMutation=!0;case 7:case"end":return t.stop()}}),t)})))()},transaction:function(t){return new Promise((function(e,n){var r=function(){var n=Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return b.currentTransaction=[],n.prev=1,n.next=4,t();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.log("Error during transaction!: ",n.t0);case 9:r=b.data.done[b.data.done.length-1],1===b.currentTransaction.length&&r&&1===r.length&&(o=d(b.currentTransaction[0].type),o.combinable(r[0],b.currentTransaction[0])&&(a=o.combinator(r[0],b.currentTransaction[0]),b.data.done.pop(),b.currentTransaction=a?[a]:[])),b.currentTransaction.length>0&&b.data.done.push(b.currentTransaction),b.currentTransaction=null,b.data.transactionQueue.length>0&&b.data.transactionQueue.pop()(),e();case 15:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();b.currentTransaction?b.data.transactionQueue.push(r):r()}))}};t.config.globalProperties.vuexHistory=b,b.initialize()}});Object(r["e"])(Oc).use(ss).use(us).mount("#app")},cfdb:function(t,e,n){"use strict";n("df56")},d049:function(t,e,n){"use strict";n("8f65")},d55d:function(t,e,n){},d673:function(t,e,n){},d699:function(t,e,n){"use strict";n("4217")},dc32:function(t,e,n){},dc61:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["D"])("data-v-032c021c"),a=o((function(t,e,n,o,a,i){return t.visible?(Object(r["o"])(),Object(r["f"])("div",{key:0,onDragleave:e[1]||(e[1]=function(e){return t.visible=!1}),onDrop:e[2]||(e[2]=function(){return t.drop.apply(t,arguments)}),class:{vertical:t.vertical}},[Object(r["t"])(t.$slots,"default")],34)):Object(r["g"])("",!0)})),i=(n("ac1f"),n("466d"),n("b85c")),c=Object(r["l"])({computed:{vertical:function(){return this.$store.state.ui.vertical}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},drop:function(t){if(this.hide(),t.stopPropagation(),t.preventDefault(),t.dataTransfer){var e,n=Object(i["a"])(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var r=e.value;"file"===r.kind&&r.type.match(/image.*/)&&this.$emit("drop",r.getAsFile())}}catch(o){n.e(o)}finally{n.f()}}}}});n("d049");c.render=a,c.__scopeId="data-v-032c021c";e["a"]=c},df56:function(t,e,n){},e278:function(t,e,n){"use strict";n("b5c3")},e2ee:function(t,e,n){},e650:function(t,e,n){"use strict";n("8056")},e67b:function(t,e,n){},e715:function(t,e,n){},e760:function(t,e,n){"use strict";n("b704")},ea98:function(t,e,n){"use strict";n("480b")},ec4d:function(t,e,n){},efa1:function(t,e,n){},f704:function(t,e,n){"use strict";n("e67b")},f982:function(t,e,n){},fa82:function(t,e,n){"use strict";n("e715")},fcd6:function(t,e,n){},fd0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("d3b7"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("6ae4"),c=n("73e5"),s=n("032b"),u=n("fec4"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u["d"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u["c"];Object(o["a"])(this,t),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=e,this.previewCanvas.height=n}return Object(a["a"])(t,[{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],r=!(s.length>2&&void 0!==s[2])||s[2],this.runningContext&&this.runningContext.abort(),o=this.previewCanvas.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),a=this.runningContext=new i["a"](o,n,r),t.prev=6,t.next=9,e(this.runningContext);case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t["catch"](6),!(t.t0 instanceof c["a"])){t.next=15;break}return t.abrupt("return",!1);case 15:throw t.t0;case 16:return t.prev=16,a===this.runningContext&&(this.runningContext=null),t.finish(16);case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this,[[6,11,16,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e,n,r,o){r&&o?t.drawImage(this.previewCanvas,e,n,r,o):t.drawImage(this.previewCanvas,e,n)}},{key:"download",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,o=r.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(new i["a"](o,!0,!1));case 7:return t.abrupt("return",s["a"].saveToFile(r,n));case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderToBlob",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,r=n.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(new i["a"](r,!0,!1));case 7:return t.next=9,new Promise((function(t,e){n.toBlob((function(n){n?t(n):e()}))}));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}()},fec4:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i}));var r=1280,o=720,a=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],i=[200,240,400,493,640,786,880,1040,1080]}});
//# sourceMappingURL=app.2abd246d.js.map