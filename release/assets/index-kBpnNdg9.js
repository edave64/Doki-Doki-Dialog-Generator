var Xa=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function Ui(t,e){const n=Object.create(null),o=t.split(",");for(let s=0;s<o.length;s++)n[o[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const We={},wo=[],en=()=>{},Lv=()=>!1,Nv=/^on[^a-z]/,zr=t=>Nv.test(t),Vi=t=>t.startsWith("onUpdate:"),nt=Object.assign,Wi=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Fv=Object.prototype.hasOwnProperty,Se=(t,e)=>Fv.call(t,e),de=Array.isArray,Po=t=>Yo(t)==="[object Map]",Xo=t=>Yo(t)==="[object Set]",Ya=t=>Yo(t)==="[object Date]",Hv=t=>Yo(t)==="[object RegExp]",_e=t=>typeof t=="function",Je=t=>typeof t=="string",So=t=>typeof t=="symbol",He=t=>t!==null&&typeof t=="object",Td=t=>(He(t)||_e(t))&&_e(t.then)&&_e(t.catch),Ad=Object.prototype.toString,Yo=t=>Ad.call(t),Uv=t=>Yo(t).slice(8,-1),Ed=t=>Yo(t)==="[object Object]",zi=t=>Je(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,fr=Ui(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Xr=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Vv=/-(\w)/g,Io=Xr(t=>t.replace(Vv,(e,n)=>n?n.toUpperCase():"")),Wv=/\B([A-Z])/g,lo=Xr(t=>t.replace(Wv,"-$1").toLowerCase()),Rd=Xr(t=>t.charAt(0).toUpperCase()+t.slice(1)),xl=Xr(t=>t?`on${Rd(t)}`:""),to=(t,e)=>!Object.is(t,e),Co=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},yr=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},_r=t=>{const e=parseFloat(t);return isNaN(e)?t:e},zv=t=>{const e=Je(t)?Number(t):NaN;return isNaN(e)?t:e};let qa;const Zl=()=>qa||(qa=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Ke(t){if(de(t)){const e={};for(let n=0;n<t.length;n++){const o=t[n],s=Je(o)?Gv(o):Ke(o);if(s)for(const r in s)e[r]=s[r]}return e}else if(Je(t)||He(t))return t}const Xv=/;(?![^(]*\))/g,Yv=/:([^]+)/,qv=/\/\*[^]*?\*\//g;function Gv(t){const e={};return t.replace(qv,"").split(Xv).forEach(n=>{if(n){const o=n.split(Yv);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function Me(t){let e="";if(Je(t))e=t;else if(de(t))for(let n=0;n<t.length;n++){const o=Me(t[n]);o&&(e+=o+" ")}else if(He(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Kv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Jv=Ui(Kv);function Bd(t){return!!t||t===""}function Zv(t,e){if(t.length!==e.length)return!1;let n=!0;for(let o=0;n&&o<t.length;o++)n=Ms(t[o],e[o]);return n}function Ms(t,e){if(t===e)return!0;let n=Ya(t),o=Ya(e);if(n||o)return n&&o?t.getTime()===e.getTime():!1;if(n=So(t),o=So(e),n||o)return t===e;if(n=de(t),o=de(e),n||o)return n&&o?Zv(t,e):!1;if(n=He(t),o=He(e),n||o){if(!n||!o)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const l in t){const a=t.hasOwnProperty(l),i=e.hasOwnProperty(l);if(a&&!i||!a&&i||!Ms(t[l],e[l]))return!1}}return String(t)===String(e)}function Xi(t,e){return t.findIndex(n=>Ms(n,e))}const $e=t=>Je(t)?t:t==null?"":de(t)||He(t)&&(t.toString===Ad||!_e(t.toString))?JSON.stringify(t,Md,2):String(t),Md=(t,e)=>e&&e.__v_isRef?Md(t,e.value):Po(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[o,s])=>(n[`${o} =>`]=s,n),{})}:Xo(e)?{[`Set(${e.size})`]:[...e.values()]}:He(e)&&!de(e)&&!Ed(e)?String(e):e;let Ht;class Dd{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ht,!e&&Ht&&(this.index=(Ht.scopes||(Ht.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Ht;try{return Ht=this,e()}finally{Ht=n}}}on(){Ht=this}off(){Ht=this.parent}stop(e){if(this._active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Qv(t){return new Dd(t)}function eg(t,e=Ht){e&&e.active&&e.effects.push(t)}function tg(){return Ht}const Yi=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Ld=t=>(t.w&Mn)>0,Nd=t=>(t.n&Mn)>0,ng=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Mn},og=t=>{const{deps:e}=t;if(e.length){let n=0;for(let o=0;o<e.length;o++){const s=e[o];Ld(s)&&!Nd(s)?s.delete(t):e[n++]=s,s.w&=~Mn,s.n&=~Mn}e.length=n}},Ql=new WeakMap;let ps=0,Mn=1;const ei=30;let Ut;const Zn=Symbol(""),ti=Symbol("");class qi{constructor(e,n=null,o){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,eg(this,o)}run(){if(!this.active)return this.fn();let e=Ut,n=Tn;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ut,Ut=this,Tn=!0,Mn=1<<++ps,ps<=ei?ng(this):Ga(this),this.fn()}finally{ps<=ei&&og(this),Mn=1<<--ps,Ut=this.parent,Tn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ut===this?this.deferStop=!0:this.active&&(Ga(this),this.onStop&&this.onStop(),this.active=!1)}}function Ga(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Tn=!0;const Fd=[];function qo(){Fd.push(Tn),Tn=!1}function Go(){const t=Fd.pop();Tn=t===void 0?!0:t}function yt(t,e,n){if(Tn&&Ut){let o=Ql.get(t);o||Ql.set(t,o=new Map);let s=o.get(n);s||o.set(n,s=Yi()),Hd(s)}}function Hd(t,e){let n=!1;ps<=ei?Nd(t)||(t.n|=Mn,n=!Ld(t)):n=!t.has(Ut),n&&(t.add(Ut),Ut.deps.push(t))}function cn(t,e,n,o,s,r){const l=Ql.get(t);if(!l)return;let a=[];if(e==="clear")a=[...l.values()];else if(n==="length"&&de(t)){const i=Number(o);l.forEach((c,u)=>{(u==="length"||!So(u)&&u>=i)&&a.push(c)})}else switch(n!==void 0&&a.push(l.get(n)),e){case"add":de(t)?zi(n)&&a.push(l.get("length")):(a.push(l.get(Zn)),Po(t)&&a.push(l.get(ti)));break;case"delete":de(t)||(a.push(l.get(Zn)),Po(t)&&a.push(l.get(ti)));break;case"set":Po(t)&&a.push(l.get(Zn));break}if(a.length===1)a[0]&&ni(a[0]);else{const i=[];for(const c of a)c&&i.push(...c);ni(Yi(i))}}function ni(t,e){const n=de(t)?t:[...t];for(const o of n)o.computed&&Ka(o);for(const o of n)o.computed||Ka(o)}function Ka(t,e){(t!==Ut||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const sg=Ui("__proto__,__v_isRef,__isVue"),Ud=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(So)),Ja=rg();function rg(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const o=Te(this);for(let r=0,l=this.length;r<l;r++)yt(o,"get",r+"");const s=o[e](...n);return s===-1||s===!1?o[e](...n.map(Te)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){qo();const o=Te(this)[e].apply(this,n);return Go(),o}}),t}function lg(t){const e=Te(this);return yt(e,"has",t),e.hasOwnProperty(t)}class Vd{constructor(e=!1,n=!1){this._isReadonly=e,this._shallow=n}get(e,n,o){const s=this._isReadonly,r=this._shallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw"&&o===(s?r?yg:Yd:r?Xd:zd).get(e))return e;const l=de(e);if(!s){if(l&&Se(Ja,n))return Reflect.get(Ja,n,o);if(n==="hasOwnProperty")return lg}const a=Reflect.get(e,n,o);return(So(n)?Ud.has(n):sg(n))||(s||yt(e,"get",n),r)?a:be(a)?l&&zi(n)?a:a.value:He(a)?s?qd(a):Dn(a):a}}class Wd extends Vd{constructor(e=!1){super(!1,e)}set(e,n,o,s){let r=e[n];if(jo(r)&&be(r)&&!be(o))return!1;if(!this._shallow&&(!wr(o)&&!jo(o)&&(r=Te(r),o=Te(o)),!de(e)&&be(r)&&!be(o)))return r.value=o,!0;const l=de(e)&&zi(n)?Number(n)<e.length:Se(e,n),a=Reflect.set(e,n,o,s);return e===Te(s)&&(l?to(o,r)&&cn(e,"set",n,o):cn(e,"add",n,o)),a}deleteProperty(e,n){const o=Se(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&o&&cn(e,"delete",n,void 0),s}has(e,n){const o=Reflect.has(e,n);return(!So(n)||!Ud.has(n))&&yt(e,"has",n),o}ownKeys(e){return yt(e,"iterate",de(e)?"length":Zn),Reflect.ownKeys(e)}}class ig extends Vd{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const ag=new Wd,cg=new ig,ug=new Wd(!0),Gi=t=>t,Yr=t=>Reflect.getPrototypeOf(t);function Xs(t,e,n=!1,o=!1){t=t.__v_raw;const s=Te(t),r=Te(e);n||(to(e,r)&&yt(s,"get",e),yt(s,"get",r));const{has:l}=Yr(s),a=o?Gi:n?Zi:ks;if(l.call(s,e))return a(t.get(e));if(l.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Ys(t,e=!1){const n=this.__v_raw,o=Te(n),s=Te(t);return e||(to(t,s)&&yt(o,"has",t),yt(o,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function qs(t,e=!1){return t=t.__v_raw,!e&&yt(Te(t),"iterate",Zn),Reflect.get(t,"size",t)}function Za(t){t=Te(t);const e=Te(this);return Yr(e).has.call(e,t)||(e.add(t),cn(e,"add",t,t)),this}function Qa(t,e){e=Te(e);const n=Te(this),{has:o,get:s}=Yr(n);let r=o.call(n,t);r||(t=Te(t),r=o.call(n,t));const l=s.call(n,t);return n.set(t,e),r?to(e,l)&&cn(n,"set",t,e):cn(n,"add",t,e),this}function ec(t){const e=Te(this),{has:n,get:o}=Yr(e);let s=n.call(e,t);s||(t=Te(t),s=n.call(e,t)),o&&o.call(e,t);const r=e.delete(t);return s&&cn(e,"delete",t,void 0),r}function tc(){const t=Te(this),e=t.size!==0,n=t.clear();return e&&cn(t,"clear",void 0,void 0),n}function Gs(t,e){return function(o,s){const r=this,l=r.__v_raw,a=Te(l),i=e?Gi:t?Zi:ks;return!t&&yt(a,"iterate",Zn),l.forEach((c,u)=>o.call(s,i(c),i(u),r))}}function Ks(t,e,n){return function(...o){const s=this.__v_raw,r=Te(s),l=Po(r),a=t==="entries"||t===Symbol.iterator&&l,i=t==="keys"&&l,c=s[t](...o),u=n?Gi:e?Zi:ks;return!e&&yt(r,"iterate",i?ti:Zn),{next(){const{value:f,done:p}=c.next();return p?{value:f,done:p}:{value:a?[u(f[0]),u(f[1])]:u(f),done:p}},[Symbol.iterator](){return this}}}}function hn(t){return function(...e){return t==="delete"?!1:this}}function dg(){const t={get(r){return Xs(this,r)},get size(){return qs(this)},has:Ys,add:Za,set:Qa,delete:ec,clear:tc,forEach:Gs(!1,!1)},e={get(r){return Xs(this,r,!1,!0)},get size(){return qs(this)},has:Ys,add:Za,set:Qa,delete:ec,clear:tc,forEach:Gs(!1,!0)},n={get(r){return Xs(this,r,!0)},get size(){return qs(this,!0)},has(r){return Ys.call(this,r,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:Gs(!0,!1)},o={get(r){return Xs(this,r,!0,!0)},get size(){return qs(this,!0)},has(r){return Ys.call(this,r,!0)},add:hn("add"),set:hn("set"),delete:hn("delete"),clear:hn("clear"),forEach:Gs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Ks(r,!1,!1),n[r]=Ks(r,!0,!1),e[r]=Ks(r,!1,!0),o[r]=Ks(r,!0,!0)}),[t,n,e,o]}const[fg,pg,hg,vg]=dg();function Ki(t,e){const n=e?t?vg:hg:t?pg:fg;return(o,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?o:Reflect.get(Se(n,s)&&s in o?n:o,s,r)}const gg={get:Ki(!1,!1)},mg={get:Ki(!1,!0)},bg={get:Ki(!0,!1)},zd=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,yg=new WeakMap;function _g(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wg(t){return t.__v_skip||!Object.isExtensible(t)?0:_g(Uv(t))}function Dn(t){return jo(t)?t:Ji(t,!1,ag,gg,zd)}function Pg(t){return Ji(t,!1,ug,mg,Xd)}function qd(t){return Ji(t,!0,cg,bg,Yd)}function Ji(t,e,n,o,s){if(!He(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const l=wg(t);if(l===0)return t;const a=new Proxy(t,l===2?o:n);return s.set(t,a),a}function xo(t){return jo(t)?xo(t.__v_raw):!!(t&&t.__v_isReactive)}function jo(t){return!!(t&&t.__v_isReadonly)}function wr(t){return!!(t&&t.__v_isShallow)}function Gd(t){return xo(t)||jo(t)}function Te(t){const e=t&&t.__v_raw;return e?Te(e):t}function Kd(t){return yr(t,"__v_skip",!0),t}const ks=t=>He(t)?Dn(t):t,Zi=t=>He(t)?qd(t):t;function Jd(t){Tn&&Ut&&(t=Te(t),Hd(t.dep||(t.dep=Yi())))}function Zd(t,e){t=Te(t);const n=t.dep;n&&ni(n)}function be(t){return!!(t&&t.__v_isRef===!0)}function N(t){return Cg(t,!1)}function Cg(t,e){return be(t)?t:new xg(t,e)}class xg{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Te(e),this._value=n?e:ks(e)}get value(){return Jd(this),this._value}set value(e){const n=this.__v_isShallow||wr(e)||jo(e);e=n?e:Te(e),to(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:ks(e),Zd(this))}}function ne(t){return be(t)?t.value:t}const kg={get:(t,e,n)=>ne(Reflect.get(t,e,n)),set:(t,e,n,o)=>{const s=t[e];return be(s)&&!be(n)?(s.value=n,!0):Reflect.set(t,e,n,o)}};function Qd(t){return xo(t)?t:new Proxy(t,kg)}class Og{constructor(e,n,o,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new qi(e,()=>{this._dirty||(this._dirty=!0,Zd(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const e=Te(this);return Jd(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function $g(t,e,n=!1){let o,s;const r=_e(t);return r?(o=t,s=en):(o=t.get,s=t.set),new Og(o,s,r||!s,n)}function An(t,e,n,o){let s;try{s=o?t(...o):t()}catch(r){Ds(r,e,n)}return s}function Et(t,e,n,o){if(_e(t)){const r=An(t,e,n,o);return r&&Td(r)&&r.catch(l=>{Ds(l,e,n)}),r}const s=[];for(let r=0;r<t.length;r++)s.push(Et(t[r],e,n,o));return s}function Ds(t,e,n,o=!0){const s=e?e.vnode:null;if(e){let r=e.parent;const l=e.proxy,a=n;for(;r;){const c=r.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,l,a)===!1)return}r=r.parent}const i=e.appContext.config.errorHandler;if(i){An(i,null,10,[t,l,a]);return}}Sg(t,n,s,o)}function Sg(t,e,n,o=!0){console.error(t)}let Os=!1,oi=!1;const dt=[];let Jt=0;const ko=[];let ln=null,Yn=0;const ef=Promise.resolve();let Qi=null;function Qn(t){const e=Qi||ef;return t?e.then(this?t.bind(this):t):e}function Ig(t){let e=Jt+1,n=dt.length;for(;e<n;){const o=e+n>>>1,s=dt[o],r=$s(s);r<t||r===t&&s.pre?e=o+1:n=o}return e}function qr(t){(!dt.length||!dt.includes(t,Os&&t.allowRecurse?Jt+1:Jt))&&(t.id==null?dt.push(t):dt.splice(Ig(t.id),0,t),tf())}function tf(){!Os&&!oi&&(oi=!0,Qi=ef.then(of))}function jg(t){const e=dt.indexOf(t);e>Jt&&dt.splice(e,1)}function Tg(t){de(t)?ko.push(...t):(!ln||!ln.includes(t,t.allowRecurse?Yn+1:Yn))&&ko.push(t),tf()}function nc(t,e=Os?Jt+1:0){for(;e<dt.length;e++){const n=dt[e];n&&n.pre&&(dt.splice(e,1),e--,n())}}function nf(t){if(ko.length){const e=[...new Set(ko)];if(ko.length=0,ln){ln.push(...e);return}for(ln=e,ln.sort((n,o)=>$s(n)-$s(o)),Yn=0;Yn<ln.length;Yn++)ln[Yn]();ln=null,Yn=0}}const $s=t=>t.id==null?1/0:t.id,Ag=(t,e)=>{const n=$s(t)-$s(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function of(t){oi=!1,Os=!0,dt.sort(Ag);try{for(Jt=0;Jt<dt.length;Jt++){const e=dt[Jt];e&&e.active!==!1&&An(e,null,14)}}finally{Jt=0,dt.length=0,nf(),Os=!1,Qi=null,(dt.length||ko.length)&&of()}}function Eg(t,e,...n){if(t.isUnmounted)return;const o=t.vnode.props||We;let s=n;const r=e.startsWith("update:"),l=r&&e.slice(7);if(l&&l in o){const u=`${l==="modelValue"?"model":l}Modifiers`,{number:f,trim:p}=o[u]||We;p&&(s=n.map(g=>Je(g)?g.trim():g)),f&&(s=n.map(_r))}let a,i=o[a=xl(e)]||o[a=xl(Io(e))];!i&&r&&(i=o[a=xl(lo(e))]),i&&Et(i,t,6,s);const c=o[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Et(c,t,6,s)}}function sf(t,e,n=!1){const o=e.emitsCache,s=o.get(t);if(s!==void 0)return s;const r=t.emits;let l={},a=!1;if(!_e(t)){const i=c=>{const u=sf(c,e,!0);u&&(a=!0,nt(l,u))};!n&&e.mixins.length&&e.mixins.forEach(i),t.extends&&i(t.extends),t.mixins&&t.mixins.forEach(i)}return!r&&!a?(He(t)&&o.set(t,null),null):(de(r)?r.forEach(i=>l[i]=null):nt(l,r),He(t)&&o.set(t,l),l)}function Gr(t,e){return!t||!zr(e)?!1:(e=e.slice(2).replace(/Once$/,""),Se(t,e[0].toLowerCase()+e.slice(1))||Se(t,lo(e))||Se(t,e))}let ft=null,Kr=null;function Pr(t){const e=ft;return ft=t,Kr=t&&t.type.__scopeId||null,e}function _t(t){Kr=t}function wt(){Kr=null}function q(t,e=ft,n){if(!e||t._n)return t;const o=(...s)=>{o._d&&hc(-1);const r=Pr(e);let l;try{l=t(...s)}finally{Pr(r),o._d&&hc(1)}return l};return o._n=!0,o._c=!0,o._d=!0,o}function kl(t){const{type:e,vnode:n,proxy:o,withProxy:s,props:r,propsOptions:[l],slots:a,attrs:i,emit:c,render:u,renderCache:f,data:p,setupState:g,ctx:m,inheritAttrs:b}=t;let P,O;const h=Pr(t);try{if(n.shapeFlag&4){const _=s||o;P=Kt(u.call(_,_,f,r,g,p,m)),O=i}else{const _=e;P=Kt(_.length>1?_(r,{attrs:i,slots:a,emit:c}):_(r,null)),O=e.props?i:Rg(i)}}catch(_){_s.length=0,Ds(_,t,1),P=A(dn)}let v=P;if(O&&b!==!1){const _=Object.keys(O),{shapeFlag:j}=v;_.length&&j&7&&(l&&_.some(Vi)&&(O=Bg(O,l)),v=Ln(v,O))}return n.dirs&&(v=Ln(v),v.dirs=v.dirs?v.dirs.concat(n.dirs):n.dirs),n.transition&&(v.transition=n.transition),P=v,Pr(h),P}const Rg=t=>{let e;for(const n in t)(n==="class"||n==="style"||zr(n))&&((e||(e={}))[n]=t[n]);return e},Bg=(t,e)=>{const n={};for(const o in t)(!Vi(o)||!(o.slice(9)in e))&&(n[o]=t[o]);return n};function Mg(t,e,n){const{props:o,children:s,component:r}=t,{props:l,children:a,patchFlag:i}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&i>=0){if(i&1024)return!0;if(i&16)return o?oc(o,l,c):!!l;if(i&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const p=u[f];if(l[p]!==o[p]&&!Gr(c,p))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===l?!1:o?l?oc(o,l,c):!0:!!l;return!1}function oc(t,e,n){const o=Object.keys(e);if(o.length!==Object.keys(t).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(e[r]!==t[r]&&!Gr(n,r))return!0}return!1}function Dg({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const Lg=Symbol.for("v-ndc"),rf=t=>t.__isSuspense;function Ng(t,e){e&&e.pendingBranch?de(t)?e.effects.push(...t):e.effects.push(t):Tg(t)}const Js={};function Xe(t,e,n){return lf(t,e,n)}function lf(t,e,{immediate:n,deep:o,flush:s,onTrack:r,onTrigger:l}=We){var a;const i=tg()===((a=at)==null?void 0:a.scope)?at:null;let c,u=!1,f=!1;if(be(t)?(c=()=>t.value,u=wr(t)):xo(t)?(c=()=>t,o=!0):de(t)?(f=!0,u=t.some(_=>xo(_)||wr(_)),c=()=>t.map(_=>{if(be(_))return _.value;if(xo(_))return Kn(_);if(_e(_))return An(_,i,2)})):_e(t)?e?c=()=>An(t,i,2):c=()=>{if(!(i&&i.isUnmounted))return p&&p(),Et(t,i,3,[g])}:c=en,e&&o){const _=c;c=()=>Kn(_())}let p,g=_=>{p=h.onStop=()=>{An(_,i,4)}},m;if(Ao)if(g=en,e?n&&Et(e,i,3,[c(),f?[]:void 0,g]):c(),s==="sync"){const _=Rm();m=_.__watcherHandles||(_.__watcherHandles=[])}else return en;let b=f?new Array(t.length).fill(Js):Js;const P=()=>{if(h.active)if(e){const _=h.run();(o||u||(f?_.some((j,S)=>to(j,b[S])):to(_,b)))&&(p&&p(),Et(e,i,3,[_,b===Js?void 0:f&&b[0]===Js?[]:b,g]),b=_)}else h.run()};P.allowRecurse=!!e;let O;s==="sync"?O=P:s==="post"?O=()=>ct(P,i&&i.suspense):(P.pre=!0,i&&(P.id=i.uid),O=()=>qr(P));const h=new qi(c,O);e?n?P():b=h.run():s==="post"?ct(h.run.bind(h),i&&i.suspense):h.run();const v=()=>{h.stop(),i&&i.scope&&Wi(i.scope.effects,h)};return m&&m.push(v),v}function Fg(t,e,n){const o=this.proxy,s=Je(t)?t.includes(".")?af(o,t):()=>o[t]:t.bind(o,o);let r;_e(e)?r=e:(r=e.handler,n=e);const l=at;To(this);const a=lf(s,r.bind(o),n);return l?To(l):eo(),a}function af(t,e){const n=e.split(".");return()=>{let o=t;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}function Kn(t,e){if(!He(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),be(t))Kn(t.value,e);else if(de(t))for(let n=0;n<t.length;n++)Kn(t[n],e);else if(Xo(t)||Po(t))t.forEach(n=>{Kn(n,e)});else if(Ed(t))for(const n in t)Kn(t[n],e);return t}function Oe(t,e){const n=ft;if(n===null)return t;const o=el(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[l,a,i,c=We]=e[r];l&&(_e(l)&&(l={mounted:l,updated:l}),l.deep&&Kn(a),s.push({dir:l,instance:o,value:a,oldValue:void 0,arg:i,modifiers:c}))}return t}function Hn(t,e,n,o){const s=t.dirs,r=e&&e.dirs;for(let l=0;l<s.length;l++){const a=s[l];r&&(a.oldValue=r[l].value);let i=a.dir[o];i&&(qo(),Et(i,n,8,[t.el,a,t,e]),Go())}}const uo=Symbol("_leaveCb"),Zs=Symbol("_enterCb");function Hg(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mt(()=>{t.isMounted=!0}),na(()=>{t.isUnmounting=!0}),t}const It=[Function,Array],Ug={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:It,onEnter:It,onAfterEnter:It,onEnterCancelled:It,onBeforeLeave:It,onLeave:It,onAfterLeave:It,onLeaveCancelled:It,onBeforeAppear:It,onAppear:It,onAfterAppear:It,onAppearCancelled:It};function Vg(t,e){const{leavingVNodes:n}=t;let o=n.get(e.type);return o||(o=Object.create(null),n.set(e.type,o)),o}function si(t,e,n,o){const{appear:s,mode:r,persisted:l=!1,onBeforeEnter:a,onEnter:i,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:f,onLeave:p,onAfterLeave:g,onLeaveCancelled:m,onBeforeAppear:b,onAppear:P,onAfterAppear:O,onAppearCancelled:h}=e,v=String(t.key),_=Vg(n,t),j=(R,D)=>{R&&Et(R,o,9,D)},S=(R,D)=>{const F=D[1];j(R,D),de(R)?R.every(K=>K.length<=1)&&F():R.length<=1&&F()},T={mode:r,persisted:l,beforeEnter(R){let D=a;if(!n.isMounted)if(s)D=b||a;else return;R[uo]&&R[uo](!0);const F=_[v];F&&qn(t,F)&&F.el[uo]&&F.el[uo](),j(D,[R])},enter(R){let D=i,F=c,K=u;if(!n.isMounted)if(s)D=P||i,F=O||c,K=h||u;else return;let Q=!1;const fe=R[Zs]=we=>{Q||(Q=!0,we?j(K,[R]):j(F,[R]),T.delayedLeave&&T.delayedLeave(),R[Zs]=void 0)};D?S(D,[R,fe]):fe()},leave(R,D){const F=String(t.key);if(R[Zs]&&R[Zs](!0),n.isUnmounting)return D();j(f,[R]);let K=!1;const Q=R[uo]=fe=>{K||(K=!0,D(),fe?j(m,[R]):j(g,[R]),R[uo]=void 0,_[F]===t&&delete _[F])};_[F]=t,p?S(p,[R,Q]):Q()},clone(R){return si(R,e,n,o)}};return T}function Cr(t,e){t.shapeFlag&6&&t.component?Cr(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function cf(t,e=!1,n){let o=[],s=0;for(let r=0;r<t.length;r++){let l=t[r];const a=n==null?l.key:String(n)+String(l.key!=null?l.key:r);l.type===le?(l.patchFlag&128&&s++,o=o.concat(cf(l.children,e,a))):(e||l.type!==dn)&&o.push(a!=null?Ln(l,{key:a}):l)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}/*! #__NO_SIDE_EFFECTS__ */function Pe(t,e){return _e(t)?nt({name:t.name},e,{setup:t}):t}const Oo=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function sc(t){_e(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:o,delay:s=200,timeout:r,suspensible:l=!0,onError:a}=t;let i=null,c,u=0;const f=()=>(u++,i=null,p()),p=()=>{let g;return i||(g=i=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),a)return new Promise((b,P)=>{a(m,()=>b(f()),()=>P(m),u+1)});throw m}).then(m=>g!==i&&i?i:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return Pe({name:"AsyncComponentWrapper",__asyncLoader:p,get __asyncResolved(){return c},setup(){const g=at;if(c)return()=>Ol(c,g);const m=h=>{i=null,Ds(h,g,13,!o)};if(l&&g.suspense||Ao)return p().then(h=>()=>Ol(h,g)).catch(h=>(m(h),()=>o?A(o,{error:h}):null));const b=N(!1),P=N(),O=N(!!s);return s&&setTimeout(()=>{O.value=!1},s),r!=null&&setTimeout(()=>{if(!b.value&&!P.value){const h=new Error(`Async component timed out after ${r}ms.`);m(h),P.value=h}},r),p().then(()=>{b.value=!0,g.parent&&ea(g.parent.vnode)&&qr(g.parent.update)}).catch(h=>{m(h),P.value=h}),()=>{if(b.value&&c)return Ol(c,g);if(P.value&&o)return A(o,{error:P.value});if(n&&!O.value)return A(n)}}})}function Ol(t,e){const{ref:n,props:o,children:s,ce:r}=e.vnode,l=A(t,o,s);return l.ref=n,l.ce=r,delete e.vnode.ce,l}const ea=t=>t.type.__isKeepAlive,Wg={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=kf(),o=n.ctx;if(!o.renderer)return()=>{const h=e.default&&e.default();return h&&h.length===1?h[0]:h};const s=new Map,r=new Set;let l=null;const a=n.suspense,{renderer:{p:i,m:c,um:u,o:{createElement:f}}}=o,p=f("div");o.activate=(h,v,_,j,S)=>{const T=h.component;c(h,v,_,0,a),i(T.vnode,h,v,_,T,a,j,h.slotScopeIds,S),ct(()=>{T.isDeactivated=!1,T.a&&Co(T.a);const R=h.props&&h.props.onVnodeMounted;R&&jt(R,T.parent,h)},a)},o.deactivate=h=>{const v=h.component;c(h,p,null,1,a),ct(()=>{v.da&&Co(v.da);const _=h.props&&h.props.onVnodeUnmounted;_&&jt(_,v.parent,h),v.isDeactivated=!0},a)};function g(h){$l(h),u(h,n,a,!0)}function m(h){s.forEach((v,_)=>{const j=bc(v.type);j&&(!h||!h(j))&&b(_)})}function b(h){const v=s.get(h);!l||!qn(v,l)?g(v):l&&$l(l),s.delete(h),r.delete(h)}Xe(()=>[t.include,t.exclude],([h,v])=>{h&&m(_=>hs(h,_)),v&&m(_=>!hs(v,_))},{flush:"post",deep:!0});let P=null;const O=()=>{P!=null&&s.set(P,Sl(n.subTree))};return mt(O),ta(O),na(()=>{s.forEach(h=>{const{subTree:v,suspense:_}=n,j=Sl(v);if(h.type===j.type&&h.key===j.key){$l(j);const S=j.component.da;S&&ct(S,_);return}g(h)})}),()=>{if(P=null,!e.default)return null;const h=e.default(),v=h[0];if(h.length>1)return l=null,h;if(!Is(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return l=null,v;let _=Sl(v);const j=_.type,S=bc(Oo(_)?_.type.__asyncResolved||{}:j),{include:T,exclude:R,max:D}=t;if(T&&(!S||!hs(T,S))||R&&S&&hs(R,S))return l=_,v;const F=_.key==null?j:_.key,K=s.get(F);return _.el&&(_=Ln(_),v.shapeFlag&128&&(v.ssContent=_)),P=F,K?(_.el=K.el,_.component=K.component,_.transition&&Cr(_,_.transition),_.shapeFlag|=512,r.delete(F),r.add(F)):(r.add(F),D&&r.size>parseInt(D,10)&&b(r.values().next().value)),_.shapeFlag|=256,l=_,rf(v.type)?v:_}}},zg=Wg;function hs(t,e){return de(t)?t.some(n=>hs(n,e)):Je(t)?t.split(",").includes(e):Hv(t)?t.test(e):!1}function uf(t,e){ff(t,"a",e)}function df(t,e){ff(t,"da",e)}function ff(t,e,n=at){const o=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Jr(e,o,n),n){let s=n.parent;for(;s&&s.parent;)ea(s.parent.vnode)&&Xg(o,e,n,s),s=s.parent}}function Xg(t,e,n,o){const s=Jr(e,t,o,!0);Vt(()=>{Wi(o[e],s)},n)}function $l(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Sl(t){return t.shapeFlag&128?t.ssContent:t}function Jr(t,e,n=at,o=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...l)=>{if(n.isUnmounted)return;qo(),To(n);const a=Et(e,n,t,l);return eo(),Go(),a});return o?s.unshift(r):s.push(r),r}}const fn=t=>(e,n=at)=>(!Ao||t==="sp")&&Jr(t,(...o)=>e(...o),n),Yg=fn("bm"),mt=fn("m"),qg=fn("bu"),ta=fn("u"),na=fn("bum"),Vt=fn("um"),Gg=fn("sp"),Kg=fn("rtg"),Jg=fn("rtc");function Zg(t,e=at){Jr("ec",t,e)}function Ve(t,e,n,o){let s;const r=n&&n[o];if(de(t)||Je(t)){s=new Array(t.length);for(let l=0,a=t.length;l<a;l++)s[l]=e(t[l],l,void 0,r&&r[l])}else if(typeof t=="number"){s=new Array(t);for(let l=0;l<t;l++)s[l]=e(l+1,l,void 0,r&&r[l])}else if(He(t))if(t[Symbol.iterator])s=Array.from(t,(l,a)=>e(l,a,void 0,r&&r[a]));else{const l=Object.keys(t);s=new Array(l.length);for(let a=0,i=l.length;a<i;a++){const c=l[a];s[a]=e(t[c],c,a,r&&r[a])}}else s=[];return n&&(n[o]=s),s}function Zt(t,e,n={},o,s){if(ft.isCE||ft.parent&&Oo(ft.parent)&&ft.parent.isCE)return e!=="default"&&(n.name=e),A("slot",n,o&&o());let r=t[e];r&&r._c&&(r._d=!1),x();const l=r&&pf(r(n)),a=ce(le,{key:n.key||l&&l.key||`_${e}`},l||(o?o():[]),l&&t._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function pf(t){return t.some(e=>Is(e)?!(e.type===dn||e.type===le&&!pf(e.children)):!0)?t:null}const ri=t=>t?Of(t)?el(t)||t.proxy:ri(t.parent):null,ms=nt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ri(t.parent),$root:t=>ri(t.root),$emit:t=>t.emit,$options:t=>oa(t),$forceUpdate:t=>t.f||(t.f=()=>qr(t.update)),$nextTick:t=>t.n||(t.n=Qn.bind(t.proxy)),$watch:t=>Fg.bind(t)}),Il=(t,e)=>t!==We&&!t.__isScriptSetup&&Se(t,e),Qg={get({_:t},e){const{ctx:n,setupState:o,data:s,props:r,accessCache:l,type:a,appContext:i}=t;let c;if(e[0]!=="$"){const g=l[e];if(g!==void 0)switch(g){case 1:return o[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(Il(o,e))return l[e]=1,o[e];if(s!==We&&Se(s,e))return l[e]=2,s[e];if((c=t.propsOptions[0])&&Se(c,e))return l[e]=3,r[e];if(n!==We&&Se(n,e))return l[e]=4,n[e];li&&(l[e]=0)}}const u=ms[e];let f,p;if(u)return e==="$attrs"&&yt(t,"get",e),u(t);if((f=a.__cssModules)&&(f=f[e]))return f;if(n!==We&&Se(n,e))return l[e]=4,n[e];if(p=i.config.globalProperties,Se(p,e))return p[e]},set({_:t},e,n){const{data:o,setupState:s,ctx:r}=t;return Il(s,e)?(s[e]=n,!0):o!==We&&Se(o,e)?(o[e]=n,!0):Se(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:o,appContext:s,propsOptions:r}},l){let a;return!!n[l]||t!==We&&Se(t,l)||Il(e,l)||(a=r[0])&&Se(a,l)||Se(o,l)||Se(ms,l)||Se(s.config.globalProperties,l)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Se(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function rc(t){return de(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let li=!0;function em(t){const e=oa(t),n=t.proxy,o=t.ctx;li=!1,e.beforeCreate&&lc(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:l,watch:a,provide:i,inject:c,created:u,beforeMount:f,mounted:p,beforeUpdate:g,updated:m,activated:b,deactivated:P,beforeDestroy:O,beforeUnmount:h,destroyed:v,unmounted:_,render:j,renderTracked:S,renderTriggered:T,errorCaptured:R,serverPrefetch:D,expose:F,inheritAttrs:K,components:Q,directives:fe,filters:we}=e;if(c&&tm(c,o,null),l)for(const B in l){const k=l[B];_e(k)&&(o[B]=k.bind(n))}if(s){const B=s.call(n,n);He(B)&&(t.data=Dn(B))}if(li=!0,r)for(const B in r){const k=r[B],w=_e(k)?k.bind(n,n):_e(k.get)?k.get.bind(n,n):en,L=!_e(k)&&_e(k.set)?k.set.bind(n):en,oe=$({get:w,set:L});Object.defineProperty(o,B,{enumerable:!0,configurable:!0,get:()=>oe.value,set:Ce=>oe.value=Ce})}if(a)for(const B in a)hf(a[B],o,n,B);if(i){const B=_e(i)?i.call(n):i;Reflect.ownKeys(B).forEach(k=>{im(k,B[k])})}u&&lc(u,t,"c");function U(B,k){de(k)?k.forEach(w=>B(w.bind(n))):k&&B(k.bind(n))}if(U(Yg,f),U(mt,p),U(qg,g),U(ta,m),U(uf,b),U(df,P),U(Zg,R),U(Jg,S),U(Kg,T),U(na,h),U(Vt,_),U(Gg,D),de(F))if(F.length){const B=t.exposed||(t.exposed={});F.forEach(k=>{Object.defineProperty(B,k,{get:()=>n[k],set:w=>n[k]=w})})}else t.exposed||(t.exposed={});j&&t.render===en&&(t.render=j),K!=null&&(t.inheritAttrs=K),Q&&(t.components=Q),fe&&(t.directives=fe)}function tm(t,e,n=en){de(t)&&(t=ii(t));for(const o in t){const s=t[o];let r;He(s)?"default"in s?r=bs(s.from||o,s.default,!0):r=bs(s.from||o):r=bs(s),be(r)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:l=>r.value=l}):e[o]=r}}function lc(t,e,n){Et(de(t)?t.map(o=>o.bind(e.proxy)):t.bind(e.proxy),e,n)}function hf(t,e,n,o){const s=o.includes(".")?af(n,o):()=>n[o];if(Je(t)){const r=e[t];_e(r)&&Xe(s,r)}else if(_e(t))Xe(s,t.bind(n));else if(He(t))if(de(t))t.forEach(r=>hf(r,e,n,o));else{const r=_e(t.handler)?t.handler.bind(n):e[t.handler];_e(r)&&Xe(s,r,t)}}function oa(t){const e=t.type,{mixins:n,extends:o}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:l}}=t.appContext,a=r.get(e);let i;return a?i=a:!s.length&&!n&&!o?i=e:(i={},s.length&&s.forEach(c=>xr(i,c,l,!0)),xr(i,e,l)),He(e)&&r.set(e,i),i}function xr(t,e,n,o=!1){const{mixins:s,extends:r}=e;r&&xr(t,r,n,!0),s&&s.forEach(l=>xr(t,l,n,!0));for(const l in e)if(!(o&&l==="expose")){const a=nm[l]||n&&n[l];t[l]=a?a(t[l],e[l]):e[l]}return t}const nm={data:ic,props:ac,emits:ac,methods:vs,computed:vs,beforeCreate:ht,created:ht,beforeMount:ht,mounted:ht,beforeUpdate:ht,updated:ht,beforeDestroy:ht,beforeUnmount:ht,destroyed:ht,unmounted:ht,activated:ht,deactivated:ht,errorCaptured:ht,serverPrefetch:ht,components:vs,directives:vs,watch:sm,provide:ic,inject:om};function ic(t,e){return e?t?function(){return nt(_e(t)?t.call(this,this):t,_e(e)?e.call(this,this):e)}:e:t}function om(t,e){return vs(ii(t),ii(e))}function ii(t){if(de(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ht(t,e){return t?[...new Set([].concat(t,e))]:e}function vs(t,e){return t?nt(Object.create(null),t,e):e}function ac(t,e){return t?de(t)&&de(e)?[...new Set([...t,...e])]:nt(Object.create(null),rc(t),rc(e!=null?e:{})):e}function sm(t,e){if(!t)return e;if(!e)return t;const n=nt(Object.create(null),t);for(const o in e)n[o]=ht(t[o],e[o]);return n}function vf(){return{app:null,config:{isNativeTag:Lv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let rm=0;function lm(t,e){return function(o,s=null){_e(o)||(o=nt({},o)),s!=null&&!He(s)&&(s=null);const r=vf(),l=new WeakSet;let a=!1;const i=r.app={_uid:rm++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:Bm,get config(){return r.config},set config(c){},use(c,...u){return l.has(c)||(c&&_e(c.install)?(l.add(c),c.install(i,...u)):_e(c)&&(l.add(c),c(i,...u))),i},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),i},component(c,u){return u?(r.components[c]=u,i):r.components[c]},directive(c,u){return u?(r.directives[c]=u,i):r.directives[c]},mount(c,u,f){if(!a){const p=A(o,s);return p.appContext=r,u&&e?e(p,c):t(p,c,f),a=!0,i._container=c,c.__vue_app__=i,el(p.component)||p.component.proxy}},unmount(){a&&(t(null,i._container),delete i._container.__vue_app__)},provide(c,u){return r.provides[c]=u,i},runWithContext(c){kr=i;try{return c()}finally{kr=null}}};return i}}let kr=null;function im(t,e){if(at){let n=at.provides;const o=at.parent&&at.parent.provides;o===n&&(n=at.provides=Object.create(o)),n[t]=e}}function bs(t,e,n=!1){const o=at||ft;if(o||kr){const s=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:kr._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&_e(e)?e.call(o&&o.proxy):e}}function am(t,e,n,o=!1){const s={},r={};yr(r,Qr,1),t.propsDefaults=Object.create(null),gf(t,e,s,r);for(const l in t.propsOptions[0])l in s||(s[l]=void 0);n?t.props=o?s:Pg(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function cm(t,e,n,o){const{props:s,attrs:r,vnode:{patchFlag:l}}=t,a=Te(s),[i]=t.propsOptions;let c=!1;if((o||l>0)&&!(l&16)){if(l&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let p=u[f];if(Gr(t.emitsOptions,p))continue;const g=e[p];if(i)if(Se(r,p))g!==r[p]&&(r[p]=g,c=!0);else{const m=Io(p);s[m]=ai(i,a,m,g,t,!1)}else g!==r[p]&&(r[p]=g,c=!0)}}}else{gf(t,e,s,r)&&(c=!0);let u;for(const f in a)(!e||!Se(e,f)&&((u=lo(f))===f||!Se(e,u)))&&(i?n&&(n[f]!==void 0||n[u]!==void 0)&&(s[f]=ai(i,a,f,void 0,t,!0)):delete s[f]);if(r!==a)for(const f in r)(!e||!Se(e,f))&&(delete r[f],c=!0)}c&&cn(t,"set","$attrs")}function gf(t,e,n,o){const[s,r]=t.propsOptions;let l=!1,a;if(e)for(let i in e){if(fr(i))continue;const c=e[i];let u;s&&Se(s,u=Io(i))?!r||!r.includes(u)?n[u]=c:(a||(a={}))[u]=c:Gr(t.emitsOptions,i)||(!(i in o)||c!==o[i])&&(o[i]=c,l=!0)}if(r){const i=Te(n),c=a||We;for(let u=0;u<r.length;u++){const f=r[u];n[f]=ai(s,i,f,c[f],t,!Se(c,f))}}return l}function ai(t,e,n,o,s,r){const l=t[n];if(l!=null){const a=Se(l,"default");if(a&&o===void 0){const i=l.default;if(l.type!==Function&&!l.skipFactory&&_e(i)){const{propsDefaults:c}=s;n in c?o=c[n]:(To(s),o=c[n]=i.call(null,e),eo())}else o=i}l[0]&&(r&&!a?o=!1:l[1]&&(o===""||o===lo(n))&&(o=!0))}return o}function mf(t,e,n=!1){const o=e.propsCache,s=o.get(t);if(s)return s;const r=t.props,l={},a=[];let i=!1;if(!_e(t)){const u=f=>{i=!0;const[p,g]=mf(f,e,!0);nt(l,p),g&&a.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!r&&!i)return He(t)&&o.set(t,wo),wo;if(de(r))for(let u=0;u<r.length;u++){const f=Io(r[u]);cc(f)&&(l[f]=We)}else if(r)for(const u in r){const f=Io(u);if(cc(f)){const p=r[u],g=l[f]=de(p)||_e(p)?{type:p}:nt({},p);if(g){const m=fc(Boolean,g.type),b=fc(String,g.type);g[0]=m>-1,g[1]=b<0||m<b,(m>-1||Se(g,"default"))&&a.push(f)}}}const c=[l,a];return He(t)&&o.set(t,c),c}function cc(t){return t[0]!=="$"}function uc(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function dc(t,e){return uc(t)===uc(e)}function fc(t,e){return de(e)?e.findIndex(n=>dc(n,t)):_e(e)&&dc(e,t)?0:-1}const bf=t=>t[0]==="_"||t==="$stable",sa=t=>de(t)?t.map(Kt):[Kt(t)],um=(t,e,n)=>{if(e._n)return e;const o=q((...s)=>sa(e(...s)),n);return o._c=!1,o},yf=(t,e,n)=>{const o=t._ctx;for(const s in t){if(bf(s))continue;const r=t[s];if(_e(r))e[s]=um(s,r,o);else if(r!=null){const l=sa(r);e[s]=()=>l}}},_f=(t,e)=>{const n=sa(e);t.slots.default=()=>n},dm=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Te(e),yr(e,"_",n)):yf(e,t.slots={})}else t.slots={},e&&_f(t,e);yr(t.slots,Qr,1)},fm=(t,e,n)=>{const{vnode:o,slots:s}=t;let r=!0,l=We;if(o.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(nt(s,e),!n&&a===1&&delete s._):(r=!e.$stable,yf(e,s)),l=e}else e&&(_f(t,e),l={default:1});if(r)for(const a in s)!bf(a)&&l[a]==null&&delete s[a]};function ci(t,e,n,o,s=!1){if(de(t)){t.forEach((p,g)=>ci(p,e&&(de(e)?e[g]:e),n,o,s));return}if(Oo(o)&&!s)return;const r=o.shapeFlag&4?el(o.component)||o.component.proxy:o.el,l=s?null:r,{i:a,r:i}=t,c=e&&e.r,u=a.refs===We?a.refs={}:a.refs,f=a.setupState;if(c!=null&&c!==i&&(Je(c)?(u[c]=null,Se(f,c)&&(f[c]=null)):be(c)&&(c.value=null)),_e(i))An(i,a,12,[l,u]);else{const p=Je(i),g=be(i);if(p||g){const m=()=>{if(t.f){const b=p?Se(f,i)?f[i]:u[i]:i.value;s?de(b)&&Wi(b,r):de(b)?b.includes(r)||b.push(r):p?(u[i]=[r],Se(f,i)&&(f[i]=u[i])):(i.value=[r],t.k&&(u[t.k]=i.value))}else p?(u[i]=l,Se(f,i)&&(f[i]=l)):g&&(i.value=l,t.k&&(u[t.k]=l))};l?(m.id=-1,ct(m,n)):m()}}}const ct=Ng;function pm(t){return hm(t)}function hm(t,e){const n=Zl();n.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:l,createText:a,createComment:i,setText:c,setElementText:u,parentNode:f,nextSibling:p,setScopeId:g=en,insertStaticContent:m}=t,b=(y,C,I,M=null,H=null,Y=null,te=!1,G=null,ee=!!C.dynamicChildren)=>{if(y===C)return;y&&!qn(y,C)&&(M=xe(y),Ce(y,H,Y,!0),y=null),C.patchFlag===-2&&(ee=!1,C.dynamicChildren=null);const{type:V,ref:pe,shapeFlag:re}=C;switch(V){case Zr:P(y,C,I,M);break;case dn:O(y,C,I,M);break;case pr:y==null&&h(C,I,M,te);break;case le:Q(y,C,I,M,H,Y,te,G,ee);break;default:re&1?j(y,C,I,M,H,Y,te,G,ee):re&6?fe(y,C,I,M,H,Y,te,G,ee):(re&64||re&128)&&V.process(y,C,I,M,H,Y,te,G,ee,X)}pe!=null&&H&&ci(pe,y&&y.ref,Y,C||y,!C)},P=(y,C,I,M)=>{if(y==null)o(C.el=a(C.children),I,M);else{const H=C.el=y.el;C.children!==y.children&&c(H,C.children)}},O=(y,C,I,M)=>{y==null?o(C.el=i(C.children||""),I,M):C.el=y.el},h=(y,C,I,M)=>{[y.el,y.anchor]=m(y.children,C,I,M,y.el,y.anchor)},v=({el:y,anchor:C},I,M)=>{let H;for(;y&&y!==C;)H=p(y),o(y,I,M),y=H;o(C,I,M)},_=({el:y,anchor:C})=>{let I;for(;y&&y!==C;)I=p(y),s(y),y=I;s(C)},j=(y,C,I,M,H,Y,te,G,ee)=>{te=te||C.type==="svg",y==null?S(C,I,M,H,Y,te,G,ee):D(y,C,H,Y,te,G,ee)},S=(y,C,I,M,H,Y,te,G)=>{let ee,V;const{type:pe,props:re,shapeFlag:he,transition:ye,dirs:ke}=y;if(ee=y.el=l(y.type,Y,re&&re.is,re),he&8?u(ee,y.children):he&16&&R(y.children,ee,null,M,H,Y&&pe!=="foreignObject",te,G),ke&&Hn(y,null,M,"created"),T(ee,y,y.scopeId,te,M),re){for(const Le in re)Le!=="value"&&!fr(Le)&&r(ee,Le,null,re[Le],Y,y.children,M,H,me);"value"in re&&r(ee,"value",null,re.value),(V=re.onVnodeBeforeMount)&&jt(V,M,y)}ke&&Hn(y,null,M,"beforeMount");const Ue=vm(H,ye);Ue&&ye.beforeEnter(ee),o(ee,C,I),((V=re&&re.onVnodeMounted)||Ue||ke)&&ct(()=>{V&&jt(V,M,y),Ue&&ye.enter(ee),ke&&Hn(y,null,M,"mounted")},H)},T=(y,C,I,M,H)=>{if(I&&g(y,I),M)for(let Y=0;Y<M.length;Y++)g(y,M[Y]);if(H){let Y=H.subTree;if(C===Y){const te=H.vnode;T(y,te,te.scopeId,te.slotScopeIds,H.parent)}}},R=(y,C,I,M,H,Y,te,G,ee=0)=>{for(let V=ee;V<y.length;V++){const pe=y[V]=G?xn(y[V]):Kt(y[V]);b(null,pe,C,I,M,H,Y,te,G)}},D=(y,C,I,M,H,Y,te)=>{const G=C.el=y.el;let{patchFlag:ee,dynamicChildren:V,dirs:pe}=C;ee|=y.patchFlag&16;const re=y.props||We,he=C.props||We;let ye;I&&Un(I,!1),(ye=he.onVnodeBeforeUpdate)&&jt(ye,I,C,y),pe&&Hn(C,y,I,"beforeUpdate"),I&&Un(I,!0);const ke=H&&C.type!=="foreignObject";if(V?F(y.dynamicChildren,V,G,I,M,ke,Y):te||k(y,C,G,null,I,M,ke,Y,!1),ee>0){if(ee&16)K(G,C,re,he,I,M,H);else if(ee&2&&re.class!==he.class&&r(G,"class",null,he.class,H),ee&4&&r(G,"style",re.style,he.style,H),ee&8){const Ue=C.dynamicProps;for(let Le=0;Le<Ue.length;Le++){const et=Ue[Le],Lt=re[et],co=he[et];(co!==Lt||et==="value")&&r(G,et,Lt,co,H,y.children,I,M,me)}}ee&1&&y.children!==C.children&&u(G,C.children)}else!te&&V==null&&K(G,C,re,he,I,M,H);((ye=he.onVnodeUpdated)||pe)&&ct(()=>{ye&&jt(ye,I,C,y),pe&&Hn(C,y,I,"updated")},M)},F=(y,C,I,M,H,Y,te)=>{for(let G=0;G<C.length;G++){const ee=y[G],V=C[G],pe=ee.el&&(ee.type===le||!qn(ee,V)||ee.shapeFlag&70)?f(ee.el):I;b(ee,V,pe,null,M,H,Y,te,!0)}},K=(y,C,I,M,H,Y,te)=>{if(I!==M){if(I!==We)for(const G in I)!fr(G)&&!(G in M)&&r(y,G,I[G],null,te,C.children,H,Y,me);for(const G in M){if(fr(G))continue;const ee=M[G],V=I[G];ee!==V&&G!=="value"&&r(y,G,V,ee,te,C.children,H,Y,me)}"value"in M&&r(y,"value",I.value,M.value)}},Q=(y,C,I,M,H,Y,te,G,ee)=>{const V=C.el=y?y.el:a(""),pe=C.anchor=y?y.anchor:a("");let{patchFlag:re,dynamicChildren:he,slotScopeIds:ye}=C;ye&&(G=G?G.concat(ye):ye),y==null?(o(V,I,M),o(pe,I,M),R(C.children,I,pe,H,Y,te,G,ee)):re>0&&re&64&&he&&y.dynamicChildren?(F(y.dynamicChildren,he,I,H,Y,te,G),(C.key!=null||H&&C===H.subTree)&&ra(y,C,!0)):k(y,C,I,pe,H,Y,te,G,ee)},fe=(y,C,I,M,H,Y,te,G,ee)=>{C.slotScopeIds=G,y==null?C.shapeFlag&512?H.ctx.activate(C,I,M,te,ee):we(C,I,M,H,Y,te,ee):Be(y,C,ee)},we=(y,C,I,M,H,Y,te)=>{const G=y.component=$m(y,M,H);if(ea(y)&&(G.ctx.renderer=X),Sm(G),G.asyncDep){if(H&&H.registerDep(G,U),!y.el){const ee=G.subTree=A(dn);O(null,ee,C,I)}return}U(G,y,C,I,H,Y,te)},Be=(y,C,I)=>{const M=C.component=y.component;if(Mg(y,C,I))if(M.asyncDep&&!M.asyncResolved){B(M,C,I);return}else M.next=C,jg(M.update),M.update();else C.el=y.el,M.vnode=C},U=(y,C,I,M,H,Y,te)=>{const G=()=>{if(y.isMounted){let{next:pe,bu:re,u:he,parent:ye,vnode:ke}=y,Ue=pe,Le;Un(y,!1),pe?(pe.el=ke.el,B(y,pe,te)):pe=ke,re&&Co(re),(Le=pe.props&&pe.props.onVnodeBeforeUpdate)&&jt(Le,ye,pe,ke),Un(y,!0);const et=kl(y),Lt=y.subTree;y.subTree=et,b(Lt,et,f(Lt.el),xe(Lt),y,H,Y),pe.el=et.el,Ue===null&&Dg(y,et.el),he&&ct(he,H),(Le=pe.props&&pe.props.onVnodeUpdated)&&ct(()=>jt(Le,ye,pe,ke),H)}else{let pe;const{el:re,props:he}=C,{bm:ye,m:ke,parent:Ue}=y,Le=Oo(C);if(Un(y,!1),ye&&Co(ye),!Le&&(pe=he&&he.onVnodeBeforeMount)&&jt(pe,Ue,C),Un(y,!0),re&&ge){const et=()=>{y.subTree=kl(y),ge(re,y.subTree,y,H,null)};Le?C.type.__asyncLoader().then(()=>!y.isUnmounted&&et()):et()}else{const et=y.subTree=kl(y);b(null,et,I,M,y,H,Y),C.el=et.el}if(ke&&ct(ke,H),!Le&&(pe=he&&he.onVnodeMounted)){const et=C;ct(()=>jt(pe,Ue,et),H)}(C.shapeFlag&256||Ue&&Oo(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&y.a&&ct(y.a,H),y.isMounted=!0,C=I=M=null}},ee=y.effect=new qi(G,()=>qr(V),y.scope),V=y.update=()=>ee.run();V.id=y.uid,Un(y,!0),V()},B=(y,C,I)=>{C.component=y;const M=y.vnode.props;y.vnode=C,y.next=null,cm(y,C.props,M,I),fm(y,C.children,I),qo(),nc(),Go()},k=(y,C,I,M,H,Y,te,G,ee=!1)=>{const V=y&&y.children,pe=y?y.shapeFlag:0,re=C.children,{patchFlag:he,shapeFlag:ye}=C;if(he>0){if(he&128){L(V,re,I,M,H,Y,te,G,ee);return}else if(he&256){w(V,re,I,M,H,Y,te,G,ee);return}}ye&8?(pe&16&&me(V,H,Y),re!==V&&u(I,re)):pe&16?ye&16?L(V,re,I,M,H,Y,te,G,ee):me(V,H,Y,!0):(pe&8&&u(I,""),ye&16&&R(re,I,M,H,Y,te,G,ee))},w=(y,C,I,M,H,Y,te,G,ee)=>{y=y||wo,C=C||wo;const V=y.length,pe=C.length,re=Math.min(V,pe);let he;for(he=0;he<re;he++){const ye=C[he]=ee?xn(C[he]):Kt(C[he]);b(y[he],ye,I,null,H,Y,te,G,ee)}V>pe?me(y,H,Y,!0,!1,re):R(C,I,M,H,Y,te,G,ee,re)},L=(y,C,I,M,H,Y,te,G,ee)=>{let V=0;const pe=C.length;let re=y.length-1,he=pe-1;for(;V<=re&&V<=he;){const ye=y[V],ke=C[V]=ee?xn(C[V]):Kt(C[V]);if(qn(ye,ke))b(ye,ke,I,null,H,Y,te,G,ee);else break;V++}for(;V<=re&&V<=he;){const ye=y[re],ke=C[he]=ee?xn(C[he]):Kt(C[he]);if(qn(ye,ke))b(ye,ke,I,null,H,Y,te,G,ee);else break;re--,he--}if(V>re){if(V<=he){const ye=he+1,ke=ye<pe?C[ye].el:M;for(;V<=he;)b(null,C[V]=ee?xn(C[V]):Kt(C[V]),I,ke,H,Y,te,G,ee),V++}}else if(V>he)for(;V<=re;)Ce(y[V],H,Y,!0),V++;else{const ye=V,ke=V,Ue=new Map;for(V=ke;V<=he;V++){const Ct=C[V]=ee?xn(C[V]):Kt(C[V]);Ct.key!=null&&Ue.set(Ct.key,V)}let Le,et=0;const Lt=he-ke+1;let co=!1,Va=0;const ss=new Array(Lt);for(V=0;V<Lt;V++)ss[V]=0;for(V=ye;V<=re;V++){const Ct=y[V];if(et>=Lt){Ce(Ct,H,Y,!0);continue}let Yt;if(Ct.key!=null)Yt=Ue.get(Ct.key);else for(Le=ke;Le<=he;Le++)if(ss[Le-ke]===0&&qn(Ct,C[Le])){Yt=Le;break}Yt===void 0?Ce(Ct,H,Y,!0):(ss[Yt-ke]=V+1,Yt>=Va?Va=Yt:co=!0,b(Ct,C[Yt],I,null,H,Y,te,G,ee),et++)}const Wa=co?gm(ss):wo;for(Le=Wa.length-1,V=Lt-1;V>=0;V--){const Ct=ke+V,Yt=C[Ct],za=Ct+1<pe?C[Ct+1].el:M;ss[V]===0?b(null,Yt,I,za,H,Y,te,G,ee):co&&(Le<0||V!==Wa[Le]?oe(Yt,I,za,2):Le--)}}},oe=(y,C,I,M,H=null)=>{const{el:Y,type:te,transition:G,children:ee,shapeFlag:V}=y;if(V&6){oe(y.component.subTree,C,I,M);return}if(V&128){y.suspense.move(C,I,M);return}if(V&64){te.move(y,C,I,X);return}if(te===le){o(Y,C,I);for(let re=0;re<ee.length;re++)oe(ee[re],C,I,M);o(y.anchor,C,I);return}if(te===pr){v(y,C,I);return}if(M!==2&&V&1&&G)if(M===0)G.beforeEnter(Y),o(Y,C,I),ct(()=>G.enter(Y),H);else{const{leave:re,delayLeave:he,afterLeave:ye}=G,ke=()=>o(Y,C,I),Ue=()=>{re(Y,()=>{ke(),ye&&ye()})};he?he(Y,ke,Ue):Ue()}else o(Y,C,I)},Ce=(y,C,I,M=!1,H=!1)=>{const{type:Y,props:te,ref:G,children:ee,dynamicChildren:V,shapeFlag:pe,patchFlag:re,dirs:he}=y;if(G!=null&&ci(G,null,I,y,!0),pe&256){C.ctx.deactivate(y);return}const ye=pe&1&&he,ke=!Oo(y);let Ue;if(ke&&(Ue=te&&te.onVnodeBeforeUnmount)&&jt(Ue,C,y),pe&6)J(y.component,I,M);else{if(pe&128){y.suspense.unmount(I,M);return}ye&&Hn(y,null,C,"beforeUnmount"),pe&64?y.type.remove(y,C,I,H,X,M):V&&(Y!==le||re>0&&re&64)?me(V,C,I,!1,!0):(Y===le&&re&384||!H&&pe&16)&&me(ee,C,I),M&&Ee(y)}(ke&&(Ue=te&&te.onVnodeUnmounted)||ye)&&ct(()=>{Ue&&jt(Ue,C,y),ye&&Hn(y,null,C,"unmounted")},I)},Ee=y=>{const{type:C,el:I,anchor:M,transition:H}=y;if(C===le){it(I,M);return}if(C===pr){_(y);return}const Y=()=>{s(I),H&&!H.persisted&&H.afterLeave&&H.afterLeave()};if(y.shapeFlag&1&&H&&!H.persisted){const{leave:te,delayLeave:G}=H,ee=()=>te(I,Y);G?G(y.el,Y,ee):ee()}else Y()},it=(y,C)=>{let I;for(;y!==C;)I=p(y),s(y),y=I;s(C)},J=(y,C,I)=>{const{bum:M,scope:H,update:Y,subTree:te,um:G}=y;M&&Co(M),H.stop(),Y&&(Y.active=!1,Ce(te,y,C,I)),G&&ct(G,C),ct(()=>{y.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},me=(y,C,I,M=!1,H=!1,Y=0)=>{for(let te=Y;te<y.length;te++)Ce(y[te],C,I,M,H)},xe=y=>y.shapeFlag&6?xe(y.component.subTree):y.shapeFlag&128?y.suspense.next():p(y.anchor||y.el),z=(y,C,I)=>{y==null?C._vnode&&Ce(C._vnode,null,null,!0):b(C._vnode||null,y,C,null,null,null,I),nc(),nf(),C._vnode=y},X={p:b,um:Ce,m:oe,r:Ee,mt:we,mc:R,pc:k,pbc:F,n:xe,o:t};let se,ge;return e&&([se,ge]=e(X)),{render:z,hydrate:se,createApp:lm(z,se)}}function Un({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function vm(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ra(t,e,n=!1){const o=t.children,s=e.children;if(de(o)&&de(s))for(let r=0;r<o.length;r++){const l=o[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=xn(s[r]),a.el=l.el),n||ra(l,a)),a.type===Zr&&(a.el=l.el)}}function gm(t){const e=t.slice(),n=[0];let o,s,r,l,a;const i=t.length;for(o=0;o<i;o++){const c=t[o];if(c!==0){if(s=n[n.length-1],t[s]<c){e[o]=s,n.push(o);continue}for(r=0,l=n.length-1;r<l;)a=r+l>>1,t[n[a]]<c?r=a+1:l=a;c<t[n[r]]&&(r>0&&(e[o]=n[r-1]),n[r]=o)}}for(r=n.length,l=n[r-1];r-- >0;)n[r]=l,l=e[l];return n}const mm=t=>t.__isTeleport,ys=t=>t&&(t.disabled||t.disabled===""),pc=t=>typeof SVGElement!="undefined"&&t instanceof SVGElement,ui=(t,e)=>{const n=t&&t.to;return Je(n)?e?e(n):null:n},bm={__isTeleport:!0,process(t,e,n,o,s,r,l,a,i,c){const{mc:u,pc:f,pbc:p,o:{insert:g,querySelector:m,createText:b,createComment:P}}=c,O=ys(e.props);let{shapeFlag:h,children:v,dynamicChildren:_}=e;if(t==null){const j=e.el=b(""),S=e.anchor=b("");g(j,n,o),g(S,n,o);const T=e.target=ui(e.props,m),R=e.targetAnchor=b("");T&&(g(R,T),l=l||pc(T));const D=(F,K)=>{h&16&&u(v,F,K,s,r,l,a,i)};O?D(n,S):T&&D(T,R)}else{e.el=t.el;const j=e.anchor=t.anchor,S=e.target=t.target,T=e.targetAnchor=t.targetAnchor,R=ys(t.props),D=R?n:S,F=R?j:T;if(l=l||pc(S),_?(p(t.dynamicChildren,_,D,s,r,l,a),ra(t,e,!0)):i||f(t,e,D,F,s,r,l,a,!1),O)R?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Qs(e,n,j,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const K=e.target=ui(e.props,m);K&&Qs(e,K,null,c,0)}else R&&Qs(e,S,T,c,1)}Pf(e)},remove(t,e,n,o,{um:s,o:{remove:r}},l){const{shapeFlag:a,children:i,anchor:c,targetAnchor:u,target:f,props:p}=t;if(f&&r(u),l&&r(c),a&16){const g=l||!ys(p);for(let m=0;m<i.length;m++){const b=i[m];s(b,e,n,g,!!b.dynamicChildren)}}},move:Qs,hydrate:ym};function Qs(t,e,n,{o:{insert:o},m:s},r=2){r===0&&o(t.targetAnchor,e,n);const{el:l,anchor:a,shapeFlag:i,children:c,props:u}=t,f=r===2;if(f&&o(l,e,n),(!f||ys(u))&&i&16)for(let p=0;p<c.length;p++)s(c[p],e,n,2);f&&o(a,e,n)}function ym(t,e,n,o,s,r,{o:{nextSibling:l,parentNode:a,querySelector:i}},c){const u=e.target=ui(e.props,i);if(u){const f=u._lpa||u.firstChild;if(e.shapeFlag&16)if(ys(e.props))e.anchor=c(l(t),e,a(t),n,o,s,r),e.targetAnchor=f;else{e.anchor=l(t);let p=f;for(;p;)if(p=l(p),p&&p.nodeType===8&&p.data==="teleport anchor"){e.targetAnchor=p,u._lpa=e.targetAnchor&&l(e.targetAnchor);break}c(f,e,u,n,o,s,r)}Pf(e)}return e.anchor&&l(e.anchor)}const wf=bm;function Pf(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n&&n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const le=Symbol.for("v-fgt"),Zr=Symbol.for("v-txt"),dn=Symbol.for("v-cmt"),pr=Symbol.for("v-stc"),_s=[];let Wt=null;function x(t=!1){_s.push(Wt=t?null:[])}function _m(){_s.pop(),Wt=_s[_s.length-1]||null}let Ss=1;function hc(t){Ss+=t}function Cf(t){return t.dynamicChildren=Ss>0?Wt||wo:null,_m(),Ss>0&&Wt&&Wt.push(t),t}function E(t,e,n,o,s,r){return Cf(d(t,e,n,o,s,r,!0))}function ce(t,e,n,o,s){return Cf(A(t,e,n,o,s,!0))}function Is(t){return t?t.__v_isVNode===!0:!1}function qn(t,e){return t.type===e.type&&t.key===e.key}const Qr="__vInternal",xf=({key:t})=>t!=null?t:null,hr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Je(t)||be(t)||_e(t)?{i:ft,r:t,k:e,f:!!n}:t:null);function d(t,e=null,n=null,o=0,s=null,r=t===le?0:1,l=!1,a=!1){const i={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&xf(e),ref:e&&hr(e),scopeId:Kr,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ft};return a?(la(i,n),r&128&&t.normalize(i)):n&&(i.shapeFlag|=Je(n)?8:16),Ss>0&&!l&&Wt&&(i.patchFlag>0||r&6)&&i.patchFlag!==32&&Wt.push(i),i}const A=wm;function wm(t,e=null,n=null,o=0,s=null,r=!1){if((!t||t===Lg)&&(t=dn),Is(t)){const a=Ln(t,e,!0);return n&&la(a,n),Ss>0&&!r&&Wt&&(a.shapeFlag&6?Wt[Wt.indexOf(t)]=a:Wt.push(a)),a.patchFlag|=-2,a}if(Am(t)&&(t=t.__vccOpts),e){e=Pm(e);let{class:a,style:i}=e;a&&!Je(a)&&(e.class=Me(a)),He(i)&&(Gd(i)&&!de(i)&&(i=nt({},i)),e.style=Ke(i))}const l=Je(t)?1:rf(t)?128:mm(t)?64:He(t)?4:_e(t)?2:0;return d(t,e,n,o,s,l,r,!0)}function Pm(t){return t?Gd(t)||Qr in t?nt({},t):t:null}function Ln(t,e,n=!1){const{props:o,ref:s,patchFlag:r,children:l}=t,a=e?xm(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&xf(a),ref:e&&e.ref?n&&s?de(s)?s.concat(hr(e)):[s,hr(e)]:hr(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==le?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ln(t.ssContent),ssFallback:t.ssFallback&&Ln(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function W(t=" ",e=0){return A(Zr,null,t,e)}function Cm(t,e){const n=A(pr,null,t);return n.staticCount=e,n}function ue(t="",e=!1){return e?(x(),ce(dn,null,t)):A(dn,null,t)}function Kt(t){return t==null||typeof t=="boolean"?A(dn):de(t)?A(le,null,t.slice()):typeof t=="object"?xn(t):A(Zr,null,String(t))}function xn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ln(t)}function la(t,e){let n=0;const{shapeFlag:o}=t;if(e==null)e=null;else if(de(e))n=16;else if(typeof e=="object")if(o&65){const s=e.default;s&&(s._c&&(s._d=!1),la(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Qr in e)?e._ctx=ft:s===3&&ft&&(ft.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else _e(e)?(e={default:e,_ctx:ft},n=32):(e=String(e),o&64?(n=16,e=[W(e)]):n=8);t.children=e,t.shapeFlag|=n}function xm(...t){const e={};for(let n=0;n<t.length;n++){const o=t[n];for(const s in o)if(s==="class")e.class!==o.class&&(e.class=Me([e.class,o.class]));else if(s==="style")e.style=Ke([e.style,o.style]);else if(zr(s)){const r=e[s],l=o[s];l&&r!==l&&!(de(r)&&r.includes(l))&&(e[s]=r?[].concat(r,l):l)}else s!==""&&(e[s]=o[s])}return e}function jt(t,e,n,o=null){Et(t,e,7,[n,o])}const km=vf();let Om=0;function $m(t,e,n){const o=t.type,s=(e?e.appContext:t.appContext)||km,r={uid:Om++,vnode:t,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Dd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:mf(o,s),emitsOptions:sf(o,s),emit:null,emitted:null,propsDefaults:We,inheritAttrs:o.inheritAttrs,ctx:We,data:We,props:We,attrs:We,slots:We,refs:We,setupState:We,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Eg.bind(null,r),t.ce&&t.ce(r),r}let at=null;const kf=()=>at||ft;let ia,fo,vc="__VUE_INSTANCE_SETTERS__";(fo=Zl()[vc])||(fo=Zl()[vc]=[]),fo.push(t=>at=t),ia=t=>{fo.length>1?fo.forEach(e=>e(t)):fo[0](t)};const To=t=>{ia(t),t.scope.on()},eo=()=>{at&&at.scope.off(),ia(null)};function Of(t){return t.vnode.shapeFlag&4}let Ao=!1;function Sm(t,e=!1){Ao=e;const{props:n,children:o}=t.vnode,s=Of(t);am(t,n,s,e),dm(t,o);const r=s?Im(t,e):void 0;return Ao=!1,r}function Im(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Kd(new Proxy(t.ctx,Qg));const{setup:o}=n;if(o){const s=t.setupContext=o.length>1?Tm(t):null;To(t),qo();const r=An(o,t,0,[t.props,s]);if(Go(),eo(),Td(r)){if(r.then(eo,eo),e)return r.then(l=>{gc(t,l,e)}).catch(l=>{Ds(l,t,0)});t.asyncDep=r}else gc(t,r,e)}else $f(t,e)}function gc(t,e,n){_e(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:He(e)&&(t.setupState=Qd(e)),$f(t,n)}let mc;function $f(t,e,n){const o=t.type;if(!t.render){if(!e&&mc&&!o.render){const s=o.template||oa(t).template;if(s){const{isCustomElement:r,compilerOptions:l}=t.appContext.config,{delimiters:a,compilerOptions:i}=o,c=nt(nt({isCustomElement:r,delimiters:a},l),i);o.render=mc(s,c)}}t.render=o.render||en}{To(t),qo();try{em(t)}finally{Go(),eo()}}}function jm(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return yt(t,"get","$attrs"),e[n]}}))}function Tm(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return jm(t)},slots:t.slots,emit:t.emit,expose:e}}function el(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Qd(Kd(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ms)return ms[n](t)},has(e,n){return n in e||n in ms}}))}function bc(t,e=!0){return _e(t)?t.displayName||t.name:t.name||e&&t.__name}function Am(t){return _e(t)&&"__vccOpts"in t}const $=(t,e)=>$g(t,e,Ao);function yc(t,e,n){const o=arguments.length;return o===2?He(e)&&!de(e)?Is(e)?A(t,null,[e]):A(t,e):A(t,null,e):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&Is(n)&&(n=[n]),A(t,e,n))}const Em=Symbol.for("v-scx"),Rm=()=>bs(Em),Bm="3.3.8",Mm="http://www.w3.org/2000/svg",Gn=typeof document!="undefined"?document:null,_c=Gn&&Gn.createElement("template"),Dm={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,o)=>{const s=e?Gn.createElementNS(Mm,t):Gn.createElement(t,n?{is:n}:void 0);return t==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:t=>Gn.createTextNode(t),createComment:t=>Gn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Gn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,o,s,r){const l=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{_c.innerHTML=o?`<svg>${t}</svg>`:t;const a=_c.content;if(o){const i=a.firstChild;for(;i.firstChild;)a.appendChild(i.firstChild);a.removeChild(i)}e.insertBefore(a,n)}return[l?l.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},vn="transition",rs="animation",Eo=Symbol("_vtc"),Sf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Lm=nt({},Ug,Sf),Vn=(t,e=[])=>{de(t)?t.forEach(n=>n(...e)):t&&t(...e)},wc=t=>t?de(t)?t.some(e=>e.length>1):t.length>1:!1;function Nm(t){const e={};for(const Q in t)Q in Sf||(e[Q]=t[Q]);if(t.css===!1)return e;const{name:n="v",type:o,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:i=r,appearActiveClass:c=l,appearToClass:u=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,m=Fm(s),b=m&&m[0],P=m&&m[1],{onBeforeEnter:O,onEnter:h,onEnterCancelled:v,onLeave:_,onLeaveCancelled:j,onBeforeAppear:S=O,onAppear:T=h,onAppearCancelled:R=v}=e,D=(Q,fe,we)=>{Cn(Q,fe?u:a),Cn(Q,fe?c:l),we&&we()},F=(Q,fe)=>{Q._isLeaving=!1,Cn(Q,f),Cn(Q,g),Cn(Q,p),fe&&fe()},K=Q=>(fe,we)=>{const Be=Q?T:h,U=()=>D(fe,Q,we);Vn(Be,[fe,U]),Pc(()=>{Cn(fe,Q?i:r),sn(fe,Q?u:a),wc(Be)||Cc(fe,o,b,U)})};return nt(e,{onBeforeEnter(Q){Vn(O,[Q]),sn(Q,r),sn(Q,l)},onBeforeAppear(Q){Vn(S,[Q]),sn(Q,i),sn(Q,c)},onEnter:K(!1),onAppear:K(!0),onLeave(Q,fe){Q._isLeaving=!0;const we=()=>F(Q,fe);sn(Q,f),jf(),sn(Q,p),Pc(()=>{Q._isLeaving&&(Cn(Q,f),sn(Q,g),wc(_)||Cc(Q,o,P,we))}),Vn(_,[Q,we])},onEnterCancelled(Q){D(Q,!1),Vn(v,[Q])},onAppearCancelled(Q){D(Q,!0),Vn(R,[Q])},onLeaveCancelled(Q){F(Q),Vn(j,[Q])}})}function Fm(t){if(t==null)return null;if(He(t))return[jl(t.enter),jl(t.leave)];{const e=jl(t);return[e,e]}}function jl(t){return zv(t)}function sn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Eo]||(t[Eo]=new Set)).add(e)}function Cn(t,e){e.split(/\s+/).forEach(o=>o&&t.classList.remove(o));const n=t[Eo];n&&(n.delete(e),n.size||(t[Eo]=void 0))}function Pc(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Hm=0;function Cc(t,e,n,o){const s=t._endId=++Hm,r=()=>{s===t._endId&&o()};if(n)return setTimeout(r,n);const{type:l,timeout:a,propCount:i}=If(t,e);if(!l)return o();const c=l+"end";let u=0;const f=()=>{t.removeEventListener(c,p),r()},p=g=>{g.target===t&&++u>=i&&f()};setTimeout(()=>{u<i&&f()},a+1),t.addEventListener(c,p)}function If(t,e){const n=window.getComputedStyle(t),o=m=>(n[m]||"").split(", "),s=o(`${vn}Delay`),r=o(`${vn}Duration`),l=xc(s,r),a=o(`${rs}Delay`),i=o(`${rs}Duration`),c=xc(a,i);let u=null,f=0,p=0;e===vn?l>0&&(u=vn,f=l,p=r.length):e===rs?c>0&&(u=rs,f=c,p=i.length):(f=Math.max(l,c),u=f>0?l>c?vn:rs:null,p=u?u===vn?r.length:i.length:0);const g=u===vn&&/\b(transform|all)(,|$)/.test(o(`${vn}Property`).toString());return{type:u,timeout:f,propCount:p,hasTransform:g}}function xc(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,o)=>kc(n)+kc(t[o])))}function kc(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function jf(){return document.body.offsetHeight}function Um(t,e,n){const o=t[Eo];o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Vm=Symbol("_vod");function Wm(t,e,n){const o=t.style,s=Je(n);if(n&&!s){if(e&&!Je(e))for(const r in e)n[r]==null&&di(o,r,"");for(const r in n)di(o,r,n[r])}else{const r=o.display;s?e!==n&&(o.cssText=n):e&&t.removeAttribute("style"),Vm in t&&(o.display=r)}}const Oc=/\s*!important$/;function di(t,e,n){if(de(n))n.forEach(o=>di(t,e,o));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const o=zm(t,e);Oc.test(n)?t.setProperty(lo(o),n.replace(Oc,""),"important"):t[o]=n}}const $c=["Webkit","Moz","ms"],Tl={};function zm(t,e){const n=Tl[e];if(n)return n;let o=Io(e);if(o!=="filter"&&o in t)return Tl[e]=o;o=Rd(o);for(let s=0;s<$c.length;s++){const r=$c[s]+o;if(r in t)return Tl[e]=r}return e}const Sc="http://www.w3.org/1999/xlink";function Xm(t,e,n,o,s){if(o&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Sc,e.slice(6,e.length)):t.setAttributeNS(Sc,e,n);else{const r=Jv(e);n==null||r&&!Bd(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function Ym(t,e,n,o,s,r,l){if(e==="innerHTML"||e==="textContent"){o&&l(o,s,r),t[e]=n==null?"":n;return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=n;const c=a==="OPTION"?t.getAttribute("value"):t.value,u=n==null?"":n;c!==u&&(t.value=u),n==null&&t.removeAttribute(e);return}let i=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=Bd(n):n==null&&c==="string"?(n="",i=!0):c==="number"&&(n=0,i=!0)}try{t[e]=n}catch(c){}i&&t.removeAttribute(e)}function On(t,e,n,o){t.addEventListener(e,n,o)}function qm(t,e,n,o){t.removeEventListener(e,n,o)}const Ic=Symbol("_vei");function Gm(t,e,n,o,s=null){const r=t[Ic]||(t[Ic]={}),l=r[e];if(o&&l)l.value=o;else{const[a,i]=Km(e);if(o){const c=r[e]=Qm(o,s);On(t,a,c,i)}else l&&(qm(t,a,l,i),r[e]=void 0)}}const jc=/(?:Once|Passive|Capture)$/;function Km(t){let e;if(jc.test(t)){e={};let o;for(;o=t.match(jc);)t=t.slice(0,t.length-o[0].length),e[o[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):lo(t.slice(2)),e]}let Al=0;const Jm=Promise.resolve(),Zm=()=>Al||(Jm.then(()=>Al=0),Al=Date.now());function Qm(t,e){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;Et(eb(o,n.value),e,5,[o])};return n.value=t,n.attached=Zm(),n}function eb(t,e){if(de(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(o=>s=>!s._stopped&&o&&o(s))}else return e}const Tc=/^on[a-z]/,tb=(t,e,n,o,s=!1,r,l,a,i)=>{e==="class"?Um(t,o,s):e==="style"?Wm(t,n,o):zr(e)?Vi(e)||Gm(t,e,n,o,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):nb(t,e,o,s))?Ym(t,e,o,r,l,a,i):(e==="true-value"?t._trueValue=o:e==="false-value"&&(t._falseValue=o),Xm(t,e,o,s))};function nb(t,e,n,o){return o?!!(e==="innerHTML"||e==="textContent"||e in t&&Tc.test(e)&&_e(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Tc.test(e)&&Je(n)?!1:e in t}const Tf=new WeakMap,Af=new WeakMap,Or=Symbol("_moveCb"),Ac=Symbol("_enterCb"),Ef={name:"TransitionGroup",props:nt({},Lm,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=kf(),o=Hg();let s,r;return ta(()=>{if(!s.length)return;const l=t.moveClass||`${t.name||"v"}-move`;if(!ib(s[0].el,n.vnode.el,l))return;s.forEach(sb),s.forEach(rb);const a=s.filter(lb);jf(),a.forEach(i=>{const c=i.el,u=c.style;sn(c,l),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[Or]=p=>{p&&p.target!==c||(!p||/transform$/.test(p.propertyName))&&(c.removeEventListener("transitionend",f),c[Or]=null,Cn(c,l))};c.addEventListener("transitionend",f)})}),()=>{const l=Te(t),a=Nm(l);let i=l.tag||le;s=r,r=e.default?cf(e.default()):[];for(let c=0;c<r.length;c++){const u=r[c];u.key!=null&&Cr(u,si(u,a,o,n))}if(s)for(let c=0;c<s.length;c++){const u=s[c];Cr(u,si(u,a,o,n)),Tf.set(u,u.el.getBoundingClientRect())}return A(i,null,r)}}},ob=t=>delete t.mode;Ef.props;const RT=Ef;function sb(t){const e=t.el;e[Or]&&e[Or](),e[Ac]&&e[Ac]()}function rb(t){Af.set(t,t.el.getBoundingClientRect())}function lb(t){const e=Tf.get(t),n=Af.get(t),o=e.left-n.left,s=e.top-n.top;if(o||s){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",t}}function ib(t,e,n){const o=t.cloneNode(),s=t[Eo];s&&s.forEach(a=>{a.split(/\s+/).forEach(i=>i&&o.classList.remove(i))}),n.split(/\s+/).forEach(a=>a&&o.classList.add(a)),o.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(o);const{hasTransform:l}=If(o);return r.removeChild(o),l}const Ro=t=>{const e=t.props["onUpdate:modelValue"]||!1;return de(e)?n=>Co(e,n):e};function ab(t){t.target.composing=!0}function Ec(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const un=Symbol("_assign"),qe={created(t,{modifiers:{lazy:e,trim:n,number:o}},s){t[un]=Ro(s);const r=o||s.props&&s.props.type==="number";On(t,e?"change":"input",l=>{if(l.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=_r(a)),t[un](a)}),n&&On(t,"change",()=>{t.value=t.value.trim()}),e||(On(t,"compositionstart",ab),On(t,"compositionend",Ec),On(t,"change",Ec))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:o,number:s}},r){if(t[un]=Ro(r),t.composing||document.activeElement===t&&t.type!=="range"&&(n||o&&t.value.trim()===e||(s||t.type==="number")&&_r(t.value)===e))return;const l=e==null?"":e;t.value!==l&&(t.value=l)}},cb={deep:!0,created(t,e,n){t[un]=Ro(n),On(t,"change",()=>{const o=t._modelValue,s=js(t),r=t.checked,l=t[un];if(de(o)){const a=Xi(o,s),i=a!==-1;if(r&&!i)l(o.concat(s));else if(!r&&i){const c=[...o];c.splice(a,1),l(c)}}else if(Xo(o)){const a=new Set(o);r?a.add(s):a.delete(s),l(a)}else l(Rf(t,r))})},mounted:Rc,beforeUpdate(t,e,n){t[un]=Ro(n),Rc(t,e,n)}};function Rc(t,{value:e,oldValue:n},o){t._modelValue=e,de(e)?t.checked=Xi(e,o.props.value)>-1:Xo(e)?t.checked=e.has(o.props.value):e!==n&&(t.checked=Ms(e,Rf(t,!0)))}const Bt={deep:!0,created(t,{value:e,modifiers:{number:n}},o){const s=Xo(e);On(t,"change",()=>{const r=Array.prototype.filter.call(t.options,l=>l.selected).map(l=>n?_r(js(l)):js(l));t[un](t.multiple?s?new Set(r):r:r[0])}),t[un]=Ro(o)},mounted(t,{value:e}){Bc(t,e)},beforeUpdate(t,e,n){t[un]=Ro(n)},updated(t,{value:e}){Bc(t,e)}};function Bc(t,e){const n=t.multiple;if(!(n&&!de(e)&&!Xo(e))){for(let o=0,s=t.options.length;o<s;o++){const r=t.options[o],l=js(r);if(n)de(e)?r.selected=Xi(e,l)>-1:r.selected=e.has(l);else if(Ms(js(r),e)){t.selectedIndex!==o&&(t.selectedIndex=o);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function js(t){return"_value"in t?t._value:t.value}function Rf(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const ub=["ctrl","shift","alt","meta"],db={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>ub.some(n=>t[`${n}Key`]&&!e.includes(n))},ae=(t,e)=>(n,...o)=>{for(let s=0;s<e.length;s++){const r=db[e[s]];if(r&&r(n,e))return}return t(n,...o)},fb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},lt=(t,e)=>n=>{if(!("key"in n))return;const o=lo(n.key);if(e.some(s=>s===o||fb[s]===o))return t(n)},pb=nt({patchProp:tb},Dm);let Mc;function hb(){return Mc||(Mc=pm(pb))}const vb=(...t)=>{const e=hb().createApp(...t),{mount:n}=e;return e.mount=o=>{const s=gb(o);if(!s)return;const r=e._component;!_e(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";const l=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},e};function gb(t){return Je(t)?document.querySelector(t):t}const mb="modulepreload",bb=function(t,e){return new URL(t,e).href},Dc={},Lc=function(e,n,o){let s=Promise.resolve();if(n&&n.length>0){const r=document.getElementsByTagName("link");s=Promise.all(n.map(l=>{if(l=bb(l,o),l in Dc)return;Dc[l]=!0;const a=l.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(!!o)for(let f=r.length-1;f>=0;f--){const p=r[f];if(p.href===l&&(!a||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${i}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":mb,a||(u.as="script",u.crossOrigin=""),u.href=l,document.head.appendChild(u),a)return new Promise((f,p)=>{u.addEventListener("load",f),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}return s.then(()=>e()).catch(r=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r})};function yb(t){return{all:t=t||new Map,on:function(e,n){var o=t.get(e);o?o.push(n):t.set(e,[n])},off:function(e,n){var o=t.get(e);o&&(n?o.splice(o.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var o=t.get(e);o&&o.slice().map(function(s){s(n)}),(o=t.get("*"))&&o.slice().map(function(s){s(e,n)})}}}var _b=Object.defineProperty,wb=(t,e,n)=>e in t?_b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ot=(t,e,n)=>(wb(t,typeof e!="symbol"?e+"":e,n),n);const El=yb(),je={fire(t){El.emit(t.kind,t)},subscribe(t,e){El.on(t.kind,e)},unsubscribe(t,e){El.off(t.kind,e)}};class $r{constructor(e){this.path=e,ot(this,"kind","AssetFailureEvent")}}ot($r,"kind","AssetFailureEvent");class Ts{constructor(e){this.message=e,ot(this,"kind","FailureEvent")}}ot(Ts,"kind","FailureEvent");class Bf{constructor(e){this.error=e,ot(this,"kind","CustomAssetFailureEvent")}}ot(Bf,"kind","CustomAssetFailureEvent");class tl{constructor(){ot(this,"kind","InvalidateRenderEvent")}}ot(tl,"kind","InvalidateRenderEvent");const Mf=class Df{constructor(){ot(this,"kind",Df.kind)}};ot(Mf,"kind","RenderUpdatedEvent");let Lf=Mf;const Nf=class Ff{constructor(){ot(this,"kind",Ff.kind)}};ot(Nf,"kind","StateLoadingEvent");let Hf=Nf;class Tt{constructor(e){this.message=e,ot(this,"kind","ShowMessageEvent")}}ot(Tt,"kind","ShowMessageEvent");class aa{constructor(e,n){this.message=e,this.actions=n,ot(this,"kind","ResolvableErrorEvent")}}ot(aa,"kind","ResolvableErrorEvent");class Sr{constructor(e){this.color=e,ot(this,"kind","ColorPickedEvent")}}ot(Sr,"kind","ColorPickedEvent");class Uf{constructor(e,n){this.error=e,this.info=n,ot(this,"kind","VueErrorEvent")}}ot(Uf,"kind","VueErrorEvent");const Pb="./",ca="/dddg-assets/v2/assets/",vt=`${Pb}packs/`,Cb=!0,ua=!0,da={"dddg.buildin.backgrounds.nsfw":`${vt}buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${vt}buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${vt}buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${vt}buildin.base.yuri.nsfw.json`},xb=new Set(Object.keys(da)),kb=Object.values(da);var Ob=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Z=Vf();function Vf(){const t=[];let e=!1;return function(o){return new Promise((s,r)=>{const l=()=>Ob(this,null,function*(){try{o.length>0?yield o(Vf()):yield o()}catch(a){console.log("Error during transaction!: ",a)}finally{e=!1}t.length>0&&t.shift()(),s()});e?t.push(l):l()})}}var $b=Object.defineProperty,Nc=Object.getOwnPropertySymbols,Sb=Object.prototype.hasOwnProperty,Ib=Object.prototype.propertyIsEnumerable,fi=(t,e,n)=>e in t?$b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pi=(t,e)=>{for(var n in e||(e={}))Sb.call(e,n)&&fi(t,n,e[n]);if(Nc)for(var n of Nc(e))Ib.call(e,n)&&fi(t,n,e[n]);return t},Nt=(t,e,n)=>(fi(t,typeof e!="symbol"?e+"":e,n),n),st=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ir=navigator.userAgent,jb=!!Ir.match(/iPad/i)||!!Ir.match(/iPhone/i),Tb=!!Ir.match(/WebKit/i),Fc=jb&&Tb&&!Ir.match(/CriOS/i);class Wf{constructor(){Nt(this,"state",Dn({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder"})),Nt(this,"supports"),Nt(this,"_gameMode",null),Nt(this,"$store",null),Nt(this,"isSavingEnabled",N(!1)),Nt(this,"localRepositoryUrl",""),Nt(this,"loading"),Nt(this,"creatingDB"),Nt(this,"loadingContentPacksAllowed"),Nt(this,"loadContentPacks"),Nt(this,"updateProgress",null);const e=this,n=rt.canSave();window.addEventListener("beforeunload",function(o){o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise((o,s)=>{this.loadContentPacks=()=>o()}),this.supports=Dn({optionalSaving:n,get autoLoading(){return n&&e.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!Fc,allowWebP:!0,limitedCanvasSpace:Fc}),n?this.loading=st(this,null,function*(){this.savingEnabled=yield rt.doesDbExists()}):this.loading=Promise.resolve(),this.loading.then(()=>st(this,null,function*(){var o;if(yield this.loadingContentPacksAllowed,this.creatingDB&&(yield this.creatingDB),this.savingEnabled){const s=(o=yield rt.loadAutoload())!=null?o:[];this.state.autoAdd=s;const r=yield Lo.getInstance(),l=yield Promise.all(s.map(a=>st(this,null,function*(){var i;const[c,u]=a.split(";",2);u!=null&&!r.hasPack(c)&&(yield r.loadTempPack(u));const f=r.getPack(c);return(i=f.dddg2Path)!=null?i:f.dddg1Path})));yield Z(()=>st(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",l)}))}}))}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(e){e?(localStorage.setItem("saving","true"),this.creatingDB=rt.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=rt.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}loadGameMode(){return st(this,null,function*(){const n=new URLSearchParams(location.search).get("mode");if(n==="ddlc"||n==="ddlc_plus"){this._gameMode=n;return}yield this.loading,yield this.creatingDB;let o="";this.isSavingEnabled.value&&(o=yield rt.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s})}setGameMode(e){return st(this,null,function*(){this.isSavingEnabled.value&&(yield rt.saveGameMode(e));const n=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${n}?mode=${e}`})}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(e){throw new Error("Method not implemented.")}connectToStore(e){this.$store=e}saveToFile(e,n,o="image/png",s=1){return st(this,null,function*(){const r=document.createElement("a");r.setAttribute("download",n);const l=yield this.createObjectURL(e,o,s);return r.setAttribute("href",l),document.body.appendChild(r),r.click(),document.body.removeChild(r),l})}localRepoInstall(e,n,o){return Promise.reject(new Error("This environment does not support a local repository"))}localRepoUninstall(e){throw new Error("This environment does not support a local repository")}autoLoadAdd(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB,yield rt.saveAutoload([...this.state.autoAdd,e]),this.state.autoAdd.push(e)})}autoLoadRemove(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB;const n=this.normalizePackId(e);yield rt.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=n));const o=this.state.autoAdd.indexOf(e);this.state.autoAdd.splice(o,1)})}normalizePackId(e){const n=e.split(";");return n.length===1?n[0]:n[n.length-1]}loadSettings(){return st(this,null,function*(){yield this.loading,yield this.creatingDB;const e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?pi(pi({},e),yield rt.loadSettings()):e})}saveSettings(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield rt.saveSettings(e))})}isInitialized(){return st(this,null,function*(){yield this.loading,yield this.creatingDB})}prompt(e,n){return new Promise((o,s)=>{o(prompt(e,n))})}onPanelChange(e){}createObjectURL(e,n,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(e.toDataURL(n,o));if(e.toBlob!=null)e.toBlob(a=>{if(!a){r();return}s(URL.createObjectURL(a))},n,o);else{const a=e.toDataURL(n,o),i=this.dataURItoBlob(a,n);s(URL.createObjectURL(i))}})}dataURItoBlob(e,n){const o=atob(e.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let l=0;l<s;l++)r[l]=o.charCodeAt(l);return new Blob([r],{type:n})}}const rt={indexedDB:(()=>{var t,e,n;try{return(n=(e=(t=window.indexedDB)!=null?t:window.mozIndexedDB)!=null?e:window.webkitIndexedDB)!=null?n:window.msIndexedDB}catch(o){return null}})(),transaction:(()=>{try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(t){return null}})(),db:null,canSave(){return!!(rt.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return rt.db?rt.db:rt.db=new Promise((t,e)=>{const n=rt.indexedDB.open("dddg",3);n.onerror=o=>{e(o)},n.onupgradeneeded=o=>{var s;const r=o.target.result,l=(s=o.oldVersion)!=null?s:o.version;l<1&&r.createObjectStore("settings"),l===1&&(r.deleteObjectStore("settings"),r.createObjectStore("settings"))},n.onsuccess=o=>{t(n.result)}})},clearDB(){return new Promise((t,e)=>{if(!rt.db){t();return}const n=rt.indexedDB.deleteDatabase("dddg");rt.db=null,n.onerror=o=>{e(o)},n.onsuccess=o=>{t()}})},loadAutoload(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("autoload"))}))},saveAutoload(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put([...t],"autoload"))}))},loadGameMode(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("gameMode"))}))},saveGameMode(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put(t,"gameMode"))}))},saveSettings(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put(pi({},t),"settings"))}))},loadSettings(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("settings"))}))},objectStorePromise(t,e){return this.db?new Promise((n,o)=>st(this,null,function*(){const r=(yield this.db).transaction(["settings"],t).objectStore("settings");try{n(yield e(r))}catch(l){o(l)}})):Promise.reject(new Error("No database"))},reqPromise(t){return new Promise((e,n)=>{t.onerror=o=>{n(o)},t.onsuccess=o=>{e(t.result)}})}};class Ab extends Wf{saveToFile(e,n,o="image/png",s=1){let r=e.toDataURL(o,s);const l=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(l)),window.navigator.msSaveBlob(l,n),Promise.resolve(r)}}const zf="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!--%20Source:%20https://fonts.google.com/icons?selected=Material%2520Icons%2520Round%253Awarning%253A%20--%3e%3csvg%20fill='%23FFFFFF'%20version='1.1'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cdefs%3e%3cfilter%20id='a'%20x='-.07126'%20y='-.079384'%20width='1.1425'%20height='1.1597'%20color-interpolation-filters='sRGB'%3e%3cfeGaussianBlur%20stdDeviation='0.36070242'/%3e%3c/filter%3e%3c/defs%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23fff'%20filter='url(%23a)'%20stroke='%23fff'/%3e%3cpath%20d='M4.47%2021h15.06c1.54%200%202.5-1.67%201.73-3L13.73%204.99c-.77-1.33-2.69-1.33-3.46%200L2.74%2018c-.77%201.33.19%203%201.73%203zM12%2014c-.55%200-1-.45-1-1v-2c0-.55.45-1%201-1s1%20.45%201%201v2c0%20.55-.45%201-1%201zm1%204h-2v-2h2v2z'%20fill='%23000'/%3e%3c/svg%3e";var Eb=Object.defineProperty,Hc=Object.getOwnPropertySymbols,Rb=Object.prototype.hasOwnProperty,Bb=Object.prototype.propertyIsEnumerable,hi=(t,e,n)=>e in t?Eb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Uc=(t,e)=>{for(var n in e||(e={}))Rb.call(e,n)&&hi(t,n,e[n]);if(Hc)for(var n of Hc(e))Bb.call(e,n)&&hi(t,n,e[n]);return t},Vc=(t,e,n)=>(hi(t,typeof e!="symbol"?e+"":e,n),n);class no{constructor(e){this.html=e,Vc(this,"width"),Vc(this,"height"),this.width=e.width,this.height=e.height}paintOnto(e,n={}){const{w:o,h:s}=Uc({w:this.width,h:this.height},n),{x:r,y:l}=Uc({x:-o/2,y:-s/2},n);e.drawImage(this.html,r,l,o,s)}}var Mb=Object.defineProperty,Db=(t,e,n)=>e in t?Mb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wc=(t,e,n)=>(Db(t,typeof e!="symbol"?e+"":e,n),n);let vi=null;setTimeout(()=>Do(zf).then(t=>{t instanceof no&&(vi=t)}),0);class As{constructor(){Wc(this,"width",300),Wc(this,"height",300)}paintOnto(e,n={}){vi&&vi.paintOnto(e,n)}}var Lb=Object.defineProperty,Nb=(t,e,n)=>e in t?Lb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xf=(t,e,n)=>(Nb(t,typeof e!="symbol"?e+"":e,n),n),Bo=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});let Rl;function Mo(){if(Rl)return Rl;if(!ve.supports.allowWebP||!Cb)return Promise.resolve(!1);const t="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",e="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return Rl=Bo(this,null,function*(){const n=yield Promise.all([gi(t,1,2),gi(e,720,1280)]);return n[0]&&n[1]})}function gi(t,e,n){return new Promise((o,s)=>{const r=document.createElement("img");r.addEventListener("load",()=>{o(r.width===n&&r.height===e)}),r.addEventListener("error",()=>{o(!1)}),r.src=t})}let Bl;function Fb(){return Bl||(Bl=Bo(this,null,function*(){return yield gi("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2)}))}class Hb{constructor(){Xf(this,"cache",new Map)}get(e){const n=this.cache.get(e);if(n)return n;const o=Tr(e);return this.cache.set(e,o),o}remove(e){this.cache.delete(e)}}class Ub{constructor(){Xf(this,"cache",new Map)}get(e){var n;const o=(n=this.cache.get(e))==null?void 0:n.deref();if(o)return o;const s=Wb(e);return this.cache.set(e,new WeakRef(s)),s}remove(e){this.cache.delete(e)}}let Ml=null;function jr(){return Ml||(window.assetCache=Ml=ve.supports.assetCaching||typeof WeakRef=="undefined"?new Hb:new Ub)}const oo={};function fa(t,e=!0){return Do(ve.supports.lq&&!e?t.lq:t.hq)}function En(t,e=!0){const n=ve.supports.lq&&ua&&!e?t.lq:t.hq;return oo[n]?oo[n]:n}function Do(t){return oo[t]&&(t=oo[t]),jr().get(t)}function Es(t,e=!0){return Bo(this,null,function*(){const n=`${ca}${t}${ve.supports.lq&&ua&&!e?".lq":""}${(yield Mo())?".webp":".png"}`.replace(/\/+/,"/");return yield jr().get(n)})}function Vb(t,e=!0){return Bo(this,null,function*(){return`${ca}${t}${ve.supports.lq&&ua&&!e?".lq":""}${(yield Mo())?".webp":".png"}`.replace(/\/+/,"/")})}function Yf(t,e){oo[t]=e}function Wb(t){return Bo(this,null,function*(){const e=!!oo[t];return e&&(t=oo[t]),yield Bo(this,null,function*(){try{return yield Tr(t)}catch(n){if(t.endsWith(".webp")&&!e)try{return yield Tr(t.replace(/\.webp$/,".png"))}catch(o){return je.fire(new $r(t)),jr().remove(t),new As}else return je.fire(new $r(t)),jr().remove(t),new As}})})}function Tr(t,e=!1){return new Promise((n,o)=>{const s=new Image;s.addEventListener("load",()=>{n(new no(s)),(e||!ve.supports.assetCaching)&&document.body.removeChild(s)}),s.addEventListener("error",r=>{n(new As),(e||!ve.supports.assetCaching)&&document.body.removeChild(s)}),s.crossOrigin="Anonymous",s.src=t,s.style.display="none",document.body.appendChild(s)})}var zb=Object.defineProperty,Xb=(t,e,n)=>e in t?zb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e,n)=>(Xb(t,typeof e!="symbol"?e+"":e,n),n),Ze=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const zc={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};class Yb{constructor(){xt(this,"state",Dn({looseTextParsing:!0,autoAdd:[],downloadLocation:""})),xt(this,"localRepositoryUrl","/repo/"),xt(this,"_gameMode",null),xt(this,"electron",window),xt(this,"$store",null),xt(this,"bgInvalidation",null),xt(this,"pendingContentPacks",[]),xt(this,"pendingContentPacksReplace",[]),xt(this,"loadingContentPacksAllowed"),xt(this,"loadContentPacks"),xt(this,"updateProgress",N("wait")),xt(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1}),xt(this,"savingEnabled",!0),this.loadingContentPacksAllowed=new Promise((n,o)=>{this.loadContentPacks=()=>n()}),this.electron.ipcRenderer.on("add-persistent-content-pack",n=>Ze(this,null,function*(){if(yield this.loadingContentPacksAllowed,!this.$store){this.pendingContentPacks.push(n);return}yield Z(()=>Ze(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",n)}))})),this.electron.ipcRenderer.on("add-persistent-background",n=>Ze(this,null,function*(){const o="persistentBg-"+n,s=n.split("/");yield Yf(o,n),zc.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()})),this.electron.ipcRenderer.on("push-message",n=>{je.fire(new Tt(n))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",n=>{this.state.downloadLocation=n}),this.electron.ipcRenderer.onConversation("load-packs",n=>Ze(this,null,function*(){const o=yield Lo.getInstance(),s=yield Promise.all(n.map(r=>Ze(this,null,function*(){const[l,a]=r.split(";",2);a!=null&&!o.hasPack(l)&&(yield o.loadTempPack(a));const i=o.getPack(l);return i.dddg2Path||i.dddg1Path})));if(!this.$store){s.forEach(r=>this.pendingContentPacks.push(r));return}yield Z(()=>Ze(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",s)}))})),this.electron.ipcRenderer.onConversation("auto-load.changed",n=>{this.state.autoAdd=n}),this.electron.ipcRenderer.onConversation("reload-repo",()=>Ze(this,null,function*(){yield(yield Lo.getInstance()).reloadLocalRepo()})),this.electron.ipcRenderer.onConversation("replace-pack",n=>Ze(this,null,function*(){const o={processed:!1,contentPack:n};this.$store?yield Z(()=>Ze(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",o)})):this.pendingContentPacksReplace.push(o)})),this.electron.ipcRenderer.onConversation("resolvable-error",(n,o)=>new Promise((s,r)=>{je.fire(new aa(n,o.map(l=>({exec:()=>s(l),name:l}))))}));let e=!1;this.electron.ipcRenderer.on("update.progress",n=>{this.updateProgress.value=n,n==="done"?(e=!1,je.fire(new Tt("An update is downloaded and will be installed once DDDG closes."))):e||(e=!0,je.fire(new Tt("An update was found and will download in the background.")))}),this.electron.ipcRenderer.on("update.checkStopped",()=>{this.updateProgress.value="none"}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(e){this.electron.ipcRenderer.send("open-folder",e)}onPanelChange(e){}saveSettings(e){return Ze(this,null,function*(){var n;yield this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw),yield this.electron.ipcRenderer.sendConvo("config.set","darkMode",(n=e.darkMode)!=null?n:void 0),yield this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom)})}loadGameMode(){return Ze(this,null,function*(){this._gameMode=(yield this.electron.ipcRenderer.sendConvo("config.get","gameMode"))||"ddlc"})}setGameMode(e){return Ze(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("config.set","gameMode",e),this.electron.ipcRenderer.send("reload")})}loadSettings(){return Ze(this,null,function*(){var e,n,o;return{lq:!1,nsfw:(e=yield this.electron.ipcRenderer.sendConvo("config.get","nsfw"))!=null?e:!1,darkMode:(n=yield this.electron.ipcRenderer.sendConvo("config.get","darkMode"))!=null?n:void 0,defaultCharacterTalkingZoom:(o=yield this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom"))!=null?o:void 0}})}localRepoInstall(e,n,o){return Ze(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.install",e,n,o)})}localRepoUninstall(e){return Ze(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.uninstall",e)})}autoLoadAdd(e){return Ze(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.add",e)})}autoLoadRemove(e){return Ze(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.remove",e)})}saveToFile(e,n,o="image/png",s=1){return new Promise((r,l)=>{e.toBlob(a=>Ze(this,null,function*(){if(!a){l();return}const i=yield a.arrayBuffer();yield this.electron.ipcRenderer.sendConvo("save-file",n,new Uint8Array(i)),r(URL.createObjectURL(a))}),o,s)})}prompt(e,n){return Ze(this,null,function*(){return yield this.electron.ipcRenderer.sendConvo("show-prompt",e,n)})}connectToStore(e){this.$store=e,this.invalidateInstalledBGs(),Z(()=>Ze(this,null,function*(){if(this.pendingContentPacks.length>0&&(yield this.$store.dispatch("content/loadContentPacks",this.pendingContentPacks)),this.pendingContentPacksReplace.length>0)for(const n of this.pendingContentPacksReplace)yield this.$store.dispatch("content/replaceContentPack",n)}))}invalidateInstalledBGs(){this.$store&&this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.$store&&Z(()=>Ze(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",{contentPack:zc})}))}}function qb(){return window.isElectron?new Yb:"msSaveOrOpenBlob"in window.navigator?new Ab:new Wf}const ve=qb();window.toast=ve;var Gb=Object.defineProperty,Kb=Object.defineProperties,Jb=Object.getOwnPropertyDescriptors,Xc=Object.getOwnPropertySymbols,Zb=Object.prototype.hasOwnProperty,Qb=Object.prototype.propertyIsEnumerable,mi=(t,e,n)=>e in t?Gb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ls=(t,e)=>{for(var n in e||(e={}))Zb.call(e,n)&&mi(t,n,e[n]);if(Xc)for(var n of Xc(e))Qb.call(e,n)&&mi(t,n,e[n]);return t},ey=(t,e)=>Kb(t,Jb(e)),$n=(t,e,n)=>(mi(t,typeof e!="symbol"?e+"":e,n),n),is=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const ty="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",Rs=class Ft{constructor(e,n,o){this.$store=o,$n(this,"onlineRepo"),$n(this,"localRepo"),$n(this,"tempRepo",Dn({authors:{},packs:[]})),$n(this,"combinedList"),$n(this,"authors"),window.repo=this,e||(e={authors:{},packs:[]},je.fire(new Tt("Couldn't load remote repository."))),n||(n={authors:{},packs:[]},ve.supports.localRepo&&je.fire(new Tt("Couldn't load local repository."))),this.onlineRepo=N(e),this.localRepo=N(n),this.combinedList=$(()=>{var s,r;const l=this.onlineRepo.value,a=(s=l==null?void 0:l.packs)!=null?s:[],i=new Map(a.map(v=>[v.id,v])),c=this.localRepo.value,u=(r=c==null?void 0:c.packs)!=null?r:[],f=new Map(u.map(v=>[v.id,v])),g=this.tempRepo.packs,m=new Map(g.map(v=>[v.id,v])),b=new Set(ve.state.autoAdd),P=this.$store.state.content.contentPacks.map(v=>v.packId).filter(v=>v!=null),O=new Set(P),h=new Set;return[...P,...u.map(v=>v.id),...a.map(v=>v.id),...g.map(v=>v.id)].filter(v=>v.startsWith("dddg.buildin.")||v.startsWith("dddg.uploads.")||v.startsWith("dddg.desktop.")||v==="concept_femc.shido_draws.edave64"||v==="mc.storm_blaze.edave64"||h.has(v)?!1:(h.add(v),!0)).map(v=>{var _,j,S;return ey(ls(ls(ls({},(_=i.get(v))!=null?_:{characters:[],kind:[],authors:[]}),(j=f.get(v))!=null?j:{}),(S=m.get(v))!=null?S:{}),{autoloading:b.has(v),installed:f.has(v),online:i.has(v)||m.has(v),loaded:O.has(v)})})}),this.authors=$(()=>{var s,r;const l=this.onlineRepo.value,a=(s=l==null?void 0:l.authors)!=null?s:{},i=this.localRepo.value,c=(r=i==null?void 0:i.authors)!=null?r:{};return ls(ls({},a),c)}),Object.freeze(this)}static getInstance(){return Ft.instance||(Ft.instance=this.createInstance()),Ft.instance}static createInstance(){return is(this,null,function*(){const e=Ft.loadRepo(ty),n=ve.supports.localRepo?yield Ft.loadRepo(ve.localRepositoryUrl):null,[o,s,r]=yield Promise.all([e,n,Ft.$store]);return new Ft(o,s,r)})}static loadRepo(e){return is(this,null,function*(){try{const[n,o]=yield Promise.all([Ft.fetchJSON(e+"repo.json"),Ft.fetchJSON(e+"people.json")]);return{packs:n,authors:o}}catch(n){return null}})}static fetchJSON(e){return is(this,null,function*(){const n=yield fetch(e);if(!n.ok)throw new Error("Could not load json");return yield n.json()})}reloadLocalRepo(){return is(this,null,function*(){this.localRepo.value=ve.supports.localRepo?yield Ft.loadRepo(ve.localRepositoryUrl):null})}getPacks(){return this.combinedList.value}hasPack(e,n=!1){var o;return n?!!((o=this.onlineRepo.value)!=null&&o.packs.find(s=>s.id===e)):!!this.getPacks().find(s=>s.id===e)}getPack(e){var n;return(n=this.getPacks().find(o=>o.id===e))!=null?n:null}getAuthor(e){return this.authors.value[e]||null}getAuthors(){return this.authors.value}loadTempPack(e){return is(this,null,function*(){const n=fetch(e);let o;try{o=yield n}catch(l){throw new Error(`Failed to load '${e}'`)}let s;try{s=yield o.json()}catch(l){throw new Error(`The contents of '${e}' is not a valid JSON: ${l.message}`)}if(!s.pack&&(!s.packs||s.packs.length===0))throw new Error(`The json file '${e}' does not contain any packages`);if(s.authors)for(const l in s.authors)this.tempRepo.authors[l]&&(this.tempRepo.authors[l]=s.authors[l]);let r=null;if(s.pack&&(this.addTempPack(s.pack,e),r=s.pack.id),s.packs)for(const l of s.packs)this.addTempPack(l,e),r===null&&(r=l.id);return r})}addTempPack(e,n){if(e.repoUrl=n,e.dddg1Path&&(e.dddg1Path=new URL(e.dddg1Path,n).toString()),e.dddg2Path&&(e.dddg2Path=new URL(e.dddg2Path,n).toString()),e.preview)for(let o=0;o<e.preview.length;++o)e.preview[o]=new URL(e.preview[o],n).toString();this.tempRepo.packs.find(o=>o.id===e.id)||this.tempRepo.packs.push(e)}};$n(Rs,"instance");$n(Rs,"setStore");$n(Rs,"$store",new Promise((t,e)=>{Rs.setStore=t}));let Lo=Rs;var ny=Object.defineProperty,oy=Object.defineProperties,sy=Object.getOwnPropertyDescriptors,Yc=Object.getOwnPropertySymbols,ry=Object.prototype.hasOwnProperty,ly=Object.prototype.propertyIsEnumerable,qc=(t,e,n)=>e in t?ny(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nl=(t,e)=>{for(var n in e||(e={}))ry.call(e,n)&&qc(t,n,e[n]);if(Yc)for(var n of Yc(e))ly.call(e,n)&&qc(t,n,e[n]);return t},iy=(t,e)=>oy(t,sy(e));function vr(t,e){return{backgrounds:ay(t.backgrounds,e.backgrounds),characters:uy(t.characters,e.characters),dependencies:bi(t.dependencies,e.dependencies),fonts:Qt(t.fonts,e.fonts,n=>n.id,(n,o)=>iy(nl({},n),{files:bi(n.files,o.files)})),poemStyles:Qt(t.poemStyles,e.poemStyles,n=>n.label,()=>{throw new Error}),poemBackgrounds:[...t.poemBackgrounds,...e.poemBackgrounds],sprites:Qt(t.sprites,e.sprites,n=>n.id,(n,o)=>{var s;return{id:n.id,label:n.label,variants:[...n.variants,...o.variants],defaultScale:n.defaultScale,hd:n.hd,sdVersion:(s=n.sdVersion)!=null?s:o.sdVersion}}),colors:Qt(t.colors,e.colors,n=>n.color,n=>n)}}function ay(t,e){return Qt(t,e,n=>n.id,cy)}function cy(t,e){var n;return{id:t.id,label:t.label,variants:[...t.variants,...e.variants],scaling:t.scaling,sdVersion:(n=t.sdVersion)!=null?n:e.sdVersion}}function uy(t,e){return Qt(t,e,n=>n.id,dy)}function dy(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:hy(t.heads,e.heads),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion,styleGroups:Qt(t.styleGroups,e.styleGroups,n=>n.id,(n,o)=>({id:n.id,styleComponents:Qt(n.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:fy(s.variants,r.variants)})),styles:Qt(n.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:Qt(s.poses,r.poses,l=>l.id,py)}))}))}}function fy(t,e){const n=nl({},t);for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(Object.prototype.hasOwnProperty.call(n,o)||(n[o]=e[o]));return n}function py(t,e){const n=nl({},t.positions);for(const o in e.positions)n[o]?n[o]=[...n[o],...e.positions[o]]:n[o]=e.positions[o];return{id:t.id,compatibleHeads:bi(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function hy(t,e){const n=nl({},t);for(const o in e){if(!Object.prototype.hasOwnProperty.call(e,o))continue;const s=e[o];if(n[o]){const r=n[o];n[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else n[o]=s}return n}function bi(t,e){const n=[...t];for(const o of e)n.includes(o)||n.push(o);return n}function Qt(t,e,n,o){const s=[...t],r=new Map(t.map((l,a)=>[n(l),a]));for(const l of e){const a=n(l);if(r.has(a)){const i=r.get(a),c=s[i];s.splice(i,1,o(c,l))}else r.set(a,s.length),s.push(l)}return s}function vy(){return qf().__VUE_DEVTOOLS_GLOBAL_HOOK__}function qf(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const gy=typeof Proxy=="function",my="devtools-plugin:setup",by="plugin:settings:set";let po,yi;function yy(){var t;return po!==void 0||(typeof window!="undefined"&&window.performance?(po=!0,yi=window.performance):typeof global!="undefined"&&(!((t=global.perf_hooks)===null||t===void 0)&&t.performance)?(po=!0,yi=global.perf_hooks.performance):po=!1),po}function _y(){return yy()?yi.now():Date.now()}class wy{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const o={};if(e.settings)for(const l in e.settings){const a=e.settings[l];o[l]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${e.id}`;let r=Object.assign({},o);try{const l=localStorage.getItem(s),a=JSON.parse(l);Object.assign(r,a)}catch(l){}this.fallbacks={getSettings(){return r},setSettings(l){try{localStorage.setItem(s,JSON.stringify(l))}catch(a){}r=l},now(){return _y()}},n&&n.on(by,(l,a)=>{l===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(l,a)=>this.target?this.target.on[a]:(...i)=>{this.onQueue.push({method:a,args:i})}}),this.proxiedTarget=new Proxy({},{get:(l,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...i)=>(this.targetQueue.push({method:a,args:i,resolve:()=>{}}),this.fallbacks[a](...i)):(...i)=>new Promise(c=>{this.targetQueue.push({method:a,args:i,resolve:c})})})}setRealTarget(e){return Xa(this,null,function*(){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(yield this.target[n.method](...n.args))})}}function Py(t,e){const n=t,o=qf(),s=vy(),r=gy&&n.enableEarlyProxy;if(s&&(o.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!r))s.emit(my,t,e);else{const l=r?new wy(n,s):null;(o.__VUE_DEVTOOLS_PLUGINS__=o.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:l}),l&&e(l.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var Gf="store";function Cy(t){return t===void 0&&(t=null),bs(t!==null?t:Gf)}function Ko(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function xy(t){return t!==null&&typeof t=="object"}function ky(t){return t&&typeof t.then=="function"}function Oy(t,e){return function(){return t(e)}}function Kf(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var o=e.indexOf(t);o>-1&&e.splice(o,1)}}function Jf(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;ol(t,n,[],t._modules.root,!0),pa(t,n,e)}function pa(t,e,n){var o=t._state,s=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var r=t._wrappedGetters,l={},a={},i=Qv(!0);i.run(function(){Ko(r,function(c,u){l[u]=Oy(c,t),a[u]=$(function(){return l[u]()}),Object.defineProperty(t.getters,u,{get:function(){return a[u].value},enumerable:!0})})}),t._state=Dn({data:e}),t._scope=i,t.strict&&Ty(t),o&&n&&t._withCommit(function(){o.data=null}),s&&s.stop()}function ol(t,e,n,o,s){var r=!n.length,l=t._modules.getNamespace(n);if(o.namespaced&&(t._modulesNamespaceMap[l],t._modulesNamespaceMap[l]=o),!r&&!s){var a=ha(e,n.slice(0,-1)),i=n[n.length-1];t._withCommit(function(){a[i]=o.state})}var c=o.context=$y(t,l,n);o.forEachMutation(function(u,f){var p=l+f;Sy(t,p,u,c)}),o.forEachAction(function(u,f){var p=u.root?f:l+f,g=u.handler||u;Iy(t,p,g,c)}),o.forEachGetter(function(u,f){var p=l+f;jy(t,p,u,c)}),o.forEachChild(function(u,f){ol(t,e,n.concat(f),u,s)})}function $y(t,e,n){var o=e==="",s={dispatch:o?t.dispatch:function(r,l,a){var i=Ar(r,l,a),c=i.payload,u=i.options,f=i.type;return(!u||!u.root)&&(f=e+f),t.dispatch(f,c)},commit:o?t.commit:function(r,l,a){var i=Ar(r,l,a),c=i.payload,u=i.options,f=i.type;(!u||!u.root)&&(f=e+f),t.commit(f,c,u)}};return Object.defineProperties(s,{getters:{get:o?function(){return t.getters}:function(){return Zf(t,e)}},state:{get:function(){return ha(t.state,n)}}}),s}function Zf(t,e){if(!t._makeLocalGettersCache[e]){var n={},o=e.length;Object.keys(t.getters).forEach(function(s){if(s.slice(0,o)===e){var r=s.slice(o);Object.defineProperty(n,r,{get:function(){return t.getters[s]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function Sy(t,e,n,o){var s=t._mutations[e]||(t._mutations[e]=[]);s.push(function(l){n.call(t,o.state,l)})}function Iy(t,e,n,o){var s=t._actions[e]||(t._actions[e]=[]);s.push(function(l){var a=n.call(t,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:t.getters,rootState:t.state},l);return ky(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(i){throw t._devtoolHook.emit("vuex:error",i),i}):a})}function jy(t,e,n,o){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(r){return n(o.state,o.getters,r.state,r.getters)})}function Ty(t){Xe(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function ha(t,e){return e.reduce(function(n,o){return n[o]},t)}function Ar(t,e,n){return xy(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var Ay="vuex bindings",Gc="vuex:mutations",Dl="vuex:actions",ho="vuex",Ey=0;function Ry(t,e){Py({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[Ay]},function(n){n.addTimelineLayer({id:Gc,label:"Vuex Mutations",color:Kc}),n.addTimelineLayer({id:Dl,label:"Vuex Actions",color:Kc}),n.addInspector({id:ho,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(o){if(o.app===t&&o.inspectorId===ho)if(o.filter){var s=[];np(s,e._modules.root,o.filter,""),o.rootNodes=s}else o.rootNodes=[tp(e._modules.root,"")]}),n.on.getInspectorState(function(o){if(o.app===t&&o.inspectorId===ho){var s=o.nodeId;Zf(e,s),o.state=Dy(Ny(e._modules,s),s==="root"?e.getters:e._makeLocalGettersCache,s)}}),n.on.editInspectorState(function(o){if(o.app===t&&o.inspectorId===ho){var s=o.nodeId,r=o.path;s!=="root"&&(r=s.split("/").filter(Boolean).concat(r)),e._withCommit(function(){o.set(e._state.data,r,o.state.value)})}}),e.subscribe(function(o,s){var r={};o.payload&&(r.payload=o.payload),r.state=s,n.notifyComponentUpdate(),n.sendInspectorTree(ho),n.sendInspectorState(ho),n.addTimelineEvent({layerId:Gc,event:{time:Date.now(),title:o.type,data:r}})}),e.subscribeAction({before:function(o,s){var r={};o.payload&&(r.payload=o.payload),o._id=Ey++,o._time=Date.now(),r.state=s,n.addTimelineEvent({layerId:Dl,event:{time:o._time,title:o.type,groupId:o._id,subtitle:"start",data:r}})},after:function(o,s){var r={},l=Date.now()-o._time;r.duration={_custom:{type:"duration",display:l+"ms",tooltip:"Action duration",value:l}},o.payload&&(r.payload=o.payload),r.state=s,n.addTimelineEvent({layerId:Dl,event:{time:Date.now(),title:o.type,groupId:o._id,subtitle:"end",data:r}})}})})}var Kc=8702998,By=6710886,My=16777215,Qf={label:"namespaced",textColor:My,backgroundColor:By};function ep(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function tp(t,e){return{id:e||"root",label:ep(e),tags:t.namespaced?[Qf]:[],children:Object.keys(t._children).map(function(n){return tp(t._children[n],e+n+"/")})}}function np(t,e,n,o){o.includes(n)&&t.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:e.namespaced?[Qf]:[]}),Object.keys(e._children).forEach(function(s){np(t,e._children[s],n,o+s+"/")})}function Dy(t,e,n){e=n==="root"?e:e[n];var o=Object.keys(e),s={state:Object.keys(t.state).map(function(l){return{key:l,editable:!0,value:t.state[l]}})};if(o.length){var r=Ly(e);s.getters=Object.keys(r).map(function(l){return{key:l.endsWith("/")?ep(l):l,editable:!1,value:_i(function(){return r[l]})}})}return s}function Ly(t){var e={};return Object.keys(t).forEach(function(n){var o=n.split("/");if(o.length>1){var s=e,r=o.pop();o.forEach(function(l){s[l]||(s[l]={_custom:{value:{},display:l,tooltip:"Module",abstract:!0}}),s=s[l]._custom.value}),s[r]=_i(function(){return t[n]})}else e[n]=_i(function(){return t[n]})}),e}function Ny(t,e){var n=e.split("/").filter(function(o){return o});return n.reduce(function(o,s,r){var l=o[s];if(!l)throw new Error('Missing module "'+s+'" for path "'+e+'".');return r===n.length-1?l:l._children},e==="root"?t:t.root._children)}function _i(t){try{return t()}catch(e){return e}}var Xt=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var o=e.state;this.state=(typeof o=="function"?o():o)||{}},op={namespaced:{configurable:!0}};op.namespaced.get=function(){return!!this._rawModule.namespaced};Xt.prototype.addChild=function(e,n){this._children[e]=n};Xt.prototype.removeChild=function(e){delete this._children[e]};Xt.prototype.getChild=function(e){return this._children[e]};Xt.prototype.hasChild=function(e){return e in this._children};Xt.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};Xt.prototype.forEachChild=function(e){Ko(this._children,e)};Xt.prototype.forEachGetter=function(e){this._rawModule.getters&&Ko(this._rawModule.getters,e)};Xt.prototype.forEachAction=function(e){this._rawModule.actions&&Ko(this._rawModule.actions,e)};Xt.prototype.forEachMutation=function(e){this._rawModule.mutations&&Ko(this._rawModule.mutations,e)};Object.defineProperties(Xt.prototype,op);var io=function(e){this.register([],e,!1)};io.prototype.get=function(e){return e.reduce(function(n,o){return n.getChild(o)},this.root)};io.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(o,s){return n=n.getChild(s),o+(n.namespaced?s+"/":"")},"")};io.prototype.update=function(e){sp([],this.root,e)};io.prototype.register=function(e,n,o){var s=this;o===void 0&&(o=!0);var r=new Xt(n,o);if(e.length===0)this.root=r;else{var l=this.get(e.slice(0,-1));l.addChild(e[e.length-1],r)}n.modules&&Ko(n.modules,function(a,i){s.register(e.concat(i),a,o)})};io.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1],s=n.getChild(o);s&&s.runtime&&n.removeChild(o)};io.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1];return n?n.hasChild(o):!1};function sp(t,e,n){if(e.update(n),n.modules)for(var o in n.modules){if(!e.getChild(o))return;sp(t.concat(o),e.getChild(o),n.modules[o])}}function Fy(t){return new Pt(t)}var Pt=function(e){var n=this;e===void 0&&(e={});var o=e.plugins;o===void 0&&(o=[]);var s=e.strict;s===void 0&&(s=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new io(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=r;var l=this,a=this,i=a.dispatch,c=a.commit;this.dispatch=function(p,g){return i.call(l,p,g)},this.commit=function(p,g,m){return c.call(l,p,g,m)},this.strict=s;var u=this._modules.root.state;ol(this,u,[],this._modules.root),pa(this,u),o.forEach(function(f){return f(n)})},va={state:{configurable:!0}};Pt.prototype.install=function(e,n){e.provide(n||Gf,this),e.config.globalProperties.$store=this;var o=this._devtools!==void 0?this._devtools:!1;o&&Ry(e,this)};va.state.get=function(){return this._state.data};va.state.set=function(t){};Pt.prototype.commit=function(e,n,o){var s=this,r=Ar(e,n,o),l=r.type,a=r.payload,i={type:l,payload:a},c=this._mutations[l];c&&(this._withCommit(function(){c.forEach(function(f){f(a)})}),this._subscribers.slice().forEach(function(u){return u(i,s.state)}))};Pt.prototype.dispatch=function(e,n){var o=this,s=Ar(e,n),r=s.type,l=s.payload,a={type:r,payload:l},i=this._actions[r];if(i){try{this._actionSubscribers.slice().filter(function(u){return u.before}).forEach(function(u){return u.before(a,o.state)})}catch(u){}var c=i.length>1?Promise.all(i.map(function(u){return u(l)})):i[0](l);return new Promise(function(u,f){c.then(function(p){try{o._actionSubscribers.filter(function(g){return g.after}).forEach(function(g){return g.after(a,o.state)})}catch(g){}u(p)},function(p){try{o._actionSubscribers.filter(function(g){return g.error}).forEach(function(g){return g.error(a,o.state,p)})}catch(g){}f(p)})})}};Pt.prototype.subscribe=function(e,n){return Kf(e,this._subscribers,n)};Pt.prototype.subscribeAction=function(e,n){var o=typeof e=="function"?{before:e}:e;return Kf(o,this._actionSubscribers,n)};Pt.prototype.watch=function(e,n,o){var s=this;return Xe(function(){return e(s.state,s.getters)},n,Object.assign({},o))};Pt.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};Pt.prototype.registerModule=function(e,n,o){o===void 0&&(o={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),ol(this,this.state,e,this._modules.get(e),o.preserveState),pa(this,this.state)};Pt.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var o=ha(n.state,e.slice(0,-1));delete o[e[e.length-1]]}),Jf(this)};Pt.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Pt.prototype.hotUpdate=function(e){this._modules.update(e),Jf(this,!0)};Pt.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(Pt.prototype,va);var tt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Bs={},Ge={},Rn={},Er=tt&&tt.__assign||function(){return Er=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Er.apply(this,arguments)},rp=tt&&tt.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Hy=tt&&tt.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},Uy=tt&&tt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Hy(arguments[e]));return t};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.mapObject=lp=Rn.assetWalker=wi=Rn.normalizePath=void 0;var Vy=10;function Wy(t,e,n,o){for(var s,r,l="",a=0,i=new Map(Array.from(e.entries()).map(function(p){return[new RegExp("{"+p[0]+"}","g"),p[1]]}));l!==t;){if(l=t,++a>Vy)throw new Error("Maximum replacement recursion exceeded!");try{for(var c=(s=void 0,rp(i.entries())),u=c.next();!u.done;u=c.next()){var f=u.value;t=t.replace(f[0],f[1])}}catch(p){s={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(s)throw s.error}}t=t.replace(/{format(:.*?:.*?)+}/gi,function(p){p=p.slice(8,-1);for(var g=p.split(":"),m=0;m<g.length;m+=2)if(n.has(g[m]))return g[m+1];return""}),t=t.replace(/{lq:(.*?):(.*?)}/gi,function(p){return p.slice(4,-1).split(":")[o?0:1]})}return t}var wi=Rn.normalizePath=Wy;function zy(t,e){return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies,characters:t.characters.map(function(n){return Xy(n,e)}),backgrounds:t.backgrounds.map(function(n){return e_(n,e)}),fonts:t.fonts.map(function(n){return t_(n,e)}),poemStyles:Uy(t.poemStyles),poemBackgrounds:t.poemBackgrounds.map(function(n){return n_(n,e)}),sprites:t.sprites.map(function(n){return o_(n,e)}),colors:t.colors}}var lp=Rn.assetWalker=zy;function Xy(t,e){return{id:t.id,label:t.label,chibi:t.chibi?e(t.chibi,"image"):void 0,heads:Zy(t.heads,e),styleGroups:t.styleGroups.map(function(n){return Yy(n,e)}),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion}}function Yy(t,e){return{id:t.id,styleComponents:t.styleComponents.map(function(n){return Gy(n,e)}),styles:t.styles.map(function(n){return qy(n,e)})}}function qy(t,e){return{components:t.components,poses:t.poses.map(function(n){return Jy(n,e)})}}function Gy(t,e){return Er(Er({},t),{variants:Ky(t.variants,e)})}function Ky(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],"image"));return n}function Jy(t,e){var n,o,s={};try{for(var r=rp(Object.keys(t.positions)),l=r.next();!l.done;l=r.next()){var a=l.value,i=t.positions[a];s[a]=i.map(function(c){return c.map(function(u){return e(u,"image")})})}}catch(c){n={error:c}}finally{try{l&&!l.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return{compatibleHeads:t.compatibleHeads,id:t.id,previewOffset:t.previewOffset,previewSize:t.previewSize,renderCommands:t.renderCommands.map(function(c){return c.type==="image"?{type:"image",offset:c.offset,images:c.images.map(function(u){return e(u,"image")})}:c}),size:t.size,scale:t.scale,positions:s}}function Zy(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=Qy(t[o],e));return n}function Qy(t,e){return{previewOffset:t.previewOffset,previewSize:t.previewSize,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})})}}function e_(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),scaling:t.scaling,sdVersion:t.sdVersion}}function t_(t,e){return{id:t.id,label:t.label,files:t.files.map(function(n){return e(n,"font")})}}function n_(t,e){return{id:t.id,fontColor:t.fontColor,label:t.label,images:t.images.map(function(n){return e(n,"image")}),sdVersion:t.sdVersion}}function o_(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),defaultScale:t.defaultScale,hd:t.hd,sdVersion:t.sdVersion}}function s_(t,e){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o],o));return n}Rn.mapObject=s_;var Rr=tt&&tt.__assign||function(){return Rr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Rr.apply(this,arguments)};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.expandId=Ge.normalizeStyleComponent=Ge.normalizeColor=Ge.normalizeBackground=Ge.normalizeFont=Ge.normalizePoemBackground=Ge.normalizePoemStyles=Ge.normalizeSprite=Ge.mapNormalize=ip=Ge.normalizeContentPack=void 0;var r_=Rn;function l_(t,e){var n={paths:e,packId:t.packId},o=bt("",t.folder||"/",n);return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies||[],characters:Gt(i_,t.characters,o,n),backgrounds:Gt(fp,t.backgrounds,o,n),fonts:Gt(dp,t.fonts,o,n),poemStyles:Gt(cp,t.poemStyles,o,n),poemBackgrounds:Gt(up,t.poemBackgrounds,o,n),sprites:Gt(ap,t.sprites,o,n),colors:Gt(pp,t.colors,o,n)}}var ip=Ge.normalizeContentPack=l_;function Gt(t,e,n,o){return e?e.map(function(s){return t(s,n,o)}):[]}Ge.mapNormalize=Gt;function ap(t,e,n){var o,s=bt(e,t.folder,n);return{id:zt(n.packId,t.id),label:t.label||t.variants[0][0],variants:t.variants.map(function(r){return sl(r,s,n)}),defaultScale:t.defaultScale||[1,1],sdVersion:t.sdVersion,hd:(o=t.hd)!==null&&o!==void 0?o:null}}Ge.normalizeSprite=ap;function cp(t){return{label:t.label,defaultFont:t.defaultFont||"Aller",fontSize:t.fontSize!==void 0?t.fontSize:30,letterSpacing:t.letterSpacing!==void 0?t.letterSpacing:1,lineSpacing:t.lineSpacing!==void 0?t.lineSpacing:1.2}}Ge.normalizePoemStyles=cp;function up(t,e,n){var o=bt(e,t.folder,n);return{id:t.id,label:t.label,images:sl(t.images,o,n),fontColor:t.fontColor||"black",sdVersion:t.sdVersion}}Ge.normalizePoemBackground=up;function dp(t,e,n){var o=bt(e,t.folder,n);return{id:zt(n.packId,t.id?t.id:t.label?t.label:t.files[0]),label:t.label?t.label:t.id?t.id:t.files[0],files:sl(t.files,o,n)}}Ge.normalizeFont=dp;function fp(t,e,n){var o,s=bt(e,t.folder,n);return{id:zt(n.packId,t.id),label:t.label?t.label:t.variants[0][0],variants:t.variants.map(function(r){return sl(r,s,n)}),scaling:["none","strech","cover"].includes((o=t.scaling)===null||o===void 0?void 0:o.toLowerCase())?t.scaling.toLowerCase():"cover",sdVersion:t.sdVersion}}Ge.normalizeBackground=fp;function pp(t){return{label:t.label||t.color,color:t.color}}Ge.normalizeColor=pp;function sl(t,e,n){return t.map(function(o){return bt(e,o,n)})}function i_(t,e,n){var o,s,r,l=bt(e,t.folder,n);return{id:zt(n.packId,t.id),label:t.label,chibi:t.chibi?bt(l,t.chibi,n):void 0,heads:d_(t.heads,l,n),defaultScale:(o=t.defaultScale)!==null&&o!==void 0?o:[.8,.8],size:(s=t.size)!==null&&s!==void 0?s:[960,960],hd:(r=t.hd)!==null&&r!==void 0?r:!1,sdVersion:t.sdVersion,styleGroups:Gt(a_,t.styleGroups,l,n)}}function a_(t,e,n){var o=bt(e,t.folder,n);return{id:zt(n.packId,t.id),styleComponents:Gt(hp,t.styleComponents,o,n),styles:t.styles.map(function(s){return c_(s,o,n)})}}function c_(t,e,n){var o=bt(e,t.folder,n),s={};if(t.components)for(var r in t.components)t.components.hasOwnProperty(r)&&(s[zt(n.packId,r)]=t.components[r]);return{components:s,poses:t.poses.map(function(l){return f_(l,o,n)})}}function hp(t,e,n){return{id:zt(n.packId,t.id),label:t.label,variants:u_(t.variants,e,n)}}Ge.normalizeStyleComponent=hp;function u_(t,e,n){if(!t)return{};var o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=bt(e,t[s],n));return o}function d_(t,e,n){var o={};if(!t)return o;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={variants:Pi(r,e,n),previewOffset:[290,70],previewSize:[380,380]};else{var a=bt(e,r.folder,n);l={variants:Pi(r.variants,a,n),previewOffset:r.previewOffset||[290,70],previewSize:r.previewSize||[380,380]}}o[zt(n.packId,s)]=l}return o}function f_(t,e,n){var o,s,r=bt(e,t.folder,n);return{compatibleHeads:((o=t.compatibleHeads)===null||o===void 0?void 0:o.map(function(l){return zt(n.packId,l)}))||[],id:zt(n.packId,t.id),previewOffset:t.previewOffset||[0,0],previewSize:t.previewSize||[960,960],size:t.size||[960,960],scale:t.scale||.8,positions:r_.mapObject(t.positions||{},function(l){return Pi(l,r,n)}),renderCommands:((s=t.renderCommands)===null||s===void 0?void 0:s.map(function(l){return p_(l,e,n)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function p_(t,e,n){if(t.type==="image"){var o=bt(e,t.folder,n);return{type:"image",composite:t.composite,offset:t.offset||[0,0],images:vp(t.images,o,n)}}else return Rr(Rr({},t),{offset:t.offset||[0,0]})}function Pi(t,e,n){return t.map(function(o){return vp(o,e,n)})}function vp(t,e,n){return t.map(function(o){return bt(e,o,n)})}function h_(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function bt(t,e,n){if(!e)return t;for(var o in n.paths)if(e.startsWith(o))return n.paths[o]+e.slice(o.length);return h_(e)?e:t+e}function zt(t,e){return e.indexOf(":")!==-1?e:t+":"+e}Ge.expandId=zt;var gr=tt&&tt.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},v_=tt&&tt.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},Ll=tt&&tt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v_(arguments[e]));return t};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.expandOrTranslateId=gp=Bs.convert=void 0;var Ci=Ge;function g_(t,e,n){if(!t.packId)throw new Error("");return{packId:t.packId,packCredits:t.packCredits?[t.packCredits]:[],dependencies:m_(t.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[b_(t,e,n)],colors:[]}}var gp=Bs.convert=g_,mp={"ddlc.monika":qt("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":qt("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":qt("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":qt("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":qt("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":qt("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":qt("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":qt("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":qt("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":qt("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function m_(t){return[]}function b_(t,e,n){var o={characterId:t.id,packId:t.packId,paths:e};return{id:Nn("character",t.id,o),chibi:t.chibi,label:t.name,heads:C_(t.heads,o,n),styleGroups:y_(t,o,n),defaultScale:[.8,.8],size:[960,960],hd:!1}}function y_(t,e,n){var o,s,r=mp[e.characterId],l=[],a=new Map,i=x_(t,e),c=i.length===0?r&&r.defaultStyleComponents?__(r.defaultStyleComponents,e):[]:i,u=t.poses.map(function(P){return P.style}).filter(function(P,O,h){return h.indexOf(P)===O}),f=new Map(t.styles.map(function(P){return[P.name,P]})),p=function(P){var O,h,v,_,j=f.get(P);if(j&&j.nsfw&&!n)return"continue";var S=P,T={};try{for(var R=(O=void 0,gr(c)),D=R.next();!D.done;D=R.next()){var F=D.value;try{for(var K=(v=void 0,gr(Object.keys(F.variants))),Q=K.next();!Q.done;Q=K.next()){var fe=Q.value,we=new RegExp("-"+fe+"\\b");if(S.match(we)){T[F.id]=fe,S=S.replace(we,"");break}}}catch(U){v={error:U}}finally{try{Q&&!Q.done&&(_=K.return)&&_.call(K)}finally{if(v)throw v.error}}}}catch(U){O={error:U}}finally{try{D&&!D.done&&(h=R.return)&&h.call(R)}finally{if(O)throw O.error}}S=Nn("styleGroups",S,e);var Be=a.get(S);Be||(Be={id:S,styleComponents:c,styles:[]},a.set(S,Be),l.push(S)),Be.styles.push({components:T,poses:P_(t.poses.filter(function(U){return U.style===P}),e,n)})};try{for(var g=gr(u),m=g.next();!m.done;m=g.next()){var b=m.value;p(b)}}catch(P){o={error:P}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}return l.map(function(P){return a.get(P)})}function __(t,e){return Ci.mapNormalize(Ci.normalizeStyleComponent,t,"",{packId:e.packId,paths:e.paths})}function w_(t,e){return t?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:e}]:[{type:"head",offset:e},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function P_(t,e,n){return t.map(function(o){return{compatibleHeads:o.compatibleHeads.map(function(s){return Nn("heads",s.toString(),e)}),id:Nn("poses",o.name,e),renderCommands:w_(o.headInForeground,o.headAnchor),previewOffset:o.offset,previewSize:o.size,size:[960,960],scale:.8,positions:{Static:"static"in o?[[o.static]]:[],Left:"left"in o?Nl(o.left,n):[],Right:"right"in o?Nl(o.right,n):[],Variant:"variant"in o?Nl(o.variant,n):[]}}})}function Nl(t,e){return t.filter(function(n){return!n.nsfw||e}).map(function(n){return[n.img]})}function C_(t,e,n){var o,s,r={};try{for(var l=gr(Object.keys(t)),a=l.next();!a.done;a=l.next()){var i=a.value,c=t[i];c.nsfw&&!n||(r[Nn("heads",i,e)]={previewOffset:c.offset,previewSize:c.size,variants:c.all.filter(function(u){return!u.nsfw||n}).map(function(u){return[u.img]})})}}catch(u){o={error:u}}finally{try{a&&!a.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}return r}function x_(t,e){var n=[],o=[];return Object.keys(t.eyes).length>0&&(Object.keys(t.eyes).forEach(function(s){return o.push(s)}),n.push({label:"Eyes",id:Nn("eyes","eyes",e),variants:t.eyes})),Object.keys(t.hairs).length>0&&(Object.keys(t.hairs).forEach(function(s){return o.push(s)}),n.push({label:"Hairs",id:Nn("hairs","hairs",e),variants:t.hairs})),n}function Fl(t,e){return new Map(e.map(function(n){return[n,t+":"+n]}))}function qt(t,e,n){return n.extraHeadAssoc?n.extraHeadAssoc=n.extraHeadAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraHeadAssoc=[],n.extraPoseAssoc?n.extraPoseAssoc=n.extraPoseAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraPoseAssoc=[],n.extraStyleGroupAssoc?n.extraStyleGroupAssoc=n.extraStyleGroupAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraStyleGroupAssoc=[],{character:t+":"+e,eyes:t+":eyes",hairs:t+":hair",defaultStyleComponents:n.defaultStyleComponents||[],heads:new Map(Ll(Fl(t,n.heads),n.extraHeadAssoc)),poses:new Map(Ll(Fl(t,n.poses),n.extraPoseAssoc)),styleGroups:new Map(Ll(Fl(t,n.styleGroups),n.extraStyleGroupAssoc))}}function Nn(t,e,n){var o=mp[n.characterId];if(o){if(t==="character"||t==="hairs"||t==="eyes")return o[t];var s=o[t].get(e);if(s)return s}return Ci.expandId(n.packId,e)}Bs.expandOrTranslateId=Nn;var ga={};Object.defineProperty(ga,"__esModule",{value:!0});var bp=ga.normalizeCharacter=void 0;function k_(t,e){var n=Fn("",t.folder||"/",e),o=void 0;return t.chibi&&(o=Fn(n,t.chibi,e)),o===void 0&&t.internalId&&(o=(e["/"]||"")+"chibis/"+t.internalId),{id:t.id,packId:t.packId,packCredits:t.packCredits,name:t.name,nsfw:!!t.nsfw,chibi:o,eyes:Jc(t.eyes,n,e),hairs:Jc(t.hairs,n,e),styles:S_(t.styles),heads:O_(t.heads,n,e),poses:$_(t.poses,n,e)}}bp=ga.normalizeCharacter=k_;function Jc(t,e,n){if(!t)return{};var o={};for(var s in t)t.hasOwnProperty(s)&&(o[s]=Fn(e,t[s],n));return o}function O_(t,e,n){var o={};if(!t)return o;for(var s in t)if(t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={all:ws(r,e,n),nsfw:!1,offset:[290,70],size:[380,380]};else{var a=Fn(e,r.folder,n);l={all:ws(r.all,a,n),nsfw:!!r.nsfw,offset:r.offset||[290,70],size:r.size||[380,380]}}o[s]=l}return o}function $_(t,e,n){return t?t.map(function(o){var s=Fn(e,o.folder,n),r={compatibleHeads:o.compatibleHeads||[],headAnchor:o.headAnchor||[0,0],headInForeground:!!o.headInForeground,name:o.name,nsfw:!!o.nsfw,style:o.style,offset:[0,0],size:[960,960]};if("static"in o)r.static=Fn(s,o.static,n);else if("variant"in o)r.variant=ws(o.variant,s,n);else if("left"in o)r.left=ws(o.left,s,n),r.right=ws(o.right,s,n);else throw new Error("Invalid pose");return r}):[]}function ws(t,e,n){return t.map(function(o){return typeof o=="string"?{img:Fn(e,o,n),nsfw:!1}:{img:Fn(e,o.img,n),nsfw:o.nsfw||!1}})}function S_(t){return t?t.map(function(e){return{name:e.name,label:e.label,nsfw:e.nsfw||!1}}):[]}function I_(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function Fn(t,e,n){if(!e)return t;for(var o in n)if(e.startsWith(o))return n[o]+e.slice(o.length);return I_(e)?e:t+e}var Ps=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function j_(t){return t.split("/").slice(0,-1).join("/")+"/"}const Zc=new Set(["png","gif","bmp","svg"]);function yp(){return{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}}}const T_={namespaced:!0,state:yp(),mutations:{setContentPacks(t,e){t.contentPacks=e},setCurrentContent(t,e){t.current=e}},actions:{removeContentPacks({commit:t,state:e,dispatch:n},o){const s=JSON.parse(JSON.stringify(e.current)),r=e.contentPacks.filter(l=>!o.has(l.packId));t("setContentPacks",r),t("setCurrentContent",r.reduce((l,a)=>vr(l,a))),n("panels/fixContentPackRemoval",s,{root:!0})},replaceContentPack(t,e){return Ps(this,arguments,function*({commit:n,state:o},s){const r=s.processed?s.contentPack:yield Br(s.contentPack);let l=o.contentPacks;const a=l.findIndex(i=>i.packId===s.contentPack.packId);a===-1?l.push(r):l.splice(a,1,r),l=l,n("setContentPacks",l),n("setCurrentContent",l.reduce((i,c)=>vr(i,c)))})},loadContentPacks(t,e){return Ps(this,arguments,function*({commit:n,state:o},s){typeof s=="string"&&(s=[s]);const r=yield Promise.all(s.map(c=>Ps(this,null,function*(){return yield xi(c)}))),l=yield Promise.all(r.map(c=>Br(c))),a=new Set(o.contentPacks.map(c=>c.packId));let i=o.current;for(const c of l){for(const u of c.dependencies)if(!a.has(u))throw new Error(`Missing dependency '${u}'. Refusing to install ${c.packId}`);i=vr(i,c)}return n("setContentPacks",[...o.contentPacks,...l]),n("setCurrentContent",i),r.map(c=>c.packId)})}},getters:{getCharacters({current:t}){const e=new Map;for(const n of t.characters)e.set(n.id,n);return e},getBackgrounds({current:t}){const e=new Map;for(const n of t.backgrounds)e.set(n.id,n);return e}}};function xi(t){return Ps(this,null,function*(){const e=yield fetch(t);if(!e.ok)throw new Error(`Could not load content pack. Server responded with: ${e.statusText}`);let n;try{n=yield e.json()}catch(o){throw new Error("Content pack is not valid json!")}try{const o={"./":j_(t),"/":ca};return n.version==="2.0"?ip(n,o):gp(bp(n,o),o,!1)}catch(o){throw new Error("Content pack is not in a valid format!")}})}function Br(t){return Ps(this,null,function*(){const e=new Set((yield Mo())?["webp",...Zc]:Zc),n=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return lp(t,(o,s)=>{var r;const l=wi(o,n,e,!1),a=wi(o,n,e,!0);return{hq:l,lq:a,sourcePack:(r=t.packId)!=null?r:"buildIn"}})})}const rl=1280,ma=720,A_=128,E_=32,R_="rgba(60,60,60,0.8)",B_=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],_p=1,M_=1/1.5,D_=-74,L_=358,N_=[200,240,400,493,640,786,880,1040,1080],F_=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:L_,CloseUpYOffset:D_,WheelBackground:R_,characterPositions:N_,hdCharacterScaleFactor:M_,positions:B_,screenHeight:ma,screenWidth:rl,sdCharacterScaleFactor:_p,wheelInnerRadius:A_,wheelWidth:E_},Symbol.toStringTag,{value:"Module"}));var H_=Object.defineProperty,U_=(t,e,n)=>e in t?H_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ll=(t,e,n)=>(U_(t,typeof e!="symbol"?e+"":e,n),n);const Ls=class yo{constructor(e,n,o,s){this.r=e,this.g=n,this.b=o,this.a=s,Object.freeze(this)}static validCss(e){return this.validCssRgb(e)||this.validHex(e)}static fromCss(e){if(this.validCssRgb(e))return this.fromCssRgb(e);if(this.validHex(e))return this.fromHex(e);throw new Error("Invalid RGB color format")}static validCssRgb(e){return this.rgbEx.test(e)||this.rgbaEx.test(e)}static fromCssRgb(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");const n=e.slice(0,-1),o=n.indexOf("("),r=n.slice(o+1).split(",").map(l=>parseFloat(l.trim()));return new yo(r[0],r[1],r[2],r.length===4?r[3]:1)}static validHex(e){return this.hexShortEx.test(e)||this.hexLongEx.test(e)}static fromHex(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");const n=e.slice(1);if(n.length===3)return new yo(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(n.length===4)return new yo(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(n.length===6)return new yo(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(n.length===8)return new yo(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:e,g:n,b:o}=this;const{a:s}=this;e/=255,n/=255,o/=255;const r=Math.max(e,n,o),l=Math.min(e,n,o);let a,i;const c=(r+l)/2;if(r===l)a=i=0;else{const u=r-l;switch(i=c>.5?u/(2-r-l):u/(r+l),r){case e:a=(n-o)/u+(n<o?6:0);break;case n:a=(o-e)/u+2;break;case o:a=(e-n)/u+4;break}a/=6}return new Fe(a,i,c,s)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};ll(Ls,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i);ll(Ls,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i);ll(Ls,"hexShortEx",/^#[0-9A-F]{3,4}$/i);ll(Ls,"hexLongEx",/^#[0-9A-F]{6,8}$/i);let Ne=Ls;class Fe{constructor(e,n,o,s){this.h=e,this.s=n,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(e){let{h:n,s:o,l:s,a:r}=this;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),o+e.s>1?o-=e.s:(o+=e.s,o<0&&(o=0)),s+e.l>1||s+e.l<0?s-=e.l:s+=e.l,r+e.a>1||r+e.a<0?r-=e.a:r+=e.a,new Fe(n,o,s,r)}toRgb(){const{h:e,s:n,l:o,a:s}=this;let r,l,a;if(n===0)r=l=a=o;else{const i=o<.5?o*(1+n):o+n-o*n,c=2*o-i;r=Fe.hue2rgb(c,i,e+1/3),l=Fe.hue2rgb(c,i,e),a=Fe.hue2rgb(c,i,e-1/3)}return new Ne(Math.round(r*255),Math.round(l*255),Math.round(a*255),s)}toHSL(){return this}static hue2rgb(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}}const V_=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),W_="#ffe6f4",z_="#ffbde1",X_=420,Y_=22,q_=640,wp=270,G_=7,Pp=3,K_=Math.ceil(Pp/2),J_=(ma-wp)/2,Z_={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Q_=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:z_,ChoiceButtonColor:W_,ChoiceButtonWidth:X_,ChoiceOuterPadding:K_,ChoicePadding:G_,ChoiceSpacing:Y_,ChoiceTextStyle:Z_,ChoiceX:q_,ChoiceY:J_,ChoiceYOffset:wp,Outline:Pp,nameboxTextOutlineDelta:V_},Symbol.toStringTag,{value:"Module"})),Cp="#ffa8d2",e0="#552222",t0="#ffeef6",ba="#bb5599",xp=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),kp=new Fe(.002028397565922768,0,.13725490196078438,0),Op=.82,$p=new Fe(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Sp=12,n0=1.5,ki=12,rn=1.5,o0=.6,s0=new Fe(.08045977011494243,-.5714285714285714,-.5960784313725489,0),r0=new Fe(0,-.14285714285714296,.3,0),l0=new Fe(.004269293924466178,-.01869158878504662,-.039215686274509665,0),i0=9.5,a0=47,Ip=new Fe(.0023347701149424305,0,.10784313725490202,0),jp=3,Tp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:s0,controlDisableColorDelta:r0,controlsDefaultColor:e0,dotColorDelta:l0,dotPatternSize:a0,dotRadius:i0,nameColorThreshold:o0,nameboxBackgroundDelta:kp,nameboxDefaultColor:t0,nameboxGradientEndDelta:$p,nameboxGradientMiddleStopPosition:Op,nameboxRounding:Sp,nameboxRoundingBuffer:n0,nameboxStrokeDefaultColor:ba,nameboxTextOutlineDelta:xp,textboxDefaultColor:Cp,textboxOutlineColorDelta:Ip,textboxOutlineWidth:jp,textboxRounding:ki,textboxRoundingBuffer:rn},Symbol.toStringTag,{value:"Module"}));var c0=Object.defineProperty,u0=Object.defineProperties,d0=Object.getOwnPropertyDescriptors,Qc=Object.getOwnPropertySymbols,f0=Object.prototype.hasOwnProperty,p0=Object.prototype.propertyIsEnumerable,eu=(t,e,n)=>e in t?c0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ap=(t,e)=>{for(var n in e||(e={}))f0.call(e,n)&&eu(t,n,e[n]);if(Qc)for(var n of Qc(e))p0.call(e,n)&&eu(t,n,e[n]);return t},Ep=(t,e)=>u0(t,d0(e));const Jo=816,ya=900,il=146,h0=0,v0=29,g0=8,Ns=38,al=44,m0=6,b0=93,y0=404,_0=9,w0=9,so=39,Fs=168,Hs=34,cl=29,_a=12,wa=-126,Pa=-72,Ca=-38,xa=30.75,ka=26,Rp=426,Oi=58,Oa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},ul=Ep(Ap({},Oa),{fontName:"riffic",fontSize:24,strokeColor:ba,strokeWidth:6,color:"white",letterSpacing:1}),$a={align:"left",font:"13px aller",fill:{style:"#522"}},Bp=Ep(Ap({},$a),{fill:{style:"#a66"}}),P0={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Sa={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},Zo=rl/2-Jo/2,C0=rl/2-ya/2,x0=Zo+Ns,Mp=Zo+Hs,k0=Mp+Fs/2,O0=Zo+wa,$0=Zo+Pa,S0=Zo+Ca,I0="normal",j0=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:xa,ArrowYBottomOffset:ka,BaseTextStyle:Oa,ControlsTextDisabledStyle:Bp,ControlsTextStyle:$a,ControlsXHistory:O0,ControlsXHistoryOffset:wa,ControlsXSkip:$0,ControlsXSkipOffset:Pa,ControlsXStuff:S0,ControlsXStuffOffset:Ca,ControlsYBottomOffset:_a,DefaultTextboxStyle:I0,GlowRX:Rp,GlowRY:Oi,HdSideMargin:y0,HdSpacing:b0,NameboxHeight:so,NameboxTextStyle:ul,NameboxTextX:k0,NameboxTextYOffset:cl,NameboxWidth:Fs,NameboxX:Mp,NameboxXOffset:Hs,TextBoxBottomSpacing:m0,TextBoxCorruptedKerning:g0,TextBoxCorruptedStyle:P0,TextBoxCorruptedWidth:ya,TextBoxCorruptedX:C0,TextBoxHeight:il,TextBoxKerning:h0,TextBoxLineHeight:v0,TextBoxStyle:Sa,TextBoxTextCorruptedXOffset:_0,TextBoxTextCorruptedYOffset:w0,TextBoxTextX:x0,TextBoxTextXOffset:Ns,TextBoxTextYOffset:al,TextBoxWidth:Jo,TextBoxX:Zo},Symbol.toStringTag,{value:"Module"}));var T0=Object.defineProperty,A0=Object.defineProperties,E0=Object.getOwnPropertyDescriptors,tu=Object.getOwnPropertySymbols,R0=Object.prototype.hasOwnProperty,B0=Object.prototype.propertyIsEnumerable,nu=(t,e,n)=>e in t?T0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,M0=(t,e)=>{for(var n in e||(e={}))R0.call(e,n)&&nu(t,n,e[n]);if(tu)for(var n of tu(e))B0.call(e,n)&&nu(t,n,e[n]);return t},D0=(t,e)=>A0(t,E0(e));const L0="#ffe6f4",N0="#ffbde1",F0="rgba(255,255,255,0.6)",H0=40,U0=30,V0=D0(M0({},Oa),{fontName:"riffic",fontSize:24,strokeColor:ba,strokeWidth:8,letterSpacing:1,color:"white"}),W0={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},z0=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:F0,NotificationBackgroundColor:L0,NotificationBorderColor:N0,NotificationOkTextStyle:V0,NotificationPadding:H0,NotificationSpacing:U0,NotificationTextStyle:W0},Symbol.toStringTag,{value:"Module"}));var X0=Object.defineProperty,Y0=Object.defineProperties,q0=Object.getOwnPropertyDescriptors,ou=Object.getOwnPropertySymbols,G0=Object.prototype.hasOwnProperty,K0=Object.prototype.propertyIsEnumerable,su=(t,e,n)=>e in t?X0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gn=(t,e)=>{for(var n in e||(e={}))G0.call(e,n)&&su(t,n,e[n]);if(ou)for(var n of ou(e))K0.call(e,n)&&su(t,n,e[n]);return t},mn=(t,e)=>Y0(t,q0(e));const Dp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],J0=0,Z0=0,Q0=rl/2,ew=ma/2,tw=33,nw=100,ow=30,sw=800,rw=720,lw=_p,iw="#333333bf",aw=480,cw=180,uw=3,dw=7,bn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Lp=[mn(gn({},bn),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),mn(gn({},bn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),mn(gn({},bn),{name:"Monika",fontName:"journal",fontSize:34}),mn(gn({},bn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),mn(gn({},bn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),mn(gn({},bn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),mn(gn({},bn),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),mn(gn({},bn),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],fw=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:lw,consoleBackgroundColor:iw,consoleHeight:cw,consoleWidth:aw,defaultConsoleBackground:uw,defaultConsoleStyle:dw,defaultPoemBackground:J0,defaultPoemHeight:rw,defaultPoemStyle:Z0,defaultPoemWidth:sw,defaultX:Q0,defaultY:ew,poemBackgrounds:Dp,poemBottomPadding:nw,poemPadding:ow,poemTextStyles:Lp,poemTopPadding:tw},Symbol.toStringTag,{value:"Module"})),pw={Base:F_,Choices:Q_,Notification:z0,Poem:fw,TextBox:j0,TextBoxCustom:Tp},dl=1920,Ia=1080,hw=128,vw=32,gw="rgba(60,60,60,0.8)",mw=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Np=1.5,bw=1,yw=-111,_w=537,ww=[300,360,600,740,960,1180,1320,1560,1620],Pw=Object.freeze(Object.defineProperty({__proto__:null,BaseCharacterYPos:_w,CloseUpYOffset:yw,WheelBackground:gw,characterPositions:ww,hdCharacterScaleFactor:bw,positions:mw,screenHeight:Ia,screenWidth:dl,sdCharacterScaleFactor:Np,wheelInnerRadius:hw,wheelWidth:vw},Symbol.toStringTag,{value:"Module"})),Cw=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),xw="#ffe6f4",kw="#ffbde1",Ow=630,$w=33,Sw=960,Fp=405,Iw=10.5,Hp=4.5,jw=Math.ceil(Hp/2),Tw=(Ia-Fp)/2,Aw={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},Ew=Object.freeze(Object.defineProperty({__proto__:null,ChoiceButtonBorderColor:kw,ChoiceButtonColor:xw,ChoiceButtonWidth:Ow,ChoiceOuterPadding:jw,ChoicePadding:Iw,ChoiceSpacing:$w,ChoiceTextStyle:Aw,ChoiceX:Sw,ChoiceY:Tw,ChoiceYOffset:Fp,Outline:Hp,nameboxTextOutlineDelta:Cw},Symbol.toStringTag,{value:"Module"})),Up="#ffa8d2",Rw="#552222",Bw="#ffeef6",ja="#bb5599",Vp=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Wp=new Fe(.002028397565922768,0,.13725490196078438,0),zp=.82,Xp=new Fe(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Yp=15,Mw=1.5,$i=19,Xn=1.5,Dw=.6,Lw=new Fe(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Nw=new Fe(0,-.14285714285714296,.3,0),Fw=new Fe(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Hw=9.5*1.5,Uw=47*1.5,qp=new Fe(.0023347701149424305,0,.10784313725490202,0),Gp=5,Kp=Object.freeze(Object.defineProperty({__proto__:null,controlColorDelta:Lw,controlDisableColorDelta:Nw,controlsDefaultColor:Rw,dotColorDelta:Fw,dotPatternSize:Uw,dotRadius:Hw,nameColorThreshold:Dw,nameboxBackgroundDelta:Wp,nameboxDefaultColor:Bw,nameboxGradientEndDelta:Xp,nameboxGradientMiddleStopPosition:zp,nameboxRounding:Yp,nameboxRoundingBuffer:Mw,nameboxStrokeDefaultColor:ja,nameboxTextOutlineDelta:Vp,textboxDefaultColor:Up,textboxOutlineColorDelta:qp,textboxOutlineWidth:Gp,textboxRounding:$i,textboxRoundingBuffer:Xn},Symbol.toStringTag,{value:"Module"}));var Vw=Object.defineProperty,Ww=Object.defineProperties,zw=Object.getOwnPropertyDescriptors,ru=Object.getOwnPropertySymbols,Xw=Object.prototype.hasOwnProperty,Yw=Object.prototype.propertyIsEnumerable,lu=(t,e,n)=>e in t?Vw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jp=(t,e)=>{for(var n in e||(e={}))Xw.call(e,n)&&lu(t,n,e[n]);if(ru)for(var n of ru(e))Yw.call(e,n)&&lu(t,n,e[n]);return t},Zp=(t,e)=>Ww(t,zw(e));const Ta=1220,Qp=900,eh=219,qw=0,Gw=29,Kw=8,Aa=57,th=68,Jw=54,Zw=9,Qw=9,Ea=59,Ra=252,Ba=49,nh=43,oh=12*1.5,sh=-126*1.5,rh=-72*1.5,lh=-38*1.5,ih=30.75*1.5,ah=26*1.5,ch=426*1.5,Si=58*1.5,Ma={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},uh=Zp(Jp({},Ma),{fontName:"riffic",fontSize:36,strokeColor:ja,strokeWidth:9,color:"white",letterSpacing:2}),Mr={align:"left",font:"24px aller",fill:{style:"#522"}},dh=Zp(Jp({},Mr),{fill:{style:"#a66"}}),fh={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},e1={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Qo=dl/2-Ta/2,t1=dl/2-Qp/2,n1=Qo+Aa,ph=Qo+Ba,o1=ph+Ra/2,s1=Qo+sh,r1=Qo+rh,l1=Qo+lh,i1="custom_plus",a1=Object.freeze(Object.defineProperty({__proto__:null,ArrowXRightOffset:ih,ArrowYBottomOffset:ah,BaseTextStyle:Ma,ControlsTextDisabledStyle:dh,ControlsTextStyle:Mr,ControlsXHistory:s1,ControlsXHistoryOffset:sh,ControlsXSkip:r1,ControlsXSkipOffset:rh,ControlsXStuff:l1,ControlsXStuffOffset:lh,ControlsYBottomOffset:oh,DefaultTextboxStyle:i1,GlowRX:ch,GlowRY:Si,NameboxHeight:Ea,NameboxTextStyle:uh,NameboxTextX:o1,NameboxTextYOffset:nh,NameboxWidth:Ra,NameboxX:ph,NameboxXOffset:Ba,TextBoxBottomSpacing:Jw,TextBoxCorruptedKerning:Kw,TextBoxCorruptedStyle:e1,TextBoxCorruptedWidth:Qp,TextBoxCorruptedX:t1,TextBoxHeight:eh,TextBoxKerning:qw,TextBoxLineHeight:Gw,TextBoxStyle:fh,TextBoxTextCorruptedXOffset:Zw,TextBoxTextCorruptedYOffset:Qw,TextBoxTextX:n1,TextBoxTextXOffset:Aa,TextBoxTextYOffset:th,TextBoxWidth:Ta,TextBoxX:Qo},Symbol.toStringTag,{value:"Module"}));var c1=Object.defineProperty,u1=Object.defineProperties,d1=Object.getOwnPropertyDescriptors,iu=Object.getOwnPropertySymbols,f1=Object.prototype.hasOwnProperty,p1=Object.prototype.propertyIsEnumerable,au=(t,e,n)=>e in t?c1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h1=(t,e)=>{for(var n in e||(e={}))f1.call(e,n)&&au(t,n,e[n]);if(iu)for(var n of iu(e))p1.call(e,n)&&au(t,n,e[n]);return t},v1=(t,e)=>u1(t,d1(e));const g1="#ffe6f4",m1="#ffbde1",b1="rgba(255,255,255,0.6)",y1=60,_1=45,w1=v1(h1({},Ma),{fontName:"riffic",fontSize:36,strokeColor:ja,strokeWidth:12,letterSpacing:1,color:"white"}),P1={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},C1=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackdropColor:b1,NotificationBackgroundColor:g1,NotificationBorderColor:m1,NotificationOkTextStyle:w1,NotificationPadding:y1,NotificationSpacing:_1,NotificationTextStyle:P1},Symbol.toStringTag,{value:"Module"}));var x1=Object.defineProperty,k1=Object.defineProperties,O1=Object.getOwnPropertyDescriptors,cu=Object.getOwnPropertySymbols,$1=Object.prototype.hasOwnProperty,S1=Object.prototype.propertyIsEnumerable,uu=(t,e,n)=>e in t?x1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yn=(t,e)=>{for(var n in e||(e={}))$1.call(e,n)&&uu(t,n,e[n]);if(cu)for(var n of cu(e))S1.call(e,n)&&uu(t,n,e[n]);return t},_n=(t,e)=>k1(t,O1(e));const I1=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],j1=0,T1=0,A1=dl/2,E1=Ia/2,R1=26,B1=150,M1=61,D1=1200,L1=1080,N1=Np,F1="#333333bf",H1=720,U1=270,V1=3,W1=7,wn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},z1=[_n(yn({},wn),{name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1}),_n(yn({},wn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5}),_n(yn({},wn),{name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5}),_n(yn({},wn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48}),_n(yn({},wn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12}),_n(yn({},wn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60}),_n(yn({},wn),{name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53}),_n(yn({},wn),{name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1})],X1=Object.freeze(Object.defineProperty({__proto__:null,backgroundScale:N1,consoleBackgroundColor:F1,consoleHeight:U1,consoleWidth:H1,defaultConsoleBackground:V1,defaultConsoleStyle:W1,defaultPoemBackground:j1,defaultPoemHeight:L1,defaultPoemStyle:T1,defaultPoemWidth:D1,defaultX:A1,defaultY:E1,poemBackgrounds:I1,poemBottomPadding:B1,poemPadding:M1,poemTextStyles:z1,poemTopPadding:R1},Symbol.toStringTag,{value:"Module"})),Y1={Base:Pw,Choices:Ew,Notification:C1,Poem:X1,TextBox:a1,TextBoxCustom:Kp};function ie(){return ve.gameMode==="ddlc_plus"?Y1:pw}function Dr(t,e,n){return t>e?t:e>n?n:e}function Ii(t,e){return(t%e+e)%e}function q1(t,e){return t===null&&e===null?!0:t===null||e===null?!1:t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.e===e.e&&t.f===e.f}function Lr(t){const{a:e,b:n,c:o,d:s,e:r,f:l}=t,a=e*s-n*o,i={x:r,y:l,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){const c=Math.sqrt(e*e+n*n);i.rotation=(n>0?Math.acos(e/c):-Math.acos(e/c))/Math.PI*180,i.scaleX=c,i.scaleY=a/c,i.skewX=Math.atan((e*o+n*s)/(c*c))/Math.PI*180,i.skewY=0}else if(o!=0||s!=0){const c=Math.sqrt(o*o+s*s);i.rotation=(Math.PI/2-(s>0?Math.acos(-o/c):-Math.acos(o/c)))/Math.PI*180,i.scaleX=a/c,i.scaleY=c,i.skewX=0,i.skewY=Math.atan((e*o+n*s)/(c*c))/Math.PI*180}return i}var G1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function K1(t){var e,n,o,s,r,l,a;const i=Object.values(t.panels.panels);if(!i.find(c=>Object.values(c.objects).find(u=>"scaleX"in u)))for(const c of i)for(const u of Object.values(c.objects)){u.scaleX=(e=u.zoom)!=null?e:1,u.scaleY=(n=u.zoom)!=null?n:1,u.skewX=0,u.skewY=0,u.linkedTo=null;const f=ie();if(u.type==="character"){const p=u,g=t.content.current.characters.find(b=>b.id===p.characterType),m=(l=(r=(s=(o=g==null?void 0:g.styleGroups[p.styleGroupId])==null?void 0:o.styles[p.styleId])==null?void 0:s.poses[p.poseId])==null?void 0:r.size)!=null?l:[960,960];hh(p,(a=u.zoom)!=null?a:1,m)}if(u.type==="textBox"){const p=u;p.height+=f.TextBox.NameboxHeight,p.y+=p.height/2}u.type==="sprite"&&(u.requireFixing25=!0,t.requireFixing25=!0),delete u.zoom}}function hh(t,e,n){let o=new DOMMatrixReadOnly().translate(t.x,t.y+t.height/2);o=o.translate(0,-t.height/2).scale(t.width/n[0],t.height/n[1]).translate(0,n[1]/2),o=o.rotate(t.flip?-t.rotation:t.rotation),o=o.translate(0,n[1]/2).scale(e).translate(0,-n[1]/2);const s=t.rotation;Object.assign(t,Lr(o)),t.rotation=t.flip?360-s:s,t.skewX=0,t.skewY=0,t.width=n[0],t.height=n[1]}const J1={fixSprites2_5(t,e){for(const n of Object.values(t.panels.panels))for(const o of Object.values(n.objects)){if(o.type!=="sprite"||!o.requireFixing25||o.scaleX!==o.scaleY)continue;const s=o;s.assets.length===1&&s.assets[0].hq===e.url&&(hh(s,o.scaleX,e.size),delete o.requireFixing25)}}};function Z1(t,e,n){return G1(this,null,function*(){if("requireFixing25"in t){const o=yield Do(n);e("fixSprites2_5",{url:n,size:[o.width,o.height]},{root:!0})}})}function Q1(t){return!t.requireFixing25}function gs(t,e,n){let o=e+n;const s=t.length;return o<0&&(o+=s),o>=s&&(o-=s),o}var an=(t=>(t[t.None=0]="None",t[t.Selected=1]="Selected",t[t.Focused=2]="Focused",t[t.Indirectly=4]="Indirectly",t))(an||{});const eP={0:void 0,1:"#f00",2:"#00f",3:"#f0f",4:"#f66",6:"#f6f"};function No(t){t.width=0,t.height=0,Da.delete(t.disposalId||0)}function ro(){const t=document.createElement("canvas");return nP(t),t}const Da=new Map;let tP=0;function nP(t){t.disposalId=tP++,typeof WeakRef!="undefined"&&Da.set(t.disposalId,new WeakRef(t))}window.addEventListener("unload",()=>{Da.forEach(t=>{const e=t.deref();e&&No(e)})});class _o{}var oP=Object.defineProperty,du=Object.getOwnPropertySymbols,sP=Object.prototype.hasOwnProperty,rP=Object.prototype.propertyIsEnumerable,ji=(t,e,n)=>e in t?oP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,as=(t,e)=>{for(var n in e||(e={}))sP.call(e,n)&&ji(t,n,e[n]);if(du)for(var n of du(e))rP.call(e,n)&&ji(t,n,e[n]);return t},lP=(t,e,n)=>(ji(t,typeof e!="symbol"?e+"":e,n),n),iP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Fo{constructor(e,n,o,s){this.canvas=e,this.fsCtx=n,this.hq=o,this.preview=s,lP(this,"aborted",!1)}static make(e,n,o){return new Fo(e,e.getContext("2d"),n,o)}static makeWithContext(e,n,o,s){return new Fo(e,n,o,s)}drawText(e){if(this.aborted)throw new _o;this.fsCtx.save();const{font:n,align:o,x:s=0,y:r=0,text:l=""}=as(as({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width,this.fsCtx.strokeText(l,s,r)),e.fill&&(this.fsCtx.fillStyle=e.fill.style,this.fsCtx.fillText(l,s,r)),this.fsCtx.restore()}measureText(e){if(this.aborted)throw new _o;this.fsCtx.save();const{font:n,align:o,text:s=""}=as(as({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width),e.fill&&(this.fsCtx.fillStyle=e.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(e){if(this.aborted)throw new _o;const{image:n,flip:o,x:s,y:r,w:l,h:a,filters:i,composite:c}=as({flip:!1,w:e.image.width,h:e.image.height,composite:"source-over"},e);if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=c,i)if("filter"in this.fsCtx){const u=[];for(const f of i)f.type==="drop-shadow"?u.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?u.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?u.push(`blur(${f.value}px)`):u.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=u.join(" ")}else{let u=1;for(const f of i)f.type==="opacity"&&(u*=f.value);this.fsCtx.globalAlpha=u}if(e.shadow){const u=e.shadow;u.color!=null&&(this.fsCtx.shadowColor=u.color),u.blur!=null&&(this.fsCtx.shadowBlur=u.blur),u.offsetX!=null&&(this.fsCtx.shadowOffsetX=u.offsetX),u.offsetY!=null&&(this.fsCtx.shadowOffsetY=u.offsetY)}if(e.rotation!=null&&e.rotation!==0){const u=e.rotationAnchor?e.rotationAnchor.x:0,f=e.rotationAnchor?e.rotationAnchor.y:0;e.rotationAnchor&&this.fsCtx.translate(u,f),this.fsCtx.rotate(e.rotation),e.rotationAnchor&&this.fsCtx.translate(-u,-f)}this.fsCtx.translate(s+l/2,r+a/2),this.fsCtx.scale(o?-1:1,1),n.paintOnto(this.fsCtx,{x:-l/2,y:-a/2,w:l,h:a}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:e,y:n,w:o,h:s,outline:r,fill:l,composition:a,rotation:i,rotationAnchor:c}){if(this.aborted)throw new _o;if(this.fsCtx.save(),i!=null&&i!==0){const u=c?c.x:0,f=c?c.y:0;c&&this.fsCtx.translate(u,f),this.fsCtx.rotate(i),c&&this.fsCtx.translate(-u,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(e,n,o,s),a&&(this.fsCtx.globalCompositeOperation=a),l&&(this.fsCtx.fillStyle=l.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:e,fill:n,path:o}){if(this.aborted)throw new _o;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(e,n="repeat"){return e instanceof vh&&(e=e.previewCanvas),this.fsCtx.createPattern(e,n)}customTransform(e,n){return iP(this,null,function*(){this.fsCtx.save(),yield e(this.fsCtx),yield n(this),this.fsCtx.restore()})}linearGradient(e,n,o,s){return this.fsCtx.createLinearGradient(e,n,o,s)}applyFilters(e){if(e.length===0)return;this.fsCtx.save();let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of e)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),n!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${n})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}var aP=Object.defineProperty,cP=(t,e,n)=>e in t?aP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hl=(t,e,n)=>(cP(t,typeof e!="symbol"?e+"":e,n),n),er=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class vh{constructor(e,n){Hl(this,"previewCanvas"),Hl(this,"runningContext",null),Hl(this,"_disposed",!1);const o=ie();this.previewCanvas=ro(),this.previewCanvas.width=e!=null?e:o.Base.screenWidth,this.previewCanvas.height=n!=null?n:o.Base.screenHeight}get disposed(){return this._disposed}render(e,n=!0,o=!0){return er(this,null,function*(){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=Fo.makeWithContext(this.previewCanvas,s,n,o);try{yield e(this.runningContext)}catch(l){if(l instanceof _o)return!1;throw l}finally{r===this.runningContext&&(this.runningContext=null)}return!0})}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(e,n){n.w!=null&&n.h!=null?e.drawImage(this.previewCanvas,n.x,n.y,n.w,n.h):e.drawImage(this.previewCanvas,n.x,n.y)}download(e,n){return er(this,null,function*(){const o=yield this.drawToCanvas(e);return yield ve.saveToFile(o,n)})}renderToBlob(e){return er(this,null,function*(){const n=yield this.drawToCanvas(e);return yield new Promise((o,s)=>{n.toBlob(r=>{r?o(r):s()})})})}drawToCanvas(e){return er(this,null,function*(){const n=ro();n.width=this.previewCanvas.width,n.height=this.previewCanvas.height;const o=n.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),yield e(Fo.makeWithContext(n,o,!0,!1)),n})}dispose(){this.runningContext&&this.runningContext.abort(),No(this.previewCanvas),this._disposed=!0}getDataAt(e,n){return this.previewCanvas.getContext("2d").getImageData(e,n,1,1).data}}function es(){return{flip:!1,rotation:0,version:0,opacity:100,x:ie().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,scaleX:1,scaleY:1,ratio:1,preserveRatio:!0,skewX:0,skewY:0,linkedTo:null}}var uP=Object.defineProperty,dP=Object.defineProperties,fP=Object.getOwnPropertyDescriptors,fu=Object.getOwnPropertySymbols,pP=Object.prototype.hasOwnProperty,hP=Object.prototype.propertyIsEnumerable,pu=(t,e,n)=>e in t?uP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nr=(t,e)=>{for(var n in e||(e={}))pP.call(e,n)&&pu(t,n,e[n]);if(fu)for(var n of fu(e))hP.call(e,n)&&pu(t,n,e[n]);return t},vP=(t,e)=>dP(t,fP(e)),gP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const mP={setPose(t,e){const n=t.panels[e.panelId].objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup(t,{id:e,panelId:n,styleGroupId:o}){const s=t.panels[n].objects[e];s.styleGroupId=o,++s.version},setCharStyle(t,{id:e,panelId:n,styleId:o}){const s=t.panels[n].objects[e];s.styleId=o,++s.version},setClose(t,e){const n=t.panels[e.panelId].objects[e.id];n.close=e.close,++n.version},setPosePosition(t,e){const n=t.panels[e.panelId].objects[e.id];n.posePositions=Nr(Nr({},n.posePositions),e.posePositions),++n.version},setFreeMove(t,e){const n=t.panels[e.panelId].objects[e.id];if(n.freeMove=e.freeMove,!n.freeMove){const o=ie();n.x=o.Base.characterPositions[Hr(n.x)],n.y=o.Base.BaseCharacterYPos}}};function fl(t,e){return t.getters["content/getCharacters"].get(e.characterType)}function Wn(t,e){return t["content/getCharacters"].get(e)}function Ho(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function bP(t,e){const n=Ho(t,e),o=[...Object.keys(n.positions).filter(s=>n.positions[s].length>1)];return n.compatibleHeads.length>0&&o.unshift("head"),o}function Fr(t,e,n=e.posePositions.headType||0){const o=Ho(t,e).compatibleHeads;return o.length===0?null:t.heads[o[n]]}function Hr(t){return ie().Base.characterPositions.map((o,s)=>({pos:Math.abs(t-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}const yP={createCharacters({rootState:t,rootGetters:e,commit:n,state:o},s){var r;const l=o.panels[s.panelId].lastObjId+1,a=ie(),i=Wn(e,s.characterType),c=i.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;return n("create",{object:vP(Nr({},es()),{id:l,panelId:t.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,width:i.size[0],height:i.size[1],scaleX:i.defaultScale[0]*c,scaleY:i.defaultScale[1]*c,characterType:s.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:(r=i.label)!=null?r:i.id,enlargeWhenTalking:t.ui.defaultCharacterTalkingZoom,linkedTo:null})}),l},seekPart({state:t,commit:e,dispatch:n,rootGetters:o},{delta:s,id:r,panelId:l,part:a}){if(a==="head"){n("seekHead",{id:r,panelId:l,delta:s});return}const i=t.panels[l].objects[r],c=Ho(Wn(o,i.characterType),i);c.positions[a]&&e("setPosePosition",{id:r,panelId:l,posePositions:{[a]:gs(c.positions[a],i.posePositions[a]||0,s)}})},seekPose({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Wn(n,l.characterType),i=a.styleGroups[l.styleGroupId].styles[l.styleId].poses;vo(e,l,a,c=>{c.poseId=gs(i,c.poseId,r)})},seekStyle({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Wn(n,l.characterType),i=a.styleGroups.flatMap((u,f)=>u.styles.map((p,g)=>({styleGroupIdx:f,styleIdx:g,styleGroupJson:JSON.stringify(p.components)}))).sort((u,f)=>u.styleGroupJson.localeCompare(f.styleGroupJson)),c=i.findIndex(u=>u.styleGroupIdx===l.styleGroupId&&u.styleIdx===l.styleId);vo(e,l,a,u=>{const f=gs(i,c,r),p=i[f];u.styleGroupId=p.styleGroupIdx,u.styleId=p.styleIdx})},seekHead({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Wn(n,l.characterType),i=Ho(a,l);let c=Fr(a,l);if(!c)return;let u=(l.posePositions.head||0)+r,f=l.posePositions.headType||0;(u<0||u>=c.variants.length)&&(f=gs(i.compatibleHeads.map(p=>a.heads[p]),f,r),c=Fr(a,l,f),u=r===1?0:c.variants.length-1),e("setPosePosition",{id:o,panelId:s,posePositions:{head:u,headType:f}})},setPart({state:t,commit:e,rootGetters:n},{panelId:o,id:s,part:r,val:l}){const a=t.panels[o].objects[s],i=Wn(n,a.characterType);r==="pose"?vo(e,a,i,c=>{c.poseId=l}):r==="style"?vo(e,a,i,c=>{c.styleId=l}):vo(e,a,i,c=>{c.posePositions[r]=l})},setCharStyle({state:t,commit:e,rootGetters:n},{panelId:o,id:s,styleGroupId:r,styleId:l}){const a=t.panels[o].objects[s],i=Wn(n,a.characterType);vo(e,a,i,c=>{c.styleGroupId=r,c.styleId=l})},setCharacterPosition({state:t,commit:e},{panelId:n,id:o,x:s,y:r}){const l=t.panels[n].objects[o];if(!l.freeMove){const a=ie();s=a.Base.characterPositions[Hr(s)],r=a.Base.BaseCharacterYPos}l.x===s&&l.y===r||e("setPosition",{panelId:n,id:o,x:s,y:r})},shiftCharacterSlot({state:t,commit:e},{panelId:n,id:o,delta:s}){const r=t.panels[n].objects[o],l=ie();let i=Hr(r.x)+s;i<0&&(i=0),i>=l.Base.characterPositions.length&&(i=l.Base.characterPositions.length-1),e("setPosition",{panelId:n,id:o,x:l.Base.characterPositions[i],y:r.y})}};function _P(t,e,n,o){return gP(this,null,function*(){const s=t.state.panels[e].objects[n],r=o.characters.find(_=>_.id===s.characterType);if(!r){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const l=gh(s),a=r.styleGroups[s.styleGroupId],i=a.styles[l.styleId],c=i.poses[l.poseId],u=t.rootState.content.current.characters.find(_=>_.id===r.id);if(!u){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const f=u.styleGroups.findIndex(_=>_.id===a.id);l.styleGroupId=f===-1?0:f;const p=u.styleGroups[l.styleGroupId],g=JSON.stringify(i.components),m=p.styles.findIndex(_=>JSON.stringify(_.components)===g);l.styleId=m===-1?0:m;const b=p.styles[l.styleId],P=b.poses.findIndex(_=>_.id===c.id);l.poseId=P===-1?0:P;const O=b.poses[l.poseId];for(const _ in O.positions){if(!Object.prototype.hasOwnProperty.call(O.positions,_))continue;const j=O.positions[_];if(c.positions[_]){const S=l.posePositions[_];S>=0&&S<j.length}}const h=c.compatibleHeads[s.posePositions.headType],v=O.compatibleHeads.indexOf(h);if(v===-1)l.posePositions.headType=0,l.posePositions.head=0;else{v!==s.posePositions.headType&&(l.posePositions.headType=v);const _=JSON.stringify(r.heads[h].variants[s.posePositions.head]),j=u.heads[h].variants.findIndex(S=>JSON.stringify(S)===_);j===-1?l.posePositions.head=0:l.posePositions.head=j}mh(t.commit,s,l)})}function gh(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Nr({},t.posePositions)}}function mh(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,panelId:e.panelId,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log(`Setting style of ${e.id} to ${n.styleId}`),t("setCharStyle",{id:e.id,panelId:e.panelId,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,panelId:e.panelId,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,panelId:e.panelId,posePositions:n.posePositions})}function vo(t,e,n,o){const s=gh(e);o(s),n.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=n.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const l=r.styles[s.styleId];l.poses[s.poseId]||(s.poseId=0);const a=l.poses[s.poseId];for(const f in a.positions)a.positions[f]&&(a.positions[f][s.posePositions[f]]||(s.posePositions[f]=0));const c=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId].compatibleHeads[e.posePositions.headType||0],u=a.compatibleHeads.indexOf(c);u>=0?s.posePositions.headType=u:(s.posePositions.headType=0,s.posePositions.head=0),mh(t,e,s)}var Rt={},bh={};Object.defineProperty(bh,"__esModule",{value:!0});var yh={};Object.defineProperty(yh,"__esModule",{value:!0});var _h={};Object.defineProperty(_h,"__esModule",{value:!0});var wh={};Object.defineProperty(wh,"__esModule",{value:!0});var Ph={};Object.defineProperty(Ph,"__esModule",{value:!0});var Ch={};Object.defineProperty(Ch,"__esModule",{value:!0});var xh={};Object.defineProperty(xh,"__esModule",{value:!0});var kh={};Object.defineProperty(kh,"__esModule",{value:!0});var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});var $h={};Object.defineProperty($h,"__esModule",{value:!0});var Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});var jh={};Object.defineProperty(jh,"__esModule",{value:!0});var Th={};Object.defineProperty(Th,"__esModule",{value:!0});var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});var Fh={};Object.defineProperty(Fh,"__esModule",{value:!0});var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});var qh={};Object.defineProperty(qh,"__esModule",{value:!0});var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});var ev={};Object.defineProperty(ev,"__esModule",{value:!0});var tv={};Object.defineProperty(tv,"__esModule",{value:!0});var nv={};Object.defineProperty(nv,"__esModule",{value:!0});var ov={};Object.defineProperty(ov,"__esModule",{value:!0});var sv={};Object.defineProperty(sv,"__esModule",{value:!0});var rv={};Object.defineProperty(rv,"__esModule",{value:!0});var lv={};Object.defineProperty(lv,"__esModule",{value:!0});var iv={};Object.defineProperty(iv,"__esModule",{value:!0});var av={};Object.defineProperty(av,"__esModule",{value:!0});var cv={};Object.defineProperty(cv,"__esModule",{value:!0});var uv={};Object.defineProperty(uv,"__esModule",{value:!0});var dv={};Object.defineProperty(dv,"__esModule",{value:!0});var fv={};Object.defineProperty(fv,"__esModule",{value:!0});var pv={};Object.defineProperty(pv,"__esModule",{value:!0});var hv={};Object.defineProperty(hv,"__esModule",{value:!0});var vv={};Object.defineProperty(vv,"__esModule",{value:!0});var gv={};Object.defineProperty(gv,"__esModule",{value:!0});var mv={};Object.defineProperty(mv,"__esModule",{value:!0});var bv={};Object.defineProperty(bv,"__esModule",{value:!0});var yv={};Object.defineProperty(yv,"__esModule",{value:!0});var _v={};Object.defineProperty(_v,"__esModule",{value:!0});var wv={};Object.defineProperty(wv,"__esModule",{value:!0});var Pv={};Object.defineProperty(Pv,"__esModule",{value:!0});var Cv={};Object.defineProperty(Cv,"__esModule",{value:!0});var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.UnreachableCaseError=void 0;class wP extends Error{constructor(e){super(`Unreachable case: ${e}`)}}pl.UnreachableCaseError=wP;var hl={};Object.defineProperty(hl,"__esModule",{value:!0});hl.assert=void 0;function PP(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}hl.assert=PP;var vl={};Object.defineProperty(vl,"__esModule",{value:!0});vl.createFactoryWithConstraint=void 0;const CP=()=>t=>t;vl.createFactoryWithConstraint=CP;var gl={};Object.defineProperty(gl,"__esModule",{value:!0});gl.isExact=void 0;const xP=()=>t=>t;gl.isExact=xP;var ml={};Object.defineProperty(ml,"__esModule",{value:!0});ml.noop=void 0;function kP(...t){}ml.noop=kP;var xv={};Object.defineProperty(xv,"__esModule",{value:!0});(function(t){var e=tt&&tt.__createBinding||(Object.create?function(o,s,r,l){l===void 0&&(l=r);var a=Object.getOwnPropertyDescriptor(s,r);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,l,a)}:function(o,s,r,l){l===void 0&&(l=r),o[l]=s[r]}),n=tt&&tt.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&e(s,o,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(bh,t),n(yh,t),n(_h,t),n(wh,t),n(Ph,t),n(Ch,t),n(xh,t),n(kh,t),n(Oh,t),n($h,t),n(Sh,t),n(Ih,t),n(jh,t),n(Th,t),n(Ah,t),n(Eh,t),n(Rh,t),n(Bh,t),n(Mh,t),n(Dh,t),n(Lh,t),n(Nh,t),n(Fh,t),n(Hh,t),n(Uh,t),n(Vh,t),n(Wh,t),n(zh,t),n(Xh,t),n(Yh,t),n(qh,t),n(Gh,t),n(Kh,t),n(Jh,t),n(Zh,t),n(Qh,t),n(ev,t),n(tv,t),n(nv,t),n(ov,t),n(sv,t),n(rv,t),n(lv,t),n(iv,t),n(av,t),n(cv,t),n(uv,t),n(dv,t),n(fv,t),n(pv,t),n(hv,t),n(vv,t),n(gv,t),n(mv,t),n(bv,t),n(yv,t),n(_v,t),n(wv,t),n(Pv,t),n(Cv,t),n(pl,t),n(hl,t),n(vl,t),n(gl,t),n(ml,t),n(xv,t)})(Rt);var OP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class $P{constructor(e,n,o,s,r,l){this.id=e,this.assets=n,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=l}render(e){return OP(this,null,function*(){const{screenWidth:n,screenHeight:o}=ie().Base,s=yield Promise.all(this.assets.map(r=>fa(r,e.hq)));for(const r of s){let l=0,a=0,i=r.width,c=r.height;const u=this.scale;switch(u){case br.None:l=n/2-i/2,a=o/2-c/2;break;case br.Stretch:i=n,c=o;break;case br.Cover:{const f=i/c,p=n/o;f>p?(c=o,i=c*f):(i=n,c=i/f),l=n/2-i/2,a=o/2-c/2;break}default:throw new Rt.UnreachableCaseError(u)}e.drawImage({image:r,x:l,y:a,w:i,h:c,flip:this.flip,composite:this.compositeMode,filters:this.filters})}})}}const hu={id:"buildin.static-color",name:"Static color",color:"#000000",render(t){const{screenWidth:e,screenHeight:n}=ie().Base;return t.drawRect({x:0,y:0,w:e,h:n,fill:{style:this.color}}),Promise.resolve()}};function Ur(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.arcTo(e+o,n+s,e,n+s,r),t.arcTo(e,n+s,e,n,r),t.arcTo(e,n,e+o,n,r),t.closePath()}function kv(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.lineTo(e+o,n+s),t.lineTo(e,n+s),t.arcTo(e,n,e+o,n,r),t.closePath()}function Bn(t,e){t.save();try{e()}finally{t.restore()}}function Cs(t,e){e.align&&(t.textAlign=e.align),e.font&&(t.font=e.font),e.fill&&(t.fillStyle=e.fill.style),e.outline&&(t.strokeStyle=e.outline.style,t.lineWidth=e.outline.width)}function SP(t,e){if("filter"in t){let n="";for(const o of e)o.type==="drop-shadow"?n+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?n+=` hue-rotate(${o.value}deg)`:o.type==="blur"?n+=` blur(${o.value}px)`:n+=` ${o.type}(${o.value*100}%)`;t.filter=(t.filter==="none"?"":t.filter)+n.trimStart()}else{let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);t.globalAlpha*=n}}var IP=Object.defineProperty,jP=(t,e,n)=>e in t?IP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pn=(t,e,n)=>(jP(t,typeof e!="symbol"?e+"":e,n),n);class Ov{constructor(e){this.obj=e,Pn(this,"lastVersion",null),Pn(this,"localCanvasInvalid",!0),Pn(this,"lastHit",null),Pn(this,"lastLocalTransform",null),Pn(this,"refTextbox",null),Pn(this,"preparedTransform"),Pn(this,"hitDetectionFallback",!1),Pn(this,"localCanvas",null)}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let e=new DOMMatrix;const n=this.obj;e=e.translate(this.x,this.y);const o=this.height/2*n.scaleX;return"close"in n&&n.close&&(e=e.translate(0,ie().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&n.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),(n.flip||n.rotation!==0||n.scaleX!==1||n.scaleY!==1||n.skewX!==0||n.skewY!==0)&&(n.rotation!==0&&(e=e.rotate(0,0,n.rotation)),n.skewX!==0&&(e=e.skewX(n.skewX)),n.skewY!==0&&(e=e.skewY(n.skewY)),n.flip&&(e=e.flipX()),(n.scaleX!==1||n.scaleY!==1)&&(e=e.scale(n.scaleX,n.scaleY))),e}getLocalSize(){if(this.transformIsLocal){const e=ie();return new DOMPointReadOnly(e.Base.screenWidth,e.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.refTextbox!==null}get linkedTo(){return this.obj.linkedTo}prepareData(e,n){this.refTextbox=null;const o=[...e.order,...e.onTopOrder];for(const s of o){const r=e.objects[s];if(r.type==="textBox"&&r.talkingObjId===this.obj.id){this.refTextbox=r;return}}}prepareTransform(e){return this.preparedTransform=e.multiply(this.getTransfrom()),this.preparedTransform}prepareRender(e){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const n=this.preparedTransform;q1(n,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=n)}else this.lastLocalTransform=null}render(e,n,o,s,r){o||(n=an.None),(!this.canSkipLocal||n!==an.None)&&(r=!1);const l=this.getLocalSize(),a=this.preparedTransform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==l.x||this.localCanvas.height!==l.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=ro()),this.localCanvas.width=l.x,this.localCanvas.height=l.y;const c=this.localCanvas.getContext("2d");if(!c)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&c.setTransform(a),this.renderLocal(c,s),this.localCanvasInvalid=!1,c.resetTransform()}const i=eP[n];Bn(e,()=>{var c;i!=null&&(e.shadowColor=i,e.shadowBlur=20),(!this.transformIsLocal||r)&&e.setTransform(a),e.globalCompositeOperation=(c=this.obj.composite)!=null?c:"source-over",SP(e,this.obj.filters),r?this.renderLocal(e,s):e.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(e){const n=e.matrixTransform(this.preparedTransform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(n.x<0||n.y<0||n.x>o.x||n.y>o.y)return console.log("Hitbox text",n),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?e:n;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}var TP=Object.defineProperty,AP=(t,e,n)=>e in t?TP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,go=(t,e,n)=>(AP(t,typeof e!="symbol"?e+"":e,n),n),EP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class $v extends Ov{constructor(){super(...arguments),go(this,"refTextbox",null),go(this,"lastUploadCount",0),go(this,"lastHq",!1),go(this,"missingAsset",!1),go(this,"_canSkipLocal",!1),go(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareData(e,n){if(super.prepareData(e,n),this.missingAsset){const o=Object.keys(n.state.uploadUrls).length;o!==this.lastUploadCount&&(this.lastHq=null),this.lastUploadCount=o}}prepareRender(e){super.prepareRender(e);let n=!1;if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),n||(n=!!this.assetList.find(o=>!("loadedAssets"in o)||o.hasMissing))),!e!==this.lastHq)for(let o=0;o<this.assetList.length;++o){const s=this.assetList[o];"loadedAssets"in s&&!s.assets.every(r=>r.hq===r.lq)&&(this.assetList[o]={assets:s.assets,offset:s.offset,composite:s.composite},n=!0)}if(this.lastHq=!e,!!n)return this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!e)}getAssetsSize(){let e=0,n=0;for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)e=Math.max(e,o.offset[0]+s.width),n=Math.max(n,o.offset[1]+s.height);return new DOMPointReadOnly(e,n)}loadAssets(e){const n=[];this.missingAsset=!1;for(const o of this.assetList)"loadedAssets"in o&&!o.hasMissing||n.push((s=>EP(this,null,function*(){const r=yield Promise.all(s.assets.map(a=>fa(a,e))),l=s;l.loadedAssets=r,l.hasMissing=r.some(a=>a instanceof As),this.missingAsset||(this.missingAsset=l.hasMissing)}))(o));if(n.length!==0)return Promise.all(n)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e,n){var o;console.log("rerendering local");for(const s of this.assetList)if("loadedAssets"in s)for(const r of s.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=(o=s.composite)!=null?o:"source-over"),r instanceof As?r.paintOnto(e,{x:s.offset[0],y:s.offset[1],h:this.height,w:this.width}):r.paintOnto(e,{x:s.offset[0],y:s.offset[1]})}}var RP=Object.defineProperty,BP=Object.defineProperties,MP=Object.getOwnPropertyDescriptors,vu=Object.getOwnPropertySymbols,DP=Object.prototype.hasOwnProperty,LP=Object.prototype.propertyIsEnumerable,gu=(t,e,n)=>e in t?RP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,NP=(t,e)=>{for(var n in e||(e={}))DP.call(e,n)&&gu(t,n,e[n]);if(vu)for(var n of vu(e))LP.call(e,n)&&gu(t,n,e[n]);return t},FP=(t,e)=>BP(t,MP(e));class HP extends $v{constructor(e,n){super(e),this.data=n}prepareData(e,n){super.prepareData(e,n),this.data=fl(n,this.obj)}prepareRender(e){return super.prepareRender(e)}isAssetListOutdated(){return!0}getAssetList(){const e=Ho(this.data,this.obj),n=Fr(this.data,this.obj),o=[],s=this.assetList||[];for(const r of e.renderCommands){let l=null;switch(r.type){case"head":{if(!n)continue;const a=n.variants[this.obj.posePositions.head||0];if(a==null)continue;l=a;break}case"image":l=r.images;break;case"pose-part":{const a=e.positions[r.part];if(!a||a.length===0)break;const i=a[this.obj.posePositions[r.part]||0];if(!i)break;l=i;break}}if(l){const a=s.find(i=>i.assets===l);a?o.push(FP(NP({},a),{offset:r.offset,composite:r.composite})):o.push({assets:l,offset:r.offset,composite:r.composite})}}return o}}var UP=Object.defineProperty,VP=(t,e,n)=>e in t?UP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WP=(t,e,n)=>(VP(t,typeof e!="symbol"?e+"":e,n),n);const mu=5;class zP{constructor(e){this.str=e,WP(this,"pos",0)}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-mu),this.pos+mu)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function bu(t,e=!0){const n=[],o=new zP(t);let s=bl;for(;s!==yl;){const r=o.pos;try{s=s(n,o)}catch(l){if(e&&s!==Ti)o.pos=r,s=(a,i)=>Ti(a,i,!0);else throw l}}return n}function bl(t,e){return e.current()===void 0?yl:e.current()==="{"?XP:e.current()===`
`?YP:Ti}function yl(){return yl}function Ti(t,e,n=!1){const{pos:o}=e;let s="",r=n,l;for(;;){if(e.current()===void 0){l=yl;break}else if(r)s+=e.current(),r=!1;else if(e.current()==="\\")r=!0;else if(e.current()==="{"||e.current()===`
`){l=bl;break}else s+=e.current();e.next()}return t.push({type:"text",pos:o,content:s}),l}function Ul(t,e){throw new Error(`Error when parsing text at position ${t.pos}: (around: "${t.around}") ${e}`)}function XP(t,e){const{pos:n}=e;if(e.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=e.next()==="/";o&&e.next();let s="",r="",l=!1;for(;e.current()===void 0&&Ul(e,"Unexpected end of text inside a command"),e.current()!=="}";)l?r+=e.current():e.current().match(/[a-z]/i)?s+=e.current():e.current()==="="?(o&&Ul(e,"Closing commands may not contain arguments"),l=!0):Ul(e,`Unexpected character '${e.current()}' in command name.`),e.next();return e.next(),o?t.push({type:"commandClose",commandName:s,pos:n}):t.push({type:"command",pos:n,argument:r,commandName:s}),bl}function YP(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),bl}var qP=Object.defineProperty,GP=Object.defineProperties,KP=Object.getOwnPropertyDescriptors,yu=Object.getOwnPropertySymbols,JP=Object.prototype.hasOwnProperty,ZP=Object.prototype.propertyIsEnumerable,_u=(t,e,n)=>e in t?qP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kt=(t,e)=>{for(var n in e||(e={}))JP.call(e,n)&&_u(t,n,e[n]);if(yu)for(var n of yu(e))ZP.call(e,n)&&_u(t,n,e[n]);return t},Ot=(t,e)=>GP(t,KP(e));const wu=new Map([mo("i",t=>Ot(kt({},t),{isItalic:!0})),mo("b",t=>Ot(kt({},t),{isBold:!0})),mo("u",t=>Ot(kt({},t),{isUnderlined:!0})),mo("s",t=>Ot(kt({},t),{isStrikethrough:!0})),mo("plain",t=>Ot(kt({},t),{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),mo("edited",t=>Ot(kt({},t),{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),tr("k",(t,e,n)=>Ot(kt({},t),{letterSpacing:e?t.letterSpacing+n:n})),tr("size",(t,e,n)=>Ot(kt({},t),{fontSize:e?t.fontSize+n:n})),tr("alpha",(t,e,n)=>Ot(kt({},t),{alpha:e?t.alpha+n:n})),tr("stroke",(t,e,n)=>Ot(kt({},t),{strokeWidth:e?t.strokeWidth+n:n})),["font",(t,e)=>Ot(kt({},t),{fontName:e})],["color",(t,e)=>Ot(kt({},t),{color:e})],["outlinecolor",(t,e)=>Ot(kt({},t),{strokeColor:e})]]);function mo(t,e){return[t,(n,o)=>{if(o!=="")throw new Error(`Operator '${t}' does not take any arguments.`);return e(n)}]}function tr(t,e){return[t,(n,o)=>{if(o=="")throw new Error(`Operator '${t}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${t}' needs a numeric argument.`);return e(n,s,r)}]}var QP=Object.defineProperty,eC=(t,e,n)=>e in t?QP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vl=(t,e,n)=>(eC(t,typeof e!="symbol"?e+"":e,n),n);class $t{constructor(e,n){this.str=e,this.baseStyle=n,Vl(this,"renderParts"),Vl(this,"tokens"),Vl(this,"loose"),this.loose=ve.state.looseTextParsing;try{this.tokens=bu(e,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=$t.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const e=new Set;let n=null;for(const s of this.renderParts)"style"in s&&s.style!==n&&(n=s.style,n.fontName&&e.add(n.fontName));const o=[];for(const s of e){const r=document,l=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(l)||o.push(r.fonts.load(l))}if(o.length!==0)return Promise.all(o).then(()=>{const s=bu(this.str);this.renderParts=$t.getRenderParts(s,this.baseStyle,this.loose)})}render(e){e.save();let n=null;for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,Ai(n,e)),n.strokeWidth>0&&n.strokeColor>""&&e.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,Ai(n,e)),e.fillText(o.character,o.x,o.y));e.restore()}quote(){let e;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(e||(e={}));let n=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const l=this.renderParts[r];if(l.type==="character")switch(o){case 0:if(l.character.match(/\s/))continue;l.character==='"'?(o=1,n=r):l.character==="*"?(o=3,n=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:cs(l.style,'"')}),r++,n=r,o=2);break;case 1:n=r,l.character==='"'&&(o=0);break;case 2:if(l.character.match(/\s/))continue;l.character==="*"&&(this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:cs(l.style,'"')}),o=3,r++),n=r;break;case 3:l.character==="*"&&(o=0),n=r;break;default:throw new Rt.UnreachableCaseError(o)}}const s=this.renderParts[n];s&&o===3&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:cs(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:cs(s.style,'"')})}fixAlignment(e,n,o,s,r){let l=0,a=[];function i(){let m=n;e==="center"?m=n+(o-n)/2-l/2:e==="right"&&(m=o-l);for(const b of a)b.x=m,m+=b.width}let c=this.renderParts;r>0&&(c=$t.applyLineWrapping(this.renderParts.slice(0),r));let u=s;const f=[];let p=0;for(const m of c)p=Math.max(p,m.height),m.type==="newline"&&(f.push(p),p=0);f.push(p);let g=0;for(const m of c)if(p=Math.max(p,m.height),m.y=u,a.push(m),l+=m.width,m.type==="newline")i(),u+=f[++g]||0,l=0,p=0,a=[];else if(m.type==="character"){const b=a[a.length-1];b.type==="character"&&(l+=b.style.letterSpacing,b.width+=b.style.letterSpacing)}i()}getHeight(e){let n=0,o=0;const s=e===0?this.renderParts:$t.applyLineWrapping(this.renderParts.slice(0),e);for(const r of s)n=Math.max(n,r.height),r.type==="newline"&&(o+=n,n=0);return o+=n,o}getWidth(){let e=0,n=0,o=null;for(const s of this.renderParts)e+=s.width,s.type==="newline"?(n=Math.max(n,e),e=0,o=null):s.type==="character"&&(o&&o.type==="character"&&(e+=o.style.letterSpacing),o=s);return n=Math.max(n,e),n}static getRenderParts(e,n,o){const s=[],r=[],l=[];let a=xu(n),i=n,c=null;function u(f){for(const p of f)s.push({type:"character",character:p,height:a,width:cs(i,p),style:i,x:0,y:0})}for(const f of e){const p=f.type;switch(p){case"command":if(wu.has(f.commandName))r.push(i),l.push(c),i=wu.get(f.commandName)(i,f.argument),a=xu(i),c=f;else if(o)u("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!c)if(o){u("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==c.commandName)if(o){u("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${c}' first. (Opened at position ${c.pos})`);c=l.pop(),i=r.pop();break;case"newline":s.push({height:a,width:0,x:0,y:0,type:"newline"});break;case"text":u(f.content);break;default:throw new Rt.UnreachableCaseError(p)}}return s}static applyLineWrapping(e,n){let o=-1,s=0,r=0;const l=[];for(const a of e)if(a.type==="newline")o=-1,s=0,r=0,l.push(a);else if(a.type==="character")a.character===" "?s>n?(o=-1,s=0,r=0,l.push({type:"newline",height:a.height,width:0,x:0,y:0})):(s+=a.width,r=s,o=l.length,l.push(a)):(s+=a.width,s>n&&o!==-1&&(s-=r,l.splice(o,1,{type:"newline",height:a.height,width:0,x:0,y:0}),o=-1,r=0),l.push(a));else throw new Rt.UnreachableCaseError(a);return l}}const La=ro();La.width=0;La.height=0;const Pu=La.getContext("2d");let Cu=null;function cs(t,e){return t!==Cu&&(Ai(t,Pu),Cu=t),Pu.measureText(e).width}const Wl=new Map;function xu(t){const e=t.fontSize+" "+t.fontName;if(Wl.has(e))return Wl.get(e)*t.lineSpacing;const n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize=`${t.fontSize}px`,n.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=t.fontName,o.style.fontSize=`${t.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(n),document.body.appendChild(o);try{const s=o.offsetHeight;return Wl.set(e,s),s*t.lineSpacing}finally{o.remove()}}function Ai(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}class _l extends Ov{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const e=this.preparedTransform;return this.obj.overflow?!0:ve.supports.limitedCanvasSpace?!1:!(e.a===1&&e.b===0&&e.c===0&&e.d===1)}}var tC=Object.defineProperty,nC=(t,e,n)=>e in t?tC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ku=(t,e,n)=>(nC(t,typeof e!="symbol"?e+"":e,n),n);class oC extends _l{constructor(){super(...arguments),ku(this,"_height",0),ku(this,"choiceRenderers",[])}get height(){const e=ie().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=ie().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e,n){const o=ie().Choices,s=this.obj.width,r=o.ChoiceOuterPadding;let l=o.ChoiceOuterPadding;for(const a of this.choiceRenderers){const i=a.getHeight(this.obj.autoWrap?s:0);e.strokeStyle=o.ChoiceButtonBorderColor,e.lineWidth=o.Outline,e.fillStyle=o.ChoiceButtonColor,e.fillRect(r,l,s,i+o.ChoicePadding*2),e.strokeRect(r,l,s,i+o.ChoicePadding*2),a.fixAlignment("center",r,s,l+o.ChoiceSpacing*1.25,this.obj.autoWrap?s:0),a.render(e),l+=i+o.ChoicePadding*2+o.ChoiceSpacing}}prepareRender(e){const n=ie();this.choiceRenderers=this.obj.choices.map(r=>new $t(r.text||" ",n.Choices.ChoiceTextStyle));const o=()=>(this._height=this.choiceRenderers.reduce((r,l)=>r+l.getHeight(this.obj.autoWrap?this.obj.width:0)+n.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e)),s=this.choiceRenderers.map(r=>r.loadFonts()).filter(r=>r!==void 0);if(s.length===0)o();else return Promise.all(s).then(o)}}var sC=Object.defineProperty,rC=(t,e,n)=>e in t?sC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nr=(t,e,n)=>(rC(t,typeof e!="symbol"?e+"":e,n),n);class lC extends _l{constructor(){super(...arguments),nr(this,"_height",0),nr(this,"_width",0),nr(this,"_textRenderer",null),nr(this,"_buttonRenderer",null)}get height(){const e=ie().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=ie().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e){const n=super.prepareRender(e),o=ie().Notification,s=this._textRenderer=new $t(this.obj.text,o.NotificationTextStyle),r=this._buttonRenderer=new $t("OK",o.NotificationOkTextStyle),l=s.loadFonts(),a=r.loadFonts(),i=()=>{const c=this.obj.autoWrap?this.obj.width-o.NotificationPadding*2:0,u=this.obj.autoWrap?c:s.getWidth(),f=s.getHeight(c),p=this.obj.autoWrap?c:r.getWidth(),g=r.getHeight(c);this._width=Math.max(u,p)+o.NotificationPadding*2,this._height=f+o.NotificationPadding*2+o.NotificationSpacing+g};if(n||l||a)return Promise.all([n,l,a]).then(i);i()}render(e,n,o,s,r){return this.obj.backdrop&&Bn(e,()=>{const l=ie();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,n,o,s,r)}renderLocal(e,n){const o=ie(),s=this.obj.autoWrap?this.obj.width-o.Notification.NotificationPadding*2:0,r=this._textRenderer,l=this._buttonRenderer,a=this._width,i=this._height,c=o.Choices.ChoiceOuterPadding;e.fillStyle=o.Choices.ChoiceButtonColor,e.strokeStyle=o.Choices.ChoiceButtonBorderColor,e.lineWidth=o.Choices.Outline,e.fillRect(c,c,a,i),e.strokeRect(c,c,a,i),r.fixAlignment("center",c,a+c,c+o.Notification.NotificationPadding*1.5,s),r.render(e),l.fixAlignment("center",c,a+c,c+i-o.Notification.NotificationPadding,s),l.render(e)}}var iC=Object.defineProperty,aC=(t,e,n)=>e in t?iC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,or=(t,e,n)=>(aC(t,typeof e!="symbol"?e+"":e,n),n),cC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const uC=-2,dC=26,fC=10,pC=10;class hC extends _l{constructor(){super(...arguments),or(this,"_paperHeight",null),or(this,"_paperWidth",null),or(this,"_paper",null),or(this,"_lastPaperUrl",null)}get height(){var e;return(e=this._paperHeight)!=null?e:this.obj.height}get width(){var e;return(e=this._paperWidth)!=null?e:this.obj.width}prepareRender(e){const n=super.prepareRender(e),o=ie().Poem,s=o.poemBackgrounds[this.obj.background],r=o.poemTextStyles[this.obj.font],a=new $t(this.obj.text,r).loadFonts();let i;if(s.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==s.file&&(i=cC(this,null,function*(){this._paper=yield Do(`assets/poemBackgrounds/${s.file}`),this._lastPaperUrl=s.file,this._paperHeight=this._paper.height*o.backgroundScale,this._paperWidth=this._paper.width*o.backgroundScale})),n||a||i)return Promise.all([n,a,i])}renderLocal(e,n){const o=ie().Poem,s=o.poemBackgrounds[this.obj.background],r=this.width,l=this.height;let a=o.poemPadding,i=o.poemTopPadding,c=a*2;if(s.file==="internal:console")e.fillStyle=this.obj.consoleColor||o.consoleBackgroundColor,e.fillRect(0,0,r,l),a=uC,i=dC,c=fC;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:r,h:l}),!this.obj.overflow)){const p=new Path2D;p.rect(0,0,r,l),e.clip(p)}const u=o.poemTextStyles[this.obj.font],f=new $t(this.obj.text,u);f.fixAlignment("left",pC+a,a,i+a,this.obj.autoWrap?this.width-c:0),f.render(e)}}class vC extends $v{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}var gC=Object.defineProperty,mC=(t,e,n)=>e in t?gC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bC=(t,e,n)=>(mC(t,typeof e!="symbol"?e+"":e,n),n),yC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Na{constructor(e){this.base=e,bC(this,"nextArrow",null)}static get defaultWidth(){return Jo}static get defaultHeight(){return il+so}static get defaultX(){return ie().Base.screenWidth/2}static get defaultY(){return ie().Base.screenHeight-this.defaultHeight/2-ie().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return $a}getControlsDisabledStyle(){return Bp}get textboxStyle(){return Sa}renderControls(e,n){const s=this.width/2,r=this.getControlsStyle();Cs(e,r),e.fillText("History",s+wa,n),Cs(e,this.base.obj.skip?r:this.getControlsDisabledStyle()),e.fillText("Skip",s+Pa,n),Cs(e,r),e.fillText("Auto   Save   Load   Settings",s+Ca,n)}prepare(){if(!(this.nextArrow instanceof no))return yC(this,null,function*(){this.nextArrow=yield Es("next")})}}var _C=Object.defineProperty,wC=(t,e,n)=>e in t?_C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sn=(t,e,n)=>(wC(t,typeof e!="symbol"?e+"":e,n),n),Ou=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class ts extends Na{constructor(){super(...arguments),Sn(this,"backgroundImage","textbox"),Sn(this,"xOffset",0),Sn(this,"nameBoxAsset",null),Sn(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return il+so}get width(){return Jo}get nameboxWidth(){return Fs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return ul}get textOffsetX(){return Ns}get textOffsetY(){return al}renderNamebox(e,n,o){var s;(s=this.nameBoxAsset)==null||s.paintOnto(e,{x:n,y:o})}renderBackdrop(e,n,o){var s;n+=this.xOffset,(s=this.backdropAsset)==null||s.paintOnto(e,{x:n,y:o})}render(e){var n;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,l=r-_a;this.obj.controls&&this.renderControls(e,l),this.obj.continue&&((n=this.nextArrow)==null||n.paintOnto(e,{x:o-xa,y:r-ka}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof no?void 0:Ou(this,null,function*(){this.backdropAsset=yield Es(this.backgroundImage)}),this.nameBoxAsset instanceof no?void 0:Ou(this,null,function*(){this.nameBoxAsset=yield Es("namebox")})])}}Sn(ts,"id","normal");Sn(ts,"label","Normal");Sn(ts,"priority",0);Sn(ts,"gameMode","ddlc");var PC=Object.defineProperty,CC=(t,e,n)=>e in t?PC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Uo=(t,e,n)=>(CC(t,typeof e!="symbol"?e+"":e,n),n);class Us extends ts{constructor(){super(...arguments),Uo(this,"backgroundImage","textbox_monika"),Uo(this,"xOffset",(Jo-ya)/2)}}Uo(Us,"id","corrupt");Uo(Us,"label","Corrupted");Uo(Us,"priority",1);Uo(Us,"gameMode","ddlc");var xC=Object.defineProperty,kC=Object.defineProperties,OC=Object.getOwnPropertyDescriptors,$u=Object.getOwnPropertySymbols,$C=Object.prototype.hasOwnProperty,SC=Object.prototype.propertyIsEnumerable,Ei=(t,e,n)=>e in t?xC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,IC=(t,e)=>{for(var n in e||(e={}))$C.call(e,n)&&Ei(t,n,e[n]);if($u)for(var n of $u(e))SC.call(e,n)&&Ei(t,n,e[n]);return t},jC=(t,e)=>kC(t,OC(e)),In=(t,e,n)=>(Ei(t,typeof e!="symbol"?e+"":e,n),n);class ns extends Na{constructor(){super(...arguments),In(this,"_dotPattern",null),In(this,"_lastColor",null),In(this,"backgroundImage","textbox"),In(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Fs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return jC(IC({},ul),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return Ns}get textOffsetY(){return al}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:Cp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(xp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(kp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Bn(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),kv(e,n,o,s,r,Sp),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Ne.fromCss(this.nameboxBackgroundColor),i=new Ne(a.r,a.g,a.b,.95),c=i.toHSL().shift($p).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(Op,i.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=Ne.fromCss(this.customColor),s=o.toHSL(),r=this.obj.height-rn*2-n,l=this.obj.width-rn*2;Bn(e,()=>{e.beginPath(),Ur(e,0,n,l,r,ki),e.clip();const i=e.createLinearGradient(0,n,0,r);i.addColorStop(0,o.toCss()),i.addColorStop(1,`rgba(${o.r},${o.g},${o.b},0.6667)`),e.fillStyle=i,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,l,r),Bn(e,()=>{e.translate(0,n),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(-rn,-rn,l,r)});const c=e.createLinearGradient(0,n+r-Oi,0,n+r);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=c,e.beginPath(),e.ellipse(l/2,n+r,Rp,Oi,0,0,2*Math.PI),e.closePath(),e.fill()});const a=s.shift(Ip).toRgb().toCss();e.strokeStyle=a,e.lineWidth=jp,e.beginPath(),Ur(e,0,n,l,r,ki),e.stroke()}render(e){const n=this.obj.height-rn*2,o=this.obj.width-rn*2;e.translate(rn,rn),this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-_a;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-xa,y:s-ka})}getDotPattern(e=Tp){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;const{dotPatternSize:n,dotColorDelta:o,dotRadius:s}=e,r=Ne.fromCss(this.customColor).toHSL(),l=ro();l.height=n,l.width=n;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=r.shift(o).toRgb().toCss();function i(u,f){a.beginPath(),a.ellipse(u,f,s,s,0,0,2*Math.PI),a.closePath(),a.fill()}i(0,0),i(n,0),i(0,n),i(n,n),i(n/2,n/2);const c=a.createPattern(l,"repeat");if(!c)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=c,c}}In(ns,"id","custom");In(ns,"label","Custom");In(ns,"priority",0);In(ns,"gameMode","ddlc");var TC=Object.defineProperty,AC=(t,e,n)=>e in t?TC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sv=(t,e,n)=>(AC(t,typeof e!="symbol"?e+"":e,n),n),EC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Iv=class jv{constructor(e){this.base=e,Sv(this,"nextArrow",null)}static get resizable(){return!1}static get defaultWidth(){return Ta}static get defaultHeight(){return eh+Ea}static get defaultX(){return ie().Base.screenWidth/2}static get defaultY(){return ie().Base.screenHeight-this.defaultHeight/2-ie().TextBox.TextBoxBottomSpacing}get allowSkippingLocal(){return!0}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Mr}getControlsDisabledStyle(){return dh}renderControls(e,n){const o=this.width,s=o/2,l=s-s,a=this.getControlsStyle(),i=["History","Skip","Auto","Save","Load","Settings"],c=[];let u=0;for(const g of i){const m=jv.controlWidth(e,g);c.push(m),u+=m}const f=Math.min((o-u)/(i.length+2),78);let p=l+(o-u-f*(i.length-1))/2;for(let g=0;g<i.length;++g){const m=i[g],b=c[g],P=m==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():a;Cs(e,P),e.fillText(m,p,n),p+=b+f}}static controlWidth(e,n){if(this.widthCache[n])return this.widthCache[n];Cs(e,Mr);const o=e.measureText(n).width;return this.widthCache[n]=o,o}prepare(){if(!(this.nextArrow instanceof no))return EC(this,null,function*(){this.nextArrow=yield Es("next_plus")})}};Sv(Iv,"widthCache",{});let RC=Iv;var BC=Object.defineProperty,MC=Object.defineProperties,DC=Object.getOwnPropertyDescriptors,Su=Object.getOwnPropertySymbols,LC=Object.prototype.hasOwnProperty,NC=Object.prototype.propertyIsEnumerable,Ri=(t,e,n)=>e in t?BC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,FC=(t,e)=>{for(var n in e||(e={}))LC.call(e,n)&&Ri(t,n,e[n]);if(Su)for(var n of Su(e))NC.call(e,n)&&Ri(t,n,e[n]);return t},HC=(t,e)=>MC(t,DC(e)),jn=(t,e,n)=>(Ri(t,typeof e!="symbol"?e+"":e,n),n);class Vs extends RC{constructor(){super(...arguments),jn(this,"_lastColor",null),jn(this,"_dotPattern",null),jn(this,"backgroundImage","textbox"),jn(this,"xOffset",0)}static get resizable(){return!0}get allowSkippingLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ra}get nameboxHeight(){return Ea}get nameboxOffsetX(){return Ba}get nameboxOffsetY(){return nh}get nameboxStyle(){return HC(FC({},uh),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return Aa}get textOffsetY(){return th}get textboxStyle(){return fh}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:Up}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(Vp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Ne.fromCss(this.customColor).toHSL().shift(Wp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Bn(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),kv(e,n,o,s,r,Yp),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Ne.fromCss(this.nameboxBackgroundColor),i=new Ne(a.r,a.g,a.b,.95),c=i.toHSL().shift(Xp).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(zp,i.toCss()),l.addColorStop(1,c.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=this.obj.height-Xn*2-n,s=this.obj.width-Xn*2,r=Ne.fromCss(this.customColor).toHSL();Bn(e,()=>{e.beginPath(),Ur(e,0,n,s,o,$i),e.clip();const a=e.createLinearGradient(0,n,0,n+o),i=Ne.fromHex(this.customColor);a.addColorStop(0,i.toCss()),a.addColorStop(1,`rgba(${i.r},${i.g},${i.b},0.6667)`),e.fillStyle=a,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,s,o),e.strokeRect(0,n,s,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,n,s,o);const c=e.createLinearGradient(0,n+o-Si,0,n+o);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=c,e.beginPath(),e.ellipse(s/2,n+o,ch,Si,0,0,2*Math.PI),e.closePath(),e.fill()});const l=r.shift(qp).toRgb().toCss();e.strokeStyle=l,e.lineWidth=Gp,e.beginPath(),Ur(e,0,n,s,o,$i),e.stroke()}render(e){const n=this.obj.height-Xn*2,o=this.obj.width-Xn*2;e.translate(Xn,Xn),this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-oh;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-ih,y:s-ah})}getDotPattern(){return ns.prototype.getDotPattern.call(this,Kp)}}jn(Vs,"id","custom_plus");jn(Vs,"label","Custom (Plus)");jn(Vs,"priority",0);jn(Vs,"gameMode","ddlc_plus");var UC=Object.defineProperty,VC=(t,e,n)=>e in t?UC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wl=(t,e,n)=>(VC(t,typeof e!="symbol"?e+"":e,n),n),WC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Ws extends Na{static get resizable(){return!0}get height(){return il+so}get width(){return Jo}get nameboxWidth(){return Fs}get nameboxHeight(){return so}get nameboxOffsetX(){return Hs}get nameboxOffsetY(){return cl}get nameboxStyle(){return ul}get textOffsetX(){return Ns}get textOffsetY(){return al}get textboxStyle(){return Sa}render(e){return WC(this,null,function*(){})}}wl(Ws,"id","none");wl(Ws,"label","None");wl(Ws,"priority",0);wl(Ws,"gameMode","ddlc");var zC=Object.defineProperty,XC=(t,e,n)=>e in t?zC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,us=(t,e,n)=>(XC(t,typeof e!="symbol"?e+"":e,n),n);const YC=[ts,Us,ns,Ws,Vs],xs=(()=>{const t={};for(const e of YC)t[e.id]=e;return t})();class qC extends _l{constructor(){super(...arguments),us(this,"nbTextRenderer",null),us(this,"textRenderer",null),us(this,"_lastRefVars",null),us(this,"refObject",null),us(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e,n;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:(n=(e=this.refObject)==null?void 0:e.label)!=null?n:"Missing name"}get canSkipLocal(){var e,n;return super.canSkipLocal&&((n=(e=this._lastRenderer)==null?void 0:e.allowSkippingLocal)!=null?n:!0)}prepareData(e,n){var o;super.prepareData(e,n),typeof this.obj.talkingObjId=="number"&&(this.refObject=(o=e.objects[this.obj.talkingObjId])!=null?o:null)}prepareRender(e){const n=super.prepareRender(e),o=this.textboxRenderer.prepare(),s=this.getRefVars();s!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=s),this.nbTextRenderer=new $t(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new $t(this.obj.text,this.textboxRenderer.textboxStyle);const r=this.nbTextRenderer.loadFonts(),l=this.textRenderer.loadFonts();if(!(!n&&!o&&!r&&!l))return Promise.all([n,o,r,l])}renderLocal(e,n){const o=this.textboxRenderer,s=o.width;if(!this.obj.overflow){const r=new Path2D;r.rect(0,0,o.width,this.height),e.clip(r)}o.render(e),this.obj.talkingObjId!==null&&this.renderName(e,o.nameboxOffsetX,0),this.renderText(e,0,0,this.obj.autoWrap?s:0)}renderName(e,n,o){const s=this.textboxRenderer,r=s.nameboxWidth;this.nbTextRenderer.fixAlignment("center",n,n+r,o+s.nameboxOffsetY,0),this.nbTextRenderer.render(e)}renderText(e,n,o,s){const r=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.fixAlignment("left",n+r.textOffsetX,0,o+r.nameboxHeight+r.textOffsetY,s-r.textOffsetX*2),l.render(e)}get forcedStyle(){const e=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,n=xs[e];if(this._lastRenderer&&this._lastRenderer.constructor===n)return this._lastRenderer;const o=new n(this);return this._lastRenderer=o,o}}var GC=Object.defineProperty,KC=(t,e,n)=>e in t?GC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mr=(t,e,n)=>(KC(t,typeof e!="symbol"?e+"":e,n),n),JC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Tv=class Av{constructor(e,n,o,s){this.store=e,this._panelId=n,this.canvasWidth=o,this.canvasHeight=s,mr(this,"renderObjectCache",new Map),mr(this,"renderer"),mr(this,"_disposed",!1),this.renderer=new vh(o,s)}get panelId(){return this._panelId}setPanelId(e){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==e&&(this._panelId=e,this.renderObjectCache.forEach(n=>{n.dispose()}),this.renderObjectCache.clear())}render(e,n,o){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,o),e,n):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const e=new Date,n=`panel-${[e.getFullYear(),`${e.getMonth()+1}`.padStart(2,"0"),`${e.getDate()}`.padStart(2,"0"),`${e.getHours()}`.padStart(2,"0"),`${e.getMinutes()}`.padStart(2,"0"),`${e.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),n)}paintOnto(e,n){this.renderer.paintOnto(e,n)}objectsAt(e,n){const o=new DOMPointReadOnly(e,n);return this.getRenderObjects().filter(s=>s.hitTest(o)).map(s=>s.id)}getLastRenderObject(e){var n;return(n=this.renderObjectCache.get(e))!=null?n:null}renderCallback(e,n){return JC(this,null,function*(){var o,s;if(this._disposed)throw new Error("Disposed scene-renderer called");n.fsCtx.imageSmoothingEnabled=!0,n.fsCtx.imageSmoothingQuality=n.hq?"high":"low",yield(o=this.getBackgroundRenderer())==null?void 0:o.render(n);const r=this.getRenderObjects(),l=new Map,a=new Map;for(const m of r){m.prepareData(this.panel,this.store);const b=m.linkedTo;let P=new DOMMatrixReadOnly;if(b!=null){const O=a.get(b);if(O)P=O;else{const h=l.get(b);h?h.push(m):l.set(b,[m]);continue}}g(m,P)}l.size>0&&console.warn("Not all renderables processed. Infinite loop?");const i=r.map(m=>m.prepareRender(!n.hq)).filter(m=>m!==void 0);i.length>0&&(yield Promise.all(i));const c=this.store.state.ui.selection,u=new Set;c!==null&&p(c,u);const f=(s=document.querySelector(Av.FocusProp))==null?void 0:s.getAttribute("data-obj-id");for(const m of r){const b=c===m.id,P=f===""+m.id;m.render(n.fsCtx,(b?an.Selected:u.has(m.id)?an.Indirectly:an.None)+(P?an.Focused:an.None),n.preview,n.hq,e)}n.applyFilters([...this.panel.filters]),n.preview&&n.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:yield Es("backgrounds/transparent")});function p(m,b){b.add(m);for(const P of r.filter(O=>O.linkedTo===m))p(P.id,b)}function g(m,b){const P=m.prepareTransform(b);a.set(m.id,P);const O=l.get(m.id);if(O){for(const h of O)g(h,P);l.delete(m.id)}}})}getRenderObjects(){const e=this.store.state.panels.panels[this.panelId],n=[...e.order,...e.onTopOrder],o=e.objects,s=Array.from(this.renderObjectCache.keys()).filter(r=>!n.includes(r));for(const r of s)this.renderObjectCache.get(r).dispose(),this.renderObjectCache.delete(r);return n.map(r=>{let l=this.renderObjectCache.get(r);if(!l){const a=o[r],i=a.type;switch(i){case"sprite":l=new vC(a);break;case"character":{const c=a;l=new HP(c,fl(this.store,c));break}case"textBox":l=new qC(a);break;case"choice":l=new oC(a);break;case"notification":l=new lC(a);break;case"poem":l=new hC(a);break;default:throw new Rt.UnreachableCaseError(i)}this.renderObjectCache.set(r,l)}return l})}get panel(){return this.store.state.panels.panels[this.panelId]}getBackgroundRenderer(){const e=this.panel;switch(e.background.current){case"buildin.static-color":return hu.color=e.background.color,hu;default:{const o=this.store.getters["content/getBackgrounds"].get(e.background.current);if(!o)return null;const s=o.variants[e.background.variant];return new $P(e.background.current,s,e.background.flipped,e.background.scaling,e.background.composite,e.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}};mr(Tv,"FocusProp",typeof CSS!="undefined"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let Bi=Tv,sr=null;function Vo(t){if(sr===null||sr.disposed){if(t.state.panels.currentPanel===-1)return null;const e=ie().Base;sr=new Bi(t,t.state.panels.currentPanel,e.screenWidth,e.screenHeight)}return sr}var ZC=Object.defineProperty,QC=Object.defineProperties,ex=Object.getOwnPropertyDescriptors,Iu=Object.getOwnPropertySymbols,tx=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,ju=(t,e,n)=>e in t?ZC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ox=(t,e)=>{for(var n in e||(e={}))tx.call(e,n)&&ju(t,n,e[n]);if(Iu)for(var n of Iu(e))nx.call(e,n)&&ju(t,n,e[n]);return t},sx=(t,e)=>QC(t,ex(e));const rx={setChoicesProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version},setChoiceProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices[e.choiceIdx][e.key]=e.value,++n.version},setChoices(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices=e.choices,++n.version}},lx={createChoice({commit:t,rootState:e,state:n},o){const s=ie(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:sx(ox({},es()),{y:s.Choices.ChoiceY,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,id:r,onTop:!0,autoWrap:!0,type:"choice",choiceDistance:s.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:s.Choices.ChoiceButtonColor})}),r},addChoice({state:t,commit:e},n){const o=t.panels[n.panelId].objects[n.id];e("setChoices",{id:n.id,panelId:n.panelId,choices:[...o.choices,{selected:!1,text:n.text}]})},removeChoice({state:t,commit:e},n){const s=[...t.panels[n.panelId].objects[n.id].choices];s.splice(n.choiceIdx,1),s.length===0&&s.push({selected:!1,text:""}),e("setChoices",{id:n.id,panelId:n.panelId,choices:s})}};var ix=Object.defineProperty,ax=Object.defineProperties,cx=Object.getOwnPropertyDescriptors,Tu=Object.getOwnPropertySymbols,ux=Object.prototype.hasOwnProperty,dx=Object.prototype.propertyIsEnumerable,Au=(t,e,n)=>e in t?ix(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fx=(t,e)=>{for(var n in e||(e={}))ux.call(e,n)&&Au(t,n,e[n]);if(Tu)for(var n of Tu(e))dx.call(e,n)&&Au(t,n,e[n]);return t},px=(t,e)=>ax(t,cx(e));const hx={setNotificationProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},vx={createNotification({commit:t,rootState:e,state:n},o){const s=ie(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:px(fx({},es()),{y:s.Base.screenHeight/2,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,autoWrap:!1,id:r,onTop:!0,type:"notification",customColor:s.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),r}};var gx=Object.defineProperty,mx=Object.defineProperties,bx=Object.getOwnPropertyDescriptors,Eu=Object.getOwnPropertySymbols,yx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,Ru=(t,e,n)=>e in t?gx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wx=(t,e)=>{for(var n in e||(e={}))yx.call(e,n)&&Ru(t,n,e[n]);if(Eu)for(var n of Eu(e))_x.call(e,n)&&Ru(t,n,e[n]);return t},Px=(t,e)=>mx(t,bx(e));const Cx={setPoemProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},xx={createPoem({commit:t,rootState:e,state:n},o){const s=ie(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:{subType:"poem",x:s.Poem.defaultX,y:s.Poem.defaultY,width:s.Poem.defaultPoemWidth,height:s.Poem.defaultPoemHeight,panelId:e.panels.currentPanel,flip:!1,rotation:0,id:r,onTop:!0,opacity:100,type:"poem",version:0,autoWrap:!0,background:s.Poem.defaultPoemBackground,font:s.Poem.defaultPoemStyle,text:`New poem

Click here to edit poem`,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,scaleX:1,scaleY:1,skewX:0,skewY:0,ratio:1,preserveRatio:!0,consoleColor:s.Poem.consoleBackgroundColor,overflow:!1,linkedTo:null}}),r},createConsole({commit:t,rootState:e,state:n},o){const s=ie(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:Px(wx({},es()),{subType:"console",x:s.Poem.consoleWidth/2,y:s.Poem.consoleHeight/2,width:s.Poem.consoleWidth,height:s.Poem.consoleHeight,panelId:e.panels.currentPanel,id:r,onTop:!0,type:"poem",background:s.Poem.defaultConsoleBackground,font:s.Poem.defaultConsoleStyle,text:`> _
  
  Console command
  Click here to edit`,autoWrap:!0,consoleColor:s.Poem.consoleBackgroundColor})}),r}};var kx=Object.defineProperty,Ox=Object.defineProperties,$x=Object.getOwnPropertyDescriptors,Bu=Object.getOwnPropertySymbols,Sx=Object.prototype.hasOwnProperty,Ix=Object.prototype.propertyIsEnumerable,Mu=(t,e,n)=>e in t?kx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jx=(t,e)=>{for(var n in e||(e={}))Sx.call(e,n)&&Mu(t,n,e[n]);if(Bu)for(var n of Bu(e))Ix.call(e,n)&&Mu(t,n,e[n]);return t},Tx=(t,e)=>Ox(t,$x(e)),Ax=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ex={},Rx={createSprite(t,e){return Ax(this,arguments,function*({commit:n,rootState:o,state:s},r){const l=yield fa(r.assets[0],!1);if(!(l instanceof no))return;const a=s.panels[r.panelId].lastObjId+1;return n("create",{object:Tx(jx({},es()),{assets:r.assets,height:l.height,width:l.width,id:a,panelId:o.panels.currentPanel,onTop:!1,type:"sprite",y:ie().Base.screenHeight/2,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})}),a})}};var Bx=Object.defineProperty,Mx=Object.defineProperties,Dx=Object.getOwnPropertyDescriptors,Du=Object.getOwnPropertySymbols,Lx=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable,Lu=(t,e,n)=>e in t?Bx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zl=(t,e)=>{for(var n in e||(e={}))Lx.call(e,n)&&Lu(t,n,e[n]);if(Du)for(var n of Du(e))Nx.call(e,n)&&Lu(t,n,e[n]);return t},Nu=(t,e)=>Mx(t,Dx(e)),Fx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Fu=4,Hx={setTalkingObject(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setResetBounds(t,e){const n=t.panels[e.panelId].objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,n.skewX=e.resetBounds.skewX,n.skewY=e.resetBounds.skewY,n.scaleX=e.resetBounds.scaleX,n.scaleY=e.resetBounds.scaleY,++n.version},setTextBoxProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},Ux={createTextBox({commit:t,state:e,rootState:n},o){var s;const r=ie(),l=e.panels[o.panelId].lastObjId+1,a=r.TextBox.DefaultTextboxStyle,i=xs[a],c=o.resetBounds||{x:i.defaultX,y:i.defaultY,width:i.defaultWidth,height:i.defaultHeight,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0};return t("create",{object:Nu(zl(zl({},es()),c),{panelId:n.panels.currentPanel,id:l,onTop:!0,type:"textBox",continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:a,overrideColor:!1,customColor:r.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:r.TextBoxCustom.controlsDefaultColor,customNameboxColor:r.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:r.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:(s=o.text)!=null?s:"Click here to edit the textbox",resetBounds:c,overflow:!1})}),l},setStyle({state:t,commit:e},n){const o=ie(),s=t.panels[n.panelId].objects[n.id],r=xs[s.style],l=xs[n.style],a=10;let i=!1;const c={panelId:n.panelId,id:n.id,x:s.x,y:s.y};let u=!1;const f={panelId:n.panelId,id:n.id,width:s.width,height:s.height};l.resizable?(r.defaultWidth!==l.defaultWidth&&(u=!0,f.width=Math.max(f.width+l.defaultWidth-r.defaultWidth,a)),r.defaultHeight!==l.defaultHeight&&(u=!0,f.height=Math.max(f.height+l.defaultHeight-r.defaultHeight,a))):(u=!0,f.width=l.defaultWidth,f.height=l.defaultHeight),r.defaultX!==l.defaultX&&(i=!0,c.x=Dr(-f.width+a,c.x+l.defaultX-r.defaultX,o.Base.screenWidth-a)),r.defaultY!==l.defaultY&&(i=!0,c.y=Dr(-f.height+a,c.y+l.defaultY-r.defaultY,o.Base.screenHeight-a)),i&&e("setPosition",c),u&&e("setSize",f),e("setTextBoxProperty",Ev(n.panelId,n.id,"style",n.style))},resetTextboxBounds({commit:t,state:e},n){const o=e.panels[n.panelId].objects[n.id];t("setPosition",{panelId:n.panelId,id:n.id,x:o.resetBounds.x,y:o.resetBounds.y}),t("setSize",{panelId:n.panelId,id:n.id,height:o.resetBounds.height,width:o.resetBounds.width}),t("setRotation",{panelId:n.panelId,id:n.id,rotation:o.resetBounds.rotation}),t("setObjectScale",{panelId:n.panelId,id:n.id,scaleX:o.resetBounds.scaleX,scaleY:o.resetBounds.scaleY}),t("setObjectSkew",{panelId:n.panelId,id:n.id,skewX:o.resetBounds.skewX,skewY:o.resetBounds.skewY})},splitTextbox(t,e){return Fx(this,arguments,function*({commit:n,state:o,dispatch:s},r){const l=o.panels[r.panelId].objects[r.id];if(l.type!=="textBox")return;const a=(l.width-Fu)/2,i=a/2+Fu/2;let c=new DOMMatrixReadOnly().translate(l.x,l.y);l.rotation!==0&&(c=c.rotate(0,0,l.rotation)),l.skewX!==0&&(c=c.skewX(l.skewX)),l.skewY!==0&&(c=c.skewY(l.skewY)),l.flip&&(c=c.flipX()),c=c.scale(l.scaleX,l.scaleY);const u=c.transformPoint(new DOMPointReadOnly(-i,0)),f=c.transformPoint(new DOMPointReadOnly(i,0));n("setResetBounds",{id:r.id,panelId:r.panelId,resetBounds:{x:u.x,y:u.y,width:a,height:l.height,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY}});const p=l.style==="custom_plus"?"custom_plus":"custom";l.style!==p&&(yield s("setStyle",Nu(zl({},r),{style:p})));const g=yield s("createTextBox",{panelId:r.panelId,resetBounds:{x:f.x,y:f.y,width:a,height:l.height,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY}});yield s("setStyle",{panelId:r.panelId,id:g,style:p}),l.flip&&n("setFlip",{id:g,panelId:r.panelId,flip:l.flip}),n("setLink",{id:g,panelId:r.panelId,link:l.linkedTo,rotation:l.rotation,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,x:f.x,y:f.y})})}};function Ev(t,e,n,o){return{id:e,panelId:t,key:n,value:o}}var Vx=Object.defineProperty,Hu=Object.getOwnPropertySymbols,Wx=Object.prototype.hasOwnProperty,zx=Object.prototype.propertyIsEnumerable,Uu=(t,e,n)=>e in t?Vx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xx=(t,e)=>{for(var n in e||(e={}))Wx.call(e,n)&&Uu(t,n,e[n]);if(Hu)for(var n of Hu(e))zx.call(e,n)&&Uu(t,n,e[n]);return t};const Vu=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function Mi(t,e,n){const s=[...e().filters];let r;switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:throw new Rt.UnreachableCaseError(t.type)}s.splice(t.idx,0,r),n({panelId:t.panelId,id:t.id,filters:s})}function Di(t,e,n){const s=[...e().filters];s.splice(t.idx,1),n({id:t.id,panelId:t.panelId,filters:s})}function Li(t,e,n){const s=[...e().filters],r=s[t.idx];s.splice(t.idx,1),s.splice(t.idx+t.moveBy,0,r),n({id:t.id,panelId:t.panelId,filters:s})}function Ni(t,e,n){const s=[...e().filters],r=Xx({},s[t.idx]);s[t.idx]=r,r.type==="drop-shadow"?(t.blurRadius!==void 0&&(r.blurRadius=t.blurRadius),t.color!==void 0&&(r.color=t.color),t.offsetX!==void 0&&(r.offsetX=t.offsetX),t.offsetY!==void 0&&(r.offsetY=t.offsetY)):r.value=t.value,n({id:t.id,panelId:t.panelId,filters:s})}var Yx=Object.defineProperty,qx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,Wu=Object.getOwnPropertySymbols,Kx=Object.prototype.hasOwnProperty,Jx=Object.prototype.propertyIsEnumerable,zu=(t,e,n)=>e in t?Yx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gt=(t,e)=>{for(var n in e||(e={}))Kx.call(e,n)&&zu(t,n,e[n]);if(Wu)for(var n of Wu(e))Jx.call(e,n)&&zu(t,n,e[n]);return t},Xu=(t,e)=>qx(t,Gx(e));const Zx=gt(gt(gt(gt(gt(gt({create(t,{object:e}){const n=t.panels[e.panelId];e.id>n.lastObjId&&(n.lastObjId=e.id),n.objects[e.id]=e,(e.onTop?n.onTopOrder:n.order).push(e.id)},removeFromList(t,e){const n=t.panels[e.panelId],o=e.onTop?n.onTopOrder:n.order,s=o.indexOf(e.id);o.splice(s,1)},addToList(t,e){const n=t.panels[e.panelId];(e.onTop?n.onTopOrder:n.order).splice(e.position,0,e.id)},setOnTop(t,e){const o=t.panels[e.panelId].objects[e.id];o.onTop=e.onTop},setPosition(t,e){const o=t.panels[e.panelId].objects[e.id];o.x=nn(e.x),o.y=nn(e.y)},setLink(t,e){const n=t.panels[e.panelId],o=n.objects[e.id];let s=n.objects[e.link];if(!s&&e.link)throw new Error("Linked object does not exist.");if(s===o)throw new Error("Object cannot link to itself.");for(;s;)if(s=n.objects[s.linkedTo],s===o)throw new Error("Objects cannot be linked recursively.");o.linkedTo=e.link,o.x=nn(e.x),o.y=nn(e.y),o.rotation=nn(e.rotation),o.scaleX=nn(e.scaleX),o.scaleY=nn(e.scaleY),o.skewX=nn(e.skewX),o.skewY=nn(e.skewY)},setFlip(t,e){const o=t.panels[e.panelId].objects[e.id];o.flip=e.flip},setSize(t,e){const o=t.panels[e.panelId].objects[e.id];o.width=Math.round(e.width*100)/100,o.height=Math.round(e.height*100)/100,++o.version},setRatio(t,e){const o=t.panels[e.panelId].objects[e.id];o.preserveRatio=e.preserveRatio,o.ratio=e.ratio},setRotation(t,e){const o=t.panels[e.panelId].objects[e.id];o.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject(t,e){const n=t.panels[e.panelId];delete n.objects[e.id]},setComposition(t,e){const o=t.panels[e.panelId].objects[e.id];o.composite=e.composite},object_setFilters(t,e){const o=t.panels[e.panelId].objects[e.id];o.filters=e.filters},setLabel(t,e){const o=t.panels[e.panelId].objects[e.id];o.label=e.label,++o.version},setTextboxColor(t,e){const o=t.panels[e.panelId].objects[e.id];o.textboxColor=e.textboxColor,++o.version},setEnlargeWhenTalking(t,e){const o=t.panels[e.panelId].objects[e.id];o.enlargeWhenTalking=e.enlargeWhenTalking,++o.version},setObjectNameboxWidth(t,e){const o=t.panels[e.panelId].objects[e.id];o.nameboxWidth=e.nameboxWidth,++o.version},setObjectScale(t,e){const o=t.panels[e.panelId].objects[e.id];o.scaleX=e.scaleX,o.scaleY=e.scaleY,++o.version},setObjectSkew(t,e){const o=t.panels[e.panelId].objects[e.id];o.skewX=e.skewX<0?180-Math.abs(e.skewX)%180:e.skewX%180,o.skewY=e.skewY<0?180-Math.abs(e.skewY)%180:e.skewY%180,++o.version},setOverflow(t,e){const o=t.panels[e.panelId].objects[e.id];"overflow"in o&&(o.overflow=e.overflow,++o.version)}},Ex),mP),Hx),rx),hx),Cx),Qx=gt(gt(gt(gt(gt(gt({removeObject({state:t,commit:e,rootState:n},o){var s;const r=t.panels[o.panelId],l=r.objects[o.id];n.ui.selection===o.id&&e("ui/setSelection",null,{root:!0});for(const a of[...r.onTopOrder,...r.order]){if(l.id===a)continue;const i=r.objects[a];if(i.linkedTo===l.id){const c=Vo(null),u=c==null?void 0:c.getLastRenderObject(i.id);u?e("setLink",gt({panelId:o.panelId,id:i.id,link:null},Lr(u.preparedTransform))):e("setLink",{panelId:o.panelId,id:i.id,link:null,rotation:i.rotation,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,x:i.x,y:i.y})}i.type==="textBox"&&i.talkingObjId===l.id&&e("setTalkingOther",{id:i.id,talkingOther:(s=l.label)!=null?s:"",panelId:o.panelId})}e("removeFromList",{id:o.id,panelId:o.panelId,onTop:l.onTop}),e("removeObject",{id:o.id,panelId:o.panelId})},setPosition({state:t,commit:e,dispatch:n},o){t.panels[o.panelId].objects[o.id].type==="character"?n("setCharacterPosition",o):e("setPosition",o)},setOnTop({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id];s.onTop!==n.onTop&&(e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{id:n.id,panelId:n.panelId,position:(n.onTop?o.onTopOrder:o.order).length,onTop:n.onTop}),e("setOnTop",{panelId:n.panelId,id:n.id,onTop:n.onTop}))},shiftLayer({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id],r=s.onTop?o.onTopOrder:o.order;let a=r.indexOf(s.id)+n.delta;a<0&&(a=0),a>r.length&&(a=r.length),e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{panelId:n.panelId,id:n.id,position:a,onTop:s.onTop})},setPreserveRatio({commit:t,state:e},n){const s=e.panels[n.panelId].objects[n.id],r=n.preserveRatio?s.width/s.height:0;t("setRatio",{panelId:n.panelId,id:n.id,preserveRatio:n.preserveRatio,ratio:r})},copyObjects({commit:t,state:e},{sourcePanelId:n,targetPanelId:o}){const s=e.panels[n],r=e.panels[o],l=[...s.onTopOrder,...s.order],a=new Map;let i=r.lastObjId;for(const c of l){const u=++i;a.set(c,u)}for(const c of l){const u=s.objects[c],f=JSON.parse(JSON.stringify(u));if("talkingObjId"in f){const p=f;p.talkingObjId!==null&&p.talkingObjId!=="$other$"&&a.has(p.talkingObjId)&&(p.talkingObjId=a.get(p.talkingObjId))}t("create",{object:Xu(gt({},f),{id:a.get(c),panelId:o})})}},copyObjectToClipboard({commit:t,state:e},{id:n,panelId:o}){const s=e.panels[o],r=s.objects[n],l=Object.values(s.objects),a=[r];i(r);function i(c,u=!0){if(!u&&c===r)throw new Error("Recursively linked object");for(const f of l)f.linkedTo===c.id&&(a.push(f),i(f,!1))}t("ui/setClipboard",JSON.stringify(a),{root:!0})},pasteObjectFromClipboard({commit:t,state:e,rootState:n}){var o;if(n.ui.clipboard==null)return;const s=JSON.parse(n.ui.clipboard),r=e.panels[e.currentPanel],l=new Map;let a=r.lastObjId;for(const i of s){const c=++a;l.set(i.id,c),i.id=c}for(const i of s)i.linkedTo!=null&&(i.linkedTo=(o=l.get(i.linkedTo))!=null?o:null),t("create",{object:Xu(gt({},i),{panelId:e.currentPanel})})},object_addFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_removeFilter({state:t,commit:e},n){Di(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_moveFilter({state:t,commit:e},n){Li(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_setFilter({state:t,commit:e},n){Ni(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))}},Rx),yP),Ux),lx),vx),xx);function ek(t,e){const n=t.state.panels;for(const o in n){const s=n[o];for(const r in s.objects){const l=s.objects[r];l.type==="character"&&_P(t,l.panelId,l.id,e)}}}function nn(t){return Math.round(t*100)/100}var tk=Object.defineProperty,nk=Object.defineProperties,ok=Object.getOwnPropertyDescriptors,Yu=Object.getOwnPropertySymbols,sk=Object.prototype.hasOwnProperty,rk=Object.prototype.propertyIsEnumerable,qu=(t,e,n)=>e in t?tk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xl=(t,e)=>{for(var n in e||(e={}))sk.call(e,n)&&qu(t,n,e[n]);if(Yu)for(var n of Yu(e))rk.call(e,n)&&qu(t,n,e[n]);return t},lk=(t,e)=>nk(t,ok(e)),br=(t=>(t[t.None=0]="None",t[t.Stretch=1]="Stretch",t[t.Cover=2]="Cover",t))(br||{});const ik="buildin.transparent",rr={panelToUrl:new Map,urlToPanel:new Map,register(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister(t,e){if(this.urlToPanel.has(e)){const n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),n.length===0&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},ak={namespaced:!0,state:{lastPanelId:-1,panels:{},panelOrder:[],currentPanel:null},mutations:Xl({setCurrentPanel(t,{panelId:e}){t.currentPanel=e},setPanelPreview(t,{panelId:e,url:n}){t.panels[e].lastRender=n,rr.register(e,n)},createPanel(t,{panel:e}){t.lastPanelId=e.id,t.panels[e.id]=e},setPanelOrder(t,{panelOrder:e}){t.panelOrder=[...e]},setCurrentBackground(t,{current:e,panelId:n}){const o=t.panels[n];o.background.current=e,o.background.variant=0},setBackgroundColor(t,{color:e,panelId:n}){const o=t.panels[n];o.background.color=e},setBackgroundFlipped(t,{flipped:e,panelId:n}){const o=t.panels[n];o.background.flipped=e},setBackgroundVariant(t,{variant:e,panelId:n}){const o=t.panels[n];o.background.variant=e},setBackgroundScaling(t,{scaling:e,panelId:n}){const o=t.panels[n];o.background.scaling=e},deletePanel(t,{panelId:e}){rr.unregister(e,rr.panelToUrl.get(e)),delete t.panels[e]},setComposition(t,e){const n=t.panels[e.panelId];n.composite=e.composite},setFilters(t,e){const n=t.panels[e.panelId];n.filters=e.filters},backgroundSetComposition(t,e){const n=t.panels[e.panelId];n.background.composite=e.composite},backgroundSetFilters(t,e){const n=t.panels[e.panelId];n.background.filters=e.filters}},Zx),actions:Xl({createPanel({state:t,commit:e}){const n=t.lastPanelId+1;return e("createPanel",{panel:{id:n,background:{color:"#000000",current:ik,flipped:!1,scaling:2,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[],objects:{},onTopOrder:[],order:[],lastObjId:-1}}),e("setPanelOrder",{panelOrder:[...t.panelOrder,n]}),e("setCurrentPanel",{panelId:n}),n},duplicatePanel({state:t,commit:e},{panelId:n}){const o=t.panels[n],s=t.lastPanelId+1;rr.register(s,o.lastRender);const r=JSON.parse(JSON.stringify(o));let l=-1;const a=new Map,i={};for(const u in r.objects)a.set(+u,++l);for(const u in r.objects){const f=r.objects[u],p=a.get(+u);if(i[p]=f,f.panelId=s,f.id=p,"talkingObjId"in f){const g=f;g.talkingObjId!==null&&g.talkingObjId!=="$other$"&&a.has(g.talkingObjId)&&(g.talkingObjId=a.get(g.talkingObjId))}f.linkedTo!=null&&(f.linkedTo=a.get(f.linkedTo))}e("createPanel",{panel:lk(Xl({},r),{id:s,lastObjId:l,objects:i,order:r.order.map(u=>a.get(u)),onTopOrder:r.onTopOrder.map(u=>a.get(u))})});const c=t.panelOrder.indexOf(n);e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,c+1),s,...t.panelOrder.slice(c+1)]}),e("setCurrentPanel",{panelId:s})},seekBackgroundVariant({state:t,rootGetters:e,commit:n},{delta:o}){const s=t.panels[t.currentPanel],l=e["content/getBackgrounds"].get(s.background.current);l&&n("setBackgroundVariant",{panelId:t.currentPanel,variant:gs(l.variants,s.background.variant,o)})},delete({state:t,commit:e},{panelId:n}){if(t.panelOrder.length<=1)return;const o=t.panelOrder.indexOf(n);let s;o===t.panelOrder.length-1?s=o-1:s=o+1,e("setCurrentPanel",{panelId:t.panelOrder[s]}),e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,o),...t.panelOrder.slice(o+1)]}),e("deletePanel",{panelId:n})},fixContentPackRemoval(t,e){const{state:n,rootGetters:o,commit:s,rootState:r}=t;for(const l of Object.values(n.panels)){const a=e.backgrounds.find(f=>f.id===l.background.current);if(!a)return;const i=o["content/getBackgrounds"].get(l.background.current);if(!i){r.content.current.backgrounds.length>0?s("setCurrentBackground",{current:r.content.current.backgrounds[0].id,panelId:l.id}):s("setCurrentBackground",{current:"buildin.transparent",panelId:l.id});return}const c=JSON.stringify(a.variants[l.background.variant]),u=i.variants.findIndex(f=>JSON.stringify(f)===c);u!==l.background.variant&&s("setBackgroundVariant",{variant:u===-1?0:u,panelId:l.id})}ek(t,e)},move({state:t,commit:e},{panelId:n,delta:o}){const s=[...t.panelOrder],r=s.indexOf(n);s.splice(r,1);const l=Math.max(r+o,0);s.splice(l,0,n),e("setPanelOrder",{panelOrder:s})},addFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},removeFilter({state:t,commit:e},n){Di(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},moveFilter({state:t,commit:e},n){Li(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},setFilter({state:t,commit:e},n){Ni(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},backgroundAddFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundRemoveFilter({state:t,commit:e},n){Di(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundMoveFilter({state:t,commit:e},n){Li(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundSetFilter({state:t,commit:e},n){Ni(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))}},Qx)};function Rv(){return{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1}}const ck={namespaced:!0,state:Rv(),mutations:{setVertical(t,e){t.vertical=e},setNsfw(t,e){t.nsfw=e},setLqRendering(t,e){t.lqRendering=e},setSelection(t,e){t.selection=e},setLastDownload(t,e){t.lastDownload=e},setClipboard(t,e){t.clipboard=e},setDarkTheme(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom(t,e){t.defaultCharacterTalkingZoom=e},setColorPicker(t,e){t.pickColor=e}}};var uk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const dk={namespaced:!0,state:{},mutations:{add(t,{name:e,url:n}){t[e]=n}},actions:{add(t,e){return uk(this,arguments,function*({state:n,commit:o,rootState:s},{name:r,url:l}){if(n[r])throw new Error(`There is already an uploaded file called "${r}"`);const a="uploads:"+r;return o("add",{name:a,url:l}),Yf(a,l),yield Z1(s,o,a),a})}}};var fk=Object.defineProperty,pk=Object.defineProperties,hk=Object.getOwnPropertyDescriptors,Gu=Object.getOwnPropertySymbols,vk=Object.prototype.hasOwnProperty,gk=Object.prototype.propertyIsEnumerable,Ku=(t,e,n)=>e in t?fk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yl=(t,e)=>{for(var n in e||(e={}))vk.call(e,n)&&Ku(t,n,e[n]);if(Gu)for(var n of Gu(e))gk.call(e,n)&&Ku(t,n,e[n]);return t},Ju=(t,e)=>pk(t,hk(e)),lr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function De(){return Cy()}const mk=Fy({state:{unsafe:!1},mutations:Yl({setUnsafe(t,e){t.unsafe=e}},J1),actions:{removePacks(t,e){return lr(this,arguments,function*({dispatch:n,commit:o},{packs:s}){o("setUnsafe",!0),yield n("content/removeContentPacks",s),o("setUnsafe",!1)})},getSave(t,e){return lr(this,arguments,function*({state:n},o){const s=yield Lo.getInstance();return JSON.stringify(Ju(Yl({},n),{version:2.5}),(r,l)=>{if(r!=="ui"&&r!=="lastRender")return r==="uploadUrls"?Object.keys(l):r==="content"&&o?l.contentPacks.filter(a=>{var i,c;return!((i=a.packId)!=null&&i.startsWith("dddg.buildin."))||((c=a.packId)==null?void 0:c.endsWith(".nsfw"))}).map(a=>{var i;let c=(i=a.packId)!=null&&i.startsWith("dddg.uploads.")?a:a.packId;if(a.packId!=null){const u=s.getPack(a.packId);u&&u.repoUrl!=null&&(c+=`;${u.repoUrl}`)}return c}):l},2)})},loadSave(t,e){return lr(this,arguments,function*({state:n},o){const s=JSON.parse(o),r=s.content;s.ui=Ju(Yl({},Rv()),{vertical:n.ui.vertical,lqRendering:n.ui.lqRendering,nsfw:r.find(i=>typeof i=="string"&&i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw"))!==void 0,clipboard:n.ui.clipboard,useDarkTheme:n.ui.useDarkTheme,defaultCharacterTalkingZoom:n.ui.defaultCharacterTalkingZoom}),s.uploadUrls={},s.content=yp();const l=yield Lo.getInstance();s.content.contentPacks=[...n.content.contentPacks.filter(i=>{var c;return(c=i.packId)==null?void 0:c.startsWith("dddg.buildin.")}),...(yield Promise.all(r.map(i=>lr(this,null,function*(){if(typeof i!="string")return i;let c=null,u;i.indexOf(";")>=0?[u,c]=i.split(";"):u=i;const f=n.content.contentPacks.find(m=>m.packId===u);if(f)return f;if(i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw")){const m=yield xi(da[i]);return yield Br(m)}c!=null&&!l.hasPack(u)&&(yield l.loadTempPack(c));const p=l.getPack(u);if(!p)return console.warn(`Pack Id ${i} not found!`),null;const g=yield xi(p.dddg2Path||p.dddg1Path);return yield Br(g)})))).filter(i=>i!==null)];let a=s.content.current;for(const i of s.content.contentPacks)a=vr(a,i);s.content.current=a,(s.version==null||s.version<2.5)&&K1(s),this.replaceState(s),je.fire(new tl)})}},modules:{ui:ck,panels:ak,content:T_,uploadUrls:dk}});var bk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const yk={key:0},_k=["onClick"],wk=["onClick"],Pk=5e3,ql=2e4,Zu=100,Ck=Pe({__name:"message-console",props:{loading:{default:!1,type:Boolean}},setup(t){const e=De(),n=t,o=N([]),s=N([]),r=N([]),l=N(!1),a=N(0),i=N(0),c=$(()=>e.state.ui.vertical);u(n.loading),je.subscribe($r,g=>{o.value.push(`Failed to load asset '${g.path}'`),setTimeout(()=>{o.value.shift()},Pk)}),je.subscribe(Bf,g=>{o.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{o.value.shift()},ql)}),je.subscribe(Ts,g=>{s.value.push(g.message)}),je.subscribe(aa,g=>{r.value.push(g)}),je.subscribe(Tt,g=>{o.value.push(g.message),setTimeout(()=>{o.value.shift()},ql)}),je.subscribe(Uf,g=>{o.value.push(g.error.name),o.value.push(JSON.stringify(g.error.stack)),o.value.push(g.info),setTimeout(()=>{o.value.shift(),o.value.shift(),o.value.shift()},ql)});function u(g){g?(i.value&&(clearTimeout(i.value),i.value=0),!l.value&&!a.value&&(a.value=setTimeout(()=>{l.value=!0,a.value=0},Zu))):(a.value&&(clearTimeout(a.value),a.value=0),l.value&&!i.value&&(i.value=setTimeout(()=>{l.value=!1,i.value=0},Zu)))}function f(g){s.value.splice(g,1)}function p(g,m){return bk(this,null,function*(){const b=r.value[g];r.value.splice(g,1),yield b.actions.find(O=>O.name===m).exec()})}return Xe(()=>n.loading,g=>{u(g)}),(g,m)=>(x(),E("div",{id:"messageConsole",class:Me({vertical:c.value})},[l.value?(x(),E("p",yk,"Loading...")):ue("",!0),(x(!0),E(le,null,Ve(o.value,(b,P)=>(x(),E("p",{key:b+"_"+P},$e(b),1))),128)),(x(!0),E(le,null,Ve(r.value,(b,P)=>(x(),E("p",{class:"error",key:"resolvableError_"+P},[W($e(b.message)+" ",1),(x(!0),E(le,null,Ve(b.actions,O=>(x(),E("a",{href:"#",key:"resolvableError_"+P+O.name,onClick:h=>p(P,O.name)},"["+$e(O.name)+"]",9,_k))),128))]))),128)),(x(!0),E(le,null,Ve(s.value,(b,P)=>(x(),E("p",{class:"error",key:"error_"+P},[W($e(b)+" ",1),d("a",{href:"#",onClick:O=>f(P)},"[Dismiss]",8,wk)]))),128))],2))}}),Re=(t,e)=>{const n=t.__vccOpts||t;for(const[o,s]of e)n[o]=s;return n},xk=Re(Ck,[["__scopeId","data-v-693f6988"]]),kk={key:0,id:"submit-options"},Ok=["onClick"],$k={key:0,id:"submit-options"},Sk=["onClick"],Ik=Pe({__name:"modal-dialog",props:{noBaseSize:Boolean,options:{type:Array,default:[]}},emits:["leave","option"],setup(t,{emit:e}){const n=window.HTMLDialogElement!=null,o=t,s=N(null),r=e;function l(){if(n){const c=s.value;c&&!c.open&&c.showModal()}window.addEventListener("click",i)}function a(){if(n){const c=s.value;c&&c.open&&c.close(),r("leave")}window.removeEventListener("click",i)}function i(c){const u=s.value;u&&u.open?c.target===u&&(a(),c.preventDefault(),c.stopPropagation()):window.removeEventListener("click",i)}return mt(l),uf(l),df(a),Vt(a),(c,u)=>n?(x(),E("dialog",{key:0,ref_key:"dialog",ref:s,class:Me(["native",{"base-size":!o.noBaseSize}]),onCancel:a},[Zt(c.$slots,"default",{},void 0,!0),t.options.length>0?(x(),E("div",kk,[(x(!0),E(le,null,Ve(t.options,f=>(x(),E("button",{key:f,class:"option",onClick:p=>r("option",f)},$e(f),9,Ok))),128))])):ue("",!0)],34)):(x(),E("div",{key:1,class:"dialog-wrapper",onClick:u[1]||(u[1]=f=>c.$emit("leave"))},[d("dialog",{ref_key:"dialog",ref:s,open:"",class:Me({"base-size":!o.noBaseSize}),onClick:u[0]||(u[0]=ae(()=>{},["stop"]))},[Zt(c.$slots,"default",{},void 0,!0),t.options.length>0?(x(),E("div",$k,[(x(!0),E(le,null,Ve(o.options,f=>(x(),E("button",{key:f,class:"option",onClick:p=>r("option",f)},$e(f),9,Sk))),128))])):ue("",!0)],2)]))}}),$o=Re(Ik,[["__scopeId","data-v-3893e2f9"]]),jk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Tk="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z'/%3e%3c/svg%3e",Ak="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23000'%20stroke='%23000'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e",Ek="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%20fill='%23fff'%20stroke='%23fff'%3e%3cpath%20d='M440-80q-50-5-96-24.5T256-156l56-58q29%2021%2061.5%2034t66.5%2018v82Zm80%200v-82q104-15%20172-93.5T760-438q0-117-81.5-198.5T480-718h-8l64%2064-56%2056-160-160%20160-160%2056%2058-62%2062h6q75%200%20140.5%2028.5t114%2077q48.5%2048.5%2077%20114T840-438q0%20137-91%20238.5T520-80ZM198-214q-32-42-51.5-88T122-398h82q5%2034%2018%2066.5t34%2061.5l-58%2056Zm-76-264q6-51%2025-98t51-86l58%2056q-21%2029-34%2061.5T204-478h-82Z'/%3e%3c/svg%3e";var Rk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function Wo(t,e){return Rk(this,null,function*(){try{yield e()}catch(n){Bk(n)}})}function Bk(t){console.error("Error in promise",name,t),je.fire(new Ts("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+name+'", '+Mk(t)))}function Mk(t){if(t instanceof Error){if(t.stack!=null){const e=t.stack.split(`
`);return e[0].includes(t.name)&&e[0].includes(t.message)?e[0]+`
<br />`+e[1]:t.name+": "+t.message+`
<br />`+e[0]}return t.name+": "+t.message}return t instanceof Object?JSON.stringify(t):""+t}var Dk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())}),Qu;const kn=(Qu=window.devicePixelRatio)!=null?Qu:1;function Lk(t,e){const n=Hk(e);if(t.save(),Qe)o(e,Qe.lastPos),Qe.grabby.paint(t,Qe),t.translate(Qe.lastPos.x,Qe.lastPos.y),t.scale(kn,kn),td(t,Qe.grabby,new DOMPointReadOnly);else{const s=ie();t.translate(n.x,n.y),t.scale(kn,kn),e.x>s.Base.screenWidth/2&&t.scale(-1,1),e.y>s.Base.screenHeight/2&&t.scale(1,-1);for(let r=0;r<Wr.length;r++){const l=Wr[r];l.pos||(l.pos=Vk(Uk*(r+1))),td(t,l,l.pos)}}t.restore();function o(s,r){t.save();try{t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(r.x,r.y),t.setLineDash([5*kn,5*kn]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}const Vr=2*Math.PI,Wr=[{icon:Ak,iconDark:Ek,paint(t,{lastPos:e,center:n,initialDragAngle:o}){const{angle:s}=ir(ds(n,e)),r=ie().Base;let l=Ii(o-s,Vr);t.beginPath(),t.moveTo(n.x,n.y);let a=o-Math.PI,i=a+s-o;if(l<=Math.PI){const c=i;i=a,a=c}t.arc(n.x,n.y,r.wheelInnerRadius,a,i),t.lineTo(n.x,n.y),t.globalCompositeOperation="difference",t.fillStyle="rgba(255, 255, 255, 1)",t.fill(),t.globalCompositeOperation="source-over"},onStartMove(t,e,n){n.initalObjRotation=e.rotation;const{angle:o}=ir(ds(n.center,n.lastPos));n.initialDragAngle=o},onMove(t,e,n,{center:o,initalObjRotation:s,initialDragAngle:r}){const{angle:l}=ir(ds(o,Qe.lastPos));let a=Ii(s+(l-r)/Math.PI*180,360);n&&(a=Math.round(a/22.5)*22.5),e.rotation!==a&&t.commit("panels/setRotation",{panelId:e.panelId,id:e.id,rotation:a})}},{icon:jk,iconDark:Tk,paint(t,{renderObj:e,originalObjTransform:n}){if(!n)return;const o=e.preparedTransform;try{e.preparedTransform=n,Bn(t,()=>{t.globalAlpha=.5,e.render(t,an.None,!0,!1,!0),t.globalAlpha=1})}finally{e.preparedTransform=o}},onStartMove(t,e,n){n.originalObjTransform=n.renderObj.preparedTransform,n.initialScaleX=e.scaleX,n.initialScaleY=e.scaleY,n.initialDelta=ds(n.center,n.lastPos)},onMove(t,e,n,{initialScaleX:o,initialScaleY:s,initialDelta:r,center:l,lastPos:a}){const i=ie(),c=ds(l,a);let u=c.x/r.x*o,f=c.y/r.y*s;if(n){let p=c;l.x>i.Base.screenWidth/2&&(p=new DOMPointReadOnly(-p.x,p.y)),l.y>i.Base.screenHeight/2&&(p=new DOMPointReadOnly(p.x,-p.y));const{angle:g}=ir(p),m=Math.round(g/Vr*11),b=(Math.abs(c.x)/Math.abs(r.x)+Math.abs(c.y)/Math.abs(r.y))/2;m===0||m===11?f=s:m===1?(u=-b*o,f=-b*s):m===2||m===3?u=o:m===4?(u=b*o,f=-b*s):m===5||m===6?f=s:m===7?(u=b*o,f=b*s):m===8||m===9?u=o:m===10&&(u=-b*o,f=b*s)}e.scaleX===u&&e.scaleY===f||t.commit("panels/setObjectScale",{panelId:e.panelId,id:e.id,scaleX:u,scaleY:f})}}];let Qe=null;function Nk(t){const e=ie(),n=Wr.find(o=>{const s=o.lastDrawPos;return s?Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))<=e.Base.wheelWidth/2*kn:!1});return n?(Qe={lastPos:t,started:!1,grabby:n,center:null,renderObj:null},!0):!1}function Fk(t,e,n){var o,s;if(!Qe)return!1;const r=t.state.panels,a=r.panels[r.currentPanel].objects[t.state.ui.selection];if(!Qe.started){Qe.started=!0;const i=Vo(t),c=i==null?void 0:i.getLastRenderObject(a.id),u=(s=(o=i==null?void 0:i.getLastRenderObject(a.linkedTo))==null?void 0:o.preparedTransform)!=null?s:new DOMMatrixReadOnly;Qe.renderObj=c,Qe.center=u.transformPoint(new DOMPointReadOnly(a.x,a.y)),Qe.grabby.onStartMove(t,a,Qe)}return Qe.lastPos=e,Qe.grabby.onMove(t,a,n,Qe),!0}function ed(){return Qe?(Qe=null,!0):!1}const Fi=new Map;for(const t of Wr)Wo("Loading grabby icon",(e=>Dk(void 0,null,function*(){Fi.set(e.icon,yield Do(e.icon)),Fi.set(e.iconDark,yield Do(e.iconDark))})).bind(void 0,t));function td(t,e,n){var o;const s=ie();t.save(),t.translate(n.x,n.y),e.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,s.Base.wheelWidth/2,s.Base.wheelWidth/2,0,0,Vr),t.closePath();const r=getComputedStyle(document.body);t.fillStyle=r.getPropertyValue("--accent-background"),t.strokeStyle=r.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const l=document.body.classList.contains("dark-theme")?e.iconDark:e.icon;(o=Fi.get(l))==null||o.paintOnto(t),t.restore()}function Hk(t){const e=ie(),n=e.Base.wheelWidth+e.Base.wheelInnerRadius*kn;return new DOMPointReadOnly(Dr(n,t.x,e.Base.screenWidth-n),Dr(n,t.y,e.Base.screenHeight-n))}const Uk=Math.PI/6;function Vk(t){const e=ie().Base;return new DOMPointReadOnly(e.wheelInnerRadius*Math.cos(t),e.wheelInnerRadius*Math.sin(t))}function ds(t,e){return new DOMPointReadOnly(t.x-e.x,t.y-e.y)}function ir(t){const e=Math.atan2(t.y,t.x);return{angle:Ii(e,Vr),distance:Math.sqrt(t.x*t.x+t.y*t.y)}}var bo=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Wk=["height","width"],zk=Pe({__name:"render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},setup(t,{expose:e}){const n=De(),o=t,s=N(null),r=N(null),l=N(null),a=N(!1),i=N(!1),c=$(()=>{var J;return(J=n.state.ui.selection)!=null?J:null}),u=$(()=>n.state.panels.panels[n.state.panels.currentPanel]),f=$(()=>n.state.ui.lqRendering);function p(){if(o.preLoading)return null;const J=Vo(n);return J==null||J.setPanelId(n.state.panels.currentPanel),J}const g=$(()=>(o.preLoading,ie().Base.screenHeight)),m=$(()=>(o.preLoading,ie().Base.screenWidth));function b(){l.value==null&&(l.value=requestAnimationFrame(P))}function P(){return bo(this,null,function*(){var J;if(l.value!=null&&(cancelAnimationFrame(l.value),l.value=null),!o.preLoading&&!n.state.unsafe){try{yield(J=p())==null?void 0:J.render(!f.value,!0,!0)}catch(me){console.log(me)}h(),je.fire(new Lf)}})}function O(){const J=document.createElement("canvas");J.height=g.value,J.width=m.value;try{Fo.make(J,!0,!1).drawText({text:"Starting...",x:J.width/2,y:J.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),r.value.drawImage(J,o.canvasWidth,o.canvasHeight)}finally{No(J)}}function h(){const J=p();a.value=!1,J==null||J.paintOnto(r.value,{x:0,y:0,w:m.value,h:g.value});const me=J==null?void 0:J.getLastRenderObject(c.value);me&&Lk(r.value,me.preparedTransform.transformPoint(new DOMPoint(0,0))),j.value=!1}function v(J,me,xe){const z=s.value,X=J-z.offsetLeft,se=me-z.offsetTop;let ge=X/z.offsetWidth*z.width,y=se/z.offsetWidth*z.width;if(xe){const C=xe.transformPoint(new DOMPointReadOnly(ge,y));ge=C.x,y=C.y}return[ge,y]}function _(J){var me;const[xe,z]=v(J.clientX,J.clientY);if(D(xe,z))return;if(i.value){i.value=!1;return}const X=p().objectsAt(xe,z),se=c.value,ge=X.findIndex(C=>C===se);let y;ge===0?y=null:ge!==-1?y=X[ge-1]:y=(me=X[X.length-1])!=null?me:null,Z(()=>{n.state.ui.selection!==y&&n.commit("ui/setSelection",y)})}Xe(()=>[o.canvasWidth,o.canvasHeight],()=>h()),je.subscribe(tl,b),je.subscribe(Hf,()=>{const J=p();J&&J.setPanelId(-1)}),n.subscribe(J=>{J.type!=="panels/setPanelPreview"&&J.type!=="panels/currentPanel"&&b()}),mt(()=>{r.value=s.value.getContext("2d"),O(),b()}),Vt(()=>{p().dispose()});const j=N(!1);function S(J){return bo(this,null,function*(){if(j.value)P(),j.value=!1;else{const me=yield Tr(J,!0);r.value.clearRect(0,0,s.value.width,s.value.height),me.paintOnto(r.value,{x:0,y:0}),j.value=!0}r.value})}const T=$(()=>n.state.ui.pickColor),R=$(()=>T.value?"crosshair":"default");function D(J,me){if(T.value){const xe=r.value.getImageData(J,me,1,1).data,z=`rgba(${xe[0].toString()},${xe[1].toString()},${xe[2].toString()},${(xe[3]/255).toString()})`;return Z(()=>{n.commit("ui/setColorPicker",!1),je.fire(new Sr(z))}),!0}return!1}function F(){return bo(this,null,function*(){const J=yield p().download();yield Z(()=>{const me=n.state.ui.lastDownload;n.commit("ui/setLastDownload",J),me!=null&&URL.revokeObjectURL(me)})})}let K=null,Q=null,fe=0,we=0,Be=0,U=0;function B(J){J.preventDefault(),w(J.clientX,J.clientY)}function k(J){w(J.touches[0].clientX,J.touches[0].clientY)}function w(J,me){var xe,z,X;const se=c.value;if(se===null)return;K=u.value.objects[se],Q=(X=(z=(xe=Vo(n).getLastRenderObject(K.linkedTo))==null?void 0:xe.preparedTransform)==null?void 0:z.inverse())!=null?X:new DOMMatrixReadOnly;const[ge,y]=v(J,me,Q);se!=null&&Nk(new DOMPointReadOnly(...v(J,me)))||(fe=ge-K.x,we=y-K.y,Be=K.x,U=K.y)}function L(J){J.stopPropagation(),J.preventDefault(),J.dataTransfer.dropEffect="copy"}function oe(J){if(!K)return;J.preventDefault();const me=J instanceof MouseEvent?J.clientX:J.touches[0].clientX,xe=J instanceof MouseEvent?J.clientY:J.touches[0].clientY;let[z,X]=v(me,xe,Q);if(Fk(n,new DOMPointReadOnly(...v(me,xe)),J.shiftKey)){b();return}z-=fe,X-=we;const se=Math.abs(z-Be),ge=Math.abs(X-U);se+ge>1&&(i.value=!0),J.shiftKey&&(se>ge?X=U:z=Be),Z(()=>bo(this,null,function*(){yield n.dispatch("panels/setPosition",{panelId:K.panelId,id:K.id,x:z,y:X})}))}function Ce(J){return bo(this,null,function*(){if(J.stopPropagation(),J.preventDefault(),!!J.dataTransfer){for(const me of J.dataTransfer.items)if(me.kind==="file"&&me.type.match(/image.*/)){const xe=me.getAsFile(),z=URL.createObjectURL(xe);try{const X=yield n.dispatch("uploadUrls/add",{name:xe.name,url:z});yield Z(()=>bo(this,null,function*(){yield n.dispatch("panels/createSprite",{panelId:n.state.panels.currentPanel,assets:[{hq:X,lq:X,sourcePack:"dddg.uploaded.sprites"}]})}))}catch(X){URL.revokeObjectURL(z)}}}})}function Ee(J){if(ed()){b(),J.preventDefault(),K=null,i.value=!0;return}K&&("TouchEvent"in window&&J instanceof TouchEvent&&(i.value=!1),K=null)}function it(J){J.buttons!==1&&(K=null,ed()&&b())}return e({download:F,blendOver:S}),(J,me)=>(x(),E("canvas",{id:"scaled_display",ref_key:"sd",ref:s,height:g.value,width:m.value,style:Ke({width:t.canvasWidth+"px",height:t.canvasHeight+"px",cursor:R.value}),draggable:"true",onClick:_,onTouchstart:k,onDragstart:B,onTouchmove:oe,onMousemove:oe,onTouchend:Ee,onMouseup:Ee,onDragover:L,onDrop:Ce,onMouseenter:it,onContextmenu:me[0]||(me[0]=ae(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,Wk))}}),Xk=["disabled","title","aria-label"],Yk={key:0,class:"material-icons","aria-hidden":"true"},qk={class:"content"},Gk={key:1,class:"shortcut-popup"},Kk=Pe({__name:"d-button",props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},shortcut:{type:String,default:null},title:{type:String,default:null}},setup(t){const e=t,n=N(null),o=$(()=>e.shortcut!=null&&!e.shortcut.startsWith("!")),s=$(()=>{const l=e.shortcut;return l==null?"":l.startsWith("!")?l.substring(1):l});function r(l){e.disabled||l.key===e.shortcut&&l.ctrlKey&&!l.altKey&&!l.metaKey&&!l.shiftKey&&(n.value.focus({focusVisible:!1}),n.value.click(),l.preventDefault(),l.stopPropagation())}return mt(()=>{e.shortcut&&window.addEventListener("keydown",r)}),Vt(()=>{window.removeEventListener("keydown",r)}),(l,a)=>{var i,c;return x(),E("button",{class:Me([t.iconPos]),disabled:t.disabled,title:(i=t.title)!=null?i:void 0,"aria-label":(c=t.title)!=null?c:void 0,style:Ke(t.icon?"height: auto":""),ref_key:"btn",ref:n},[t.icon?(x(),E("div",Yk,$e(t.icon),1)):ue("",!0),d("div",qk,[Zt(l.$slots,"default",{},void 0,!0)]),o.value?(x(),E("div",Gk,$e(s.value),1)):ue("",!0)],14,Xk)}}}),Ie=Re(Kk,[["__scopeId","data-v-693e35a8"]]),Jk={methods:{verticalScrollRedirect:Bv}};function Bv(t){if(t.type!=="wheel"||!t.currentTarget)return;const e=t.currentTarget,n=getComputedStyle(e),o=t;if(o.deltaY===0)return;if(n.overflowY==="auto"){if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight){t.stopPropagation();return}}else if(e.scrollTop>0){t.stopPropagation();return}}const s=e.scrollLeft;e.scrollLeft+=o.deltaY,e.scrollLeft!==s&&t.stopPropagation()}function Mt(t){const e=De(),n=$(()=>e.state.ui.vertical);function o(){const r=t.value;return r?r.$el?r.$el:r:null}function s(){t.value&&o().classList.toggle("vertical",n.value)}return Xe(()=>n.value,s),mt(()=>{s(),o().addEventListener("wheel",r=>{n.value||Bv(r)},{passive:!0})}),{vertical:n,getRoot:o}}var Zk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Qk=["title","onClick","onKeypress"],eO=["src","alt"],tO=Pe({__name:"character",emits:["show-dialog"],setup(t,{emit:e}){const n=De(),o=e,s=$(()=>n.state.content.current.characters);function r(a){return a.chibi?ve.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){Z(()=>Zk(this,null,function*(){yield n.dispatch("panels/createCharacters",{characterType:a,panelId:n.state.panels.currentPanel})}))}return(a,i)=>(x(),E(le,null,[(x(!0),E(le,null,Ve(s.value,c=>(x(),E("div",{class:"character",tabindex:"0",key:c.id,title:c.label,onClick:ae(u=>l(c.id),["left"]),onKeypress:[lt(ae(u=>l(c.id),["prevent","stop"]),["enter"]),lt(ae(u=>l(c.id),["prevent","stop"]),["space"])]},[d("img",{src:r(c),alt:c.label},null,8,eO)],40,Qk))),128)),A(Ie,{class:"custom-sprite",icon:"extension",onClick:i[0]||(i[0]=c=>o("show-dialog","type: Characters"))},{default:q(()=>[W(" Search in content packs ")]),_:1})],64))}}),nO=Re(tO,[["__scopeId","data-v-5519b22d"]]),oO=Pe({__name:"drop-target",emits:["drop"],setup(t,{expose:e,emit:n}){const o=n,s=De(),r=N(!1),l=$(()=>s.state.ui.vertical);function a(){r.value=!0}function i(){r.value=!1}function c(u){if(i(),u.stopPropagation(),u.preventDefault(),!!u.dataTransfer)for(const f of u.dataTransfer.items)f.kind==="file"&&f.type.match(/image.*/)&&o("drop",f.getAsFile())}return e({show:a,hide:i}),(u,f)=>r.value?(x(),E("div",{key:0,onDragleave:f[0]||(f[0]=p=>r.value=!1),onDrop:c,class:Me({vertical:l.value})},[Zt(u.$slots,"default",{},void 0,!0)],34)):ue("",!0)}}),Mv=Re(oO,[["__scopeId","data-v-4179078f"]]);var sO=Object.defineProperty,rO=Object.defineProperties,lO=Object.getOwnPropertyDescriptors,nd=Object.getOwnPropertySymbols,iO=Object.prototype.hasOwnProperty,aO=Object.prototype.propertyIsEnumerable,od=(t,e,n)=>e in t?sO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sd=(t,e)=>{for(var n in e||(e={}))iO.call(e,n)&&od(t,n,e[n]);if(nd)for(var n of nd(e))aO.call(e,n)&&od(t,n,e[n]);return t},rd=(t,e)=>rO(t,lO(e)),on=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const cO=["title","onClick","onKeypress"],uO=["title","onClick","onKeypress"],dO=Pe({__name:"sprite",emits:["show-dialog"],setup(t,{expose:e,emit:n}){const o=De(),s=n,r=$(()=>o.state.content.current.sprites.map(S=>{let T=null;const R=S.variants[0].map(D=>{const F=En(D,!1);return F.startsWith("uploads:")?(Object.keys(o.state.uploadUrls),T=F,zf):F});return rd(sd({},S),{missing:T,urls:R})})),l=$(()=>ve.supports.openableFolders.has("sprites"));function a(S){return S.variants[0].map(T=>`url('${En(T,!1)}')`).join(",")}function i(S){return on(this,null,function*(){yield Z(()=>on(this,null,function*(){yield o.dispatch("panels/createSprite",{panelId:o.state.panels.currentPanel,assets:S.variants[0]})}))})}function c(){ve.openFolder("sprites")}const u=N(null);function f(S){return on(this,null,function*(){const T=u.value,R=T.uploadingSprite;if(!T.files)return;if(T.files.length!==1){console.error("More than one file uploaded!");return}const D=T.files[0];yield Z(()=>on(this,null,function*(){const F=URL.createObjectURL(D);yield o.dispatch("uploadUrls/add",{name:R,url:F})}))})}function p(S){const T=u.value;T.uploadingSprite=En(S.variants[0][0]).substring(8),T.click()}const g={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},m=N(null);function b(){const S=m.value;if(S.files)for(const T of S.files)O(T)}function P(){return on(this,null,function*(){const S=prompt("Enter the URL of the image");if(S==null)return;const T=S.split("/").slice(-1)[0];yield h(T,S)})}function O(S){return on(this,null,function*(){yield Z(T=>on(this,null,function*(){const R=URL.createObjectURL(S),D=yield o.dispatch("uploadUrls/add",{name:S.name,url:R});yield h(S.name,D,T)}))})}function h(S,T){return on(this,arguments,function*(R,D,F=Z){const K=o.state.content.contentPacks.find(fe=>fe.packId===g.packId)||g,Q=rd(sd({},K),{sprites:[...K.sprites,{id:D,label:R,variants:[[{lq:D,hq:D}]],defaultScale:[1,1],hd:null}]});yield F(()=>on(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:Q,processed:!0})}))})}const v=N(null);function _(S){S.dataTransfer&&(S.dataTransfer.effectAllowed="none",Array.from(S.dataTransfer.items).find(T=>T.type.match(/^image.*$/))&&(S.dataTransfer.effectAllowed="link",v.value.show()))}function j(){v.value.hide()}return e({showDropTarget:_,hideDropTarget:j}),(S,T)=>(x(),E(le,null,[A(Mv,{ref_key:"spriteDt",ref:v,class:"drop-target",onDrop:O},{default:q(()=>[W("Drop here to add as a new sprite ")]),_:1},512),(x(!0),E(le,null,Ve(r.value,R=>(x(),E(le,null,[R.missing!==null?(x(),E("div",{class:"sprite",tabindex:"0",key:`${R.label}_missing`,title:R.label,style:Ke({background:a(R)}),onClick:D=>p(R),onKeypress:[lt(ae(D=>p(R),["prevent","stop"]),["enter"]),lt(ae(D=>p(R),["prevent","stop"]),["space"])]},$e(R.label),45,cO)):(x(),E("div",{class:"sprite",tabindex:"0",key:R.label,title:R.label,style:Ke({background:a(R)}),onClick:D=>i(R),onKeypress:[lt(ae(D=>i(R),["prevent","stop"]),["enter"]),lt(ae(D=>i(R),["prevent","stop"]),["space"])]},$e(R.label),45,uO))],64))),256)),A(Ie,{class:"custom-sprite v-w100",icon:"publish",onClick:T[0]||(T[0]=R=>m.value.click())},{default:q(()=>[W(" Upload new sprite "),d("input",{type:"file",ref_key:"spriteUpload",ref:m,onChange:b,multiple:""},null,544)]),_:1}),A(Ie,{icon:"insert_link",onClick:P},{default:q(()=>[W(" New sprite from URL ")]),_:1}),A(Ie,{icon:"extension",onClick:T[1]||(T[1]=R=>s("show-dialog","type: Sprites"))},{default:q(()=>[W(" Search in content packs ")]),_:1}),l.value?(x(),ce(Ie,{key:0,icon:"folder",onClick:c},{default:q(()=>[W(" Open sprites folder ")]),_:1})):ue("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:u,onChange:f},null,544)],64))}}),fO=Re(dO,[["__scopeId","data-v-c43e665a"]]);var zn=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const pO=Pe({__name:"ui",setup(t){const e=De();function n(){return zn(this,null,function*(){return yield a("createTextBox")})}function o(){return zn(this,null,function*(){return yield a("createChoice")})}function s(){return zn(this,null,function*(){return yield a("createNotification")})}function r(){return zn(this,null,function*(){return yield a("createPoem")})}function l(){return zn(this,null,function*(){return yield a("createConsole")})}function a(i){return zn(this,null,function*(){yield Z(()=>zn(this,null,function*(){yield e.dispatch(`panels/${i}`,{panelId:e.state.panels.currentPanel})}))})}return(i,c)=>(x(),E(le,null,[d("button",{class:"v-w100",onClick:n},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:r},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:s},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:o},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}});var hO=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const vO=t=>(_t("data-v-3787cba0"),t=t(),wt(),t),gO=vO(()=>d("h1",null,"Add",-1)),mO=["innerHTML"],bO=["disabled"],yO=Pe({__name:"add",setup(t){const e={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},n=N(null),o=N("characters"),s=N(null),r=De(),{vertical:l}=Mt(n),a=$(()=>r.state.panels.panels[r.state.panels.currentPanel]),i=$(()=>r.state.ui.clipboard!=null);function c(){Z(()=>hO(this,null,function*(){yield r.dispatch("panels/pasteObjectFromClipboard",{panelId:a.value.id})}))}return(u,f)=>(x(),E("div",{class:"panel",ref_key:"root",ref:n,onDragenter:f[2]||(f[2]=(...p)=>{var g,m;return((g=s.value)==null?void 0:g.showDropTarget)&&((m=s.value)==null?void 0:m.showDropTarget(...p))}),onMouseleave:f[3]||(f[3]=(...p)=>{var g,m;return((g=s.value)==null?void 0:g.hideDropTarget)&&((m=s.value)==null?void 0:m.hideDropTarget(...p))})},[gO,d("div",{class:Me({"group-selector":!0,vertical:ne(l)})},[(x(),E(le,null,Ve(e,(p,g)=>A(Ie,{key:g,class:Me({active:o.value===g,"v-bl0":g!=="characters","h-bt0":g!=="characters"}),"icon-pos":"top",icon:p.icon,shortcut:p.shortcut,onClick:m=>o.value=g},{default:q(()=>[d("span",{innerHTML:p.text},null,8,mO)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:Me({"item-grid":!0,vertical:ne(l)})},[o.value==="characters"?(x(),ce(nO,{key:0,onShowDialog:f[0]||(f[0]=p=>u.$emit("show-dialog",p))})):o.value==="sprites"?(x(),ce(fO,{key:1,ref_key:"sprites",ref:s,onShowDialog:f[1]||(f[1]=p=>u.$emit("show-dialog",p))},null,512)):o.value==="ui"?(x(),ce(pO,{key:2})):ue("",!0),d("button",{class:"v-w100",onClick:c,disabled:!i.value}," Paste ",8,bO)],2)],544))}}),_O=Re(yO,[["__scopeId","data-v-3787cba0"]]);var wO=Object.defineProperty,PO=Object.defineProperties,CO=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,xO=Object.prototype.hasOwnProperty,kO=Object.prototype.propertyIsEnumerable,id=(t,e,n)=>e in t?wO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,OO=(t,e)=>{for(var n in e||(e={}))xO.call(e,n)&&id(t,n,e[n]);if(ld)for(var n of ld(e))kO.call(e,n)&&id(t,n,e[n]);return t},$O=(t,e)=>PO(t,CO(e));const SO=Pe({mixins:[Jk],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.$store.state.ui.vertical?"vertical":"horizontal":this.direction==="inverted"?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render(){const t=this.noWraping?"no-wraping":"wraping",n=yc("div",$O(OO({},{}),{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize!==void 0){const o=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return yc("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:o}},[n])}return n},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}}),At=Re(SO,[["__scopeId","data-v-ed79b299"]]);let Hi=0;typeof BigInt!="undefined"&&(Hi=BigInt(0));function Fa(){const t=Hi;return Hi++,t+""}const IO=["for"],jO=["id","x1","x2"],TO=["offset"],AO=["fill"],EO=["d"],RO=["id","max","value"],ar=255,Gl=8,BO=Pe({__name:"slider",props:{label:{type:String,required:!0},gradientStops:{required:!0,type:Array},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{default:!1},noInput:{default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=Fa(),o=t,s=De(),r=e,l=$(()=>s.state.ui.vertical),a=N(null),i=$(()=>{const b=o.modelValue/o.maxValue*ar;return`M${b} 0L${b+14} 0L${b+7} 12Z`}),c=$(()=>!o.shiftGradient||o.modelValue===0?0:o.modelValue/o.maxValue);function u(b){r("update:modelValue",parseFloat(b.target.value))}const f=N(!1);function p(b){f.value=!0,g(b),b instanceof MouseEvent&&(window.addEventListener("mousemove",g),window.addEventListener("mouseup",m)),b.preventDefault()}function g(b){if(!f.value)return;const P=a.value;if(b instanceof MouseEvent&&b.buttons===0){m();return}b.preventDefault();const O=P.getBoundingClientRect(),h=O.width/(Gl+ar+Gl),_=((b instanceof MouseEvent?b.clientX:b.touches[0].clientX)-O.x)/h,j=Math.max(Math.min(_-Gl,ar),0)/ar*o.maxValue;r("update:modelValue",j),b.preventDefault()}function m(){f.value=!1,window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",m)}return(b,P)=>(x(),E("div",{class:Me({slider:!0,vertical:l.value}),onKeydown:P[1]||(P[1]=ae(()=>{},["stop"]))},[t.noInput?ue("",!0):(x(),E("label",{key:0,for:ne(n)},$e(t.label),9,IO)),d("div",null,[(x(),E("svg",{ref_key:"svg",ref:a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:p,onTouchstart:p,onTouchmove:g,onTouchend:m},[d("defs",null,[d("linearGradient",{id:`gradient${ne(n)}`,x1:c.value*100+"%",y1:"0%",x2:(c.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(x(!0),E(le,null,Ve(t.gradientStops,(O,h)=>(x(),E("stop",{key:h,offset:h/(t.gradientStops.length-1)*100+"%",style:Ke("stop-color:"+O)},null,12,TO))),128))],8,jO)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${ne(n)})`},null,8,AO),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,EO)])],544))]),t.noInput?ue("",!0):(x(),E("input",{key:1,id:ne(n),class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:u,onKeydown:P[0]||(P[0]=ae(()=>{},["stop"]))},null,40,RO))],34))}}),Jn=Re(BO,[["__scopeId","data-v-e1e5dccb"]]),MO=Pe({__name:"slider-group",props:{modelValue:{type:String,validator:t=>!!t.match(/^#[0-9a-f]{6,8}$/i)},mode:{type:String},relative:Boolean},emits:["update:modelValue"],setup(t,{emit:e}){const n=e,o=t,s=N(null),r=N(0),l=N(0),a=N(0),i=N(0),c=O({rgba:{label:"Red",stops(){const h=o.relative?l.value:0,v=o.relative?a.value:0;return[new Ne(0,h,v,1),new Ne(255,h,v,1)]}},hsla:{label:"Hue",max:360,stops(){const h=o.relative?l.value/100:1,v=o.relative?a.value/100:.5;return P(_=>new Fe(_,h,v,1))}}}),u=O({rgba:{label:"Green",stops(){const h=o.relative?r.value:0,v=o.relative?a.value:0;return[new Ne(h,0,v,1),new Ne(h,255,v,1)]}},hsla:{label:"Saturation",stops(){const h=o.relative?r.value/360:0,v=o.relative?a.value/100:.5;return P(_=>new Fe(h,_,v,1))}}}),f=O({rgba:{label:"Blue",stops(){const h=o.relative?r.value:0,v=o.relative?l.value:0;return[new Ne(h,v,0,1),new Ne(h,v,255,1)]}},hsla:{label:"Luminosity",stops(){const h=o.relative?r.value/360:0,v=o.relative?l.value/100:.5;return P(_=>new Fe(h,v,_,1))}}}),p=$(()=>{const h=Ne.fromHex(o.modelValue);return[new Ne(h.r,h.g,h.b,0).toCss(),new Ne(h.r,h.g,h.b,1).toCss()]});function g(){o.modelValue!==s.value&&b()}function m(){let h;o.mode==="rgba"?h=new Ne(r.value,l.value,a.value,i.value/255):h=new Fe(r.value/360,l.value/100,a.value/100,i.value/255);const v=h.toRgb().toHex();if(s.value!==v){if(v.length!==9)throw new Error(`Invalid color code: ${v}`);s.value=v,n("update:modelValue",v)}}function b(){const h=Ne.fromHex(o.modelValue);if(s.value=h.toHex(),i.value=h.a*255,o.mode==="hsla"){const v=h.toHSL();r.value=v.h*360,l.value=v.s*100,a.value=v.l*100}else r.value=h.r,l.value=h.g,a.value=h.b}function P(h){const v=[];for(let _=0;_<=8;++_)v.push(h(_/8));return v}Xe(()=>o.modelValue,g),Xe(()=>o.mode,b,{immediate:!0}),Xe(()=>[r.value,l.value,a.value,i.value],m);function O({rgba:h,hsla:v}){const _=$(()=>{var T;return o.mode==="rgba"?255:(T=v.max)!=null?T:100}),j=$(()=>o.mode==="rgba"?h.label:v.label),S=$(()=>(o.mode==="rgba"?h.stops():v.stops()).map(R=>R.toRgb().toCss()));return{maxValue:_,label:j,stops:S}}return(h,v)=>(x(),E("div",null,[A(Jn,{label:ne(c).label.value,modelValue:r.value,"onUpdate:modelValue":v[0]||(v[0]=_=>r.value=_),"max-value":ne(c).maxValue.value,"gradient-stops":ne(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),A(Jn,{label:ne(u).label.value,modelValue:l.value,"onUpdate:modelValue":v[1]||(v[1]=_=>l.value=_),"max-value":ne(u).maxValue.value,"gradient-stops":ne(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),A(Jn,{label:ne(f).label.value,modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=_=>a.value=_),"max-value":ne(f).maxValue.value,"gradient-stops":ne(f).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),A(Jn,{label:"Alpha",modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=_=>i.value=_),"max-value":255,"gradient-stops":p.value},null,8,["modelValue","gradient-stops"])]))}}),DO=Re(MO,[["__scopeId","data-v-62add962"]]);var LO=Object.defineProperty,NO=Object.defineProperties,FO=Object.getOwnPropertyDescriptors,ad=Object.getOwnPropertySymbols,HO=Object.prototype.hasOwnProperty,UO=Object.prototype.propertyIsEnumerable,cd=(t,e,n)=>e in t?LO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ud=(t,e)=>{for(var n in e||(e={}))HO.call(e,n)&&cd(t,n,e[n]);if(ad)for(var n of ad(e))UO.call(e,n)&&cd(t,n,e[n]);return t},dd=(t,e)=>NO(t,FO(e)),VO=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const WO={class:"v-w100 h-h100"},zO={class:"hex-selector"},XO=["for"],YO=["id","value"],qO=["title","onClick"],fd="dddg.generated.colors",GO=Pe(dd(ud({},{inheritAttrs:!1}),{__name:"color",props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},emits:["leave","update:modelValue"],setup(t,{emit:e}){const n=Fa(),o=De(),s=e,r=t,l=N("hsla"),a=$(()=>o.state.ui.vertical),i=$({get(){return r.format==="rgb"?Ne.fromCss(r.modelValue).toHex():r.modelValue},set(m){if(r.format==="rgb"){const b=Ne.fromCss(m);s("update:modelValue",b.toCss())}else s("update:modelValue",m)}});function c(m){const b=m.target.value;Ne.validHex(b)&&(b.length===7||b.length===9)&&(i.value=b)}const u=$(()=>o.state.content.current.colors);function f(){if(u.value.find(P=>P.color===i.value))return;const m=o.state.content.contentPacks.find(P=>P.packId===fd)||{packId:fd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},b=dd(ud({},m),{colors:[...m.colors,{label:i.value,color:i.value}]});Z(()=>VO(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:b,processed:!0})}))}function p(){Z(()=>{o.commit("ui/setColorPicker",!0)})}function g(m){i.value=Ne.fromCss(m.color).toHex()}return mt(()=>{je.subscribe(Sr,g)}),Vt(()=>{je.unsubscribe(Sr,g)}),(m,b)=>(x(),E("div",{class:Me([{color:!0,vertical:a.value},"v-w100 h-h100"])},[d("h2",null,$e(t.title),1),d("button",{onClick:b[0]||(b[0]=P=>m.$emit("leave"))},"OK"),d("table",null,[d("tr",null,[d("td",null,[d("button",{onClick:b[1]||(b[1]=P=>l.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:b[2]||(b[2]=P=>l.value="rgba")},"RGBA")])])]),d("div",WO,[A(DO,{mode:l.value,modelValue:i.value,"onUpdate:modelValue":b[3]||(b[3]=P=>i.value=P),relative:!0},null,8,["mode","modelValue"]),d("div",zO,[d("label",{class:"hex-label",for:`hex_${ne(n)}`},"Hex",8,XO),d("input",{id:`hex_${ne(n)}`,value:i.value,onInput:c,onKeydown:b[4]||(b[4]=ae(()=>{},["stop"]))},null,40,YO)]),A(At,{direction:"global",class:"color-tools"},{default:q(()=>[d("button",{onClick:f},"Add as swatch"),A(Ie,{class:"h-bl0 v-bt0",icon:"colorize",onClick:p},{default:q(()=>[W("Pick color")]),_:1})]),_:1})]),d("div",{id:"color-swatches",class:Me({vertical:a.value})},[(x(!0),E(le,null,Ve(u.value,P=>(x(),E("button",{class:"swatch",key:P.color,style:Ke({backgroundColor:P.color}),title:P.label,onClick:O=>{i.value=P.color,s("leave")}},null,12,qO))),128))],2)],2))}})),Pl=Re(GO,[["__scopeId","data-v-c953cf4f"]]),KO={class:"fieldset_wrapper"},JO={key:0},ZO={class:"fieldset_contents"},QO=Pe({__name:"d-fieldset",props:{title:{required:!0,type:String}},setup(t){const e=t;return(n,o)=>(x(),E("div",KO,[d("fieldset",null,[t.title>""?(x(),E("legend",JO,$e(e.title),1)):ue("",!0),d("div",ZO,[Zt(n.$slots,"default",{},void 0,!0)])])]))}}),St=Re(QO,[["__scopeId","data-v-2b2d1b79"]]),e$=["href"],Ye=Pe({__name:"link",props:{to:{type:String,required:!0}},setup(t){const e=N(null),n=t,o=$(()=>{let s=n.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,l)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+l.replaceAll(" ","-")),s});return(s,r)=>(x(),E("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[Zt(s.$slots,"default")],8,e$))}});var t$=Object.defineProperty,pd=Object.getOwnPropertySymbols,n$=Object.prototype.hasOwnProperty,o$=Object.prototype.propertyIsEnumerable,hd=(t,e,n)=>e in t?t$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,s$=(t,e)=>{for(var n in e||(e={}))n$.call(e,n)&&hd(t,n,e[n]);if(pd)for(var n of pd(e))o$.call(e,n)&&hd(t,n,e[n]);return t},cr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ae=t=>(_t("data-v-132700f7"),t=t(),wt(),t),r$=Ae(()=>d("h2",null,"Image options",-1)),l$={class:"column ok-col"},i$={key:0,class:"column"},a$=Ae(()=>d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),c$=Ae(()=>d("option",{value:"source-over"},"Normal",-1)),u$=Ae(()=>d("option",{value:"source-atop"},"source-atop",-1)),d$=Ae(()=>d("option",{value:"destination-over"},"destination-over",-1)),f$=Ae(()=>d("option",{value:"destination-in"},"destination-in",-1)),p$=Ae(()=>d("option",{value:"destination-in"},"destination-out",-1)),h$=Ae(()=>d("option",{value:"destination-in"},"destination-atop",-1)),v$=Ae(()=>d("option",{value:"lighter"},"lighter",-1)),g$=Ae(()=>d("option",{value:"xor"},"xor",-1)),m$=Ae(()=>d("option",{value:"multiply"},"multiply",-1)),b$=Ae(()=>d("option",{value:"screen"},"screen",-1)),y$=Ae(()=>d("option",{value:"overlay"},"overlay",-1)),_$=Ae(()=>d("option",{value:"darken"},"darken",-1)),w$=Ae(()=>d("option",{value:"lighten"},"lighten",-1)),P$=Ae(()=>d("option",{value:"color-dodge"},"color-dodge",-1)),C$=Ae(()=>d("option",{value:"color-burn"},"color-burn",-1)),x$=Ae(()=>d("option",{value:"hard-light"},"hard-light",-1)),k$=Ae(()=>d("option",{value:"soft-light"},"soft-light",-1)),O$=Ae(()=>d("option",{value:"difference"},"difference",-1)),$$=Ae(()=>d("option",{value:"exclusion"},"exclusion",-1)),S$=Ae(()=>d("option",{value:"hue"},"hue",-1)),I$=Ae(()=>d("option",{value:"saturation"},"saturation",-1)),j$=Ae(()=>d("option",{value:"color"},"color",-1)),T$=Ae(()=>d("option",{value:"luminosity"},"luminosity",-1)),A$=[c$,u$,d$,f$,p$,h$,v$,g$,m$,b$,y$,_$,w$,P$,C$,x$,k$,O$,$$,S$,I$,j$,T$],E$=Ae(()=>d("label",{for:"addEffect"},"Add new effect",-1)),R$=["value"],B$=["disabled"],M$=["disabled"],D$=["disabled"],L$=["disabled"],N$=["onClick","onKeydown"],F$={key:0,class:"value-input-table"},H$=Ae(()=>d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),U$=Ae(()=>d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),V$=Ae(()=>d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),W$=Ae(()=>d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),z$=Ae(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),X$=["value","max","min"],Y$={key:0},q$={colspan:"2"},G$=Ae(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),K$=["value","max","min"],J$={key:0},Z$={colspan:"2"},Q$=Pe({__name:"image-options",props:{type:{type:String,required:!0},title:{type:String},id:{},panelId:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],setup(t,{emit:e}){const n=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),o=(()=>{try{const U=ro();U.width=0,U.height=0;const k="filter"in U.getContext("2d");if(No(U),k)return Array.from(n.keys()).sort()}catch(U){}return["opacity"]})(),s=t,r=De(),l=N(""),a=N(0),i=$(()=>{switch(s.type){case"object":return r.state.panels.panels[s.panelId].objects[s.id];case"background":return r.state.panels.panels[s.panelId].background;case"panel":return r.state.panels.panels[s.panelId];default:throw new Rt.UnreachableCaseError(s.type)}}),c=$({get(){return i.value.composite},set(U){Z(()=>{switch(s.type){case"object":r.commit("panels/setComposition",{id:s.id,panelId:s.panelId,composite:U});break;case"background":break;case"panel":break;default:throw new Rt.UnreachableCaseError(s.type)}})}}),u=$(()=>i.value.filters),f=$(()=>{var U;return(U=u.value[a.value])!=null?U:null}),p=$(()=>{const U=f.value;return U?Vu.has(U.type):!1}),g=$(()=>{const U=f.value;if(U){if(U.type==="hue-rotate")return 360;if(U.type==="grayscale"||U.type==="sepia"||U.type==="opacity"||U.type==="invert")return 100}}),m=$(()=>{const U=f.value;if(U)switch(U.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function b(U){return n.get(U)}function P(U){return Vu.has(U.type)?`${n.get(U.type)} ${(U.value*100).toFixed()}%`:U.type==="hue-rotate"?`${n.get(U.type)} ${U.value.toFixed()}°`:U.type==="blur"?`${n.get(U.type)} ${U.value.toFixed()}px`:n.get(U.type)}function O(U){switch(s.type){case"object":return"panels/object_"+U;case"background":return"panels/background"+U[0].toUpperCase()+U.slice(1);case"panel":return"panels/"+U}}function h(){Z(()=>cr(this,null,function*(){yield r.dispatch(O("addFilter"),{id:s.id,panelId:s.panelId,type:l.value,idx:a.value+1})}))}function v(U){a.value=U}function _(){Z(()=>cr(this,null,function*(){yield r.dispatch(O("removeFilter"),{id:s.id,panelId:s.panelId,idx:a.value}),a.value>=i.value.filters.length&&(a.value=i.value.filters.length-1)}))}function j(U){Z(()=>cr(this,null,function*(){yield r.dispatch(O("moveFilter"),{id:s.id,panelId:s.panelId,idx:a.value,moveBy:U}),a.value+=U}))}function S(U){let B=Number(U.target.value);p.value&&(B=B/100),T({value:B})}function T(U){Z(()=>cr(this,null,function*(){yield r.dispatch(O("setFilter"),s$({id:s.id,panelId:s.panelId,idx:a.value},U))}))}const R=$(()=>D(B=>new Fe(B,1,.5,1)).map(B=>B.toRgb().toCss()));function D(U){const B=[];for(let k=0;k<=8;++k)B.push(U(k/8));return B}const F=N(!1),K=Be("color"),Q=Be("offsetX"),fe=Be("offsetY"),we=Be("blurRadius");function Be(U){return $({get(){const B=f.value;if(!B||!(U in B))throw new Error("Tried reading shadow prop on a non shadow object");return B[U]},set(B){T({[U]:B})}})}return(U,B)=>F.value?(x(),ce(Pl,{key:0,modelValue:ne(K),"onUpdate:modelValue":B[0]||(B[0]=k=>be(K)?K.value=k:null),format:"rgb",onLeave:B[1]||(B[1]=k=>F.value=!1)},null,8,["modelValue"])):(x(),ce(At,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:q(()=>[r$,d("div",l$,[d("button",{onClick:B[2]||(B[2]=k=>U.$emit("leave"))},"Back")]),t.noComposition?ue("",!0):(x(),E("div",i$,[a$,A(Ye,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:q(()=>[W("[?] ")]),_:1}),Oe(d("select",{id:"compositionSelect","onUpdate:modelValue":B[3]||(B[3]=k=>c.value=k),onKeydown:B[4]||(B[4]=ae(()=>{},["stop"]))},A$,544),[[Bt,c.value]])])),A(St,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:q(()=>[A(At,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:q(()=>[A(At,{direction:"vertical","no-wraping":""},{default:q(()=>[E$,Oe(d("select",{id:"addEffect","onUpdate:modelValue":B[5]||(B[5]=k=>l.value=k),onKeydown:B[6]||(B[6]=ae(()=>{},["stop"]))},[(x(!0),E(le,null,Ve(ne(o),k=>(x(),E("option",{key:k,value:k},$e(b(k)),9,R$))),128))],544),[[Bt,l.value]]),d("button",{disabled:l.value==="",onClick:h,onKeydown:B[7]||(B[7]=ae(()=>{},["stop"]))}," Add ",40,B$),d("button",{disabled:!f.value,onClick:_,onKeydown:B[8]||(B[8]=ae(()=>{},["stop"]))}," Remove ",40,M$),d("button",{disabled:a.value===0,onClick:B[9]||(B[9]=k=>j(-1)),onKeydown:B[10]||(B[10]=ae(()=>{},["stop"]))}," Move up ",40,D$),d("button",{disabled:a.value===u.value.length-1||u.value.length===0,onClick:B[11]||(B[11]=k=>j(1)),onKeydown:B[12]||(B[12]=ae(()=>{},["stop"]))}," Move down ",40,L$)]),_:1}),A(At,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:q(()=>[(x(!0),E(le,null,Ve(u.value,(k,w)=>(x(),E("div",{key:w,class:Me({choiceBtn:!0,active:w===a.value}),tabindex:"0",onClick:L=>v(w),onKeydown:[lt(L=>v(w),["enter"]),lt(ae(L=>v(w),["prevent"]),["space"])]},$e(P(k)),43,N$))),128))]),_:1}),f.value?(x(),E("table",F$,[f.value.type==="drop-shadow"?(x(),E(le,{key:0},[d("tr",null,[H$,d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:Ke({background:ne(K)}),onClick:B[13]||(B[13]=k=>F.value=!0)},"   ",4)])]),d("tr",null,[U$,d("td",null,[Oe(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":B[14]||(B[14]=k=>be(Q)?Q.value=k:null),onKeydown:B[15]||(B[15]=ae(()=>{},["stop"]))},null,544),[[qe,ne(Q),void 0,{number:!0}]])])]),d("tr",null,[V$,d("td",null,[Oe(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":B[16]||(B[16]=k=>be(fe)?fe.value=k:null),onKeydown:B[17]||(B[17]=ae(()=>{},["stop"]))},null,544),[[qe,ne(fe),void 0,{number:!0}]])])]),d("tr",null,[W$,d("td",null,[Oe(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":B[18]||(B[18]=k=>be(we)?we.value=k:null),onKeydown:B[19]||(B[19]=ae(()=>{},["stop"]))},null,544),[[qe,ne(we),void 0,{number:!0}]])])])],64)):p.value?(x(),E(le,{key:1},[d("tr",null,[z$,d("td",null,[d("input",{id:"filter_value",value:(f.value.value*100).toFixed(),type:"number",max:g.value,min:m.value,onInput:S,onKeydown:B[20]||(B[20]=ae(()=>{},["stop"]))},null,40,X$),W("% ")])]),m.value===0&&g.value!==void 0?(x(),E("tr",Y$,[d("td",q$,[A(Jn,{gradientStops:["#000000","#ffffff"],label:"",maxValue:g.value,modelValue:f.value.value*100,"no-input":"","onUpdate:modelValue":B[21]||(B[21]=k=>T({value:Math.round(k)/100}))},null,8,["maxValue","modelValue"])])])):ue("",!0)],64)):(x(),E(le,{key:2},[d("tr",null,[G$,d("td",null,[d("input",{id:"filter_value",value:f.value.value,type:"number",max:g.value,min:m.value,onInput:S,onKeydown:B[22]||(B[22]=ae(()=>{},["stop"]))},null,40,K$)])]),m.value===0&&g.value!==void 0?(x(),E("tr",J$,[d("td",Z$,[A(Jn,{gradientStops:R.value,label:"",maxValue:g.value,modelValue:f.value.value,"no-input":"","onUpdate:modelValue":B[23]||(B[23]=k=>T({value:Math.round(k)}))},null,8,["gradientStops","maxValue","modelValue"]),A(Jn,{gradientStops:R.value,label:"",maxValue:g.value,modelValue:f.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):ue("",!0)],64))])):ue("",!0)]),_:1})]),_:1})]),_:1}))}}),Ha=Re(Q$,[["__scopeId","data-v-132700f7"]]);var vd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const eS=["title"],tS=["title"],nS=Pe({__name:"button",props:{backgroundId:{type:String,required:!0}},setup(t){const e=De(),n=t,o=$(()=>{const p=e.state.panels.currentPanel;return e.state.panels.panels[p].background}),s=N(null),r=$(()=>{Object.keys(e.state.uploadUrls);const p=l.value;if(!p)return null;for(const g of p.variants)for(const m of g){const b=En(m,!1);if(b.startsWith("uploads:"))return Object.keys(e.state.uploadUrls),b.substring(8)}return null}),l=$(()=>e.getters["content/getBackgrounds"].get(n.backgroundId)||null),a=$(()=>n.backgroundId===o.value.current),i=$(()=>{var p;switch(n.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return(p=l.value.label)!=null?p:""}),c=$(()=>{var p;switch(n.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let g=!1;const m=(p=l.value)==null?void 0:p.variants[0].map(b=>{const P=En(b,!1);return P.startsWith("uploads:")&&(g=!0),`url('${P}')`}).join(",");return g&&Object.keys(e.state.uploadUrls),{backgroundImage:m!=null?m:""}});function u(){s.value.click()}function f(p){return vd(this,null,function*(){const g=s.value,m=r.value;if(!g.files)return;if(g.files.length!==1){console.error("More than one file uploaded!");return}const b=g.files[0];yield Z(()=>vd(this,null,function*(){const P=URL.createObjectURL(b);yield e.dispatch("uploadUrls/add",{name:m,url:P})}))})}return(p,g)=>r.value!==null?(x(),E("div",{key:0,class:Me({background:!0,active:a.value}),title:i.value,style:Ke(c.value),tabindex:"0",onClick:g[0]||(g[0]=m=>u()),onKeypress:[g[1]||(g[1]=lt(ae(m=>u(),["prevent","stop"]),["enter"])),g[2]||(g[2]=lt(ae(m=>u(),["prevent","stop"]),["space"]))]},[W($e(i.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,eS)):(x(),E("div",{key:1,class:Me({background:!0,active:a.value}),title:i.value,style:Ke(c.value),tabindex:"0",onClick:g[3]||(g[3]=m=>p.$emit("input",t.backgroundId)),onKeydown:[g[4]||(g[4]=lt(m=>p.$emit("input",t.backgroundId),["enter"])),g[5]||(g[5]=lt(ae(m=>p.$emit("input",t.backgroundId),["prevent"]),["space"]))]},$e(i.value),47,tS))}}),oS=Re(nS,[["__scopeId","data-v-7e72e585"]]),sS={class:"toggle_box"},rS=["id"],lS=["for"],iS=["for"],ze=Pe({__name:"toggle",props:{label:String,modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,o=Fa(),s=e,r=$({get(){return n.modelValue},set(a){s("update:modelValue",a)}}),l=N(null);return(a,i)=>(x(),E("div",sS,[Oe(d("input",{id:ne(o),type:"checkbox",ref_key:"checkbox",ref:l,"onUpdate:modelValue":i[0]||(i[0]=c=>r.value=c)},null,8,rS),[[cb,r.value]]),d("label",{for:ne(o),class:"switch"},null,8,lS),d("label",{for:ne(o),class:"toggle_label"},$e(t.label),9,iS)]))}});var aS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const zs=t=>(_t("data-v-41e8fed1"),t=t(),wt(),t),cS=zs(()=>d("label",{for:"bg_color"},"Color:",-1)),uS={key:1},dS={colspan:"3"},fS={key:0},pS={class:"arrow-col"},hS=zs(()=>d("td",{style:{"text-align":"center"}},"Variant",-1)),vS={class:"arrow-col"},gS={colspan:"3"},mS=zs(()=>d("option",{value:"0"},"None",-1)),bS=zs(()=>d("option",{value:"1"},"Stretch",-1)),yS=zs(()=>d("option",{value:"2"},"Cover",-1)),_S=[mS,bS,yS],wS={colspan:"3"},PS=Pe({__name:"settings",emits:["open-image-options","change-color"],setup(t,{emit:e}){const n=De(),o=e,s=$(()=>n.state.ui.vertical),r=$(()=>{const b=n.state.panels.currentPanel;return n.state.panels.panels[b].background}),l=$({get(){return r.value.flipped},set(b){Z(()=>{n.commit("panels/setBackgroundFlipped",{flipped:b,panelId:n.state.panels.currentPanel})})}}),a=$({get(){return r.value.scaling.toString()},set(b){Z(()=>{n.commit("panels/setBackgroundScaling",{scaling:parseInt(b,10),panelId:n.state.panels.currentPanel})})}}),i=$(()=>r.value.current),c=$(()=>n.state.content.current.backgrounds.find(b=>b.id===i.value)||null),u=$(()=>i.value==="buildin.static-color"),f=$({get(){return r.value.color},set(b){Z(()=>{n.commit("panels/setBackgroundColor",{color:b,panelId:n.state.panels.currentPanel})})}}),p=$(()=>!!c.value),g=$(()=>c.value?c.value.variants.length>1:!1);function m(b){Z(()=>aS(this,null,function*(){yield n.dispatch("panels/seekBackgroundVariant",{delta:b,panelId:n.state.panels.currentPanel})}))}return(b,P)=>(x(),ce(St,{class:Me({"bg-settings":!0,vertical:s.value}),title:"Settings:"},{default:q(()=>[u.value?(x(),E(le,{key:0},[cS,d("button",{id:"bg_color",class:"color-button",style:Ke({background:f.value}),onClick:P[0]||(P[0]=O=>o("change-color"))},null,4)],64)):ue("",!0),p.value?(x(),E("table",uS,[d("tr",null,[d("td",dS,[A(ze,{modelValue:l.value,"onUpdate:modelValue":P[1]||(P[1]=O=>l.value=O),label:"Flipped?"},null,8,["modelValue"])])]),g.value?(x(),E("tr",fS,[d("td",pS,[d("button",{class:"small-button",onClick:P[2]||(P[2]=O=>m(-1))},"<")]),hS,d("td",vS,[d("button",{class:"small-button",onClick:P[3]||(P[3]=O=>m(1))},">")])])):ue("",!0),d("tr",null,[d("td",gS,[Oe(d("select",{"onUpdate:modelValue":P[4]||(P[4]=O=>a.value=O),onKeydown:P[5]||(P[5]=ae(()=>{},["stop"]))},_S,544),[[Bt,a.value]])])]),d("tr",null,[d("td",wS,[d("button",{id:"image_options_button",class:"v-w100",onClick:P[6]||(P[6]=O=>o("open-image-options"))}," Image options ")])])])):ue("",!0)]),_:1},8,["class"]))}}),CS=Re(PS,[["__scopeId","data-v-41e8fed1"]]);var xS=Object.defineProperty,kS=Object.defineProperties,OS=Object.getOwnPropertyDescriptors,gd=Object.getOwnPropertySymbols,$S=Object.prototype.hasOwnProperty,SS=Object.prototype.propertyIsEnumerable,md=(t,e,n)=>e in t?xS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,IS=(t,e)=>{for(var n in e||(e={}))$S.call(e,n)&&md(t,n,e[n]);if(gd)for(var n of gd(e))SS.call(e,n)&&md(t,n,e[n]);return t},jS=(t,e)=>kS(t,OS(e)),ur=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const TS=t=>(_t("data-v-c536dfca"),t=t(),wt(),t),AS=TS(()=>d("h1",null,"Background",-1)),ES=Pe({__name:"backgrounds",setup(t){const e={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},n=De(),o=N(null);Mt(o);const s=N(!1),r=N(!1),l=$({get(){return n.state.panels.panels[n.state.panels.currentPanel].background.color},set(h){Z(()=>{n.commit("panels/setBackgroundColor",{color:h,panelId:n.state.panels.currentPanel})})}}),a=$(()=>[...n.state.content.current.backgrounds.map(h=>h.id),"buildin.static-color","buildin.transparent"]),i=$(()=>ve.supports.openableFolders.has("backgrounds"));function c(h){n.commit("panels/setCurrentBackground",{current:h,panelId:n.state.panels.currentPanel})}function u(){ve.openFolder("backgrounds")}const f=N(null);function p(h){const v=f.value;if(v.files)for(const _ of v.files)g(_)}function g(h){return ur(this,null,function*(){yield Z(()=>ur(this,null,function*(){const v=URL.createObjectURL(h),_=yield n.dispatch("uploadUrls/add",{name:h.name,url:v});yield b(h.name,h.name,_)}))})}function m(){const h=prompt("Enter the URL of the image");if(h==null)return;const v=h.split("/").slice(-1)[0];b(v,v,h)}function b(h,v,_){return ur(this,null,function*(){const j=n.state.content.contentPacks.find(T=>T.packId===e.packId)||e,S=jS(IS({},j),{backgrounds:[...j.backgrounds,{id:h,label:v,variants:[[{hq:_,lq:_,sourcePack:e.packId}]],scaling:"none"}]});yield Z(()=>ur(this,null,function*(){yield n.dispatch("content/replaceContentPack",{contentPack:S,processed:!0}),c(h)}))})}const P=N(null);function O(h){h.dataTransfer&&(h.dataTransfer.effectAllowed="none",Array.from(h.dataTransfer.items).find(v=>v.type.match(/^image.*$/))&&(h.dataTransfer.effectAllowed="link",P.value.show()))}return(h,v)=>(x(),E("div",{class:"panel",ref_key:"root",ref:o,onDragenter:O,onMouseleave:v[7]||(v[7]=_=>P.value.hide())},[A(Mv,{ref_key:"dt",ref:P,class:"drop-target",onDrop:g},{default:q(()=>[W("Drop here to add as a new background ")]),_:1},512),AS,s.value?(x(),ce(Pl,{key:0,modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=_=>l.value=_),onLeave:v[1]||(v[1]=_=>s.value=!1)},null,8,["modelValue"])):r.value?(x(),ce(Ha,{key:1,type:"background",title:"","panel-id":ne(n).state.panels.currentPanel,"no-composition":"",onLeave:v[2]||(v[2]=_=>r.value=!1)},null,8,["panel-id"])):(x(),E(le,{key:2},[A(CS,{onChangeColor:v[3]||(v[3]=_=>s.value=!0),onOpenImageOptions:v[4]||(v[4]=_=>r.value=!0)}),A(Ie,{icon:"upload",class:"upload-background",onClick:v[5]||(v[5]=_=>f.value.click())},{default:q(()=>[W(" Upload "),d("input",{type:"file",ref_key:"upload",ref:f,onChange:p,multiple:""},null,544)]),_:1}),A(Ie,{icon:"link",class:"upload-background",onClick:m},{default:q(()=>[W(" Add by URL ")]),_:1}),A(Ie,{icon:"extension",class:"upload-background",onClick:v[6]||(v[6]=_=>h.$emit("show-dialog","type: Backgrounds"))},{default:q(()=>[W(" Search in content packs ")]),_:1}),i.value?(x(),ce(Ie,{key:0,icon:"folder",class:"upload-background",onClick:u},{default:q(()=>[W(" Open backgrounds folder ")]),_:1})):ue("",!0),(x(!0),E(le,null,Ve(a.value,_=>(x(),ce(oS,{key:_,backgroundId:_,onInput:j=>c(_)},null,8,["backgroundId","onInput"]))),128))],64))],544))}}),RS=Re(ES,[["__scopeId","data-v-c536dfca"]]);function Ua(t,e,n,o,s){return $({get(){return e.value[s]},set(r){Z(()=>{t[o?"dispatch":"commit"](n,{panelId:e.value.panelId,id:e.value.id,key:s,value:r})})}})}function zo(t,e,n,o,s){return $({get(){return e.value[s]},set(r){Z(()=>{t[o?"dispatch":"commit"](n,{panelId:e.value.panelId,id:e.value.id,[s]:r})})}})}var BS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const MS=["onKeydown"],bd=960,DS=Pe({__name:"part-button",props:{part:{required:!0,type:Object},value:{required:!0},size:{type:Number,default:150}},emits:["quick-click","click"],setup(t,{emit:e}){const n=t,o=e,s=N([]),r=$(()=>n.size/n.part.size[0]),l=$(()=>n.size/n.part.size[1]),a=$(()=>`${Math.floor(bd*r.value)}px ${Math.floor(bd*l.value)}px`),i=$(()=>{var p,g;let m="";const b=a.value,P=(p=n.part.offset)!=null?p:[0,0],O=n.part.images.length-1;for(let h=0;h<=O;++h){const v=n.part.images[O-h],_=s.value[O-h];if(!_)continue;h>0&&(m+=", ");const j=(g=v.offset)!=null?g:[0,0],S=`${Math.floor((P[0]-j[0])*-r.value)}px ${Math.floor((P[1]-j[1])*-l.value)}px`;m+=`url('${_.replace("'","\\'")}') ${S} / ${b}`}return m}),c=$(()=>({height:n.size+"px",width:n.size+"px",background:i.value}));function u(p){p.preventDefault(),o("quick-click")}function f(){return BS(this,null,function*(){s.value=yield Promise.all(n.part.images.map(p=>typeof p.asset=="string"?Vb(p.asset,!1):En(p.asset,!1)))})}return Wo("Initialization of parts button",f),(p,g)=>{var m;return x(),E("div",{class:Me({part:!0,active:(m=t.part)==null?void 0:m.active}),style:Ke(c.value),tabindex:"0",onClick:g[0]||(g[0]=b=>o("click")),onContextmenu:u,onKeydown:[g[1]||(g[1]=lt(ae(b=>o("click"),["prevent"]),["enter"])),lt(ae(u,["prevent"]),["space"])]},null,46,MS)}}}),yd=Re(DS,[["__scopeId","data-v-de25e019"]]);var Kl=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const LS=Pe({__name:"parts",props:{character:{type:Object,required:!0},part:{required:!0,type:String}},emits:["leave","show-dialog","show-expression-dialog"],setup(t,{emit:e}){const n=t,o=De(),s=e,r=N(null),l=N([]),a=$(()=>{switch(n.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),i=$(()=>fl(o,n.character)),c=$(()=>{if(n.part!=="style")return[];const h=i.value.styleGroups[n.character.styleGroupId];return h.styleComponents.map(v=>{const _={};for(const j in v.variants){if(!v.variants.hasOwnProperty(j))continue;const S=v.variants[j];_[j]={size:h.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:S}],active:!1}}return{label:v.label,name:v.id,buttons:_}})}),u=$(()=>{const h={};let v,_,j;const S=i.value,T=Ho(S,n.character);switch(n.part){case"head":{const D=n.character.posePositions.headType||0,F=n.character.posePositions.head||0;for(let K=0;K<T.compatibleHeads.length;++K){const Q=T.compatibleHeads[K],fe=S.heads[Q];for(let we=0;we<fe.variants.length;++we){const Be=fe.variants[we];h[`${K}_${we}`]={size:fe.previewSize,offset:fe.previewOffset,images:Be.map(U=>({asset:U,offset:[0,0]})),active:F===we&&D===K}}}return h}case"pose":const R=S.styleGroups[n.character.styleGroupId].styles[n.character.styleId];for(let D=0;D<R.poses.length;++D){const F=R.poses[D];h[D]=p(F),h[D].active=D===n.character.poseId}return h;case"style":for(let D=0;D<S.styleGroups.length;++D){const F=S.styleGroups[D];h[F.id]=p(F.styles[0].poses[0]),h[F.id].active=D===n.character.styleGroupId}return h;default:v=T.positions[n.part],j=T.previewSize,_=T.previewOffset;break}for(let R=0;R<v.length;++R){const D=v[R];h[R]={images:D.map(F=>({offset:[0,0],asset:F})),size:j,offset:_,active:R===(n.character.posePositions[n.part]||0)}}return h});function f(){const h=i.value.styleGroups[n.character.styleGroupId].styles[n.character.styleId];l.value=Object.keys(h.components).map(v=>[v,h.components[v]])}function p(h){const v=i.value;let _=[];for(const j of h.renderCommands)switch(j.type){case"pose-part":const S=h.positions[j.part];if(S==null||S.length===0)break;_=_.concat(S[0].map(T=>({asset:T,offset:j.offset})));break;case"head":{const T=v.heads[h.compatibleHeads[0]];if(h.compatibleHeads.length===0)break;const R=T.variants[0];_=_.concat(R.map(D=>({asset:D,offset:j.offset})));break}case"image":_=_.concat(j.images.map(T=>({asset:T,offset:j.offset})));break}return{images:_,size:h.previewSize,offset:h.previewOffset,active:!1}}function g(h){h==null&&(h=n.character.styleGroupId);const _=i.value.styleGroups[h];let j=_.styles;for(const S of l.value){const T=j.filter(R=>R.components[S[0]]===S[1]);T.length>0&&(j=T)}Z(()=>Kl(this,null,function*(){yield o.dispatch("panels/setCharStyle",{id:n.character.id,panelId:n.character.panelId,styleGroupId:h,styleId:_.styles.indexOf(j[0])})}))}function m(h){if(n.part==="style")g(i.value.styleGroups.findIndex(v=>v.id===h));else if(n.part==="head"){const[v,_]=(""+h).split("_",2).map(j=>parseInt(j,10));o.commit("panels/setPosePosition",{id:n.character.id,panelId:n.character.panelId,posePositions:{headType:v,head:_}})}else O(n.part,parseInt(""+h,10))}function b(h,v){const _=l.value.findIndex(j=>j[0]===h);l.value.splice(_,1),l.value.unshift([h,""+v]),g()}function P(h){(h.key==="Backspace"||h.key==="Escape")&&(s("leave"),h.preventDefault(),h.stopPropagation())}function O(h,v){Z(()=>Kl(this,null,function*(){yield o.dispatch("panels/setPart",{id:n.character.id,panelId:n.character.panelId,part:h,val:v})}))}return Wo("Initializing parts data",()=>Kl(this,null,function*(){r.value=yield Mo()})),Xe(()=>n.character,f,{immediate:!0}),(h,v)=>(x(),ce(At,{"no-wraping":"",onKeydown:P},{default:q(()=>[d("button",{onClick:v[0]||(v[0]=_=>s("leave")),class:"h-h100"},"Back"),A(At,{direction:"vertical",class:"parts-fnc-btns"},{default:q(()=>[A(Ie,{icon:"extension",class:"h-bl0 v-w100 v-bt0",onClick:v[1]||(v[1]=_=>s("show-dialog",`type: ${a.value} character: ${i.value.label}`))},{default:q(()=>[W(" Search in content packs ")]),_:1}),t.part==="head"?(x(),ce(Ie,{key:0,icon:"extension",class:"h-bl0 h-bt0 v-w100 v-bt0",onClick:v[2]||(v[2]=_=>s("show-expression-dialog",{character:t.character.characterType}))},{default:q(()=>[W(" Create new expressions ")]),_:1})):ue("",!0)]),_:1}),(x(!0),E(le,null,Ve(u.value,(_,j)=>(x(),ce(yd,{key:j,value:j,part:_,onClick:S=>{m(j),s("leave")},onQuickClick:S=>m(j)},null,8,["value","part","onClick","onQuickClick"]))),128)),(x(!0),E(le,null,Ve(c.value,_=>(x(),ce(St,{key:_.name,title:_.label,class:"h-h100"},{default:q(()=>[A(At,{noWraping:""},{default:q(()=>[(x(!0),E(le,null,Ve(_.buttons,(j,S)=>(x(),ce(yd,{size:130,key:S,value:S,part:j,onClick:T=>b(_.name,S)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}}),NS=Re(LS,[["__scopeId","data-v-d052352b"]]);var FS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const HS=Pe({__name:"delete",props:{obj:{required:!0,type:Object}},setup(t){const e=De(),n=t;function o(){Z(()=>FS(this,null,function*(){yield e.dispatch("panels/removeObject",{panelId:n.obj.panelId,id:n.obj.id})}))}return(s,r)=>(x(),E("button",{onClick:o},"Delete"))}});var US=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const VS=Pe({__name:"layers",props:{object:{required:!0,type:Object}},setup(t){const e=De(),n=t,o=zo(e,$(()=>n.object),"panels/setOnTop",!0,"onTop");function s(r){Z(()=>US(this,null,function*(){yield e.dispatch("panels/shiftLayer",{id:n.object.id,panelId:n.object.panelId,delta:r})}))}return(r,l)=>(x(),ce(St,{id:"layerfs",title:"Layer:"},{default:q(()=>[A(At,{class:"layer_flow",direction:"horizontal"},{default:q(()=>[A(Ie,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>s(-1/0)),title:"Move to back"}),A(Ie,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>s(-1)),title:"Move backwards"}),A(Ie,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>s(1)),title:"Move forwards"}),A(Ie,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>s(1/0)),title:"Move to front"})]),_:1}),A(ze,{modelValue:ne(o),"onUpdate:modelValue":l[4]||(l[4]=a=>be(o)?o.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}}),WS=Re(VS,[["__scopeId","data-v-79e02927"]]);var zS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Cl=t=>(_t("data-v-c57122ef"),t=t(),wt(),t),XS={class:"v-w100"},YS={colspan:"2"},qS={key:0},GS={colspan:"2"},KS={class:"v-w100 button-tbl"},JS={class:"arrow-col"},ZS=["disabled"],QS=["value"],e2={class:"arrow-col"},t2=["disabled"],n2=Cl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),o2={class:"v-w50"},s2=Cl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),r2={class:"v-w50"},l2=Cl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),i2={class:"v-w50"},a2=Cl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),c2={class:"v-w50"},u2=Pe({__name:"position-and-size",props:{obj:{required:!0,type:Object}},setup(t){const e=De(),n=t,o=$({get(){const b=ie().TextBox;return n.obj.height-(l.value?b.NameboxHeight:0)},set(b){const P=ie().TextBox;Z(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:b+(l.value?P.NameboxHeight:0),width:n.obj.width})})}}),s=$({get(){return n.obj.width},set(b){Z(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:n.obj.height,width:b})})}}),r=$(()=>{const b=n.obj;if(b.type==="textBox")return xs[b.style].resizable;const P=ie().Poem;return b.type==="poem"?P.poemBackgrounds[b.background].file.startsWith("internal:"):!1}),l=$(()=>n.obj.type==="textBox"&&location.search.includes("alex")),a=$(()=>"freeMove"in n.obj),i=$(()=>ie().Base.positions),c=$(()=>f.value===0),u=$(()=>f.value===ie().Base.positions.length-1),f=$({get(){return Hr(n.obj.x)},set(b){Z(()=>zS(this,null,function*(){yield e.dispatch("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:ie().Base.characterPositions[b],y:n.obj.y})}))}}),p=$({get(){return!!n.obj.freeMove},set(b){Z(()=>{e.commit("panels/setFreeMove",{id:n.obj.id,panelId:n.obj.panelId,freeMove:b})})}}),g=$({get(){return n.obj.x},set(b){Z(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:b,y:m.value})})}}),m=$({get(){return n.obj.y},set(b){Z(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:g.value,y:b})})}});return(b,P)=>(x(),ce(St,{title:"Position"+(r.value?"/Size":"")},{default:q(()=>[d("table",XS,[d("tr",null,[d("td",YS,[a.value?(x(),ce(ze,{key:0,modelValue:p.value,"onUpdate:modelValue":P[0]||(P[0]=O=>p.value=O),label:"Move freely?"},null,8,["modelValue"])):ue("",!0)])]),a.value&&!p.value?(x(),E("tr",qS,[d("td",GS,[d("table",KS,[d("tr",null,[d("td",JS,[d("button",{onClick:P[1]||(P[1]=O=>--f.value),disabled:c.value},"<",8,ZS)]),d("td",null,[Oe(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":P[2]||(P[2]=O=>f.value=O)},[(x(!0),E(le,null,Ve(i.value,(O,h)=>(x(),E("option",{key:h,value:h},$e(O),9,QS))),128))],512),[[Bt,f.value,void 0,{number:!0}]])]),d("td",e2,[d("button",{onClick:P[3]||(P[3]=O=>++f.value),disabled:u.value},">",8,t2)])])])])])):(x(),E(le,{key:1},[d("tr",null,[n2,d("td",o2,[Oe(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":P[4]||(P[4]=O=>g.value=O),onKeydown:P[5]||(P[5]=ae(()=>{},["stop"]))},null,544),[[qe,g.value,void 0,{number:!0}]])])]),d("tr",null,[s2,d("td",r2,[Oe(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":P[6]||(P[6]=O=>m.value=O),onKeydown:P[7]||(P[7]=ae(()=>{},["stop"]))},null,544),[[qe,m.value,void 0,{number:!0}]])])])],64)),r.value?(x(),E(le,{key:2},[d("tr",null,[l2,d("td",i2,[Oe(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":P[8]||(P[8]=O=>s.value=O),onKeydown:P[9]||(P[9]=ae(()=>{},["stop"]))},null,544),[[qe,s.value,void 0,{number:!0}]])])]),d("tr",null,[a2,d("td",c2,[Oe(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":P[10]||(P[10]=O=>o.value=O),onKeydown:P[11]||(P[11]=ae(()=>{},["stop"]))},null,544),[[qe,o.value,void 0,{number:!0}]])])])],64)):ue("",!0)])]),_:1},8,["title"]))}}),d2=Re(u2,[["__scopeId","data-v-c57122ef"]]);var f2=Object.defineProperty,p2=Object.defineProperties,h2=Object.getOwnPropertyDescriptors,_d=Object.getOwnPropertySymbols,v2=Object.prototype.hasOwnProperty,g2=Object.prototype.propertyIsEnumerable,wd=(t,e,n)=>e in t?f2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,m2=(t,e)=>{for(var n in e||(e={}))v2.call(e,n)&&wd(t,n,e[n]);if(_d)for(var n of _d(e))g2.call(e,n)&&wd(t,n,e[n]);return t},b2=(t,e)=>p2(t,h2(e));const y2=t=>(_t("data-v-9bc42f91"),t=t(),wt(),t),_2={class:"column ok-col"},w2={class:"column"},P2=["value"],C2={key:0,class:"column error-col"},x2={class:"column"},k2=y2(()=>d("p",{class:"hint-col"},"Apply style to selected text:",-1)),O2={class:"column"},$2={class:"column"},S2={class:"column"},I2=Cm('<option value data-v-9bc42f91>Font</option><option value="aller" style="font-family:aller;" data-v-9bc42f91> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-9bc42f91> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-9bc42f91> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-9bc42f91> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-9bc42f91> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-9bc42f91> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-9bc42f91> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-9bc42f91> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-9bc42f91> Halogen (MC) </option>',10),j2=[I2],T2=Pe(b2(m2({},{inheritAttrs:!1}),{__name:"text",props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},emits:["update:modelValue","leave"],setup(t,{emit:e}){const n=De(),o=e,s=N(null),r=N(""),l=N(""),a=N("#000000"),i=N(0),c=N(0),u=N(""),f=$(()=>n.state.ui.vertical);Xe(()=>f.value,()=>{const O=s.value;O&&(O.style.height="",O.style.width="")}),Xe(()=>l.value,()=>{l.value!==""&&(P("font",l.value),l.value="")});function p(){const O=ie(),h=s.value.value;try{new $t(h,O.TextBox.NameboxTextStyle),u.value=""}catch(v){u.value=v.message}o("update:modelValue",h)}function g(O){const h=s.value;r.value=O,i.value=h.selectionStart,c.value=h.selectionEnd}function m(){const O=a.value,h=r.value,v=()=>{const _=s.value;if(!_){Qn(v);return}_.selectionStart=i.value,_.selectionEnd=c.value,P(h==="text"?"color":"outlinecolor",O)};Qn(v),a.value="#000000",r.value=""}function b(O){const h=s.value,v=h.value,_=h.selectionStart,j=h.selectionEnd;h.value=v.slice(0,_)+O+v.slice(j),h.selectionStart=h.selectionEnd=_+O.length,h.focus(),p()}function P(O,h){const v=s.value,_=v.value,j=v.selectionStart,S=v.selectionEnd,T=_.slice(j,S),R=_.slice(0,j),D=_.slice(S);let F=O;h&&(F+="="+h),v.value=`${R}{${F}}${T}{/${O}}${D}`,v.selectionStart=j+F.length+2,v.selectionEnd=v.selectionStart+T.length,v.focus(),p()}return(O,h)=>r.value?(x(),ce(Pl,{key:0,modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=v=>a.value=v),onLeave:m},null,8,["modelValue"])):(x(),E("div",{key:1,class:Me({"text-subpanel":!0,vertical:f.value})},[d("h2",null,$e(t.title),1),d("div",_2,[d("button",{onClick:h[1]||(h[1]=v=>o("leave"))},"OK")]),d("div",w2,[d("textarea",{class:"v-w100",ref_key:"textArea",ref:s,value:t.modelValue,onInput:p,onKeydown:h[2]||(h[2]=ae(()=>{},["stop"])),onKeypress:h[3]||(h[3]=ae(()=>{},["stop"]))},null,40,P2)]),u.value?(x(),E("div",C2,$e(u.value),1)):ue("",!0),d("div",x2,[d("button",{onClick:h[4]||(h[4]=v=>b("\\\\")),class:"style-button"},"Insert \\"),d("button",{onClick:h[5]||(h[5]=v=>b("\\{")),class:"style-button"},"Insert {"),d("button",{onClick:h[6]||(h[6]=v=>b("\\}")),class:"style-button"},"Insert }")]),k2,d("div",O2,[d("button",{onClick:h[7]||(h[7]=v=>P("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:h[8]||(h[8]=v=>P("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:h[9]||(h[9]=v=>P("plain")),class:"style-button"}," Plain "),d("button",{onClick:h[10]||(h[10]=v=>P("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:h[11]||(h[11]=v=>P("k",2)),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),d("div",$2,[d("button",{onClick:h[12]||(h[12]=v=>P("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",S2,[d("button",{onClick:h[13]||(h[13]=v=>P("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Oe(d("select",{"onUpdate:modelValue":h[14]||(h[14]=v=>l.value=v),class:"style-button"},j2,512),[[Bt,l.value]]),d("button",{onClick:h[15]||(h[15]=v=>g("text")),class:"style-button"}," Text color "),d("button",{onClick:h[16]||(h[16]=v=>g("outline")),class:"style-button"}," Outline color ")])],2))}})),A2=Re(T2,[["__scopeId","data-v-9bc42f91"]]);var E2=Object.defineProperty,Pd=Object.getOwnPropertySymbols,R2=Object.prototype.hasOwnProperty,B2=Object.prototype.propertyIsEnumerable,Cd=(t,e,n)=>e in t?E2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xd=(t,e)=>{for(var n in e||(e={}))R2.call(e,n)&&Cd(t,n,e[n]);if(Pd)for(var n of Pd(e))B2.call(e,n)&&Cd(t,n,e[n]);return t},Jl=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const tn=t=>(_t("data-v-20833839"),t=t(),wt(),t),M2=tn(()=>d("span",{class:"icon material-icons"},"edit",-1)),D2=tn(()=>d("p",{class:"modal-text"},"Enter the new name",-1)),L2={class:"modal-text"},N2=tn(()=>d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),F2=tn(()=>d("option",{value:""},"None",-1)),H2=["value"],U2={class:"input-table v-w100"},V2=tn(()=>d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation: °")],-1)),W2={for:"zoom",class:"v-w100"},z2={key:0},X2=tn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),Y2=tn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),q2=tn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),G2={key:0,colspan:"2"},K2={key:0},J2=tn(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),Z2=tn(()=>d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),Q2=["placeholder"],eI=Pe({__name:"object-tool",props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},setup(t){const e=De(),n=N(null),o=t,s=(k,w)=>zo(e,$(()=>o.object),w,!1,k);Mt(n);const r=$({get(){var k;return(k=o.object.linkedTo)!=null?k:""},set(k){const w=o.object,L=k===""?null:k,oe=Vo(e),Ce=oe==null?void 0:oe.getLastRenderObject(w.id),Ee=L===null?oe==null?void 0:oe.getLastRenderObject(w.linkedTo):oe==null?void 0:oe.getLastRenderObject(L);try{if(!Ce||!Ee)e.commit("panels/setLink",{panelId:b.value.id,id:w.id,link:L,x:w.x,y:w.y,scaleX:w.scaleX,scaleY:w.scaleY,skewX:w.skewX,skewY:w.skewY,rotation:w.rotation});else if(L==null)e.commit("panels/setLink",xd({panelId:b.value.id,id:w.id,link:L},Lr(Ce.preparedTransform)));else{const J=Ee.preparedTransform.inverse().multiply(Ce.preparedTransform);console.log(Ce.preparedTransform),console.log(Ee.preparedTransform.multiply(J)),console.log(J),e.commit("panels/setLink",xd({panelId:b.value.id,id:w.id,link:L},Lr(J)))}}catch(it){it instanceof Error?je.fire(new Ts(it.message)):je.fire(new Ts(""+it))}}}),l=N(!1),a=N(""),i=N(!1),c=N(null),u=s("flip","panels/setFlip"),f=s("rotation","panels/setRotation"),p=s("enlargeWhenTalking","panels/setEnlargeWhenTalking"),g=$(()=>"overflow"in o.object),m=$(()=>Q1(o.object)),b=$(()=>e.state.panels.panels[o.object.panelId]),P=$(()=>{const k=b.value,w=[];for(const L of[...k.order,...k.onTopOrder]){const oe=k.objects[L];oe.label===null||oe===o.object||w.push([L,oe.label])}return w}),O=location.search.includes("alex"),h=$({get(){var k;return(k=o.object.overflow)!=null?k:!1},set(k){Z(()=>Jl(this,null,function*(){yield e.commit("panels/setOverflow",{id:o.object.id,panelId:o.object.panelId,overflow:k})}))}}),v=$({get(){return o.object.preserveRatio},set(k){Z(()=>Jl(this,null,function*(){yield e.dispatch("panels/setPreserveRatio",{id:o.object.id,panelId:o.object.panelId,preserveRatio:k})}))}}),_=$({get(){const k=o.object.nameboxWidth;return k===null?"":k},set(k){const w=typeof k=="string"&&k.trim()===""?null:parseInt(k+"");Z(()=>{e.commit("panels/setObjectNameboxWidth",{id:o.object.id,panelId:o.object.panelId,nameboxWidth:w})})}}),j=$({get(){return o.object.scaleX*100},set(k){Z(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:k/100,scaleY:o.object.preserveRatio?k/100*o.object.ratio:o.object.scaleY})})}}),S=$({get(){return o.object.scaleY*100},set(k){Z(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:o.object.preserveRatio?k/100/o.object.ratio:o.object.scaleX,scaleY:k/100})})}}),T=$({get(){return o.object.skewX},set(k){Z(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:k,skewY:o.object.skewY})})}}),R=$({get(){return o.object.skewY},set(k){Z(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:o.object.skewX,skewY:k})})}}),D=$(()=>ie().TextBox.NameboxWidth),F=$(()=>c.value||o.colorHandler||null),K=$(()=>o.object.label!==null),Q=$(()=>{var k,w;return(w=(k=o.object.label)!=null?k:o.title)!=null?w:"Object"}),fe=$({get(){return o.object.textboxColor!==null},set(k){Z(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:k?ie().TextBoxCustom.textboxDefaultColor:null})})}});function we(){Z(()=>Jl(this,null,function*(){yield e.dispatch("panels/copyObjectToClipboard",{panelId:o.object.panelId,id:o.object.id})}))}function Be(){var k;a.value=(k=o.object.label)!=null?k:"",i.value=!0}function U(k){i.value=!1,k==="Apply"&&Z(()=>{e.commit("panels/setLabel",{panelId:o.object.panelId,id:o.object.id,label:a.value})})}function B(){c.value={title:"Textbox color",get:()=>o.object.textboxColor,set:k=>{Z(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:k})})},leave:()=>{c.value=null}}}return(k,w)=>(x(),E("div",{class:"panel",ref_key:"root",ref:n},[d("h1",{style:Ke({fontStyle:K.value?"italic":"normal"}),onClick:Be},[W($e(Q.value)+" ",1),M2],4),(x(),ce(wf,{to:"#modal-messages"},[i.value?(x(),ce($o,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:U,onLeave:w[2]||(w[2]=L=>U("Cancel"))},{default:q(()=>[D2,d("p",L2,[Oe(d("input",{"onUpdate:modelValue":w[0]||(w[0]=L=>a.value=L),style:{width:"100%"},onKeydown:w[1]||(w[1]=lt(ae(L=>U("Apply"),["prevent","stop"]),["enter"]))},null,544),[[qe,a.value]])])]),_:1})):ue("",!0)])),t.textHandler?(x(),ce(A2,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":w[3]||(w[3]=L=>t.textHandler.set(L)),onLeave:w[4]||(w[4]=L=>t.textHandler.leave())},null,8,["title","modelValue"])):F.value?(x(),ce(Pl,{key:1,title:F.value.title,modelValue:F.value.get(),"onUpdate:modelValue":w[5]||(w[5]=L=>F.value.set(L)),onLeave:w[6]||(w[6]=L=>F.value.leave())},null,8,["title","modelValue"])):l.value?(x(),ce(Ha,{key:2,type:"object","panel-id":t.object.panelId,id:t.object.id,onLeave:w[7]||(w[7]=L=>l.value=!1)},null,8,["panel-id","id"])):t.showAltPanel?Zt(k.$slots,"alt-panel",{key:3},void 0,!0):(x(),E(le,{key:4},[Zt(k.$slots,"default",{},void 0,!0),g.value?(x(),ce(ze,{key:0,modelValue:h.value,"onUpdate:modelValue":w[8]||(w[8]=L=>h.value=L),label:"Overflow",title:"Allow the text to move outside of the textbox"},null,8,["modelValue"])):ue("",!0),A(d2,{obj:t.object},null,8,["obj"]),A(WS,{object:t.object},null,8,["object"]),A(St,{title:"Transform",class:"transforms"},{default:q(()=>[A(ze,{modelValue:ne(u),"onUpdate:modelValue":w[9]||(w[9]=L=>be(u)?u.value=L:null),label:"Flip?"},null,8,["modelValue"]),N2,Oe(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":w[10]||(w[10]=L=>r.value=L),onKeydown:w[11]||(w[11]=ae(()=>{},["stop"]))},[F2,(x(!0),E(le,null,Ve(P.value,([L,oe])=>(x(),E("option",{key:L,value:L},$e(oe),9,H2))),128))],544),[[Bt,r.value]]),d("table",U2,[d("tr",null,[V2,d("td",null,[Oe(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":w[12]||(w[12]=L=>be(f)?f.value=L:null),onKeydown:w[13]||(w[13]=ae(()=>{},["stop"]))},null,544),[[qe,ne(f)]])])]),m.value?(x(),E(le,{key:0},[d("tr",null,[d("td",null,[d("label",W2,$e(ne(O)?"Zoom":"Scale X"),1)]),d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":w[14]||(w[14]=L=>j.value=L),onKeydown:w[15]||(w[15]=ae(()=>{},["stop"]))},null,544),[[qe,j.value]])])]),ne(O)?ue("",!0):(x(),E("tr",z2,[X2,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":w[16]||(w[16]=L=>S.value=L),onKeydown:w[17]||(w[17]=ae(()=>{},["stop"]))},null,544),[[qe,S.value]])])]))],64)):ue("",!0),d("tr",null,[Y2,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":w[18]||(w[18]=L=>T.value=L),onKeydown:w[19]||(w[19]=ae(()=>{},["stop"]))},null,544),[[qe,T.value]])])]),d("tr",null,[q2,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":w[20]||(w[20]=L=>R.value=L),onKeydown:w[21]||(w[21]=ae(()=>{},["stop"]))},null,544),[[qe,R.value]])])]),d("tr",null,[ne(O)?ue("",!0):(x(),E("td",G2,[A(ze,{modelValue:v.value,"onUpdate:modelValue":w[22]||(w[22]=L=>v.value=L),label:"Lock scale ratio?"},null,8,["modelValue"])]))])]),Zt(k.$slots,"transform",{},void 0,!0)]),_:3}),Zt(k.$slots,"options",{},void 0,!0),K.value?(x(),ce(St,{key:1,title:"Textbox settings"},{default:q(()=>{var L;return[t.object.type==="character"||t.object.type==="sprite"?(x(),ce(ze,{key:0,label:"Enlarge when talking",modelValue:ne(p),"onUpdate:modelValue":w[23]||(w[23]=oe=>be(p)?p.value=oe:null)},null,8,["modelValue"])):ue("",!0),A(ze,{label:"Own textbox color",modelValue:fe.value,"onUpdate:modelValue":w[24]||(w[24]=oe=>fe.value=oe)},null,8,["modelValue"]),d("table",null,[fe.value?(x(),E("tr",K2,[J2,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Ke({background:(L=t.object.textboxColor)!=null?L:""}),onClick:B},null,4)])])):ue("",!0),d("tr",null,[Z2,d("td",null,[Oe(d("input",{id:"namebox_width",type:"number",placeholder:D.value+"","onUpdate:modelValue":w[25]||(w[25]=oe=>_.value=oe)},null,8,Q2),[[qe,_.value,void 0,{lazy:!0}]])])])])]}),_:1})):ue("",!0),d("button",{onClick:w[26]||(w[26]=L=>l.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:we},"Copy"),A(HS,{class:"v-bt0",obj:t.object},null,8,["obj"])],64))],512))}}),os=Re(eI,[["__scopeId","data-v-20833839"]]);var fs=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const tI={class:"warning"},nI={style:{"word-wrap":"break-word"}},oI={class:"button-tbl"},sI={key:0},rI={class:"arrow-col"},lI={class:"arrow-col"},iI={key:1},aI={class:"arrow-col"},cI={class:"arrow-col"},uI={class:"arrow-col"},dI=["onClick"],fI=["onClick"],pI={class:"arrow-col"},hI=["onClick"],vI=Pe({__name:"character",setup(t){const e=De(),n=N(null),o=N(null);Mt(n);const s=N(null),r=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=$(()=>e.state.ui.selection),a=$(()=>{const j=r.value.objects[l.value];if(j.type==="character")return j}),i=zo(e,a,"panels/setClose",!1,"close"),c=$(()=>{const j=a.value,S=Fr(u.value,j);if(!S)return null;for(const T of S.variants){const R=En(T[0],!1);if(R.startsWith("uploads:"))return R.substring(8)}return null}),u=$(()=>fl(e,a.value)),f=$(()=>{var j;return(j=u.value.label)!=null?j:""}),p=$(()=>bP(u.value,a.value)),g=$(()=>u.value.styleGroups[a.value.styleGroupId].styles.length>1||u.value.styleGroups.length>1),m=$(()=>u.value.styleGroups[a.value.styleGroupId].styles[a.value.styleId].poses.length>1);function b(){o.value.click()}function P(j){return fs(this,null,function*(){const S=o.value;if(!S.files)return;if(S.files.length!==1){console.error("More than one file uploaded!");return}const T=S.files[0];yield Z(()=>fs(this,null,function*(){const R=URL.createObjectURL(T);yield e.dispatch("uploadUrls/add",{name:c.value,url:R})}))})}function O(j){Z(()=>fs(this,null,function*(){yield e.dispatch("panels/seekPose",{id:a.value.id,panelId:a.value.panelId,delta:j})}))}function h(j){Z(()=>fs(this,null,function*(){yield e.dispatch("panels/seekStyle",{id:a.value.id,panelId:a.value.panelId,delta:j})}))}function v(j,S){Z(()=>fs(this,null,function*(){yield e.dispatch("panels/seekPart",{id:a.value.id,panelId:a.value.panelId,delta:S,part:j})}))}function _(j){return j.charAt(0).toUpperCase()+j.substring(1)}return Xe(()=>l.value,()=>{s.value=null}),(j,S)=>(x(),ce(os,{ref_key:"root",ref:n,object:a.value,title:f.value,showAltPanel:!!s.value},{"alt-panel":q(()=>[s.value?(x(),ce(NS,{key:0,character:a.value,part:s.value,onLeave:S[0]||(S[0]=T=>s.value=null),onShowDialog:S[1]||(S[1]=T=>j.$emit("show-dialog",T)),onShowExpressionDialog:S[2]||(S[2]=T=>j.$emit("show-expression-dialog",T))},null,8,["character","part"])):ue("",!0)]),default:q(()=>[c.value?(x(),E(le,{key:0},[d("p",tI,[W(" MISSING Head sprite! Click below to re-upload "),d("span",nI,'"'+$e(c.value)+'"',1),W(". ")]),d("button",{onClick:S[3]||(S[3]=T=>b())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:o,onChange:P},null,544)],64)):ue("",!0),m.value||p.value.length>0||g.value?(x(),ce(St,{key:1,class:"pose-list",title:"Pose:"},{default:q(()=>[d("table",oI,[d("tbody",null,[g.value?(x(),E("tr",sI,[d("td",rI,[d("button",{onClick:S[4]||(S[4]=T=>h(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:S[5]||(S[5]=T=>s.value="style")}," Style ")]),d("td",lI,[d("button",{onClick:S[6]||(S[6]=T=>h(1))},">")])])):ue("",!0),m.value?(x(),E("tr",iI,[d("td",aI,[d("button",{onClick:S[7]||(S[7]=T=>O(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:S[8]||(S[8]=T=>s.value="pose")}," Pose ")]),d("td",cI,[d("button",{onClick:S[9]||(S[9]=T=>O(1))},">")])])):ue("",!0),(x(!0),E(le,null,Ve(p.value,T=>(x(),E("tr",{key:T},[d("td",uI,[d("button",{onClick:R=>v(T,-1)},"<",8,dI)]),d("td",null,[d("button",{class:"middle-button",onClick:R=>s.value=T},$e(_(T)),9,fI)]),d("td",pI,[d("button",{onClick:R=>v(T,1)},">",8,hI)])]))),128))])])]),_:1})):ue("",!0)]),transform:q(()=>[A(ze,{modelValue:ne(i),"onUpdate:modelValue":S[10]||(S[10]=T=>be(i)?i.value=T:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}}),gI=Re(vI,[["__scopeId","data-v-b8d6f4b8"]]);var kd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const mI=t=>(_t("data-v-ba335ec3"),t=t(),wt(),t),bI=["onClick"],yI=mI(()=>d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),_I=Pe({__name:"choice",setup(t){const e=De(),n=N(null);Mt(n);const o=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=$(()=>{const P=o.value.objects[e.state.ui.selection];if(P.type==="choice")return P}),r=(P,O)=>zo(e,s,O,!1,P),l=N(0),a=N(!1),i=r("autoWrap","panels/setAutoWrapping"),c=b("text"),u=$(()=>s.value.choices),f=$(()=>{if(a.value)return{title:"Text",get:()=>c.value,set:P=>{c.value=P},leave:()=>{a.value=!1}}});function p(P){l.value=P}function g(){Z(()=>kd(this,null,function*(){yield e.dispatch("panels/addChoice",{id:s.value.id,panelId:s.value.panelId,text:""})}))}function m(){Z(()=>kd(this,null,function*(){l.value===s.value.choices.length-1&&l.value>0&&p(l.value-1),yield e.dispatch("panels/removeChoice",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value})}))}function b(P){return $({get(){return s.value.choices[l.value][P]},set(O){Z(()=>{e.commit("panels/setChoiceProperty",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value,key:P,value:O})})}})}return(P,O)=>(x(),ce(os,{ref_key:"root",ref:n,object:s.value,title:"Choice",textHandler:f.value},{default:q(()=>[A(St,{class:"buttons",title:"Buttons:"},{default:q(()=>[A(At,{maxSize:"100%",direction:"vertical",noWraping:""},{default:q(()=>[(x(!0),E(le,null,Ve(u.value,(h,v)=>(x(),E("div",{class:Me({choiceBtn:!0,active:v===l.value}),key:v,onClick:_=>p(v)},$e(h.text.trim()===""?"[Empty]":h.text),11,bI))),128))]),_:1})]),_:1}),A(St,{class:"current_button",title:"Current button:"},{default:q(()=>[d("table",null,[yI,d("tr",null,[d("td",null,[Oe(d("input",{id:"choice-button-input","onUpdate:modelValue":O[0]||(O[0]=h=>be(c)?c.value=h:null),onKeydown:O[1]||(O[1]=ae(()=>{},["stop"]))},null,544),[[qe,ne(c)]])]),d("td",null,[d("button",{onClick:O[2]||(O[2]=h=>a.value=!0)},"...")])])])]),_:1}),d("button",{onClick:g},"Add"),d("button",{onClick:m},"Remove"),A(ze,{label:"Auto line wrap?",modelValue:ne(i),"onUpdate:modelValue":O[3]||(O[3]=h=>be(i)?i.value=h:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),wI=Re(_I,[["__scopeId","data-v-ba335ec3"]]),pn=t=>(_t("data-v-c47263ec"),t=t(),wt(),t),PI=pn(()=>d("h1",null,"Help and Credits",-1)),CI=pn(()=>d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),xI=pn(()=>d("p",null,[W(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),W("Based on gemdude46's DDLC Shitpost generator ")],-1)),kI=pn(()=>d("p",null,[W(" MC Sprite by Childish-N "),d("br"),W("MC Casual Sprite by SlightlySimple "),d("br"),W("MC Chibi by SlightlySimple ")],-1)),OI=pn(()=>d("p",null,[W(" MC Chad Sprite by Cylent-Nite "),d("br"),W("MC Chad Poses and expressions by SlightlySimple "),d("br"),W("MC Chad Poses and chibi by Meddy-sin ")],-1)),$I=pn(()=>d("p",null,[W(" FeMC Sprite by Meddy-sin "),d("br"),W("FeMC Casual Sprite by SlightlySimple ")],-1)),SI=pn(()=>d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),II=pn(()=>d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),jI=pn(()=>d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1)),TI=Pe({__name:"credits",setup(t){const e=N(null);return Mt(e),(n,o)=>(x(),E("div",{class:"panel",ref_key:"root",ref:e},[PI,A(Ye,{class:"btn",to:"wiki://Dokumentation"},{default:q(()=>[W("Help")]),_:1}),A(Ye,{class:"btn",to:"github://"},{default:q(()=>[W("Fork me on GitHub")]),_:1}),A(Ye,{class:"btn",to:"wiki://Privacy Statement"},{default:q(()=>[W("Privacy Statement")]),_:1}),CI,xI,d("p",null,[W(" Unused House Background by "),A(Ye,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:q(()=>[W(" Fatelogic ")]),_:1})]),d("p",null,[W(" Aller Font by "),A(Ye,{to:"https://www.daltonmaag.com/library/aller"},{default:q(()=>[W("Dalton Maag Ltd")]),_:1})]),d("p",null,[W(" Riffic Bold Font by "),A(Ye,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:q(()=>[W("InkyType")]),_:1})]),d("p",null,[W(" Verily Serif Mono Font by "),A(Ye,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:q(()=>[W("Stephen G. Hartke")]),_:1})]),d("p",null,[W(" F25 Bank Printer Font by "),A(Ye,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:q(()=>[W("F25 Digital Typeface Design")]),_:1})]),d("p",null,[W(" Journal Font by "),A(Ye,{to:"https://www.dafont.com/journal.font"},{default:q(()=>[W("Fontourist")]),_:1})]),d("p",null,[W(" Hashtag Font by "),A(Ye,{to:"https://www.dafont.com/hashtag.font"},{default:q(()=>[W(" TitanVex")]),_:1})]),d("p",null,[W(" JP Hand Slanted Font by "),A(Ye,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:q(()=>[W("Jonathan Paterson")]),_:1})]),d("p",null,[W(" As I Lay Dying Font by "),A(Ye,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:q(()=>[W("Moises Esqueda")]),_:1})]),d("p",null,[W(" Damagrafik Script Font by "),A(Ye,{to:"https://www.dafont.com/damagrafik-script.font"},{default:q(()=>[W("Davide Terenzi")]),_:1})]),d("p",null,[W(" Ammy's Handwriting Font by "),A(Ye,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:q(()=>[W("Ammy K.")]),_:1})]),d("p",null,[W(" Halogen Font by "),A(Ye,{to:"https://www.dafont.com/halogen.font"},{default:q(()=>[W("JLH Fonts")]),_:1})]),kI,d("p",null,[A(Ye,{to:"https://www.reddit.com/ofkg59"},{default:q(()=>[W("Concept MC")]),_:1}),W(" by StormBlazed76, "),A(Ye,{to:"https://www.reddit.com/og6shh"},{default:q(()=>[W("red")]),_:1}),W(" and "),A(Ye,{to:"https://www.reddit.com/oft3vb"},{default:q(()=>[W("yellow")]),_:1}),W(" eyes by YinuS_WinneR, "),A(Ye,{to:"https://www.reddit.com/ofof3o"},{default:q(()=>[W("chibi")]),_:1}),W(" by Hadrosaur838 ")]),OI,$I,d("p",null,[A(Ye,{to:"https://www.reddit.com/oizaow"},{default:q(()=>[W("Concept FeMC")]),_:1}),W(" by ShidoDraws, "),A(Ye,{to:"https://www.reddit.com/oosuxu"},{default:q(()=>[W("additional poses, expressions and chibi")]),_:1}),W(" by SlightlySimple ")]),SI,II,jI],512))}}),AI=Re(TI,[["__scopeId","data-v-c47263ec"]]),EI=t=>(_t("data-v-b13704be"),t=t(),wt(),t),RI={id:"notification_text_wrapper"},BI=EI(()=>d("label",{for:"notification_text"},"Text:",-1)),MI=Pe({__name:"notification",setup(t){const e=De(),n=N(null);Mt(n);const o=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=$(()=>{const u=o.value.objects[e.state.ui.selection];if(u.type==="notification")return u}),r=u=>Ua(e,s,"panels/setNotificationProperty",!1,u),l=r("text"),a=r("backdrop"),i=N(!1),c=$(()=>{if(i.value)return{title:"Text",get:()=>l.value,set:u=>{l.value=u},leave:()=>{i.value=!1}}});return(u,f)=>(x(),ce(os,{ref_key:"root",ref:n,object:s.value,title:"Notification",textHandler:c.value},{default:q(()=>[d("div",RI,[BI,Oe(d("textarea",{"onUpdate:modelValue":f[0]||(f[0]=p=>be(l)?l.value=p:null),id:"notification_text",onKeydown:f[1]||(f[1]=ae(()=>{},["stop"]))},null,544),[[qe,ne(l)]]),d("button",{onClick:f[2]||(f[2]=p=>i.value=!0)},"Formatting")])]),options:q(()=>[A(ze,{modelValue:ne(a),"onUpdate:modelValue":f[3]||(f[3]=p=>be(a)?a.value=p:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}}),DI=Re(MI,[["__scopeId","data-v-b13704be"]]);var ut=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const ao=t=>(_t("data-v-2550e2b1"),t=t(),wt(),t),LI=ao(()=>d("h1",null,"Panels",-1)),NI=["onClick","onKeydown"],FI={class:"panel_text"},HI={class:"panel_nr"},UI={class:"column"},VI={class:"v-w100"},WI=ao(()=>d("td",null,[d("label",{for:"export_format"},"Format")],-1)),zI=ao(()=>d("option",{value:"image/png"},"PNG (lossless)",-1)),XI={key:0,value:"image/webp"},YI={key:1,value:"image/heif"},qI=ao(()=>d("option",{value:"image/jpeg"},"JPEG (lossy)",-1)),GI={key:0},KI=ao(()=>d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),JI={for:"export_ppi"},ZI={key:0},QI=ao(()=>d("br",null,null,-1)),ej={for:"export_pages"},tj={key:0},nj=ao(()=>d("br",null,null,-1)),oj={colspan:"2"},sj={class:"column"},rj=100,lj=90,Od=70,$d=1/4,ij=.5,aj=Pe({__name:"panels",setup(t){const e=De(),n=N(null),{vertical:o,getRoot:s}=Mt(n),r=N(ve.supports.limitedCanvasSpace?10:0),l=N(""),a=N("image/png"),i=N(lj),c=N(!1),u=N(null),f=ie().Base,p=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),g=$(()=>a.value!=="image/png"),m=$(()=>_.value.length>1);function b(z){return z===""}const P=N(!1),O=N(!1);Promise.allSettled([Mo(),Fb()]).then(([z,X])=>{z.status==="fulfilled"&&(P.value=z.value),X.status==="fulfilled"&&(O.value=X.value)});const h=$(()=>e.state.panels.panelOrder.indexOf(p.value.id)>0),v=$(()=>{const z=e.state.panels.panelOrder;return z.indexOf(p.value.id)<z.length-1}),_=$(()=>e.state.panels.panelOrder.map(X=>{const se=e.state.panels.panels[X],ge=e.state.panels.panels[X],y=[...ge.order,...ge.onTopOrder].map(C=>e.state.panels.panels[X].objects[C]).map(j);return{id:X,image:se.lastRender,text:y.reduce((C,I)=>C.length>I.length?C:I,"")}}));function j(z){switch(z.type){case"textBox":return z.text;case"notification":return z.text;case"poem":return z.text;case"choice":return z.choices.map(X=>`[${X.text}]`).join(`
`)}return""}function S(){const z=s().querySelector(".panel_button.active");z&&T(z)}function T(z){const X=z.parentElement.parentElement;e.state.ui.vertical?(X.scrollTop=z.offsetTop-X.clientHeight/2,X.scrollLeft=0):(X.scrollLeft=z.offsetLeft-X.clientWidth/2,X.scrollTop=0)}mt(()=>{S()});function R(){const z=new Date;return`cd-${[z.getFullYear(),`${z.getMonth()+1}`.padStart(2,"0"),`${z.getDate()}`.padStart(2,"0"),`${z.getHours()}`.padStart(2,"0"),`${z.getMinutes()}`.padStart(2,"0"),`${z.getSeconds()}`.padStart(2,"0")].join("-")}`}function D(){return ut(this,null,function*(){yield Wo("export image",()=>ut(this,null,function*(){const z=Q(),X=a.value.split("/")[1],se=a.value,ge=i.value,y=R();yield F(z,!0,(C,I)=>ut(this,null,function*(){yield ve.saveToFile(I,`${y}_${C}.${X}`,se,ge/rj)}))}))})}function F(z,X,se){return ut(this,null,function*(){const ge=ie().Base,y=[];for(let C=0;C<z.length;++C){const I=z[C],M=document.createElement("canvas");M.width=ge.screenWidth,M.height=ge.screenHeight*I.length;try{const H=M.getContext("2d");for(let Y=0;Y<I.length;++Y){const te=I[Y],G=new Bi(e,te,ge.screenWidth,ge.screenHeight);try{yield G.render(X,!1,!0),G.paintOnto(H,{x:0,y:ge.screenHeight*Y,w:ge.screenWidth,h:ge.screenHeight})}finally{G.dispose()}}y.push(yield se(C,M))}finally{No(M)}}return y})}function K(){const z=e.state.panels.panelOrder.length-1,X=0,se=l.value.split(","),ge=[];let y=!1;for(const C of se){const I=C.trim(),M=I.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!M){I!==""&&je.fire(new Tt(`Could not read '${C}' in the page list.`));continue}if(y=!0,M[2])ge.push(parseInt(M[2],10)-1);else{const H=Math.max(parseInt(M[3],10)-1,X),Y=Math.min(parseInt(M[4],10)-1,z);if(H==null||Y==null||H>Y)continue;for(let te=H;te<=Y;++te)ge.push(te)}}return y?ge.sort((C,I)=>C-I).filter((C,I,M)=>M[I-1]!==C).map(C=>e.state.panels.panelOrder[C]):e.state.panels.panelOrder}function Q(){const z=K();if(isNaN(r.value)&&(r.value=0),r.value===0)return[z];const X=[];for(let se=0;se<z.length/r.value;++se){const ge=se*r.value,y=ge+r.value;X.push([...z.slice(ge,y)])}return X}function fe(){return ut(this,null,function*(){yield Z(()=>ut(this,null,function*(){yield e.dispatch("panels/duplicatePanel",{panelId:e.state.panels.currentPanel})})),yield Qn(),S()})}function we(z){Z(()=>{e.commit("panels/setCurrentPanel",{panelId:z})}),Qn(()=>{S()})}function Be(){Z(()=>ut(this,null,function*(){yield e.dispatch("panels/delete",{panelId:e.state.panels.currentPanel})})),Qn(()=>{S()})}function U(){Z(()=>ut(this,null,function*(){yield e.dispatch("panels/move",{panelId:p.value.id,delta:-1})}))}function B(){Z(()=>ut(this,null,function*(){yield e.dispatch("panels/move",{panelId:p.value.id,delta:1})}))}const k=ro();k.width=f.screenWidth*$d,k.height=f.screenHeight*$d;const w=k.getContext("2d"),L=N(!1),oe=$(()=>e.state.panels.panelOrder.filter(X=>e.state.panels.panels[X].lastRender==null));function Ce(){return ut(this,null,function*(){const z=Vo(e);yield Ee(z)})}function Ee(z){return ut(this,null,function*(){yield Wo("render thumbnail",()=>ut(this,null,function*(){const X=z.panelId;z.paintOnto(w,{x:0,y:0,w:w.canvas.width,h:w.canvas.height}),w.canvas.toBlob(se=>{if(!se)return;const ge=URL.createObjectURL(se);Z(()=>{e.commit("panels/setPanelPreview",{panelId:X,url:ge})})},(yield Mo())?"image/webp":"image/jpeg",ij)}))})}function it(){return ut(this,null,function*(){const z=ie().Base;if(!L.value||ve.supports.limitedCanvasSpace)return;const X=oe.value;if(X.length===0)return;const se=X[0],ge=new Bi(e,se,z.screenWidth,z.screenHeight);yield ge.render(!1,!1,!0),yield Ee(ge),setTimeout(()=>{it()},500)})}mt(()=>{L.value=!0,requestAnimationFrame(()=>Ce().catch(()=>{}))}),Vt(()=>{L.value=!1,No(w.canvas)}),je.subscribe(Lf,()=>requestAnimationFrame(Ce));function J(){return ut(this,null,function*(){const z=yield e.dispatch("getSave",!0),X=new Blob([z],{type:"text/plain"}),se=new Date,ge=`save-${[se.getFullYear(),`${se.getMonth()+1}`.padStart(2,"0"),`${se.getDate()}`.padStart(2,"0"),`${se.getHours()}`.padStart(2,"0"),`${se.getMinutes()}`.padStart(2,"0"),`${se.getSeconds()}`.padStart(2,"0")].join("-")}`;ve.storeSaveFile(X,`${ge}.dddg`)})}function me(){return ut(this,null,function*(){yield Z(()=>ut(this,null,function*(){const z=u.value;if(!z.files)return;je.fire(new Hf);const X=yield xe(z.files[0]);yield e.dispatch("loadSave",X),ve.supports.limitedCanvasSpace&&je.fire(new Tt("To prevent running out of memory, thumbnails will not be automatically restored in the background."))})),yield Ce(),setTimeout(()=>{it()},1e3)})}function xe(z){return new Promise((X,se)=>{const ge=new FileReader;ge.onload=function(){X(ge.result)},ge.onerror=function(y){se(y)},ge.readAsText(z)})}return Xe(()=>i.value,(z,X)=>{if(z===100){je.fire(new Tt("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(X>Od&&z<=Od){je.fire(new Tt("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),Xe(()=>r.value,(z,X)=>{if(ve.supports.limitedCanvasSpace&&(X<=10&&z>10||z===0&&_.value.length>10)){je.fire(new Tt("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(z,X)=>(x(),E("div",{class:"panel",ref_key:"root",ref:n},[LI,c.value?(x(),ce(Ha,{key:0,type:"panel",title:"","panel-id":p.value.id,"no-composition":"",onLeave:X[0]||(X[0]=se=>{c.value=!1,Ce()})},null,8,["panel-id"])):(x(),E(le,{key:1},[A(St,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:q(()=>[A(At,{"no-wraping":"",maxSize:"350px"},{default:q(()=>[(x(!0),E(le,null,Ve(_.value,(se,ge)=>(x(),E("div",{key:se.id,class:Me({panel_button:!0,active:se.id===p.value.id}),style:Ke(`background-image: url('${se.image}')`),tabindex:"0",onClick:y=>we(se.id),onKeydown:[lt(y=>we(se.id),["enter"]),lt(ae(y=>we(se.id),["prevent"]),["space"])]},[d("div",FI,[d("p",null,$e(se.text),1)]),d("div",HI,$e(ge+1),1)],46,NI))),128))]),_:1})]),_:1}),d("div",UI,[A(Ie,{icon:"add_to_queue",onClick:fe},{default:q(()=>[W(" Add new")]),_:1}),A(Ie,{icon:"remove_from_queue",class:"bt0",onClick:Be,disabled:!m.value},{default:q(()=>[W(" Delete panel ")]),_:1},8,["disabled"]),A(Ie,{icon:"arrow_upward",class:"bt0",onClick:U,disabled:!h.value},{default:q(()=>[W(" Move ahead ")]),_:1},8,["disabled"]),A(Ie,{icon:"arrow_downward",class:"bt0",onClick:B,disabled:!v.value},{default:q(()=>[W(" Move behind ")]),_:1},8,["disabled"]),A(Ie,{class:"bt0",icon:"color_lens",onClick:X[1]||(X[1]=se=>c.value=!0)},{default:q(()=>[W(" Image options ")]),_:1})]),A(St,{title:"Export",class:"h-h100"},{default:q(()=>[d("table",VI,[d("tr",null,[WI,d("td",null,[Oe(d("select",{id:"export_format","onUpdate:modelValue":X[2]||(X[2]=se=>a.value=se)},[zI,P.value?(x(),E("option",XI," WebP (lossy) ")):ue("",!0),O.value?(x(),E("option",YI," HEIF (lossy) ")):ue("",!0),qI],512),[[Bt,a.value]])])]),g.value?(x(),E("tr",GI,[KI,d("td",null,[Oe(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":X[3]||(X[3]=se=>i.value=se),onKeydown:X[4]||(X[4]=ae(()=>{},["stop"]))},null,544),[[qe,i.value,void 0,{number:!0}]])])])):ue("",!0),d("tr",null,[d("td",null,[d("label",JI,[W(" Panels per image: "),!g.value||ne(o)?(x(),E("small",ZI,[QI,W("(0 for one single image)")])):ue("",!0)])]),d("td",null,[Oe(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":X[5]||(X[5]=se=>r.value=se),onKeydown:X[6]||(X[6]=ae(()=>{},["stop"])),onBlur:X[7]||(X[7]=se=>{b(r.value)&&(r.value=0)})},null,544),[[qe,r.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",ej,[W(" Panels to export: "),!g.value||ne(o)?(x(),E("small",tj,[nj,W("(Leave empty for all)")])):ue("",!0)])]),d("td",null,[Oe(d("input",{id:"export_pages","onUpdate:modelValue":X[8]||(X[8]=se=>l.value=se),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[qe,l.value]])])]),d("tr",null,[d("td",oj,[A(Ie,{icon:"photo_camera",class:"w100",onClick:D},{default:q(()=>[W(" Download ")]),_:1})])])])]),_:1}),d("div",sj,[A(Ie,{icon:"save",onClick:J},{default:q(()=>[W("Save")]),_:1}),A(Ie,{class:"bt0",icon:"folder_open",onClick:X[9]||(X[9]=se=>u.value.click())},{default:q(()=>[W(" Load "),d("input",{type:"file",ref_key:"loadUpload",ref:u,onChange:me},null,544)]),_:1})])],64))],512))}}),cj=Re(aj,[["__scopeId","data-v-2550e2b1"]]),Dv=t=>(_t("data-v-f4db8760"),t=t(),wt(),t),uj={id:"poem_text",class:"v-w100"},dj=Dv(()=>d("label",{for:"poem_text"},"Text:",-1)),fj=["value"],pj=["value"],hj={key:1},vj=Dv(()=>d("td",{style:{width:"0"}},"Color:",-1)),gj={class:"v-w100"},mj=Pe({__name:"poem",setup(t){const e=De(),n=N(null),o=N(null),{vertical:s}=Mt(n),r=N(!1),l=N("");Xe(()=>s.value,()=>{o.value.style.height="",o.value.style.width=""});const a=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=$(()=>{const O=a.value.objects[e.state.ui.selection];if(O.type==="poem")return O}),c=O=>Ua(e,i,"panels/setPoemProperty",!1,O),u=$(()=>{if(r.value)return{title:"Text",get:()=>p.value,set:O=>{p.value=O},leave:()=>{r.value=!1}}}),f=$(()=>{if(l.value)return{title:"Color",get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.consoleColor;default:throw new Rt.UnreachableCaseError(l.value)}},set:O=>{Z(()=>{const h=a.value.id,v=i.value.id;O!==void 0&&e.commit("panels/setPoemProperty",{key:"consoleColor",panelId:h,id:v,value:O})})},leave:()=>{l.value=""}}}),p=c("text"),g=c("autoWrap"),m=c("font"),b=c("overflow"),P=c("background");return(O,h)=>(x(),ce(os,{ref_key:"root",ref:n,object:i.value,title:i.value.subType==="poem"?"Poem":"Console",textHandler:u.value,colorHandler:f.value},{default:q(()=>[d("div",uj,[dj,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":h[0]||(h[0]=v=>be(p)?p.value=v:null),onKeydown:h[1]||(h[1]=ae(()=>{},["stop"]))},null,544),[[qe,ne(p)]]),d("button",{class:"w100 bt0",onClick:h[2]||(h[2]=v=>r.value=!0)},"Formatting")]),A(ze,{label:"Auto line wrap?",modelValue:ne(g),"onUpdate:modelValue":h[3]||(h[3]=v=>be(g)?g.value=v:null)},null,8,["modelValue"]),A(ze,{label:"Allow overflow?",modelValue:ne(b),"onUpdate:modelValue":h[4]||(h[4]=v=>be(b)?b.value=v:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),i.value.subType==="poem"?(x(),E(le,{key:0},[Oe(d("select",{"onUpdate:modelValue":h[5]||(h[5]=v=>be(P)?P.value=v:null),onKeydown:h[6]||(h[6]=ae(()=>{},["stop"]))},[(x(!0),E(le,null,Ve(ne(Dp),(v,_)=>(x(),E("option",{value:_,key:_},$e(v.name),9,fj))),128))],544),[[Bt,ne(P)]]),Oe(d("select",{"onUpdate:modelValue":h[7]||(h[7]=v=>be(m)?m.value=v:null),onKeydown:h[8]||(h[8]=ae(()=>{},["stop"]))},[(x(!0),E(le,null,Ve(ne(Lp),(v,_)=>(x(),E("option",{value:_,key:_},$e(v.name),9,pj))),128))],544),[[Bt,ne(m)]])],64)):(x(),E("table",hj,[d("tr",null,[vj,d("td",gj,[d("button",{id:"console_color",class:"w100",style:Ke([{background:i.value.consoleColor},{"min-width":"64px"}]),onClick:h[9]||(h[9]=v=>l.value="base")},null,4)])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}}),bj=Re(mj,[["__scopeId","data-v-f4db8760"]]);var yj=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Dt=t=>(_t("data-v-fc563e3f"),t=t(),wt(),t),_j=Dt(()=>d("h1",null,"Settings",-1)),wj={class:"modal-scroll-area"},Pj=Dt(()=>d("p",null,"Do you want to allow DDDG to save settings on your device?",-1)),Cj=Dt(()=>d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),xj=Dt(()=>d("p",null,"You can revoke this permission at any time.",-1)),kj={class:"modal-scroll-area"},Oj=Dt(()=>d("p",null,"Do you want to deny DDDG from saving settings on your device?",-1)),$j=Dt(()=>d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),Sj=Dt(()=>d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)),Ij={key:0},jj={key:1},Tj={key:2},Aj={key:3,disabled:""},Ej={class:"v-w100"},Rj=Dt(()=>d("td",null,[d("label",null,"Theme:")],-1)),Bj=Dt(()=>d("option",{value:null},"System",-1)),Mj=Dt(()=>d("option",{value:!1},"Light",-1)),Dj=Dt(()=>d("option",{value:!0},"Dark",-1)),Lj=[Bj,Mj,Dj],Nj={key:7,class:"downloadTable"},Fj=Dt(()=>d("td",null,[d("label",null,"Download folder:")],-1)),Hj=Pe({__name:"settings",setup(t){const e=De(),n=N(null),o=ve.updateProgress;Mt(n);function s(){var D;ve.saveSettings({lq:e.state.ui.lqRendering,nsfw:e.state.ui.nsfw,darkMode:(D=e.state.ui.useDarkTheme)!=null?D:void 0,looseTextParsing:ve.state.looseTextParsing,defaultCharacterTalkingZoom:e.state.ui.defaultCharacterTalkingZoom})}const r=$(()=>ve.supports.optionalSaving),l=N(!1),a=N(!1),i=N(!1),c=$({get(){return ve.savingEnabled},set(D){i.value=!0,ve.savingEnabled=D,s()}});function u(D){l.value=!1,D==="Allow"&&(c.value=!0)}function f(D){a.value=!1,D==="Deny"&&(c.value=!1)}Xe(()=>c.value,()=>i.value=!1);const p=N(!1),g=$(()=>ve.gameMode==="ddlc_plus");function m(D){Wo("changing modes",()=>yj(this,null,function*(){D==="Enter Classic Mode"?yield ve.setGameMode("ddlc"):D==="Enter Plus mode"?yield ve.setGameMode("ddlc_plus"):p.value=!1}))}const b=$(()=>ve.supports.lq),P=$({get(){return e.state.ui.lqRendering},set(D){Z(()=>{e.commit("ui/setLqRendering",D)}),s()}}),O=$({get(){return!!e.state.ui.nsfw},set(D){Z(()=>{e.commit("ui/setNsfw",D),s()})}}),h=$({get(){return!!e.state.ui.defaultCharacterTalkingZoom},set(D){Z(()=>{e.commit("ui/setDefaultCharacterTalkingZoom",D),s()})}}),v=$({get(){return ve.state.looseTextParsing},set(D){ve.state.looseTextParsing=D,s()}}),_=$({get(){return e.state.ui.useDarkTheme},set(D){Z(()=>{e.commit("ui/setDarkTheme",D),s()})}}),j=$(()=>ve.supports.setDownloadFolder),S=$(()=>ve.state.downloadLocation);function T(){ve.updateDownloadFolder()}function R(){ve.openFolder("downloads")}return(D,F)=>(x(),E("div",{class:"panel",ref_key:"root",ref:n},[_j,(x(),ce(wf,{to:"#modal-messages"},[l.value?(x(),ce($o,{key:0,options:["Allow","Deny"],onLeave:F[0]||(F[0]=K=>u("Deny")),onOption:u,"no-base-size":""},{default:q(()=>[d("div",wj,[Pj,Cj,xj,d("p",null,[W(" Our usual "),A(Ye,{to:"wiki://Privacy Statement"},{default:q(()=>[W("privacy policy")]),_:1}),W(" still applies. ")])])]),_:1})):ue("",!0),a.value?(x(),ce($o,{key:1,options:["Deny","Cancle"],onLeave:F[1]||(F[1]=K=>f("Cancel")),onOption:f,"no-base-size":""},{default:q(()=>[d("div",kj,[Oj,$j,d("p",null,[W(" Our usual "),A(Ye,{to:"wiki://Privacy Statement"},{default:q(()=>[W("privacy policy")]),_:1}),W(" still applies. ")])])]),_:1})):ue("",!0),p.value?(x(),ce($o,{key:2,options:[g.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:F[2]||(F[2]=K=>p.value=!1),onOption:m,"no-base-size":""},{default:q(()=>[Sj]),_:1},8,["options"])):ue("",!0)])),ne(o)==="done"?(x(),E("p",Ij," Update is successfully downloaded. It will be installed once the application is closed. ")):ue("",!0),ne(o)==="wait"?(x(),E("p",jj,"Checking for updates...")):ue("",!0),typeof ne(o)=="number"?(x(),E("p",Tj," Downloading update ("+$e(ne(o))+"%) ",1)):ue("",!0),i.value?(x(),E("button",Aj,"Applying...")):!c.value&&r.value?(x(),E("button",{key:4,onClick:F[3]||(F[3]=K=>l.value=!0)}," Allow saving options ")):c.value&&r.value?(x(),E("button",{key:5,onClick:F[4]||(F[4]=K=>a.value=!0)}," Deny saving options ")):ue("",!0),d("button",{onClick:F[5]||(F[5]=K=>p.value=!0),class:Me(r.value?"bt0":"")},[g.value?(x(),E(le,{key:0},[W(" Enter Classic Mode ")],64)):(x(),E(le,{key:1},[W(" Enter DDLC Plus Mode ")],64))],2),b.value?(x(),ce(ze,{key:6,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:P.value,"onUpdate:modelValue":F[6]||(F[6]=K=>P.value=K)},null,8,["modelValue"])):ue("",!0),A(ze,{label:"NSFW Mode?",modelValue:O.value,"onUpdate:modelValue":F[7]||(F[7]=K=>O.value=K)},null,8,["modelValue"]),A(ze,{label:"Enlarge talking objects? (Default value)",modelValue:h.value,"onUpdate:modelValue":F[8]||(F[8]=K=>h.value=K)},null,8,["modelValue"]),A(ze,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:v.value,"onUpdate:modelValue":F[9]||(F[9]=K=>v.value=K)},null,8,["modelValue"]),d("table",Ej,[d("tr",null,[Rj,d("td",null,[Oe(d("select",{"onUpdate:modelValue":F[10]||(F[10]=K=>_.value=K),class:"v-w100"},Lj,512),[[Bt,_.value]])])])]),j.value?(x(),E("table",Nj,[d("tr",null,[Fj,d("td",null,$e(S.value),1),d("td",null,[d("button",{onClick:T},"Set"),d("button",{onClick:R},"Open")])])])):ue("",!0)],512))}}),Uj=Re(Hj,[["__scopeId","data-v-fc563e3f"]]);var Sd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Vj={class:"warning"},Wj={style:{"word-wrap":"break-word"}},zj=Pe({__name:"sprite",setup(t){const e=De(),n=N(null),o=N(null);Mt(n);const s=$(()=>{for(const c of l.value.assets){const u=En(c,!1);if(console.log(u),u.startsWith("uploads:"))return u.substring(8)}return null}),r=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=$(()=>{const c=r.value.objects[e.state.ui.selection];if(c.type==="sprite")return c});function a(){o.value.click()}function i(c){return Sd(this,null,function*(){const u=o.value;if(!u.files)return;if(u.files.length!==1){console.error("More than one file uploaded!");return}const f=u.files[0];yield Z(()=>Sd(this,null,function*(){const p=URL.createObjectURL(f);yield e.dispatch("uploadUrls/add",{name:s.value,url:p})}))})}return(c,u)=>(x(),ce(os,{ref_key:"root",ref:n,object:l.value,title:"Custom Sprite"},{default:q(()=>[s.value?(x(),E(le,{key:0},[d("p",Vj,[W(" MISSING SPRITE! Click below to re-upload "),d("span",Wj,'"'+$e(s.value)+'"',1),W(". ")]),d("button",{onClick:u[0]||(u[0]=f=>a())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:o,onChange:i},null,544)],64)):ue("",!0)]),_:1},8,["object"]))}}),Xj=Re(zj,[["__scopeId","data-v-357c401c"]]);var Id=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const pt=t=>(_t("data-v-3e0506d4"),t=t(),wt(),t),Yj={class:"upper-combos"},qj=pt(()=>d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),Gj={colspan:"2"},Kj=pt(()=>d("option",{value:"normal"},"Normal",-1)),Jj=pt(()=>d("option",{value:"corrupt"},"Corrupt",-1)),Zj=pt(()=>d("option",{value:"custom"},"Custom",-1)),Qj=pt(()=>d("option",{value:"custom_plus"},"Custom (Plus)",-1)),eT=pt(()=>d("option",{value:"none"},"None",-1)),tT=[Kj,Jj,Zj,Qj,eT],nT=pt(()=>d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),oT=pt(()=>d("option",{value:"$null$"},"No-one",-1)),sT=["value"],rT=pt(()=>d("option",{value:"$other$"},"Other",-1)),lT=["disabled"],iT=pt(()=>d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),aT={id:"dialog_text_wrapper",class:"v-w100"},cT=pt(()=>d("label",{for:"dialog_text"},"Dialog:",-1)),uT={key:0},dT=pt(()=>d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),fT=["placeholder"],pT={colspan:"2"},hT={key:0},vT=pt(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),gT={key:1},mT={colspan:"2"},bT=pt(()=>d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),yT=pt(()=>d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),_T=pt(()=>d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),wT=Pe({__name:"textbox",setup(t){const e=De(),n=N(null),o=N(null),{vertical:s}=Mt(n),r=N(""),l=N("");Xe(()=>s.value,()=>{const B=o.value;B&&(B.style.height="",B.style.width="")});const a=$(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=$(()=>{const B=a.value.objects[e.state.ui.selection];if(B.type==="textBox")return B}),c=B=>Ua(e,i,"panels/setTextBoxProperty",!1,B),u=$(()=>{if(r.value)return{title:b.value,get(){return r.value==="name"?i.value.talkingOther:r.value==="body"?_.value:""},set(B){r.value==="name"?g.value=B:r.value==="body"&&(_.value=B)},leave(){r.value=""}}}),f=$(()=>{if(l.value)return{title:P.value,get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.customColor;case"controls":return i.value.customControlsColor;case"namebox":return i.value.customNameboxColor;case"nameboxStroke":return i.value.customNameboxStroke;default:throw new Rt.UnreachableCaseError(l.value)}},set:B=>{Z(()=>{const k=a.value.id,w=i.value.id;let L={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[l.value];B!==void 0&&e.commit("panels/setTextBoxProperty",Ev(k,w,L,B))})},leave:()=>{l.value=""}}}),p=$({get(){var B;return(B=i.value.talkingObjId)!=null?B:"$null$"},set(B){Z(()=>{e.commit("panels/setTalkingObject",{id:i.value.id,panelId:i.value.panelId,talkingObjId:B==="$null$"?null:B})})}}),g=zo(e,i,"panels/setTalkingOther",!1,"talkingOther"),m=$(()=>{const B=a.value,k=[];for(const w of[...B.order,...B.onTopOrder]){const L=B.objects[w];L.label!==null&&k.push([w,L.label])}return k}),b=$(()=>r.value==="name"?"Name":r.value==="body"?"Dialog":""),P=$(()=>{switch(l.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Rt.UnreachableCaseError(l.value)}}),O=c("autoQuoting"),h=c("autoWrap"),v=c("overflow"),_=c("text"),j=$(()=>S.value.startsWith("custom")),S=zo(e,i,"panels/setStyle",!0,"style"),T=c("controls"),R=c("skip"),D=c("continue"),F=c("overrideColor"),K=c("deriveCustomColors"),Q=c("customNameboxWidth"),fe=$(()=>ie().TextBox.NameboxWidth);function we(){Z(()=>Id(this,null,function*(){yield e.dispatch("panels/splitTextbox",{id:i.value.id,panelId:i.value.panelId})}))}function Be(){Z(()=>Id(this,null,function*(){yield e.dispatch("panels/resetTextboxBounds",{id:i.value.id,panelId:i.value.panelId})}))}function U(){Z(()=>{e.commit("ui/setSelection",p.value)})}return(B,k)=>(x(),ce(os,{ref_key:"root",ref:n,object:i.value,title:"Textbox",textHandler:u.value,colorHandler:f.value},{default:q(()=>[d("table",Yj,[d("tr",null,[qj,d("td",Gj,[Oe(d("select",{id:"text_style","onUpdate:modelValue":k[0]||(k[0]=w=>be(S)?S.value=w:null),onKeydown:k[1]||(k[1]=ae(()=>{},["stop"]))},tT,544),[[Bt,ne(S)]])])]),d("tr",null,[nT,d("td",null,[Oe(d("select",{id:"current_talking","onUpdate:modelValue":k[2]||(k[2]=w=>p.value=w),onKeydown:k[3]||(k[3]=ae(()=>{},["stop"]))},[oT,(x(!0),E(le,null,Ve(m.value,([w,L])=>(x(),E("option",{key:w,value:w},$e(L),9,sT))),128)),rT],544),[[Bt,p.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:U,disabled:p.value==="$null$"||p.value==="$other$"}," > ",8,lT)])]),d("tr",null,[iT,d("td",null,[Oe(d("input",{id:"custom_name","onUpdate:modelValue":k[4]||(k[4]=w=>be(g)?g.value=w:null),onKeydown:k[5]||(k[5]=ae(()=>{},["stop"]))},null,544),[[qe,ne(g)]])]),d("td",null,[d("button",{onClick:k[6]||(k[6]=w=>r.value="name")},"...")])])]),A(ze,{label:"Auto quoting?",modelValue:ne(O),"onUpdate:modelValue":k[7]||(k[7]=w=>be(O)?O.value=w:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),A(ze,{label:"Auto line wrap?",modelValue:ne(h),"onUpdate:modelValue":k[8]||(k[8]=w=>be(h)?h.value=w:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),A(ze,{label:"Allow overflow?",modelValue:ne(v),"onUpdate:modelValue":k[9]||(k[9]=w=>be(v)?v.value=w:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",aT,[cT,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":k[10]||(k[10]=w=>be(_)?_.value=w:null),id:"dialog_text",onKeydown:k[11]||(k[11]=ae(()=>{},["stop"]))},null,544),[[qe,ne(_)]]),d("button",{class:"w100 bt0",onClick:k[12]||(k[12]=w=>r.value="body")}," Formatting ")])]),options:q(()=>[A(St,{title:"Customization:",class:Me(j.value?"customization-set":"")},{default:q(()=>[A(At,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:q(()=>[A(ze,{label:"Controls visible?",modelValue:ne(T),"onUpdate:modelValue":k[13]||(k[13]=w=>be(T)?T.value=w:null)},null,8,["modelValue"]),A(ze,{label:"Able to skip?",modelValue:ne(R),"onUpdate:modelValue":k[14]||(k[14]=w=>be(R)?R.value=w:null)},null,8,["modelValue"]),A(ze,{label:"Continue arrow?",modelValue:ne(D),"onUpdate:modelValue":k[15]||(k[15]=w=>be(D)?D.value=w:null)},null,8,["modelValue"]),j.value?(x(),E("table",uT,[d("tr",null,[dT,d("td",null,[Oe(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:fe.value+"","onUpdate:modelValue":k[16]||(k[16]=w=>be(Q)?Q.value=w:null),onKeydown:k[17]||(k[17]=ae(()=>{},["stop"]))},null,40,fT),[[qe,ne(Q),void 0,{number:!0}]])])]),d("tr",null,[d("td",pT,[A(ze,{modelValue:ne(F),"onUpdate:modelValue":k[18]||(k[18]=w=>be(F)?F.value=w:null),label:"Override color"},null,8,["modelValue"])])]),ne(F)?(x(),E("tr",hT,[vT,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Ke({background:i.value.customColor}),onClick:k[19]||(k[19]=w=>l.value="base")},null,4)])])):ue("",!0),ne(F)?(x(),E("tr",gT,[d("td",mT,[A(ze,{id:"derive_custom_colors",modelValue:ne(K),"onUpdate:modelValue":k[20]||(k[20]=w=>be(K)?K.value=w:null),label:"Derive other colors"},null,8,["modelValue"])])])):ue("",!0),ne(F)&&!ne(K)?(x(),E(le,{key:2},[d("tr",null,[bT,d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:Ke({background:i.value.customControlsColor}),onClick:k[21]||(k[21]=w=>l.value="controls")},null,4)])]),d("tr",null,[yT,d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:Ke({background:i.value.customNameboxColor}),onClick:k[22]||(k[22]=w=>l.value="namebox")},null,4)])]),d("tr",null,[_T,d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:Ke({background:i.value.customNameboxStroke}),onClick:k[23]||(k[23]=w=>l.value="nameboxStroke")},null,4)])])],64)):ue("",!0)])):ue("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:Be},"Reset position"),d("button",{class:"bt0",onClick:we},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}}),PT=Re(wT,[["__scopeId","data-v-3e0506d4"]]),CT={id:"toolbar"},xT={id:"toolbar-end"},kT=Pe({__name:"toolbox",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(t,{emit:e}){const n=De(),o=e,s=N(null),r=N("add"),l=$(()=>n.state.panels.panels[n.state.panels.currentPanel]),a=$(()=>n.state.ui.vertical),i=$(()=>n.state.ui.selection),c=$(()=>{if(r.value==="selection")if(i.value===null)r.value="add";else return l.value.objects[i.value].type;return r.value}),u=$(()=>n.state.ui.lastDownload!==null);function f(g){g===r.value&&(g="add"),r.value=g,i.value!==null&&n.commit("ui/setSelection",null)}function p(){s.value instanceof HTMLElement&&(s.value.scrollTop=0,s.value.scrollLeft=0)}return Xe(()=>i.value,g=>{if(g!=null){r.value="selection";return}r.value==="selection"&&(r.value="add")}),ve.onPanelChange(g=>{r.value=g}),(g,m)=>(x(),E("div",{id:"panels",class:Me({vertical:a.value}),onScroll:p,ref_key:"panels",ref:s},[d("div",CT,[A(Ie,{icon:"add_box","icon-pos":"top",class:Me({active:c.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:m[0]||(m[0]=b=>f("add"))},null,8,["class"]),A(Ie,{icon:"panorama","icon-pos":"top",class:Me({active:c.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:m[1]||(m[1]=b=>f("backgrounds"))},null,8,["class"]),A(Ie,{icon:"view_module","icon-pos":"top",class:Me({active:c.value==="panels"}),title:"Panels",shortcut:"d",onClick:m[2]||(m[2]=b=>f("panels"))},null,8,["class"]),A(Ie,{icon:"settings_applications","icon-pos":"top",class:Me({active:c.value==="settings"}),title:"Settings",shortcut:"f",onClick:m[3]||(m[3]=b=>f("settings"))},null,8,["class"])]),c.value==="settings"?(x(),ce(Uj,{key:0})):c.value==="backgrounds"?(x(),ce(RS,{key:1,onShowDialog:m[4]||(m[4]=b=>o("show-dialog",b))})):c.value==="help_credits"?(x(),ce(AI,{key:2})):c.value==="character"?(x(),ce(gI,{key:3,onShowDialog:m[5]||(m[5]=b=>o("show-dialog",b)),onShowExpressionDialog:m[6]||(m[6]=b=>o("show-expression-dialog",b))})):c.value==="sprite"?(x(),ce(Xj,{key:4})):c.value==="textBox"?(x(),ce(PT,{key:5})):c.value==="choice"?(x(),ce(wI,{key:6})):c.value==="panels"?(x(),ce(cj,{key:7})):c.value==="notification"?(x(),ce(DI,{key:8})):c.value==="poem"?(x(),ce(bj,{key:9})):(x(),ce(_O,{key:10,onShowDialog:m[7]||(m[7]=b=>o("show-dialog",b))})),d("div",xT,[A(Ie,{icon:"help","icon-pos":"top",class:Me({active:c.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:m[8]||(m[8]=b=>f("help_credits"))},null,8,["class"]),A(Ie,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:m[9]||(m[9]=b=>o("show-dialog"))}),A(Ie,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:m[10]||(m[10]=b=>o("show-prev-render")),disabled:!u.value},null,8,["disabled"]),A(Ie,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:m[11]||(m[11]=b=>o("download"))})])],34))}});var dr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(c){s(c)}},l=i=>{try{a(n.throw(i))}catch(c){s(c)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const OT={id:"app"},$T={class:"hidden-selectors"},ST=["data-obj-id","onKeydown"],IT=d("div",{id:"modal-messages"},null,-1),jT=20,jd=16/9,TT=50,AT=Pe({__name:"app",setup(t){const e=sc(()=>Lc(()=>import("./single-box-IbdHM6Sd.js"),__vite__mapDeps([0,1]),import.meta.url)),n=sc(()=>Lc(()=>import("./index-wZ4dA3Hn.js"),__vite__mapDeps([2,3]),import.meta.url)),o=De(),s=N(!0),r=N(null),l=$(()=>{const w=o.state.panels,L=w.panels[w.currentPanel];return L==null?[]:[...L.order,...L.onTopOrder]});function a(){const w=o.state.ui.lastDownload;w!=null&&r.value.blendOver(w)}function i(w){w.preventDefault()}mt(()=>{document.body.addEventListener("drop",i,!0),document.body.addEventListener("dragover",i,!0)}),Vt(()=>{document.body.removeEventListener("drop",i,!0),document.body.removeEventListener("dragover",i,!0)});const c=N(0),u=N(0),f=N(192);function p(w,L){let oe=w/jd,Ce=L*jd;return oe>L?oe=L:Ce=w,[Ce,oe]}function g(w,L){const oe=p(w,L-f.value),Ce=p(w-f.value,L);return oe[0]*oe[1]>Ce[0]*Ce[1]?[oe[0],oe[1],!1]:[Ce[0],Ce[1],!0]}function m(){const[w,L,oe]=g(document.documentElement.clientWidth,document.documentElement.clientHeight);c.value=w,u.value=L,o.state.ui.vertical!==oe&&o.commit("ui/setVertical",oe)}m(),mt(()=>{window.addEventListener("resize",m)}),Vt(()=>{window.removeEventListener("resize",m)});const b=N(!1),P=$(()=>o.state.ui.useDarkTheme),O=$(()=>{var w;return(w=P.value)!=null?w:b.value});if(Xe(()=>O.value,w=>{document.body.classList.toggle("dark-theme",w)},{immediate:!0}),window.matchMedia!=null){const w=window.matchMedia("(prefers-color-scheme: dark)");b.value=w.matches;const L=oe=>b.value=oe.matches;w.addEventListener?w.addEventListener("change",L):w.addListener(L)}const h=N(!1),v=N(""),_=N(void 0);function j(w){h.value=!0,v.value=w.character,_.value=w.headGroup}const S=N(null),T=N(!1);function R(w){if(T.value=!0,w==null)return;const L=()=>{S.value?S.value.setSearch(w):setTimeout(L,TT)};Qn(L)}const D=$(()=>o.state.ui.nsfw);Xe(()=>D.value,w=>dr(this,null,function*(){w?yield o.dispatch("content/loadContentPacks",kb):yield o.dispatch("removePacks",{packs:xb})}));let F=null;function K(){F==null&&(F=requestAnimationFrame(()=>{F=null,je.fire(new tl)}))}function Q(w){if(w.target instanceof HTMLInputElement||w.target instanceof HTMLTextAreaElement){console.log("skip keydown on potential target");return}Z(()=>dr(this,null,function*(){const L=w.ctrlKey&&!w.altKey&&!w.metaKey&&!w.shiftKey,oe=!w.ctrlKey&&!w.altKey&&!w.metaKey&&!w.shiftKey;if(L&&w.key==="v"){yield o.dispatch("panels/pasteObjectFromClipboard",{}),w.preventDefault();return}if(oe&&w.key==="Escape"){if(o.state.ui.selection===null)return;o.commit("ui/setSelection",null);return}const Ee=o.state.panels.panels[o.state.panels.currentPanel].objects[o.state.ui.selection];if(Ee!=null){if(L){if(w.key==="c"||w.key==="x"){yield o.dispatch("panels/copyObjectToClipboard",{id:Ee.id,panelId:Ee.panelId}),w.key==="x"&&(yield o.dispatch("panels/removeObject",{id:Ee.id,panelId:Ee.panelId})),w.preventDefault();return}}else if(oe){if(w.key==="Delete"){yield o.dispatch("panels/removeObject",{id:Ee.id,panelId:Ee.panelId});return}if(w.key==="/"||w.key==="*"){let xe=w.key==="/"?-10:10;w.shiftKey&&(xe/=Math.abs(xe)),o.commit("panels/setRotation",{id:Ee.id,panelId:Ee.panelId,rotation:Ee.rotation+xe}),w.stopPropagation(),w.preventDefault();return}if(Ee.type==="character"){const xe=Ee;if(!xe.freeMove){if(w.key==="ArrowLeft"){yield o.dispatch("panels/shiftCharacterSlot",{id:xe.id,panelId:xe.panelId,delta:-1});return}if(w.key==="ArrowRight"){yield o.dispatch("panels/shiftCharacterSlot",{id:xe.id,panelId:xe.panelId,delta:1});return}}}let{x:it,y:J}=Ee;const me=w.shiftKey?1:jT;switch(w.key){case"ArrowLeft":it-=me;break;case"ArrowRight":it+=me;break;case"ArrowUp":J-=me;break;case"ArrowDown":J+=me;break;default:return}yield o.dispatch("panels/setPosition",{id:Ee.id,panelId:Ee.panelId,x:it,y:J})}}}))}mt(()=>{window.addEventListener("keydown",Q)}),Vt(()=>{window.removeEventListener("keydown",Q)});let fe=null,we=!1;function Be(w){w.ctrlKey?!we&&fe===null&&(fe=setTimeout(U)):B()}function U(){document.body.classList.add("ctrl-key"),we=!0}function B(){fe!==null&&(clearTimeout(fe),fe=null),document.body.classList.remove("ctrl-key"),we=!1}mt(()=>{for(const w of["keydown","keyup","mousemove"])window.addEventListener(w,Be,!0);window.addEventListener("blur",B)}),Vt(()=>{for(const w of["keydown","keyup","mousemove"])window.removeEventListener(w,Be,!0);window.removeEventListener("blur",B)});function k(w){Z(()=>{o.state.ui.selection!==w&&o.commit("ui/setSelection",w)})}return Xe(()=>o.state.ui.selection,w=>{var L,oe;((L=document.activeElement)==null?void 0:L.getAttribute("data-obj-id"))!==""+w&&((oe=document.querySelector(`*[data-obj-id='${w}']`))==null||oe.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),Lo.setStore(o),window.store=o,window.env=ve,mt(()=>dr(this,null,function*(){yield ve.loadGameMode(),ve.connectToStore(o),s.value=!1;const w=yield ve.loadSettings();yield Z(()=>dr(this,null,function*(){var L,oe,Ce,Ee;ve.state.looseTextParsing=w.looseTextParsing||!0,o.commit("ui/setLqRendering",(L=w.lq)!=null?L:!1),o.commit("ui/setDarkTheme",(oe=w.darkMode)!=null?oe:null),o.commit("ui/setDefaultCharacterTalkingZoom",(Ce=w.defaultCharacterTalkingZoom)!=null?Ce:!0),yield o.dispatch("content/loadContentPacks",[`${vt}buildin.base.backgrounds.json`,`${vt}buildin.base.monika.json`,`${vt}buildin.base.sayori.json`,`${vt}buildin.base.natsuki.json`,`${vt}buildin.base.yuri.json`,`${vt}buildin.extra.mc.json`,`${vt}buildin.extra.concept_mc.json`,`${vt}buildin.extra.mc_chad.json`,`${vt}buildin.extra.femc.json`,`${vt}buildin.extra.concept_femc.json`,`${vt}buildin.extra.amy.json`]),yield ve.loadContentPacks();const it=yield o.dispatch("panels/createPanel");Object.keys(o.state.panels.panels[it].objects).length===0&&(yield o.dispatch("panels/createTextBox",{panelId:it,text:`Hi! Click here to edit this textbox! ${o.state.ui.vertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`})),o.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:o.state.panels.currentPanel}),o.commit("ui/setNsfw",(Ee=w.nsfw)!=null?Ee:!1)}))})),(w,L)=>(x(),E(le,null,[d("div",OT,[d("div",$T,[(x(!0),E(le,null,Ve(l.value,oe=>(x(),E("div",{key:oe,tabindex:"0","data-obj-id":oe,onFocus:L[0]||(L[0]=Ce=>K()),onBlur:L[1]||(L[1]=Ce=>K()),onKeydown:[lt(ae(Ce=>k(oe),["prevent"]),["enter"]),lt(ae(Ce=>k(oe),["prevent"]),["space"])]},null,40,ST))),128))]),A(zk,{ref_key:"renderer",ref:r,canvasWidth:c.value,canvasHeight:u.value,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),A(xk),A(kT,{onShowPrevRender:a,onDownload:L[2]||(L[2]=oe=>r.value.download()),onShowDialog:R,onShowExpressionDialog:j}),(x(),ce(zg,null,[T.value?(x(),ce($o,{key:0,ref:"dialog",onLeave:L[4]||(L[4]=oe=>T.value=!1)},{default:q(()=>[A(ne(e),{ref_key:"packDialog",ref:S,onLeave:L[3]||(L[3]=oe=>T.value=!1)},null,512)]),_:1},512)):ue("",!0)],1024)),h.value?(x(),ce($o,{key:0,ref:"dialog",onLeave:L[6]||(L[6]=oe=>h.value=!1)},{default:q(()=>[A(ne(n),{character:v.value,initHeadGroup:_.value,onLeave:L[5]||(L[5]=oe=>h.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):ue("",!0)]),IT],64))}});vb(AT).use(mk).mount("#main_wrapper");export{mt as A,Vt as B,Oe as C,qe as D,Cm as E,le as F,uf as G,Wo as H,je as I,Dn as J,Zt as K,En as L,Mv as M,Bv as N,Bt as O,St as P,HP as Q,Lo as R,vh as S,RT as T,br as U,Uf as V,$v as W,an as X,Do as Y,Z,Re as _,E as a,d as b,$ as c,Pe as d,Ve as e,ue as f,A as g,q as h,Qn as i,ve as j,W as k,ne as l,Ye as m,Me as n,x as o,ce as p,ze as q,N as r,Ke as s,$e as t,De as u,ae as v,Xe as w,_t as x,wt as y,Bk as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./single-box-IbdHM6Sd.js","./single-box-r4ULXqGB.css","./index-wZ4dA3Hn.js","./index-W9OjW2tR.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
