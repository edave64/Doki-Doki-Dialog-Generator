var Va=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function Ni(t,e){const n=Object.create(null),o=t.split(",");for(let s=0;s<o.length;s++)n[o[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const We={},Po=[],zt=()=>{},Tv=()=>!1,Av=/^on[^a-z]/,Vr=t=>Av.test(t),Fi=t=>t.startsWith("onUpdate:"),nt=Object.assign,Hi=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Ev=Object.prototype.hasOwnProperty,Se=(t,e)=>Ev.call(t,e),ue=Array.isArray,Co=t=>Xo(t)==="[object Map]",Go=t=>Xo(t)==="[object Set]",Wa=t=>Xo(t)==="[object Date]",Rv=t=>Xo(t)==="[object RegExp]",_e=t=>typeof t=="function",Je=t=>typeof t=="string",Io=t=>typeof t=="symbol",He=t=>t!==null&&typeof t=="object",Id=t=>(He(t)||_e(t))&&_e(t.then)&&_e(t.catch),jd=Object.prototype.toString,Xo=t=>jd.call(t),Bv=t=>Xo(t).slice(8,-1),Td=t=>Xo(t)==="[object Object]",Ui=t=>Je(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ur=Ni(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Wr=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Mv=/-(\w)/g,jo=Wr(t=>t.replace(Mv,(e,n)=>n?n.toUpperCase():"")),Dv=/\B([A-Z])/g,io=Wr(t=>t.replace(Dv,"-$1").toLowerCase()),Ad=Wr(t=>t.charAt(0).toUpperCase()+t.slice(1)),Cl=Wr(t=>t?`on${Ad(t)}`:""),no=(t,e)=>!Object.is(t,e),xo=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},gr=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},mr=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Lv=t=>{const e=Je(t)?Number(t):NaN;return isNaN(e)?t:e};let za;const Kl=()=>za||(za=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Ke(t){if(ue(t)){const e={};for(let n=0;n<t.length;n++){const o=t[n],s=Je(o)?Uv(o):Ke(o);if(s)for(const r in s)e[r]=s[r]}return e}else if(Je(t)||He(t))return t}const Nv=/;(?![^(]*\))/g,Fv=/:([^]+)/,Hv=/\/\*[^]*?\*\//g;function Uv(t){const e={};return t.replace(Hv,"").split(Nv).forEach(n=>{if(n){const o=n.split(Fv);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function Le(t){let e="";if(Je(t))e=t;else if(ue(t))for(let n=0;n<t.length;n++){const o=Le(t[n]);o&&(e+=o+" ")}else if(He(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Vv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Wv=Ni(Vv);function Ed(t){return!!t||t===""}function zv(t,e){if(t.length!==e.length)return!1;let n=!0;for(let o=0;n&&o<t.length;o++)n=Rs(t[o],e[o]);return n}function Rs(t,e){if(t===e)return!0;let n=Wa(t),o=Wa(e);if(n||o)return n&&o?t.getTime()===e.getTime():!1;if(n=Io(t),o=Io(e),n||o)return t===e;if(n=ue(t),o=ue(e),n||o)return n&&o?zv(t,e):!1;if(n=He(t),o=He(e),n||o){if(!n||!o)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const l in t){const a=t.hasOwnProperty(l),i=e.hasOwnProperty(l);if(a&&!i||!a&&i||!Rs(t[l],e[l]))return!1}}return String(t)===String(e)}function Vi(t,e){return t.findIndex(n=>Rs(n,e))}const $e=t=>Je(t)?t:t==null?"":ue(t)||He(t)&&(t.toString===jd||!_e(t.toString))?JSON.stringify(t,Rd,2):String(t),Rd=(t,e)=>e&&e.__v_isRef?Rd(t,e.value):Co(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[o,s])=>(n[`${o} =>`]=s,n),{})}:Go(e)?{[`Set(${e.size})`]:[...e.values()]}:He(e)&&!ue(e)&&!Td(e)?String(e):e;let Ft;class Bd{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ft,!e&&Ft&&(this.index=(Ft.scopes||(Ft.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Ft;try{return Ft=this,e()}finally{Ft=n}}}on(){Ft=this}off(){Ft=this.parent}stop(e){if(this._active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Gv(t){return new Bd(t)}function Xv(t,e=Ft){e&&e.active&&e.effects.push(t)}function Yv(){return Ft}const Wi=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Md=t=>(t.w&Ln)>0,Dd=t=>(t.n&Ln)>0,qv=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Ln},Kv=t=>{const{deps:e}=t;if(e.length){let n=0;for(let o=0;o<e.length;o++){const s=e[o];Md(s)&&!Dd(s)?s.delete(t):e[n++]=s,s.w&=~Ln,s.n&=~Ln}e.length=n}},Jl=new WeakMap;let ps=0,Ln=1;const Ql=30;let Ht;const Zn=Symbol(""),Zl=Symbol("");class zi{constructor(e,n=null,o){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Xv(this,o)}run(){if(!this.active)return this.fn();let e=Ht,n=En;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ht,Ht=this,En=!0,Ln=1<<++ps,ps<=Ql?qv(this):Ga(this),this.fn()}finally{ps<=Ql&&Kv(this),Ln=1<<--ps,Ht=this.parent,En=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ht===this?this.deferStop=!0:this.active&&(Ga(this),this.onStop&&this.onStop(),this.active=!1)}}function Ga(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let En=!0;const Ld=[];function Yo(){Ld.push(En),En=!1}function qo(){const t=Ld.pop();En=t===void 0?!0:t}function yt(t,e,n){if(En&&Ht){let o=Jl.get(t);o||Jl.set(t,o=new Map);let s=o.get(n);s||o.set(n,s=Wi()),Nd(s)}}function Nd(t,e){let n=!1;ps<=Ql?Dd(t)||(t.n|=Ln,n=!Md(t)):n=!t.has(Ht),n&&(t.add(Ht),Ht.deps.push(t))}function cn(t,e,n,o,s,r){const l=Jl.get(t);if(!l)return;let a=[];if(e==="clear")a=[...l.values()];else if(n==="length"&&ue(t)){const i=Number(o);l.forEach((u,c)=>{(c==="length"||!Io(c)&&c>=i)&&a.push(u)})}else switch(n!==void 0&&a.push(l.get(n)),e){case"add":ue(t)?Ui(n)&&a.push(l.get("length")):(a.push(l.get(Zn)),Co(t)&&a.push(l.get(Zl)));break;case"delete":ue(t)||(a.push(l.get(Zn)),Co(t)&&a.push(l.get(Zl)));break;case"set":Co(t)&&a.push(l.get(Zn));break}if(a.length===1)a[0]&&ei(a[0]);else{const i=[];for(const u of a)u&&i.push(...u);ei(Wi(i))}}function ei(t,e){const n=ue(t)?t:[...t];for(const o of n)o.computed&&Xa(o);for(const o of n)o.computed||Xa(o)}function Xa(t,e){(t!==Ht||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Jv=Ni("__proto__,__v_isRef,__isVue"),Fd=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Io)),Ya=Qv();function Qv(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const o=Ae(this);for(let r=0,l=this.length;r<l;r++)yt(o,"get",r+"");const s=o[e](...n);return s===-1||s===!1?o[e](...n.map(Ae)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Yo();const o=Ae(this)[e].apply(this,n);return qo(),o}}),t}function Zv(t){const e=Ae(this);return yt(e,"has",t),e.hasOwnProperty(t)}class Hd{constructor(e=!1,n=!1){this._isReadonly=e,this._shallow=n}get(e,n,o){const s=this._isReadonly,r=this._shallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw"&&o===(s?r?fg:zd:r?Wd:Vd).get(e))return e;const l=ue(e);if(!s){if(l&&Se(Ya,n))return Reflect.get(Ya,n,o);if(n==="hasOwnProperty")return Zv}const a=Reflect.get(e,n,o);return(Io(n)?Fd.has(n):Jv(n))||(s||yt(e,"get",n),r)?a:be(a)?l&&Ui(n)?a:a.value:He(a)?s?Gd(a):Nn(a):a}}class Ud extends Hd{constructor(e=!1){super(!1,e)}set(e,n,o,s){let r=e[n];if(To(r)&&be(r)&&!be(o))return!1;if(!this._shallow&&(!br(o)&&!To(o)&&(r=Ae(r),o=Ae(o)),!ue(e)&&be(r)&&!be(o)))return r.value=o,!0;const l=ue(e)&&Ui(n)?Number(n)<e.length:Se(e,n),a=Reflect.set(e,n,o,s);return e===Ae(s)&&(l?no(o,r)&&cn(e,"set",n,o):cn(e,"add",n,o)),a}deleteProperty(e,n){const o=Se(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&o&&cn(e,"delete",n,void 0),s}has(e,n){const o=Reflect.has(e,n);return(!Io(n)||!Fd.has(n))&&yt(e,"has",n),o}ownKeys(e){return yt(e,"iterate",ue(e)?"length":Zn),Reflect.ownKeys(e)}}class eg extends Hd{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const tg=new Ud,ng=new eg,og=new Ud(!0),Gi=t=>t,zr=t=>Reflect.getPrototypeOf(t);function Vs(t,e,n=!1,o=!1){t=t.__v_raw;const s=Ae(t),r=Ae(e);n||(no(e,r)&&yt(s,"get",e),yt(s,"get",r));const{has:l}=zr(s),a=o?Gi:n?qi:ks;if(l.call(s,e))return a(t.get(e));if(l.call(s,r))return a(t.get(r));t!==s&&t.get(e)}function Ws(t,e=!1){const n=this.__v_raw,o=Ae(n),s=Ae(t);return e||(no(t,s)&&yt(o,"has",t),yt(o,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function zs(t,e=!1){return t=t.__v_raw,!e&&yt(Ae(t),"iterate",Zn),Reflect.get(t,"size",t)}function qa(t){t=Ae(t);const e=Ae(this);return zr(e).has.call(e,t)||(e.add(t),cn(e,"add",t,t)),this}function Ka(t,e){e=Ae(e);const n=Ae(this),{has:o,get:s}=zr(n);let r=o.call(n,t);r||(t=Ae(t),r=o.call(n,t));const l=s.call(n,t);return n.set(t,e),r?no(e,l)&&cn(n,"set",t,e):cn(n,"add",t,e),this}function Ja(t){const e=Ae(this),{has:n,get:o}=zr(e);let s=n.call(e,t);s||(t=Ae(t),s=n.call(e,t)),o&&o.call(e,t);const r=e.delete(t);return s&&cn(e,"delete",t,void 0),r}function Qa(){const t=Ae(this),e=t.size!==0,n=t.clear();return e&&cn(t,"clear",void 0,void 0),n}function Gs(t,e){return function(o,s){const r=this,l=r.__v_raw,a=Ae(l),i=e?Gi:t?qi:ks;return!t&&yt(a,"iterate",Zn),l.forEach((u,c)=>o.call(s,i(u),i(c),r))}}function Xs(t,e,n){return function(...o){const s=this.__v_raw,r=Ae(s),l=Co(r),a=t==="entries"||t===Symbol.iterator&&l,i=t==="keys"&&l,u=s[t](...o),c=n?Gi:e?qi:ks;return!e&&yt(r,"iterate",i?Zl:Zn),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:a?[c(f[0]),c(f[1])]:c(f),done:h}},[Symbol.iterator](){return this}}}}function gn(t){return function(...e){return t==="delete"?!1:this}}function sg(){const t={get(r){return Vs(this,r)},get size(){return zs(this)},has:Ws,add:qa,set:Ka,delete:Ja,clear:Qa,forEach:Gs(!1,!1)},e={get(r){return Vs(this,r,!1,!0)},get size(){return zs(this)},has:Ws,add:qa,set:Ka,delete:Ja,clear:Qa,forEach:Gs(!1,!0)},n={get(r){return Vs(this,r,!0)},get size(){return zs(this,!0)},has(r){return Ws.call(this,r,!0)},add:gn("add"),set:gn("set"),delete:gn("delete"),clear:gn("clear"),forEach:Gs(!0,!1)},o={get(r){return Vs(this,r,!0,!0)},get size(){return zs(this,!0)},has(r){return Ws.call(this,r,!0)},add:gn("add"),set:gn("set"),delete:gn("delete"),clear:gn("clear"),forEach:Gs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=Xs(r,!1,!1),n[r]=Xs(r,!0,!1),e[r]=Xs(r,!1,!0),o[r]=Xs(r,!0,!0)}),[t,n,e,o]}const[rg,lg,ig,ag]=sg();function Xi(t,e){const n=e?t?ag:ig:t?lg:rg;return(o,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?o:Reflect.get(Se(n,s)&&s in o?n:o,s,r)}const ug={get:Xi(!1,!1)},cg={get:Xi(!1,!0)},dg={get:Xi(!0,!1)},Vd=new WeakMap,Wd=new WeakMap,zd=new WeakMap,fg=new WeakMap;function pg(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function hg(t){return t.__v_skip||!Object.isExtensible(t)?0:pg(Bv(t))}function Nn(t){return To(t)?t:Yi(t,!1,tg,ug,Vd)}function vg(t){return Yi(t,!1,og,cg,Wd)}function Gd(t){return Yi(t,!0,ng,dg,zd)}function Yi(t,e,n,o,s){if(!He(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=s.get(t);if(r)return r;const l=hg(t);if(l===0)return t;const a=new Proxy(t,l===2?o:n);return s.set(t,a),a}function ko(t){return To(t)?ko(t.__v_raw):!!(t&&t.__v_isReactive)}function To(t){return!!(t&&t.__v_isReadonly)}function br(t){return!!(t&&t.__v_isShallow)}function Xd(t){return ko(t)||To(t)}function Ae(t){const e=t&&t.__v_raw;return e?Ae(e):t}function Yd(t){return gr(t,"__v_skip",!0),t}const ks=t=>He(t)?Nn(t):t,qi=t=>He(t)?Gd(t):t;function qd(t){En&&Ht&&(t=Ae(t),Nd(t.dep||(t.dep=Wi())))}function Kd(t,e){t=Ae(t);const n=t.dep;n&&ei(n)}function be(t){return!!(t&&t.__v_isRef===!0)}function L(t){return gg(t,!1)}function gg(t,e){return be(t)?t:new mg(t,e)}class mg{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Ae(e),this._value=n?e:ks(e)}get value(){return qd(this),this._value}set value(e){const n=this.__v_isShallow||br(e)||To(e);e=n?e:Ae(e),no(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:ks(e),Kd(this))}}function ne(t){return be(t)?t.value:t}const bg={get:(t,e,n)=>ne(Reflect.get(t,e,n)),set:(t,e,n,o)=>{const s=t[e];return be(s)&&!be(n)?(s.value=n,!0):Reflect.set(t,e,n,o)}};function Jd(t){return ko(t)?t:new Proxy(t,bg)}class yg{constructor(e,n,o,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new zi(e,()=>{this._dirty||(this._dirty=!0,Kd(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=o}get value(){const e=Ae(this);return qd(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function _g(t,e,n=!1){let o,s;const r=_e(t);return r?(o=t,s=zt):(o=t.get,s=t.set),new yg(o,s,r||!s,n)}function Rn(t,e,n,o){let s;try{s=o?t(...o):t()}catch(r){Bs(r,e,n)}return s}function Et(t,e,n,o){if(_e(t)){const r=Rn(t,e,n,o);return r&&Id(r)&&r.catch(l=>{Bs(l,e,n)}),r}const s=[];for(let r=0;r<t.length;r++)s.push(Et(t[r],e,n,o));return s}function Bs(t,e,n,o=!0){const s=e?e.vnode:null;if(e){let r=e.parent;const l=e.proxy,a=n;for(;r;){const u=r.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](t,l,a)===!1)return}r=r.parent}const i=e.appContext.config.errorHandler;if(i){Rn(i,null,10,[t,l,a]);return}}wg(t,n,s,o)}function wg(t,e,n,o=!0){console.error(t)}let Os=!1,ti=!1;const ft=[];let Zt=0;const Oo=[];let an=null,Yn=0;const Qd=Promise.resolve();let Ki=null;function eo(t){const e=Ki||Qd;return t?e.then(this?t.bind(this):t):e}function Pg(t){let e=Zt+1,n=ft.length;for(;e<n;){const o=e+n>>>1,s=ft[o],r=$s(s);r<t||r===t&&s.pre?e=o+1:n=o}return e}function Gr(t){(!ft.length||!ft.includes(t,Os&&t.allowRecurse?Zt+1:Zt))&&(t.id==null?ft.push(t):ft.splice(Pg(t.id),0,t),Zd())}function Zd(){!Os&&!ti&&(ti=!0,Ki=Qd.then(tf))}function Cg(t){const e=ft.indexOf(t);e>Zt&&ft.splice(e,1)}function xg(t){ue(t)?Oo.push(...t):(!an||!an.includes(t,t.allowRecurse?Yn+1:Yn))&&Oo.push(t),Zd()}function Za(t,e=Os?Zt+1:0){for(;e<ft.length;e++){const n=ft[e];n&&n.pre&&(ft.splice(e,1),e--,n())}}function ef(t){if(Oo.length){const e=[...new Set(Oo)];if(Oo.length=0,an){an.push(...e);return}for(an=e,an.sort((n,o)=>$s(n)-$s(o)),Yn=0;Yn<an.length;Yn++)an[Yn]();an=null,Yn=0}}const $s=t=>t.id==null?1/0:t.id,kg=(t,e)=>{const n=$s(t)-$s(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function tf(t){ti=!1,Os=!0,ft.sort(kg);const e=zt;try{for(Zt=0;Zt<ft.length;Zt++){const n=ft[Zt];n&&n.active!==!1&&Rn(n,null,14)}}finally{Zt=0,ft.length=0,ef(),Os=!1,Ki=null,(ft.length||Oo.length)&&tf()}}function Og(t,e,...n){if(t.isUnmounted)return;const o=t.vnode.props||We;let s=n;const r=e.startsWith("update:"),l=r&&e.slice(7);if(l&&l in o){const c=`${l==="modelValue"?"model":l}Modifiers`,{number:f,trim:h}=o[c]||We;h&&(s=n.map(v=>Je(v)?v.trim():v)),f&&(s=n.map(mr))}let a,i=o[a=Cl(e)]||o[a=Cl(jo(e))];!i&&r&&(i=o[a=Cl(io(e))]),i&&Et(i,t,6,s);const u=o[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Et(u,t,6,s)}}function nf(t,e,n=!1){const o=e.emitsCache,s=o.get(t);if(s!==void 0)return s;const r=t.emits;let l={},a=!1;if(!_e(t)){const i=u=>{const c=nf(u,e,!0);c&&(a=!0,nt(l,c))};!n&&e.mixins.length&&e.mixins.forEach(i),t.extends&&i(t.extends),t.mixins&&t.mixins.forEach(i)}return!r&&!a?(He(t)&&o.set(t,null),null):(ue(r)?r.forEach(i=>l[i]=null):nt(l,r),He(t)&&o.set(t,l),l)}function Xr(t,e){return!t||!Vr(e)?!1:(e=e.slice(2).replace(/Once$/,""),Se(t,e[0].toLowerCase()+e.slice(1))||Se(t,io(e))||Se(t,e))}let pt=null,Yr=null;function yr(t){const e=pt;return pt=t,Yr=t&&t.type.__scopeId||null,e}function _t(t){Yr=t}function wt(){Yr=null}function Y(t,e=pt,n){if(!e||t._n)return t;const o=(...s)=>{o._d&&du(-1);const r=yr(e);let l;try{l=t(...s)}finally{yr(r),o._d&&du(1)}return l};return o._n=!0,o._c=!0,o._d=!0,o}function xl(t){const{type:e,vnode:n,proxy:o,withProxy:s,props:r,propsOptions:[l],slots:a,attrs:i,emit:u,render:c,renderCache:f,data:h,setupState:v,ctx:g,inheritAttrs:b}=t;let w,$;const p=yr(t);try{if(n.shapeFlag&4){const _=s||o;w=Qt(c.call(_,_,f,r,v,h,g)),$=i}else{const _=e;w=Qt(_.length>1?_(r,{attrs:i,slots:a,emit:u}):_(r,null)),$=e.props?i:$g(i)}}catch(_){_s.length=0,Bs(_,t,1),w=R(fn)}let m=w;if($&&b!==!1){const _=Object.keys($),{shapeFlag:A}=m;_.length&&A&7&&(l&&_.some(Fi)&&($=Sg($,l)),m=Fn(m,$))}return n.dirs&&(m=Fn(m),m.dirs=m.dirs?m.dirs.concat(n.dirs):n.dirs),n.transition&&(m.transition=n.transition),w=m,yr(p),w}const $g=t=>{let e;for(const n in t)(n==="class"||n==="style"||Vr(n))&&((e||(e={}))[n]=t[n]);return e},Sg=(t,e)=>{const n={};for(const o in t)(!Fi(o)||!(o.slice(9)in e))&&(n[o]=t[o]);return n};function Ig(t,e,n){const{props:o,children:s,component:r}=t,{props:l,children:a,patchFlag:i}=e,u=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&i>=0){if(i&1024)return!0;if(i&16)return o?eu(o,l,u):!!l;if(i&8){const c=e.dynamicProps;for(let f=0;f<c.length;f++){const h=c[f];if(l[h]!==o[h]&&!Xr(u,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===l?!1:o?l?eu(o,l,u):!0:!!l;return!1}function eu(t,e,n){const o=Object.keys(e);if(o.length!==Object.keys(t).length)return!0;for(let s=0;s<o.length;s++){const r=o[s];if(e[r]!==t[r]&&!Xr(n,r))return!0}return!1}function jg({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const of=t=>t.__isSuspense;function Tg(t,e){e&&e.pendingBranch?ue(t)?e.effects.push(...t):e.effects.push(t):xg(t)}const Ys={};function Xe(t,e,n){return sf(t,e,n)}function sf(t,e,{immediate:n,deep:o,flush:s,onTrack:r,onTrigger:l}=We){var a;const i=Yv()===((a=it)==null?void 0:a.scope)?it:null;let u,c=!1,f=!1;if(be(t)?(u=()=>t.value,c=br(t)):ko(t)?(u=()=>t,o=!0):ue(t)?(f=!0,c=t.some(_=>ko(_)||br(_)),u=()=>t.map(_=>{if(be(_))return _.value;if(ko(_))return Jn(_);if(_e(_))return Rn(_,i,2)})):_e(t)?e?u=()=>Rn(t,i,2):u=()=>{if(!(i&&i.isUnmounted))return h&&h(),Et(t,i,3,[v])}:u=zt,e&&o){const _=u;u=()=>Jn(_())}let h,v=_=>{h=p.onStop=()=>{Rn(_,i,4)}},g;if(Eo)if(v=zt,e?n&&Et(e,i,3,[u(),f?[]:void 0,v]):u(),s==="sync"){const _=$m();g=_.__watcherHandles||(_.__watcherHandles=[])}else return zt;let b=f?new Array(t.length).fill(Ys):Ys;const w=()=>{if(!!p.active)if(e){const _=p.run();(o||c||(f?_.some((A,I)=>no(A,b[I])):no(_,b)))&&(h&&h(),Et(e,i,3,[_,b===Ys?void 0:f&&b[0]===Ys?[]:b,v]),b=_)}else p.run()};w.allowRecurse=!!e;let $;s==="sync"?$=w:s==="post"?$=()=>ut(w,i&&i.suspense):(w.pre=!0,i&&(w.id=i.uid),$=()=>Gr(w));const p=new zi(u,$);e?n?w():b=p.run():s==="post"?ut(p.run.bind(p),i&&i.suspense):p.run();const m=()=>{p.stop(),i&&i.scope&&Hi(i.scope.effects,p)};return g&&g.push(m),m}function Ag(t,e,n){const o=this.proxy,s=Je(t)?t.includes(".")?rf(o,t):()=>o[t]:t.bind(o,o);let r;_e(e)?r=e:(r=e.handler,n=e);const l=it;Ao(this);const a=sf(s,r.bind(o),n);return l?Ao(l):to(),a}function rf(t,e){const n=e.split(".");return()=>{let o=t;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}function Jn(t,e){if(!He(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),be(t))Jn(t.value,e);else if(ue(t))for(let n=0;n<t.length;n++)Jn(t[n],e);else if(Go(t)||Co(t))t.forEach(n=>{Jn(n,e)});else if(Td(t))for(const n in t)Jn(t[n],e);return t}function Oe(t,e){const n=pt;if(n===null)return t;const o=Qr(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[l,a,i,u=We]=e[r];l&&(_e(l)&&(l={mounted:l,updated:l}),l.deep&&Jn(a),s.push({dir:l,instance:o,value:a,oldValue:void 0,arg:i,modifiers:u}))}return t}function Vn(t,e,n,o){const s=t.dirs,r=e&&e.dirs;for(let l=0;l<s.length;l++){const a=s[l];r&&(a.oldValue=r[l].value);let i=a.dir[o];i&&(Yo(),Et(i,n,8,[t.el,a,t,e]),qo())}}const fo=Symbol("_leaveCb"),qs=Symbol("_enterCb");function Eg(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mt(()=>{t.isMounted=!0}),Zi(()=>{t.isUnmounting=!0}),t}const St=[Function,Array],Rg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:St,onEnter:St,onAfterEnter:St,onEnterCancelled:St,onBeforeLeave:St,onLeave:St,onAfterLeave:St,onLeaveCancelled:St,onBeforeAppear:St,onAppear:St,onAfterAppear:St,onAppearCancelled:St};function Bg(t,e){const{leavingVNodes:n}=t;let o=n.get(e.type);return o||(o=Object.create(null),n.set(e.type,o)),o}function ni(t,e,n,o){const{appear:s,mode:r,persisted:l=!1,onBeforeEnter:a,onEnter:i,onAfterEnter:u,onEnterCancelled:c,onBeforeLeave:f,onLeave:h,onAfterLeave:v,onLeaveCancelled:g,onBeforeAppear:b,onAppear:w,onAfterAppear:$,onAppearCancelled:p}=e,m=String(t.key),_=Bg(n,t),A=(j,M)=>{j&&Et(j,o,9,M)},I=(j,M)=>{const H=M[1];A(j,M),ue(j)?j.every(te=>te.length<=1)&&H():j.length<=1&&H()},E={mode:r,persisted:l,beforeEnter(j){let M=a;if(!n.isMounted)if(s)M=b||a;else return;j[fo]&&j[fo](!0);const H=_[m];H&&qn(t,H)&&H.el[fo]&&H.el[fo](),A(M,[j])},enter(j){let M=i,H=u,te=c;if(!n.isMounted)if(s)M=w||i,H=$||u,te=p||c;else return;let q=!1;const pe=j[qs]=we=>{q||(q=!0,we?A(te,[j]):A(H,[j]),E.delayedLeave&&E.delayedLeave(),j[qs]=void 0)};M?I(M,[j,pe]):pe()},leave(j,M){const H=String(t.key);if(j[qs]&&j[qs](!0),n.isUnmounting)return M();A(f,[j]);let te=!1;const q=j[fo]=pe=>{te||(te=!0,M(),pe?A(g,[j]):A(v,[j]),j[fo]=void 0,_[H]===t&&delete _[H])};_[H]=t,h?I(h,[j,q]):q()},clone(j){return ni(j,e,n,o)}};return E}function _r(t,e){t.shapeFlag&6&&t.component?_r(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function lf(t,e=!1,n){let o=[],s=0;for(let r=0;r<t.length;r++){let l=t[r];const a=n==null?l.key:String(n)+String(l.key!=null?l.key:r);l.type===re?(l.patchFlag&128&&s++,o=o.concat(lf(l.children,e,a))):(e||l.type!==fn)&&o.push(a!=null?Fn(l,{key:a}):l)}if(s>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}/*! #__NO_SIDE_EFFECTS__ */function Pe(t,e){return _e(t)?(()=>nt({name:t.name},e,{setup:t}))():t}const $o=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function tu(t){_e(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:o,delay:s=200,timeout:r,suspensible:l=!0,onError:a}=t;let i=null,u,c=0;const f=()=>(c++,i=null,h()),h=()=>{let v;return i||(v=i=e().catch(g=>{if(g=g instanceof Error?g:new Error(String(g)),a)return new Promise((b,w)=>{a(g,()=>b(f()),()=>w(g),c+1)});throw g}).then(g=>v!==i&&i?i:(g&&(g.__esModule||g[Symbol.toStringTag]==="Module")&&(g=g.default),u=g,g)))};return Pe({name:"AsyncComponentWrapper",__asyncLoader:h,get __asyncResolved(){return u},setup(){const v=it;if(u)return()=>kl(u,v);const g=p=>{i=null,Bs(p,v,13,!o)};if(l&&v.suspense||Eo)return h().then(p=>()=>kl(p,v)).catch(p=>(g(p),()=>o?R(o,{error:p}):null));const b=L(!1),w=L(),$=L(!!s);return s&&setTimeout(()=>{$.value=!1},s),r!=null&&setTimeout(()=>{if(!b.value&&!w.value){const p=new Error(`Async component timed out after ${r}ms.`);g(p),w.value=p}},r),h().then(()=>{b.value=!0,v.parent&&Ji(v.parent.vnode)&&Gr(v.parent.update)}).catch(p=>{g(p),w.value=p}),()=>{if(b.value&&u)return kl(u,v);if(w.value&&o)return R(o,{error:w.value});if(n&&!$.value)return R(n)}}})}function kl(t,e){const{ref:n,props:o,children:s,ce:r}=e.vnode,l=R(t,o,s);return l.ref=n,l.ce=r,delete e.vnode.ce,l}const Ji=t=>t.type.__isKeepAlive,Mg={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=Cf(),o=n.ctx;if(!o.renderer)return()=>{const p=e.default&&e.default();return p&&p.length===1?p[0]:p};const s=new Map,r=new Set;let l=null;const a=n.suspense,{renderer:{p:i,m:u,um:c,o:{createElement:f}}}=o,h=f("div");o.activate=(p,m,_,A,I)=>{const E=p.component;u(p,m,_,0,a),i(E.vnode,p,m,_,E,a,A,p.slotScopeIds,I),ut(()=>{E.isDeactivated=!1,E.a&&xo(E.a);const j=p.props&&p.props.onVnodeMounted;j&&jt(j,E.parent,p)},a)},o.deactivate=p=>{const m=p.component;u(p,h,null,1,a),ut(()=>{m.da&&xo(m.da);const _=p.props&&p.props.onVnodeUnmounted;_&&jt(_,m.parent,p),m.isDeactivated=!0},a)};function v(p){Ol(p),c(p,n,a,!0)}function g(p){s.forEach((m,_)=>{const A=vu(m.type);A&&(!p||!p(A))&&b(_)})}function b(p){const m=s.get(p);!l||!qn(m,l)?v(m):l&&Ol(l),s.delete(p),r.delete(p)}Xe(()=>[t.include,t.exclude],([p,m])=>{p&&g(_=>hs(p,_)),m&&g(_=>!hs(m,_))},{flush:"post",deep:!0});let w=null;const $=()=>{w!=null&&s.set(w,$l(n.subTree))};return mt($),Qi($),Zi(()=>{s.forEach(p=>{const{subTree:m,suspense:_}=n,A=$l(m);if(p.type===A.type&&p.key===A.key){Ol(A);const I=A.component.da;I&&ut(I,_);return}v(p)})}),()=>{if(w=null,!e.default)return null;const p=e.default(),m=p[0];if(p.length>1)return l=null,p;if(!Is(m)||!(m.shapeFlag&4)&&!(m.shapeFlag&128))return l=null,m;let _=$l(m);const A=_.type,I=vu($o(_)?_.type.__asyncResolved||{}:A),{include:E,exclude:j,max:M}=t;if(E&&(!I||!hs(E,I))||j&&I&&hs(j,I))return l=_,m;const H=_.key==null?A:_.key,te=s.get(H);return _.el&&(_=Fn(_),m.shapeFlag&128&&(m.ssContent=_)),w=H,te?(_.el=te.el,_.component=te.component,_.transition&&_r(_,_.transition),_.shapeFlag|=512,r.delete(H),r.add(H)):(r.add(H),M&&r.size>parseInt(M,10)&&b(r.values().next().value)),_.shapeFlag|=256,l=_,of(m.type)?m:_}}},Dg=Mg;function hs(t,e){return ue(t)?t.some(n=>hs(n,e)):Je(t)?t.split(",").includes(e):Rv(t)?t.test(e):!1}function af(t,e){cf(t,"a",e)}function uf(t,e){cf(t,"da",e)}function cf(t,e,n=it){const o=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(qr(e,o,n),n){let s=n.parent;for(;s&&s.parent;)Ji(s.parent.vnode)&&Lg(o,e,n,s),s=s.parent}}function Lg(t,e,n,o){const s=qr(e,t,o,!0);Ut(()=>{Hi(o[e],s)},n)}function Ol(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function $l(t){return t.shapeFlag&128?t.ssContent:t}function qr(t,e,n=it,o=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...l)=>{if(n.isUnmounted)return;Yo(),Ao(n);const a=Et(e,n,t,l);return to(),qo(),a});return o?s.unshift(r):s.push(r),r}}const hn=t=>(e,n=it)=>(!Eo||t==="sp")&&qr(t,(...o)=>e(...o),n),Ng=hn("bm"),mt=hn("m"),Fg=hn("bu"),Qi=hn("u"),Zi=hn("bum"),Ut=hn("um"),Hg=hn("sp"),Ug=hn("rtg"),Vg=hn("rtc");function Wg(t,e=it){qr("ec",t,e)}const zg=Symbol.for("v-ndc");function Ve(t,e,n,o){let s;const r=n&&n[o];if(ue(t)||Je(t)){s=new Array(t.length);for(let l=0,a=t.length;l<a;l++)s[l]=e(t[l],l,void 0,r&&r[l])}else if(typeof t=="number"){s=new Array(t);for(let l=0;l<t;l++)s[l]=e(l+1,l,void 0,r&&r[l])}else if(He(t))if(t[Symbol.iterator])s=Array.from(t,(l,a)=>e(l,a,void 0,r&&r[a]));else{const l=Object.keys(t);s=new Array(l.length);for(let a=0,i=l.length;a<i;a++){const u=l[a];s[a]=e(t[u],u,a,r&&r[a])}}else s=[];return n&&(n[o]=s),s}function en(t,e,n={},o,s){if(pt.isCE||pt.parent&&$o(pt.parent)&&pt.parent.isCE)return e!=="default"&&(n.name=e),R("slot",n,o&&o());let r=t[e];r&&r._c&&(r._d=!1),k();const l=r&&df(r(n)),a=ae(re,{key:n.key||l&&l.key||`_${e}`},l||(o?o():[]),l&&t._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),r&&r._c&&(r._d=!0),a}function df(t){return t.some(e=>Is(e)?!(e.type===fn||e.type===re&&!df(e.children)):!0)?t:null}const oi=t=>t?xf(t)?Qr(t)||t.proxy:oi(t.parent):null,ms=nt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>oi(t.parent),$root:t=>oi(t.root),$emit:t=>t.emit,$options:t=>ea(t),$forceUpdate:t=>t.f||(t.f=()=>Gr(t.update)),$nextTick:t=>t.n||(t.n=eo.bind(t.proxy)),$watch:t=>Ag.bind(t)}),Sl=(t,e)=>t!==We&&!t.__isScriptSetup&&Se(t,e),Gg={get({_:t},e){const{ctx:n,setupState:o,data:s,props:r,accessCache:l,type:a,appContext:i}=t;let u;if(e[0]!=="$"){const v=l[e];if(v!==void 0)switch(v){case 1:return o[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(Sl(o,e))return l[e]=1,o[e];if(s!==We&&Se(s,e))return l[e]=2,s[e];if((u=t.propsOptions[0])&&Se(u,e))return l[e]=3,r[e];if(n!==We&&Se(n,e))return l[e]=4,n[e];si&&(l[e]=0)}}const c=ms[e];let f,h;if(c)return e==="$attrs"&&yt(t,"get",e),c(t);if((f=a.__cssModules)&&(f=f[e]))return f;if(n!==We&&Se(n,e))return l[e]=4,n[e];if(h=i.config.globalProperties,Se(h,e))return h[e]},set({_:t},e,n){const{data:o,setupState:s,ctx:r}=t;return Sl(s,e)?(s[e]=n,!0):o!==We&&Se(o,e)?(o[e]=n,!0):Se(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:o,appContext:s,propsOptions:r}},l){let a;return!!n[l]||t!==We&&Se(t,l)||Sl(e,l)||(a=r[0])&&Se(a,l)||Se(o,l)||Se(ms,l)||Se(s.config.globalProperties,l)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Se(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function nu(t){return ue(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let si=!0;function Xg(t){const e=ea(t),n=t.proxy,o=t.ctx;si=!1,e.beforeCreate&&ou(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:l,watch:a,provide:i,inject:u,created:c,beforeMount:f,mounted:h,beforeUpdate:v,updated:g,activated:b,deactivated:w,beforeDestroy:$,beforeUnmount:p,destroyed:m,unmounted:_,render:A,renderTracked:I,renderTriggered:E,errorCaptured:j,serverPrefetch:M,expose:H,inheritAttrs:te,components:q,directives:pe,filters:we}=e;if(u&&Yg(u,o,null),l)for(const O in l){const C=l[O];_e(C)&&(o[O]=C.bind(n))}if(s){const O=s.call(n,n);He(O)&&(t.data=Nn(O))}if(si=!0,r)for(const O in r){const C=r[O],x=_e(C)?C.bind(n,n):_e(C.get)?C.get.bind(n,n):zt,J=!_e(C)&&_e(C.set)?C.set.bind(n):zt,ve=S({get:x,set:J});Object.defineProperty(o,O,{enumerable:!0,configurable:!0,get:()=>ve.value,set:Ce=>ve.value=Ce})}if(a)for(const O in a)ff(a[O],o,n,O);if(i){const O=_e(i)?i.call(n):i;Reflect.ownKeys(O).forEach(C=>{em(C,O[C])})}c&&ou(c,t,"c");function F(O,C){ue(C)?C.forEach(x=>O(x.bind(n))):C&&O(C.bind(n))}if(F(Ng,f),F(mt,h),F(Fg,v),F(Qi,g),F(af,b),F(uf,w),F(Wg,j),F(Vg,I),F(Ug,E),F(Zi,p),F(Ut,_),F(Hg,M),ue(H))if(H.length){const O=t.exposed||(t.exposed={});H.forEach(C=>{Object.defineProperty(O,C,{get:()=>n[C],set:x=>n[C]=x})})}else t.exposed||(t.exposed={});A&&t.render===zt&&(t.render=A),te!=null&&(t.inheritAttrs=te),q&&(t.components=q),pe&&(t.directives=pe)}function Yg(t,e,n=zt){ue(t)&&(t=ri(t));for(const o in t){const s=t[o];let r;He(s)?"default"in s?r=bs(s.from||o,s.default,!0):r=bs(s.from||o):r=bs(s),be(r)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:l=>r.value=l}):e[o]=r}}function ou(t,e,n){Et(ue(t)?t.map(o=>o.bind(e.proxy)):t.bind(e.proxy),e,n)}function ff(t,e,n,o){const s=o.includes(".")?rf(n,o):()=>n[o];if(Je(t)){const r=e[t];_e(r)&&Xe(s,r)}else if(_e(t))Xe(s,t.bind(n));else if(He(t))if(ue(t))t.forEach(r=>ff(r,e,n,o));else{const r=_e(t.handler)?t.handler.bind(n):e[t.handler];_e(r)&&Xe(s,r,t)}}function ea(t){const e=t.type,{mixins:n,extends:o}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:l}}=t.appContext,a=r.get(e);let i;return a?i=a:!s.length&&!n&&!o?i=e:(i={},s.length&&s.forEach(u=>wr(i,u,l,!0)),wr(i,e,l)),He(e)&&r.set(e,i),i}function wr(t,e,n,o=!1){const{mixins:s,extends:r}=e;r&&wr(t,r,n,!0),s&&s.forEach(l=>wr(t,l,n,!0));for(const l in e)if(!(o&&l==="expose")){const a=qg[l]||n&&n[l];t[l]=a?a(t[l],e[l]):e[l]}return t}const qg={data:su,props:ru,emits:ru,methods:vs,computed:vs,beforeCreate:vt,created:vt,beforeMount:vt,mounted:vt,beforeUpdate:vt,updated:vt,beforeDestroy:vt,beforeUnmount:vt,destroyed:vt,unmounted:vt,activated:vt,deactivated:vt,errorCaptured:vt,serverPrefetch:vt,components:vs,directives:vs,watch:Jg,provide:su,inject:Kg};function su(t,e){return e?t?function(){return nt(_e(t)?t.call(this,this):t,_e(e)?e.call(this,this):e)}:e:t}function Kg(t,e){return vs(ri(t),ri(e))}function ri(t){if(ue(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function vt(t,e){return t?[...new Set([].concat(t,e))]:e}function vs(t,e){return t?nt(Object.create(null),t,e):e}function ru(t,e){return t?ue(t)&&ue(e)?[...new Set([...t,...e])]:nt(Object.create(null),nu(t),nu(e!=null?e:{})):e}function Jg(t,e){if(!t)return e;if(!e)return t;const n=nt(Object.create(null),t);for(const o in e)n[o]=vt(t[o],e[o]);return n}function pf(){return{app:null,config:{isNativeTag:Tv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Qg=0;function Zg(t,e){return function(o,s=null){_e(o)||(o=nt({},o)),s!=null&&!He(s)&&(s=null);const r=pf(),l=new WeakSet;let a=!1;const i=r.app={_uid:Qg++,_component:o,_props:s,_container:null,_context:r,_instance:null,version:Sm,get config(){return r.config},set config(u){},use(u,...c){return l.has(u)||(u&&_e(u.install)?(l.add(u),u.install(i,...c)):_e(u)&&(l.add(u),u(i,...c))),i},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),i},component(u,c){return c?(r.components[u]=c,i):r.components[u]},directive(u,c){return c?(r.directives[u]=c,i):r.directives[u]},mount(u,c,f){if(!a){const h=R(o,s);return h.appContext=r,c&&e?e(h,u):t(h,u,f),a=!0,i._container=u,u.__vue_app__=i,Qr(h.component)||h.component.proxy}},unmount(){a&&(t(null,i._container),delete i._container.__vue_app__)},provide(u,c){return r.provides[u]=c,i},runWithContext(u){Pr=i;try{return u()}finally{Pr=null}}};return i}}let Pr=null;function em(t,e){if(it){let n=it.provides;const o=it.parent&&it.parent.provides;o===n&&(n=it.provides=Object.create(o)),n[t]=e}}function bs(t,e,n=!1){const o=it||pt;if(o||Pr){const s=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:Pr._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&_e(e)?e.call(o&&o.proxy):e}}function tm(t,e,n,o=!1){const s={},r={};gr(r,Jr,1),t.propsDefaults=Object.create(null),hf(t,e,s,r);for(const l in t.propsOptions[0])l in s||(s[l]=void 0);n?t.props=o?s:vg(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function nm(t,e,n,o){const{props:s,attrs:r,vnode:{patchFlag:l}}=t,a=Ae(s),[i]=t.propsOptions;let u=!1;if((o||l>0)&&!(l&16)){if(l&8){const c=t.vnode.dynamicProps;for(let f=0;f<c.length;f++){let h=c[f];if(Xr(t.emitsOptions,h))continue;const v=e[h];if(i)if(Se(r,h))v!==r[h]&&(r[h]=v,u=!0);else{const g=jo(h);s[g]=li(i,a,g,v,t,!1)}else v!==r[h]&&(r[h]=v,u=!0)}}}else{hf(t,e,s,r)&&(u=!0);let c;for(const f in a)(!e||!Se(e,f)&&((c=io(f))===f||!Se(e,c)))&&(i?n&&(n[f]!==void 0||n[c]!==void 0)&&(s[f]=li(i,a,f,void 0,t,!0)):delete s[f]);if(r!==a)for(const f in r)(!e||!Se(e,f)&&!0)&&(delete r[f],u=!0)}u&&cn(t,"set","$attrs")}function hf(t,e,n,o){const[s,r]=t.propsOptions;let l=!1,a;if(e)for(let i in e){if(ur(i))continue;const u=e[i];let c;s&&Se(s,c=jo(i))?!r||!r.includes(c)?n[c]=u:(a||(a={}))[c]=u:Xr(t.emitsOptions,i)||(!(i in o)||u!==o[i])&&(o[i]=u,l=!0)}if(r){const i=Ae(n),u=a||We;for(let c=0;c<r.length;c++){const f=r[c];n[f]=li(s,i,f,u[f],t,!Se(u,f))}}return l}function li(t,e,n,o,s,r){const l=t[n];if(l!=null){const a=Se(l,"default");if(a&&o===void 0){const i=l.default;if(l.type!==Function&&!l.skipFactory&&_e(i)){const{propsDefaults:u}=s;n in u?o=u[n]:(Ao(s),o=u[n]=i.call(null,e),to())}else o=i}l[0]&&(r&&!a?o=!1:l[1]&&(o===""||o===io(n))&&(o=!0))}return o}function vf(t,e,n=!1){const o=e.propsCache,s=o.get(t);if(s)return s;const r=t.props,l={},a=[];let i=!1;if(!_e(t)){const c=f=>{i=!0;const[h,v]=vf(f,e,!0);nt(l,h),v&&a.push(...v)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!r&&!i)return He(t)&&o.set(t,Po),Po;if(ue(r))for(let c=0;c<r.length;c++){const f=jo(r[c]);lu(f)&&(l[f]=We)}else if(r)for(const c in r){const f=jo(c);if(lu(f)){const h=r[c],v=l[f]=ue(h)||_e(h)?{type:h}:nt({},h);if(v){const g=uu(Boolean,v.type),b=uu(String,v.type);v[0]=g>-1,v[1]=b<0||g<b,(g>-1||Se(v,"default"))&&a.push(f)}}}const u=[l,a];return He(t)&&o.set(t,u),u}function lu(t){return t[0]!=="$"}function iu(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function au(t,e){return iu(t)===iu(e)}function uu(t,e){return ue(e)?e.findIndex(n=>au(n,t)):_e(e)&&au(e,t)?0:-1}const gf=t=>t[0]==="_"||t==="$stable",ta=t=>ue(t)?t.map(Qt):[Qt(t)],om=(t,e,n)=>{if(e._n)return e;const o=Y((...s)=>ta(e(...s)),n);return o._c=!1,o},mf=(t,e,n)=>{const o=t._ctx;for(const s in t){if(gf(s))continue;const r=t[s];if(_e(r))e[s]=om(s,r,o);else if(r!=null){const l=ta(r);e[s]=()=>l}}},bf=(t,e)=>{const n=ta(e);t.slots.default=()=>n},sm=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Ae(e),gr(e,"_",n)):mf(e,t.slots={})}else t.slots={},e&&bf(t,e);gr(t.slots,Jr,1)},rm=(t,e,n)=>{const{vnode:o,slots:s}=t;let r=!0,l=We;if(o.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:(nt(s,e),!n&&a===1&&delete s._):(r=!e.$stable,mf(e,s)),l=e}else e&&(bf(t,e),l={default:1});if(r)for(const a in s)!gf(a)&&l[a]==null&&delete s[a]};function ii(t,e,n,o,s=!1){if(ue(t)){t.forEach((h,v)=>ii(h,e&&(ue(e)?e[v]:e),n,o,s));return}if($o(o)&&!s)return;const r=o.shapeFlag&4?Qr(o.component)||o.component.proxy:o.el,l=s?null:r,{i:a,r:i}=t,u=e&&e.r,c=a.refs===We?a.refs={}:a.refs,f=a.setupState;if(u!=null&&u!==i&&(Je(u)?(c[u]=null,Se(f,u)&&(f[u]=null)):be(u)&&(u.value=null)),_e(i))Rn(i,a,12,[l,c]);else{const h=Je(i),v=be(i);if(h||v){const g=()=>{if(t.f){const b=h?Se(f,i)?f[i]:c[i]:i.value;s?ue(b)&&Hi(b,r):ue(b)?b.includes(r)||b.push(r):h?(c[i]=[r],Se(f,i)&&(f[i]=c[i])):(i.value=[r],t.k&&(c[t.k]=i.value))}else h?(c[i]=l,Se(f,i)&&(f[i]=l)):v&&(i.value=l,t.k&&(c[t.k]=l))};l?(g.id=-1,ut(g,n)):g()}}}const ut=Tg;function lm(t){return im(t)}function im(t,e){const n=Kl();n.__VUE__=!0;const{insert:o,remove:s,patchProp:r,createElement:l,createText:a,createComment:i,setText:u,setElementText:c,parentNode:f,nextSibling:h,setScopeId:v=zt,insertStaticContent:g}=t,b=(y,P,T,D=null,N=null,G=null,ee=!1,X=null,Z=!!P.dynamicChildren)=>{if(y===P)return;y&&!qn(y,P)&&(D=xe(y),Ce(y,N,G,!0),y=null),P.patchFlag===-2&&(Z=!1,P.dynamicChildren=null);const{type:U,ref:de,shapeFlag:se}=P;switch(U){case Kr:w(y,P,T,D);break;case fn:$(y,P,T,D);break;case cr:y==null&&p(P,T,D,ee);break;case re:q(y,P,T,D,N,G,ee,X,Z);break;default:se&1?A(y,P,T,D,N,G,ee,X,Z):se&6?pe(y,P,T,D,N,G,ee,X,Z):(se&64||se&128)&&U.process(y,P,T,D,N,G,ee,X,Z,z)}de!=null&&N&&ii(de,y&&y.ref,G,P||y,!P)},w=(y,P,T,D)=>{if(y==null)o(P.el=a(P.children),T,D);else{const N=P.el=y.el;P.children!==y.children&&u(N,P.children)}},$=(y,P,T,D)=>{y==null?o(P.el=i(P.children||""),T,D):P.el=y.el},p=(y,P,T,D)=>{[y.el,y.anchor]=g(y.children,P,T,D,y.el,y.anchor)},m=({el:y,anchor:P},T,D)=>{let N;for(;y&&y!==P;)N=h(y),o(y,T,D),y=N;o(P,T,D)},_=({el:y,anchor:P})=>{let T;for(;y&&y!==P;)T=h(y),s(y),y=T;s(P)},A=(y,P,T,D,N,G,ee,X,Z)=>{ee=ee||P.type==="svg",y==null?I(P,T,D,N,G,ee,X,Z):M(y,P,N,G,ee,X,Z)},I=(y,P,T,D,N,G,ee,X)=>{let Z,U;const{type:de,props:se,shapeFlag:fe,transition:ye,dirs:ke}=y;if(Z=y.el=l(y.type,G,se&&se.is,se),fe&8?c(Z,y.children):fe&16&&j(y.children,Z,null,D,N,G&&de!=="foreignObject",ee,X),ke&&Vn(y,null,D,"created"),E(Z,y,y.scopeId,ee,D),se){for(const Ne in se)Ne!=="value"&&!ur(Ne)&&r(Z,Ne,null,se[Ne],G,y.children,D,N,me);"value"in se&&r(Z,"value",null,se.value),(U=se.onVnodeBeforeMount)&&jt(U,D,y)}ke&&Vn(y,null,D,"beforeMount");const Ue=am(N,ye);Ue&&ye.beforeEnter(Z),o(Z,P,T),((U=se&&se.onVnodeMounted)||Ue||ke)&&ut(()=>{U&&jt(U,D,y),Ue&&ye.enter(Z),ke&&Vn(y,null,D,"mounted")},N)},E=(y,P,T,D,N)=>{if(T&&v(y,T),D)for(let G=0;G<D.length;G++)v(y,D[G]);if(N){let G=N.subTree;if(P===G){const ee=N.vnode;E(y,ee,ee.scopeId,ee.slotScopeIds,N.parent)}}},j=(y,P,T,D,N,G,ee,X,Z=0)=>{for(let U=Z;U<y.length;U++){const de=y[U]=X?On(y[U]):Qt(y[U]);b(null,de,P,T,D,N,G,ee,X)}},M=(y,P,T,D,N,G,ee)=>{const X=P.el=y.el;let{patchFlag:Z,dynamicChildren:U,dirs:de}=P;Z|=y.patchFlag&16;const se=y.props||We,fe=P.props||We;let ye;T&&Wn(T,!1),(ye=fe.onVnodeBeforeUpdate)&&jt(ye,T,P,y),de&&Vn(P,y,T,"beforeUpdate"),T&&Wn(T,!0);const ke=N&&P.type!=="foreignObject";if(U?H(y.dynamicChildren,U,X,T,D,ke,G):ee||C(y,P,X,null,T,D,ke,G,!1),Z>0){if(Z&16)te(X,P,se,fe,T,D,N);else if(Z&2&&se.class!==fe.class&&r(X,"class",null,fe.class,N),Z&4&&r(X,"style",se.style,fe.style,N),Z&8){const Ue=P.dynamicProps;for(let Ne=0;Ne<Ue.length;Ne++){const et=Ue[Ne],Lt=se[et],co=fe[et];(co!==Lt||et==="value")&&r(X,et,Lt,co,N,y.children,T,D,me)}}Z&1&&y.children!==P.children&&c(X,P.children)}else!ee&&U==null&&te(X,P,se,fe,T,D,N);((ye=fe.onVnodeUpdated)||de)&&ut(()=>{ye&&jt(ye,T,P,y),de&&Vn(P,y,T,"updated")},D)},H=(y,P,T,D,N,G,ee)=>{for(let X=0;X<P.length;X++){const Z=y[X],U=P[X],de=Z.el&&(Z.type===re||!qn(Z,U)||Z.shapeFlag&70)?f(Z.el):T;b(Z,U,de,null,D,N,G,ee,!0)}},te=(y,P,T,D,N,G,ee)=>{if(T!==D){if(T!==We)for(const X in T)!ur(X)&&!(X in D)&&r(y,X,T[X],null,ee,P.children,N,G,me);for(const X in D){if(ur(X))continue;const Z=D[X],U=T[X];Z!==U&&X!=="value"&&r(y,X,U,Z,ee,P.children,N,G,me)}"value"in D&&r(y,"value",T.value,D.value)}},q=(y,P,T,D,N,G,ee,X,Z)=>{const U=P.el=y?y.el:a(""),de=P.anchor=y?y.anchor:a("");let{patchFlag:se,dynamicChildren:fe,slotScopeIds:ye}=P;ye&&(X=X?X.concat(ye):ye),y==null?(o(U,T,D),o(de,T,D),j(P.children,T,de,N,G,ee,X,Z)):se>0&&se&64&&fe&&y.dynamicChildren?(H(y.dynamicChildren,fe,T,N,G,ee,X),(P.key!=null||N&&P===N.subTree)&&na(y,P,!0)):C(y,P,T,de,N,G,ee,X,Z)},pe=(y,P,T,D,N,G,ee,X,Z)=>{P.slotScopeIds=X,y==null?P.shapeFlag&512?N.ctx.activate(P,T,D,ee,Z):we(P,T,D,N,G,ee,Z):je(y,P,Z)},we=(y,P,T,D,N,G,ee)=>{const X=y.component=_m(y,D,N);if(Ji(y)&&(X.ctx.renderer=z),wm(X),X.asyncDep){if(N&&N.registerDep(X,F),!y.el){const Z=X.subTree=R(fn);$(null,Z,P,T)}return}F(X,y,P,T,N,G,ee)},je=(y,P,T)=>{const D=P.component=y.component;if(Ig(y,P,T))if(D.asyncDep&&!D.asyncResolved){O(D,P,T);return}else D.next=P,Cg(D.update),D.update();else P.el=y.el,D.vnode=P},F=(y,P,T,D,N,G,ee)=>{const X=()=>{if(y.isMounted){let{next:de,bu:se,u:fe,parent:ye,vnode:ke}=y,Ue=de,Ne;Wn(y,!1),de?(de.el=ke.el,O(y,de,ee)):de=ke,se&&xo(se),(Ne=de.props&&de.props.onVnodeBeforeUpdate)&&jt(Ne,ye,de,ke),Wn(y,!0);const et=xl(y),Lt=y.subTree;y.subTree=et,b(Lt,et,f(Lt.el),xe(Lt),y,N,G),de.el=et.el,Ue===null&&jg(y,et.el),fe&&ut(fe,N),(Ne=de.props&&de.props.onVnodeUpdated)&&ut(()=>jt(Ne,ye,de,ke),N)}else{let de;const{el:se,props:fe}=P,{bm:ye,m:ke,parent:Ue}=y,Ne=$o(P);if(Wn(y,!1),ye&&xo(ye),!Ne&&(de=fe&&fe.onVnodeBeforeMount)&&jt(de,Ue,P),Wn(y,!0),se&&ge){const et=()=>{y.subTree=xl(y),ge(se,y.subTree,y,N,null)};Ne?P.type.__asyncLoader().then(()=>!y.isUnmounted&&et()):et()}else{const et=y.subTree=xl(y);b(null,et,T,D,y,N,G),P.el=et.el}if(ke&&ut(ke,N),!Ne&&(de=fe&&fe.onVnodeMounted)){const et=P;ut(()=>jt(de,Ue,et),N)}(P.shapeFlag&256||Ue&&$o(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&y.a&&ut(y.a,N),y.isMounted=!0,P=T=D=null}},Z=y.effect=new zi(X,()=>Gr(U),y.scope),U=y.update=()=>Z.run();U.id=y.uid,Wn(y,!0),U()},O=(y,P,T)=>{P.component=y;const D=y.vnode.props;y.vnode=P,y.next=null,nm(y,P.props,D,T),rm(y,P.children,T),Yo(),Za(),qo()},C=(y,P,T,D,N,G,ee,X,Z=!1)=>{const U=y&&y.children,de=y?y.shapeFlag:0,se=P.children,{patchFlag:fe,shapeFlag:ye}=P;if(fe>0){if(fe&128){J(U,se,T,D,N,G,ee,X,Z);return}else if(fe&256){x(U,se,T,D,N,G,ee,X,Z);return}}ye&8?(de&16&&me(U,N,G),se!==U&&c(T,se)):de&16?ye&16?J(U,se,T,D,N,G,ee,X,Z):me(U,N,G,!0):(de&8&&c(T,""),ye&16&&j(se,T,D,N,G,ee,X,Z))},x=(y,P,T,D,N,G,ee,X,Z)=>{y=y||Po,P=P||Po;const U=y.length,de=P.length,se=Math.min(U,de);let fe;for(fe=0;fe<se;fe++){const ye=P[fe]=Z?On(P[fe]):Qt(P[fe]);b(y[fe],ye,T,null,N,G,ee,X,Z)}U>de?me(y,N,G,!0,!1,se):j(P,T,D,N,G,ee,X,Z,se)},J=(y,P,T,D,N,G,ee,X,Z)=>{let U=0;const de=P.length;let se=y.length-1,fe=de-1;for(;U<=se&&U<=fe;){const ye=y[U],ke=P[U]=Z?On(P[U]):Qt(P[U]);if(qn(ye,ke))b(ye,ke,T,null,N,G,ee,X,Z);else break;U++}for(;U<=se&&U<=fe;){const ye=y[se],ke=P[fe]=Z?On(P[fe]):Qt(P[fe]);if(qn(ye,ke))b(ye,ke,T,null,N,G,ee,X,Z);else break;se--,fe--}if(U>se){if(U<=fe){const ye=fe+1,ke=ye<de?P[ye].el:D;for(;U<=fe;)b(null,P[U]=Z?On(P[U]):Qt(P[U]),T,ke,N,G,ee,X,Z),U++}}else if(U>fe)for(;U<=se;)Ce(y[U],N,G,!0),U++;else{const ye=U,ke=U,Ue=new Map;for(U=ke;U<=fe;U++){const Ct=P[U]=Z?On(P[U]):Qt(P[U]);Ct.key!=null&&Ue.set(Ct.key,U)}let Ne,et=0;const Lt=fe-ke+1;let co=!1,Fa=0;const ss=new Array(Lt);for(U=0;U<Lt;U++)ss[U]=0;for(U=ye;U<=se;U++){const Ct=y[U];if(et>=Lt){Ce(Ct,N,G,!0);continue}let Yt;if(Ct.key!=null)Yt=Ue.get(Ct.key);else for(Ne=ke;Ne<=fe;Ne++)if(ss[Ne-ke]===0&&qn(Ct,P[Ne])){Yt=Ne;break}Yt===void 0?Ce(Ct,N,G,!0):(ss[Yt-ke]=U+1,Yt>=Fa?Fa=Yt:co=!0,b(Ct,P[Yt],T,null,N,G,ee,X,Z),et++)}const Ha=co?um(ss):Po;for(Ne=Ha.length-1,U=Lt-1;U>=0;U--){const Ct=ke+U,Yt=P[Ct],Ua=Ct+1<de?P[Ct+1].el:D;ss[U]===0?b(null,Yt,T,Ua,N,G,ee,X,Z):co&&(Ne<0||U!==Ha[Ne]?ve(Yt,T,Ua,2):Ne--)}}},ve=(y,P,T,D,N=null)=>{const{el:G,type:ee,transition:X,children:Z,shapeFlag:U}=y;if(U&6){ve(y.component.subTree,P,T,D);return}if(U&128){y.suspense.move(P,T,D);return}if(U&64){ee.move(y,P,T,z);return}if(ee===re){o(G,P,T);for(let se=0;se<Z.length;se++)ve(Z[se],P,T,D);o(y.anchor,P,T);return}if(ee===cr){m(y,P,T);return}if(D!==2&&U&1&&X)if(D===0)X.beforeEnter(G),o(G,P,T),ut(()=>X.enter(G),N);else{const{leave:se,delayLeave:fe,afterLeave:ye}=X,ke=()=>o(G,P,T),Ue=()=>{se(G,()=>{ke(),ye&&ye()})};fe?fe(G,ke,Ue):Ue()}else o(G,P,T)},Ce=(y,P,T,D=!1,N=!1)=>{const{type:G,props:ee,ref:X,children:Z,dynamicChildren:U,shapeFlag:de,patchFlag:se,dirs:fe}=y;if(X!=null&&ii(X,null,T,y,!0),de&256){P.ctx.deactivate(y);return}const ye=de&1&&fe,ke=!$o(y);let Ue;if(ke&&(Ue=ee&&ee.onVnodeBeforeUnmount)&&jt(Ue,P,y),de&6)Q(y.component,T,D);else{if(de&128){y.suspense.unmount(T,D);return}ye&&Vn(y,null,P,"beforeUnmount"),de&64?y.type.remove(y,P,T,N,z,D):U&&(G!==re||se>0&&se&64)?me(U,P,T,!1,!0):(G===re&&se&384||!N&&de&16)&&me(Z,P,T),D&&Me(y)}(ke&&(Ue=ee&&ee.onVnodeUnmounted)||ye)&&ut(()=>{Ue&&jt(Ue,P,y),ye&&Vn(y,null,P,"unmounted")},T)},Me=y=>{const{type:P,el:T,anchor:D,transition:N}=y;if(P===re){at(T,D);return}if(P===cr){_(y);return}const G=()=>{s(T),N&&!N.persisted&&N.afterLeave&&N.afterLeave()};if(y.shapeFlag&1&&N&&!N.persisted){const{leave:ee,delayLeave:X}=N,Z=()=>ee(T,G);X?X(y.el,G,Z):Z()}else G()},at=(y,P)=>{let T;for(;y!==P;)T=h(y),s(y),y=T;s(P)},Q=(y,P,T)=>{const{bum:D,scope:N,update:G,subTree:ee,um:X}=y;D&&xo(D),N.stop(),G&&(G.active=!1,Ce(ee,y,P,T)),X&&ut(X,P),ut(()=>{y.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},me=(y,P,T,D=!1,N=!1,G=0)=>{for(let ee=G;ee<y.length;ee++)Ce(y[ee],P,T,D,N)},xe=y=>y.shapeFlag&6?xe(y.component.subTree):y.shapeFlag&128?y.suspense.next():h(y.anchor||y.el),W=(y,P,T)=>{y==null?P._vnode&&Ce(P._vnode,null,null,!0):b(P._vnode||null,y,P,null,null,null,T),Za(),ef(),P._vnode=y},z={p:b,um:Ce,m:ve,r:Me,mt:we,mc:j,pc:C,pbc:H,n:xe,o:t};let oe,ge;return e&&([oe,ge]=e(z)),{render:W,hydrate:oe,createApp:Zg(W,oe)}}function Wn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function am(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function na(t,e,n=!1){const o=t.children,s=e.children;if(ue(o)&&ue(s))for(let r=0;r<o.length;r++){const l=o[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=On(s[r]),a.el=l.el),n||na(l,a)),a.type===Kr&&(a.el=l.el)}}function um(t){const e=t.slice(),n=[0];let o,s,r,l,a;const i=t.length;for(o=0;o<i;o++){const u=t[o];if(u!==0){if(s=n[n.length-1],t[s]<u){e[o]=s,n.push(o);continue}for(r=0,l=n.length-1;r<l;)a=r+l>>1,t[n[a]]<u?r=a+1:l=a;u<t[n[r]]&&(r>0&&(e[o]=n[r-1]),n[r]=o)}}for(r=n.length,l=n[r-1];r-- >0;)n[r]=l,l=e[l];return n}const cm=t=>t.__isTeleport,ys=t=>t&&(t.disabled||t.disabled===""),cu=t=>typeof SVGElement!="undefined"&&t instanceof SVGElement,ai=(t,e)=>{const n=t&&t.to;return Je(n)?e?e(n):null:n},dm={__isTeleport:!0,process(t,e,n,o,s,r,l,a,i,u){const{mc:c,pc:f,pbc:h,o:{insert:v,querySelector:g,createText:b,createComment:w}}=u,$=ys(e.props);let{shapeFlag:p,children:m,dynamicChildren:_}=e;if(t==null){const A=e.el=b(""),I=e.anchor=b("");v(A,n,o),v(I,n,o);const E=e.target=ai(e.props,g),j=e.targetAnchor=b("");E&&(v(j,E),l=l||cu(E));const M=(H,te)=>{p&16&&c(m,H,te,s,r,l,a,i)};$?M(n,I):E&&M(E,j)}else{e.el=t.el;const A=e.anchor=t.anchor,I=e.target=t.target,E=e.targetAnchor=t.targetAnchor,j=ys(t.props),M=j?n:I,H=j?A:E;if(l=l||cu(I),_?(h(t.dynamicChildren,_,M,s,r,l,a),na(t,e,!0)):i||f(t,e,M,H,s,r,l,a,!1),$)j?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Ks(e,n,A,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const te=e.target=ai(e.props,g);te&&Ks(e,te,null,u,0)}else j&&Ks(e,I,E,u,1)}_f(e)},remove(t,e,n,o,{um:s,o:{remove:r}},l){const{shapeFlag:a,children:i,anchor:u,targetAnchor:c,target:f,props:h}=t;if(f&&r(c),l&&r(u),a&16){const v=l||!ys(h);for(let g=0;g<i.length;g++){const b=i[g];s(b,e,n,v,!!b.dynamicChildren)}}},move:Ks,hydrate:fm};function Ks(t,e,n,{o:{insert:o},m:s},r=2){r===0&&o(t.targetAnchor,e,n);const{el:l,anchor:a,shapeFlag:i,children:u,props:c}=t,f=r===2;if(f&&o(l,e,n),(!f||ys(c))&&i&16)for(let h=0;h<u.length;h++)s(u[h],e,n,2);f&&o(a,e,n)}function fm(t,e,n,o,s,r,{o:{nextSibling:l,parentNode:a,querySelector:i}},u){const c=e.target=ai(e.props,i);if(c){const f=c._lpa||c.firstChild;if(e.shapeFlag&16)if(ys(e.props))e.anchor=u(l(t),e,a(t),n,o,s,r),e.targetAnchor=f;else{e.anchor=l(t);let h=f;for(;h;)if(h=l(h),h&&h.nodeType===8&&h.data==="teleport anchor"){e.targetAnchor=h,c._lpa=e.targetAnchor&&l(e.targetAnchor);break}u(f,e,c,n,o,s,r)}_f(e)}return e.anchor&&l(e.anchor)}const yf=dm;function _f(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n&&n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const re=Symbol.for("v-fgt"),Kr=Symbol.for("v-txt"),fn=Symbol.for("v-cmt"),cr=Symbol.for("v-stc"),_s=[];let Vt=null;function k(t=!1){_s.push(Vt=t?null:[])}function pm(){_s.pop(),Vt=_s[_s.length-1]||null}let Ss=1;function du(t){Ss+=t}function wf(t){return t.dynamicChildren=Ss>0?Vt||Po:null,pm(),Ss>0&&Vt&&Vt.push(t),t}function B(t,e,n,o,s,r){return wf(d(t,e,n,o,s,r,!0))}function ae(t,e,n,o,s){return wf(R(t,e,n,o,s,!0))}function Is(t){return t?t.__v_isVNode===!0:!1}function qn(t,e){return t.type===e.type&&t.key===e.key}const Jr="__vInternal",Pf=({key:t})=>t!=null?t:null,dr=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Je(t)||be(t)||_e(t)?{i:pt,r:t,k:e,f:!!n}:t:null);function d(t,e=null,n=null,o=0,s=null,r=t===re?0:1,l=!1,a=!1){const i={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Pf(e),ref:e&&dr(e),scopeId:Yr,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:pt};return a?(oa(i,n),r&128&&t.normalize(i)):n&&(i.shapeFlag|=Je(n)?8:16),Ss>0&&!l&&Vt&&(i.patchFlag>0||r&6)&&i.patchFlag!==32&&Vt.push(i),i}const R=hm;function hm(t,e=null,n=null,o=0,s=null,r=!1){if((!t||t===zg)&&(t=fn),Is(t)){const a=Fn(t,e,!0);return n&&oa(a,n),Ss>0&&!r&&Vt&&(a.shapeFlag&6?Vt[Vt.indexOf(t)]=a:Vt.push(a)),a.patchFlag|=-2,a}if(km(t)&&(t=t.__vccOpts),e){e=vm(e);let{class:a,style:i}=e;a&&!Je(a)&&(e.class=Le(a)),He(i)&&(Xd(i)&&!ue(i)&&(i=nt({},i)),e.style=Ke(i))}const l=Je(t)?1:of(t)?128:cm(t)?64:He(t)?4:_e(t)?2:0;return d(t,e,n,o,s,l,r,!0)}function vm(t){return t?Xd(t)||Jr in t?nt({},t):t:null}function Fn(t,e,n=!1){const{props:o,ref:s,patchFlag:r,children:l}=t,a=e?mm(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Pf(a),ref:e&&e.ref?n&&s?ue(s)?s.concat(dr(e)):[s,dr(e)]:dr(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==re?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Fn(t.ssContent),ssFallback:t.ssFallback&&Fn(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function V(t=" ",e=0){return R(Kr,null,t,e)}function gm(t,e){const n=R(cr,null,t);return n.staticCount=e,n}function ce(t="",e=!1){return e?(k(),ae(fn,null,t)):R(fn,null,t)}function Qt(t){return t==null||typeof t=="boolean"?R(fn):ue(t)?R(re,null,t.slice()):typeof t=="object"?On(t):R(Kr,null,String(t))}function On(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Fn(t)}function oa(t,e){let n=0;const{shapeFlag:o}=t;if(e==null)e=null;else if(ue(e))n=16;else if(typeof e=="object")if(o&65){const s=e.default;s&&(s._c&&(s._d=!1),oa(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Jr in e)?e._ctx=pt:s===3&&pt&&(pt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else _e(e)?(e={default:e,_ctx:pt},n=32):(e=String(e),o&64?(n=16,e=[V(e)]):n=8);t.children=e,t.shapeFlag|=n}function mm(...t){const e={};for(let n=0;n<t.length;n++){const o=t[n];for(const s in o)if(s==="class")e.class!==o.class&&(e.class=Le([e.class,o.class]));else if(s==="style")e.style=Ke([e.style,o.style]);else if(Vr(s)){const r=e[s],l=o[s];l&&r!==l&&!(ue(r)&&r.includes(l))&&(e[s]=r?[].concat(r,l):l)}else s!==""&&(e[s]=o[s])}return e}function jt(t,e,n,o=null){Et(t,e,7,[n,o])}const bm=pf();let ym=0;function _m(t,e,n){const o=t.type,s=(e?e.appContext:t.appContext)||bm,r={uid:ym++,vnode:t,type:o,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Bd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:vf(o,s),emitsOptions:nf(o,s),emit:null,emitted:null,propsDefaults:We,inheritAttrs:o.inheritAttrs,ctx:We,data:We,props:We,attrs:We,slots:We,refs:We,setupState:We,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Og.bind(null,r),t.ce&&t.ce(r),r}let it=null;const Cf=()=>it||pt;let sa,po,fu="__VUE_INSTANCE_SETTERS__";(po=Kl()[fu])||(po=Kl()[fu]=[]),po.push(t=>it=t),sa=t=>{po.length>1?po.forEach(e=>e(t)):po[0](t)};const Ao=t=>{sa(t),t.scope.on()},to=()=>{it&&it.scope.off(),sa(null)};function xf(t){return t.vnode.shapeFlag&4}let Eo=!1;function wm(t,e=!1){Eo=e;const{props:n,children:o}=t.vnode,s=xf(t);tm(t,n,s,e),sm(t,o);const r=s?Pm(t,e):void 0;return Eo=!1,r}function Pm(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Yd(new Proxy(t.ctx,Gg));const{setup:o}=n;if(o){const s=t.setupContext=o.length>1?xm(t):null;Ao(t),Yo();const r=Rn(o,t,0,[t.props,s]);if(qo(),to(),Id(r)){if(r.then(to,to),e)return r.then(l=>{pu(t,l,e)}).catch(l=>{Bs(l,t,0)});t.asyncDep=r}else pu(t,r,e)}else kf(t,e)}function pu(t,e,n){_e(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:He(e)&&(t.setupState=Jd(e)),kf(t,n)}let hu;function kf(t,e,n){const o=t.type;if(!t.render){if(!e&&hu&&!o.render){const s=o.template||ea(t).template;if(s){const{isCustomElement:r,compilerOptions:l}=t.appContext.config,{delimiters:a,compilerOptions:i}=o,u=nt(nt({isCustomElement:r,delimiters:a},l),i);o.render=hu(s,u)}}t.render=o.render||zt}{Ao(t),Yo();try{Xg(t)}finally{qo(),to()}}}function Cm(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return yt(t,"get","$attrs"),e[n]}}))}function xm(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return Cm(t)},slots:t.slots,emit:t.emit,expose:e}}function Qr(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Jd(Yd(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in ms)return ms[n](t)},has(e,n){return n in e||n in ms}}))}function vu(t,e=!0){return _e(t)?t.displayName||t.name:t.name||e&&t.__name}function km(t){return _e(t)&&"__vccOpts"in t}const S=(t,e)=>_g(t,e,Eo);function gu(t,e,n){const o=arguments.length;return o===2?He(e)&&!ue(e)?Is(e)?R(t,null,[e]):R(t,e):R(t,null,e):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&Is(n)&&(n=[n]),R(t,e,n))}const Om=Symbol.for("v-scx"),$m=()=>bs(Om),Sm="3.3.7",Im="http://www.w3.org/2000/svg",Kn=typeof document!="undefined"?document:null,mu=Kn&&Kn.createElement("template"),jm={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,o)=>{const s=e?Kn.createElementNS(Im,t):Kn.createElement(t,n?{is:n}:void 0);return t==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:t=>Kn.createTextNode(t),createComment:t=>Kn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Kn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,o,s,r){const l=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{mu.innerHTML=o?`<svg>${t}</svg>`:t;const a=mu.content;if(o){const i=a.firstChild;for(;i.firstChild;)a.appendChild(i.firstChild);a.removeChild(i)}e.insertBefore(a,n)}return[l?l.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},mn="transition",rs="animation",Ro=Symbol("_vtc"),Of={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Tm=nt({},Rg,Of),zn=(t,e=[])=>{ue(t)?t.forEach(n=>n(...e)):t&&t(...e)},bu=t=>t?ue(t)?t.some(e=>e.length>1):t.length>1:!1;function Am(t){const e={};for(const q in t)q in Of||(e[q]=t[q]);if(t.css===!1)return e;const{name:n="v",type:o,duration:s,enterFromClass:r=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:i=r,appearActiveClass:u=l,appearToClass:c=a,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:h=`${n}-leave-active`,leaveToClass:v=`${n}-leave-to`}=t,g=Em(s),b=g&&g[0],w=g&&g[1],{onBeforeEnter:$,onEnter:p,onEnterCancelled:m,onLeave:_,onLeaveCancelled:A,onBeforeAppear:I=$,onAppear:E=p,onAppearCancelled:j=m}=e,M=(q,pe,we)=>{kn(q,pe?c:a),kn(q,pe?u:l),we&&we()},H=(q,pe)=>{q._isLeaving=!1,kn(q,f),kn(q,v),kn(q,h),pe&&pe()},te=q=>(pe,we)=>{const je=q?E:p,F=()=>M(pe,q,we);zn(je,[pe,F]),yu(()=>{kn(pe,q?i:r),rn(pe,q?c:a),bu(je)||_u(pe,o,b,F)})};return nt(e,{onBeforeEnter(q){zn($,[q]),rn(q,r),rn(q,l)},onBeforeAppear(q){zn(I,[q]),rn(q,i),rn(q,u)},onEnter:te(!1),onAppear:te(!0),onLeave(q,pe){q._isLeaving=!0;const we=()=>H(q,pe);rn(q,f),Sf(),rn(q,h),yu(()=>{!q._isLeaving||(kn(q,f),rn(q,v),bu(_)||_u(q,o,w,we))}),zn(_,[q,we])},onEnterCancelled(q){M(q,!1),zn(m,[q])},onAppearCancelled(q){M(q,!0),zn(j,[q])},onLeaveCancelled(q){H(q),zn(A,[q])}})}function Em(t){if(t==null)return null;if(He(t))return[Il(t.enter),Il(t.leave)];{const e=Il(t);return[e,e]}}function Il(t){return Lv(t)}function rn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Ro]||(t[Ro]=new Set)).add(e)}function kn(t,e){e.split(/\s+/).forEach(o=>o&&t.classList.remove(o));const n=t[Ro];n&&(n.delete(e),n.size||(t[Ro]=void 0))}function yu(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Rm=0;function _u(t,e,n,o){const s=t._endId=++Rm,r=()=>{s===t._endId&&o()};if(n)return setTimeout(r,n);const{type:l,timeout:a,propCount:i}=$f(t,e);if(!l)return o();const u=l+"end";let c=0;const f=()=>{t.removeEventListener(u,h),r()},h=v=>{v.target===t&&++c>=i&&f()};setTimeout(()=>{c<i&&f()},a+1),t.addEventListener(u,h)}function $f(t,e){const n=window.getComputedStyle(t),o=g=>(n[g]||"").split(", "),s=o(`${mn}Delay`),r=o(`${mn}Duration`),l=wu(s,r),a=o(`${rs}Delay`),i=o(`${rs}Duration`),u=wu(a,i);let c=null,f=0,h=0;e===mn?l>0&&(c=mn,f=l,h=r.length):e===rs?u>0&&(c=rs,f=u,h=i.length):(f=Math.max(l,u),c=f>0?l>u?mn:rs:null,h=c?c===mn?r.length:i.length:0);const v=c===mn&&/\b(transform|all)(,|$)/.test(o(`${mn}Property`).toString());return{type:c,timeout:f,propCount:h,hasTransform:v}}function wu(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,o)=>Pu(n)+Pu(t[o])))}function Pu(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Sf(){return document.body.offsetHeight}function Bm(t,e,n){const o=t[Ro];o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Mm=Symbol("_vod");function Dm(t,e,n){const o=t.style,s=Je(n);if(n&&!s){if(e&&!Je(e))for(const r in e)n[r]==null&&ui(o,r,"");for(const r in n)ui(o,r,n[r])}else{const r=o.display;s?e!==n&&(o.cssText=n):e&&t.removeAttribute("style"),Mm in t&&(o.display=r)}}const Cu=/\s*!important$/;function ui(t,e,n){if(ue(n))n.forEach(o=>ui(t,e,o));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const o=Lm(t,e);Cu.test(n)?t.setProperty(io(o),n.replace(Cu,""),"important"):t[o]=n}}const xu=["Webkit","Moz","ms"],jl={};function Lm(t,e){const n=jl[e];if(n)return n;let o=jo(e);if(o!=="filter"&&o in t)return jl[e]=o;o=Ad(o);for(let s=0;s<xu.length;s++){const r=xu[s]+o;if(r in t)return jl[e]=r}return e}const ku="http://www.w3.org/1999/xlink";function Nm(t,e,n,o,s){if(o&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(ku,e.slice(6,e.length)):t.setAttributeNS(ku,e,n);else{const r=Wv(e);n==null||r&&!Ed(n)?t.removeAttribute(e):t.setAttribute(e,r?"":n)}}function Fm(t,e,n,o,s,r,l){if(e==="innerHTML"||e==="textContent"){o&&l(o,s,r),t[e]=n==null?"":n;return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=n;const u=a==="OPTION"?t.getAttribute("value"):t.value,c=n==null?"":n;u!==c&&(t.value=c),n==null&&t.removeAttribute(e);return}let i=!1;if(n===""||n==null){const u=typeof t[e];u==="boolean"?n=Ed(n):n==null&&u==="string"?(n="",i=!0):u==="number"&&(n=0,i=!0)}try{t[e]=n}catch(u){}i&&t.removeAttribute(e)}function Sn(t,e,n,o){t.addEventListener(e,n,o)}function Hm(t,e,n,o){t.removeEventListener(e,n,o)}const Ou=Symbol("_vei");function Um(t,e,n,o,s=null){const r=t[Ou]||(t[Ou]={}),l=r[e];if(o&&l)l.value=o;else{const[a,i]=Vm(e);if(o){const u=r[e]=Gm(o,s);Sn(t,a,u,i)}else l&&(Hm(t,a,l,i),r[e]=void 0)}}const $u=/(?:Once|Passive|Capture)$/;function Vm(t){let e;if($u.test(t)){e={};let o;for(;o=t.match($u);)t=t.slice(0,t.length-o[0].length),e[o[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):io(t.slice(2)),e]}let Tl=0;const Wm=Promise.resolve(),zm=()=>Tl||(Wm.then(()=>Tl=0),Tl=Date.now());function Gm(t,e){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;Et(Xm(o,n.value),e,5,[o])};return n.value=t,n.attached=zm(),n}function Xm(t,e){if(ue(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(o=>s=>!s._stopped&&o&&o(s))}else return e}const Su=/^on[a-z]/,Ym=(t,e,n,o,s=!1,r,l,a,i)=>{e==="class"?Bm(t,o,s):e==="style"?Dm(t,n,o):Vr(e)?Fi(e)||Um(t,e,n,o,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):qm(t,e,o,s))?Fm(t,e,o,r,l,a,i):(e==="true-value"?t._trueValue=o:e==="false-value"&&(t._falseValue=o),Nm(t,e,o,s))};function qm(t,e,n,o){return o?!!(e==="innerHTML"||e==="textContent"||e in t&&Su.test(e)&&_e(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Su.test(e)&&Je(n)?!1:e in t}const If=new WeakMap,jf=new WeakMap,Cr=Symbol("_moveCb"),Iu=Symbol("_enterCb"),Tf={name:"TransitionGroup",props:nt({},Tm,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=Cf(),o=Eg();let s,r;return Qi(()=>{if(!s.length)return;const l=t.moveClass||`${t.name||"v"}-move`;if(!eb(s[0].el,n.vnode.el,l))return;s.forEach(Jm),s.forEach(Qm);const a=s.filter(Zm);Sf(),a.forEach(i=>{const u=i.el,c=u.style;rn(u,l),c.transform=c.webkitTransform=c.transitionDuration="";const f=u[Cr]=h=>{h&&h.target!==u||(!h||/transform$/.test(h.propertyName))&&(u.removeEventListener("transitionend",f),u[Cr]=null,kn(u,l))};u.addEventListener("transitionend",f)})}),()=>{const l=Ae(t),a=Am(l);let i=l.tag||re;s=r,r=e.default?lf(e.default()):[];for(let u=0;u<r.length;u++){const c=r[u];c.key!=null&&_r(c,ni(c,a,o,n))}if(s)for(let u=0;u<s.length;u++){const c=s[u];_r(c,ni(c,a,o,n)),If.set(c,c.el.getBoundingClientRect())}return R(i,null,r)}}},Km=t=>delete t.mode;Tf.props;const a2=Tf;function Jm(t){const e=t.el;e[Cr]&&e[Cr](),e[Iu]&&e[Iu]()}function Qm(t){jf.set(t,t.el.getBoundingClientRect())}function Zm(t){const e=If.get(t),n=jf.get(t),o=e.left-n.left,s=e.top-n.top;if(o||s){const r=t.el.style;return r.transform=r.webkitTransform=`translate(${o}px,${s}px)`,r.transitionDuration="0s",t}}function eb(t,e,n){const o=t.cloneNode(),s=t[Ro];s&&s.forEach(a=>{a.split(/\s+/).forEach(i=>i&&o.classList.remove(i))}),n.split(/\s+/).forEach(a=>a&&o.classList.add(a)),o.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(o);const{hasTransform:l}=$f(o);return r.removeChild(o),l}const Bo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ue(e)?n=>xo(e,n):e};function tb(t){t.target.composing=!0}function ju(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const dn=Symbol("_assign"),Ye={created(t,{modifiers:{lazy:e,trim:n,number:o}},s){t[dn]=Bo(s);const r=o||s.props&&s.props.type==="number";Sn(t,e?"change":"input",l=>{if(l.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=mr(a)),t[dn](a)}),n&&Sn(t,"change",()=>{t.value=t.value.trim()}),e||(Sn(t,"compositionstart",tb),Sn(t,"compositionend",ju),Sn(t,"change",ju))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:o,number:s}},r){if(t[dn]=Bo(r),t.composing||document.activeElement===t&&t.type!=="range"&&(n||o&&t.value.trim()===e||(s||t.type==="number")&&mr(t.value)===e))return;const l=e==null?"":e;t.value!==l&&(t.value=l)}},nb={deep:!0,created(t,e,n){t[dn]=Bo(n),Sn(t,"change",()=>{const o=t._modelValue,s=js(t),r=t.checked,l=t[dn];if(ue(o)){const a=Vi(o,s),i=a!==-1;if(r&&!i)l(o.concat(s));else if(!r&&i){const u=[...o];u.splice(a,1),l(u)}}else if(Go(o)){const a=new Set(o);r?a.add(s):a.delete(s),l(a)}else l(Af(t,r))})},mounted:Tu,beforeUpdate(t,e,n){t[dn]=Bo(n),Tu(t,e,n)}};function Tu(t,{value:e,oldValue:n},o){t._modelValue=e,ue(e)?t.checked=Vi(e,o.props.value)>-1:Go(e)?t.checked=e.has(o.props.value):e!==n&&(t.checked=Rs(e,Af(t,!0)))}const Bt={deep:!0,created(t,{value:e,modifiers:{number:n}},o){const s=Go(e);Sn(t,"change",()=>{const r=Array.prototype.filter.call(t.options,l=>l.selected).map(l=>n?mr(js(l)):js(l));t[dn](t.multiple?s?new Set(r):r:r[0])}),t[dn]=Bo(o)},mounted(t,{value:e}){Au(t,e)},beforeUpdate(t,e,n){t[dn]=Bo(n)},updated(t,{value:e}){Au(t,e)}};function Au(t,e){const n=t.multiple;if(!(n&&!ue(e)&&!Go(e))){for(let o=0,s=t.options.length;o<s;o++){const r=t.options[o],l=js(r);if(n)ue(e)?r.selected=Vi(e,l)>-1:r.selected=e.has(l);else if(Rs(js(r),e)){t.selectedIndex!==o&&(t.selectedIndex=o);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function js(t){return"_value"in t?t._value:t.value}function Af(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const ob=["ctrl","shift","alt","meta"],sb={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>ob.some(n=>t[`${n}Key`]&&!e.includes(n))},ie=(t,e)=>(n,...o)=>{for(let s=0;s<e.length;s++){const r=sb[e[s]];if(r&&r(n,e))return}return t(n,...o)},rb={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},lt=(t,e)=>n=>{if(!("key"in n))return;const o=io(n.key);if(e.some(s=>s===o||rb[s]===o))return t(n)},lb=nt({patchProp:Ym},jm);let Eu;function ib(){return Eu||(Eu=lm(lb))}const ab=(...t)=>{const e=ib().createApp(...t),{mount:n}=e;return e.mount=o=>{const s=ub(o);if(!s)return;const r=e._component;!_e(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.innerHTML="";const l=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),l},e};function ub(t){return Je(t)?document.querySelector(t):t}const cb="modulepreload",db=function(t,e){return new URL(t,e).href},Ru={},Bu=function(e,n,o){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(r=>{if(r=db(r,o),r in Ru)return;Ru[r]=!0;const l=r.endsWith(".css"),a=l?'[rel="stylesheet"]':"";if(!!o)for(let c=s.length-1;c>=0;c--){const f=s[c];if(f.href===r&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${a}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":cb,l||(u.as="script",u.crossOrigin=""),u.href=r,document.head.appendChild(u),l)return new Promise((c,f)=>{u.addEventListener("load",c),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};function fb(t){return{all:t=t||new Map,on:function(e,n){var o=t.get(e);o?o.push(n):t.set(e,[n])},off:function(e,n){var o=t.get(e);o&&(n?o.splice(o.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var o=t.get(e);o&&o.slice().map(function(s){s(n)}),(o=t.get("*"))&&o.slice().map(function(s){s(e,n)})}}}var pb=Object.defineProperty,hb=(t,e,n)=>e in t?pb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ot=(t,e,n)=>(hb(t,typeof e!="symbol"?e+"":e,n),n);const Al=fb(),Re={fire(t){Al.emit(t.kind,t)},subscribe(t,e){Al.on(t.kind,e)},unsubscribe(t,e){Al.off(t.kind,e)}};class xr{constructor(e){this.path=e,ot(this,"kind","AssetFailureEvent")}}ot(xr,"kind","AssetFailureEvent");class Zr{constructor(e){this.message=e,ot(this,"kind","FailureEvent")}}ot(Zr,"kind","FailureEvent");class Ef{constructor(e){this.error=e,ot(this,"kind","CustomAssetFailureEvent")}}ot(Ef,"kind","CustomAssetFailureEvent");class el{constructor(){ot(this,"kind","InvalidateRenderEvent")}}ot(el,"kind","InvalidateRenderEvent");const Rf=class{constructor(){ot(this,"kind",Rf.kind)}};let ra=Rf;ot(ra,"kind","RenderUpdatedEvent");const Bf=class{constructor(){ot(this,"kind",Bf.kind)}};let la=Bf;ot(la,"kind","StateLoadingEvent");class At{constructor(e){this.message=e,ot(this,"kind","ShowMessageEvent")}}ot(At,"kind","ShowMessageEvent");class ia{constructor(e,n){this.message=e,this.actions=n,ot(this,"kind","ResolvableErrorEvent")}}ot(ia,"kind","ResolvableErrorEvent");class kr{constructor(e){this.color=e,ot(this,"kind","ColorPickedEvent")}}ot(kr,"kind","ColorPickedEvent");class Mf{constructor(e,n){this.error=e,this.info=n,ot(this,"kind","VueErrorEvent")}}ot(Mf,"kind","VueErrorEvent");var vb=Object.defineProperty,gb=Object.defineProperties,mb=Object.getOwnPropertyDescriptors,Mu=Object.getOwnPropertySymbols,bb=Object.prototype.hasOwnProperty,yb=Object.prototype.propertyIsEnumerable,ci=(t,e,n)=>e in t?vb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ls=(t,e)=>{for(var n in e||(e={}))bb.call(e,n)&&ci(t,n,e[n]);if(Mu)for(var n of Mu(e))yb.call(e,n)&&ci(t,n,e[n]);return t},_b=(t,e)=>gb(t,mb(e)),In=(t,e,n)=>(ci(t,typeof e!="symbol"?e+"":e,n),n),is=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const wb="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",Tt=class{constructor(t,e,n){this.$store=n,In(this,"onlineRepo"),In(this,"localRepo"),In(this,"tempRepo",Nn({authors:{},packs:[]})),In(this,"combinedList"),In(this,"authors"),window.repo=this,t||(t={authors:{},packs:[]},Re.fire(new At("Couldn't load remote repository."))),e||(e={authors:{},packs:[]},he.supports.localRepo&&Re.fire(new At("Couldn't load local repository."))),this.onlineRepo=L(t),this.localRepo=L(e),this.combinedList=S(()=>{var o,s;const r=this.onlineRepo.value,l=(o=r==null?void 0:r.packs)!=null?o:[],a=new Map(l.map(p=>[p.id,p])),i=this.localRepo.value,u=(s=i==null?void 0:i.packs)!=null?s:[],c=new Map(u.map(p=>[p.id,p])),h=this.tempRepo.packs,v=new Map(h.map(p=>[p.id,p])),g=new Set(he.state.autoAdd),b=this.$store.state.content.contentPacks.map(p=>p.packId).filter(p=>p!=null),w=new Set(b),$=new Set;return[...b,...u.map(p=>p.id),...l.map(p=>p.id),...h.map(p=>p.id)].filter(p=>p.startsWith("dddg.buildin.")||p.startsWith("dddg.uploads.")||p.startsWith("dddg.desktop.")||p==="concept_femc.shido_draws.edave64"||p==="mc.storm_blaze.edave64"||$.has(p)?!1:($.add(p),!0)).map(p=>{var m,_,A;return _b(ls(ls(ls({},(m=a.get(p))!=null?m:{characters:[],kind:[],authors:[]}),(_=c.get(p))!=null?_:{}),(A=v.get(p))!=null?A:{}),{autoloading:g.has(p),installed:c.has(p),online:a.has(p)||v.has(p),loaded:w.has(p)})})}),this.authors=S(()=>{var o,s;const r=this.onlineRepo.value,l=(o=r==null?void 0:r.authors)!=null?o:{},a=this.localRepo.value,i=(s=a==null?void 0:a.authors)!=null?s:{};return ls(ls({},l),i)}),Object.freeze(this)}static getInstance(){return Tt.instance||(Tt.instance=this.createInstance()),Tt.instance}static createInstance(){return is(this,null,function*(){const t=Tt.loadRepo(wb),e=he.supports.localRepo?yield Tt.loadRepo(he.localRepositoryUrl):null,[n,o,s]=yield Promise.all([t,e,Tt.$store]);return new Tt(n,o,s)})}static loadRepo(t){return is(this,null,function*(){try{const[e,n]=yield Promise.all([Tt.fetchJSON(t+"repo.json"),Tt.fetchJSON(t+"people.json")]);return{packs:e,authors:n}}catch(e){return null}})}static fetchJSON(t){return is(this,null,function*(){const e=yield fetch(t);if(!e.ok)throw new Error("Could not load json");return yield e.json()})}reloadLocalRepo(){return is(this,null,function*(){this.localRepo.value=he.supports.localRepo?yield Tt.loadRepo(he.localRepositoryUrl):null})}getPacks(){return this.combinedList.value}hasPack(t,e=!1){var n;return e?!!((n=this.onlineRepo.value)!=null&&n.packs.find(o=>o.id===t)):!!this.getPacks().find(o=>o.id===t)}getPack(t){var e;return(e=this.getPacks().find(n=>n.id===t))!=null?e:null}getAuthor(t){return this.authors.value[t]||null}getAuthors(){return this.authors.value}loadTempPack(t){return is(this,null,function*(){const e=fetch(t);let n;try{n=yield e}catch(r){throw new Error(`Failed to load '${t}'`)}let o;try{o=yield n.json()}catch(r){throw new Error(`The contents of '${t}' is not a valid JSON: ${r.message}`)}if(!o.pack)throw new Error(`The json file '${t}' does not contain any packages`);if(o.authors)for(const r in o.authors)this.tempRepo.authors[r]&&(this.tempRepo.authors[r]=o.authors[r]);const s=o.pack;return s.repoUrl=t,this.tempRepo.packs.find(r=>r.id===s.id)||this.tempRepo.packs.push(s),s.id})}};let pn=Tt;In(pn,"instance");In(pn,"setStore");In(pn,"$store",new Promise((t,e)=>{Tt.setStore=t}));var Pb=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const K=Df();function Df(){const t=[];let e=!1;return function(o){return new Promise((s,r)=>{const l=()=>Pb(this,null,function*(){try{o.length>0?yield o(Df()):yield o()}catch(a){console.log("Error during transaction!: ",a)}finally{e=!1}t.length>0&&t.shift()(),s()});e?t.push(l):l()})}}var Cb=Object.defineProperty,Du=Object.getOwnPropertySymbols,xb=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,di=(t,e,n)=>e in t?Cb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fi=(t,e)=>{for(var n in e||(e={}))xb.call(e,n)&&di(t,n,e[n]);if(Du)for(var n of Du(e))kb.call(e,n)&&di(t,n,e[n]);return t},qt=(t,e,n)=>(di(t,typeof e!="symbol"?e+"":e,n),n),st=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Or=navigator.userAgent,Ob=!!Or.match(/iPad/i)||!!Or.match(/iPhone/i),$b=!!Or.match(/WebKit/i),Lu=Ob&&$b&&!Or.match(/CriOS/i);class Lf{constructor(){qt(this,"state",Nn({looseTextParsing:!0,autoAdd:[],downloadLocation:"Default download folder"})),qt(this,"supports"),qt(this,"_gameMode",null),qt(this,"$store",null),qt(this,"isSavingEnabled",L(!1)),qt(this,"localRepositoryUrl",""),qt(this,"loading"),qt(this,"creatingDB"),qt(this,"loadingContentPacksAllowed"),qt(this,"loadContentPacks");const e=this,n=rt.canSave();window.addEventListener("beforeunload",function(o){o.preventDefault(),o.returnValue="Are you sure you want to leave? All your progress will be lost!"}),this.loadingContentPacksAllowed=new Promise((o,s)=>{this.loadContentPacks=()=>o()}),this.supports=Nn({optionalSaving:n,get autoLoading(){return n&&e.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0,setDownloadFolder:!1,openableFolders:new Set([]),assetCaching:!Lu,allowWebP:!0,limitedCanvasSpace:Lu}),n?this.loading=(()=>st(this,null,function*(){this.savingEnabled=yield rt.doesDbExists()}))():this.loading=Promise.resolve(),this.loading.then(()=>st(this,null,function*(){var o;if(yield this.loadingContentPacksAllowed,this.creatingDB&&(yield this.creatingDB),this.savingEnabled){const s=(o=yield rt.loadAutoload())!=null?o:[];this.state.autoAdd=s;const r=yield pn.getInstance(),l=yield Promise.all(s.map(a=>st(this,null,function*(){var i;const[u,c]=a.split(";",2);c!=null&&!r.hasPack(u)&&(yield r.loadTempPack(c));const f=r.getPack(u);return(i=f.dddg2Path)!=null?i:f.dddg1Path})));yield K(()=>st(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",l)}))}}))}get gameMode(){return this._gameMode}get savingEnabled(){return this.isSavingEnabled.value}set savingEnabled(e){e?(localStorage.setItem("saving","true"),this.creatingDB=rt.createDB(),this.creatingDB.then(()=>{this.creatingDB=void 0,this.isSavingEnabled.value=!0}).catch(()=>{})):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=rt.clearDB().then(()=>{this.creatingDB=void 0}).catch(()=>{}))}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}loadGameMode(){return st(this,null,function*(){const n=new URLSearchParams(location.search).get("mode");if(n==="ddlc"||n==="ddlc_plus"){this._gameMode=n;return}yield this.loading,yield this.creatingDB;let o="";this.isSavingEnabled.value&&(o=yield rt.loadGameMode());let s="ddlc";(o==="ddlc"||o==="ddlc_plus")&&(s=o),this._gameMode=s})}setGameMode(e){return st(this,null,function*(){this.isSavingEnabled.value&&(yield rt.saveGameMode(e));const n=`${location.protocol}//${location.host}${location.pathname}`;location.href=`${n}?mode=${e}`})}updateDownloadFolder(){throw new Error("Method not implemented.")}openFolder(e){throw new Error("Method not implemented.")}connectToStore(e){this.$store=e}saveToFile(e,n,o="image/png",s=1){return st(this,null,function*(){const r=document.createElement("a");r.setAttribute("download",n);const l=yield this.createObjectURL(e,o,s);return r.setAttribute("href",l),document.body.appendChild(r),r.click(),document.body.removeChild(r),l})}localRepoInstall(e,n,o){throw new Error("This environment does not support a local repository")}localRepoUninstall(e){throw new Error("This environment does not support a local repository")}autoLoadAdd(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB,yield rt.saveAutoload([...this.state.autoAdd,e]),this.state.autoAdd.push(e)})}autoLoadRemove(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB;const n=this.normalizePackId(e);yield rt.saveAutoload(this.state.autoAdd.filter(s=>this.normalizePackId(s)!=n));const o=this.state.autoAdd.indexOf(e);this.state.autoAdd.splice(o,1)})}normalizePackId(e){const n=e.split(";");return n.length===1?n[0]:n[n.length-1]}loadSettings(){return st(this,null,function*(){yield this.loading,yield this.creatingDB;const e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0,looseTextParsing:!0};return this.isSavingEnabled.value?fi(fi({},e),yield rt.loadSettings()):e})}saveSettings(e){return st(this,null,function*(){yield this.loading,yield this.creatingDB,this.isSavingEnabled.value&&(yield rt.saveSettings(e))})}isInitialized(){return st(this,null,function*(){yield this.loading,yield this.creatingDB})}prompt(e,n){return new Promise((o,s)=>{o(prompt(e,n))})}onPanelChange(e){}createObjectURL(e,n,o){return new Promise((s,r)=>{if(!(window.URL!=null&&window.URL.createObjectURL!=null))return s(e.toDataURL(n,o));if(e.toBlob!=null)e.toBlob(a=>{if(!a){r();return}s(URL.createObjectURL(a))},n,o);else{const a=e.toDataURL(n,o),i=this.dataURItoBlob(a,n);s(URL.createObjectURL(i))}})}dataURItoBlob(e,n){const o=atob(e.split(",")[1]),s=o.length,r=new Uint8Array(s);for(let l=0;l<s;l++)r[l]=o.charCodeAt(l);return new Blob([r],{type:n})}}const rt={indexedDB:(()=>{var t,e,n;try{return(n=(e=(t=window.indexedDB)!=null?t:window.mozIndexedDB)!=null?e:window.webkitIndexedDB)!=null?n:window.msIndexedDB}catch(o){return null}})(),transaction:(()=>{try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(t){return null}})(),db:null,canSave(){return!!(rt.indexedDB&&window.localStorage!=null)},doesDbExists(){return localStorage.getItem("saving")==="true"?Promise.resolve(!0):Promise.resolve(!1)},createDB(){return rt.db?rt.db:rt.db=new Promise((t,e)=>{const n=rt.indexedDB.open("dddg",3);n.onerror=o=>{e(o)},n.onupgradeneeded=o=>{var s;const r=o.target.result,l=(s=o.oldVersion)!=null?s:o.version;l<1&&r.createObjectStore("settings"),l===1&&(r.deleteObjectStore("settings"),r.createObjectStore("settings"))},n.onsuccess=o=>{t(n.result)}})},clearDB(){return new Promise((t,e)=>{if(!rt.db){t();return}const n=rt.indexedDB.deleteDatabase("dddg");rt.db=null,n.onerror=o=>{e(o)},n.onsuccess=o=>{t()}})},loadAutoload(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("autoload"))}))},saveAutoload(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put([...t],"autoload"))}))},loadGameMode(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("gameMode"))}))},saveGameMode(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put(t,"gameMode"))}))},saveSettings(t){return this.objectStorePromise("readwrite",e=>st(this,null,function*(){yield this.reqPromise(e.put(fi({},t),"settings"))}))},loadSettings(){return this.objectStorePromise("readonly",t=>st(this,null,function*(){return yield this.reqPromise(t.get("settings"))}))},objectStorePromise(t,e){return this.db?new Promise((n,o)=>st(this,null,function*(){const r=(yield this.db).transaction(["settings"],t).objectStore("settings");try{n(yield e(r))}catch(l){o(l)}})):Promise.reject(new Error("No database"))},reqPromise(t){return new Promise((e,n)=>{t.onerror=o=>{n(o)},t.onsuccess=o=>{e(t.result)}})}};class Sb extends Lf{saveToFile(e,n,o="image/png",s=1){let r=e.toDataURL(o,s);const l=this.dataURItoBlob(r,o);return window.URL!=null&&window.URL.createObjectURL!=null&&(r=URL.createObjectURL(l)),window.navigator.msSaveBlob(l,n),Promise.resolve(r)}}var Ib=Object.defineProperty,jb=(t,e,n)=>e in t?Ib(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,It=(t,e,n)=>(jb(t,typeof e!="symbol"?e+"":e,n),n),Qe=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Nu={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]};class Tb{constructor(){It(this,"state",Nn({looseTextParsing:!0,autoAdd:[],downloadLocation:""})),It(this,"localRepositoryUrl","/repo/"),It(this,"_gameMode",null),It(this,"electron",window),It(this,"$store",null),It(this,"bgInvalidation",null),It(this,"pendingContentPacks",[]),It(this,"pendingContentPacksReplace",[]),It(this,"loadingContentPacksAllowed"),It(this,"loadContentPacks"),It(this,"supports",{autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1,setDownloadFolder:!0,openableFolders:new Set(["downloads","backgrounds","sprites"]),assetCaching:!0,allowWebP:!0,limitedCanvasSpace:!1}),It(this,"savingEnabled",!0),this.loadingContentPacksAllowed=new Promise((n,o)=>{this.loadContentPacks=()=>n()}),this.electron.ipcRenderer.on("add-persistent-content-pack",n=>Qe(this,null,function*(){if(yield this.loadingContentPacksAllowed,!this.$store){this.pendingContentPacks.push(n);return}yield K(()=>Qe(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",n)}))})),this.electron.ipcRenderer.on("add-persistent-background",n=>Qe(this,null,function*(){const o="persistentBg-"+n,s=n.split("/");yield Hf(o,n),Nu.backgrounds.push({id:o,variants:[[o]],label:s[s.length-1],scaling:"none"}),this.invalidateInstalledBGs()})),this.electron.ipcRenderer.on("push-message",n=>{Re.fire(new At(n))}),this.electron.ipcRenderer.on("config.downloadFolderUpdate",n=>{this.state.downloadLocation=n}),this.electron.ipcRenderer.onConversation("load-packs",n=>Qe(this,null,function*(){const o=yield pn.getInstance(),s=yield Promise.all(n.map(r=>Qe(this,null,function*(){const[l,a]=r.split(";",2);a!=null&&!o.hasPack(l)&&(yield o.loadTempPack(a));const i=o.getPack(l);return i.dddg2Path||i.dddg1Path})));if(!this.$store){s.forEach(r=>this.pendingContentPacks.push(r));return}yield K(()=>Qe(this,null,function*(){yield this.$store.dispatch("content/loadContentPacks",s)}))})),this.electron.ipcRenderer.onConversation("auto-load.changed",n=>{this.state.autoAdd=n}),this.electron.ipcRenderer.onConversation("reload-repo",()=>Qe(this,null,function*(){yield(yield pn.getInstance()).reloadLocalRepo()})),this.electron.ipcRenderer.onConversation("replace-pack",n=>Qe(this,null,function*(){const o={processed:!1,contentPack:n};this.$store?yield K(()=>Qe(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",o)})):this.pendingContentPacksReplace.push(o)})),this.electron.ipcRenderer.onConversation("resolvable-error",(n,o)=>new Promise((s,r)=>{Re.fire(new ia(n,o.map(l=>({exec:()=>s(l),name:l}))))}));let e=!1;this.electron.ipcRenderer.on("update.progress",n=>{n==="done"?(e=!1,Re.fire(new At("An update is ready and will be installed once DDDG closes."))):e||(e=!0,Re.fire(new At("An update is ready and will be installed once DDDG closes.")))}),this.electron.ipcRenderer.send("init-dddg")}get gameMode(){return this._gameMode}storeSaveFile(e,n){const o=document.createElement("a"),s=URL.createObjectURL(e);return o.setAttribute("download",n),o.setAttribute("href",s),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),Promise.resolve()}updateDownloadFolder(){this.electron.ipcRenderer.send("config.newDownloadFolder")}openFolder(e){this.electron.ipcRenderer.send("open-folder",e)}onPanelChange(e){}saveSettings(e){return Qe(this,null,function*(){var n;yield this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw),yield this.electron.ipcRenderer.sendConvo("config.set","darkMode",(n=e.darkMode)!=null?n:void 0),yield this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom)})}loadGameMode(){return Qe(this,null,function*(){this._gameMode=(yield this.electron.ipcRenderer.sendConvo("config.get","gameMode"))||"ddlc"})}setGameMode(e){return Qe(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("config.set","gameMode",e),this.electron.ipcRenderer.send("reload")})}loadSettings(){return Qe(this,null,function*(){var e,n,o;return{lq:!1,nsfw:(e=yield this.electron.ipcRenderer.sendConvo("config.get","nsfw"))!=null?e:!1,darkMode:(n=yield this.electron.ipcRenderer.sendConvo("config.get","darkMode"))!=null?n:void 0,defaultCharacterTalkingZoom:(o=yield this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom"))!=null?o:void 0}})}localRepoInstall(e,n,o){return Qe(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.install",e,n,o)})}localRepoUninstall(e){return Qe(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("repo.uninstall",e)})}autoLoadAdd(e){return Qe(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.add",e)})}autoLoadRemove(e){return Qe(this,null,function*(){yield this.electron.ipcRenderer.sendConvo("auto-load.remove",e)})}saveToFile(e,n,o="image/png",s=1){return new Promise((r,l)=>{e.toBlob(a=>Qe(this,null,function*(){if(!a){l();return}const i=yield a.arrayBuffer();yield this.electron.ipcRenderer.sendConvo("save-file",n,new Uint8Array(i)),r(URL.createObjectURL(a))}),o,s)})}prompt(e,n){return Qe(this,null,function*(){return yield this.electron.ipcRenderer.sendConvo("show-prompt",e,n)})}connectToStore(e){this.$store=e,this.invalidateInstalledBGs(),K(()=>Qe(this,null,function*(){if(this.pendingContentPacks.length>0&&(yield this.$store.dispatch("content/loadContentPacks",this.pendingContentPacks)),this.pendingContentPacksReplace.length>0)for(const n of this.pendingContentPacksReplace)yield this.$store.dispatch("content/replaceContentPack",n)}))}invalidateInstalledBGs(){!this.$store||this.bgInvalidation===null&&(this.bgInvalidation=requestAnimationFrame(()=>{this.updateInstalledBGs()}))}updateInstalledBGs(){this.bgInvalidation!=null&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.$store&&K(()=>Qe(this,null,function*(){yield this.$store.dispatch("content/replaceContentPack",{contentPack:Nu})}))}}function Ab(){return window.isElectron?new Tb:"msSaveOrOpenBlob"in window.navigator?new Sb:new Lf}const he=Ab();window.toast=he;const Nf=""+new URL("missing_image.480f7f62.svg",import.meta.url).href;var Eb=Object.defineProperty,Fu=Object.getOwnPropertySymbols,Rb=Object.prototype.hasOwnProperty,Bb=Object.prototype.propertyIsEnumerable,pi=(t,e,n)=>e in t?Eb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hu=(t,e)=>{for(var n in e||(e={}))Rb.call(e,n)&&pi(t,n,e[n]);if(Fu)for(var n of Fu(e))Bb.call(e,n)&&pi(t,n,e[n]);return t},Uu=(t,e,n)=>(pi(t,typeof e!="symbol"?e+"":e,n),n);class oo{constructor(e){this.html=e,Uu(this,"width"),Uu(this,"height"),this.width=e.width,this.height=e.height}paintOnto(e,n={}){const{w:o,h:s}=Hu({w:this.width,h:this.height},n),{x:r,y:l}=Hu({x:-o/2,y:-s/2},n);e.drawImage(this.html,r,l,o,s)}}var Mb=Object.defineProperty,Db=(t,e,n)=>e in t?Mb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vu=(t,e,n)=>(Db(t,typeof e!="symbol"?e+"":e,n),n);let hi=null;setTimeout(()=>Lo(Nf).then(t=>{t instanceof oo&&(hi=t)}),0);class Ts{constructor(){Vu(this,"width",300),Vu(this,"height",300)}paintOnto(e,n={}){hi&&hi.paintOnto(e,n)}}var Lb=Object.defineProperty,Nb=(t,e,n)=>e in t?Lb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ff=(t,e,n)=>(Nb(t,typeof e!="symbol"?e+"":e,n),n),Mo=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});let El;function Do(){if(El)return El;if(!he.supports.allowWebP)return Promise.resolve(!1);const t="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",e="data:image/webp;base64,UklGRogAAABXRUJQVlA4THwAAAAv/8SzAA/wGbPPmH3GbP7jAQSSNu9f+rzDwYj+G23bpt3Gx3xD8353j73f5b87+e9OALmT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9OAriT/+7kvzv5704CuJP/7uS/O/nvTgK4k//u5L87+e9O/rsTwe7kvzsL";return El=(()=>Mo(this,null,function*(){const n=yield Promise.all([vi(t,1,2),vi(e,720,1280)]);return n[0]&&n[1]}))()}function vi(t,e,n){return new Promise((o,s)=>{const r=document.createElement("img");r.addEventListener("load",()=>{o(r.width===n&&r.height===e)}),r.addEventListener("error",()=>{o(!1)}),r.src=t})}let Rl;function Fb(){return Rl||(Rl=(()=>Mo(this,null,function*(){return yield vi("data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",1,2)}))())}class Hb{constructor(){Ff(this,"cache",new Map)}get(e){const n=this.cache.get(e);if(n)return n;const o=Sr(e);return this.cache.set(e,o),o}remove(e){this.cache.delete(e)}}class Ub{constructor(){Ff(this,"cache",new Map)}get(e){var n;const o=(n=this.cache.get(e))==null?void 0:n.deref();if(o)return o;const s=Wb(e);return this.cache.set(e,new WeakRef(s)),s}remove(e){this.cache.delete(e)}}let Bl=null;function $r(){return Bl||(window.assetCache=Bl=he.supports.assetCaching||typeof WeakRef=="undefined"?new Hb:new Ub)}const so={};function aa(t,e=!0){return Lo(he.supports.lq&&!e?t.lq:t.hq)}function Bn(t,e=!0){const n=he.supports.lq&&!e?t.lq:t.hq;return so[n]?so[n]:n}function Lo(t){return so[t]&&(t=so[t]),$r().get(t)}const ct="./";function As(t,e=!0){return Mo(this,null,function*(){const n=`${ct}assets/${t}${e?"":".lq"}${(yield Do())?".webp":".png"}`.replace(/\/+/,"/");return yield $r().get(n)})}function Vb(t,e=!0){return Mo(this,null,function*(){return`${ct}assets/${t}${he.supports.lq&&!e?".lq":""}${(yield Do())?".webp":".png"}`.replace(/\/+/,"/")})}function Hf(t,e){so[t]=e}function Wb(t){return Mo(this,null,function*(){const e=!!so[t];return e&&(t=so[t]),yield(()=>Mo(this,null,function*(){try{return yield Sr(t)}catch(n){if(t.endsWith(".webp")&&!e)try{return yield Sr(t.replace(/\.webp$/,".png"))}catch(o){return Re.fire(new xr(t)),$r().remove(t),new Ts}else return Re.fire(new xr(t)),$r().remove(t),new Ts}}))()})}function Sr(t,e=!1){return new Promise((n,o)=>{const s=new Image;s.addEventListener("load",()=>{n(new oo(s)),(e||!he.supports.assetCaching)&&document.body.removeChild(s)}),s.addEventListener("error",r=>{n(new Ts),(e||!he.supports.assetCaching)&&document.body.removeChild(s)}),s.crossOrigin="Anonymous",s.src=t,s.style.display="none",document.body.appendChild(s)})}const tl=1280,ua=720,zb=128,Gb=32,Xb="rgba(60,60,60,0.8)",Yb=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],Uf=1,qb=1/1.5,Kb=-74,Jb=358,Qb=[200,240,400,493,640,786,880,1040,1080],Zb=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:tl,screenHeight:ua,wheelInnerRadius:zb,wheelWidth:Gb,WheelBackground:Xb,positions:Yb,sdCharacterScaleFactor:Uf,hdCharacterScaleFactor:qb,CloseUpYOffset:Kb,BaseCharacterYPos:Jb,characterPositions:Qb},Symbol.toStringTag,{value:"Module"}));var ey=Object.defineProperty,ty=(t,e,n)=>e in t?ey(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nl=(t,e,n)=>(ty(t,typeof e!="symbol"?e+"":e,n),n);const _o=class{constructor(t,e,n,o){this.r=t,this.g=e,this.b=n,this.a=o,Object.freeze(this)}static validCss(t){return this.validCssRgb(t)||this.validHex(t)}static fromCss(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}static validCssRgb(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}static fromCssRgb(t){if(!this.validCssRgb(t))throw new Error("Invalid RGB color format");const e=t.slice(0,-1),n=e.indexOf("("),s=e.slice(n+1).split(",").map(r=>parseFloat(r.trim()));return new _o(s[0],s[1],s[2],s.length===4?s[3]:1)}static validHex(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}static fromHex(t){if(!this.validHex(t))throw new Error("Invalid Hex color format");const e=t.slice(1);if(e.length===3)return new _o(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),1);if(e.length===4)return new _o(parseInt(e[0]+e[0],16),parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)/255);if(e.length===6)return new _o(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),1);if(e.length===8)return new _o(parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16),parseInt(e[6]+e[7],16)/255);throw new Error("Invalid Hex color format length")}toCss(){return this.a>1?`rgb(${this.r},${this.g},${this.b})`:`rgba(${this.r},${this.g},${this.b},${this.a})`}toHex(){return`#${Math.round(this.r).toString(16).padStart(2,"0")}${Math.round(this.g).toString(16).padStart(2,"0")}${Math.round(this.b).toString(16).padStart(2,"0")}${Math.round(this.a*255).toString(16).padStart(2,"0")}`}toRgb(){return this}toHSL(){let{r:t,g:e,b:n}=this;const{a:o}=this;t/=255,e/=255,n/=255;const s=Math.max(t,e,n),r=Math.min(t,e,n);let l,a;const i=(s+r)/2;if(s===r)l=a=0;else{const u=s-r;switch(a=i>.5?u/(2-s-r):u/(s+r),s){case t:l=(e-n)/u+(e<n?6:0);break;case e:l=(n-t)/u+2;break;case n:l=(t-e)/u+4;break}l/=6}return new Fe(l,a,i,o)}get luminance(){return Math.sqrt(Math.pow(.299*(this.r/255),2)+Math.pow(.587*(this.g/255),2)+Math.pow(.114*(this.b/255),2))}};let Te=_o;nl(Te,"rgbEx",/^rgb\((\d*?),(\d*?),(\d*?)\)$/i);nl(Te,"rgbaEx",/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i);nl(Te,"hexShortEx",/^#[0-9A-F]{3,4}$/i);nl(Te,"hexLongEx",/^#[0-9A-F]{6,8}$/i);class Fe{constructor(e,n,o,s){this.h=e,this.s=n,this.l=o,this.a=s,Object.freeze(this)}toCss(){return this.a>=1?`hsl(${this.h}, ${this.s}, ${this.l})`:`hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`}shift(e){let{h:n,s:o,l:s,a:r}=this;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),o+e.s>1?o-=e.s:(o+=e.s,o<0&&(o=0)),s+e.l>1||s+e.l<0?s-=e.l:s+=e.l,r+e.a>1||r+e.a<0?r-=e.a:r+=e.a,new Fe(n,o,s,r)}toRgb(){const{h:e,s:n,l:o,a:s}=this;let r,l,a;if(n===0)r=l=a=o;else{const i=o<.5?o*(1+n):o+n-o*n,u=2*o-i;r=Fe.hue2rgb(u,i,e+1/3),l=Fe.hue2rgb(u,i,e),a=Fe.hue2rgb(u,i,e-1/3)}return new Te(Math.round(r*255),Math.round(l*255),Math.round(a*255),s)}toHSL(){return this}static hue2rgb(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}}const ny=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),oy="#ffe6f4",sy="#ffbde1",ry=420,ly=22,iy=640,Vf=270,ay=7,Wf=3,uy=Math.ceil(Wf/2),cy=(ua-Vf)/2,dy={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},fy=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:ny,ChoiceButtonColor:oy,ChoiceButtonBorderColor:sy,ChoiceButtonWidth:ry,ChoiceSpacing:ly,ChoiceX:iy,ChoiceYOffset:Vf,ChoicePadding:ay,Outline:Wf,ChoiceOuterPadding:uy,ChoiceY:cy,ChoiceTextStyle:dy},Symbol.toStringTag,{value:"Module"})),zf="#ffa8d2",py="#552222",hy="#ffeef6",ca="#bb5599",Gf=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Xf=new Fe(.002028397565922768,0,.13725490196078438,0),Yf=.82,qf=new Fe(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Kf=12,vy=1.5,gi=12,Nt=1.5,gy=.6,my=new Fe(.08045977011494243,-.5714285714285714,-.5960784313725489,0),by=new Fe(0,-.14285714285714296,.3,0),yy=new Fe(.004269293924466178,-.01869158878504662,-.039215686274509665,0),_y=9.5,wy=47,Jf=new Fe(.0023347701149424305,0,.10784313725490202,0),Qf=3,Zf=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:zf,controlsDefaultColor:py,nameboxDefaultColor:hy,nameboxStrokeDefaultColor:ca,nameboxTextOutlineDelta:Gf,nameboxBackgroundDelta:Xf,nameboxGradientMiddleStopPosition:Yf,nameboxGradientEndDelta:qf,nameboxRounding:Kf,nameboxRoundingBuffer:vy,textboxRounding:gi,textboxRoundingBuffer:Nt,nameColorThreshold:gy,controlColorDelta:my,controlDisableColorDelta:by,dotColorDelta:yy,dotRadius:_y,dotPatternSize:wy,textboxOutlineColorDelta:Jf,textboxOutlineWidth:Qf},Symbol.toStringTag,{value:"Module"}));var Py=Object.defineProperty,Cy=Object.defineProperties,xy=Object.getOwnPropertyDescriptors,Wu=Object.getOwnPropertySymbols,ky=Object.prototype.hasOwnProperty,Oy=Object.prototype.propertyIsEnumerable,zu=(t,e,n)=>e in t?Py(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ep=(t,e)=>{for(var n in e||(e={}))ky.call(e,n)&&zu(t,n,e[n]);if(Wu)for(var n of Wu(e))Oy.call(e,n)&&zu(t,n,e[n]);return t},tp=(t,e)=>Cy(t,xy(e));const Ko=816,da=900,ol=146,$y=0,Sy=29,Iy=8,Ms=38,sl=44,jy=6,Ty=93,Ay=404,Ey=9,Ry=9,ro=39,Ds=168,Ls=34,rl=29,fa=12,pa=-126,ha=-72,va=-38,ga=30.75,ma=26,np=426,mi=58,ba={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},ll=tp(ep({},ba),{fontName:"riffic",fontSize:24,strokeColor:ca,strokeWidth:6,color:"white",letterSpacing:1}),ya={align:"left",font:"13px aller",fill:{style:"#522"}},op=tp(ep({},ya),{fill:{style:"#a66"}}),By={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},_a={alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2},Jo=tl/2-Ko/2,My=tl/2-da/2,Dy=Jo+Ms,sp=Jo+Ls,Ly=sp+Ds/2,Ny=Jo+pa,Fy=Jo+ha,Hy=Jo+va,Uy="normal",Vy=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:Ko,TextBoxCorruptedWidth:da,TextBoxHeight:ol,TextBoxKerning:$y,TextBoxLineHeight:Sy,TextBoxCorruptedKerning:Iy,TextBoxTextXOffset:Ms,TextBoxTextYOffset:sl,TextBoxBottomSpacing:jy,HdSpacing:Ty,HdSideMargin:Ay,TextBoxTextCorruptedXOffset:Ey,TextBoxTextCorruptedYOffset:Ry,NameboxHeight:ro,NameboxWidth:Ds,NameboxXOffset:Ls,NameboxTextYOffset:rl,ControlsYBottomOffset:fa,ControlsXHistoryOffset:pa,ControlsXSkipOffset:ha,ControlsXStuffOffset:va,ArrowXRightOffset:ga,ArrowYBottomOffset:ma,GlowRX:np,GlowRY:mi,BaseTextStyle:ba,NameboxTextStyle:ll,ControlsTextStyle:ya,ControlsTextDisabledStyle:op,TextBoxCorruptedStyle:By,TextBoxStyle:_a,TextBoxX:Jo,TextBoxCorruptedX:My,TextBoxTextX:Dy,NameboxX:sp,NameboxTextX:Ly,ControlsXHistory:Ny,ControlsXSkip:Fy,ControlsXStuff:Hy,DefaultTextboxStyle:Uy},Symbol.toStringTag,{value:"Module"}));var Wy=Object.defineProperty,zy=Object.defineProperties,Gy=Object.getOwnPropertyDescriptors,Gu=Object.getOwnPropertySymbols,Xy=Object.prototype.hasOwnProperty,Yy=Object.prototype.propertyIsEnumerable,Xu=(t,e,n)=>e in t?Wy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qy=(t,e)=>{for(var n in e||(e={}))Xy.call(e,n)&&Xu(t,n,e[n]);if(Gu)for(var n of Gu(e))Yy.call(e,n)&&Xu(t,n,e[n]);return t},Ky=(t,e)=>zy(t,Gy(e));const Jy="#ffe6f4",Qy="#ffbde1",Zy="rgba(255,255,255,0.6)",e_=40,t_=30,n_=Ky(qy({},ba),{fontName:"riffic",fontSize:24,strokeColor:ca,strokeWidth:8,letterSpacing:1,color:"white"}),o_={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},s_=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:Jy,NotificationBorderColor:Qy,NotificationBackdropColor:Zy,NotificationPadding:e_,NotificationSpacing:t_,NotificationOkTextStyle:n_,NotificationTextStyle:o_},Symbol.toStringTag,{value:"Module"}));var r_=Object.defineProperty,l_=Object.defineProperties,i_=Object.getOwnPropertyDescriptors,Yu=Object.getOwnPropertySymbols,a_=Object.prototype.hasOwnProperty,u_=Object.prototype.propertyIsEnumerable,qu=(t,e,n)=>e in t?r_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bn=(t,e)=>{for(var n in e||(e={}))a_.call(e,n)&&qu(t,n,e[n]);if(Yu)for(var n of Yu(e))u_.call(e,n)&&qu(t,n,e[n]);return t},yn=(t,e)=>l_(t,i_(e));const rp=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],c_=0,d_=0,f_=tl/2,p_=ua/2,h_=33,v_=100,g_=30,m_=800,b_=720,y_=Uf,__="#333333bf",w_=480,P_=180,C_=3,x_=7,_n={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},lp=[yn(bn({},_n),{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),yn(bn({},_n),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),yn(bn({},_n),{name:"Monika",fontName:"journal",fontSize:34}),yn(bn({},_n),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),yn(bn({},_n),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),yn(bn({},_n),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),yn(bn({},_n),{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),yn(bn({},_n),{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],k_=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:rp,defaultPoemBackground:c_,defaultPoemStyle:d_,defaultX:f_,defaultY:p_,poemTopPadding:h_,poemBottomPadding:v_,poemPadding:g_,defaultPoemWidth:m_,defaultPoemHeight:b_,backgroundScale:y_,consoleBackgroundColor:__,consoleWidth:w_,consoleHeight:P_,defaultConsoleBackground:C_,defaultConsoleStyle:x_,poemTextStyles:lp},Symbol.toStringTag,{value:"Module"})),O_={Base:Zb,Choices:fy,Notification:s_,Poem:k_,TextBox:Vy,TextBoxCustom:Zf},il=1920,wa=1080,$_=128,S_=32,I_="rgba(60,60,60,0.8)",j_=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],ip=1.5,T_=1,A_=-111,E_=-39,R_=[300,360,600,740,960,1180,1320,1560,1620],B_=Object.freeze(Object.defineProperty({__proto__:null,screenWidth:il,screenHeight:wa,wheelInnerRadius:$_,wheelWidth:S_,WheelBackground:I_,positions:j_,sdCharacterScaleFactor:ip,hdCharacterScaleFactor:T_,CloseUpYOffset:A_,BaseCharacterYPos:E_,characterPositions:R_},Symbol.toStringTag,{value:"Module"})),M_=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),D_="#ffe6f4",L_="#ffbde1",N_=630,F_=33,H_=960,ap=405,U_=10.5,up=4.5,V_=Math.ceil(up/2),W_=(wa-ap)/2,z_={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},G_=Object.freeze(Object.defineProperty({__proto__:null,nameboxTextOutlineDelta:M_,ChoiceButtonColor:D_,ChoiceButtonBorderColor:L_,ChoiceButtonWidth:N_,ChoiceSpacing:F_,ChoiceX:H_,ChoiceYOffset:ap,ChoicePadding:U_,Outline:up,ChoiceOuterPadding:V_,ChoiceY:W_,ChoiceTextStyle:z_},Symbol.toStringTag,{value:"Module"})),cp="#ffa8d2",X_="#552222",Y_="#ffeef6",Pa="#bb5599",dp=new Fe(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),fp=new Fe(.002028397565922768,0,.13725490196078438,0),pp=.82,hp=new Fe(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),vp=15,q_=1.5,bi=19,ln=1.5,K_=.6,J_=new Fe(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Q_=new Fe(0,-.14285714285714296,.3,0),Z_=new Fe(.004269293924466178,-.01869158878504662,-.039215686274509665,0),ew=9.5*1.5,tw=47*1.5,gp=new Fe(.0023347701149424305,0,.10784313725490202,0),mp=5,bp=Object.freeze(Object.defineProperty({__proto__:null,textboxDefaultColor:cp,controlsDefaultColor:X_,nameboxDefaultColor:Y_,nameboxStrokeDefaultColor:Pa,nameboxTextOutlineDelta:dp,nameboxBackgroundDelta:fp,nameboxGradientMiddleStopPosition:pp,nameboxGradientEndDelta:hp,nameboxRounding:vp,nameboxRoundingBuffer:q_,textboxRounding:bi,textboxRoundingBuffer:ln,nameColorThreshold:K_,controlColorDelta:J_,controlDisableColorDelta:Q_,dotColorDelta:Z_,dotRadius:ew,dotPatternSize:tw,textboxOutlineColorDelta:gp,textboxOutlineWidth:mp},Symbol.toStringTag,{value:"Module"}));var nw=Object.defineProperty,ow=Object.defineProperties,sw=Object.getOwnPropertyDescriptors,Ku=Object.getOwnPropertySymbols,rw=Object.prototype.hasOwnProperty,lw=Object.prototype.propertyIsEnumerable,Ju=(t,e,n)=>e in t?nw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yp=(t,e)=>{for(var n in e||(e={}))rw.call(e,n)&&Ju(t,n,e[n]);if(Ku)for(var n of Ku(e))lw.call(e,n)&&Ju(t,n,e[n]);return t},_p=(t,e)=>ow(t,sw(e));const Ca=1220,wp=900,Pp=219,iw=0,aw=29,uw=8,xa=57,Cp=68,cw=54,dw=9,fw=9,ka=59,Oa=252,$a=49,xp=43,kp=12*1.5,Op=-126*1.5,$p=-72*1.5,Sp=-38*1.5,Ip=30.75*1.5,jp=26*1.5,Tp=426*1.5,yi=58*1.5,Sa={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:1,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Ap=_p(yp({},Sa),{fontName:"riffic",fontSize:36,strokeColor:Pa,strokeWidth:9,color:"white",letterSpacing:2}),Ir={align:"left",font:"24px aller",fill:{style:"#522"}},Ep=_p(yp({},Ir),{fill:{style:"#a66"}}),Rp={alpha:1,color:"#ffffff",fontName:"aller",fontSize:30,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:5,lineSpacing:1.2},pw={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},Qo=il/2-Ca/2,hw=il/2-wp/2,vw=Qo+xa,Bp=Qo+$a,gw=Bp+Oa/2,mw=Qo+Op,bw=Qo+$p,yw=Qo+Sp,_w="custom_plus",ww=Object.freeze(Object.defineProperty({__proto__:null,TextBoxWidth:Ca,TextBoxCorruptedWidth:wp,TextBoxHeight:Pp,TextBoxKerning:iw,TextBoxLineHeight:aw,TextBoxCorruptedKerning:uw,TextBoxTextXOffset:xa,TextBoxTextYOffset:Cp,TextBoxBottomSpacing:cw,TextBoxTextCorruptedXOffset:dw,TextBoxTextCorruptedYOffset:fw,NameboxHeight:ka,NameboxWidth:Oa,NameboxXOffset:$a,NameboxTextYOffset:xp,ControlsYBottomOffset:kp,ControlsXHistoryOffset:Op,ControlsXSkipOffset:$p,ControlsXStuffOffset:Sp,ArrowXRightOffset:Ip,ArrowYBottomOffset:jp,GlowRX:Tp,GlowRY:yi,BaseTextStyle:Sa,NameboxTextStyle:Ap,ControlsTextStyle:Ir,ControlsTextDisabledStyle:Ep,TextBoxStyle:Rp,TextBoxCorruptedStyle:pw,TextBoxX:Qo,TextBoxCorruptedX:hw,TextBoxTextX:vw,NameboxX:Bp,NameboxTextX:gw,ControlsXHistory:mw,ControlsXSkip:bw,ControlsXStuff:yw,DefaultTextboxStyle:_w},Symbol.toStringTag,{value:"Module"}));var Pw=Object.defineProperty,Cw=Object.defineProperties,xw=Object.getOwnPropertyDescriptors,Qu=Object.getOwnPropertySymbols,kw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable,Zu=(t,e,n)=>e in t?Pw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$w=(t,e)=>{for(var n in e||(e={}))kw.call(e,n)&&Zu(t,n,e[n]);if(Qu)for(var n of Qu(e))Ow.call(e,n)&&Zu(t,n,e[n]);return t},Sw=(t,e)=>Cw(t,xw(e));const Iw="#ffe6f4",jw="#ffbde1",Tw="rgba(255,255,255,0.6)",Aw=60,Ew=45,Rw=Sw($w({},Sa),{fontName:"riffic",fontSize:36,strokeColor:Pa,strokeWidth:12,letterSpacing:1,color:"white"}),Bw={alpha:1,color:"black",fontName:"aller",fontSize:36,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Mw=Object.freeze(Object.defineProperty({__proto__:null,NotificationBackgroundColor:Iw,NotificationBorderColor:jw,NotificationBackdropColor:Tw,NotificationPadding:Aw,NotificationSpacing:Ew,NotificationOkTextStyle:Rw,NotificationTextStyle:Bw},Symbol.toStringTag,{value:"Module"}));var Dw=Object.defineProperty,Lw=Object.defineProperties,Nw=Object.getOwnPropertyDescriptors,ec=Object.getOwnPropertySymbols,Fw=Object.prototype.hasOwnProperty,Hw=Object.prototype.propertyIsEnumerable,tc=(t,e,n)=>e in t?Dw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wn=(t,e)=>{for(var n in e||(e={}))Fw.call(e,n)&&tc(t,n,e[n]);if(ec)for(var n of ec(e))Hw.call(e,n)&&tc(t,n,e[n]);return t},Pn=(t,e)=>Lw(t,Nw(e));const Uw=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Vw=0,Ww=0,zw=il/2,Gw=wa/2,Xw=26,Yw=150,qw=61,Kw=1200,Jw=1080,Qw=ip,Zw="#333333bf",e0=720,t0=270,n0=3,o0=7,Cn={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:18},s0=[Pn(wn({},Cn),{name:"Sayori",fontName:"hashtag",fontSize:45,lineSpacing:.95,letterSpacing:1}),Pn(wn({},Cn),{name:"Natsuki",fontName:"ammy_handwriting",fontSize:41,letterSpacing:-.5}),Pn(wn({},Cn),{name:"Monika",fontName:"journal",fontSize:36,lineSpacing:1.4,letterSpacing:.5}),Pn(wn({},Cn),{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.55,fontSize:48}),Pn(wn({},Cn),{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:27,letterSpacing:-12}),Pn(wn({},Cn),{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:60}),Pn(wn({},Cn),{name:"MC",fontName:"halogen",fontSize:45,lineSpacing:1.53}),Pn(wn({},Cn),{name:"Console",fontName:"f25_bank_printer",fontSize:27,color:"white",lineSpacing:1.1})],r0=Object.freeze(Object.defineProperty({__proto__:null,poemBackgrounds:Uw,defaultPoemBackground:Vw,defaultPoemStyle:Ww,defaultX:zw,defaultY:Gw,poemTopPadding:Xw,poemBottomPadding:Yw,poemPadding:qw,defaultPoemWidth:Kw,defaultPoemHeight:Jw,backgroundScale:Qw,consoleBackgroundColor:Zw,consoleWidth:e0,consoleHeight:t0,defaultConsoleBackground:n0,defaultConsoleStyle:o0,poemTextStyles:s0},Symbol.toStringTag,{value:"Module"})),l0={Base:B_,Choices:G_,Notification:Mw,Poem:r0,TextBox:ww,TextBoxCustom:bp};function le(){return he.gameMode==="ddlc_plus"?l0:O_}const Ia={"dddg.buildin.backgrounds.nsfw":`${ct}packs/buildin.base.backgrounds.nsfw.json`,"dddg.buildin.sayori.nsfw":`${ct}packs/buildin.base.sayori.nsfw.json`,"dddg.buildin.base.natsuki.nsfw":`${ct}packs/buildin.base.natsuki.nsfw.json`,"dddg.buildin.yuri.nsfw":`${ct}packs/buildin.base.yuri.nsfw.json`},i0=new Set(Object.keys(Ia)),a0=Object.values(Ia);var u0=Object.defineProperty,c0=Object.defineProperties,d0=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,f0=Object.prototype.hasOwnProperty,p0=Object.prototype.propertyIsEnumerable,oc=(t,e,n)=>e in t?u0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,al=(t,e)=>{for(var n in e||(e={}))f0.call(e,n)&&oc(t,n,e[n]);if(nc)for(var n of nc(e))p0.call(e,n)&&oc(t,n,e[n]);return t},h0=(t,e)=>c0(t,d0(e));function fr(t,e){return{backgrounds:v0(t.backgrounds,e.backgrounds),characters:m0(t.characters,e.characters),dependencies:_i(t.dependencies,e.dependencies),fonts:tn(t.fonts,e.fonts,n=>n.id,(n,o)=>h0(al({},n),{files:_i(n.files,o.files)})),poemStyles:tn(t.poemStyles,e.poemStyles,n=>n.label,()=>{throw new Error}),poemBackgrounds:[...t.poemBackgrounds,...e.poemBackgrounds],sprites:tn(t.sprites,e.sprites,n=>n.id,(n,o)=>{var s;return{id:n.id,label:n.label,variants:[...n.variants,...o.variants],defaultScale:n.defaultScale,hd:n.hd,sdVersion:(s=n.sdVersion)!=null?s:o.sdVersion}}),colors:tn(t.colors,e.colors,n=>n.color,n=>n)}}function v0(t,e){return tn(t,e,n=>n.id,g0)}function g0(t,e){var n;return{id:t.id,label:t.label,variants:[...t.variants,...e.variants],scaling:t.scaling,sdVersion:(n=t.sdVersion)!=null?n:e.sdVersion}}function m0(t,e){return tn(t,e,n=>n.id,b0)}function b0(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:w0(t.heads,e.heads),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion,styleGroups:tn(t.styleGroups,e.styleGroups,n=>n.id,(n,o)=>({id:n.id,styleComponents:tn(n.styleComponents,o.styleComponents,s=>s.id,(s,r)=>({id:s.id,label:s.label,variants:y0(s.variants,r.variants)})),styles:tn(n.styles,o.styles,s=>JSON.stringify(s.components),(s,r)=>({components:s.components,poses:tn(s.poses,r.poses,l=>l.id,_0)}))}))}}function y0(t,e){const n=al({},t);for(const o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(n,o)||(n[o]=e[o]);return n}function _0(t,e){const n=al({},t.positions);for(const o in e.positions)n[o]?n[o]=[...n[o],...e.positions[o]]:n[o]=e.positions[o];return{id:t.id,compatibleHeads:_i(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function w0(t,e){const n=al({},t);for(const o in e){if(!Object.prototype.hasOwnProperty.call(e,o))continue;const s=e[o];if(n[o]){const r=n[o];n[o]={previewOffset:r.previewOffset,previewSize:r.previewSize,variants:[...r.variants,...s.variants]}}else n[o]=s}return n}function _i(t,e){const n=[...t];for(const o of e)n.includes(o)||n.push(o);return n}function tn(t,e,n,o){const s=[...t],r=new Map(t.map((l,a)=>[n(l),a]));for(const l of e){const a=n(l);if(r.has(a)){const i=r.get(a),u=s[i];s.splice(i,1,o(u,l))}else r.set(a,s.length),s.push(l)}return s}function jr(t,e,n){return t>e?t:e>n?n:e}function wi(t,e){return(t%e+e)%e}function P0(t,e){return t===null&&e===null?!0:t===null||e===null?!1:t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.e===e.e&&t.f===e.f}function Tr(t){const{a:e,b:n,c:o,d:s,e:r,f:l}=t,a=e*s-n*o,i={x:r,y:l,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){const u=Math.sqrt(e*e+n*n);i.rotation=(n>0?Math.acos(e/u):-Math.acos(e/u))/Math.PI*180,i.scaleX=u,i.scaleY=a/u,i.skewX=Math.atan((e*o+n*s)/(u*u))/Math.PI*180,i.skewY=0}else if(o!=0||s!=0){const u=Math.sqrt(o*o+s*s);i.rotation=(Math.PI/2-(s>0?Math.acos(-o/u):-Math.acos(o/u)))/Math.PI*180,i.scaleX=a/u,i.scaleY=u,i.skewX=0,i.skewY=Math.atan((e*o+n*s)/(u*u))/Math.PI*180}return i}function C0(){return Mp().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Mp(){return typeof navigator!="undefined"&&typeof window!="undefined"?window:typeof global!="undefined"?global:{}}const x0=typeof Proxy=="function",k0="devtools-plugin:setup",O0="plugin:settings:set";let ho,Pi;function $0(){var t;return ho!==void 0||(typeof window!="undefined"&&window.performance?(ho=!0,Pi=window.performance):typeof global!="undefined"&&((t=global.perf_hooks)===null||t===void 0?void 0:t.performance)?(ho=!0,Pi=global.perf_hooks.performance):ho=!1),ho}function S0(){return $0()?Pi.now():Date.now()}class I0{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const o={};if(e.settings)for(const l in e.settings){const a=e.settings[l];o[l]=a.defaultValue}const s=`__vue-devtools-plugin-settings__${e.id}`;let r=Object.assign({},o);try{const l=localStorage.getItem(s),a=JSON.parse(l);Object.assign(r,a)}catch(l){}this.fallbacks={getSettings(){return r},setSettings(l){try{localStorage.setItem(s,JSON.stringify(l))}catch(a){}r=l},now(){return S0()}},n&&n.on(O0,(l,a)=>{l===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(l,a)=>this.target?this.target.on[a]:(...i)=>{this.onQueue.push({method:a,args:i})}}),this.proxiedTarget=new Proxy({},{get:(l,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...i)=>(this.targetQueue.push({method:a,args:i,resolve:()=>{}}),this.fallbacks[a](...i)):(...i)=>new Promise(u=>{this.targetQueue.push({method:a,args:i,resolve:u})})})}setRealTarget(e){return Va(this,null,function*(){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(yield this.target[n.method](...n.args))})}}function j0(t,e){const n=t,o=Mp(),s=C0(),r=x0&&n.enableEarlyProxy;if(s&&(o.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!r))s.emit(k0,t,e);else{const l=r?new I0(n,s):null;(o.__VUE_DEVTOOLS_PLUGINS__=o.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:l}),l&&e(l.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var Dp="store";function T0(t){return t===void 0&&(t=null),bs(t!==null?t:Dp)}function Zo(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function A0(t){return t!==null&&typeof t=="object"}function E0(t){return t&&typeof t.then=="function"}function R0(t,e){return function(){return t(e)}}function Lp(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var o=e.indexOf(t);o>-1&&e.splice(o,1)}}function Np(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;ul(t,n,[],t._modules.root,!0),ja(t,n,e)}function ja(t,e,n){var o=t._state,s=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var r=t._wrappedGetters,l={},a={},i=Gv(!0);i.run(function(){Zo(r,function(u,c){l[c]=R0(u,t),a[c]=S(function(){return l[c]()}),Object.defineProperty(t.getters,c,{get:function(){return a[c].value},enumerable:!0})})}),t._state=Nn({data:e}),t._scope=i,t.strict&&N0(t),o&&n&&t._withCommit(function(){o.data=null}),s&&s.stop()}function ul(t,e,n,o,s){var r=!n.length,l=t._modules.getNamespace(n);if(o.namespaced&&(t._modulesNamespaceMap[l],t._modulesNamespaceMap[l]=o),!r&&!s){var a=Ta(e,n.slice(0,-1)),i=n[n.length-1];t._withCommit(function(){a[i]=o.state})}var u=o.context=B0(t,l,n);o.forEachMutation(function(c,f){var h=l+f;M0(t,h,c,u)}),o.forEachAction(function(c,f){var h=c.root?f:l+f,v=c.handler||c;D0(t,h,v,u)}),o.forEachGetter(function(c,f){var h=l+f;L0(t,h,c,u)}),o.forEachChild(function(c,f){ul(t,e,n.concat(f),c,s)})}function B0(t,e,n){var o=e==="",s={dispatch:o?t.dispatch:function(r,l,a){var i=Ar(r,l,a),u=i.payload,c=i.options,f=i.type;return(!c||!c.root)&&(f=e+f),t.dispatch(f,u)},commit:o?t.commit:function(r,l,a){var i=Ar(r,l,a),u=i.payload,c=i.options,f=i.type;(!c||!c.root)&&(f=e+f),t.commit(f,u,c)}};return Object.defineProperties(s,{getters:{get:o?function(){return t.getters}:function(){return Fp(t,e)}},state:{get:function(){return Ta(t.state,n)}}}),s}function Fp(t,e){if(!t._makeLocalGettersCache[e]){var n={},o=e.length;Object.keys(t.getters).forEach(function(s){if(s.slice(0,o)===e){var r=s.slice(o);Object.defineProperty(n,r,{get:function(){return t.getters[s]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function M0(t,e,n,o){var s=t._mutations[e]||(t._mutations[e]=[]);s.push(function(l){n.call(t,o.state,l)})}function D0(t,e,n,o){var s=t._actions[e]||(t._actions[e]=[]);s.push(function(l){var a=n.call(t,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:t.getters,rootState:t.state},l);return E0(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(i){throw t._devtoolHook.emit("vuex:error",i),i}):a})}function L0(t,e,n,o){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(r){return n(o.state,o.getters,r.state,r.getters)})}function N0(t){Xe(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function Ta(t,e){return e.reduce(function(n,o){return n[o]},t)}function Ar(t,e,n){return A0(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var F0="vuex bindings",sc="vuex:mutations",Ml="vuex:actions",vo="vuex",H0=0;function U0(t,e){j0({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[F0]},function(n){n.addTimelineLayer({id:sc,label:"Vuex Mutations",color:rc}),n.addTimelineLayer({id:Ml,label:"Vuex Actions",color:rc}),n.addInspector({id:vo,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(o){if(o.app===t&&o.inspectorId===vo)if(o.filter){var s=[];Wp(s,e._modules.root,o.filter,""),o.rootNodes=s}else o.rootNodes=[Vp(e._modules.root,"")]}),n.on.getInspectorState(function(o){if(o.app===t&&o.inspectorId===vo){var s=o.nodeId;Fp(e,s),o.state=z0(X0(e._modules,s),s==="root"?e.getters:e._makeLocalGettersCache,s)}}),n.on.editInspectorState(function(o){if(o.app===t&&o.inspectorId===vo){var s=o.nodeId,r=o.path;s!=="root"&&(r=s.split("/").filter(Boolean).concat(r)),e._withCommit(function(){o.set(e._state.data,r,o.state.value)})}}),e.subscribe(function(o,s){var r={};o.payload&&(r.payload=o.payload),r.state=s,n.notifyComponentUpdate(),n.sendInspectorTree(vo),n.sendInspectorState(vo),n.addTimelineEvent({layerId:sc,event:{time:Date.now(),title:o.type,data:r}})}),e.subscribeAction({before:function(o,s){var r={};o.payload&&(r.payload=o.payload),o._id=H0++,o._time=Date.now(),r.state=s,n.addTimelineEvent({layerId:Ml,event:{time:o._time,title:o.type,groupId:o._id,subtitle:"start",data:r}})},after:function(o,s){var r={},l=Date.now()-o._time;r.duration={_custom:{type:"duration",display:l+"ms",tooltip:"Action duration",value:l}},o.payload&&(r.payload=o.payload),r.state=s,n.addTimelineEvent({layerId:Ml,event:{time:Date.now(),title:o.type,groupId:o._id,subtitle:"end",data:r}})}})})}var rc=8702998,V0=6710886,W0=16777215,Hp={label:"namespaced",textColor:W0,backgroundColor:V0};function Up(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function Vp(t,e){return{id:e||"root",label:Up(e),tags:t.namespaced?[Hp]:[],children:Object.keys(t._children).map(function(n){return Vp(t._children[n],e+n+"/")})}}function Wp(t,e,n,o){o.includes(n)&&t.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:e.namespaced?[Hp]:[]}),Object.keys(e._children).forEach(function(s){Wp(t,e._children[s],n,o+s+"/")})}function z0(t,e,n){e=n==="root"?e:e[n];var o=Object.keys(e),s={state:Object.keys(t.state).map(function(l){return{key:l,editable:!0,value:t.state[l]}})};if(o.length){var r=G0(e);s.getters=Object.keys(r).map(function(l){return{key:l.endsWith("/")?Up(l):l,editable:!1,value:Ci(function(){return r[l]})}})}return s}function G0(t){var e={};return Object.keys(t).forEach(function(n){var o=n.split("/");if(o.length>1){var s=e,r=o.pop();o.forEach(function(l){s[l]||(s[l]={_custom:{value:{},display:l,tooltip:"Module",abstract:!0}}),s=s[l]._custom.value}),s[r]=Ci(function(){return t[n]})}else e[n]=Ci(function(){return t[n]})}),e}function X0(t,e){var n=e.split("/").filter(function(o){return o});return n.reduce(function(o,s,r){var l=o[s];if(!l)throw new Error('Missing module "'+s+'" for path "'+e+'".');return r===n.length-1?l:l._children},e==="root"?t:t.root._children)}function Ci(t){try{return t()}catch(e){return e}}var Xt=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var o=e.state;this.state=(typeof o=="function"?o():o)||{}},zp={namespaced:{configurable:!0}};zp.namespaced.get=function(){return!!this._rawModule.namespaced};Xt.prototype.addChild=function(e,n){this._children[e]=n};Xt.prototype.removeChild=function(e){delete this._children[e]};Xt.prototype.getChild=function(e){return this._children[e]};Xt.prototype.hasChild=function(e){return e in this._children};Xt.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};Xt.prototype.forEachChild=function(e){Zo(this._children,e)};Xt.prototype.forEachGetter=function(e){this._rawModule.getters&&Zo(this._rawModule.getters,e)};Xt.prototype.forEachAction=function(e){this._rawModule.actions&&Zo(this._rawModule.actions,e)};Xt.prototype.forEachMutation=function(e){this._rawModule.mutations&&Zo(this._rawModule.mutations,e)};Object.defineProperties(Xt.prototype,zp);var ao=function(e){this.register([],e,!1)};ao.prototype.get=function(e){return e.reduce(function(n,o){return n.getChild(o)},this.root)};ao.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(o,s){return n=n.getChild(s),o+(n.namespaced?s+"/":"")},"")};ao.prototype.update=function(e){Gp([],this.root,e)};ao.prototype.register=function(e,n,o){var s=this;o===void 0&&(o=!0);var r=new Xt(n,o);if(e.length===0)this.root=r;else{var l=this.get(e.slice(0,-1));l.addChild(e[e.length-1],r)}n.modules&&Zo(n.modules,function(a,i){s.register(e.concat(i),a,o)})};ao.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1],s=n.getChild(o);!s||!s.runtime||n.removeChild(o)};ao.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),o=e[e.length-1];return n?n.hasChild(o):!1};function Gp(t,e,n){if(e.update(n),n.modules)for(var o in n.modules){if(!e.getChild(o))return;Gp(t.concat(o),e.getChild(o),n.modules[o])}}function Y0(t){return new Pt(t)}var Pt=function(e){var n=this;e===void 0&&(e={});var o=e.plugins;o===void 0&&(o=[]);var s=e.strict;s===void 0&&(s=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new ao(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=r;var l=this,a=this,i=a.dispatch,u=a.commit;this.dispatch=function(h,v){return i.call(l,h,v)},this.commit=function(h,v,g){return u.call(l,h,v,g)},this.strict=s;var c=this._modules.root.state;ul(this,c,[],this._modules.root),ja(this,c),o.forEach(function(f){return f(n)})},Aa={state:{configurable:!0}};Pt.prototype.install=function(e,n){e.provide(n||Dp,this),e.config.globalProperties.$store=this;var o=this._devtools!==void 0?this._devtools:!1;o&&U0(e,this)};Aa.state.get=function(){return this._state.data};Aa.state.set=function(t){};Pt.prototype.commit=function(e,n,o){var s=this,r=Ar(e,n,o),l=r.type,a=r.payload,i={type:l,payload:a},u=this._mutations[l];!u||(this._withCommit(function(){u.forEach(function(f){f(a)})}),this._subscribers.slice().forEach(function(c){return c(i,s.state)}))};Pt.prototype.dispatch=function(e,n){var o=this,s=Ar(e,n),r=s.type,l=s.payload,a={type:r,payload:l},i=this._actions[r];if(!!i){try{this._actionSubscribers.slice().filter(function(c){return c.before}).forEach(function(c){return c.before(a,o.state)})}catch(c){}var u=i.length>1?Promise.all(i.map(function(c){return c(l)})):i[0](l);return new Promise(function(c,f){u.then(function(h){try{o._actionSubscribers.filter(function(v){return v.after}).forEach(function(v){return v.after(a,o.state)})}catch(v){}c(h)},function(h){try{o._actionSubscribers.filter(function(v){return v.error}).forEach(function(v){return v.error(a,o.state,h)})}catch(v){}f(h)})})}};Pt.prototype.subscribe=function(e,n){return Lp(e,this._subscribers,n)};Pt.prototype.subscribeAction=function(e,n){var o=typeof e=="function"?{before:e}:e;return Lp(o,this._actionSubscribers,n)};Pt.prototype.watch=function(e,n,o){var s=this;return Xe(function(){return e(s.state,s.getters)},n,Object.assign({},o))};Pt.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};Pt.prototype.registerModule=function(e,n,o){o===void 0&&(o={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),ul(this,this.state,e,this._modules.get(e),o.preserveState),ja(this,this.state)};Pt.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var o=Ta(n.state,e.slice(0,-1));delete o[e[e.length-1]]}),Np(this)};Pt.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Pt.prototype.hotUpdate=function(e){this._modules.update(e),Np(this,!0)};Pt.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(Pt.prototype,Aa);var tt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Es={},qe={},Mn={},Er=tt&&tt.__assign||function(){return Er=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Er.apply(this,arguments)},Xp=tt&&tt.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},q0=tt&&tt.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},K0=tt&&tt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(q0(arguments[e]));return t};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.mapObject=Yp=Mn.assetWalker=xi=Mn.normalizePath=void 0;var J0=10;function Q0(t,e,n,o){for(var s,r,l="",a=0,i=new Map(Array.from(e.entries()).map(function(h){return[new RegExp("{"+h[0]+"}","g"),h[1]]}));l!==t;){if(l=t,++a>J0)throw new Error("Maximum replacement recursion exceeded!");try{for(var u=(s=void 0,Xp(i.entries())),c=u.next();!c.done;c=u.next()){var f=c.value;t=t.replace(f[0],f[1])}}catch(h){s={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(s)throw s.error}}t=t.replace(/{format(:.*?:.*?)+}/gi,function(h){h=h.slice(8,-1);for(var v=h.split(":"),g=0;g<v.length;g+=2)if(n.has(v[g]))return v[g+1];return""}),t=t.replace(/{lq:(.*?):(.*?)}/gi,function(h){return h.slice(4,-1).split(":")[o?0:1]})}return t}var xi=Mn.normalizePath=Q0;function Z0(t,e){return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies,characters:t.characters.map(function(n){return eP(n,e)}),backgrounds:t.backgrounds.map(function(n){return aP(n,e)}),fonts:t.fonts.map(function(n){return uP(n,e)}),poemStyles:K0(t.poemStyles),poemBackgrounds:t.poemBackgrounds.map(function(n){return cP(n,e)}),sprites:t.sprites.map(function(n){return dP(n,e)}),colors:t.colors}}var Yp=Mn.assetWalker=Z0;function eP(t,e){return{id:t.id,label:t.label,chibi:t.chibi?e(t.chibi,"image"):void 0,heads:lP(t.heads,e),styleGroups:t.styleGroups.map(function(n){return tP(n,e)}),defaultScale:t.defaultScale,hd:t.hd,size:t.size,sdVersion:t.sdVersion}}function tP(t,e){return{id:t.id,styleComponents:t.styleComponents.map(function(n){return oP(n,e)}),styles:t.styles.map(function(n){return nP(n,e)})}}function nP(t,e){return{components:t.components,poses:t.poses.map(function(n){return rP(n,e)})}}function oP(t,e){return Er(Er({},t),{variants:sP(t.variants,e)})}function sP(t,e){var n={};for(var o in t)!t.hasOwnProperty(o)||(n[o]=e(t[o],"image"));return n}function rP(t,e){var n,o,s={};try{for(var r=Xp(Object.keys(t.positions)),l=r.next();!l.done;l=r.next()){var a=l.value,i=t.positions[a];s[a]=i.map(function(u){return u.map(function(c){return e(c,"image")})})}}catch(u){n={error:u}}finally{try{l&&!l.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return{compatibleHeads:t.compatibleHeads,id:t.id,previewOffset:t.previewOffset,previewSize:t.previewSize,renderCommands:t.renderCommands.map(function(u){return u.type==="image"?{type:"image",offset:u.offset,images:u.images.map(function(c){return e(c,"image")})}:u}),size:t.size,scale:t.scale,positions:s}}function lP(t,e){var n={};for(var o in t)!t.hasOwnProperty(o)||(n[o]=iP(t[o],e));return n}function iP(t,e){return{previewOffset:t.previewOffset,previewSize:t.previewSize,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})})}}function aP(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),scaling:t.scaling,sdVersion:t.sdVersion}}function uP(t,e){return{id:t.id,label:t.label,files:t.files.map(function(n){return e(n,"font")})}}function cP(t,e){return{id:t.id,fontColor:t.fontColor,label:t.label,images:t.images.map(function(n){return e(n,"image")}),sdVersion:t.sdVersion}}function dP(t,e){return{id:t.id,label:t.label,variants:t.variants.map(function(n){return n.map(function(o){return e(o,"image")})}),defaultScale:t.defaultScale,hd:t.hd,sdVersion:t.sdVersion}}function fP(t,e){var n={};for(var o in t)!t.hasOwnProperty(o)||(n[o]=e(t[o],o));return n}Mn.mapObject=fP;var Rr=tt&&tt.__assign||function(){return Rr=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Rr.apply(this,arguments)};Object.defineProperty(qe,"__esModule",{value:!0});qe.expandId=qe.normalizeStyleComponent=qe.normalizeColor=qe.normalizeBackground=qe.normalizeFont=qe.normalizePoemBackground=qe.normalizePoemStyles=qe.normalizeSprite=qe.mapNormalize=qp=qe.normalizeContentPack=void 0;var pP=Mn;function hP(t,e){var n={paths:e,packId:t.packId},o=bt("",t.folder||"/",n);return{packId:t.packId,packCredits:t.packCredits,dependencies:t.dependencies||[],characters:Jt(vP,t.characters,o,n),backgrounds:Jt(eh,t.backgrounds,o,n),fonts:Jt(Zp,t.fonts,o,n),poemStyles:Jt(Jp,t.poemStyles,o,n),poemBackgrounds:Jt(Qp,t.poemBackgrounds,o,n),sprites:Jt(Kp,t.sprites,o,n),colors:Jt(th,t.colors,o,n)}}var qp=qe.normalizeContentPack=hP;function Jt(t,e,n,o){return e?e.map(function(s){return t(s,n,o)}):[]}qe.mapNormalize=Jt;function Kp(t,e,n){var o,s=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label||t.variants[0][0],variants:t.variants.map(function(r){return cl(r,s,n)}),defaultScale:t.defaultScale||[1,1],sdVersion:t.sdVersion,hd:(o=t.hd)!==null&&o!==void 0?o:null}}qe.normalizeSprite=Kp;function Jp(t){return{label:t.label,defaultFont:t.defaultFont||"Aller",fontSize:t.fontSize!==void 0?t.fontSize:30,letterSpacing:t.letterSpacing!==void 0?t.letterSpacing:1,lineSpacing:t.lineSpacing!==void 0?t.lineSpacing:1.2}}qe.normalizePoemStyles=Jp;function Qp(t,e,n){var o=bt(e,t.folder,n);return{id:t.id,label:t.label,images:cl(t.images,o,n),fontColor:t.fontColor||"black",sdVersion:t.sdVersion}}qe.normalizePoemBackground=Qp;function Zp(t,e,n){var o=bt(e,t.folder,n);return{id:Gt(n.packId,t.id?t.id:t.label?t.label:t.files[0]),label:t.label?t.label:t.id?t.id:t.files[0],files:cl(t.files,o,n)}}qe.normalizeFont=Zp;function eh(t,e,n){var o,s=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label?t.label:t.variants[0][0],variants:t.variants.map(function(r){return cl(r,s,n)}),scaling:["none","strech","cover"].includes((o=t.scaling)===null||o===void 0?void 0:o.toLowerCase())?t.scaling.toLowerCase():"cover",sdVersion:t.sdVersion}}qe.normalizeBackground=eh;function th(t){return{label:t.label||t.color,color:t.color}}qe.normalizeColor=th;function cl(t,e,n){return t.map(function(o){return bt(e,o,n)})}function vP(t,e,n){var o,s,r,l=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),label:t.label,chibi:t.chibi?bt(l,t.chibi,n):void 0,heads:yP(t.heads,l,n),defaultScale:(o=t.defaultScale)!==null&&o!==void 0?o:[.8,.8],size:(s=t.size)!==null&&s!==void 0?s:[960,960],hd:(r=t.hd)!==null&&r!==void 0?r:!1,sdVersion:t.sdVersion,styleGroups:Jt(gP,t.styleGroups,l,n)}}function gP(t,e,n){var o=bt(e,t.folder,n);return{id:Gt(n.packId,t.id),styleComponents:Jt(nh,t.styleComponents,o,n),styles:t.styles.map(function(s){return mP(s,o,n)})}}function mP(t,e,n){var o=bt(e,t.folder,n),s={};if(t.components)for(var r in t.components)!t.components.hasOwnProperty(r)||(s[Gt(n.packId,r)]=t.components[r]);return{components:s,poses:t.poses.map(function(l){return _P(l,o,n)})}}function nh(t,e,n){return{id:Gt(n.packId,t.id),label:t.label,variants:bP(t.variants,e,n)}}qe.normalizeStyleComponent=nh;function bP(t,e,n){if(!t)return{};var o={};for(var s in t)!t.hasOwnProperty(s)||(o[s]=bt(e,t[s],n));return o}function yP(t,e,n){var o={};if(!t)return o;for(var s in t)if(!!t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={variants:ki(r,e,n),previewOffset:[290,70],previewSize:[380,380]};else{var a=bt(e,r.folder,n);l={variants:ki(r.variants,a,n),previewOffset:r.previewOffset||[290,70],previewSize:r.previewSize||[380,380]}}o[Gt(n.packId,s)]=l}return o}function _P(t,e,n){var o,s,r=bt(e,t.folder,n);return{compatibleHeads:((o=t.compatibleHeads)===null||o===void 0?void 0:o.map(function(l){return Gt(n.packId,l)}))||[],id:Gt(n.packId,t.id),previewOffset:t.previewOffset||[0,0],previewSize:t.previewSize||[960,960],size:t.size||[960,960],scale:t.scale||.8,positions:pP.mapObject(t.positions||{},function(l){return ki(l,r,n)}),renderCommands:((s=t.renderCommands)===null||s===void 0?void 0:s.map(function(l){return wP(l,e,n)}))||[{type:"head",offset:[0,0]},{type:"pose-part",part:"Left",offset:[0,0]},{type:"pose-part",part:"Right",offset:[0,0]},{type:"pose-part",part:"Variant",offset:[0,0]}]}}function wP(t,e,n){if(t.type==="image"){var o=bt(e,t.folder,n);return{type:"image",composite:t.composite,offset:t.offset||[0,0],images:oh(t.images,o,n)}}else return Rr(Rr({},t),{offset:t.offset||[0,0]})}function ki(t,e,n){return t.map(function(o){return oh(o,e,n)})}function oh(t,e,n){return t.map(function(o){return bt(e,o,n)})}function PP(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function bt(t,e,n){if(!e)return t;for(var o in n.paths)if(e.startsWith(o))return n.paths[o]+e.slice(o.length);return PP(e)?e:t+e}function Gt(t,e){return e.indexOf(":")!==-1?e:t+":"+e}qe.expandId=Gt;var pr=tt&&tt.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},CP=tt&&tt.__read||function(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var o=n.call(t),s,r=[],l;try{for(;(e===void 0||e-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(a){l={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(l)throw l.error}}return r},Dl=tt&&tt.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(CP(arguments[e]));return t};Object.defineProperty(Es,"__esModule",{value:!0});Es.expandOrTranslateId=sh=Es.convert=void 0;var Oi=qe;function xP(t,e,n){if(!t.packId)throw new Error("");return{packId:t.packId,packCredits:t.packCredits?[t.packCredits]:[],dependencies:kP(t.id),backgrounds:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],characters:[OP(t,e,n)],colors:[]}}var sh=Es.convert=xP,rh={"ddlc.monika":Kt("dddg.buildin.base.monika","ddlc.monika",{heads:["straight","sideways"],poses:["normal","leaned","old","glitch"],styleGroups:["uniform","old","glitch"]}),"ddlc.natsuki":Kt("dddg.buildin.base.natsuki","ddlc.natsuki",{heads:["straight","straight_nsfw","sideways","turnedAway"],poses:["normal","crossed_arms","vomit","glitch"],styleGroups:["uniform","casual","old"],extraPoseAssoc:[["normal_causal","normal"],["crossed_arms_casual","crossed_arms"]],extraHeadAssoc:[["straight_nsfw","straight"]]}),"ddlc.sayori":Kt("dddg.buildin.sayori","ddlc.sayori",{heads:["straight","sideways"],poses:["normal","sideways","old","glitch","dead"],styleGroups:["uniform","casual","old","glitch","hanging"],extraPoseAssoc:[["normal_casual","normal"]]}),"ddlc.yuri":Kt("dddg.buildin.yuri","ddlc.yuri",{heads:["straight","sideways"],poses:["normal","sideways","stabbing","glitching","dragon"],styleGroups:["uniform","casual","glitch"],extraPoseAssoc:[["normal_causal","normal"],["hairplay_casual","hairplay"]]}),"ddlc.fan.mc1":Kt("dddg.buildin.mc_classic","ddlc.fan.mc1",{heads:["straight"],poses:["normal"],styleGroups:[],extraStyleGroupAssoc:[["uniform-yellow","uniform"]]}),"ddlc.fan.mc2":Kt("dddg.buildin.mc","ddlc.fan.mc2",{heads:["straight","straight_red"],poses:["normal","crossed_arms","casual","glitching","dragon"],styleGroups:["uniform","casual"],extraPoseAssoc:[["crossed_arms_casual","crossed_arms"],["crossed_arms_red","crossed_arms"],["normal_red","normal"],["casual_red","casual"],["casual_crossed_arms_red","crossed_arms"]],defaultStyleComponents:[{id:"eyes",label:"Eyes",variants:{yellow:"/parts/mc/yellow-eyes{ext}",red:"/parts/mc/red-eyes{ext}"}}]}),"ddlc.fan.mc_chad":Kt("dddg.buildin.mc_chad","ddlc.fan.mc_chad",{heads:["straight","straight_closed","straight_red"],poses:["normal","youknowihadto"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal_casual","normal"],["youknowihadto_casual","youknowihadto"],["normal_red","normal"],["youknowihadto_red","youknowihadto"],["normal_casual_red","normal"],["youknowihadto_casual_red","youknowihadto"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/chad/yellow-eyes{ext}",red:"/parts/chad/red-eyes{ext}"}}]}),"ddlc.fan.femc":Kt("dddg.buildin.femc","ddlc.fan.femc",{heads:["straight","straight_lh","straight_closed","straight_hetero","straight_hetero_lh"],poses:["normal","crossed_arms"],styleGroups:["uniform","casual","uniform_strict"],extraPoseAssoc:[["casual_normal","normal"],["casual_crossed_arms","crossed_arms"],["uniform_normal","normal"],["uniform_crossed_arms","crossed_arms"],["normal_long_hair","normal"],["crossed_arms_long_hair","crossed_arms"],["casual_normal_long_hair","normal"],["casual_crossed_arms_long_hair","crossed_arms"],["uniform_normal_long_hair","normal"],["uniform_crossed_arms_long_hair","crossed_arms"],["normal_hetero","normal"],["crossed_arms_hetero","crossed_arms"],["casual_normal_hetero","normal"],["casual_crossed_arms_hetero","crossed_arms"],["uniform_normal_hetero","normal"],["uniform_crossed_arms_hetero","crossed_arms"],["normal_long_hair_hetero","normal"],["crossed_arms_long_hair_hetero","crossed_arms"],["casual_normal_long_hair_hetero","normal"],["casual_crossed_arms_long_hair_hetero","crossed_arms"],["uniform_normal_long_hair_hetero","normal"],["uniform_crossed_arms_long_hair_hetero","crossed_arms"]],defaultStyleComponents:[{label:"Eyes",id:"eyes",variants:{yellow:"/parts/femc/yellow-eyes{ext}",hetero:"/parts/femc/hetero-eyes{ext}"}},{label:"Hairs",id:"hairs",variants:{sh:"/parts/femc/short-hair{ext}",lh:"/parts/femc/long-hair{ext}"}}]}),"ddlc.fan.amy1":Kt("dddg.buildin.amy1","ddlc.fan.amy1",{heads:["straight"],poses:["normal","crossed_arms"],styleGroups:["uniform"]}),"ddlc.fan.amy2":Kt("dddg.buildin.amy2","ddlc.fan.amy2",{heads:["straight","straight_closed","straight_red"],poses:["normal","folded_hands_up","folded_hands_down","hands_on_glasses"],styleGroups:["uniform","casual"],extraPoseAssoc:[["normal-casual","normal"],["folded_hands_up-casual","folded_hands_up"],["folded_hands_down-casual","folded_hands_down"],["hands_on_glasses-casual","hands_on_glasses"]]})};function kP(t){return[]}function OP(t,e,n){var o={characterId:t.id,packId:t.packId,paths:e};return{id:Hn("character",t.id,o),chibi:t.chibi,label:t.name,heads:TP(t.heads,o,n),styleGroups:$P(t,o,n),defaultScale:[.8,.8],size:[960,960],hd:!1}}function $P(t,e,n){var o,s,r=rh[e.characterId],l=[],a=new Map,i=AP(t,e),u=i.length===0?r&&r.defaultStyleComponents?SP(r.defaultStyleComponents,e):[]:i,c=t.poses.map(function(w){return w.style}).filter(function(w,$,p){return p.indexOf(w)===$}),f=new Map(t.styles.map(function(w){return[w.name,w]})),h=function(w){var $,p,m,_,A=f.get(w);if(A&&A.nsfw&&!n)return"continue";var I=w,E={};try{for(var j=($=void 0,pr(u)),M=j.next();!M.done;M=j.next()){var H=M.value;try{for(var te=(m=void 0,pr(Object.keys(H.variants))),q=te.next();!q.done;q=te.next()){var pe=q.value,we=new RegExp("-"+pe+"\\b");if(I.match(we)){E[H.id]=pe,I=I.replace(we,"");break}}}catch(F){m={error:F}}finally{try{q&&!q.done&&(_=te.return)&&_.call(te)}finally{if(m)throw m.error}}}}catch(F){$={error:F}}finally{try{M&&!M.done&&(p=j.return)&&p.call(j)}finally{if($)throw $.error}}I=Hn("styleGroups",I,e);var je=a.get(I);je||(je={id:I,styleComponents:u,styles:[]},a.set(I,je),l.push(I)),je.styles.push({components:E,poses:jP(t.poses.filter(function(F){return F.style===w}),e,n)})};try{for(var v=pr(c),g=v.next();!g.done;g=v.next()){var b=g.value;h(b)}}catch(w){o={error:w}}finally{try{g&&!g.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}return l.map(function(w){return a.get(w)})}function SP(t,e){return Oi.mapNormalize(Oi.normalizeStyleComponent,t,"",{packId:e.packId,paths:e.paths})}function IP(t,e){return t?[{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"},{type:"head",offset:e}]:[{type:"head",offset:e},{type:"pose-part",offset:[0,0],part:"Static"},{type:"pose-part",offset:[0,0],part:"Variant"},{type:"pose-part",offset:[0,0],part:"Left"},{type:"pose-part",offset:[0,0],part:"Right"}]}function jP(t,e,n){return t.map(function(o){return{compatibleHeads:o.compatibleHeads.map(function(s){return Hn("heads",s.toString(),e)}),id:Hn("poses",o.name,e),renderCommands:IP(o.headInForeground,o.headAnchor),previewOffset:o.offset,previewSize:o.size,size:[960,960],scale:.8,positions:{Static:"static"in o?[[o.static]]:[],Left:"left"in o?Ll(o.left,n):[],Right:"right"in o?Ll(o.right,n):[],Variant:"variant"in o?Ll(o.variant,n):[]}}})}function Ll(t,e){return t.filter(function(n){return!n.nsfw||e}).map(function(n){return[n.img]})}function TP(t,e,n){var o,s,r={};try{for(var l=pr(Object.keys(t)),a=l.next();!a.done;a=l.next()){var i=a.value,u=t[i];u.nsfw&&!n||(r[Hn("heads",i,e)]={previewOffset:u.offset,previewSize:u.size,variants:u.all.filter(function(c){return!c.nsfw||n}).map(function(c){return[c.img]})})}}catch(c){o={error:c}}finally{try{a&&!a.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}return r}function AP(t,e){var n=[],o=[];return Object.keys(t.eyes).length>0&&(Object.keys(t.eyes).forEach(function(s){return o.push(s)}),n.push({label:"Eyes",id:Hn("eyes","eyes",e),variants:t.eyes})),Object.keys(t.hairs).length>0&&(Object.keys(t.hairs).forEach(function(s){return o.push(s)}),n.push({label:"Hairs",id:Hn("hairs","hairs",e),variants:t.hairs})),n}function Nl(t,e){return new Map(e.map(function(n){return[n,t+":"+n]}))}function Kt(t,e,n){return n.extraHeadAssoc?n.extraHeadAssoc=n.extraHeadAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraHeadAssoc=[],n.extraPoseAssoc?n.extraPoseAssoc=n.extraPoseAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraPoseAssoc=[],n.extraStyleGroupAssoc?n.extraStyleGroupAssoc=n.extraStyleGroupAssoc.map(function(o){return[o[0],t+":"+o[1]]}):n.extraStyleGroupAssoc=[],{character:t+":"+e,eyes:t+":eyes",hairs:t+":hair",defaultStyleComponents:n.defaultStyleComponents||[],heads:new Map(Dl(Nl(t,n.heads),n.extraHeadAssoc)),poses:new Map(Dl(Nl(t,n.poses),n.extraPoseAssoc)),styleGroups:new Map(Dl(Nl(t,n.styleGroups),n.extraStyleGroupAssoc))}}function Hn(t,e,n){var o=rh[n.characterId];if(o){if(t==="character"||t==="hairs"||t==="eyes")return o[t];var s=o[t].get(e);if(s)return s}return Oi.expandId(n.packId,e)}Es.expandOrTranslateId=Hn;var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});var lh=Ea.normalizeCharacter=void 0;function EP(t,e){var n=Un("",t.folder||"/",e),o=void 0;return t.chibi&&(o=Un(n,t.chibi,e)),o===void 0&&t.internalId&&(o=(e["/"]||"")+"chibis/"+t.internalId),{id:t.id,packId:t.packId,packCredits:t.packCredits,name:t.name,nsfw:!!t.nsfw,chibi:o,eyes:lc(t.eyes,n,e),hairs:lc(t.hairs,n,e),styles:MP(t.styles),heads:RP(t.heads,n,e),poses:BP(t.poses,n,e)}}lh=Ea.normalizeCharacter=EP;function lc(t,e,n){if(!t)return{};var o={};for(var s in t)!t.hasOwnProperty(s)||(o[s]=Un(e,t[s],n));return o}function RP(t,e,n){var o={};if(!t)return o;for(var s in t)if(!!t.hasOwnProperty(s)){var r=t[s],l=void 0;if(r instanceof Array)l={all:ws(r,e,n),nsfw:!1,offset:[290,70],size:[380,380]};else{var a=Un(e,r.folder,n);l={all:ws(r.all,a,n),nsfw:!!r.nsfw,offset:r.offset||[290,70],size:r.size||[380,380]}}o[s]=l}return o}function BP(t,e,n){return t?t.map(function(o){var s=Un(e,o.folder,n),r={compatibleHeads:o.compatibleHeads||[],headAnchor:o.headAnchor||[0,0],headInForeground:!!o.headInForeground,name:o.name,nsfw:!!o.nsfw,style:o.style,offset:[0,0],size:[960,960]};if("static"in o)r.static=Un(s,o.static,n);else if("variant"in o)r.variant=ws(o.variant,s,n);else if("left"in o)r.left=ws(o.left,s,n),r.right=ws(o.right,s,n);else throw new Error("Invalid pose");return r}):[]}function ws(t,e,n){return t.map(function(o){return typeof o=="string"?{img:Un(e,o,n),nsfw:!1}:{img:Un(e,o.img,n),nsfw:o.nsfw||!1}})}function MP(t){return t?t.map(function(e){return{name:e.name,label:e.label,nsfw:e.nsfw||!1}}):[]}function DP(t){return t.startsWith("blob:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("://")}function Un(t,e,n){if(!e)return t;for(var o in n)if(e.startsWith(o))return n[o]+e.slice(o.length);return DP(e)?e:t+e}var Ps=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function ic(t){return t.split("/").slice(0,-1).join("/")+"/"}const ac=new Set(["png","gif","bmp","svg"]);function ih(){return{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}}}const LP={namespaced:!0,state:ih(),mutations:{setContentPacks(t,e){t.contentPacks=e},setCurrentContent(t,e){t.current=e}},actions:{removeContentPacks({commit:t,state:e,dispatch:n},o){const s=JSON.parse(JSON.stringify(e.current)),r=e.contentPacks.filter(l=>!o.has(l.packId));t("setContentPacks",r),t("setCurrentContent",r.reduce((l,a)=>fr(l,a))),n("panels/fixContentPackRemoval",s,{root:!0})},replaceContentPack(t,e){return Ps(this,arguments,function*({commit:n,state:o},s){debugger;const r=s.processed?s.contentPack:yield Br(s.contentPack);let l=o.contentPacks;const a=l.findIndex(i=>i.packId===s.contentPack.packId);a===-1?l.push(r):l.splice(a,1,r),l=l,n("setContentPacks",l),n("setCurrentContent",l.reduce((i,u)=>fr(i,u)))})},loadContentPacks(t,e){return Ps(this,arguments,function*({commit:n,state:o},s){typeof s=="string"&&(s=[s]);const r=yield Promise.all(s.map(u=>Ps(this,null,function*(){return yield $i(u)}))),l=yield Promise.all(r.map(u=>Br(u))),a=new Set(o.contentPacks.map(u=>u.packId));let i=o.current;for(const u of l){for(const c of u.dependencies)if(!a.has(c))throw new Error(`Missing dependency '${c}'. Refusing to install ${u.packId}`);i=fr(i,u)}return n("setContentPacks",[...o.contentPacks,...l]),n("setCurrentContent",i),r.map(u=>u.packId)})}},getters:{getCharacters({current:t}){const e=new Map;for(const n of t.characters)e.set(n.id,n);return e},getBackgrounds({current:t}){const e=new Map;for(const n of t.backgrounds)e.set(n.id,n);return e}}};function $i(t){return Ps(this,null,function*(){const e=yield fetch(t);if(!e.ok)throw new Error(`Could not load content pack. Server responded with: ${e.statusText}`);let n;try{n=yield e.json()}catch(o){throw new Error("Content pack is not valid json!")}try{const o={"./":ic(t),"/":ic(location.href)+"assets/"};return n.version==="2.0"?qp(n,o):sh(lh(n,o),o,!1)}catch(o){throw new Error("Content pack is not in a valid format!")}})}function Br(t){return Ps(this,null,function*(){const e=new Set((yield Do())?["webp",...ac]:ac),n=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]);return Yp(t,(o,s)=>{var r;const l=xi(o,n,e,!1),a=xi(o,n,e,!0);return{hq:l,lq:a,sourcePack:(r=t.packId)!=null?r:"buildIn"}})})}function gs(t,e,n){let o=e+n;const s=t.length;return o<0&&(o+=s),o>=s&&(o-=s),o}var un=(t=>(t[t.None=0]="None",t[t.Selected=1]="Selected",t[t.Focused=2]="Focused",t[t.Indirectly=4]="Indirectly",t))(un||{});const NP={[0]:void 0,[1]:"#f00",[2]:"#00f",[1+2]:"#f0f",[4]:"#f66",[4+2]:"#f6f"};function No(t){t.width=0,t.height=0,Ra.delete(t.disposalId||0)}function lo(){const t=document.createElement("canvas");return HP(t),t}const Ra=new Map;let FP=0;function HP(t){t.disposalId=FP++,typeof WeakRef!="undefined"&&Ra.set(t.disposalId,new WeakRef(t))}window.addEventListener("unload",()=>{Ra.forEach(t=>{const e=t.deref();!e||No(e)})});class wo{}var UP=Object.defineProperty,uc=Object.getOwnPropertySymbols,VP=Object.prototype.hasOwnProperty,WP=Object.prototype.propertyIsEnumerable,Si=(t,e,n)=>e in t?UP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,as=(t,e)=>{for(var n in e||(e={}))VP.call(e,n)&&Si(t,n,e[n]);if(uc)for(var n of uc(e))WP.call(e,n)&&Si(t,n,e[n]);return t},zP=(t,e,n)=>(Si(t,typeof e!="symbol"?e+"":e,n),n),GP=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Fo{constructor(e,n,o,s){this.canvas=e,this.fsCtx=n,this.hq=o,this.preview=s,zP(this,"aborted",!1)}static make(e,n,o){return new Fo(e,e.getContext("2d"),n,o)}static makeWithContext(e,n,o,s){return new Fo(e,n,o,s)}drawText(e){if(this.aborted)throw new wo;this.fsCtx.save();const{font:n,align:o,x:s=0,y:r=0,text:l=""}=as(as({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width,this.fsCtx.strokeText(l,s,r)),e.fill&&(this.fsCtx.fillStyle=e.fill.style,this.fsCtx.fillText(l,s,r)),this.fsCtx.restore()}measureText(e){if(this.aborted)throw new wo;this.fsCtx.save();const{font:n,align:o,text:s=""}=as(as({},{font:"20px aller",align:"left"}),e);this.fsCtx.lineJoin="round",this.fsCtx.textAlign=o,this.fsCtx.font=n,e.outline&&(this.fsCtx.strokeStyle=e.outline.style,this.fsCtx.lineWidth=e.outline.width),e.fill&&(this.fsCtx.fillStyle=e.fill.style);const r=this.fsCtx.measureText(s);return this.fsCtx.restore(),r}drawImage(e){if(this.aborted)throw new wo;const{image:n,flip:o,x:s,y:r,w:l,h:a,filters:i,composite:u}=as({flip:!1,w:e.image.width,h:e.image.height,composite:"source-over"},e);if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=u,i)if("filter"in this.fsCtx){const c=[];for(const f of i)f.type==="drop-shadow"?c.push(`drop-shadow(${f.offsetX}px ${f.offsetY}px ${f.blurRadius}px ${f.color})`):f.type==="hue-rotate"?c.push(`hue-rotate(${f.value}deg)`):f.type==="blur"?c.push(`blur(${f.value}px)`):c.push(`${f.type}(${f.value*100}%)`);this.fsCtx.filter=c.join(" ")}else{let c=1;for(const f of i)f.type==="opacity"&&(c*=f.value);this.fsCtx.globalAlpha=c}if(e.shadow){const c=e.shadow;c.color!=null&&(this.fsCtx.shadowColor=c.color),c.blur!=null&&(this.fsCtx.shadowBlur=c.blur),c.offsetX!=null&&(this.fsCtx.shadowOffsetX=c.offsetX),c.offsetY!=null&&(this.fsCtx.shadowOffsetY=c.offsetY)}if(e.rotation!=null&&e.rotation!==0){const c=e.rotationAnchor?e.rotationAnchor.x:0,f=e.rotationAnchor?e.rotationAnchor.y:0;e.rotationAnchor&&this.fsCtx.translate(c,f),this.fsCtx.rotate(e.rotation),e.rotationAnchor&&this.fsCtx.translate(-c,-f)}this.fsCtx.translate(s+l/2,r+a/2),this.fsCtx.scale(o?-1:1,1),n.paintOnto(this.fsCtx,{x:-l/2,y:-a/2,w:l,h:a}),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}drawRect({x:e,y:n,w:o,h:s,outline:r,fill:l,composition:a,rotation:i,rotationAnchor:u}){if(this.aborted)throw new wo;if(this.fsCtx.save(),i!=null&&i!==0){const c=u?u.x:0,f=u?u.y:0;u&&this.fsCtx.translate(c,f),this.fsCtx.rotate(i),u&&this.fsCtx.translate(-c,-f)}this.fsCtx.beginPath(),this.fsCtx.rect(e,n,o,s),a&&(this.fsCtx.globalCompositeOperation=a),l&&(this.fsCtx.fillStyle=l.style,this.fsCtx.fill()),r&&(this.fsCtx.strokeStyle=r.style,this.fsCtx.lineWidth=r.width,this.fsCtx.stroke()),this.fsCtx.restore()}drawPath({outline:e,fill:n,path:o}){if(this.aborted)throw new wo;this.fsCtx.save(),this.fsCtx.beginPath(),o(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}patternFrom(e,n="repeat"){return e instanceof ah&&(e=e.previewCanvas),this.fsCtx.createPattern(e,n)}customTransform(e,n){return GP(this,null,function*(){this.fsCtx.save(),yield e(this.fsCtx),yield n(this),this.fsCtx.restore()})}linearGradient(e,n,o,s){return this.fsCtx.createLinearGradient(e,n,o,s)}applyFilters(e){if(e.length===0)return;this.fsCtx.save();let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);if("filter"in this.fsCtx){const o=[];for(const s of e)s.type!=="opacity"&&(s.type==="drop-shadow"?o.push(`drop-shadow(${s.offsetX}px ${s.offsetY}px ${s.blurRadius}px ${s.color})`):s.type==="hue-rotate"?o.push(`hue-rotate(${s.value}deg)`):s.type==="blur"?o.push(`blur(${s.value}px)`):o.push(`${s.type}(${s.value*100}%)`));this.fsCtx.filter=o.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),n!==1&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle=`rgba(0,0,0,${n})`,this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}abort(){this.aborted=!0}}var XP=Object.defineProperty,YP=(t,e,n)=>e in t?XP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fl=(t,e,n)=>(YP(t,typeof e!="symbol"?e+"":e,n),n),Js=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class ah{constructor(e,n){Fl(this,"previewCanvas"),Fl(this,"runningContext",null),Fl(this,"_disposed",!1);const o=le();this.previewCanvas=lo(),this.previewCanvas.width=e!=null?e:o.Base.screenWidth,this.previewCanvas.height=n!=null?n:o.Base.screenHeight}get disposed(){return this._disposed}render(e,n=!0,o=!0){return Js(this,null,function*(){this.runningContext&&this.runningContext.abort();const s=this.previewCanvas.getContext("2d");s.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height);const r=this.runningContext=Fo.makeWithContext(this.previewCanvas,s,n,o);try{yield e(this.runningContext)}catch(l){if(l instanceof wo)return!1;throw l}finally{r===this.runningContext&&(this.runningContext=null)}return!0})}get width(){return this.previewCanvas.width}get height(){return this.previewCanvas.height}paintOnto(e,n){n.w!=null&&n.h!=null?e.drawImage(this.previewCanvas,n.x,n.y,n.w,n.h):e.drawImage(this.previewCanvas,n.x,n.y)}download(e,n){return Js(this,null,function*(){const o=yield this.drawToCanvas(e);return yield he.saveToFile(o,n)})}renderToBlob(e){return Js(this,null,function*(){const n=yield this.drawToCanvas(e);return yield new Promise((o,s)=>{n.toBlob(r=>{r?o(r):s()})})})}drawToCanvas(e){return Js(this,null,function*(){const n=lo();n.width=this.previewCanvas.width,n.height=this.previewCanvas.height;const o=n.getContext("2d");return o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),yield e(Fo.makeWithContext(n,o,!0,!1)),n})}dispose(){this.runningContext&&this.runningContext.abort(),No(this.previewCanvas),this._disposed=!0}getDataAt(e,n){return this.previewCanvas.getContext("2d").getImageData(e,n,1,1).data}}function es(){return{flip:!1,rotation:0,version:0,opacity:100,x:le().Base.screenWidth/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,scaleX:1,scaleY:1,ratio:1,preserveRatio:!0,skewX:0,skewY:0,linkedTo:null}}var qP=Object.defineProperty,KP=Object.defineProperties,JP=Object.getOwnPropertyDescriptors,cc=Object.getOwnPropertySymbols,QP=Object.prototype.hasOwnProperty,ZP=Object.prototype.propertyIsEnumerable,dc=(t,e,n)=>e in t?qP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mr=(t,e)=>{for(var n in e||(e={}))QP.call(e,n)&&dc(t,n,e[n]);if(cc)for(var n of cc(e))ZP.call(e,n)&&dc(t,n,e[n]);return t},e1=(t,e)=>KP(t,JP(e)),t1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const n1={setPose(t,e){const n=t.panels[e.panelId].objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup(t,{id:e,panelId:n,styleGroupId:o}){const s=t.panels[n].objects[e];s.styleGroupId=o,++s.version},setCharStyle(t,{id:e,panelId:n,styleId:o}){const s=t.panels[n].objects[e];s.styleId=o,++s.version},setClose(t,e){const n=t.panels[e.panelId].objects[e.id];n.close=e.close,++n.version},setPosePosition(t,e){const n=t.panels[e.panelId].objects[e.id];n.posePositions=Mr(Mr({},n.posePositions),e.posePositions),++n.version},setFreeMove(t,e){const n=t.panels[e.panelId].objects[e.id];if(n.freeMove=e.freeMove,!n.freeMove){const o=le();n.x=o.Base.characterPositions[Lr(n.x)],n.y=o.Base.BaseCharacterYPos}}};function dl(t,e){return t.getters["content/getCharacters"].get(e.characterType)}function Gn(t,e){return t["content/getCharacters"].get(e)}function Ho(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function o1(t,e){const n=Ho(t,e),o=[...Object.keys(n.positions).filter(s=>n.positions[s].length>1)];return n.compatibleHeads.length>0&&o.unshift("head"),o}function Dr(t,e,n=e.posePositions.headType||0){const o=Ho(t,e).compatibleHeads;return o.length===0?null:t.heads[o[n]]}function Lr(t){return le().Base.characterPositions.map((o,s)=>({pos:Math.abs(t-o),idx:s})).sort((o,s)=>o.pos-s.pos)[0].idx}const s1={createCharacters({rootState:t,rootGetters:e,commit:n,state:o},s){var r;const l=o.panels[s.panelId].lastObjId+1,a=le(),i=Gn(e,s.characterType),u=i.hd?a.Base.hdCharacterScaleFactor:a.Base.sdCharacterScaleFactor;return n("create",{object:e1(Mr({},es()),{id:l,panelId:t.panels.currentPanel,onTop:!1,type:"character",y:a.Base.BaseCharacterYPos,width:i.size[0],height:i.size[1],scaleX:i.defaultScale[0]*u,scaleY:i.defaultScale[1]*u,characterType:s.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:(r=i.label)!=null?r:i.id,enlargeWhenTalking:t.ui.defaultCharacterTalkingZoom,linkedTo:null})}),l},seekPart({state:t,commit:e,dispatch:n,rootGetters:o},{delta:s,id:r,panelId:l,part:a}){if(a==="head"){n("seekHead",{id:r,panelId:l,delta:s});return}const i=t.panels[l].objects[r],u=Ho(Gn(o,i.characterType),i);!u.positions[a]||e("setPosePosition",{id:r,panelId:l,posePositions:{[a]:gs(u.positions[a],i.posePositions[a]||0,s)}})},seekPose({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Gn(n,l.characterType),i=a.styleGroups[l.styleGroupId].styles[l.styleId].poses;go(e,l,a,u=>{u.poseId=gs(i,u.poseId,r)})},seekStyle({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Gn(n,l.characterType),i=a.styleGroups.flatMap((c,f)=>c.styles.map((h,v)=>({styleGroupIdx:f,styleIdx:v,styleGroupJson:JSON.stringify(h.components)}))).sort((c,f)=>c.styleGroupJson.localeCompare(f.styleGroupJson)),u=i.findIndex(c=>c.styleGroupIdx===l.styleGroupId&&c.styleIdx===l.styleId);go(e,l,a,c=>{const f=gs(i,u,r),h=i[f];c.styleGroupId=h.styleGroupIdx,c.styleId=h.styleIdx})},seekHead({state:t,commit:e,rootGetters:n},{id:o,panelId:s,delta:r}){const l=t.panels[s].objects[o],a=Gn(n,l.characterType),i=Ho(a,l);let u=Dr(a,l);if(!u)return;let c=(l.posePositions.head||0)+r,f=l.posePositions.headType||0;(c<0||c>=u.variants.length)&&(f=gs(i.compatibleHeads.map(h=>a.heads[h]),f,r),u=Dr(a,l,f),c=r===1?0:u.variants.length-1),e("setPosePosition",{id:o,panelId:s,posePositions:{head:c,headType:f}})},setPart({state:t,commit:e,rootGetters:n},{panelId:o,id:s,part:r,val:l}){const a=t.panels[o].objects[s],i=Gn(n,a.characterType);r==="pose"?go(e,a,i,u=>{u.poseId=l}):r==="style"?go(e,a,i,u=>{u.styleId=l}):go(e,a,i,u=>{u.posePositions[r]=l})},setCharStyle({state:t,commit:e,rootGetters:n},{panelId:o,id:s,styleGroupId:r,styleId:l}){const a=t.panels[o].objects[s],i=Gn(n,a.characterType);go(e,a,i,u=>{u.styleGroupId=r,u.styleId=l})},setCharacterPosition({state:t,commit:e},{panelId:n,id:o,x:s,y:r}){const l=t.panels[n].objects[o];if(!l.freeMove){const a=le();s=a.Base.characterPositions[Lr(s)],r=a.Base.BaseCharacterYPos}l.x===s&&l.y===r||e("setPosition",{panelId:n,id:o,x:s,y:r})},shiftCharacterSlot({state:t,commit:e},{panelId:n,id:o,delta:s}){const r=t.panels[n].objects[o],l=le();let i=Lr(r.x)+s;i<0&&(i=0),i>=l.Base.characterPositions.length&&(i=l.Base.characterPositions.length-1),e("setPosition",{panelId:n,id:o,x:l.Base.characterPositions[i],y:r.y})}};function r1(t,e,n,o){return t1(this,null,function*(){const s=t.state.panels[e].objects[n],r=o.characters.find(_=>_.id===s.characterType);if(!r){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const l=uh(s),a=r.styleGroups[s.styleGroupId],i=a.styles[l.styleId],u=i.poses[l.poseId],c=t.rootState.content.current.characters.find(_=>_.id===r.id);if(!c){console.error("Character data is missing. Dropping the character."),yield t.dispatch("removeObject",{id:n,panelId:e});return}const f=c.styleGroups.findIndex(_=>_.id===a.id);l.styleGroupId=f===-1?0:f;const h=c.styleGroups[l.styleGroupId],v=JSON.stringify(i.components),g=h.styles.findIndex(_=>JSON.stringify(_.components)===v);l.styleId=g===-1?0:g;const b=h.styles[l.styleId],w=b.poses.findIndex(_=>_.id===u.id);l.poseId=w===-1?0:w;const $=b.poses[l.poseId];for(const _ in $.positions){if(!Object.prototype.hasOwnProperty.call($.positions,_))continue;const A=$.positions[_];if(u.positions[_]){const I=l.posePositions[_];I>=0&&I<A.length}}const p=u.compatibleHeads[s.posePositions.headType],m=$.compatibleHeads.indexOf(p);if(m===-1)l.posePositions.headType=0,l.posePositions.head=0;else{m!==s.posePositions.headType&&(l.posePositions.headType=m);const _=JSON.stringify(r.heads[p].variants[s.posePositions.head]),A=c.heads[p].variants.findIndex(I=>JSON.stringify(I)===_);A===-1?l.posePositions.head=0:l.posePositions.head=A}ch(t.commit,s,l)})}function uh(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Mr({},t.posePositions)}}function ch(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,panelId:e.panelId,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log(`Setting style of ${e.id} to ${n.styleId}`),t("setCharStyle",{id:e.id,panelId:e.panelId,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,panelId:e.panelId,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,panelId:e.panelId,posePositions:n.posePositions})}function go(t,e,n,o){const s=uh(e);o(s),n.styleGroups[s.styleGroupId]||(s.styleGroupId=0);const r=n.styleGroups[s.styleGroupId];r.styles[s.styleId]||(s.styleId=0);const l=r.styles[s.styleId];l.poses[s.poseId]||(s.poseId=0);const a=l.poses[s.poseId];for(const f in a.positions)!a.positions[f]||a.positions[f][s.posePositions[f]]||(s.posePositions[f]=0);const u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId].compatibleHeads[e.posePositions.headType||0],c=a.compatibleHeads.indexOf(u);c>=0?s.posePositions.headType=c:(s.posePositions.headType=0,s.posePositions.head=0),ch(t,e,s)}var Rt={},dh={};Object.defineProperty(dh,"__esModule",{value:!0});var fh={};Object.defineProperty(fh,"__esModule",{value:!0});var ph={};Object.defineProperty(ph,"__esModule",{value:!0});var hh={};Object.defineProperty(hh,"__esModule",{value:!0});var vh={};Object.defineProperty(vh,"__esModule",{value:!0});var gh={};Object.defineProperty(gh,"__esModule",{value:!0});var mh={};Object.defineProperty(mh,"__esModule",{value:!0});var bh={};Object.defineProperty(bh,"__esModule",{value:!0});var yh={};Object.defineProperty(yh,"__esModule",{value:!0});var _h={};Object.defineProperty(_h,"__esModule",{value:!0});var wh={};Object.defineProperty(wh,"__esModule",{value:!0});var Ph={};Object.defineProperty(Ph,"__esModule",{value:!0});var Ch={};Object.defineProperty(Ch,"__esModule",{value:!0});var xh={};Object.defineProperty(xh,"__esModule",{value:!0});var kh={};Object.defineProperty(kh,"__esModule",{value:!0});var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});var $h={};Object.defineProperty($h,"__esModule",{value:!0});var Sh={};Object.defineProperty(Sh,"__esModule",{value:!0});var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});var jh={};Object.defineProperty(jh,"__esModule",{value:!0});var Th={};Object.defineProperty(Th,"__esModule",{value:!0});var Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});var Eh={};Object.defineProperty(Eh,"__esModule",{value:!0});var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0});var Bh={};Object.defineProperty(Bh,"__esModule",{value:!0});var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});var Dh={};Object.defineProperty(Dh,"__esModule",{value:!0});var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});var Nh={};Object.defineProperty(Nh,"__esModule",{value:!0});var Fh={};Object.defineProperty(Fh,"__esModule",{value:!0});var Hh={};Object.defineProperty(Hh,"__esModule",{value:!0});var Uh={};Object.defineProperty(Uh,"__esModule",{value:!0});var Vh={};Object.defineProperty(Vh,"__esModule",{value:!0});var Wh={};Object.defineProperty(Wh,"__esModule",{value:!0});var zh={};Object.defineProperty(zh,"__esModule",{value:!0});var Gh={};Object.defineProperty(Gh,"__esModule",{value:!0});var Xh={};Object.defineProperty(Xh,"__esModule",{value:!0});var Yh={};Object.defineProperty(Yh,"__esModule",{value:!0});var qh={};Object.defineProperty(qh,"__esModule",{value:!0});var Kh={};Object.defineProperty(Kh,"__esModule",{value:!0});var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});var Qh={};Object.defineProperty(Qh,"__esModule",{value:!0});var Zh={};Object.defineProperty(Zh,"__esModule",{value:!0});var ev={};Object.defineProperty(ev,"__esModule",{value:!0});var tv={};Object.defineProperty(tv,"__esModule",{value:!0});var nv={};Object.defineProperty(nv,"__esModule",{value:!0});var ov={};Object.defineProperty(ov,"__esModule",{value:!0});var sv={};Object.defineProperty(sv,"__esModule",{value:!0});var rv={};Object.defineProperty(rv,"__esModule",{value:!0});var lv={};Object.defineProperty(lv,"__esModule",{value:!0});var iv={};Object.defineProperty(iv,"__esModule",{value:!0});var av={};Object.defineProperty(av,"__esModule",{value:!0});var uv={};Object.defineProperty(uv,"__esModule",{value:!0});var cv={};Object.defineProperty(cv,"__esModule",{value:!0});var dv={};Object.defineProperty(dv,"__esModule",{value:!0});var fv={};Object.defineProperty(fv,"__esModule",{value:!0});var pv={};Object.defineProperty(pv,"__esModule",{value:!0});var hv={};Object.defineProperty(hv,"__esModule",{value:!0});var vv={};Object.defineProperty(vv,"__esModule",{value:!0});var gv={};Object.defineProperty(gv,"__esModule",{value:!0});var fl={};Object.defineProperty(fl,"__esModule",{value:!0});fl.UnreachableCaseError=void 0;class l1 extends Error{constructor(e){super(`Unreachable case: ${e}`)}}fl.UnreachableCaseError=l1;var pl={};Object.defineProperty(pl,"__esModule",{value:!0});pl.assert=void 0;function i1(t,e="no additional info provided"){if(!t)throw new Error("Assertion Error: "+e)}pl.assert=i1;var hl={};Object.defineProperty(hl,"__esModule",{value:!0});hl.createFactoryWithConstraint=void 0;const a1=()=>t=>t;hl.createFactoryWithConstraint=a1;var vl={};Object.defineProperty(vl,"__esModule",{value:!0});vl.isExact=void 0;const u1=()=>t=>t;vl.isExact=u1;var gl={};Object.defineProperty(gl,"__esModule",{value:!0});gl.noop=void 0;function c1(...t){}gl.noop=c1;var mv={};Object.defineProperty(mv,"__esModule",{value:!0});(function(t){var e=tt&&tt.__createBinding||(Object.create?function(o,s,r,l){l===void 0&&(l=r);var a=Object.getOwnPropertyDescriptor(s,r);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,l,a)}:function(o,s,r,l){l===void 0&&(l=r),o[l]=s[r]}),n=tt&&tt.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&e(s,o,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(dh,t),n(fh,t),n(ph,t),n(hh,t),n(vh,t),n(gh,t),n(mh,t),n(bh,t),n(yh,t),n(_h,t),n(wh,t),n(Ph,t),n(Ch,t),n(xh,t),n(kh,t),n(Oh,t),n($h,t),n(Sh,t),n(Ih,t),n(jh,t),n(Th,t),n(Ah,t),n(Eh,t),n(Rh,t),n(Bh,t),n(Mh,t),n(Dh,t),n(Lh,t),n(Nh,t),n(Fh,t),n(Hh,t),n(Uh,t),n(Vh,t),n(Wh,t),n(zh,t),n(Gh,t),n(Xh,t),n(Yh,t),n(qh,t),n(Kh,t),n(Jh,t),n(Qh,t),n(Zh,t),n(ev,t),n(tv,t),n(nv,t),n(ov,t),n(sv,t),n(rv,t),n(lv,t),n(iv,t),n(av,t),n(uv,t),n(cv,t),n(dv,t),n(fv,t),n(pv,t),n(hv,t),n(vv,t),n(gv,t),n(fl,t),n(pl,t),n(hl,t),n(vl,t),n(gl,t),n(mv,t)})(Rt);var d1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class f1{constructor(e,n,o,s,r,l){this.id=e,this.assets=n,this.flip=o,this.scale=s,this.compositeMode=r,this.filters=l}render(e){return d1(this,null,function*(){const{screenWidth:n,screenHeight:o}=le().Base,s=yield Promise.all(this.assets.map(r=>aa(r,e.hq)));for(const r of s){let l=0,a=0,i=r.width,u=r.height;const c=this.scale;switch(c){case vr.None:l=n/2-i/2,a=o/2-u/2;break;case vr.Stretch:i=n,u=o;break;case vr.Cover:{const f=i/u,h=n/o;f>h?(u=o,i=u*f):(i=n,u=i/f),l=n/2-i/2,a=o/2-u/2;break}default:throw new Rt.UnreachableCaseError(c)}e.drawImage({image:r,x:l,y:a,w:i,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters})}})}}const fc={id:"buildin.static-color",name:"Static color",color:"#000000",render(t){const{screenWidth:e,screenHeight:n}=le().Base;return t.drawRect({x:0,y:0,w:e,h:n,fill:{style:this.color}}),Promise.resolve()}};function Nr(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.arcTo(e+o,n+s,e,n+s,r),t.arcTo(e,n+s,e,n,r),t.arcTo(e,n,e+o,n,r),t.closePath()}function bv(t,e,n,o,s,r){o<0&&(o=0),s<0&&(s=0),o<2*r&&(r=o/2),s<2*r&&(r=s/2),t.moveTo(e+r,n),t.arcTo(e+o,n,e+o,n+s,r),t.lineTo(e+o,n+s),t.lineTo(e,n+s),t.arcTo(e,n,e+o,n,r),t.closePath()}function Dn(t,e){t.save();try{e()}finally{t.restore()}}function Cs(t,e){e.align&&(t.textAlign=e.align),e.font&&(t.font=e.font),e.fill&&(t.fillStyle=e.fill.style),e.outline&&(t.strokeStyle=e.outline.style,t.lineWidth=e.outline.width)}function p1(t,e){if("filter"in t){let n="";for(const o of e)o.type==="drop-shadow"?n+=` drop-shadow(${o.offsetX}px ${o.offsetY}px ${o.blurRadius}px ${o.color})`:o.type==="hue-rotate"?n+=` hue-rotate(${o.value}deg)`:o.type==="blur"?n+=` blur(${o.value}px)`:n+=` ${o.type}(${o.value*100}%)`;t.filter=(t.filter==="none"?"":t.filter)+n.trimStart()}else{let n=1;for(const o of e)o.type==="opacity"&&(n*=o.value);t.globalAlpha*=n}}var h1=Object.defineProperty,v1=(t,e,n)=>e in t?h1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xn=(t,e,n)=>(v1(t,typeof e!="symbol"?e+"":e,n),n);class yv{constructor(e){this.obj=e,xn(this,"lastVersion",null),xn(this,"localCanvasInvalid",!0),xn(this,"lastHit",null),xn(this,"lastLocalTransform",null),xn(this,"refTextbox",null),xn(this,"preparedTransform"),xn(this,"hitDetectionFallback",!1),xn(this,"localCanvas",null)}get id(){return this.obj.id}get canSkipLocal(){return!1}get transformIsLocal(){return!1}get height(){return this.obj.height}get width(){return this.obj.width}get x(){return this.obj.x}get y(){return this.obj.y}getTransfrom(){let e=new DOMMatrix;const n=this.obj;e=e.translate(this.x,this.y);const o=this.height/2*n.scaleX;return"close"in n&&n.close&&(e=e.translate(0,le().Base.CloseUpYOffset),e=e.translate(0,-o),e=e.scale(2,2),e=e.translate(0,o)),this.isTalking&&n.enlargeWhenTalking&&(e=e.translate(0,+o),e=e.scale(1.05,1.05),e=e.translate(0,-o)),(n.flip||n.rotation!==0||n.scaleX!==1||n.scaleY!==1||n.skewX!==0||n.skewY!==0)&&(n.rotation!==0&&(e=e.rotate(0,0,n.rotation)),n.skewX!==1&&(e=e.skewX(n.skewX)),n.skewY!==1&&(e=e.skewY(n.skewY)),n.flip&&(e=e.flipX()),(n.scaleX!==1||n.scaleY!==1)&&(e=e.scale(n.scaleX,n.scaleY))),e}getLocalSize(){if(this.transformIsLocal){const e=le();return new DOMPointReadOnly(e.Base.screenWidth,e.Base.screenHeight)}else return new DOMPointReadOnly(this.width,this.height)}get isTalking(){return this.refTextbox!==null}get linkedTo(){return this.obj.linkedTo}prepareTransform(e){return this.preparedTransform=e.multiply(this.getTransfrom()),this.preparedTransform}prepareRender(e,n,o){if(this.lastVersion!==this.obj.version&&(this.localCanvasInvalid=!0,this.lastVersion=this.obj.version),this.transformIsLocal){const r=this.preparedTransform;P0(r,this.lastLocalTransform)||(this.localCanvasInvalid=!0,this.lastLocalTransform=r)}else this.lastLocalTransform=null;this.refTextbox=null;const s=[...e.order,...e.onTopOrder];for(const r of s){const l=e.objects[r];if(l.type==="textBox"&&l.talkingObjId===this.obj.id){this.refTextbox=l;return}}}render(e,n,o,s,r){o||(n=un.None),(!this.canSkipLocal||n!==un.None)&&(r=!1);const l=this.getLocalSize(),a=this.preparedTransform.translate(-this.width/2,-this.height/2);if(this.localCanvas&&(this.localCanvas.width!==l.x||this.localCanvas.height!==l.y)&&(this.localCanvasInvalid=!0),this.localCanvasInvalid&&!r){this.localCanvas||(this.localCanvas=lo()),this.localCanvas.width=l.x,this.localCanvas.height=l.y;const u=this.localCanvas.getContext("2d");if(!u)throw new Error("No canvas context received. Possibly out of memory?");this.transformIsLocal&&u.setTransform(a),this.renderLocal(u,s),this.localCanvasInvalid=!1,u.resetTransform()}const i=NP[n];Dn(e,()=>{var u;i!=null&&(e.shadowColor=i,e.shadowBlur=20),(!this.transformIsLocal||r)&&e.setTransform(a),e.globalCompositeOperation=(u=this.obj.composite)!=null?u:"source-over",p1(e,this.obj.filters),r?this.renderLocal(e,s):e.drawImage(this.localCanvas,0,0)})}dispose(){}hitTest(e){const n=e.matrixTransform(this.preparedTransform.translate(-this.width/2,-this.height/2).inverse()),o=this.getLocalSize();if(n.x<0||n.y<0||n.x>o.x||n.y>o.y)return console.log("Hitbox text",n),!1;if(this.hitDetectionFallback||!this.localCanvas||this.localCanvasInvalid)return!0;try{const s=this.transformIsLocal?e:n;return this.lastHit=s,this.localCanvas.getContext("2d",{willReadFrequently:!0}).getImageData(s.x|0,s.y|0,1,1).data[3]!==0}catch(s){throw this.hitDetectionFallback=!0,s}}}var g1=Object.defineProperty,m1=(t,e,n)=>e in t?g1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mo=(t,e,n)=>(m1(t,typeof e!="symbol"?e+"":e,n),n),b1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class _v extends yv{constructor(){super(...arguments),mo(this,"refTextbox",null),mo(this,"lastUploadCount",0),mo(this,"lastHq",!1),mo(this,"missingAsset",!1),mo(this,"_canSkipLocal",!1),mo(this,"assetList",[])}get canSkipLocal(){return this._canSkipLocal}get transformIsLocal(){return!1}prepareRender(e,n,o){super.prepareRender(e,n,o);let s=!o===this.lastHq;if(this.missingAsset){const r=Object.keys(n.state.uploadUrls).length;s=r!==this.lastUploadCount,this.lastUploadCount=r}if(this.isAssetListOutdated()&&(this.assetList=this.getAssetList(),s=!0),!!s)return this.lastHq=!o,this.localCanvasInvalid=!0,this._canSkipLocal=this.assetList.length<=1,this.loadAssets(!o)}getAssetsSize(){let e=0,n=0;for(const o of this.assetList)if("loadedAssets"in o)for(const s of o.loadedAssets)e=Math.max(e,o.offset[0]+s.width),n=Math.max(n,o.offset[1]+s.height);return new DOMPointReadOnly(e,n)}loadAssets(e){const n=[];this.missingAsset=!1;for(const o of this.assetList)"loadedAssets"in o&&!o.hasMissing||n.push((s=>b1(this,null,function*(){const r=yield Promise.all(s.assets.map(a=>aa(a,e))),l=s;l.loadedAssets=r,l.hasMissing=r.some(a=>a instanceof Ts),this.missingAsset||(this.missingAsset=l.hasMissing)}))(o));if(n.length!==0)return Promise.all(n)}isAssetListOutdated(){return this.assetList.length===0}renderLocal(e,n){var o;console.log("rerendering local");for(const s of this.assetList)if("loadedAssets"in s)for(const r of s.loadedAssets)this.canSkipLocal||(e.globalCompositeOperation=(o=s.composite)!=null?o:"source-over"),r instanceof Ts?r.paintOnto(e,{x:s.offset[0],y:s.offset[1],h:this.height,w:this.width}):r.paintOnto(e,{x:s.offset[0],y:s.offset[1]})}}class y1 extends _v{constructor(e,n){super(e),this.data=n}prepareRender(e,n,o){return this.data=dl(n,this.obj),super.prepareRender(e,n,o)}isAssetListOutdated(){return!0}getAssetList(){const e=Ho(this.data,this.obj),n=Dr(this.data,this.obj),o=[];for(const s of e.renderCommands)switch(s.type){case"head":{if(!n)continue;const r=n.variants[this.obj.posePositions.head||0];if(r==null)continue;o.push({offset:s.offset,composite:s.composite,assets:r});break}case"image":o.push({offset:s.offset,composite:s.composite,assets:s.images});break;case"pose-part":{const r=e.positions[s.part];if(!r||r.length===0)break;const l=r[this.obj.posePositions[s.part]||0];if(!l)break;o.push({offset:s.offset,composite:s.composite,assets:l});break}}return o}}var _1=Object.defineProperty,w1=(t,e,n)=>e in t?_1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,P1=(t,e,n)=>(w1(t,typeof e!="symbol"?e+"":e,n),n);const pc=5;class C1{constructor(e){this.str=e,P1(this,"pos",0)}current(){return this.str[this.pos]}get around(){return this.str.slice(Math.max(0,this.pos-pc),this.pos+pc)}get ahead(){return this.str[this.pos+1]}get behind(){return this.str[this.pos+1]}next(){return++this.pos,this.current()}}function hc(t,e=!0){const n=[],o=new C1(t);let s=ml;for(;s!==bl;){const r=o.pos;try{s=s(n,o)}catch(l){if(e&&s!==Ii)o.pos=r,s=(a,i)=>Ii(a,i,!0);else throw l}}return n}function ml(t,e){return e.current()===void 0?bl:e.current()==="{"?x1:e.current()===`
`?k1:Ii}function bl(){return bl}function Ii(t,e,n=!1){const{pos:o}=e;let s="",r=n,l;for(;;){if(e.current()===void 0){l=bl;break}else if(r)s+=e.current(),r=!1;else if(e.current()==="\\")r=!0;else if(e.current()==="{"||e.current()===`
`){l=ml;break}else s+=e.current();e.next()}return t.push({type:"text",pos:o,content:s}),l}function Hl(t,e){throw new Error(`Error when parsing text at position ${t.pos}: (around: "${t.around}") ${e}`)}function x1(t,e){const{pos:n}=e;if(e.current()!=="{")throw new Error("Parser error: Command does not start with {");const o=e.next()==="/";o&&e.next();let s="",r="",l=!1;for(;e.current()===void 0&&Hl(e,"Unexpected end of text inside a command"),e.current()!=="}";)l?r+=e.current():e.current().match(/[a-z]/i)?s+=e.current():e.current()==="="?(o&&Hl(e,"Closing commands may not contain arguments"),l=!0):Hl(e,`Unexpected character '${e.current()}' in command name.`),e.next();return e.next(),o?t.push({type:"commandClose",commandName:s,pos:n}):t.push({type:"command",pos:n,argument:r,commandName:s}),ml}function k1(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),ml}var O1=Object.defineProperty,$1=Object.defineProperties,S1=Object.getOwnPropertyDescriptors,vc=Object.getOwnPropertySymbols,I1=Object.prototype.hasOwnProperty,j1=Object.prototype.propertyIsEnumerable,gc=(t,e,n)=>e in t?O1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e)=>{for(var n in e||(e={}))I1.call(e,n)&&gc(t,n,e[n]);if(vc)for(var n of vc(e))j1.call(e,n)&&gc(t,n,e[n]);return t},kt=(t,e)=>$1(t,S1(e));const mc=new Map([bo("i",t=>kt(xt({},t),{isItalic:!0})),bo("b",t=>kt(xt({},t),{isBold:!0})),bo("u",t=>kt(xt({},t),{isUnderlined:!0})),bo("s",t=>kt(xt({},t),{isStrikethrough:!0})),bo("plain",t=>kt(xt({},t),{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})),bo("edited",t=>kt(xt({},t),{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})),Qs("k",(t,e,n)=>kt(xt({},t),{letterSpacing:e?t.letterSpacing+n:n})),Qs("size",(t,e,n)=>kt(xt({},t),{fontSize:e?t.fontSize+n:n})),Qs("alpha",(t,e,n)=>kt(xt({},t),{alpha:e?t.alpha+n:n})),Qs("stroke",(t,e,n)=>kt(xt({},t),{strokeWidth:e?t.strokeWidth+n:n})),["font",(t,e)=>kt(xt({},t),{fontName:e})],["color",(t,e)=>kt(xt({},t),{color:e})],["outlinecolor",(t,e)=>kt(xt({},t),{strokeColor:e})]]);function bo(t,e){return[t,(n,o)=>{if(o!=="")throw new Error(`Operator '${t}' does not take any arguments.`);return e(n)}]}function Qs(t,e){return[t,(n,o)=>{if(o=="")throw new Error(`Operator '${t}' needs an argument.`);const s=o[0]==="+"||o[0]==="-",r=Number(o);if(isNaN(r))throw new Error(`Operator '${t}' needs a numeric argument.`);return e(n,s,r)}]}var T1=Object.defineProperty,A1=(t,e,n)=>e in t?T1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ul=(t,e,n)=>(A1(t,typeof e!="symbol"?e+"":e,n),n);class Ot{constructor(e,n){this.str=e,this.baseStyle=n,Ul(this,"renderParts"),Ul(this,"tokens"),Ul(this,"loose"),this.loose=he.state.looseTextParsing;try{this.tokens=hc(e,this.loose)}catch(o){if(o instanceof Error)this.tokens=[{type:"text",pos:0,content:o.message}];else throw o}this.rebuildParts()}rebuildParts(){this.renderParts=Ot.getRenderParts(this.tokens,this.baseStyle,this.loose)}loadFonts(){if(!("fonts"in document))return;const e=new Set;let n=null;for(const s of this.renderParts)"style"in s&&s.style!==n&&(n=s.style,n.fontName&&e.add(n.fontName));const o=[];for(const s of e){const r=document,l=`8px '${s.replaceAll("'","\\'")}'`;r.fonts.check(l)||o.push(r.fonts.load(l))}if(o.length!==0)return Promise.all(o).then(()=>{const s=hc(this.str);this.renderParts=Ot.getRenderParts(s,this.baseStyle,this.loose)})}render(e){e.save();let n=null;for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,ji(n,e)),n.strokeWidth>0&&n.strokeColor>""&&e.strokeText(o.character,o.x,o.y));for(const o of this.renderParts)o.type!=="newline"&&(o.style!==n&&(n=o.style,ji(n,e)),e.fillText(o.character,o.x,o.y));e.restore()}quote(){let e;(r=>{r[r.None=0]="None",r[r.ExplictQuote=1]="ExplictQuote",r[r.ImplictQuote=2]="ImplictQuote",r[r.Star=3]="Star"})(e||(e={}));let n=-1,o=0;for(let r=0;r<this.renderParts.length;++r){const l=this.renderParts[r];if(l.type==="character")switch(o){case 0:if(l.character.match(/\s/))continue;l.character==='"'?(o=1,n=r):l.character==="*"?(o=3,n=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:us(l.style,'"')}),r++,n=r,o=2);break;case 1:n=r,l.character==='"'&&(o=0);break;case 2:if(l.character.match(/\s/))continue;l.character==="*"&&(this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:l.style,character:'"',height:l.height,width:us(l.style,'"')}),o=3,r++),n=r;break;case 3:l.character==="*"&&(o=0),n=r;break;default:throw new Rt.UnreachableCaseError(o)}}const s=this.renderParts[n];s&&o===3&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:"*",height:s.height,width:us(s.style,'"')}),s&&(o===1||o===2)&&this.renderParts.splice(n+1,0,{type:"character",x:0,y:0,style:s.style,character:'"',height:s.height,width:us(s.style,'"')})}fixAlignment(e,n,o,s,r){let l=0,a=[];function i(){let g=n;e==="center"?g=n+(o-n)/2-l/2:e==="right"&&(g=o-l);for(const b of a)b.x=g,g+=b.width}let u=this.renderParts;r>0&&(u=Ot.applyLineWrapping(this.renderParts.slice(0),r));let c=s;const f=[];let h=0;for(const g of u)h=Math.max(h,g.height),g.type==="newline"&&(f.push(h),h=0);f.push(h);let v=0;for(const g of u)if(h=Math.max(h,g.height),g.y=c,a.push(g),l+=g.width,g.type==="newline")i(),c+=f[++v]||0,l=0,h=0,a=[];else if(g.type==="character"){const b=a[a.length-1];b.type==="character"&&(l+=b.style.letterSpacing,b.width+=b.style.letterSpacing)}i()}getHeight(e){let n=0,o=0;const s=e===0?this.renderParts:Ot.applyLineWrapping(this.renderParts.slice(0),e);for(const r of s)n=Math.max(n,r.height),r.type==="newline"&&(o+=n,n=0);return o+=n,o}getWidth(){let e=0,n=0,o=null;for(const s of this.renderParts)e+=s.width,s.type==="newline"?(n=Math.max(n,e),e=0,o=null):s.type==="character"&&(o&&o.type==="character"&&(e+=o.style.letterSpacing),o=s);return n=Math.max(n,e),n}static getRenderParts(e,n,o){const s=[],r=[],l=[];let a=_c(n),i=n,u=null;function c(f){for(const h of f)s.push({type:"character",character:h,height:a,width:us(i,h),style:i,x:0,y:0})}for(const f of e){const h=f.type;switch(h){case"command":if(mc.has(f.commandName))r.push(i),l.push(u),i=mc.get(f.commandName)(i,f.argument),a=_c(i),u=f;else if(o)c("{"+f.commandName+"}");else throw new Error(`There is no text command called '${f.commandName}' at position ${f.pos}.`);break;case"commandClose":if(!u)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', but no commands are currently open.`);if(f.commandName!==u.commandName)if(o){c("{/"+f.commandName+"}");break}else throw new Error(`Unmatched closing command at position ${f.pos}. Closed '${f.commandName}', expected to close '${u}' first. (Opened at position ${u.pos})`);u=l.pop(),i=r.pop();break;case"newline":s.push({height:a,width:0,x:0,y:0,type:"newline"});break;case"text":c(f.content);break;default:throw new Rt.UnreachableCaseError(h)}}return s}static applyLineWrapping(e,n){let o=-1,s=0,r=0;const l=[];for(const a of e)if(a.type==="newline")o=-1,s=0,r=0,l.push(a);else if(a.type==="character")a.character===" "?s>n?(o=-1,s=0,r=0,l.push({type:"newline",height:a.height,width:0,x:0,y:0})):(s+=a.width,r=s,o=l.length,l.push(a)):(s+=a.width,s>n&&o!==-1&&(s-=r,l.splice(o,1,{type:"newline",height:a.height,width:0,x:0,y:0}),o=-1,r=0),l.push(a));else throw new Rt.UnreachableCaseError(a);return l}}const Ba=lo();Ba.width=0;Ba.height=0;const bc=Ba.getContext("2d");let yc=null;function us(t,e){return t!==yc&&(ji(t,bc),yc=t),bc.measureText(e).width}const Vl=new Map;function _c(t){const e=t.fontSize+" "+t.fontName;if(Vl.has(e))return Vl.get(e)*t.lineSpacing;const n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize=`${t.fontSize}px`,n.style.lineHeight="1";const o=document.createElement("div");o.style.opacity="0",o.style.fontFamily=t.fontName,o.style.fontSize=`${t.fontSize}px`,o.style.lineHeight="1",o.style.position="absolute",o.style.top="0",o.style.left="0",o.appendChild(n),document.body.appendChild(o);try{const s=o.offsetHeight;return Vl.set(e,s),s*t.lineSpacing}finally{o.remove()}}function ji(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}class yl extends yv{get canSkipLocal(){return this.obj.composite==="source-over"&&this.obj.filters.length===0}get transformIsLocal(){const e=this.preparedTransform;return this.obj.overflow?!0:he.supports.limitedCanvasSpace?!1:!(e.a===1&&e.b===0&&e.c===0&&e.d===1)}}var E1=Object.defineProperty,R1=(t,e,n)=>e in t?E1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wc=(t,e,n)=>(R1(t,typeof e!="symbol"?e+"":e,n),n);class B1 extends yl{constructor(){super(...arguments),wc(this,"_height",0),wc(this,"choiceRenderers",[])}get height(){const e=le().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=le().Choices;return this.obj.width+e.ChoiceOuterPadding*2}renderLocal(e,n){const o=le().Choices,s=this.obj.width,r=o.ChoiceOuterPadding;let l=o.ChoiceOuterPadding;for(const a of this.choiceRenderers){const i=a.getHeight(this.obj.autoWrap?s:0);e.strokeStyle=o.ChoiceButtonBorderColor,e.lineWidth=o.Outline,e.fillStyle=o.ChoiceButtonColor,e.fillRect(r,l,s,i+o.ChoicePadding*2),e.strokeRect(r,l,s,i+o.ChoicePadding*2),a.fixAlignment("center",r,s,l+o.ChoiceSpacing*1.25,this.obj.autoWrap?s:0),a.render(e),l+=i+o.ChoicePadding*2+o.ChoiceSpacing}}prepareRender(e,n,o){const s=le();this.choiceRenderers=this.obj.choices.map(a=>new Ot(a.text||" ",s.Choices.ChoiceTextStyle));const r=()=>(this._height=this.choiceRenderers.reduce((a,i)=>a+i.getHeight(this.obj.autoWrap?this.obj.width:0)+s.Choices.ChoicePadding*2,0)+this.obj.choiceDistance*(this.obj.choices.length-1),super.prepareRender(e,n,o)),l=this.choiceRenderers.map(a=>a.loadFonts()).filter(a=>a!==void 0);if(l.length===0)r();else return Promise.all(l).then(r)}}var M1=Object.defineProperty,D1=(t,e,n)=>e in t?M1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zs=(t,e,n)=>(D1(t,typeof e!="symbol"?e+"":e,n),n);class L1 extends yl{constructor(){super(...arguments),Zs(this,"_height",0),Zs(this,"_width",0),Zs(this,"_textRenderer",null),Zs(this,"_buttonRenderer",null)}get height(){const e=le().Choices;return this._height+e.ChoiceOuterPadding*2}get width(){const e=le().Choices;return this._width+e.ChoiceOuterPadding*2}prepareRender(e,n,o){const s=super.prepareRender(e,n,o),r=le().Notification,l=this._textRenderer=new Ot(this.obj.text,r.NotificationTextStyle),a=this._buttonRenderer=new Ot("OK",r.NotificationOkTextStyle),i=l.loadFonts(),u=a.loadFonts(),c=()=>{const f=this.obj.autoWrap?this.obj.width-r.NotificationPadding*2:0,h=this.obj.autoWrap?f:l.getWidth(),v=l.getHeight(f),g=this.obj.autoWrap?f:a.getWidth(),b=a.getHeight(f);this._width=Math.max(h,g)+r.NotificationPadding*2,this._height=v+r.NotificationPadding*2+r.NotificationSpacing+b};if(s||i||u)return Promise.all([s,i,u]).then(c);c()}render(e,n,o,s,r){return this.obj.backdrop&&Dn(e,()=>{const l=le();e.resetTransform(),e.fillStyle=l.Notification.NotificationBackdropColor,e.fillRect(0,0,l.Base.screenWidth,l.Base.screenHeight)}),super.render(e,n,o,s,r)}renderLocal(e,n){const o=le(),s=this.obj.autoWrap?this.obj.width-o.Notification.NotificationPadding*2:0,r=this._textRenderer,l=this._buttonRenderer,a=this._width,i=this._height,u=o.Choices.ChoiceOuterPadding;e.fillStyle=o.Choices.ChoiceButtonColor,e.strokeStyle=o.Choices.ChoiceButtonBorderColor,e.lineWidth=o.Choices.Outline,e.fillRect(u,u,a,i),e.strokeRect(u,u,a,i),r.fixAlignment("center",u,a+u,u+o.Notification.NotificationPadding*1.5,s),r.render(e),l.fixAlignment("center",u,a+u,u+i-o.Notification.NotificationPadding,s),l.render(e)}}var N1=Object.defineProperty,F1=(t,e,n)=>e in t?N1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,er=(t,e,n)=>(F1(t,typeof e!="symbol"?e+"":e,n),n),H1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const U1=-2,V1=26,W1=10,z1=10;class G1 extends yl{constructor(){super(...arguments),er(this,"_paperHeight",null),er(this,"_paperWidth",null),er(this,"_paper",null),er(this,"_lastPaperUrl",null)}get height(){var e;return(e=this._paperHeight)!=null?e:this.obj.height}get width(){var e;return(e=this._paperWidth)!=null?e:this.obj.width}prepareRender(e,n,o){const s=super.prepareRender(e,n,o),r=le().Poem,l=r.poemBackgrounds[this.obj.background],a=r.poemTextStyles[this.obj.font],u=new Ot(this.obj.text,a).loadFonts();let c;if(l.file.startsWith("internal:")?(this._lastPaperUrl=null,this._paper=null,this._paperHeight=null,this._paperWidth=null):this._lastPaperUrl!==l.file&&(c=(()=>H1(this,null,function*(){this._paper=yield Lo(`assets/poemBackgrounds/${l.file}`),this._lastPaperUrl=l.file,this._paperHeight=this._paper.height*r.backgroundScale,this._paperWidth=this._paper.width*r.backgroundScale}))()),s||u||c)return Promise.all([s,u,c])}renderLocal(e,n){const o=le().Poem,s=o.poemBackgrounds[this.obj.background],r=this.width,l=this.height;let a=o.poemPadding,i=o.poemTopPadding,u=a*2;if(s.file==="internal:console")e.fillStyle=this.obj.consoleColor||o.consoleBackgroundColor,e.fillRect(0,0,r,l),a=U1,i=V1,u=W1;else if(this._paper&&(this._paper.paintOnto(e,{x:0,y:0,w:r,h:l}),!this.obj.overflow)){const h=new Path2D;h.rect(0,0,r,l),e.clip(h)}const c=o.poemTextStyles[this.obj.font],f=new Ot(this.obj.text,c);f.fixAlignment("left",z1+a,a,i+a,this.obj.autoWrap?this.width-u:0),f.render(e)}}class X1 extends _v{getAssetList(){return[{assets:this.obj.assets,offset:[0,0]}]}}var Y1=Object.defineProperty,q1=(t,e,n)=>e in t?Y1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,K1=(t,e,n)=>(q1(t,typeof e!="symbol"?e+"":e,n),n),J1=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Ma{constructor(e){this.base=e,K1(this,"nextArrow",null)}static get defaultWidth(){return Ko}static get defaultHeight(){return ol+ro}static get defaultX(){return le().Base.screenWidth/2}static get defaultY(){return le().Base.screenHeight-this.defaultHeight/2-le().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return ya}getControlsDisabledStyle(){return op}get textboxStyle(){return _a}renderControls(e,n){const s=this.width/2,r=this.getControlsStyle();Cs(e,r),e.fillText("History",s+pa,n),Cs(e,this.base.obj.skip?r:this.getControlsDisabledStyle()),e.fillText("Skip",s+ha,n),Cs(e,r),e.fillText("Auto   Save   Load   Settings",s+va,n)}prepare(){if(!(this.nextArrow instanceof oo))return(()=>J1(this,null,function*(){this.nextArrow=yield As("next")}))()}}var Q1=Object.defineProperty,Z1=(t,e,n)=>e in t?Q1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jn=(t,e,n)=>(Z1(t,typeof e!="symbol"?e+"":e,n),n),Pc=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class ts extends Ma{constructor(){super(...arguments),jn(this,"backgroundImage","textbox"),jn(this,"xOffset",0),jn(this,"nameBoxAsset",null),jn(this,"backdropAsset",null)}static get resizable(){return!1}get height(){return ol+ro}get width(){return Ko}get innerHeight(){return this.height}get innerWidth(){return this.width}get nameboxWidth(){return Ds}get nameboxHeight(){return ro}get nameboxOffsetX(){return Ls}get nameboxOffsetY(){return rl}get nameboxStyle(){return ll}get textOffsetX(){return Ms}get textOffsetY(){return sl}renderNamebox(e,n,o){var s;(s=this.nameBoxAsset)==null||s.paintOnto(e,{x:n,y:o})}renderBackdrop(e,n,o){var s;n+=this.xOffset,(s=this.backdropAsset)==null||s.paintOnto(e,{x:n,y:o})}render(e){var n;const o=this.width,s=this.height;this.renderBackdrop(e,0,0+this.nameboxHeight),this.obj.talkingObjId!==null&&this.renderNamebox(e,0+this.nameboxOffsetX,0);const r=s,l=r-fa;this.obj.controls&&this.renderControls(e,l),this.obj.continue&&((n=this.nextArrow)==null||n.paintOnto(e,{x:o-ga,y:r-ma}))}prepare(){const e=super.prepare();if(!(!e&&this.backdropAsset&&this.nameBoxAsset))return Promise.all([e,this.backdropAsset instanceof oo?void 0:(()=>Pc(this,null,function*(){this.backdropAsset=yield As(this.backgroundImage)}))(),this.nameBoxAsset instanceof oo?void 0:(()=>Pc(this,null,function*(){this.nameBoxAsset=yield As("namebox")}))()])}}jn(ts,"id","normal");jn(ts,"label","Normal");jn(ts,"priority",0);jn(ts,"gameMode","ddlc");var eC=Object.defineProperty,tC=(t,e,n)=>e in t?eC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Uo=(t,e,n)=>(tC(t,typeof e!="symbol"?e+"":e,n),n);class Ns extends ts{constructor(){super(...arguments),Uo(this,"backgroundImage","textbox_monika"),Uo(this,"xOffset",(Ko-da)/2)}}Uo(Ns,"id","corrupt");Uo(Ns,"label","Corrupted");Uo(Ns,"priority",1);Uo(Ns,"gameMode","ddlc");var nC=Object.defineProperty,oC=Object.defineProperties,sC=Object.getOwnPropertyDescriptors,Cc=Object.getOwnPropertySymbols,rC=Object.prototype.hasOwnProperty,lC=Object.prototype.propertyIsEnumerable,Ti=(t,e,n)=>e in t?nC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iC=(t,e)=>{for(var n in e||(e={}))rC.call(e,n)&&Ti(t,n,e[n]);if(Cc)for(var n of Cc(e))lC.call(e,n)&&Ti(t,n,e[n]);return t},aC=(t,e)=>oC(t,sC(e)),Tn=(t,e,n)=>(Ti(t,typeof e!="symbol"?e+"":e,n),n);class ns extends Ma{constructor(){super(...arguments),Tn(this,"_dotPattern",null),Tn(this,"_lastColor",null),Tn(this,"backgroundImage","textbox"),Tn(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height}get width(){return this.obj.width}get innerHeight(){return this.obj.height-Nt*2}get innerWidth(){return this.obj.width-Nt*2}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Ds}get nameboxHeight(){return ro}get nameboxOffsetX(){return Ls}get nameboxOffsetY(){return rl}get nameboxStyle(){return aC(iC({},ll),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return Ms}get textOffsetY(){return sl}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:zf}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Te.fromCss(this.customColor).toHSL().shift(Gf).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Te.fromCss(this.customColor).toHSL().shift(Xf).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Dn(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),bv(e,n,o,s,r,Kf),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Te.fromCss(this.nameboxBackgroundColor),i=new Te(a.r,a.g,a.b,.95),u=i.toHSL().shift(qf).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(Yf,i.toCss()),l.addColorStop(1,u.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=Te.fromCss(this.customColor),s=o.toHSL(),r=this.obj.height-Nt*2-n,l=this.obj.width-Nt*2;Dn(e,()=>{e.beginPath(),Nr(e,0,n,l,r,gi),e.clip();const i=e.createLinearGradient(0,n,0,r);i.addColorStop(0,o.toCss()),i.addColorStop(1,`rgba(${o.r},${o.g},${o.b},0.6667)`),e.fillStyle=i,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,l,r),Dn(e,()=>{e.translate(0,n),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(-Nt,-Nt,l,r)});const u=e.createLinearGradient(0,n+r-mi,0,n+r);u.addColorStop(0,"rgba(255,255,255,0.3137)"),u.addColorStop(.5,"rgba(255,255,255,0.0627)"),u.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=u,e.beginPath(),e.ellipse(l/2,n+r,np,mi,0,0,2*Math.PI),e.closePath(),e.fill()});const a=s.shift(Jf).toRgb().toCss();e.strokeStyle=a,e.lineWidth=Qf,e.beginPath(),Nr(e,0,n,l,r,gi),e.stroke()}render(e){const n=this.obj.height-Nt*2,o=this.obj.width-Nt*2;e.translate(Nt,Nt),this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-fa;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-ga,y:s-ma})}getDotPattern(e=Zf){if(this._dotPattern&&this._lastColor===this.customColor)return this._dotPattern;const{dotPatternSize:n,dotColorDelta:o,dotRadius:s}=e,r=Te.fromCss(this.customColor).toHSL(),l=lo();l.height=n,l.width=n;const a=l.getContext("2d");if(!a)throw new Error("Failed to create canvas for textbox dot-pattern. Out of memory?");a.fillStyle=r.shift(o).toRgb().toCss();function i(c,f){a.beginPath(),a.ellipse(c,f,s,s,0,0,2*Math.PI),a.closePath(),a.fill()}i(0,0),i(n,0),i(0,n),i(n,n),i(n/2,n/2);const u=a.createPattern(l,"repeat");if(!u)throw new Error("Failed to create textbox dot-pattern. Out of memory?");return this._dotPattern=u,u}}Tn(ns,"id","custom");Tn(ns,"label","Custom");Tn(ns,"priority",0);Tn(ns,"gameMode","ddlc");var uC=Object.defineProperty,cC=(t,e,n)=>e in t?uC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wv=(t,e,n)=>(cC(t,typeof e!="symbol"?e+"":e,n),n),dC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Pv=class{constructor(t){this.base=t,wv(this,"nextArrow",null)}static get resizable(){return!1}static get defaultWidth(){return Ca}static get defaultHeight(){return Pp+ka}static get defaultX(){return le().Base.screenWidth/2}static get defaultY(){return le().Base.screenHeight-this.defaultHeight/2-le().TextBox.TextBoxBottomSpacing}get obj(){return this.base.obj}get refObject(){return this.base.refObject}getControlsStyle(){return Ir}getControlsDisabledStyle(){return Ep}renderControls(t,e){const n=le(),o=this.width,s=o/2,l=(this.base.obj.flip?n.Base.screenWidth-this.base.obj.x:this.base.obj.x)-s,a=this.getControlsStyle(),i=["History","Skip","Auto","Save","Load","Settings"],u=[];let c=0;for(const v of i){const g=Pv.controlWidth(t,v);u.push(g),c+=g}const f=Math.min((o-c)/(i.length+2),78);let h=l+(o-c-f*(i.length-1))/2;for(let v=0;v<i.length;++v){const g=i[v],b=u[v],w=g==="Skip"&&!this.base.obj.skip?this.getControlsDisabledStyle():a;Cs(t,w),t.fillText(g,h,e),h+=b+f}}static controlWidth(t,e){if(this.widthCache[e])return this.widthCache[e];Cs(t,Ir);const n=t.measureText(e).width;return this.widthCache[e]=n,n}prepare(){if(!(this.nextArrow instanceof oo))return(()=>dC(this,null,function*(){this.nextArrow=yield As("next_plus")}))()}};let Cv=Pv;wv(Cv,"widthCache",{});var fC=Object.defineProperty,pC=Object.defineProperties,hC=Object.getOwnPropertyDescriptors,xc=Object.getOwnPropertySymbols,vC=Object.prototype.hasOwnProperty,gC=Object.prototype.propertyIsEnumerable,Ai=(t,e,n)=>e in t?fC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mC=(t,e)=>{for(var n in e||(e={}))vC.call(e,n)&&Ai(t,n,e[n]);if(xc)for(var n of xc(e))gC.call(e,n)&&Ai(t,n,e[n]);return t},bC=(t,e)=>pC(t,hC(e)),An=(t,e,n)=>(Ai(t,typeof e!="symbol"?e+"":e,n),n);class Fs extends Cv{constructor(){super(...arguments),An(this,"_lastColor",null),An(this,"_dotPattern",null),An(this,"backgroundImage","textbox"),An(this,"xOffset",0)}static get resizable(){return!0}get height(){return this.obj.height}get width(){return this.obj.width}get innerHeight(){return this.obj.height-ln*2}get innerWidth(){return this.obj.width-ln*2}get nameboxWidth(){return this.refObject&&this.refObject.nameboxWidth!==null?this.refObject.nameboxWidth:this.obj.customNameboxWidth!==null?this.obj.customNameboxWidth:Oa}get nameboxHeight(){return ka}get nameboxOffsetX(){return $a}get nameboxOffsetY(){return xp}get nameboxStyle(){return bC(mC({},Ap),{strokeColor:this.nameboxOutlineColor,color:"#FFFFFF"})}get textOffsetX(){return xa}get textOffsetY(){return Cp}get textboxStyle(){return Rp}get customColor(){if(this.obj.overrideColor)return this.obj.customColor;const e=this.refObject;return e!=null&&e.textboxColor!=null?e.textboxColor:cp}get nameboxOutlineColor(){return this.obj.deriveCustomColors?Te.fromCss(this.customColor).toHSL().shift(dp).toRgb().toCss():this.obj.customNameboxStroke}get nameboxBackgroundColor(){return this.obj.deriveCustomColors?Te.fromCss(this.customColor).toHSL().shift(fp).toRgb().toCss():this.obj.customNameboxColor}renderNamebox(e,n,o){Dn(e,()=>{const s=this.nameboxWidth,r=this.nameboxHeight;e.beginPath(),bv(e,n,o,s,r,vp),e.clip();const l=e.createLinearGradient(n,o,n,o+r),a=Te.fromCss(this.nameboxBackgroundColor),i=new Te(a.r,a.g,a.b,.95),u=i.toHSL().shift(hp).toRgb();l.addColorStop(0,i.toCss()),l.addColorStop(pp,i.toCss()),l.addColorStop(1,u.toCss()),e.fillStyle=l,e.fillRect(n,o,this.obj.width,r)})}renderBackdrop(e,n){const o=this.obj.height-ln*2-n,s=this.obj.width-ln*2,r=Te.fromCss(this.customColor).toHSL();Dn(e,()=>{e.beginPath(),Nr(e,0,n,s,o,bi),e.clip();const a=e.createLinearGradient(0,n,0,n+o),i=Te.fromHex(this.customColor);a.addColorStop(0,i.toCss()),a.addColorStop(1,`rgba(${i.r},${i.g},${i.b},0.6667)`),e.fillStyle=a,e.strokeStyle="#ffdfee",e.lineWidth=6,e.fillRect(0,n,s,o),e.strokeRect(0,n,s,o),e.fillStyle=this.getDotPattern(),e.globalCompositeOperation="source-atop",e.fillRect(0,n,s,o);const u=e.createLinearGradient(0,n+o-yi,0,n+o);u.addColorStop(0,"rgba(255,255,255,0.3137)"),u.addColorStop(.5,"rgba(255,255,255,0.0627)"),u.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=u,e.beginPath(),e.ellipse(s/2,n+o,Tp,yi,0,0,2*Math.PI),e.closePath(),e.fill()});const l=r.shift(gp).toRgb().toCss();e.strokeStyle=l,e.lineWidth=mp,e.beginPath(),Nr(e,0,n,s,o,bi),e.stroke()}render(e){const n=this.obj.height-ln*2,o=this.obj.width-ln*2;e.translate(ln,ln),this.obj.talkingObjId!==null&&this.renderNamebox(e,this.nameboxOffsetX,0),this.renderBackdrop(e,this.nameboxHeight);const s=n,r=s-kp;this.obj.controls&&this.renderControls(e,r),this.obj.continue&&this.nextArrow&&this.nextArrow.paintOnto(e,{x:o-Ip,y:s-jp})}getDotPattern(){return ns.prototype.getDotPattern.call(this,bp)}}An(Fs,"id","custom_plus");An(Fs,"label","Custom (Plus)");An(Fs,"priority",0);An(Fs,"gameMode","ddlc_plus");var yC=Object.defineProperty,_C=(t,e,n)=>e in t?yC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_l=(t,e,n)=>(_C(t,typeof e!="symbol"?e+"":e,n),n),wC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});class Hs extends Ma{static get resizable(){return!0}get height(){return ol+ro}get width(){return Ko}get nameboxWidth(){return Ds}get nameboxHeight(){return ro}get nameboxOffsetX(){return Ls}get nameboxOffsetY(){return rl}get nameboxStyle(){return ll}get textOffsetX(){return Ms}get textOffsetY(){return sl}get textboxStyle(){return _a}render(e){return wC(this,null,function*(){})}}_l(Hs,"id","none");_l(Hs,"label","None");_l(Hs,"priority",0);_l(Hs,"gameMode","ddlc");var PC=Object.defineProperty,CC=(t,e,n)=>e in t?PC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cs=(t,e,n)=>(CC(t,typeof e!="symbol"?e+"":e,n),n);const xC=[ts,Ns,ns,Hs,Fs],xs=(()=>{const t={};for(const e of xC)t[e.id]=e;return t})();class kC extends yl{constructor(){super(...arguments),cs(this,"nbTextRenderer",null),cs(this,"textRenderer",null),cs(this,"_lastRefVars",null),cs(this,"refObject",null),cs(this,"_lastRenderer",null)}getRefVars(){const e=this.refObject;return e?JSON.stringify([e.label,e.textboxColor,e.nameboxWidth]):null}getName(){var e,n;return this.obj.talkingObjId==="$other$"?this.obj.talkingOther:(n=(e=this.refObject)==null?void 0:e.label)!=null?n:"Missing name"}prepareRender(e,n,o){var s;const r=super.prepareRender(e,n,o),l=this.textboxRenderer.prepare();typeof this.obj.talkingObjId=="number"&&(this.refObject=(s=e.objects[this.obj.talkingObjId])!=null?s:null);const a=this.getRefVars();a!==this._lastRefVars&&(this.localCanvasInvalid=!0,this._lastRefVars=a),this.nbTextRenderer=new Ot(this.getName(),this.textboxRenderer.nameboxStyle),this.textRenderer=new Ot(this.obj.text,this.textboxRenderer.textboxStyle);const i=this.nbTextRenderer.loadFonts(),u=this.textRenderer.loadFonts();if(!(!r&&!l&&!i&&!u))return Promise.all([r,l,i,u])}renderLocal(e,n){const o=this.textboxRenderer,s=o.width;if(!this.obj.overflow){const r=new Path2D;r.rect(0,0,o.width,this.height),e.clip(r)}o.render(e),this.obj.talkingObjId!==null&&this.renderName(e,o.nameboxOffsetX,0),this.renderText(e,0,0,this.obj.autoWrap?s:0)}renderName(e,n,o){const s=this.textboxRenderer,r=s.nameboxWidth;this.nbTextRenderer.fixAlignment("center",n,n+r,o+s.nameboxOffsetY,0),this.nbTextRenderer.render(e)}renderText(e,n,o,s){const r=this.textboxRenderer,l=this.textRenderer;this.obj.autoQuoting&&this.obj.talkingObjId!==null&&l.quote(),l.fixAlignment("left",n+r.textOffsetX,0,o+r.nameboxHeight+r.textOffsetY,s-r.textOffsetX*2),l.render(e)}get forcedStyle(){const e=this.refObject;return(this.obj.style==="normal"||this.obj.style==="normal_plus")&&e&&(e.textboxColor!=null||e.nameboxWidth!=null)?"custom":this.obj.style}get textboxRenderer(){const e=this.forcedStyle,n=xs[e];if(this._lastRenderer&&this._lastRenderer.constructor===n)return this._lastRenderer;const o=new n(this);return this._lastRenderer=o,o}}var OC=Object.defineProperty,$C=(t,e,n)=>e in t?OC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hr=(t,e,n)=>($C(t,typeof e!="symbol"?e+"":e,n),n),SC=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const xv=class{constructor(t,e,n,o){this.store=t,this._panelId=e,this.canvasWidth=n,this.canvasHeight=o,hr(this,"renderObjectCache",new Map),hr(this,"renderer"),hr(this,"_disposed",!1),this.renderer=new ah(n,o)}get panelId(){return this._panelId}setPanelId(t){if(this._disposed)throw new Error("Disposed scene-renderer called");this._panelId!==t&&(this._panelId=t,this.renderObjectCache.forEach(e=>{e.dispose()}),this.renderObjectCache.clear())}render(t,e,n){if(this._disposed)throw new Error("Disposed scene-renderer called");return this.panel?this.renderer.render(this.renderCallback.bind(this,n),t,e):Promise.resolve(!1)}download(){if(this._disposed)throw new Error("Disposed scene-renderer called");const t=new Date,e=`panel-${[t.getFullYear(),`${t.getMonth()+1}`.padStart(2,"0"),`${t.getDate()}`.padStart(2,"0"),`${t.getHours()}`.padStart(2,"0"),`${t.getMinutes()}`.padStart(2,"0"),`${t.getSeconds()}`.padStart(2,"0")].join("-")}.png`;return this.renderer.download(this.renderCallback.bind(this,!0),e)}paintOnto(t,e){this.renderer.paintOnto(t,e)}objectsAt(t,e){const n=new DOMPointReadOnly(t,e);return this.getRenderObjects().filter(o=>o.hitTest(n)).map(o=>o.id)}getLastRenderObject(t){var e;return(e=this.renderObjectCache.get(t))!=null?e:null}renderCallback(t,e){return SC(this,null,function*(){var n,o;if(this._disposed)throw new Error("Disposed scene-renderer called");e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",yield(n=this.getBackgroundRenderer())==null?void 0:n.render(e);const s=this.getRenderObjects(),r=new Map,l=new Map;for(const v of s){const g=v.linkedTo;let b=new DOMMatrixReadOnly;if(g!=null){const w=l.get(g);if(w)b=w;else{const $=r.get(g);$?$.push(v):r.set(g,[v]);continue}}h(v,b)}r.size>0&&console.warn("Not all renderables processed. Infinite loop?");const a=s.map(v=>v.prepareRender(this.panel,this.store,!e.hq)).filter(v=>v!==void 0);a.length>0&&(yield Promise.all(a));const i=this.store.state.ui.selection,u=new Set;i!==null&&f(i,u);const c=(o=document.querySelector(xv.FocusProp))==null?void 0:o.getAttribute("data-obj-id");for(const v of s){const g=i===v.id,b=c===""+v.id;v.render(e.fsCtx,(g?un.Selected:u.has(v.id)?un.Indirectly:un.None)+(b?un.Focused:un.None),e.preview,e.hq,t)}e.applyFilters([...this.panel.filters]),e.preview&&e.drawImage({x:0,y:0,h:this.canvasHeight,w:this.canvasWidth,composite:"destination-over",image:yield As("backgrounds/transparent")});function f(v,g){g.add(v);for(const b of s.filter(w=>w.linkedTo===v))f(b.id,g)}function h(v,g){const b=v.prepareTransform(g);l.set(v.id,b);const w=r.get(v.id);if(w){for(const $ of w)h($,b);r.delete(v.id)}}})}getRenderObjects(){const t=this.store.state.panels.panels[this.panelId],e=[...t.order,...t.onTopOrder],n=t.objects,o=Array.from(this.renderObjectCache.keys()).filter(s=>!e.includes(s));for(const s of o)this.renderObjectCache.get(s).dispose(),this.renderObjectCache.delete(s);return e.map(s=>{let r=this.renderObjectCache.get(s);if(!r){const l=n[s],a=l.type;switch(a){case"sprite":r=new X1(l);break;case"character":{const i=l;r=new y1(i,dl(this.store,i));break}case"textBox":r=new kC(l);break;case"choice":r=new B1(l);break;case"notification":r=new L1(l);break;case"poem":r=new G1(l);break;default:throw new Rt.UnreachableCaseError(a)}this.renderObjectCache.set(s,r)}return r})}get panel(){return this.store.state.panels.panels[this.panelId]}getBackgroundRenderer(){const t=this.panel;switch(t.background.current){case"buildin.static-color":return fc.color=t.background.color,fc;default:{const n=this.store.getters["content/getBackgrounds"].get(t.background.current);if(!n)return null;const o=n.variants[t.background.variant];return new f1(t.background.current,o,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters)}}}get disposed(){return this._disposed}dispose(){this._disposed=!0,this.renderer.dispose()}};let Fr=xv;hr(Fr,"FocusProp",typeof CSS!="undefined"&&CSS.supports("selector(:focus-visible)")?":focus-visible":":focus");let tr=null;function Vo(t){if(tr===null||tr.disposed){if(t.state.panels.currentPanel===-1)return null;const e=le().Base;tr=new Fr(t,t.state.panels.currentPanel,e.screenWidth,e.screenHeight)}return tr}var IC=Object.defineProperty,jC=Object.defineProperties,TC=Object.getOwnPropertyDescriptors,kc=Object.getOwnPropertySymbols,AC=Object.prototype.hasOwnProperty,EC=Object.prototype.propertyIsEnumerable,Oc=(t,e,n)=>e in t?IC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,RC=(t,e)=>{for(var n in e||(e={}))AC.call(e,n)&&Oc(t,n,e[n]);if(kc)for(var n of kc(e))EC.call(e,n)&&Oc(t,n,e[n]);return t},BC=(t,e)=>jC(t,TC(e));const MC={setChoicesProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version},setChoiceProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices[e.choiceIdx][e.key]=e.value,++n.version},setChoices(t,e){const n=t.panels[e.panelId].objects[e.id];n.choices=e.choices,++n.version}},DC={createChoice({commit:t,rootState:e,state:n},o){const s=le(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:BC(RC({},es()),{y:s.Choices.ChoiceY,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,id:r,onTop:!0,autoWrap:!0,type:"choice",choiceDistance:s.Choices.ChoiceSpacing,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:s.Choices.ChoiceButtonColor})}),r},addChoice({state:t,commit:e},n){const o=t.panels[n.panelId].objects[n.id];e("setChoices",{id:n.id,panelId:n.panelId,choices:[...o.choices,{selected:!1,text:n.text}]})},removeChoice({state:t,commit:e},n){const s=[...t.panels[n.panelId].objects[n.id].choices];s.splice(n.choiceIdx,1),s.length===0&&s.push({selected:!1,text:""}),e("setChoices",{id:n.id,panelId:n.panelId,choices:s})}};var LC=Object.defineProperty,NC=Object.defineProperties,FC=Object.getOwnPropertyDescriptors,$c=Object.getOwnPropertySymbols,HC=Object.prototype.hasOwnProperty,UC=Object.prototype.propertyIsEnumerable,Sc=(t,e,n)=>e in t?LC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,VC=(t,e)=>{for(var n in e||(e={}))HC.call(e,n)&&Sc(t,n,e[n]);if($c)for(var n of $c(e))UC.call(e,n)&&Sc(t,n,e[n]);return t},WC=(t,e)=>NC(t,FC(e));const zC={setNotificationProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},GC={createNotification({commit:t,rootState:e,state:n},o){const s=le(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:WC(VC({},es()),{y:s.Base.screenHeight/2,width:s.Choices.ChoiceButtonWidth,height:0,panelId:e.panels.currentPanel,autoWrap:!1,id:r,onTop:!0,type:"notification",customColor:s.Choices.ChoiceButtonColor,text:"Click here to edit notification",backdrop:!0})}),r}};var XC=Object.defineProperty,YC=Object.defineProperties,qC=Object.getOwnPropertyDescriptors,Ic=Object.getOwnPropertySymbols,KC=Object.prototype.hasOwnProperty,JC=Object.prototype.propertyIsEnumerable,jc=(t,e,n)=>e in t?XC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QC=(t,e)=>{for(var n in e||(e={}))KC.call(e,n)&&jc(t,n,e[n]);if(Ic)for(var n of Ic(e))JC.call(e,n)&&jc(t,n,e[n]);return t},ZC=(t,e)=>YC(t,qC(e));const ex={setPoemProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},tx={createPoem({commit:t,rootState:e,state:n},o){const s=le(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:{subType:"poem",x:s.Poem.defaultX,y:s.Poem.defaultY,width:s.Poem.defaultPoemWidth,height:s.Poem.defaultPoemHeight,panelId:e.panels.currentPanel,flip:!1,rotation:0,id:r,onTop:!0,opacity:100,type:"poem",version:0,autoWrap:!0,background:s.Poem.defaultPoemBackground,font:s.Poem.defaultPoemStyle,text:`New poem

Click here to edit poem`,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,scaleX:1,scaleY:1,skewX:0,skewY:0,ratio:1,preserveRatio:!0,consoleColor:s.Poem.consoleBackgroundColor,overflow:!1,linkedTo:null}}),r},createConsole({commit:t,rootState:e,state:n},o){const s=le(),r=n.panels[o.panelId].lastObjId+1;return t("create",{object:ZC(QC({},es()),{subType:"console",x:s.Poem.consoleWidth/2,y:s.Poem.consoleHeight/2,width:s.Poem.consoleWidth,height:s.Poem.consoleHeight,panelId:e.panels.currentPanel,id:r,onTop:!0,type:"poem",background:s.Poem.defaultConsoleBackground,font:s.Poem.defaultConsoleStyle,text:`> _
  
  Console command
  Click here to edit`,autoWrap:!0,consoleColor:s.Poem.consoleBackgroundColor})}),r}};var nx=Object.defineProperty,ox=Object.defineProperties,sx=Object.getOwnPropertyDescriptors,Tc=Object.getOwnPropertySymbols,rx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Ac=(t,e,n)=>e in t?nx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ix=(t,e)=>{for(var n in e||(e={}))rx.call(e,n)&&Ac(t,n,e[n]);if(Tc)for(var n of Tc(e))lx.call(e,n)&&Ac(t,n,e[n]);return t},ax=(t,e)=>ox(t,sx(e)),ux=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const cx={},dx={createSprite(t,e){return ux(this,arguments,function*({commit:n,rootState:o,state:s},r){const l=yield aa(r.assets[0],!1);if(!(l instanceof oo))return;const a=s.panels[r.panelId].lastObjId+1;return n("create",{object:ax(ix({},es()),{assets:r.assets,height:l.height,width:l.width,id:a,panelId:o.panels.currentPanel,onTop:!1,type:"sprite",y:le().Base.screenHeight/2,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})}),a})}};function Ec(t,e,n,o,s){const r=Math.cos(s),l=Math.sin(s),a=t-n,i=e-o,u=r*a-l*i+n,c=l*a+r*i+o;return[u,c]}var fx=Object.defineProperty,px=Object.defineProperties,hx=Object.getOwnPropertyDescriptors,Rc=Object.getOwnPropertySymbols,vx=Object.prototype.hasOwnProperty,gx=Object.prototype.propertyIsEnumerable,Bc=(t,e,n)=>e in t?fx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wl=(t,e)=>{for(var n in e||(e={}))vx.call(e,n)&&Bc(t,n,e[n]);if(Rc)for(var n of Rc(e))gx.call(e,n)&&Bc(t,n,e[n]);return t},Mc=(t,e)=>px(t,hx(e)),mx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Dc=4,bx={setTalkingObject(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther(t,e){const n=t.panels[e.panelId].objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setResetBounds(t,e){const n=t.panels[e.panelId].objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,++n.version},setTextBoxProperty(t,e){const n=t.panels[e.panelId].objects[e.id];n[e.key]=e.value,++n.version}},yx={createTextBox({commit:t,state:e,rootState:n},o){var s;const r=le(),l=e.panels[o.panelId].lastObjId+1,a=r.TextBox.DefaultTextboxStyle,i=xs[a],u=o.resetBounds||{x:i.defaultX,y:i.defaultY,width:i.defaultWidth,height:i.defaultHeight,rotation:0};return t("create",{object:Mc(Wl(Wl({},es()),u),{panelId:n.panels.currentPanel,id:l,onTop:!0,type:"textBox",continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:"custom",overrideColor:!1,customColor:r.TextBoxCustom.textboxDefaultColor,deriveCustomColors:!0,customControlsColor:r.TextBoxCustom.controlsDefaultColor,customNameboxColor:r.TextBoxCustom.nameboxDefaultColor,customNameboxWidth:null,customNameboxStroke:r.TextBoxCustom.nameboxStrokeDefaultColor,talkingObjId:null,talkingOther:"",text:(s=o.text)!=null?s:"Click here to edit the textbox",resetBounds:u,overflow:!1})}),l},setStyle({state:t,commit:e},n){const o=le(),s=t.panels[n.panelId].objects[n.id],r=xs[s.style],l=xs[n.style],a=10;let i=!1;const u={panelId:n.panelId,id:n.id,x:s.x,y:s.y};let c=!1;const f={panelId:n.panelId,id:n.id,width:s.width,height:s.height};l.resizable?(r.defaultWidth!==l.defaultWidth&&(c=!0,f.width=Math.max(f.width+l.defaultWidth-r.defaultWidth,a)),r.defaultHeight!==l.defaultHeight&&(c=!0,f.height=Math.max(f.height+l.defaultHeight-r.defaultHeight,a))):(c=!0,f.width=l.defaultWidth,f.height=l.defaultHeight),r.defaultX!==l.defaultX&&(i=!0,u.x=jr(-f.width+a,u.x+l.defaultX-r.defaultX,o.Base.screenWidth-a)),r.defaultY!==l.defaultY&&(i=!0,u.y=jr(-f.height+a,u.y+l.defaultY-r.defaultY,o.Base.screenHeight-a)),i&&e("setPosition",u),c&&e("setSize",f),e("setTextBoxProperty",kv(n.panelId,n.id,"style",n.style))},resetTextboxBounds({commit:t,state:e},n){const o=e.panels[n.panelId].objects[n.id];t("setPosition",{panelId:n.panelId,id:n.id,x:o.resetBounds.x,y:o.resetBounds.y}),t("setSize",{panelId:n.panelId,id:n.id,height:o.resetBounds.height,width:o.resetBounds.width}),t("setRotation",{panelId:n.panelId,id:n.id,rotation:o.resetBounds.rotation})},splitTextbox(t,e){return mx(this,arguments,function*({commit:n,state:o,dispatch:s},r){const l=o.panels[r.panelId].objects[r.id];if(l.type!=="textBox")return;const a=(l.width-Dc)/2,i=a/2+Dc/2,u=[l.x,l.y];let c=[l.x-i,l.y],f=[l.x+i,l.y];l.rotation!==0&&(c=Ec(c[0],c[1],u[0],u[1],l.rotation/180*Math.PI),f=Ec(f[0],f[1],u[0],u[1],l.rotation/180*Math.PI)),n("setResetBounds",{id:r.id,panelId:r.panelId,resetBounds:{x:c[0],y:c[1],width:a,height:l.height,rotation:l.rotation}});const h=l.style==="custom_plus"?"custom_plus":"custom";l.style!==h&&(yield s("setStyle",Mc(Wl({},r),{style:h})));const v=yield s("createTextBox",{panelId:r.panelId,resetBounds:{x:f[0],y:f[1],width:a,height:l.height,rotation:l.rotation}});yield s("setStyle",{panelId:r.panelId,id:v,style:h}),l.flip&&n("setFlip",{id:v,panelId:r.panelId,flip:l.flip})})}};function kv(t,e,n,o){return{id:e,panelId:t,key:n,value:o}}var _x=Object.defineProperty,Lc=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,Px=Object.prototype.propertyIsEnumerable,Nc=(t,e,n)=>e in t?_x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cx=(t,e)=>{for(var n in e||(e={}))wx.call(e,n)&&Nc(t,n,e[n]);if(Lc)for(var n of Lc(e))Px.call(e,n)&&Nc(t,n,e[n]);return t};const Fc=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function Ei(t,e,n){const s=[...e().filters];let r;switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:throw new Rt.UnreachableCaseError(t.type)}s.splice(t.idx,0,r),n({panelId:t.panelId,id:t.id,filters:s})}function Ri(t,e,n){const s=[...e().filters];s.splice(t.idx,1),n({id:t.id,panelId:t.panelId,filters:s})}function Bi(t,e,n){const s=[...e().filters],r=s[t.idx];s.splice(t.idx,1),s.splice(t.idx+t.moveBy,0,r),n({id:t.id,panelId:t.panelId,filters:s})}function Mi(t,e,n){const s=[...e().filters],r=Cx({},s[t.idx]);s[t.idx]=r,r.type==="drop-shadow"?(t.blurRadius!==void 0&&(r.blurRadius=t.blurRadius),t.color!==void 0&&(r.color=t.color),t.offsetX!==void 0&&(r.offsetX=t.offsetX),t.offsetY!==void 0&&(r.offsetY=t.offsetY)):r.value=t.value,n({id:t.id,panelId:t.panelId,filters:s})}var xx=Object.defineProperty,kx=Object.defineProperties,Ox=Object.getOwnPropertyDescriptors,Hc=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,Sx=Object.prototype.propertyIsEnumerable,Uc=(t,e,n)=>e in t?xx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gt=(t,e)=>{for(var n in e||(e={}))$x.call(e,n)&&Uc(t,n,e[n]);if(Hc)for(var n of Hc(e))Sx.call(e,n)&&Uc(t,n,e[n]);return t},Vc=(t,e)=>kx(t,Ox(e));const Ix=gt(gt(gt(gt(gt(gt({create(t,{object:e}){const n=t.panels[e.panelId];e.id>n.lastObjId&&(n.lastObjId=e.id),n.objects[e.id]=e,(e.onTop?n.onTopOrder:n.order).push(e.id)},removeFromList(t,e){const n=t.panels[e.panelId],o=e.onTop?n.onTopOrder:n.order,s=o.indexOf(e.id);o.splice(s,1)},addToList(t,e){const n=t.panels[e.panelId];(e.onTop?n.onTopOrder:n.order).splice(e.position,0,e.id)},setOnTop(t,e){const o=t.panels[e.panelId].objects[e.id];o.onTop=e.onTop},setPosition(t,e){const o=t.panels[e.panelId].objects[e.id];o.x=on(e.x),o.y=on(e.y)},setLink(t,e){const n=t.panels[e.panelId],o=n.objects[e.id];let s=n.objects[e.link];if(!s&&e.link)throw new Error("Linked object does not exist.");if(s===o)throw new Error("Object cannot link to itself.");for(;s;)if(s=n.objects[s.linkedTo],s===o)throw new Error("Objects cannot be linked recursively.");o.linkedTo=e.link,o.x=on(e.x),o.y=on(e.y),o.rotation=on(e.rotation),o.scaleX=on(e.scaleX),o.scaleY=on(e.scaleY),o.skewX=on(e.skewX),o.skewY=on(e.skewY)},setFlip(t,e){const o=t.panels[e.panelId].objects[e.id];o.flip=e.flip},setSize(t,e){const o=t.panels[e.panelId].objects[e.id];o.width=Math.round(e.width*100)/100,o.height=Math.round(e.height*100)/100,++o.version},setRatio(t,e){const o=t.panels[e.panelId].objects[e.id];o.preserveRatio=e.preserveRatio,o.ratio=e.ratio},setRotation(t,e){const o=t.panels[e.panelId].objects[e.id];o.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject(t,e){const n=t.panels[e.panelId];delete n.objects[e.id]},setComposition(t,e){const o=t.panels[e.panelId].objects[e.id];o.composite=e.composite},object_setFilters(t,e){const o=t.panels[e.panelId].objects[e.id];o.filters=e.filters},setLabel(t,e){const o=t.panels[e.panelId].objects[e.id];o.label=e.label,++o.version},setTextboxColor(t,e){const o=t.panels[e.panelId].objects[e.id];o.textboxColor=e.textboxColor,++o.version},setEnlargeWhenTalking(t,e){const o=t.panels[e.panelId].objects[e.id];o.enlargeWhenTalking=e.enlargeWhenTalking,++o.version},setObjectNameboxWidth(t,e){const o=t.panels[e.panelId].objects[e.id];o.nameboxWidth=e.nameboxWidth,++o.version},setObjectScale(t,e){const o=t.panels[e.panelId].objects[e.id];o.scaleX=e.scaleX,o.scaleY=e.scaleY,++o.version},setObjectSkew(t,e){const o=t.panels[e.panelId].objects[e.id];o.skewX=e.skewX<0?180-Math.abs(e.skewX)%180:e.skewX%180,o.skewY=e.skewY<0?180-Math.abs(e.skewY)%180:e.skewY%180,++o.version},setOverflow(t,e){const o=t.panels[e.panelId].objects[e.id];"overflow"in o&&(o.overflow=e.overflow,++o.version)}},cx),n1),bx),MC),zC),ex),jx=gt(gt(gt(gt(gt(gt({removeObject({state:t,commit:e,rootState:n},o){var s;const r=t.panels[o.panelId],l=r.objects[o.id];n.ui.selection===o.id&&e("ui/setSelection",null,{root:!0});for(const a of[...r.onTopOrder,...r.order]){if(l.id===a)continue;const i=r.objects[a];if(i.linkedTo===l.id){const u=Vo(null),c=u==null?void 0:u.getLastRenderObject(i.id);c?e("setLink",gt({panelId:o.panelId,id:i.id,link:null},Tr(c.preparedTransform))):e("setLink",{panelId:o.panelId,id:i.id,link:null,rotation:i.rotation,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,x:i.x,y:i.y})}i.type==="textBox"&&i.talkingObjId===l.id&&e("setTalkingOther",{id:i.id,talkingOther:(s=l.label)!=null?s:"",panelId:o.panelId})}e("removeFromList",{id:o.id,panelId:o.panelId,onTop:l.onTop}),e("removeObject",{id:o.id,panelId:o.panelId})},setPosition({state:t,commit:e,dispatch:n},o){t.panels[o.panelId].objects[o.id].type==="character"?n("setCharacterPosition",o):e("setPosition",o)},setOnTop({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id];s.onTop!==n.onTop&&(e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{id:n.id,panelId:n.panelId,position:(n.onTop?o.onTopOrder:o.order).length,onTop:n.onTop}),e("setOnTop",{panelId:n.panelId,id:n.id,onTop:n.onTop}))},shiftLayer({state:t,commit:e},n){const o=t.panels[n.panelId],s=o.objects[n.id],r=s.onTop?o.onTopOrder:o.order;let a=r.indexOf(s.id)+n.delta;a<0&&(a=0),a>r.length&&(a=r.length),e("removeFromList",{panelId:n.panelId,id:n.id,onTop:s.onTop}),e("addToList",{panelId:n.panelId,id:n.id,position:a,onTop:s.onTop})},setPreserveRatio({commit:t,state:e},n){const s=e.panels[n.panelId].objects[n.id],r=n.preserveRatio?s.width/s.height:0;t("setRatio",{panelId:n.panelId,id:n.id,preserveRatio:n.preserveRatio,ratio:r})},copyObjects({commit:t,state:e},{sourcePanelId:n,targetPanelId:o}){const s=e.panels[n],r=e.panels[o],l=[...s.onTopOrder,...s.order],a=new Map;let i=r.lastObjId;for(const u of l){const c=++i;a.set(u,c)}for(const u of l){const c=s.objects[u],f=JSON.parse(JSON.stringify(c));if("talkingObjId"in f){const h=f;h.talkingObjId!==null&&h.talkingObjId!=="$other$"&&a.has(h.talkingObjId)&&(h.talkingObjId=a.get(h.talkingObjId))}t("create",{object:Vc(gt({},f),{id:a.get(u),panelId:o})})}},copyObjectToClipboard({commit:t,state:e},{id:n,panelId:o}){const s=e.panels[o],r=s.objects[n],l=Object.values(s.objects),a=[r];i(r);function i(u,c=!0){if(!c&&u===r)throw new Error("Recursively linked object");for(const f of l)f.linkedTo===u.id&&(a.push(f),i(f,!1))}t("ui/setClipboard",JSON.stringify(a),{root:!0})},pasteObjectFromClipboard({commit:t,state:e,rootState:n}){var o;if(n.ui.clipboard==null)return;const s=JSON.parse(n.ui.clipboard),r=e.panels[e.currentPanel],l=new Map;let a=r.lastObjId;for(const i of s){const u=++a;l.set(i.id,u),i.id=u}for(const i of s)i.linkedTo!=null&&(i.linkedTo=(o=l.get(i.linkedTo))!=null?o:null),t("create",{object:Vc(gt({},i),{panelId:e.currentPanel})})},object_addFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_removeFilter({state:t,commit:e},n){Ri(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_moveFilter({state:t,commit:e},n){Bi(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))},object_setFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId].objects[n.id],o=>e("object_setFilters",o))}},dx),s1),yx),DC),GC),tx);function Tx(t,e){const n=t.state.panels;for(const o in n){const s=n[o];for(const r in s.objects){const l=s.objects[r];if(l.type==="character"){r1(t,l.panelId,l.id,e);return}}}}function on(t){return Math.round(t*100)/100}var Ax=Object.defineProperty,Ex=Object.defineProperties,Rx=Object.getOwnPropertyDescriptors,Wc=Object.getOwnPropertySymbols,Bx=Object.prototype.hasOwnProperty,Mx=Object.prototype.propertyIsEnumerable,zc=(t,e,n)=>e in t?Ax(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zl=(t,e)=>{for(var n in e||(e={}))Bx.call(e,n)&&zc(t,n,e[n]);if(Wc)for(var n of Wc(e))Mx.call(e,n)&&zc(t,n,e[n]);return t},Dx=(t,e)=>Ex(t,Rx(e)),vr=(t=>(t[t.None=0]="None",t[t.Stretch=1]="Stretch",t[t.Cover=2]="Cover",t))(vr||{});const Lx="buildin.transparent",nr={panelToUrl:new Map,urlToPanel:new Map,register(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister(t,e){if(this.urlToPanel.has(e)){const n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),n.length===0&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},Nx={namespaced:!0,state:{lastPanelId:-1,panels:{},panelOrder:[],currentPanel:null},mutations:zl({setCurrentPanel(t,{panelId:e}){t.currentPanel=e},setPanelPreview(t,{panelId:e,url:n}){t.panels[e].lastRender=n,nr.register(e,n)},createPanel(t,{panel:e}){t.lastPanelId=e.id,t.panels[e.id]=e},setPanelOrder(t,{panelOrder:e}){t.panelOrder=[...e]},setCurrentBackground(t,{current:e,panelId:n}){const o=t.panels[n];o.background.current=e,o.background.variant=0},setBackgroundColor(t,{color:e,panelId:n}){const o=t.panels[n];o.background.color=e},setBackgroundFlipped(t,{flipped:e,panelId:n}){const o=t.panels[n];o.background.flipped=e},setBackgroundVariant(t,{variant:e,panelId:n}){const o=t.panels[n];o.background.variant=e},setBackgroundScaling(t,{scaling:e,panelId:n}){const o=t.panels[n];o.background.scaling=e},deletePanel(t,{panelId:e}){nr.unregister(e,nr.panelToUrl.get(e)),delete t.panels[e]},setComposition(t,e){const n=t.panels[e.panelId];n.composite=e.composite},setFilters(t,e){const n=t.panels[e.panelId];n.filters=e.filters},backgroundSetComposition(t,e){const n=t.panels[e.panelId];n.background.composite=e.composite},backgroundSetFilters(t,e){const n=t.panels[e.panelId];n.background.filters=e.filters}},Ix),actions:zl({createPanel({state:t,commit:e}){const n=t.lastPanelId+1;return e("createPanel",{panel:{id:n,background:{color:"#000000",current:Lx,flipped:!1,scaling:2,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[],objects:{},onTopOrder:[],order:[],lastObjId:-1}}),e("setPanelOrder",{panelOrder:[...t.panelOrder,n]}),e("setCurrentPanel",{panelId:n}),n},duplicatePanel({state:t,commit:e},{panelId:n}){const o=t.panels[n],s=t.lastPanelId+1;nr.register(s,o.lastRender);const r=JSON.parse(JSON.stringify(o));let l=-1;const a=new Map,i={};for(const c in r.objects)a.set(+c,++l);for(const c in r.objects){const f=r.objects[c],h=a.get(+c);if(i[h]=f,f.panelId=s,f.id=h,"talkingObjId"in f){const v=f;v.talkingObjId!==null&&v.talkingObjId!=="$other$"&&a.has(v.talkingObjId)&&(v.talkingObjId=a.get(v.talkingObjId))}f.linkedTo!=null&&(f.linkedTo=a.get(f.linkedTo))}e("createPanel",{panel:Dx(zl({},r),{id:s,lastObjId:l,objects:i,order:r.order.map(c=>a.get(c)),onTopOrder:r.onTopOrder.map(c=>a.get(c))})});const u=t.panelOrder.indexOf(n);e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,u+1),s,...t.panelOrder.slice(u+1)]}),e("setCurrentPanel",{panelId:s})},seekBackgroundVariant({state:t,rootGetters:e,commit:n},{delta:o}){const s=t.panels[t.currentPanel],l=e["content/getBackgrounds"].get(s.background.current);!l||n("setBackgroundVariant",{panelId:t.currentPanel,variant:gs(l.variants,s.background.variant,o)})},delete({state:t,commit:e},{panelId:n}){if(t.panelOrder.length<=1)return;const o=t.panelOrder.indexOf(n);let s;o===t.panelOrder.length-1?s=o-1:s=o+1,e("setCurrentPanel",{panelId:t.panelOrder[s]}),e("setPanelOrder",{panelOrder:[...t.panelOrder.slice(0,o),...t.panelOrder.slice(o+1)]}),e("deletePanel",{panelId:n})},fixContentPackRemoval(t,e){const{state:n,rootGetters:o,commit:s,rootState:r}=t;for(const l of Object.values(n.panels)){const a=e.backgrounds.find(f=>f.id===l.background.current);if(!a)return;const i=o["content/getBackgrounds"].get(l.background.current);if(!i){r.content.current.backgrounds.length>0?s("setCurrentBackground",{current:r.content.current.backgrounds[0].id,panelId:l.id}):s("setCurrentBackground",{current:"buildin.transparent",panelId:l.id});return}const u=JSON.stringify(a.variants[l.background.variant]),c=i.variants.findIndex(f=>JSON.stringify(f)===u);c!==l.background.variant&&s("setBackgroundVariant",{variant:c===-1?0:c,panelId:l.id})}Tx(t,e)},move({state:t,commit:e},{panelId:n,delta:o}){const s=[...t.panelOrder],r=s.indexOf(n);s.splice(r,1);const l=Math.max(r+o,0);s.splice(l,0,n),e("setPanelOrder",{panelOrder:s})},addFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},removeFilter({state:t,commit:e},n){Ri(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},moveFilter({state:t,commit:e},n){Bi(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},setFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId],o=>e("setFilters",o))},backgroundAddFilter({state:t,commit:e},n){Ei(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundRemoveFilter({state:t,commit:e},n){Ri(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundMoveFilter({state:t,commit:e},n){Bi(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))},backgroundSetFilter({state:t,commit:e},n){Mi(n,()=>t.panels[n.panelId].background,o=>e("backgroundSetFilters",o))}},jx)};function Ov(){return{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1}}const Fx={namespaced:!0,state:Ov(),mutations:{setVertical(t,e){t.vertical=e},setNsfw(t,e){t.nsfw=e},setLqRendering(t,e){t.lqRendering=e},setSelection(t,e){t.selection=e},setLastDownload(t,e){t.lastDownload=e},setClipboard(t,e){t.clipboard=e},setDarkTheme(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom(t,e){t.defaultCharacterTalkingZoom=e},setColorPicker(t,e){t.pickColor=e}}};var Hx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ux={namespaced:!0,state:{},mutations:{add(t,{name:e,url:n}){t[e]=n}},actions:{add(t,e){return Hx(this,arguments,function*({state:n,commit:o,rootState:s},{name:r,url:l}){if(n[r])throw new Error(`There is already an uploaded file called "${r}"`);const a="uploads:"+r;if(o("add",{name:a,url:l}),Hf(a,l),"requireFixing25"in s){const i=yield Lo(a);o("fix25Sprites",{url:a,size:[i.width,i.height]},{root:!0})}return a})}}};var Vx=Object.defineProperty,Wx=Object.defineProperties,zx=Object.getOwnPropertyDescriptors,Gc=Object.getOwnPropertySymbols,Gx=Object.prototype.hasOwnProperty,Xx=Object.prototype.propertyIsEnumerable,Xc=(t,e,n)=>e in t?Vx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yc=(t,e)=>{for(var n in e||(e={}))Gx.call(e,n)&&Xc(t,n,e[n]);if(Gc)for(var n of Gc(e))Xx.call(e,n)&&Xc(t,n,e[n]);return t},qc=(t,e)=>Wx(t,zx(e)),or=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function De(){return T0()}const Yx=Y0({state:{unsafe:!1},mutations:{setUnsafe(t,e){t.unsafe=e},fix25Sprites(t,e){for(const n of Object.values(t.panels.panels))for(const o of Object.values(n.objects)){if(o.type!=="sprite"||!o.requireFixing25||o.scaleX!==o.scaleY)continue;const s=o;s.assets.length===1&&s.assets[0].hq===e.url&&($v(s,o.scaleX,e.size),delete o.requireFixing25)}}},actions:{removePacks(t,e){return or(this,arguments,function*({dispatch:n,commit:o},{packs:s}){o("setUnsafe",!0),yield n("content/removeContentPacks",s),o("setUnsafe",!1)})},getSave(t,e){return or(this,arguments,function*({state:n},o){const s=yield pn.getInstance();return JSON.stringify(qc(Yc({},n),{version:2.5}),(r,l)=>{if(r!=="ui"&&r!=="lastRender")return r==="uploadUrls"?Object.keys(l):r==="content"&&o?l.contentPacks.filter(a=>{var i,u;return!((i=a.packId)!=null&&i.startsWith("dddg.buildin."))||((u=a.packId)==null?void 0:u.endsWith(".nsfw"))}).map(a=>{var i;let u=(i=a.packId)!=null&&i.startsWith("dddg.uploads.")?a:a.packId;if(a.packId!=null){const c=s.getPack(a.packId);c&&c.repoUrl!=null&&(u+=`;${c.repoUrl}`)}return u}):l},2)})},loadSave(t,e){return or(this,arguments,function*({state:n},o){const s=JSON.parse(o),r=s.content;s.ui=qc(Yc({},Ov()),{vertical:n.ui.vertical,lqRendering:n.ui.lqRendering,nsfw:r.find(i=>typeof i=="string"&&i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw"))!==void 0,clipboard:n.ui.clipboard,useDarkTheme:n.ui.useDarkTheme,defaultCharacterTalkingZoom:n.ui.defaultCharacterTalkingZoom}),s.uploadUrls={},s.content=ih();const l=yield pn.getInstance();s.content.contentPacks=[...n.content.contentPacks.filter(i=>{var u;return(u=i.packId)==null?void 0:u.startsWith("dddg.buildin.")}),...(yield Promise.all(r.map(i=>or(this,null,function*(){if(typeof i!="string")return i;let u=null,c;i.indexOf(";")>=0?[c,u]=i.split(";"):c=i;const f=n.content.contentPacks.find(g=>g.packId===c);if(f)return f;if(i.startsWith("dddg.buildin.")&&i.endsWith(".nsfw")){const g=yield $i(Ia[i]);return yield Br(g)}u!=null&&!l.hasPack(c)&&(yield l.loadTempPack(u));const h=l.getPack(c);if(!h)return console.warn(`Pack Id ${i} not found!`),null;const v=yield $i(h.dddg2Path||h.dddg1Path);return yield Br(v)})))).filter(i=>i!==null)];let a=s.content.current;for(const i of s.content.contentPacks)a=fr(a,i);s.content.current=a,(s.version==null||s.version<2.5)&&qx(s),this.replaceState(s),Re.fire(new el)})}},modules:{ui:Fx,panels:Nx,content:LP,uploadUrls:Ux}});function qx(t){var e,n,o,s,r,l,a;const i=Object.values(t.panels.panels);if(!i.find(u=>Object.values(u.objects).find(c=>"scaleX"in c)))for(const u of i)for(const c of Object.values(u.objects)){c.scaleX=(e=c.zoom)!=null?e:1,c.scaleY=(n=c.zoom)!=null?n:1,c.skewX=0,c.skewY=0,c.linkedTo=null;const f=le();if(c.type==="character"){const h=c,v=t.content.current.characters.find(b=>b.id===h.characterType),g=(l=(r=(s=(o=v==null?void 0:v.styleGroups[h.styleGroupId])==null?void 0:o.styles[h.styleId])==null?void 0:s.poses[h.poseId])==null?void 0:r.size)!=null?l:[960,960];$v(c,(a=c.zoom)!=null?a:1,g)}if(c.type==="textBox"){const h=c;h.height+=f.TextBox.NameboxHeight,h.y+=h.height/2}c.type==="sprite"&&(c.requireFixing25=!0,t.requireFixing25=!0),delete c.zoom}}function $v(t,e,n){let o=new DOMMatrixReadOnly().translate(t.x,t.y+t.height/2);o=o.translate(0,-t.height/2).scale(t.width/n[0],t.height/n[1]).translate(0,n[1]/2),o=o.rotate(t.flip?-t.rotation:t.rotation),o=o.translate(0,n[1]/2).scale(e).translate(0,-n[1]/2);const s=t.rotation;Object.assign(t,Tr(o)),t.rotation=t.flip?360-s:s,t.skewX=0,t.skewY=0,t.width=n[0],t.height=n[1]}var Kx=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Jx={key:0},Qx=["onClick"],Zx=["onClick"],ek=5e3,Gl=2e4,Kc=100,tk=Pe({__name:"message-console",props:{loading:{default:!1,type:Boolean}},setup(t){const e=De(),n=t,o=L([]),s=L([]),r=L([]),l=L(!1),a=L(0),i=L(0),u=S(()=>e.state.ui.vertical);c(n.loading),Re.subscribe(xr,v=>{o.value.push(`Failed to load asset '${v.path}'`),setTimeout(()=>{o.value.shift()},ek)}),Re.subscribe(Ef,v=>{o.value.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout(()=>{o.value.shift()},Gl)}),Re.subscribe(Zr,v=>{s.value.push(v.message)}),Re.subscribe(ia,v=>{r.value.push(v)}),Re.subscribe(At,v=>{o.value.push(v.message),setTimeout(()=>{o.value.shift()},Gl)}),Re.subscribe(Mf,v=>{o.value.push(v.error.name),o.value.push(JSON.stringify(v.error.stack)),o.value.push(v.info),setTimeout(()=>{o.value.shift(),o.value.shift(),o.value.shift()},Gl)});function c(v){v?(i.value&&(clearTimeout(i.value),i.value=0),!l.value&&!a.value&&(a.value=setTimeout(()=>{l.value=!0,a.value=0},Kc))):(a.value&&(clearTimeout(a.value),a.value=0),l.value&&!i.value&&(i.value=setTimeout(()=>{l.value=!1,i.value=0},Kc)))}function f(v){s.value.splice(v,1)}function h(v,g){return Kx(this,null,function*(){const b=r.value[v];r.value.splice(v,1),yield b.actions.find($=>$.name===g).exec()})}return Xe(()=>n.loading,v=>{c(v)}),(v,g)=>(k(),B("div",{id:"messageConsole",class:Le({vertical:u.value})},[l.value?(k(),B("p",Jx,"Loading...")):ce("",!0),(k(!0),B(re,null,Ve(o.value,(b,w)=>(k(),B("p",{key:b+"_"+w},$e(b),1))),128)),(k(!0),B(re,null,Ve(r.value,(b,w)=>(k(),B("p",{class:"error",key:"resolvableError_"+w},[V($e(b.message)+" ",1),(k(!0),B(re,null,Ve(b.actions,$=>(k(),B("a",{href:"#",key:"resolvableError_"+w+$.name,onClick:p=>h(w,$.name)},"["+$e($.name)+"]",9,Qx))),128))]))),128)),(k(!0),B(re,null,Ve(s.value,(b,w)=>(k(),B("p",{class:"error",key:"error_"+w},[V($e(b)+" ",1),d("a",{href:"#",onClick:$=>f(w)},"[Dismiss]",8,Zx)]))),128))],2))}});const Be=(t,e)=>{const n=t.__vccOpts||t;for(const[o,s]of e)n[o]=s;return n},nk=Be(tk,[["__scopeId","data-v-fdb9d9bc"]]),ok={key:0,id:"submit-options"},sk=["onClick"],rk={key:0,id:"submit-options"},lk=["onClick"],ik=Pe({__name:"modal-dialog",props:{noBaseSize:Boolean,options:{type:Array,default:[]}},emits:["leave","option"],setup(t,{emit:e}){const n=window.HTMLDialogElement!=null,o=t,s=L(null),r=e;function l(){if(n){const u=s.value;u&&!u.open&&u.showModal()}window.addEventListener("click",i)}function a(){if(n){const u=s.value;u&&u.open&&u.close(),r("leave")}window.removeEventListener("click",i)}function i(u){const c=s.value;c&&c.open?u.target===c&&(a(),u.preventDefault(),u.stopPropagation()):window.removeEventListener("click",i)}return mt(l),af(l),uf(a),Ut(a),(u,c)=>n?(k(),B("dialog",{key:0,ref_key:"dialog",ref:s,class:Le(["native",{"base-size":!o.noBaseSize}]),onCancel:a},[en(u.$slots,"default",{},void 0,!0),t.options.length>0?(k(),B("div",ok,[(k(!0),B(re,null,Ve(t.options,f=>(k(),B("button",{key:f,class:"option",onClick:h=>r("option",f)},$e(f),9,sk))),128))])):ce("",!0)],34)):(k(),B("div",{key:1,class:"dialog-wrapper",onClick:c[1]||(c[1]=f=>u.$emit("leave"))},[d("dialog",{ref_key:"dialog",ref:s,open:"",class:Le({"base-size":!o.noBaseSize}),onClick:c[0]||(c[0]=ie(()=>{},["stop"]))},[en(u.$slots,"default",{},void 0,!0),t.options.length>0?(k(),B("div",rk,[(k(!0),B(re,null,Ve(o.options,f=>(k(),B("button",{key:f,class:"option",onClick:h=>r("option",f)},$e(f),9,lk))),128))])):ce("",!0)],2)]))}});const So=Be(ik,[["__scopeId","data-v-95b82e11"]]),ak=""+new URL("open_in_full.0d15444c.svg",import.meta.url).href,uk=""+new URL("open_in_full_dark.e8d5767b.svg",import.meta.url).href,ck=""+new URL("rotate_left.d26c7be6.svg",import.meta.url).href,dk=""+new URL("rotate_left_dark.1e7e3add.svg",import.meta.url).href;var fk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});function Wo(t,e){return fk(this,null,function*(){try{yield e()}catch(n){console.error("Error in promise",t,n),Re.fire(new Zr("Unexpected error! Please copy the following message and send it to /u/edave64: Error in '"+t+'", '+pk(n)))}})}function pk(t){if(t instanceof Error){if(t.stack!=null){const e=t.stack.split(`
`);return e[0].includes(t.name)&&e[0].includes(t.message)?e[0]+`
<br />`+e[1]:t.name+": "+t.message+`
<br />`+e[0]}return t.name+": "+t.message}return t instanceof Object?JSON.stringify(t):""+t}var hk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())}),Jc;const $n=(Jc=window.devicePixelRatio)!=null?Jc:1;function vk(t,e){const n=bk(e);if(t.save(),Ze)o(e,Ze.lastPos),Ze.grabby.paint(t,Ze),t.translate(Ze.lastPos.x,Ze.lastPos.y),t.scale($n,$n),Zc(t,Ze.grabby,new DOMPointReadOnly);else{const s=le();t.translate(n.x,n.y),t.scale($n,$n),e.x>s.Base.screenWidth/2&&t.scale(-1,1),e.y>s.Base.screenHeight/2&&t.scale(1,-1);for(let r=0;r<Ur.length;r++){const l=Ur[r];l.pos||(l.pos=_k(yk*(r+1))),Zc(t,l,l.pos)}}t.restore();function o(s,r){t.save();try{t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(r.x,r.y),t.setLineDash([5*$n,5*$n]),t.strokeStyle="#000",t.stroke(),t.closePath()}finally{t.restore()}}}const Hr=2*Math.PI,Ur=[{icon:ck,iconDark:dk,paint(t,{lastPos:e,center:n,initialDragAngle:o}){const{angle:s}=sr(ds(n,e)),r=le().Base;let l=wi(o-s,Hr);t.beginPath(),t.moveTo(n.x,n.y);let a=o-Math.PI,i=a+s-o;if(l<=Math.PI){const u=i;i=a,a=u}t.arc(n.x,n.y,r.wheelInnerRadius,a,i),t.lineTo(n.x,n.y),t.globalCompositeOperation="difference",t.fillStyle="rgba(255, 255, 255, 1)",t.fill(),t.globalCompositeOperation="source-over"},onStartMove(t,e,n){n.initalObjRotation=e.rotation;const{angle:o}=sr(ds(n.center,n.lastPos));n.initialDragAngle=o},onMove(t,e,n,{center:o,initalObjRotation:s,initialDragAngle:r}){const{angle:l}=sr(ds(o,Ze.lastPos));let a=wi(s+(l-r)/Math.PI*180,360);n&&(a=Math.round(a/22.5)*22.5),e.rotation!==a&&t.commit("panels/setRotation",{panelId:e.panelId,id:e.id,rotation:a})}},{icon:ak,iconDark:uk,paint(t,{renderObj:e,originalObjTransform:n}){if(!n)return;const o=e.preparedTransform;try{e.preparedTransform=n,Dn(t,()=>{t.globalAlpha=.5,e.render(t,un.None,!0,!1,!0),t.globalAlpha=1})}finally{e.preparedTransform=o}},onStartMove(t,e,n){n.originalObjTransform=n.renderObj.preparedTransform,n.initialScaleX=e.scaleX,n.initialScaleY=e.scaleY,n.initialDelta=ds(n.center,n.lastPos)},onMove(t,e,n,{initialScaleX:o,initialScaleY:s,initialDelta:r,center:l,lastPos:a}){const i=le(),u=ds(l,a);let c=u.x/r.x*o,f=u.y/r.y*s;if(n){let h=u;l.x>i.Base.screenWidth/2&&(h=new DOMPointReadOnly(-h.x,h.y)),l.y>i.Base.screenHeight/2&&(h=new DOMPointReadOnly(h.x,-h.y));const{angle:v}=sr(h),g=Math.round(v/Hr*11),b=(Math.abs(u.x)/Math.abs(r.x)+Math.abs(u.y)/Math.abs(r.y))/2;g===0||g===11?f=s:g===1?(c=-b*o,f=-b*s):g===2||g===3?c=o:g===4?(c=b*o,f=-b*s):g===5||g===6?f=s:g===7?(c=b*o,f=b*s):g===8||g===9?c=o:g===10&&(c=-b*o,f=b*s)}e.scaleX===c&&e.scaleY===f||t.commit("panels/setObjectScale",{panelId:e.panelId,id:e.id,scaleX:c,scaleY:f})}}];let Ze=null;function gk(t){const e=le(),n=Ur.find(o=>{const s=o.lastDrawPos;return s?Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))<=e.Base.wheelWidth/2*$n:!1});return n?(Ze={lastPos:t,started:!1,grabby:n,center:null,renderObj:null},!0):!1}function mk(t,e,n){var o,s;if(!Ze)return!1;const r=t.state.panels,a=r.panels[r.currentPanel].objects[t.state.ui.selection];if(!Ze.started){Ze.started=!0;const i=Vo(t),u=i==null?void 0:i.getLastRenderObject(a.id),c=(s=(o=i==null?void 0:i.getLastRenderObject(a.linkedTo))==null?void 0:o.preparedTransform)!=null?s:new DOMMatrixReadOnly;Ze.renderObj=u,Ze.center=c.transformPoint(new DOMPointReadOnly(a.x,a.y)),Ze.grabby.onStartMove(t,a,Ze)}return Ze.lastPos=e,Ze.grabby.onMove(t,a,n,Ze),!0}function Qc(){return Ze?(Ze=null,!0):!1}const Di=new Map;for(const t of Ur)Wo("Loading grabby icon",(e=>hk(void 0,null,function*(){Di.set(e.icon,yield Lo(e.icon)),Di.set(e.iconDark,yield Lo(e.iconDark))})).bind(void 0,t));function Zc(t,e,n){var o;const s=le();t.save(),t.translate(n.x,n.y),e.lastDrawPos=t.getTransform().transformPoint(new DOMPointReadOnly),t.scale(-1,1),t.beginPath(),t.ellipse(0,0,s.Base.wheelWidth/2,s.Base.wheelWidth/2,0,0,Hr),t.closePath();const r=getComputedStyle(document.body);t.fillStyle=r.getPropertyValue("--accent-background"),t.strokeStyle=r.getPropertyValue("--border"),t.lineWidth=2,t.fill(),t.stroke();const l=document.body.classList.contains("dark-theme")?e.iconDark:e.icon;(o=Di.get(l))==null||o.paintOnto(t),t.restore()}function bk(t){const e=le(),n=e.Base.wheelWidth+e.Base.wheelInnerRadius*$n;return new DOMPointReadOnly(jr(n,t.x,e.Base.screenWidth-n),jr(n,t.y,e.Base.screenHeight-n))}const yk=Math.PI/6;function _k(t){const e=le().Base;return new DOMPointReadOnly(e.wheelInnerRadius*Math.cos(t),e.wheelInnerRadius*Math.sin(t))}function ds(t,e){return new DOMPointReadOnly(t.x-e.x,t.y-e.y)}function sr(t){const e=Math.atan2(t.y,t.x);return{angle:wi(e,Hr),distance:Math.sqrt(t.x*t.x+t.y*t.y)}}var yo=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const wk=["height","width"],Pk=Pe({__name:"render",props:{canvasWidth:{default:0},canvasHeight:{default:0},preLoading:{type:Boolean}},setup(t,{expose:e}){const n=De(),o=t,s=L(null),r=L(null),l=L(null),a=L(!1),i=L(!1),u=S(()=>{var Q;return(Q=n.state.ui.selection)!=null?Q:null}),c=S(()=>n.state.panels.panels[n.state.panels.currentPanel]),f=S(()=>n.state.ui.lqRendering);function h(){if(o.preLoading)return null;const Q=Vo(n);return Q==null||Q.setPanelId(n.state.panels.currentPanel),Q}const v=S(()=>(o.preLoading,le().Base.screenHeight)),g=S(()=>(o.preLoading,le().Base.screenWidth));function b(){l.value==null&&(l.value=requestAnimationFrame(w))}function w(){return yo(this,null,function*(){var Q;if(l.value!=null&&(cancelAnimationFrame(l.value),l.value=null),!o.preLoading&&!n.state.unsafe){try{yield(Q=h())==null?void 0:Q.render(!f.value,!0,!1)}catch(me){console.log(me)}p(),Re.fire(new ra)}})}function $(){const Q=document.createElement("canvas");Q.height=v.value,Q.width=g.value;try{Fo.make(Q,!0,!1).drawText({text:"Starting...",x:Q.width/2,y:Q.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),r.value.drawImage(Q,o.canvasWidth,o.canvasHeight)}finally{No(Q)}}function p(){const Q=h();a.value=!1,Q==null||Q.paintOnto(r.value,{x:0,y:0,w:g.value,h:v.value});const me=Q==null?void 0:Q.getLastRenderObject(u.value);me&&vk(r.value,me.preparedTransform.transformPoint(new DOMPoint(0,0))),A.value=!1}function m(Q,me,xe){const W=s.value,z=Q-W.offsetLeft,oe=me-W.offsetTop;let ge=z/W.offsetWidth*W.width,y=oe/W.offsetWidth*W.width;if(xe){const P=xe.transformPoint(new DOMPointReadOnly(ge,y));ge=P.x,y=P.y}return[ge,y]}function _(Q){var me;const[xe,W]=m(Q.clientX,Q.clientY);if(M(xe,W))return;if(i.value){i.value=!1;return}const z=h().objectsAt(xe,W),oe=u.value,ge=z.findIndex(P=>P===oe);let y;ge===0?y=null:ge!==-1?y=z[ge-1]:y=(me=z[z.length-1])!=null?me:null,K(()=>{n.state.ui.selection!==y&&n.commit("ui/setSelection",y)})}Xe(()=>[o.canvasWidth,o.canvasHeight],()=>p()),Re.subscribe(el,b),Re.subscribe(la,()=>{const Q=h();Q&&Q.setPanelId(-1)}),n.subscribe(Q=>{Q.type!=="panels/setPanelPreview"&&Q.type!=="panels/currentPanel"&&b()}),mt(()=>{r.value=s.value.getContext("2d"),$(),b()}),Ut(()=>{h().dispose()});const A=L(!1);function I(Q){return yo(this,null,function*(){if(A.value)w(),A.value=!1;else{const me=yield Sr(Q,!0);r.value.clearRect(0,0,s.value.width,s.value.height),me.paintOnto(r.value,{x:0,y:0}),A.value=!0}r.value})}const E=S(()=>n.state.ui.pickColor),j=S(()=>E.value?"crosshair":"default");function M(Q,me){if(E.value){const xe=r.value.getImageData(Q,me,1,1).data,W=`rgba(${xe[0].toString()},${xe[1].toString()},${xe[2].toString()},${(xe[3]/255).toString()})`;return K(()=>{n.commit("ui/setColorPicker",!1),Re.fire(new kr(W))}),!0}return!1}function H(){return yo(this,null,function*(){const Q=yield h().download();yield K(()=>{const me=n.state.ui.lastDownload;n.commit("ui/setLastDownload",Q),me!=null&&URL.revokeObjectURL(me)})})}let te=null,q=null,pe=0,we=0,je=0,F=0;function O(Q){Q.preventDefault(),x(Q.clientX,Q.clientY)}function C(Q){x(Q.touches[0].clientX,Q.touches[0].clientY)}function x(Q,me){var xe,W,z;const oe=u.value;if(oe===null)return;te=c.value.objects[oe],q=(z=(W=(xe=Vo(n).getLastRenderObject(te.linkedTo))==null?void 0:xe.preparedTransform)==null?void 0:W.inverse())!=null?z:new DOMMatrixReadOnly;const[ge,y]=m(Q,me,q);oe!=null&&gk(new DOMPointReadOnly(...m(Q,me)))||(pe=ge-te.x,we=y-te.y,je=te.x,F=te.y)}function J(Q){Q.stopPropagation(),Q.preventDefault(),Q.dataTransfer.dropEffect="copy"}function ve(Q){if(!te)return;Q.preventDefault();const me=Q instanceof MouseEvent?Q.clientX:Q.touches[0].clientX,xe=Q instanceof MouseEvent?Q.clientY:Q.touches[0].clientY;let[W,z]=m(me,xe,q);if(mk(n,new DOMPointReadOnly(...m(me,xe)),Q.shiftKey)){b();return}W-=pe,z-=we;const oe=Math.abs(W-je),ge=Math.abs(z-F);oe+ge>1&&(i.value=!0),Q.shiftKey&&(oe>ge?z=F:W=je),K(()=>yo(this,null,function*(){yield n.dispatch("panels/setPosition",{panelId:te.panelId,id:te.id,x:W,y:z})}))}function Ce(Q){return yo(this,null,function*(){if(Q.stopPropagation(),Q.preventDefault(),!!Q.dataTransfer){for(const me of Q.dataTransfer.items)if(me.kind==="file"&&me.type.match(/image.*/)){const xe=me.getAsFile(),W=URL.createObjectURL(xe);try{const z=yield n.dispatch("uploadUrls/add",{name:xe.name,url:W});yield K(()=>yo(this,null,function*(){yield n.dispatch("panels/createSprite",{panelId:n.state.panels.currentPanel,assets:[{hq:z,lq:z,sourcePack:"dddg.uploaded.sprites"}]})}))}catch(z){URL.revokeObjectURL(W)}}}})}function Me(Q){if(Qc()){b(),Q.preventDefault(),te=null,i.value=!0;return}te&&("TouchEvent"in window&&Q instanceof TouchEvent&&(i.value=!1),te=null)}function at(Q){Q.buttons!==1&&(te=null,Qc()&&b())}return e({download:H,blendOver:I}),(Q,me)=>(k(),B("canvas",{id:"scaled_display",ref_key:"sd",ref:s,height:v.value,width:g.value,style:Ke({width:t.canvasWidth+"px",height:t.canvasHeight+"px",cursor:j.value}),draggable:"true",onClick:_,onTouchstart:C,onDragstart:O,onTouchmove:ve,onMousemove:ve,onTouchend:Me,onMouseup:Me,onDragover:J,onDrop:Ce,onMouseenter:at,onContextmenu:me[0]||(me[0]=ie(()=>{},["prevent"]))}," HTML5 is required to use the Doki Doki Dialog Generator. ",44,wk))}});const Ck=["disabled","title","aria-label"],xk={key:0,class:"material-icons","aria-hidden":"true"},kk={class:"content"},Ok={key:1,class:"shortcut-popup"},$k=Pe({__name:"d-button",props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},shortcut:{type:String,default:null},title:{type:String,default:null}},setup(t){const e=t,n=L(null),o=S(()=>e.shortcut!=null&&!e.shortcut.startsWith("!")),s=S(()=>{const l=e.shortcut;return l==null?"":l.startsWith("!")?l.substring(1):l});function r(l){e.disabled||l.key===e.shortcut&&l.ctrlKey&&!l.altKey&&!l.metaKey&&!l.shiftKey&&(n.value.focus({focusVisible:!1}),n.value.click(),l.preventDefault(),l.stopPropagation())}return mt(()=>{!e.shortcut||window.addEventListener("keydown",r)}),Ut(()=>{window.removeEventListener("keydown",r)}),(l,a)=>{var i,u;return k(),B("button",{class:Le([t.iconPos]),disabled:t.disabled,title:(i=t.title)!=null?i:void 0,"aria-label":(u=t.title)!=null?u:void 0,style:Ke(t.icon?"height: auto":""),ref_key:"btn",ref:n},[t.icon?(k(),B("div",xk,$e(t.icon),1)):ce("",!0),d("div",kk,[en(l.$slots,"default",{},void 0,!0)]),o.value?(k(),B("div",Ok,$e(s.value),1)):ce("",!0)],14,Ck)}}});const Ie=Be($k,[["__scopeId","data-v-eccae88d"]]),Sk={methods:{verticalScrollRedirect:Sv}};function Sv(t){if(t.type!=="wheel"||!t.currentTarget)return;const e=t.currentTarget,n=getComputedStyle(e),o=t;if(o.deltaY===0)return;if(n.overflowY==="auto"){if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight){t.stopPropagation();return}}else if(e.scrollTop>0){t.stopPropagation();return}}const s=e.scrollLeft;e.scrollLeft+=o.deltaY,e.scrollLeft!==s&&t.stopPropagation()}function Mt(t){const e=De(),n=S(()=>e.state.ui.vertical);function o(){const r=t.value;return r?r.$el?r.$el:r:null}function s(){!t.value||o().classList.toggle("vertical",n.value)}return Xe(()=>n.value,s),mt(()=>{s(),o().addEventListener("wheel",r=>{n.value||Sv(r)},{passive:!0})}),{vertical:n,getRoot:o}}var Ik=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const jk=["title","onClick","onKeypress"],Tk=["src","alt"],Ak=Pe({__name:"character",emits:["show-dialog"],setup(t,{emit:e}){const n=De(),o=e,s=S(()=>n.state.content.current.characters);function r(a){return a.chibi?he.supports.lq?a.chibi.lq:a.chibi.hq:""}function l(a){K(()=>Ik(this,null,function*(){yield n.dispatch("panels/createCharacters",{characterType:a,panelId:n.state.panels.currentPanel})}))}return(a,i)=>(k(),B(re,null,[(k(!0),B(re,null,Ve(s.value,u=>(k(),B("div",{class:"character",tabindex:"0",key:u.id,title:u.label,onClick:ie(c=>l(u.id),["left"]),onKeypress:[lt(ie(c=>l(u.id),["prevent","stop"]),["enter"]),lt(ie(c=>l(u.id),["prevent","stop"]),["space"])]},[d("img",{src:r(u),alt:u.label},null,8,Tk)],40,jk))),128)),R(Ie,{class:"custom-sprite",icon:"extension",onClick:i[0]||(i[0]=u=>o("show-dialog","type: Characters"))},{default:Y(()=>[V(" Search in content packs ")]),_:1})],64))}});const Ek=Be(Ak,[["__scopeId","data-v-f0d6ef73"]]),Rk=Pe({__name:"drop-target",emits:["drop"],setup(t,{expose:e,emit:n}){const o=n,s=De(),r=L(!1),l=S(()=>s.state.ui.vertical);function a(){r.value=!0}function i(){r.value=!1}function u(c){if(i(),c.stopPropagation(),c.preventDefault(),!!c.dataTransfer)for(const f of c.dataTransfer.items)f.kind==="file"&&f.type.match(/image.*/)&&o("drop",f.getAsFile())}return e({show:a,hide:i}),(c,f)=>r.value?(k(),B("div",{key:0,onDragleave:f[0]||(f[0]=h=>r.value=!1),onDrop:u,class:Le({vertical:l.value})},[en(c.$slots,"default",{},void 0,!0)],34)):ce("",!0)}});const Iv=Be(Rk,[["__scopeId","data-v-34538d63"]]);var Bk=Object.defineProperty,Mk=Object.defineProperties,Dk=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,Lk=Object.prototype.hasOwnProperty,Nk=Object.prototype.propertyIsEnumerable,td=(t,e,n)=>e in t?Bk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nd=(t,e)=>{for(var n in e||(e={}))Lk.call(e,n)&&td(t,n,e[n]);if(ed)for(var n of ed(e))Nk.call(e,n)&&td(t,n,e[n]);return t},od=(t,e)=>Mk(t,Dk(e)),sn=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Fk=["title","onClick","onKeypress"],Hk=["title","onClick","onKeypress"],Uk=Pe({__name:"sprite",emits:["show-dialog"],setup(t,{expose:e,emit:n}){const o=De(),s=n,r=S(()=>o.state.content.current.sprites.map(I=>{let E=null;const j=I.variants[0].map(M=>{const H=Bn(M,!1);return H.startsWith("uploads:")?(Object.keys(o.state.uploadUrls),E=H,Nf):H});return od(nd({},I),{missing:E,urls:j})})),l=S(()=>he.supports.openableFolders.has("sprites"));function a(I){return I.variants[0].map(E=>`url('${Bn(E,!1)}')`).join(",")}function i(I){return sn(this,null,function*(){yield K(()=>sn(this,null,function*(){yield o.dispatch("panels/createSprite",{panelId:o.state.panels.currentPanel,assets:I.variants[0]})}))})}function u(){he.openFolder("sprites")}const c=L(null);function f(I){return sn(this,null,function*(){const E=c.value,j=E.uploadingSprite;if(!E.files)return;if(E.files.length!==1){console.error("More than one file uploaded!");return}const M=E.files[0];yield K(()=>sn(this,null,function*(){const H=URL.createObjectURL(M);yield o.dispatch("uploadUrls/add",{name:j,url:H})}))})}function h(I){const E=c.value;E.uploadingSprite=Bn(I.variants[0][0]).substring(8),E.click()}const v={packId:"dddg.uploads.sprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},g=L(null);function b(){const I=g.value;if(!!I.files)for(const E of I.files)$(E)}function w(){return sn(this,null,function*(){const I=prompt("Enter the URL of the image");if(I==null)return;const E=I.split("/").slice(-1)[0];yield p(E,I)})}function $(I){return sn(this,null,function*(){yield K(E=>sn(this,null,function*(){const j=URL.createObjectURL(I),M=yield o.dispatch("uploadUrls/add",{name:I.name,url:j});yield p(I.name,M,E)}))})}function p(I,E){return sn(this,arguments,function*(j,M,H=K){const te=o.state.content.contentPacks.find(pe=>pe.packId===v.packId)||v,q=od(nd({},te),{sprites:[...te.sprites,{id:M,label:j,variants:[[{lq:M,hq:M}]],defaultScale:[1,1],hd:null}]});yield H(()=>sn(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:q,processed:!0})}))})}const m=L(null);function _(I){!I.dataTransfer||(I.dataTransfer.effectAllowed="none",Array.from(I.dataTransfer.items).find(E=>E.type.match(/^image.*$/))&&(I.dataTransfer.effectAllowed="link",m.value.show()))}function A(){m.value.hide()}return e({showDropTarget:_,hideDropTarget:A}),(I,E)=>(k(),B(re,null,[R(Iv,{ref_key:"spriteDt",ref:m,class:"drop-target",onDrop:$},{default:Y(()=>[V("Drop here to add as a new sprite ")]),_:1},512),(k(!0),B(re,null,Ve(r.value,j=>(k(),B(re,null,[j.missing!==null?(k(),B("div",{class:"sprite",tabindex:"0",key:`${j.label}_missing`,title:j.label,style:Ke({background:a(j)}),onClick:M=>h(j),onKeypress:[lt(ie(M=>h(j),["prevent","stop"]),["enter"]),lt(ie(M=>h(j),["prevent","stop"]),["space"])]},$e(j.label),45,Fk)):(k(),B("div",{class:"sprite",tabindex:"0",key:j.label,title:j.label,style:Ke({background:a(j)}),onClick:M=>i(j),onKeypress:[lt(ie(M=>i(j),["prevent","stop"]),["enter"]),lt(ie(M=>i(j),["prevent","stop"]),["space"])]},$e(j.label),45,Hk))],64))),256)),R(Ie,{class:"custom-sprite v-w100",icon:"publish",onClick:E[0]||(E[0]=j=>g.value.click())},{default:Y(()=>[V(" Upload new sprite "),d("input",{type:"file",ref_key:"spriteUpload",ref:g,onChange:b},null,544)]),_:1}),R(Ie,{icon:"insert_link",onClick:w},{default:Y(()=>[V(" New sprite from URL ")]),_:1}),R(Ie,{icon:"extension",onClick:E[1]||(E[1]=j=>s("show-dialog","type: Sprites"))},{default:Y(()=>[V(" Search in content packs ")]),_:1}),l.value?(k(),ae(Ie,{key:0,icon:"folder",onClick:u},{default:Y(()=>[V(" Open sprites folder ")]),_:1})):ce("",!0),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:c,onChange:f},null,544)],64))}});const Vk=Be(Uk,[["__scopeId","data-v-d2e4e53f"]]);var Xn=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Wk=Pe({__name:"ui",setup(t){const e=De();function n(){return Xn(this,null,function*(){return yield a("createTextBox")})}function o(){return Xn(this,null,function*(){return yield a("createChoice")})}function s(){return Xn(this,null,function*(){return yield a("createNotification")})}function r(){return Xn(this,null,function*(){return yield a("createPoem")})}function l(){return Xn(this,null,function*(){return yield a("createConsole")})}function a(i){return Xn(this,null,function*(){yield K(()=>Xn(this,null,function*(){yield e.dispatch(`panels/${i}`,{panelId:e.state.panels.currentPanel})}))})}return(i,u)=>(k(),B(re,null,[d("button",{class:"v-w100",onClick:n},"Textbox"),d("button",{class:"v-w100 v-bt0",onClick:r},"Poem"),d("button",{class:"v-w100 v-bt0",onClick:s},"Notification"),d("button",{class:"v-w100 v-bt0",onClick:o},"Choice"),d("button",{class:"v-w100 v-bt0",onClick:l},"Console")],64))}});var zk=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Gk=t=>(_t("data-v-aad6f368"),t=t(),wt(),t),Xk=Gk(()=>d("h1",null,"Add",-1)),Yk=["innerHTML"],qk=["disabled"],Kk=Pe({__name:"add",setup(t){const e={characters:{icon:"emoji_people",text:"Char&shy;acters",shortcut:"1"},sprites:{icon:"change_history",text:"Sprites",shortcut:"2"},ui:{icon:"view_quilt",text:"UI",shortcut:"3"}},n=L(null),o=L("characters"),s=L(null),r=De(),{vertical:l}=Mt(n),a=S(()=>r.state.panels.panels[r.state.panels.currentPanel]),i=S(()=>r.state.ui.clipboard!=null);function u(){K(()=>zk(this,null,function*(){yield r.dispatch("panels/pasteObjectFromClipboard",{panelId:a.value.id})}))}return(c,f)=>(k(),B("div",{class:"panel",ref_key:"root",ref:n,onDragenter:f[2]||(f[2]=(...h)=>{var v,g;return((v=s.value)==null?void 0:v.showDropTarget)&&((g=s.value)==null?void 0:g.showDropTarget(...h))}),onMouseleave:f[3]||(f[3]=(...h)=>{var v,g;return((v=s.value)==null?void 0:v.hideDropTarget)&&((g=s.value)==null?void 0:g.hideDropTarget(...h))})},[Xk,d("div",{class:Le({"group-selector":!0,vertical:ne(l)})},[(k(),B(re,null,Ve(e,(h,v)=>R(Ie,{key:v,class:Le({active:o.value===v,"v-bl0":v!=="characters","h-bt0":v!=="characters"}),"icon-pos":"top",icon:h.icon,shortcut:h.shortcut,onClick:g=>o.value=v},{default:Y(()=>[d("span",{innerHTML:h.text},null,8,Yk)]),_:2},1032,["class","icon","shortcut","onClick"])),64))],2),d("div",{class:Le({"item-grid":!0,vertical:ne(l)})},[o.value==="characters"?(k(),ae(Ek,{key:0,onShowDialog:f[0]||(f[0]=h=>c.$emit("show-dialog",h))})):o.value==="sprites"?(k(),ae(Vk,{key:1,ref_key:"sprites",ref:s,onShowDialog:f[1]||(f[1]=h=>c.$emit("show-dialog",h))},null,512)):o.value==="ui"?(k(),ae(Wk,{key:2})):ce("",!0),d("button",{class:"v-w100",onClick:u,disabled:!i.value}," Paste ",8,qk)],2)],544))}});const Jk=Be(Kk,[["__scopeId","data-v-aad6f368"]]);var Qk=Object.defineProperty,Zk=Object.defineProperties,eO=Object.getOwnPropertyDescriptors,sd=Object.getOwnPropertySymbols,tO=Object.prototype.hasOwnProperty,nO=Object.prototype.propertyIsEnumerable,rd=(t,e,n)=>e in t?Qk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oO=(t,e)=>{for(var n in e||(e={}))tO.call(e,n)&&rd(t,n,e[n]);if(sd)for(var n of sd(e))nO.call(e,n)&&rd(t,n,e[n]);return t},sO=(t,e)=>Zk(t,eO(e));const rO=Pe({mixins:[Sk],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection(){return this.direction==="global"?this.$store.state.ui.vertical?"vertical":"horizontal":this.direction==="inverted"?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render(){const t=this.noWraping?"no-wraping":"wraping",n=gu("div",sO(oO({},{}),{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize!==void 0){const o=this.maxSize instanceof Array?this.maxSize[this.finalDirection==="horizontal"?0:1]:this.maxSize;return gu("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:{[this.finalDirection==="horizontal"?"maxWidth":"maxHeight"]:o}},[n])}return n},mounted(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});const Wt=Be(rO,[["__scopeId","data-v-3912d02e"]]);let Li=0;typeof BigInt!="undefined"&&(Li=BigInt(0));function Da(){const t=Li;return Li++,t+""}const lO=["for"],iO=["id","x1","x2"],aO=["offset"],uO=["fill"],cO=["d"],dO=["id","max","value"],rr=255,Xl=8,fO=Pe({__name:"slider",props:{label:{type:String,required:!0},gradientStops:{required:!0,type:Array},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{default:!1},noInput:{default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=Da(),o=t,s=De(),r=e,l=S(()=>s.state.ui.vertical),a=L(null),i=S(()=>{const b=o.modelValue/o.maxValue*rr;return`M${b} 0L${b+14} 0L${b+7} 12Z`}),u=S(()=>!o.shiftGradient||o.modelValue===0?0:o.modelValue/o.maxValue);function c(b){r("update:modelValue",parseFloat(b.target.value))}const f=L(!1);function h(b){f.value=!0,v(b),b instanceof MouseEvent&&(window.addEventListener("mousemove",v),window.addEventListener("mouseup",g)),b.preventDefault()}function v(b){if(!f.value)return;const w=a.value;if(b instanceof MouseEvent&&b.buttons===0){g();return}b.preventDefault();const $=w.getBoundingClientRect(),p=$.width/(Xl+rr+Xl),_=((b instanceof MouseEvent?b.clientX:b.touches[0].clientX)-$.x)/p,A=Math.max(Math.min(_-Xl,rr),0)/rr*o.maxValue;r("update:modelValue",A),b.preventDefault()}function g(){f.value=!1,window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",g)}return(b,w)=>(k(),B("div",{class:Le({slider:!0,vertical:l.value}),onKeydown:w[1]||(w[1]=ie(()=>{},["stop"]))},[t.noInput?ce("",!0):(k(),B("label",{key:0,for:ne(n)},$e(t.label),9,lO)),d("div",null,[(k(),B("svg",{ref_key:"svg",ref:a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:h,onTouchstart:h,onTouchmove:v,onTouchend:g},[d("defs",null,[d("linearGradient",{id:`gradient${ne(n)}`,x1:u.value*100+"%",y1:"0%",x2:(u.value+1)*100+"%",y2:"0%",spreadMethod:"repeat"},[(k(!0),B(re,null,Ve(t.gradientStops,($,p)=>(k(),B("stop",{key:p,offset:p/(t.gradientStops.length-1)*100+"%",style:Ke("stop-color:"+$)},null,12,aO))),128))],8,iO)]),d("g",null,[d("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:`url(#gradient${ne(n)})`},null,8,uO),d("path",{d:i.value,"stroke-width":"2",class:"slider-pointer"},null,8,cO)])],544))]),t.noInput?ce("",!0):(k(),B("input",{key:1,id:ne(n),class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:c,onKeydown:w[0]||(w[0]=ie(()=>{},["stop"]))},null,40,dO))],34))}});const Qn=Be(fO,[["__scopeId","data-v-81831f96"]]),pO=Pe({__name:"slider-group",props:{modelValue:{type:String,validator:t=>!!t.match(/^#[0-9a-f]{6,8}$/i)},mode:{type:String},relative:Boolean},emits:["update:modelValue"],setup(t,{emit:e}){const n=e,o=t,s=L(null),r=L(0),l=L(0),a=L(0),i=L(0),u=$({rgba:{label:"Red",stops(){const p=o.relative?l.value:0,m=o.relative?a.value:0;return[new Te(0,p,m,1),new Te(255,p,m,1)]}},hsla:{label:"Hue",max:360,stops(){const p=o.relative?l.value/100:1,m=o.relative?a.value/100:.5;return w(_=>new Fe(_,p,m,1))}}}),c=$({rgba:{label:"Green",stops(){const p=o.relative?r.value:0,m=o.relative?a.value:0;return[new Te(p,0,m,1),new Te(p,255,m,1)]}},hsla:{label:"Saturation",stops(){const p=o.relative?r.value/360:0,m=o.relative?a.value/100:.5;return w(_=>new Fe(p,_,m,1))}}}),f=$({rgba:{label:"Blue",stops(){const p=o.relative?r.value:0,m=o.relative?l.value:0;return[new Te(p,m,0,1),new Te(p,m,255,1)]}},hsla:{label:"Luminosity",stops(){const p=o.relative?r.value/360:0,m=o.relative?l.value/100:.5;return w(_=>new Fe(p,m,_,1))}}}),h=S(()=>{const p=Te.fromHex(o.modelValue);return[new Te(p.r,p.g,p.b,0).toCss(),new Te(p.r,p.g,p.b,1).toCss()]});function v(){o.modelValue!==s.value&&b()}function g(){let p;o.mode==="rgba"?p=new Te(r.value,l.value,a.value,i.value/255):p=new Fe(r.value/360,l.value/100,a.value/100,i.value/255);const m=p.toRgb().toHex();if(s.value!==m){if(m.length!==9)throw new Error(`Invalid color code: ${m}`);s.value=m,n("update:modelValue",m)}}function b(){const p=Te.fromHex(o.modelValue);if(s.value=p.toHex(),i.value=p.a*255,o.mode==="hsla"){const m=p.toHSL();r.value=m.h*360,l.value=m.s*100,a.value=m.l*100}else r.value=p.r,l.value=p.g,a.value=p.b}function w(p){const m=[];for(let _=0;_<=8;++_)m.push(p(_/8));return m}Xe(()=>o.modelValue,v),Xe(()=>o.mode,b,{immediate:!0}),Xe(()=>[r.value,l.value,a.value,i.value],g);function $({rgba:p,hsla:m}){const _=S(()=>{var E;return o.mode==="rgba"?255:(E=m.max)!=null?E:100}),A=S(()=>o.mode==="rgba"?p.label:m.label),I=S(()=>(o.mode==="rgba"?p.stops():m.stops()).map(j=>j.toRgb().toCss()));return{maxValue:_,label:A,stops:I}}return(p,m)=>(k(),B("div",null,[R(Qn,{label:ne(u).label.value,modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=_=>r.value=_),"max-value":ne(u).maxValue.value,"gradient-stops":ne(u).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),R(Qn,{label:ne(c).label.value,modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=_=>l.value=_),"max-value":ne(c).maxValue.value,"gradient-stops":ne(c).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),R(Qn,{label:ne(f).label.value,modelValue:a.value,"onUpdate:modelValue":m[2]||(m[2]=_=>a.value=_),"max-value":ne(f).maxValue.value,"gradient-stops":ne(f).stops.value},null,8,["label","modelValue","max-value","gradient-stops"]),R(Qn,{label:"Alpha",modelValue:i.value,"onUpdate:modelValue":m[3]||(m[3]=_=>i.value=_),"max-value":255,"gradient-stops":h.value},null,8,["modelValue","gradient-stops"])]))}});const hO=Be(pO,[["__scopeId","data-v-d66257ab"]]);var vO=Object.defineProperty,gO=Object.defineProperties,mO=Object.getOwnPropertyDescriptors,ld=Object.getOwnPropertySymbols,bO=Object.prototype.hasOwnProperty,yO=Object.prototype.propertyIsEnumerable,id=(t,e,n)=>e in t?vO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ad=(t,e)=>{for(var n in e||(e={}))bO.call(e,n)&&id(t,n,e[n]);if(ld)for(var n of ld(e))yO.call(e,n)&&id(t,n,e[n]);return t},ud=(t,e)=>gO(t,mO(e)),_O=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const wO={class:"v-w100 h-h100"},PO={class:"hex-selector"},CO=["for"],xO=["id","value"],kO=["title","onClick"],cd="dddg.generated.colors",OO=Pe(ud(ad({},{inheritAttrs:!1}),{__name:"color",props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},emits:["leave","update:modelValue"],setup(t,{emit:e}){const n=Da(),o=De(),s=e,r=t,l=L("hsla"),a=S(()=>o.state.ui.vertical),i=S({get(){return r.format==="rgb"?Te.fromCss(r.modelValue).toHex():r.modelValue},set(g){if(r.format==="rgb"){const b=Te.fromCss(g);s("update:modelValue",b.toCss())}else s("update:modelValue",g)}});function u(g){const b=g.target.value;Te.validHex(b)&&(b.length===7||b.length===9)&&(i.value=b)}const c=S(()=>o.state.content.current.colors);function f(){if(c.value.find(w=>w.color===i.value))return;const g=o.state.content.contentPacks.find(w=>w.packId===cd)||{packId:cd,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},b=ud(ad({},g),{colors:[...g.colors,{label:i.value,color:i.value}]});K(()=>_O(this,null,function*(){yield o.dispatch("content/replaceContentPack",{contentPack:b,processed:!0})}))}function h(){K(()=>{o.commit("ui/setColorPicker",!0)})}function v(g){i.value=Te.fromCss(g.color).toHex()}return mt(()=>{Re.subscribe(kr,v)}),Ut(()=>{Re.unsubscribe(kr,v)}),(g,b)=>(k(),B("div",{class:Le([{color:!0,vertical:a.value},"v-w100 h-h100"])},[d("h2",null,$e(t.title),1),d("button",{onClick:b[0]||(b[0]=w=>g.$emit("leave"))},"OK"),d("table",null,[d("tr",null,[d("td",null,[d("button",{onClick:b[1]||(b[1]=w=>l.value="hsla")},"HSLA")]),d("td",null,[d("button",{onClick:b[2]||(b[2]=w=>l.value="rgba")},"RGBA")])])]),d("div",wO,[R(hO,{mode:l.value,modelValue:i.value,"onUpdate:modelValue":b[3]||(b[3]=w=>i.value=w),relative:!0},null,8,["mode","modelValue"]),d("div",PO,[d("label",{class:"hex-label",for:`hex_${ne(n)}`},"Hex",8,CO),d("input",{id:`hex_${ne(n)}`,value:i.value,onInput:u,onKeydown:b[4]||(b[4]=ie(()=>{},["stop"]))},null,40,xO)]),R(Wt,{direction:"global",class:"color-tools"},{default:Y(()=>[d("button",{onClick:f},"Add as swatch"),R(Ie,{class:"h-bl0 v-bt0",icon:"colorize",onClick:h},{default:Y(()=>[V("Pick color")]),_:1})]),_:1})]),d("div",{id:"color-swatches",class:Le({vertical:a.value})},[(k(!0),B(re,null,Ve(c.value,w=>(k(),B("button",{class:"swatch",key:w.color,style:Ke({backgroundColor:w.color}),title:w.label,onClick:$=>{i.value=w.color,s("leave")}},null,12,kO))),128))],2)],2))}}));const wl=Be(OO,[["__scopeId","data-v-c1f9b924"]]),$O={class:"fieldset_wrapper"},SO={key:0},IO={class:"fieldset_contents"},jO=Pe({__name:"d-fieldset",props:{title:{required:!0,type:String}},setup(t){const e=t;return(n,o)=>(k(),B("div",$O,[d("fieldset",null,[t.title>""?(k(),B("legend",SO,$e(e.title),1)):ce("",!0),d("div",IO,[en(n.$slots,"default",{},void 0,!0)])])]))}});const $t=Be(jO,[["__scopeId","data-v-60e241fa"]]),TO=["href"],Ge=Pe({__name:"link",props:{to:{type:String,required:!0}},setup(t){const e=L(null),n=t,o=S(()=>{let s=n.to;return s=s.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),s=s.replace(/^wiki:\/\/(.*)/,(r,l)=>"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+l.replaceAll(" ","-")),s});return(s,r)=>(k(),B("a",{target:"_blank",rel:"noopener noreferrer",ref_key:"root",ref:e,href:o.value},[en(s.$slots,"default")],8,TO))}});var AO=Object.defineProperty,dd=Object.getOwnPropertySymbols,EO=Object.prototype.hasOwnProperty,RO=Object.prototype.propertyIsEnumerable,fd=(t,e,n)=>e in t?AO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,BO=(t,e)=>{for(var n in e||(e={}))EO.call(e,n)&&fd(t,n,e[n]);if(dd)for(var n of dd(e))RO.call(e,n)&&fd(t,n,e[n]);return t},lr=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Ee=t=>(_t("data-v-3d98ba0e"),t=t(),wt(),t),MO=Ee(()=>d("h2",null,"Image options",-1)),DO={class:"column ok-col"},LO={key:0,class:"column"},NO=Ee(()=>d("label",{for:"compositionSelect"},"Compositing Mode:",-1)),FO=Ee(()=>d("option",{value:"source-over"},"Normal",-1)),HO=Ee(()=>d("option",{value:"source-atop"},"source-atop",-1)),UO=Ee(()=>d("option",{value:"destination-over"},"destination-over",-1)),VO=Ee(()=>d("option",{value:"destination-in"},"destination-in",-1)),WO=Ee(()=>d("option",{value:"destination-in"},"destination-out",-1)),zO=Ee(()=>d("option",{value:"destination-in"},"destination-atop",-1)),GO=Ee(()=>d("option",{value:"lighter"},"lighter",-1)),XO=Ee(()=>d("option",{value:"xor"},"xor",-1)),YO=Ee(()=>d("option",{value:"multiply"},"multiply",-1)),qO=Ee(()=>d("option",{value:"screen"},"screen",-1)),KO=Ee(()=>d("option",{value:"overlay"},"overlay",-1)),JO=Ee(()=>d("option",{value:"darken"},"darken",-1)),QO=Ee(()=>d("option",{value:"lighten"},"lighten",-1)),ZO=Ee(()=>d("option",{value:"color-dodge"},"color-dodge",-1)),e$=Ee(()=>d("option",{value:"color-burn"},"color-burn",-1)),t$=Ee(()=>d("option",{value:"hard-light"},"hard-light",-1)),n$=Ee(()=>d("option",{value:"soft-light"},"soft-light",-1)),o$=Ee(()=>d("option",{value:"difference"},"difference",-1)),s$=Ee(()=>d("option",{value:"exclusion"},"exclusion",-1)),r$=Ee(()=>d("option",{value:"hue"},"hue",-1)),l$=Ee(()=>d("option",{value:"saturation"},"saturation",-1)),i$=Ee(()=>d("option",{value:"color"},"color",-1)),a$=Ee(()=>d("option",{value:"luminosity"},"luminosity",-1)),u$=[FO,HO,UO,VO,WO,zO,GO,XO,YO,qO,KO,JO,QO,ZO,e$,t$,n$,o$,s$,r$,l$,i$,a$],c$=Ee(()=>d("label",{for:"addEffect"},"Add new effect",-1)),d$=["value"],f$=["disabled"],p$=["disabled"],h$=["disabled"],v$=["disabled"],g$=["onClick","onKeydown"],m$={key:0,class:"value-input-table"},b$=Ee(()=>d("td",null,[d("label",{for:"shadow_color"},"Color:")],-1)),y$=Ee(()=>d("td",null,[d("label",{for:"filter_x"},"X:")],-1)),_$=Ee(()=>d("td",null,[d("label",{for:"filter_y"},"Y:")],-1)),w$=Ee(()=>d("td",null,[d("label",{for:"filter_blur"},"Blur:")],-1)),P$=Ee(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),C$=["value","max","min"],x$={key:0},k$={colspan:"2"},O$=Ee(()=>d("td",null,[d("label",{for:"filter_value"},"Value:")],-1)),$$=["value","max","min"],S$={key:0},I$={colspan:"2"},j$=Pe({__name:"image-options",props:{type:{type:String,required:!0},title:{type:String},id:{},panelId:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],setup(t,{emit:e}){const n=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),o=(()=>{try{const F=lo();F.width=0,F.height=0;const C="filter"in F.getContext("2d");if(No(F),C)return Array.from(n.keys()).sort()}catch(F){}return["opacity"]})(),s=t,r=De(),l=L(""),a=L(0),i=S(()=>{switch(s.type){case"object":return r.state.panels.panels[s.panelId].objects[s.id];case"background":return r.state.panels.panels[s.panelId].background;case"panel":return r.state.panels.panels[s.panelId];default:throw new Rt.UnreachableCaseError(s.type)}}),u=S({get(){return i.value.composite},set(F){K(()=>{switch(s.type){case"object":r.commit("panels/setComposition",{id:s.id,panelId:s.panelId,composite:F});break;case"background":break;case"panel":break;default:throw new Rt.UnreachableCaseError(s.type)}})}}),c=S(()=>i.value.filters),f=S(()=>{var F;return(F=c.value[a.value])!=null?F:null}),h=S(()=>{const F=f.value;return F?Fc.has(F.type):!1}),v=S(()=>{const F=f.value;if(!!F){if(F.type==="hue-rotate")return 360;if(F.type==="grayscale"||F.type==="sepia"||F.type==="opacity"||F.type==="invert")return 100}}),g=S(()=>{const F=f.value;if(!!F)switch(F.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}});function b(F){return n.get(F)}function w(F){return Fc.has(F.type)?`${n.get(F.type)} ${(F.value*100).toFixed()}%`:F.type==="hue-rotate"?`${n.get(F.type)} ${F.value.toFixed()}\xB0`:F.type==="blur"?`${n.get(F.type)} ${F.value.toFixed()}px`:n.get(F.type)}function $(F){switch(s.type){case"object":return"panels/object_"+F;case"background":return"panels/background"+F[0].toUpperCase()+F.slice(1);case"panel":return"panels/"+F}}function p(){K(()=>lr(this,null,function*(){yield r.dispatch($("addFilter"),{id:s.id,panelId:s.panelId,type:l.value,idx:a.value+1})}))}function m(F){a.value=F}function _(){K(()=>lr(this,null,function*(){yield r.dispatch($("removeFilter"),{id:s.id,panelId:s.panelId,idx:a.value}),a.value>=i.value.filters.length&&(a.value=i.value.filters.length-1)}))}function A(F){K(()=>lr(this,null,function*(){yield r.dispatch($("moveFilter"),{id:s.id,panelId:s.panelId,idx:a.value,moveBy:F}),a.value+=F}))}function I(F){if(!(F instanceof InputEvent))return;let O=Number(F.target.value);h.value&&(O=O/100),E({value:O})}function E(F){K(()=>lr(this,null,function*(){yield r.dispatch($("setFilter"),BO({id:s.id,panelId:s.panelId,idx:a.value},F))}))}const j=S(()=>M(O=>new Fe(O,1,.5,1)).map(O=>O.toRgb().toCss()));function M(F){const O=[];for(let C=0;C<=8;++C)O.push(F(C/8));return O}const H=L(!1),te=je("color"),q=je("offsetX"),pe=je("offsetY"),we=je("blurRadius");function je(F){return S({get(){const O=f.value;if(!O||!(F in O))throw new Error("Tried reading shadow prop on a non shadow object");return O[F]},set(O){E({[F]:O})}})}return(F,O)=>H.value?(k(),ae(wl,{key:0,modelValue:ne(te),"onUpdate:modelValue":O[0]||(O[0]=C=>be(te)?te.value=C:null),format:"rgb",onLeave:O[1]||(O[1]=C=>H.value=!1)},null,8,["modelValue"])):(k(),ae(Wt,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:Y(()=>[MO,d("div",DO,[d("button",{onClick:O[2]||(O[2]=C=>F.$emit("leave"))},"Back")]),t.noComposition?ce("",!0):(k(),B("div",LO,[NO,R(Ge,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:Y(()=>[V("[?] ")]),_:1}),Oe(d("select",{id:"compositionSelect","onUpdate:modelValue":O[3]||(O[3]=C=>u.value=C),onKeydown:O[4]||(O[4]=ie(()=>{},["stop"]))},u$,544),[[Bt,u.value]])])),R($t,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:Y(()=>[R(Wt,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:Y(()=>[R(Wt,{direction:"vertical","no-wraping":""},{default:Y(()=>[c$,Oe(d("select",{id:"addEffect","onUpdate:modelValue":O[5]||(O[5]=C=>l.value=C),onKeydown:O[6]||(O[6]=ie(()=>{},["stop"]))},[(k(!0),B(re,null,Ve(ne(o),C=>(k(),B("option",{key:C,value:C},$e(b(C)),9,d$))),128))],544),[[Bt,l.value]]),d("button",{disabled:l.value==="",onClick:p,onKeydown:O[7]||(O[7]=ie(()=>{},["stop"]))}," Add ",40,f$),d("button",{disabled:!f.value,onClick:_,onKeydown:O[8]||(O[8]=ie(()=>{},["stop"]))}," Remove ",40,p$),d("button",{disabled:a.value===0,onClick:O[9]||(O[9]=C=>A(-1)),onKeydown:O[10]||(O[10]=ie(()=>{},["stop"]))}," Move up ",40,h$),d("button",{disabled:a.value===c.value.length-1||c.value.length===0,onClick:O[11]||(O[11]=C=>A(1)),onKeydown:O[12]||(O[12]=ie(()=>{},["stop"]))}," Move down ",40,v$)]),_:1}),R(Wt,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:Y(()=>[(k(!0),B(re,null,Ve(c.value,(C,x)=>(k(),B("div",{key:x,class:Le({choiceBtn:!0,active:x===a.value}),tabindex:"0",onClick:J=>m(x),onKeydown:[lt(J=>m(x),["enter"]),lt(ie(J=>m(x),["prevent"]),["space"])]},$e(w(C)),43,g$))),128))]),_:1}),f.value?(k(),B("table",m$,[f.value.type==="drop-shadow"?(k(),B(re,{key:0},[d("tr",null,[b$,d("td",null,[d("button",{id:"shadow_color",class:"color-button",style:Ke({background:ne(te)}),onClick:O[13]||(O[13]=C=>H.value=!0)}," \xA0 ",4)])]),d("tr",null,[y$,d("td",null,[Oe(d("input",{id:"filter_x",type:"number","onUpdate:modelValue":O[14]||(O[14]=C=>be(q)?q.value=C:null),onKeydown:O[15]||(O[15]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(q),void 0,{number:!0}]])])]),d("tr",null,[_$,d("td",null,[Oe(d("input",{id:"filter_y",type:"number","onUpdate:modelValue":O[16]||(O[16]=C=>be(pe)?pe.value=C:null),onKeydown:O[17]||(O[17]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(pe),void 0,{number:!0}]])])]),d("tr",null,[w$,d("td",null,[Oe(d("input",{id:"filter_blur",type:"number","onUpdate:modelValue":O[18]||(O[18]=C=>be(we)?we.value=C:null),onKeydown:O[19]||(O[19]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(we),void 0,{number:!0}]])])])],64)):h.value?(k(),B(re,{key:1},[d("tr",null,[P$,d("td",null,[d("input",{id:"filter_value",value:(f.value.value*100).toFixed(),type:"number",max:v.value,min:g.value,onInput:I,onKeydown:O[20]||(O[20]=ie(()=>{},["stop"]))},null,40,C$),V("% ")])]),g.value===0&&v.value!==void 0?(k(),B("tr",x$,[d("td",k$,[R(Qn,{gradientStops:["#000000","#ffffff"],label:"",maxValue:v.value,modelValue:f.value.value*100,"no-input":"","onUpdate:modelValue":O[21]||(O[21]=C=>E({value:Math.round(C)/100}))},null,8,["maxValue","modelValue"])])])):ce("",!0)],64)):(k(),B(re,{key:2},[d("tr",null,[O$,d("td",null,[d("input",{id:"filter_value",value:f.value.value,type:"number",max:v.value,min:g.value,onInput:I,onKeydown:O[22]||(O[22]=ie(()=>{},["stop"]))},null,40,$$)])]),g.value===0&&v.value!==void 0?(k(),B("tr",S$,[d("td",I$,[R(Qn,{gradientStops:j.value,label:"",maxValue:v.value,modelValue:f.value.value,"no-input":"","onUpdate:modelValue":O[23]||(O[23]=C=>E({value:Math.round(C)}))},null,8,["gradientStops","maxValue","modelValue"]),R(Qn,{gradientStops:j.value,label:"",maxValue:v.value,modelValue:f.value.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):ce("",!0)],64))])):ce("",!0)]),_:1})]),_:1})]),_:1}))}});const La=Be(j$,[["__scopeId","data-v-3d98ba0e"]]);var pd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const T$=["title"],A$=["title"],E$=Pe({__name:"button",props:{backgroundId:{type:String,required:!0}},setup(t){const e=De(),n=t,o=S(()=>{const h=e.state.panels.currentPanel;return e.state.panels.panels[h].background}),s=L(null),r=S(()=>{Object.keys(e.state.uploadUrls);const h=l.value;if(!h)return null;for(const v of h.variants)for(const g of v){const b=Bn(g,!1);if(b.startsWith("uploads:"))return Object.keys(e.state.uploadUrls),b.substring(8)}return null}),l=S(()=>e.getters["content/getBackgrounds"].get(n.backgroundId)||null),a=S(()=>n.backgroundId===o.value.current),i=S(()=>{var h;switch(n.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return(h=l.value.label)!=null?h:""}),u=S(()=>{var h;switch(n.backgroundId){case"buildin.static-color":return{"background-color":o.value.color};case"buildin.transparent":return{}}let v=!1;const g=(h=l.value)==null?void 0:h.variants[0].map(b=>{const w=Bn(b,!1);return w.startsWith("uploads:")&&(v=!0),`url('${w}')`}).join(",");return v&&Object.keys(e.state.uploadUrls),{backgroundImage:g!=null?g:""}});function c(){s.value.click()}function f(h){return pd(this,null,function*(){const v=s.value,g=r.value;if(!v.files)return;if(v.files.length!==1){console.error("More than one file uploaded!");return}const b=v.files[0];yield K(()=>pd(this,null,function*(){const w=URL.createObjectURL(b);yield e.dispatch("uploadUrls/add",{name:g,url:w})}))})}return(h,v)=>r.value!==null?(k(),B("div",{key:0,class:Le({background:!0,active:a.value}),title:i.value,style:Ke(u.value),tabindex:"0",onClick:v[0]||(v[0]=g=>c()),onKeypress:[v[1]||(v[1]=lt(ie(g=>c(),["prevent","stop"]),["enter"])),v[2]||(v[2]=lt(ie(g=>c(),["prevent","stop"]),["space"]))]},[V($e(i.value)+" ",1),d("input",{type:"file",style:{display:"none"},ref_key:"missingBackgroundUpload",ref:s,onChange:f},null,544)],46,T$)):(k(),B("div",{key:1,class:Le({background:!0,active:a.value}),title:i.value,style:Ke(u.value),tabindex:"0",onClick:v[3]||(v[3]=g=>h.$emit("input",t.backgroundId)),onKeydown:[v[4]||(v[4]=lt(g=>h.$emit("input",t.backgroundId),["enter"])),v[5]||(v[5]=lt(ie(g=>h.$emit("input",t.backgroundId),["prevent"]),["space"]))]},$e(i.value),47,A$))}});const R$=Be(E$,[["__scopeId","data-v-a03a1466"]]),B$={class:"toggle_box"},M$=["id"],D$=["for"],L$=["for"],ze=Pe({__name:"toggle",props:{label:String,modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,o=Da(),s=e,r=S({get(){return n.modelValue},set(a){s("update:modelValue",a)}}),l=L(null);return(a,i)=>(k(),B("div",B$,[Oe(d("input",{id:ne(o),type:"checkbox",ref_key:"checkbox",ref:l,"onUpdate:modelValue":i[0]||(i[0]=u=>r.value=u)},null,8,M$),[[nb,r.value]]),d("label",{for:ne(o),class:"switch"},null,8,D$),d("label",{for:ne(o),class:"toggle_label"},$e(t.label),9,L$)]))}});var N$=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Us=t=>(_t("data-v-29cb5d90"),t=t(),wt(),t),F$=Us(()=>d("label",{for:"bg_color"},"Color:",-1)),H$={key:1},U$={colspan:"3"},V$={key:0},W$={class:"arrow-col"},z$=Us(()=>d("td",{style:{"text-align":"center"}},"Variant",-1)),G$={class:"arrow-col"},X$={colspan:"3"},Y$=Us(()=>d("option",{value:"0"},"None",-1)),q$=Us(()=>d("option",{value:"1"},"Stretch",-1)),K$=Us(()=>d("option",{value:"2"},"Cover",-1)),J$=[Y$,q$,K$],Q$={colspan:"3"},Z$=Pe({__name:"settings",emits:["open-image-options","change-color"],setup(t,{emit:e}){const n=De(),o=e,s=S(()=>n.state.ui.vertical),r=S(()=>{const b=n.state.panels.currentPanel;return n.state.panels.panels[b].background}),l=S({get(){return r.value.flipped},set(b){K(()=>{n.commit("panels/setBackgroundFlipped",{flipped:b,panelId:n.state.panels.currentPanel})})}}),a=S({get(){return r.value.scaling.toString()},set(b){K(()=>{n.commit("panels/setBackgroundScaling",{scaling:parseInt(b,10),panelId:n.state.panels.currentPanel})})}}),i=S(()=>r.value.current),u=S(()=>n.state.content.current.backgrounds.find(b=>b.id===i.value)||null),c=S(()=>i.value==="buildin.static-color"),f=S({get(){return r.value.color},set(b){K(()=>{n.commit("panels/setBackgroundColor",{color:b,panelId:n.state.panels.currentPanel})})}}),h=S(()=>!!u.value),v=S(()=>u.value?u.value.variants.length>1:!1);function g(b){K(()=>N$(this,null,function*(){yield n.dispatch("panels/seekBackgroundVariant",{delta:b,panelId:n.state.panels.currentPanel})}))}return(b,w)=>(k(),ae($t,{class:Le({"bg-settings":!0,vertical:s.value}),title:"Settings:"},{default:Y(()=>[c.value?(k(),B(re,{key:0},[F$,d("button",{id:"bg_color",class:"color-button",style:Ke({background:f.value}),onClick:w[0]||(w[0]=$=>o("change-color"))},null,4)],64)):ce("",!0),h.value?(k(),B("table",H$,[d("tr",null,[d("td",U$,[R(ze,{modelValue:l.value,"onUpdate:modelValue":w[1]||(w[1]=$=>l.value=$),label:"Flipped?"},null,8,["modelValue"])])]),v.value?(k(),B("tr",V$,[d("td",W$,[d("button",{class:"small-button",onClick:w[2]||(w[2]=$=>g(-1))},"<")]),z$,d("td",G$,[d("button",{class:"small-button",onClick:w[3]||(w[3]=$=>g(1))},">")])])):ce("",!0),d("tr",null,[d("td",X$,[Oe(d("select",{"onUpdate:modelValue":w[4]||(w[4]=$=>a.value=$),onKeydown:w[5]||(w[5]=ie(()=>{},["stop"]))},J$,544),[[Bt,a.value]])])]),d("tr",null,[d("td",Q$,[d("button",{id:"image_options_button",class:"v-w100",onClick:w[6]||(w[6]=$=>o("open-image-options"))}," Image options ")])])])):ce("",!0)]),_:1},8,["class"]))}});const eS=Be(Z$,[["__scopeId","data-v-29cb5d90"]]);var tS=Object.defineProperty,nS=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,sS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,vd=(t,e,n)=>e in t?tS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lS=(t,e)=>{for(var n in e||(e={}))sS.call(e,n)&&vd(t,n,e[n]);if(hd)for(var n of hd(e))rS.call(e,n)&&vd(t,n,e[n]);return t},iS=(t,e)=>nS(t,oS(e)),ir=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const aS=t=>(_t("data-v-3d68fb70"),t=t(),wt(),t),uS=aS(()=>d("h1",null,"Background",-1)),cS=Pe({__name:"backgrounds",setup(t){const e={packId:"dddg.uploads.backgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},n=De(),o=L(null);Mt(o);const s=L(!1),r=L(!1),l=S({get(){return n.state.panels.panels[n.state.panels.currentPanel].background.color},set(p){K(()=>{n.commit("panels/setBackgroundColor",{color:p,panelId:n.state.panels.currentPanel})})}}),a=S(()=>[...n.state.content.current.backgrounds.map(p=>p.id),"buildin.static-color","buildin.transparent"]),i=S(()=>he.supports.openableFolders.has("backgrounds"));function u(p){n.commit("panels/setCurrentBackground",{current:p,panelId:n.state.panels.currentPanel})}function c(){he.openFolder("backgrounds")}const f=L(null);function h(p){const m=f.value;if(!!m.files)for(const _ of m.files)v(_)}function v(p){return ir(this,null,function*(){yield K(()=>ir(this,null,function*(){const m=URL.createObjectURL(p),_=yield n.dispatch("uploadUrls/add",{name:p.name,url:m});yield b(p.name,p.name,_)}))})}function g(){const p=prompt("Enter the URL of the image");if(p==null)return;const m=p.split("/").slice(-1)[0];b(m,m,p)}function b(p,m,_){return ir(this,null,function*(){const A=n.state.content.contentPacks.find(E=>E.packId===e.packId)||e,I=iS(lS({},A),{backgrounds:[...A.backgrounds,{id:p,label:m,variants:[[{hq:_,lq:_,sourcePack:e.packId}]],scaling:"none"}]});yield K(()=>ir(this,null,function*(){yield n.dispatch("content/replaceContentPack",{contentPack:I,processed:!0}),u(p)}))})}const w=L(null);function $(p){!p.dataTransfer||(p.dataTransfer.effectAllowed="none",Array.from(p.dataTransfer.items).find(m=>m.type.match(/^image.*$/))&&(p.dataTransfer.effectAllowed="link",w.value.show()))}return(p,m)=>(k(),B("div",{class:"panel",ref_key:"root",ref:o,onDragenter:$,onMouseleave:m[7]||(m[7]=_=>w.value.hide())},[R(Iv,{ref_key:"dt",ref:w,class:"drop-target",onDrop:v},{default:Y(()=>[V("Drop here to add as a new background ")]),_:1},512),uS,s.value?(k(),ae(wl,{key:0,modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=_=>l.value=_),onLeave:m[1]||(m[1]=_=>s.value=!1)},null,8,["modelValue"])):r.value?(k(),ae(La,{key:1,type:"background",title:"","panel-id":ne(n).state.panels.currentPanel,"no-composition":"",onLeave:m[2]||(m[2]=_=>r.value=!1)},null,8,["panel-id"])):(k(),B(re,{key:2},[R(eS,{onChangeColor:m[3]||(m[3]=_=>s.value=!0),onOpenImageOptions:m[4]||(m[4]=_=>r.value=!0)}),R(Ie,{icon:"upload",class:"upload-background",onClick:m[5]||(m[5]=_=>f.value.click())},{default:Y(()=>[V(" Upload "),d("input",{type:"file",ref_key:"upload",ref:f,onChange:h},null,544)]),_:1}),R(Ie,{icon:"link",class:"upload-background",onClick:g},{default:Y(()=>[V(" Add by URL ")]),_:1}),R(Ie,{icon:"extension",class:"upload-background",onClick:m[6]||(m[6]=_=>p.$emit("show-dialog","type: Backgrounds"))},{default:Y(()=>[V(" Search in content packs ")]),_:1}),i.value?(k(),ae(Ie,{key:0,icon:"folder",class:"upload-background",onClick:c},{default:Y(()=>[V(" Open backgrounds folder ")]),_:1})):ce("",!0),(k(!0),B(re,null,Ve(a.value,_=>(k(),ae(R$,{key:_,backgroundId:_,onInput:A=>u(_)},null,8,["backgroundId","onInput"]))),128))],64))],544))}});const dS=Be(cS,[["__scopeId","data-v-3d68fb70"]]);function Na(t,e,n,o,s){return S({get(){return e.value[s]},set(r){K(()=>{t[o?"dispatch":"commit"](n,{panelId:e.value.panelId,id:e.value.id,key:s,value:r})})}})}function zo(t,e,n,o,s){return S({get(){return e.value[s]},set(r){K(()=>{t[o?"dispatch":"commit"](n,{panelId:e.value.panelId,id:e.value.id,[s]:r})})}})}var fS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const pS=["onKeydown"],gd=960,hS=Pe({__name:"part-button",props:{part:{required:!0,type:Object},value:{required:!0},size:{type:Number,default:150}},emits:["quick-click","click"],setup(t,{emit:e}){const n=t,o=e,s=L([]),r=S(()=>n.size/n.part.size[0]),l=S(()=>n.size/n.part.size[1]),a=S(()=>`${Math.floor(gd*r.value)}px ${Math.floor(gd*l.value)}px`),i=S(()=>{var h,v;let g="";const b=a.value,w=(h=n.part.offset)!=null?h:[0,0],$=n.part.images.length-1;for(let p=0;p<=$;++p){const m=n.part.images[$-p],_=s.value[$-p];if(!_)continue;p>0&&(g+=", ");const A=(v=m.offset)!=null?v:[0,0],I=`${Math.floor((w[0]-A[0])*-r.value)}px ${Math.floor((w[1]-A[1])*-l.value)}px`;g+=`url('${_.replace("'","\\'")}') ${I} / ${b}`}return g}),u=S(()=>({height:n.size+"px",width:n.size+"px",background:i.value}));function c(h){h.preventDefault(),o("quick-click")}function f(){return fS(this,null,function*(){s.value=yield Promise.all(n.part.images.map(h=>typeof h.asset=="string"?Vb(h.asset,!1):Bn(h.asset,!1)))})}return Wo("Initialization of parts button",f),(h,v)=>{var g;return k(),B("div",{class:Le({part:!0,active:(g=t.part)==null?void 0:g.active}),style:Ke(u.value),tabindex:"0",onClick:v[0]||(v[0]=b=>o("click")),onContextmenu:c,onKeydown:[v[1]||(v[1]=lt(ie(b=>o("click"),["prevent"]),["enter"])),lt(ie(c,["prevent"]),["space"])]},null,46,pS)}}});const md=Be(hS,[["__scopeId","data-v-fcce95d0"]]);var Yl=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const vS=Pe({__name:"parts",props:{character:{type:Object,required:!0},part:{required:!0,type:String}},emits:["leave","show-dialog","show-expression-dialog"],setup(t,{emit:e}){const n=t,o=De(),s=e,r=L(null),l=L([]),a=S(()=>{switch(n.part){case"head":return"Expressions";case"style":return"Styles";default:return"Poses"}}),i=S(()=>dl(o,n.character)),u=S(()=>{if(n.part!=="style")return[];const p=i.value.styleGroups[n.character.styleGroupId];return p.styleComponents.map(m=>{const _={};for(const A in m.variants){if(!m.variants.hasOwnProperty(A))continue;const I=m.variants[A];_[A]={size:p.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:I}],active:!1}}return{label:m.label,name:m.id,buttons:_}})}),c=S(()=>{const p={};let m,_,A;const I=i.value,E=Ho(I,n.character);switch(n.part){case"head":{const M=n.character.posePositions.headType||0,H=n.character.posePositions.head||0;for(let te=0;te<E.compatibleHeads.length;++te){const q=E.compatibleHeads[te],pe=I.heads[q];for(let we=0;we<pe.variants.length;++we){const je=pe.variants[we];p[`${te}_${we}`]={size:pe.previewSize,offset:pe.previewOffset,images:je.map(F=>({asset:F,offset:[0,0]})),active:H===we&&M===te}}}return p}case"pose":const j=I.styleGroups[n.character.styleGroupId].styles[n.character.styleId];for(let M=0;M<j.poses.length;++M){const H=j.poses[M];p[M]=h(H),p[M].active=M===n.character.poseId}return p;case"style":for(let M=0;M<I.styleGroups.length;++M){const H=I.styleGroups[M];p[H.id]=h(H.styles[0].poses[0]),p[H.id].active=M===n.character.styleGroupId}return p;default:m=E.positions[n.part],A=E.previewSize,_=E.previewOffset;break}for(let j=0;j<m.length;++j){const M=m[j];p[j]={images:M.map(H=>({offset:[0,0],asset:H})),size:A,offset:_,active:j===(n.character.posePositions[n.part]||0)}}return p});function f(){const p=i.value.styleGroups[n.character.styleGroupId].styles[n.character.styleId];l.value=Object.keys(p.components).map(m=>[m,p.components[m]])}function h(p){const m=i.value;let _=[];for(const A of p.renderCommands)switch(A.type){case"pose-part":const I=p.positions[A.part];if(I==null||I.length===0)break;_=_.concat(I[0].map(E=>({asset:E,offset:A.offset})));break;case"head":{const E=m.heads[p.compatibleHeads[0]];if(p.compatibleHeads.length===0)break;const j=E.variants[0];_=_.concat(j.map(M=>({asset:M,offset:A.offset})));break}case"image":_=_.concat(A.images.map(E=>({asset:E,offset:A.offset})));break}return{images:_,size:p.previewSize,offset:p.previewOffset,active:!1}}function v(p){p==null&&(p=n.character.styleGroupId);const _=i.value.styleGroups[p];let A=_.styles;for(const I of l.value){const E=A.filter(j=>j.components[I[0]]===I[1]);E.length>0&&(A=E)}K(()=>Yl(this,null,function*(){yield o.dispatch("panels/setCharStyle",{id:n.character.id,panelId:n.character.panelId,styleGroupId:p,styleId:_.styles.indexOf(A[0])})}))}function g(p){if(n.part==="style")v(i.value.styleGroups.findIndex(m=>m.id===p));else if(n.part==="head"){const[m,_]=(""+p).split("_",2).map(A=>parseInt(A,10));o.commit("panels/setPosePosition",{id:n.character.id,panelId:n.character.panelId,posePositions:{headType:m,head:_}})}else $(n.part,parseInt(""+p,10))}function b(p,m){const _=l.value.findIndex(A=>A[0]===p);l.value.splice(_,1),l.value.unshift([p,""+m]),v()}function w(p){(p.key==="Backspace"||p.key==="Escape")&&(s("leave"),p.preventDefault(),p.stopPropagation())}function $(p,m){K(()=>Yl(this,null,function*(){yield o.dispatch("panels/setPart",{id:n.character.id,panelId:n.character.panelId,part:p,val:m})}))}return Wo("Initializing parts data",()=>Yl(this,null,function*(){r.value=yield Do()})),Xe(()=>n.character,f,{immediate:!0}),(p,m)=>(k(),ae(Wt,{"no-wraping":"",onKeydown:w},{default:Y(()=>[d("button",{onClick:m[0]||(m[0]=_=>s("leave"))},"Back"),t.part==="head"?(k(),ae(Ie,{key:0,icon:"extension",onClick:m[1]||(m[1]=_=>s("show-expression-dialog",{character:t.character.characterType}))},{default:Y(()=>[V(" Create new expressions ")]),_:1})):ce("",!0),R(Ie,{icon:"extension",onClick:m[2]||(m[2]=_=>s("show-dialog",`type: ${a.value} character: ${i.value.label}`))},{default:Y(()=>[V(" Search in content packs ")]),_:1}),(k(!0),B(re,null,Ve(c.value,(_,A)=>(k(),ae(md,{key:A,value:A,part:_,onClick:I=>{g(A),s("leave")},onQuickClick:I=>g(A)},null,8,["value","part","onClick","onQuickClick"]))),128)),(k(!0),B(re,null,Ve(u.value,_=>(k(),ae($t,{key:_.name,title:_.label},{default:Y(()=>[R(Wt,{noWraping:""},{default:Y(()=>[(k(!0),B(re,null,Ve(_.buttons,(A,I)=>(k(),ae(md,{size:130,key:I,value:I,part:A,onClick:E=>b(_.name,I)},null,8,["value","part","onClick"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))}});const gS=Be(vS,[["__scopeId","data-v-3aae698b"]]);var mS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const bS=Pe({__name:"delete",props:{obj:{required:!0,type:Object}},setup(t){const e=De(),n=t;function o(){K(()=>mS(this,null,function*(){yield e.dispatch("panels/removeObject",{panelId:n.obj.panelId,id:n.obj.id})}))}return(s,r)=>(k(),B("button",{onClick:o},"Delete"))}});var yS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const _S=Pe({__name:"layers",props:{object:{required:!0,type:Object}},setup(t){const e=De(),n=t,o=zo(e,S(()=>n.object),"panels/setOnTop",!0,"onTop");function s(r){K(()=>yS(this,null,function*(){yield e.dispatch("panels/shiftLayer",{id:n.object.id,panelId:n.object.panelId,delta:r})}))}return(r,l)=>(k(),ae($t,{id:"layerfs",title:"Layer:"},{default:Y(()=>[R(Wt,{class:"layer_flow",direction:"horizontal"},{default:Y(()=>[R(Ie,{icon:"vertical_align_bottom","icon-pos":"top",onClick:l[0]||(l[0]=a=>s(-1/0)),title:"Move to back"}),R(Ie,{icon:"arrow_downward","icon-pos":"top",onClick:l[1]||(l[1]=a=>s(-1)),title:"Move backwards"}),R(Ie,{icon:"arrow_upward","icon-pos":"top",onClick:l[2]||(l[2]=a=>s(1)),title:"Move forwards"}),R(Ie,{icon:"vertical_align_top","icon-pos":"top",onClick:l[3]||(l[3]=a=>s(1/0)),title:"Move to front"})]),_:1}),R(ze,{modelValue:ne(o),"onUpdate:modelValue":l[4]||(l[4]=a=>be(o)?o.value=a:null),label:"In front?"},null,8,["modelValue"])]),_:1}))}});const wS=Be(_S,[["__scopeId","data-v-59722cd0"]]);var PS=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Pl=t=>(_t("data-v-e3c4690d"),t=t(),wt(),t),CS={class:"v-w100"},xS={colspan:"2"},kS={key:0},OS={colspan:"2"},$S={class:"v-w100 button-tbl"},SS={class:"arrow-col"},IS=["disabled"],jS=["value"],TS={class:"arrow-col"},AS=["disabled"],ES=Pl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_x"},"X:")],-1)),RS={class:"v-w50"},BS=Pl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_y"},"Y:")],-1)),MS={class:"v-w50"},DS=Pl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_w"},"Width:")],-1)),LS={class:"v-w50"},NS=Pl(()=>d("td",{class:"v-w50"},[d("label",{for:"sprite_h"},"Height:")],-1)),FS={class:"v-w50"},HS=Pe({__name:"position-and-size",props:{obj:{required:!0,type:Object}},setup(t){const e=De(),n=t,o=S({get(){const b=le().TextBox;return n.obj.height-(l.value?b.NameboxHeight:0)},set(b){const w=le().TextBox;K(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:b+(l.value?w.NameboxHeight:0),width:n.obj.width})})}}),s=S({get(){return n.obj.width},set(b){K(()=>{e.commit("panels/setSize",{id:n.obj.id,panelId:n.obj.panelId,height:n.obj.height,width:b})})}}),r=S(()=>{const b=n.obj;if(b.type==="textBox")return xs[b.style].resizable;const w=le().Poem;return b.type==="poem"?w.poemBackgrounds[b.background].file.startsWith("internal:"):!1}),l=S(()=>n.obj.type==="textBox"&&location.search.includes("alex")),a=S(()=>"freeMove"in n.obj),i=S(()=>le().Base.positions),u=S(()=>f.value===0),c=S(()=>f.value===le().Base.positions.length-1),f=S({get(){return Lr(n.obj.x)},set(b){K(()=>PS(this,null,function*(){yield e.dispatch("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:le().Base.characterPositions[b],y:n.obj.y})}))}}),h=S({get(){return!!n.obj.freeMove},set(b){K(()=>{e.commit("panels/setFreeMove",{id:n.obj.id,panelId:n.obj.panelId,freeMove:b})})}}),v=S({get(){return n.obj.x},set(b){K(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:b,y:g.value})})}}),g=S({get(){return n.obj.y},set(b){K(()=>{e.commit("panels/setPosition",{id:n.obj.id,panelId:n.obj.panelId,x:v.value,y:b})})}});return(b,w)=>(k(),ae($t,{title:"Position"+(r.value?"/Size":"")},{default:Y(()=>[d("table",CS,[d("tr",null,[d("td",xS,[a.value?(k(),ae(ze,{key:0,modelValue:h.value,"onUpdate:modelValue":w[0]||(w[0]=$=>h.value=$),label:"Move freely?"},null,8,["modelValue"])):ce("",!0)])]),a.value&&!h.value?(k(),B("tr",kS,[d("td",OS,[d("table",$S,[d("tr",null,[d("td",SS,[d("button",{onClick:w[1]||(w[1]=$=>--f.value),disabled:u.value},"<",8,IS)]),d("td",null,[Oe(d("select",{id:"current_talking",class:"v-w100",style:{"text-align":"center"},"onUpdate:modelValue":w[2]||(w[2]=$=>f.value=$)},[(k(!0),B(re,null,Ve(i.value,($,p)=>(k(),B("option",{key:p,value:p},$e($),9,jS))),128))],512),[[Bt,f.value,void 0,{number:!0}]])]),d("td",TS,[d("button",{onClick:w[3]||(w[3]=$=>++f.value),disabled:c.value},">",8,AS)])])])])])):(k(),B(re,{key:1},[d("tr",null,[ES,d("td",RS,[Oe(d("input",{id:"sprite_x",class:"w100",type:"number","onUpdate:modelValue":w[4]||(w[4]=$=>v.value=$),onKeydown:w[5]||(w[5]=ie(()=>{},["stop"]))},null,544),[[Ye,v.value,void 0,{number:!0}]])])]),d("tr",null,[BS,d("td",MS,[Oe(d("input",{class:"w100",id:"sprite_y",type:"number","onUpdate:modelValue":w[6]||(w[6]=$=>g.value=$),onKeydown:w[7]||(w[7]=ie(()=>{},["stop"]))},null,544),[[Ye,g.value,void 0,{number:!0}]])])])],64)),r.value?(k(),B(re,{key:2},[d("tr",null,[DS,d("td",LS,[Oe(d("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":w[8]||(w[8]=$=>s.value=$),onKeydown:w[9]||(w[9]=ie(()=>{},["stop"]))},null,544),[[Ye,s.value,void 0,{number:!0}]])])]),d("tr",null,[NS,d("td",FS,[Oe(d("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":w[10]||(w[10]=$=>o.value=$),onKeydown:w[11]||(w[11]=ie(()=>{},["stop"]))},null,544),[[Ye,o.value,void 0,{number:!0}]])])])],64)):ce("",!0)])]),_:1},8,["title"]))}});const US=Be(HS,[["__scopeId","data-v-e3c4690d"]]);var VS=Object.defineProperty,WS=Object.defineProperties,zS=Object.getOwnPropertyDescriptors,bd=Object.getOwnPropertySymbols,GS=Object.prototype.hasOwnProperty,XS=Object.prototype.propertyIsEnumerable,yd=(t,e,n)=>e in t?VS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,YS=(t,e)=>{for(var n in e||(e={}))GS.call(e,n)&&yd(t,n,e[n]);if(bd)for(var n of bd(e))XS.call(e,n)&&yd(t,n,e[n]);return t},qS=(t,e)=>WS(t,zS(e));const KS=t=>(_t("data-v-e63aaa5e"),t=t(),wt(),t),JS={class:"column ok-col"},QS={class:"column"},ZS=["value"],eI={key:0,class:"column error-col"},tI={class:"column"},nI=KS(()=>d("p",{class:"hint-col"},"Apply style to selected text:",-1)),oI={class:"column"},sI={class:"column"},rI={class:"column"},lI=gm('<option value data-v-e63aaa5e>Font</option><option value="aller" style="font-family:aller;" data-v-e63aaa5e> Aller (Textbox) </option><option value="riffic" style="font-family:riffic;" data-v-e63aaa5e> Riffic (Bold text) </option><option value="hashtag" style="font-family:hashtag;" data-v-e63aaa5e> Hashtag (Sayori) </option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-e63aaa5e> Ammy&#39;s Handwriting (Natsuki) </option><option value="journal" style="font-family:journal;" data-v-e63aaa5e> Journal (Monika) </option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-e63aaa5e> JP Hand Slanted (Yuri) </option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-e63aaa5e> Damagrafik (Yuri, Act 2) </option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-e63aaa5e> As I Lay Dying (Yuri, Act Unused) </option><option value="halogen" style="font-family:halogen;" data-v-e63aaa5e> Halogen (MC) </option>',10),iI=[lI],aI=Pe(qS(YS({},{inheritAttrs:!1}),{__name:"text",props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},emits:["update:modelValue","leave"],setup(t,{emit:e}){const n=De(),o=e,s=L(null),r=L(""),l=L(""),a=L("#000000"),i=L(0),u=L(0),c=L(""),f=S(()=>n.state.ui.vertical);Xe(()=>l.value,()=>{l.value!==""&&(w("font",l.value),l.value="")});function h(){const $=le(),p=s.value.value;try{new Ot(p,$.TextBox.NameboxTextStyle),c.value=""}catch(m){c.value=m.message}o("update:modelValue",p)}function v($){const p=s.value;r.value=$,i.value=p.selectionStart,u.value=p.selectionEnd}function g(){const $=a.value,p=r.value,m=()=>{const _=s.value;if(!_){eo(m);return}_.selectionStart=i.value,_.selectionEnd=u.value,w(p==="text"?"color":"outlinecolor",$)};eo(m),a.value="#000000",r.value=""}function b($){const p=s.value,m=p.value,_=p.selectionStart,A=p.selectionEnd;p.value=m.slice(0,_)+$+m.slice(A),p.selectionStart=p.selectionEnd=_+$.length,p.focus(),h()}function w($,p){const m=s.value,_=m.value,A=m.selectionStart,I=m.selectionEnd,E=_.slice(A,I),j=_.slice(0,A),M=_.slice(I);let H=$;p&&(H+="="+p),m.value=`${j}{${H}}${E}{/${$}}${M}`,m.selectionStart=A+H.length+2,m.selectionEnd=m.selectionStart+E.length,m.focus(),h()}return($,p)=>r.value?(k(),ae(wl,{key:0,modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=m=>a.value=m),onLeave:g},null,8,["modelValue"])):(k(),B("div",{key:1,class:Le({"text-subpanel":!0,vertical:f.value})},[d("h2",null,$e(t.title),1),d("div",JS,[d("button",{onClick:p[1]||(p[1]=m=>o("leave"))},"OK")]),d("div",QS,[d("textarea",{ref_key:"textArea",ref:s,value:t.modelValue,onInput:h,onKeydown:p[2]||(p[2]=ie(()=>{},["stop"])),onKeypress:p[3]||(p[3]=ie(()=>{},["stop"]))},null,40,ZS)]),c.value?(k(),B("div",eI,$e(c.value),1)):ce("",!0),d("div",tI,[d("button",{onClick:p[4]||(p[4]=m=>b("\\\\")),class:"style-button"},"Insert \\"),d("button",{onClick:p[5]||(p[5]=m=>b("\\{")),class:"style-button"},"Insert {"),d("button",{onClick:p[6]||(p[6]=m=>b("\\}")),class:"style-button"},"Insert }")]),nI,d("div",oI,[d("button",{onClick:p[7]||(p[7]=m=>w("b")),class:"style-button",style:{"font-weight":"bold"}}," Bold "),d("button",{onClick:p[8]||(p[8]=m=>w("i")),class:"style-button",style:{"font-style":"italic"}}," Italics "),d("button",{onClick:p[9]||(p[9]=m=>w("plain")),class:"style-button"}," Plain "),d("button",{onClick:p[10]||(p[10]=m=>w("edited")),class:"style-button edited-style"}," Edited "),d("button",{onClick:p[11]||(p[11]=m=>w("k",2)),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),d("div",sI,[d("button",{onClick:p[12]||(p[12]=m=>w("alpha",.5)),class:"style-button"}," Alpha ")]),d("div",rI,[d("button",{onClick:p[13]||(p[13]=m=>w("size",12)),class:"style-button",style:{"font-size":"20px"}}," Font size "),Oe(d("select",{"onUpdate:modelValue":p[14]||(p[14]=m=>l.value=m),class:"style-button"},iI,512),[[Bt,l.value]]),d("button",{onClick:p[15]||(p[15]=m=>v("text")),class:"style-button"}," Text color "),d("button",{onClick:p[16]||(p[16]=m=>v("outline")),class:"style-button"}," Outline color ")])],2))}}));const uI=Be(aI,[["__scopeId","data-v-e63aaa5e"]]);var cI=Object.defineProperty,_d=Object.getOwnPropertySymbols,dI=Object.prototype.hasOwnProperty,fI=Object.prototype.propertyIsEnumerable,wd=(t,e,n)=>e in t?cI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pd=(t,e)=>{for(var n in e||(e={}))dI.call(e,n)&&wd(t,n,e[n]);if(_d)for(var n of _d(e))fI.call(e,n)&&wd(t,n,e[n]);return t},ql=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const nn=t=>(_t("data-v-b46f0fb4"),t=t(),wt(),t),pI=nn(()=>d("span",{class:"icon material-icons"},"edit",-1)),hI=nn(()=>d("p",{class:"modal-text"},"Enter the new name",-1)),vI={class:"modal-text"},gI=nn(()=>d("label",{for:"linked_to",class:"v-w100"},"Linked with:",-1)),mI=nn(()=>d("option",{value:""},"None",-1)),bI=["value"],yI={class:"input-table v-w100"},_I=nn(()=>d("td",null,[d("label",{for:"rotation",class:"v-w100"},"Rotation:\xA0\xB0")],-1)),wI={for:"zoom",class:"v-w100"},PI={key:0},CI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Scale Y: ")],-1)),xI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew X: ")],-1)),kI=nn(()=>d("td",null,[d("label",{for:"zoom",class:"v-w100"},"Skew Y: ")],-1)),OI={key:0,colspan:"2"},$I={key:0},SI=nn(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),II=nn(()=>d("td",null,[d("label",{for:"namebox_width"},"Namebox width:")],-1)),jI=["placeholder"],TI=Pe({__name:"object-tool",props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},setup(t){const e=De(),n=L(null),o=t,s=(O,C)=>zo(e,S(()=>o.object),C,!1,O);Mt(n);const r=S({get(){var O;return(O=o.object.linkedTo)!=null?O:""},set(O){const C=o.object,x=O===""?null:O,J=Vo(e),ve=J==null?void 0:J.getLastRenderObject(C.id),Ce=x===null?J==null?void 0:J.getLastRenderObject(C.linkedTo):J==null?void 0:J.getLastRenderObject(x);try{if(!ve||!Ce)e.commit("panels/setLink",{panelId:g.value.id,id:C.id,link:x,x:C.x,y:C.y,scaleX:C.scaleX,scaleY:C.scaleY,skewX:C.skewX,skewY:C.skewY,rotation:C.rotation});else if(x==null)e.commit("panels/setLink",Pd({panelId:g.value.id,id:C.id,link:x},Tr(ve.preparedTransform)));else{const at=Ce.preparedTransform.inverse().multiply(ve.preparedTransform);console.log(ve.preparedTransform),console.log(Ce.preparedTransform.multiply(at)),console.log(at),e.commit("panels/setLink",Pd({panelId:g.value.id,id:C.id,link:x},Tr(at)))}}catch(Me){Re.fire(new Zr(Me.message))}}}),l=L(!1),a=L(""),i=L(!1),u=L(null),c=s("flip","panels/setFlip"),f=s("rotation","panels/setRotation"),h=s("enlargeWhenTalking","panels/setEnlargeWhenTalking"),v=S(()=>"overflow"in o.object),g=S(()=>e.state.panels.panels[o.object.panelId]),b=S(()=>{const O=g.value,C=[];for(const x of[...O.order,...O.onTopOrder]){const J=O.objects[x];J.label===null||J===o.object||C.push([x,J.label])}return C}),w=location.search.includes("alex"),$=S({get(){var O;return(O=o.object.overflow)!=null?O:!1},set(O){K(()=>ql(this,null,function*(){yield e.commit("panels/setOverflow",{id:o.object.id,panelId:o.object.panelId,overflow:O})}))}}),p=S({get(){return o.object.preserveRatio},set(O){K(()=>ql(this,null,function*(){yield e.dispatch("panels/setPreserveRatio",{id:o.object.id,panelId:o.object.panelId,preserveRatio:O})}))}}),m=S({get(){const O=o.object.nameboxWidth;return O===null?"":O},set(O){const C=typeof O=="string"&&O.trim()===""?null:parseInt(O+"");K(()=>{e.commit("panels/setObjectNameboxWidth",{id:o.object.id,panelId:o.object.panelId,nameboxWidth:C})})}}),_=S({get(){return o.object.scaleX*100},set(O){K(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:O/100,scaleY:o.object.preserveRatio?O/100*o.object.ratio:o.object.scaleY})})}}),A=S({get(){return o.object.scaleY*100},set(O){K(()=>{e.commit("panels/setObjectScale",{id:o.object.id,panelId:o.object.panelId,scaleX:o.object.preserveRatio?O/100/o.object.ratio:o.object.scaleX,scaleY:O/100})})}}),I=S({get(){return o.object.skewX},set(O){K(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:O,skewY:o.object.skewY})})}}),E=S({get(){return o.object.skewY},set(O){K(()=>{e.commit("panels/setObjectSkew",{id:o.object.id,panelId:o.object.panelId,skewX:o.object.skewX,skewY:O})})}}),j=S(()=>le().TextBox.NameboxWidth),M=S(()=>u.value||o.colorHandler||null),H=S(()=>o.object.label!==null),te=S(()=>{var O,C;return(C=(O=o.object.label)!=null?O:o.title)!=null?C:"Object"}),q=S({get(){return o.object.textboxColor!==null},set(O){K(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:O?le().TextBoxCustom.textboxDefaultColor:null})})}});function pe(){K(()=>ql(this,null,function*(){yield e.dispatch("panels/copyObjectToClipboard",{panelId:o.object.panelId,id:o.object.id})}))}function we(){var O;a.value=(O=o.object.label)!=null?O:"",i.value=!0}function je(O){i.value=!1,O==="Apply"&&K(()=>{e.commit("panels/setLabel",{panelId:o.object.panelId,id:o.object.id,label:a.value})})}function F(){u.value={title:"Textbox color",get:()=>o.object.textboxColor,set:O=>{K(()=>{e.commit("panels/setTextboxColor",{panelId:o.object.panelId,id:o.object.id,textboxColor:O})})},leave:()=>{u.value=null}}}return(O,C)=>(k(),B("div",{class:"panel",ref_key:"root",ref:n},[d("h1",{style:Ke({fontStyle:H.value?"italic":"normal"}),onClick:we},[V($e(te.value)+" ",1),pI],4),(k(),ae(yf,{to:"#modal-messages"},[i.value?(k(),ae(So,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:je,onLeave:C[2]||(C[2]=x=>je("Cancel"))},{default:Y(()=>[hI,d("p",vI,[Oe(d("input",{"onUpdate:modelValue":C[0]||(C[0]=x=>a.value=x),style:{width:"100%"},onKeydown:C[1]||(C[1]=lt(ie(x=>je("Apply"),["prevent","stop"]),["enter"]))},null,544),[[Ye,a.value]])])]),_:1})):ce("",!0)])),t.textHandler?(k(),ae(uI,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":C[3]||(C[3]=x=>t.textHandler.set(x)),onLeave:C[4]||(C[4]=x=>t.textHandler.leave())},null,8,["title","modelValue"])):M.value?(k(),ae(wl,{key:1,title:M.value.title,modelValue:M.value.get(),"onUpdate:modelValue":C[5]||(C[5]=x=>M.value.set(x)),onLeave:C[6]||(C[6]=x=>M.value.leave())},null,8,["title","modelValue"])):l.value?(k(),ae(La,{key:2,type:"object","panel-id":t.object.panelId,id:t.object.id,onLeave:C[7]||(C[7]=x=>l.value=!1)},null,8,["panel-id","id"])):t.showAltPanel?en(O.$slots,"alt-panel",{key:3},void 0,!0):(k(),B(re,{key:4},[en(O.$slots,"default",{},void 0,!0),v.value?(k(),ae(ze,{key:0,modelValue:$.value,"onUpdate:modelValue":C[8]||(C[8]=x=>$.value=x),label:"Overflow",title:"Allow the text to move outside of the textbox"},null,8,["modelValue"])):ce("",!0),R(US,{obj:t.object},null,8,["obj"]),R(wS,{object:t.object},null,8,["object"]),R($t,{title:"Transform",class:"transforms"},{default:Y(()=>[R(ze,{modelValue:ne(c),"onUpdate:modelValue":C[9]||(C[9]=x=>be(c)?c.value=x:null),label:"Flip?"},null,8,["modelValue"]),gI,Oe(d("select",{id:"linked_to",class:"v-w100","onUpdate:modelValue":C[10]||(C[10]=x=>r.value=x),onKeydown:C[11]||(C[11]=ie(()=>{},["stop"]))},[mI,(k(!0),B(re,null,Ve(b.value,([x,J])=>(k(),B("option",{key:x,value:x},$e(J),9,bI))),128))],544),[[Bt,r.value]]),d("table",yI,[d("tr",null,[_I,d("td",null,[Oe(d("input",{id:"rotation",class:"smol v-w100",type:"number","onUpdate:modelValue":C[12]||(C[12]=x=>be(f)?f.value=x:null),onKeydown:C[13]||(C[13]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(f)]])])]),t.object.requireFixing25?ce("",!0):(k(),B(re,{key:0},[d("tr",null,[d("td",null,[d("label",wI,$e(ne(w)?"Zoom":"Scale X"),1)]),d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":C[14]||(C[14]=x=>_.value=x),onKeydown:C[15]||(C[15]=ie(()=>{},["stop"]))},null,544),[[Ye,_.value]])])]),ne(w)?ce("",!0):(k(),B("tr",PI,[CI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1",min:"0","onUpdate:modelValue":C[16]||(C[16]=x=>A.value=x),onKeydown:C[17]||(C[17]=ie(()=>{},["stop"]))},null,544),[[Ye,A.value]])])]))],64)),d("tr",null,[xI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":C[18]||(C[18]=x=>I.value=x),onKeydown:C[19]||(C[19]=ie(()=>{},["stop"]))},null,544),[[Ye,I.value]])])]),d("tr",null,[kI,d("td",null,[Oe(d("input",{id:"zoom",type:"number",class:"smol v-w100",step:"1","onUpdate:modelValue":C[20]||(C[20]=x=>E.value=x),onKeydown:C[21]||(C[21]=ie(()=>{},["stop"]))},null,544),[[Ye,E.value]])])]),d("tr",null,[ne(w)?ce("",!0):(k(),B("td",OI,[R(ze,{modelValue:p.value,"onUpdate:modelValue":C[22]||(C[22]=x=>p.value=x),label:"Lock scale ratio?"},null,8,["modelValue"])]))])]),en(O.$slots,"transform",{},void 0,!0)]),_:3}),en(O.$slots,"options",{},void 0,!0),H.value?(k(),ae($t,{key:1,title:"Textbox settings"},{default:Y(()=>{var x;return[t.object.type==="character"||t.object.type==="sprite"?(k(),ae(ze,{key:0,label:"Enlarge when talking",modelValue:ne(h),"onUpdate:modelValue":C[23]||(C[23]=J=>be(h)?h.value=J:null)},null,8,["modelValue"])):ce("",!0),R(ze,{label:"Own textbox color",modelValue:q.value,"onUpdate:modelValue":C[24]||(C[24]=J=>q.value=J)},null,8,["modelValue"]),d("table",null,[q.value?(k(),B("tr",$I,[SI,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Ke({background:(x=t.object.textboxColor)!=null?x:""}),onClick:F},null,4)])])):ce("",!0),d("tr",null,[II,d("td",null,[Oe(d("input",{id:"namebox_width",type:"number",placeholder:j.value+"","onUpdate:modelValue":C[25]||(C[25]=J=>m.value=J)},null,8,jI),[[Ye,m.value,void 0,{lazy:!0}]])])])])]}),_:1})):ce("",!0),d("button",{onClick:C[26]||(C[26]=x=>l.value=!0)},"Image options"),d("button",{class:"v-bt0",onClick:pe},"Copy"),R(bS,{class:"v-bt0",obj:t.object},null,8,["obj"])],64))],512))}});const os=Be(TI,[["__scopeId","data-v-b46f0fb4"]]);var fs=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const AI={class:"warning"},EI={style:{"word-wrap":"break-word"}},RI={class:"button-tbl"},BI={key:0},MI={class:"arrow-col"},DI={class:"arrow-col"},LI={key:1},NI={class:"arrow-col"},FI={class:"arrow-col"},HI={class:"arrow-col"},UI=["onClick"],VI=["onClick"],WI={class:"arrow-col"},zI=["onClick"],GI=Pe({__name:"character",setup(t){const e=De(),n=L(null),o=L(null);Mt(n);const s=L(null),r=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=S(()=>e.state.ui.selection),a=S(()=>{const A=r.value.objects[l.value];if(A.type==="character")return A}),i=zo(e,a,"panels/setClose",!1,"close"),u=S(()=>{const A=a.value,I=Dr(c.value,A);if(!I)return null;for(const E of I.variants){const j=Bn(E[0],!1);if(console.log(j),j.startsWith("uploads:"))return j.substring(8)}return null}),c=S(()=>dl(e,a.value)),f=S(()=>{var A;return(A=c.value.label)!=null?A:""}),h=S(()=>o1(c.value,a.value)),v=S(()=>c.value.styleGroups[a.value.styleGroupId].styles.length>1||c.value.styleGroups.length>1),g=S(()=>c.value.styleGroups[a.value.styleGroupId].styles[a.value.styleId].poses.length>1);function b(){o.value.click()}function w(A){return fs(this,null,function*(){const I=o.value;if(!I.files)return;if(I.files.length!==1){console.error("More than one file uploaded!");return}const E=I.files[0];yield K(()=>fs(this,null,function*(){const j=URL.createObjectURL(E);yield e.dispatch("uploadUrls/add",{name:u.value,url:j})}))})}function $(A){K(()=>fs(this,null,function*(){yield e.dispatch("panels/seekPose",{id:a.value.id,panelId:a.value.panelId,delta:A})}))}function p(A){K(()=>fs(this,null,function*(){yield e.dispatch("panels/seekStyle",{id:a.value.id,panelId:a.value.panelId,delta:A})}))}function m(A,I){K(()=>fs(this,null,function*(){yield e.dispatch("panels/seekPart",{id:a.value.id,panelId:a.value.panelId,delta:I,part:A})}))}function _(A){return A.charAt(0).toUpperCase()+A.substring(1)}return Xe(()=>l.value,()=>{s.value=null}),(A,I)=>(k(),ae(os,{ref_key:"root",ref:n,object:a.value,title:f.value,showAltPanel:!!s.value},{"alt-panel":Y(()=>[s.value?(k(),ae(gS,{key:0,character:a.value,part:s.value,onLeave:I[0]||(I[0]=E=>s.value=null),onShowDialog:I[1]||(I[1]=E=>A.$emit("show-dialog",E)),onShowExpressionDialog:I[2]||(I[2]=E=>A.$emit("show-expression-dialog",E))},null,8,["character","part"])):ce("",!0)]),default:Y(()=>[u.value?(k(),B(re,{key:0},[d("p",AI,[V(" MISSING Head sprite! Click below to re-upload "),d("span",EI,'"'+$e(u.value)+'"',1),V(". ")]),d("button",{onClick:I[3]||(I[3]=E=>b())},"Re-Upload"),d("input",{type:"file",ref_key:"missingHeadUpload",ref:o,onChange:w},null,544)],64)):ce("",!0),g.value||h.value.length>0||v.value?(k(),ae($t,{key:1,class:"pose-list",title:"Pose:"},{default:Y(()=>[d("table",RI,[d("tbody",null,[v.value?(k(),B("tr",BI,[d("td",MI,[d("button",{onClick:I[4]||(I[4]=E=>p(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:I[5]||(I[5]=E=>s.value="style")}," Style ")]),d("td",DI,[d("button",{onClick:I[6]||(I[6]=E=>p(1))},">")])])):ce("",!0),g.value?(k(),B("tr",LI,[d("td",NI,[d("button",{onClick:I[7]||(I[7]=E=>$(-1))},"<")]),d("td",null,[d("button",{class:"middle-button",onClick:I[8]||(I[8]=E=>s.value="pose")}," Pose ")]),d("td",FI,[d("button",{onClick:I[9]||(I[9]=E=>$(1))},">")])])):ce("",!0),(k(!0),B(re,null,Ve(h.value,E=>(k(),B("tr",{key:E},[d("td",HI,[d("button",{onClick:j=>m(E,-1)},"<",8,UI)]),d("td",null,[d("button",{class:"middle-button",onClick:j=>s.value=E},$e(_(E)),9,VI)]),d("td",WI,[d("button",{onClick:j=>m(E,1)},">",8,zI)])]))),128))])])]),_:1})):ce("",!0)]),transform:Y(()=>[R(ze,{modelValue:ne(i),"onUpdate:modelValue":I[10]||(I[10]=E=>be(i)?i.value=E:null),label:"Close up?"},null,8,["modelValue"])]),_:1},8,["object","title","showAltPanel"]))}});const XI=Be(GI,[["__scopeId","data-v-4331b556"]]);var Cd=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const YI=t=>(_t("data-v-50b44756"),t=t(),wt(),t),qI=["onClick"],KI=YI(()=>d("tr",null,[d("td",{colspan:"2"},[d("label",{for:"choice-button-input"},"Text")])],-1)),JI=Pe({__name:"choice",setup(t){const e=De(),n=L(null);Mt(n);const o=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=S(()=>{const w=o.value.objects[e.state.ui.selection];if(w.type==="choice")return w}),r=(w,$)=>zo(e,s,$,!1,w),l=L(0),a=L(!1),i=r("autoWrap","panels/setAutoWrapping"),u=b("text"),c=S(()=>s.value.choices),f=S(()=>{if(!!a.value)return{title:"Text",get:()=>u.value,set:w=>{u.value=w},leave:()=>{a.value=!1}}});function h(w){l.value=w}function v(){K(()=>Cd(this,null,function*(){yield e.dispatch("panels/addChoice",{id:s.value.id,panelId:s.value.panelId,text:""})}))}function g(){K(()=>Cd(this,null,function*(){l.value===s.value.choices.length-1&&l.value>0&&h(l.value-1),yield e.dispatch("panels/removeChoice",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value})}))}function b(w){return S({get(){return s.value.choices[l.value][w]},set($){K(()=>{e.commit("panels/setChoiceProperty",{id:s.value.id,panelId:s.value.panelId,choiceIdx:l.value,key:w,value:$})})}})}return(w,$)=>(k(),ae(os,{ref_key:"root",ref:n,object:s.value,title:"Choice",textHandler:f.value},{default:Y(()=>[R($t,{class:"buttons",title:"Buttons:"},{default:Y(()=>[R(Wt,{maxSize:"100%",direction:"vertical",noWraping:""},{default:Y(()=>[(k(!0),B(re,null,Ve(c.value,(p,m)=>(k(),B("div",{class:Le({choiceBtn:!0,active:m===l.value}),key:m,onClick:_=>h(m)},$e(p.text.trim()===""?"[Empty]":p.text),11,qI))),128))]),_:1})]),_:1}),R($t,{class:"current_button",title:"Current button:"},{default:Y(()=>[d("table",null,[KI,d("tr",null,[d("td",null,[Oe(d("input",{id:"choice-button-input","onUpdate:modelValue":$[0]||($[0]=p=>be(u)?u.value=p:null),onKeydown:$[1]||($[1]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(u)]])]),d("td",null,[d("button",{onClick:$[2]||($[2]=p=>a.value=!0)},"...")])])])]),_:1}),d("button",{onClick:v},"Add"),d("button",{onClick:g},"Remove"),R(ze,{label:"Auto line wrap?",modelValue:ne(i),"onUpdate:modelValue":$[3]||($[3]=p=>be(i)?i.value=p:null)},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}});const QI=Be(JI,[["__scopeId","data-v-50b44756"]]),vn=t=>(_t("data-v-e852d4f2"),t=t(),wt(),t),ZI=vn(()=>d("h1",null,"Help and Credits",-1)),ej=vn(()=>d("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1)),tj=vn(()=>d("p",null,[V(" Doki Doki Dialog Generator developed by EDave64 "),d("br"),V("Based on gemdude46's DDLC Shitpost generator ")],-1)),nj=vn(()=>d("p",null,[V(" MC Sprite by Childish-N "),d("br"),V("MC Casual Sprite by SlightlySimple "),d("br"),V("MC Chibi by SlightlySimple ")],-1)),oj=vn(()=>d("p",null,[V(" MC Chad Sprite by Cylent-Nite "),d("br"),V("MC Chad Poses and expressions by SlightlySimple "),d("br"),V("MC Chad Poses and chibi by Meddy-sin ")],-1)),sj=vn(()=>d("p",null,[V(" FeMC Sprite by Meddy-sin "),d("br"),V("FeMC Casual Sprite by SlightlySimple ")],-1)),rj=vn(()=>d("p",null,"Amy Sprite by Meddy-sin and SlightlySimple",-1)),lj=vn(()=>d("p",null,"Special thanks to SlightlySimple for testing and technical help",-1)),ij=vn(()=>d("p",null," Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing ",-1)),aj=Pe({__name:"credits",setup(t){const e=L(null);return Mt(e),(n,o)=>(k(),B("div",{class:"panel",ref_key:"root",ref:e},[ZI,R(Ge,{class:"btn",to:"wiki://Dokumentation"},{default:Y(()=>[V("Help")]),_:1}),R(Ge,{class:"btn",to:"github://"},{default:Y(()=>[V("Fork me on GitHub")]),_:1}),R(Ge,{class:"btn",to:"wiki://Privacy Statement"},{default:Y(()=>[V("Privacy Statement")]),_:1}),ej,tj,d("p",null,[V(" Unused House Background by "),R(Ge,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:Y(()=>[V(" Fatelogic ")]),_:1})]),d("p",null,[V(" Aller Font by "),R(Ge,{to:"https://www.daltonmaag.com/library/aller"},{default:Y(()=>[V("Dalton Maag Ltd")]),_:1})]),d("p",null,[V(" Riffic Bold Font by "),R(Ge,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:Y(()=>[V("InkyType")]),_:1})]),d("p",null,[V(" Verily Serif Mono Font by "),R(Ge,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:Y(()=>[V("Stephen G. Hartke")]),_:1})]),d("p",null,[V(" F25 Bank Printer Font by "),R(Ge,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:Y(()=>[V("F25 Digital Typeface Design")]),_:1})]),d("p",null,[V(" Journal Font by "),R(Ge,{to:"https://www.dafont.com/journal.font"},{default:Y(()=>[V("Fontourist")]),_:1})]),d("p",null,[V(" Hashtag Font by "),R(Ge,{to:"https://www.dafont.com/hashtag.font"},{default:Y(()=>[V(" TitanVex")]),_:1})]),d("p",null,[V(" JP Hand Slanted Font by "),R(Ge,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:Y(()=>[V("Jonathan Paterson")]),_:1})]),d("p",null,[V(" As I Lay Dying Font by "),R(Ge,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:Y(()=>[V("Moises Esqueda")]),_:1})]),d("p",null,[V(" Damagrafik Script Font by "),R(Ge,{to:"https://www.dafont.com/damagrafik-script.font"},{default:Y(()=>[V("Davide Terenzi")]),_:1})]),d("p",null,[V(" Ammy's Handwriting Font by "),R(Ge,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:Y(()=>[V("Ammy K.")]),_:1})]),d("p",null,[V(" Halogen Font by "),R(Ge,{to:"https://www.dafont.com/halogen.font"},{default:Y(()=>[V("JLH Fonts")]),_:1})]),nj,d("p",null,[R(Ge,{to:"https://www.reddit.com/ofkg59"},{default:Y(()=>[V("Concept MC")]),_:1}),V(" by StormBlazed76, "),R(Ge,{to:"https://www.reddit.com/og6shh"},{default:Y(()=>[V("red")]),_:1}),V(" and "),R(Ge,{to:"https://www.reddit.com/oft3vb"},{default:Y(()=>[V("yellow")]),_:1}),V(" eyes by YinuS_WinneR, "),R(Ge,{to:"https://www.reddit.com/ofof3o"},{default:Y(()=>[V("chibi")]),_:1}),V(" by Hadrosaur838 ")]),oj,sj,d("p",null,[R(Ge,{to:"https://www.reddit.com/oizaow"},{default:Y(()=>[V("Concept FeMC")]),_:1}),V(" by ShidoDraws, "),R(Ge,{to:"https://www.reddit.com/oosuxu"},{default:Y(()=>[V("additional poses, expressions and chibi")]),_:1}),V(" by SlightlySimple ")]),rj,lj,ij],512))}});const uj=Be(aj,[["__scopeId","data-v-e852d4f2"]]),cj=t=>(_t("data-v-e3fa2c53"),t=t(),wt(),t),dj={id:"notification_text_wrapper"},fj=cj(()=>d("label",{for:"notification_text"},"Text:",-1)),pj=Pe({__name:"notification",setup(t){const e=De(),n=L(null);Mt(n);const o=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),s=S(()=>{const c=o.value.objects[e.state.ui.selection];if(c.type==="notification")return c}),r=c=>Na(e,s,"panels/setNotificationProperty",!1,c),l=r("text"),a=r("backdrop"),i=L(!1),u=S(()=>{if(!!i.value)return{title:"Text",get:()=>l.value,set:c=>{l.value=c},leave:()=>{i.value=!1}}});return(c,f)=>(k(),ae(os,{ref_key:"root",ref:n,object:s.value,title:"Notification",textHandler:u.value},{default:Y(()=>[d("div",dj,[fj,Oe(d("textarea",{"onUpdate:modelValue":f[0]||(f[0]=h=>be(l)?l.value=h:null),id:"notification_text",onKeydown:f[1]||(f[1]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(l)]]),d("button",{onClick:f[2]||(f[2]=h=>i.value=!0)},"Formatting")])]),options:Y(()=>[R(ze,{modelValue:ne(a),"onUpdate:modelValue":f[3]||(f[3]=h=>be(a)?a.value=h:null),label:"Show backdrop?"},null,8,["modelValue"])]),_:1},8,["object","textHandler"]))}});const hj=Be(pj,[["__scopeId","data-v-e3fa2c53"]]);var dt=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const uo=t=>(_t("data-v-74b7d9e5"),t=t(),wt(),t),vj=uo(()=>d("h1",null,"Panels",-1)),gj=["onClick","onKeydown"],mj={class:"panel_text"},bj={class:"panel_nr"},yj={class:"column"},_j={class:"v-w100"},wj=uo(()=>d("td",null,[d("label",{for:"export_format"},"Format")],-1)),Pj=uo(()=>d("option",{value:"image/png"},"PNG (lossless)",-1)),Cj={key:0,value:"image/webp"},xj={key:1,value:"image/heif"},kj=uo(()=>d("option",{value:"image/jpeg"},"JPEG (lossy)",-1)),Oj={key:0},$j=uo(()=>d("td",null,[d("label",{for:"export_quality"},"Quality:")],-1)),Sj={for:"export_ppi"},Ij={key:0},jj=uo(()=>d("br",null,null,-1)),Tj={for:"export_pages"},Aj={key:0},Ej=uo(()=>d("br",null,null,-1)),Rj={colspan:"2"},Bj={class:"column"},Mj=100,Dj=90,xd=70,kd=1/4,Lj=.5,Nj=Pe({__name:"panels",setup(t){const e=De(),n=L(null),{vertical:o,getRoot:s}=Mt(n),r=L(he.supports.limitedCanvasSpace?10:0),l=L(""),a=L("image/png"),i=L(Dj),u=L(!1),c=L(null),f=le().Base,h=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),v=S(()=>a.value!=="image/png"),g=S(()=>_.value.length>1);function b(W){return W===""}const w=L(!1),$=L(!1);Promise.allSettled([Do(),Fb()]).then(([W,z])=>{W.status==="fulfilled"&&(w.value=W.value),z.status==="fulfilled"&&($.value=z.value)});const p=S(()=>e.state.panels.panelOrder.indexOf(h.value.id)>0),m=S(()=>{const W=e.state.panels.panelOrder;return W.indexOf(h.value.id)<W.length-1}),_=S(()=>e.state.panels.panelOrder.map(z=>{const oe=e.state.panels.panels[z],ge=e.state.panels.panels[z],y=[...ge.order,...ge.onTopOrder].map(P=>e.state.panels.panels[z].objects[P]).map(A);return{id:z,image:oe.lastRender,text:y.reduce((P,T)=>P.length>T.length?P:T,"")}}));function A(W){switch(W.type){case"textBox":return W.text;case"notification":return W.text;case"poem":return W.text;case"choice":return W.choices.map(z=>`[${z.text}]`).join(`
`)}return""}function I(){const W=s().querySelector(".panel_button.active");W&&E(W)}function E(W){const z=W.parentElement.parentElement;e.state.ui.vertical?(z.scrollTop=W.offsetTop-z.clientHeight/2,z.scrollLeft=0):(z.scrollLeft=W.offsetLeft-z.clientWidth/2,z.scrollTop=0)}mt(()=>{I()});function j(){const W=new Date;return`cd-${[W.getFullYear(),`${W.getMonth()+1}`.padStart(2,"0"),`${W.getDate()}`.padStart(2,"0"),`${W.getHours()}`.padStart(2,"0"),`${W.getMinutes()}`.padStart(2,"0"),`${W.getSeconds()}`.padStart(2,"0")].join("-")}`}function M(){return dt(this,null,function*(){yield Wo("export image",()=>dt(this,null,function*(){const W=q(),z=a.value.split("/")[1],oe=a.value,ge=i.value,y=j();yield H(W,!0,(P,T)=>dt(this,null,function*(){yield he.saveToFile(T,`${y}_${P}.${z}`,oe,ge/Mj)}))}))})}function H(W,z,oe){return dt(this,null,function*(){const ge=le().Base,y=[];for(let P=0;P<W.length;++P){const T=W[P],D=document.createElement("canvas");D.width=ge.screenWidth,D.height=ge.screenHeight*T.length;try{const N=D.getContext("2d");for(let G=0;G<T.length;++G){const ee=T[G],X=new Fr(e,ee,ge.screenWidth,ge.screenHeight);try{yield X.render(z,!1,!0),X.paintOnto(N,{x:0,y:ge.screenHeight*G,w:ge.screenWidth,h:ge.screenHeight})}finally{X.dispose()}}y.push(yield oe(P,D))}finally{No(D)}}return y})}function te(){const W=e.state.panels.panelOrder.length-1,z=0,oe=l.value.split(","),ge=[];let y=!1;for(const P of oe){const T=P.trim(),D=T.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(!D){T!==""&&Re.fire(new At(`Could not read '${P}' in the page list.`));continue}if(y=!0,D[2])ge.push(parseInt(D[2],10)-1);else{const N=Math.max(parseInt(D[3],10)-1,z),G=Math.min(parseInt(D[4],10)-1,W);if(N==null||G==null||N>G)continue;for(let ee=N;ee<=G;++ee)ge.push(ee)}}return y?ge.sort((P,T)=>P-T).filter((P,T,D)=>D[T-1]!==P).map(P=>e.state.panels.panelOrder[P]):e.state.panels.panelOrder}function q(){const W=te();if(isNaN(r.value)&&(r.value=0),r.value===0)return[W];const z=[];for(let oe=0;oe<W.length/r.value;++oe){const ge=oe*r.value,y=ge+r.value;z.push([...W.slice(ge,y)])}return z}function pe(){return dt(this,null,function*(){yield K(()=>dt(this,null,function*(){yield e.dispatch("panels/duplicatePanel",{panelId:e.state.panels.currentPanel})})),yield eo(),I()})}function we(W){K(()=>{e.commit("panels/setCurrentPanel",{panelId:W})}),eo(()=>{I()})}function je(){K(()=>dt(this,null,function*(){yield e.dispatch("panels/delete",{panelId:e.state.panels.currentPanel})})),eo(()=>{I()})}function F(){K(()=>dt(this,null,function*(){yield e.dispatch("panels/move",{panelId:h.value.id,delta:-1})}))}function O(){K(()=>dt(this,null,function*(){yield e.dispatch("panels/move",{panelId:h.value.id,delta:1})}))}const C=lo();C.width=f.screenWidth*kd,C.height=f.screenHeight*kd;const x=C.getContext("2d"),J=L(!1),ve=S(()=>e.state.panels.panelOrder.filter(z=>e.state.panels.panels[z].lastRender==null));function Ce(){return dt(this,null,function*(){const W=Vo(e);yield Me(W)})}function Me(W){return dt(this,null,function*(){yield Wo("render thumbnail",()=>dt(this,null,function*(){const z=W.panelId;W.paintOnto(x,{x:0,y:0,w:x.canvas.width,h:x.canvas.height}),x.canvas.toBlob(oe=>{if(!oe)return;const ge=URL.createObjectURL(oe);K(()=>{e.commit("panels/setPanelPreview",{panelId:z,url:ge})})},(yield Do())?"image/webp":"image/jpeg",Lj)}))})}function at(){return dt(this,null,function*(){const W=le().Base;if(!J.value||he.supports.limitedCanvasSpace)return;const z=ve.value;if(z.length===0)return;const oe=z[0],ge=new Fr(e,oe,W.screenWidth,W.screenHeight);yield ge.render(!1,!1,!0),yield Me(ge),setTimeout(()=>{at()},500)})}mt(()=>{J.value=!0,requestAnimationFrame(()=>Ce().catch(()=>{}))}),Ut(()=>{J.value=!1,No(x.canvas)}),Re.subscribe(ra,()=>requestAnimationFrame(Ce));function Q(){return dt(this,null,function*(){const W=yield e.dispatch("getSave",!0),z=new Blob([W],{type:"text/plain"}),oe=new Date,ge=`save-${[oe.getFullYear(),`${oe.getMonth()+1}`.padStart(2,"0"),`${oe.getDate()}`.padStart(2,"0"),`${oe.getHours()}`.padStart(2,"0"),`${oe.getMinutes()}`.padStart(2,"0"),`${oe.getSeconds()}`.padStart(2,"0")].join("-")}`;he.storeSaveFile(z,`${ge}.dddg`)})}function me(){return dt(this,null,function*(){yield K(()=>dt(this,null,function*(){const W=c.value;if(!W.files)return;Re.fire(new la);const z=yield xe(W.files[0]);yield e.dispatch("loadSave",z),he.supports.limitedCanvasSpace&&Re.fire(new At("To prevent running out of memory, thumbnails will not be automatically restored in the background."))})),yield Ce(),setTimeout(()=>{at()},1e3)})}function xe(W){return new Promise((z,oe)=>{const ge=new FileReader;ge.onload=function(){z(ge.result)},ge.onerror=function(y){oe(y)},ge.readAsText(W)})}return Xe(()=>i.value,(W,z)=>{if(W===100){Re.fire(new At("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."));return}if(z>xd&&W<=xd){Re.fire(new At("Note: A quality level below 70% might be very noticeable and impair legibility of text."));return}}),Xe(()=>r.value,(W,z)=>{if(!!he.supports.limitedCanvasSpace&&(z<=10&&W>10||W===0&&_.value.length>10)){Re.fire(new At("Note: Safari has strict limitations on available memory. More images per panel can easily cause crashes."));return}}),(W,z)=>(k(),B("div",{class:"panel",ref_key:"root",ref:n},[vj,u.value?(k(),ae(La,{key:0,type:"panel",title:"","panel-id":h.value.id,"no-composition":"",onLeave:z[0]||(z[0]=oe=>{u.value=!1,Ce()})},null,8,["panel-id"])):(k(),B(re,{key:1},[R($t,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:Y(()=>[R(Wt,{"no-wraping":"",maxSize:"350px"},{default:Y(()=>[(k(!0),B(re,null,Ve(_.value,(oe,ge)=>(k(),B("div",{key:oe.id,class:Le({panel_button:!0,active:oe.id===h.value.id}),style:Ke(`background-image: url('${oe.image}')`),tabindex:"0",onClick:y=>we(oe.id),onKeydown:[lt(y=>we(oe.id),["enter"]),lt(ie(y=>we(oe.id),["prevent"]),["space"])]},[d("div",mj,[d("p",null,$e(oe.text),1)]),d("div",bj,$e(ge+1),1)],46,gj))),128))]),_:1})]),_:1}),d("div",yj,[R(Ie,{icon:"add_to_queue",onClick:pe},{default:Y(()=>[V(" Add new")]),_:1}),R(Ie,{icon:"remove_from_queue",class:"bt0",onClick:je,disabled:!g.value},{default:Y(()=>[V(" Delete panel ")]),_:1},8,["disabled"]),R(Ie,{icon:"arrow_upward",class:"bt0",onClick:F,disabled:!p.value},{default:Y(()=>[V(" Move ahead ")]),_:1},8,["disabled"]),R(Ie,{icon:"arrow_downward",class:"bt0",onClick:O,disabled:!m.value},{default:Y(()=>[V(" Move behind ")]),_:1},8,["disabled"]),R(Ie,{class:"bt0",icon:"color_lens",onClick:z[1]||(z[1]=oe=>u.value=!0)},{default:Y(()=>[V(" Image options ")]),_:1})]),R($t,{title:"Export",class:"h-h100"},{default:Y(()=>[d("table",_j,[d("tr",null,[wj,d("td",null,[Oe(d("select",{id:"export_format","onUpdate:modelValue":z[2]||(z[2]=oe=>a.value=oe)},[Pj,w.value?(k(),B("option",Cj," WebP (lossy) ")):ce("",!0),$.value?(k(),B("option",xj," HEIF (lossy) ")):ce("",!0),kj],512),[[Bt,a.value]])])]),v.value?(k(),B("tr",Oj,[$j,d("td",null,[Oe(d("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":z[3]||(z[3]=oe=>i.value=oe),onKeydown:z[4]||(z[4]=ie(()=>{},["stop"]))},null,544),[[Ye,i.value,void 0,{number:!0}]])])])):ce("",!0),d("tr",null,[d("td",null,[d("label",Sj,[V(" Panels per image: "),!v.value||ne(o)?(k(),B("small",Ij,[jj,V("(0 for one single image)")])):ce("",!0)])]),d("td",null,[Oe(d("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":z[5]||(z[5]=oe=>r.value=oe),onKeydown:z[6]||(z[6]=ie(()=>{},["stop"])),onBlur:z[7]||(z[7]=oe=>{b(r.value)&&(r.value=0)})},null,544),[[Ye,r.value,void 0,{number:!0}]])])]),d("tr",null,[d("td",null,[d("label",Tj,[V(" Panels to export: "),!v.value||ne(o)?(k(),B("small",Aj,[Ej,V("(Leave empty for all)")])):ce("",!0)])]),d("td",null,[Oe(d("input",{id:"export_pages","onUpdate:modelValue":z[8]||(z[8]=oe=>l.value=oe),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[Ye,l.value]])])]),d("tr",null,[d("td",Rj,[R(Ie,{icon:"photo_camera",class:"w100",onClick:M},{default:Y(()=>[V(" Download ")]),_:1})])])])]),_:1}),d("div",Bj,[R(Ie,{icon:"save",onClick:Q},{default:Y(()=>[V("Save")]),_:1}),R(Ie,{class:"v-bt0",icon:"folder_open",onClick:z[9]||(z[9]=oe=>c.value.click())},{default:Y(()=>[V(" Load "),d("input",{type:"file",ref_key:"loadUpload",ref:c,onChange:me},null,544)]),_:1})])],64))],512))}});const Fj=Be(Nj,[["__scopeId","data-v-74b7d9e5"]]),jv=t=>(_t("data-v-f4db8760"),t=t(),wt(),t),Hj={id:"poem_text",class:"v-w100"},Uj=jv(()=>d("label",{for:"poem_text"},"Text:",-1)),Vj=["value"],Wj=["value"],zj={key:1},Gj=jv(()=>d("td",{style:{width:"0"}},"Color:",-1)),Xj={class:"v-w100"},Yj=Pe({__name:"poem",setup(t){const e=De(),n=L(null),o=L(null),{vertical:s}=Mt(n),r=L(!1),l=L("");Xe(()=>s.value,()=>{o.value.style.height="",o.value.style.width=""});const a=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=S(()=>{const $=a.value.objects[e.state.ui.selection];if($.type==="poem")return $}),u=$=>Na(e,i,"panels/setPoemProperty",!1,$),c=S(()=>{if(!!r.value)return{title:"Text",get:()=>h.value,set:$=>{h.value=$},leave:()=>{r.value=!1}}}),f=S(()=>{if(!!l.value)return{title:"Color",get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.consoleColor;default:throw new Rt.UnreachableCaseError(l.value)}},set:$=>{K(()=>{const p=a.value.id,m=i.value.id;$!==void 0&&e.commit("panels/setPoemProperty",{key:"consoleColor",panelId:p,id:m,value:$})})},leave:()=>{l.value=""}}}),h=u("text"),v=u("autoWrap"),g=u("font"),b=u("overflow"),w=u("background");return($,p)=>(k(),ae(os,{ref_key:"root",ref:n,object:i.value,title:i.value.subType==="poem"?"Poem":"Console",textHandler:c.value,colorHandler:f.value},{default:Y(()=>[d("div",Hj,[Uj,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":p[0]||(p[0]=m=>be(h)?h.value=m:null),onKeydown:p[1]||(p[1]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(h)]]),d("button",{class:"w100 bt0",onClick:p[2]||(p[2]=m=>r.value=!0)},"Formatting")]),R(ze,{label:"Auto line wrap?",modelValue:ne(v),"onUpdate:modelValue":p[3]||(p[3]=m=>be(v)?v.value=m:null)},null,8,["modelValue"]),R(ze,{label:"Allow overflow?",modelValue:ne(b),"onUpdate:modelValue":p[4]||(p[4]=m=>be(b)?b.value=m:null),title:"When text is too long, it is shown outside the container. Uses more memory"},null,8,["modelValue"]),i.value.subType==="poem"?(k(),B(re,{key:0},[Oe(d("select",{"onUpdate:modelValue":p[5]||(p[5]=m=>be(w)?w.value=m:null),onKeydown:p[6]||(p[6]=ie(()=>{},["stop"]))},[(k(!0),B(re,null,Ve(ne(rp),(m,_)=>(k(),B("option",{value:_,key:_},$e(m.name),9,Vj))),128))],544),[[Bt,ne(w)]]),Oe(d("select",{"onUpdate:modelValue":p[7]||(p[7]=m=>be(g)?g.value=m:null),onKeydown:p[8]||(p[8]=ie(()=>{},["stop"]))},[(k(!0),B(re,null,Ve(ne(lp),(m,_)=>(k(),B("option",{value:_,key:_},$e(m.name),9,Wj))),128))],544),[[Bt,ne(g)]])],64)):(k(),B("table",zj,[d("tr",null,[Gj,d("td",Xj,[d("button",{id:"console_color",class:"w100",style:Ke([{background:i.value.consoleColor},{"min-width":"64px"}]),onClick:p[9]||(p[9]=m=>l.value="base")},null,4)])])]))]),_:1},8,["object","title","textHandler","colorHandler"]))}});const qj=Be(Yj,[["__scopeId","data-v-f4db8760"]]);var Kj=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const Dt=t=>(_t("data-v-b7c535f5"),t=t(),wt(),t),Jj=Dt(()=>d("h1",null,"Settings",-1)),Qj={class:"modal-scroll-area"},Zj=Dt(()=>d("p",null,"Do you want to allow DDDG to save settings on your device?",-1)),eT=Dt(()=>d("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1)),tT=Dt(()=>d("p",null,"You can revoke this permission at any time.",-1)),nT={class:"modal-scroll-area"},oT=Dt(()=>d("p",null,"Do you want to deny DDDG from saving settings on your device?",-1)),sT=Dt(()=>d("p",null," This will cause all your settings to reset when leaving the page. ",-1)),rT=Dt(()=>d("div",{class:"modal-scroll-area"},[d("p",null," WARNING: Swiching modes will discard everything you have done in this session. All dialouge will be lost! ")],-1)),lT={key:0,disabled:""},iT={class:"v-w100"},aT=Dt(()=>d("td",null,[d("label",null,"Theme:")],-1)),uT=Dt(()=>d("option",{value:null},"System",-1)),cT=Dt(()=>d("option",{value:!1},"Light",-1)),dT=Dt(()=>d("option",{value:!0},"Dark",-1)),fT=[uT,cT,dT],pT={key:4,class:"downloadTable"},hT=Dt(()=>d("td",null,[d("label",null,"Download folder:")],-1)),vT=Pe({__name:"settings",setup(t){const e=De(),n=L(null);Mt(n);function o(){var j;he.saveSettings({lq:e.state.ui.lqRendering,nsfw:e.state.ui.nsfw,darkMode:(j=e.state.ui.useDarkTheme)!=null?j:void 0,looseTextParsing:he.state.looseTextParsing,defaultCharacterTalkingZoom:e.state.ui.defaultCharacterTalkingZoom})}const s=S(()=>he.supports.optionalSaving),r=L(!1),l=L(!1),a=L(!1),i=S({get(){return he.savingEnabled},set(j){a.value=!0,he.savingEnabled=j,o()}});function u(j){r.value=!1,j==="Allow"&&(i.value=!0)}function c(j){l.value=!1,j==="Deny"&&(i.value=!1)}Xe(()=>i.value,()=>a.value=!1);const f=L(!1),h=S(()=>he.gameMode==="ddlc_plus");function v(j){Wo("changing modes",()=>Kj(this,null,function*(){j==="Enter Classic Mode"?yield he.setGameMode("ddlc"):j==="Enter Plus mode"?yield he.setGameMode("ddlc_plus"):f.value=!1}))}const g=S(()=>he.supports.lq),b=S({get(){return e.state.ui.lqRendering},set(j){K(()=>{e.commit("ui/setLqRendering",j)}),o()}}),w=S({get(){return!!e.state.ui.nsfw},set(j){K(()=>{e.commit("ui/setNsfw",j),o()})}}),$=S({get(){return!!e.state.ui.defaultCharacterTalkingZoom},set(j){K(()=>{e.commit("ui/setDefaultCharacterTalkingZoom",j),o()})}}),p=S({get(){return he.state.looseTextParsing},set(j){he.state.looseTextParsing=j,o()}}),m=S({get(){return e.state.ui.useDarkTheme},set(j){K(()=>{e.commit("ui/setDarkTheme",j),o()})}}),_=S(()=>he.supports.setDownloadFolder),A=S(()=>he.state.downloadLocation);function I(){he.updateDownloadFolder()}function E(){he.openFolder("downloads")}return(j,M)=>(k(),B("div",{class:"panel",ref_key:"root",ref:n},[Jj,(k(),ae(yf,{to:"#modal-messages"},[r.value?(k(),ae(So,{key:0,options:["Allow","Deny"],onLeave:M[0]||(M[0]=H=>u("Deny")),onOption:u,"no-base-size":""},{default:Y(()=>[d("div",Qj,[Zj,eT,tT,d("p",null,[V(" Our usual "),R(Ge,{to:"wiki://Privacy Statement"},{default:Y(()=>[V("privacy policy")]),_:1}),V(" still applies. ")])])]),_:1})):ce("",!0),l.value?(k(),ae(So,{key:1,options:["Deny","Cancle"],onLeave:M[1]||(M[1]=H=>c("Cancel")),onOption:c,"no-base-size":""},{default:Y(()=>[d("div",nT,[oT,sT,d("p",null,[V(" Our usual "),R(Ge,{to:"wiki://Privacy Statement"},{default:Y(()=>[V("privacy policy")]),_:1}),V(" still applies. ")])])]),_:1})):ce("",!0),f.value?(k(),ae(So,{key:2,options:[h.value?"Enter Classic Mode":"Enter Plus mode","Stay"],onLeave:M[2]||(M[2]=H=>f.value=!1),onOption:v,"no-base-size":""},{default:Y(()=>[rT]),_:1},8,["options"])):ce("",!0)])),a.value?(k(),B("button",lT,"Applying...")):!i.value&&s.value?(k(),B("button",{key:1,onClick:M[3]||(M[3]=H=>r.value=!0)}," Allow saving options ")):i.value&&s.value?(k(),B("button",{key:2,onClick:M[4]||(M[4]=H=>l.value=!0)}," Deny saving options ")):ce("",!0),d("button",{onClick:M[5]||(M[5]=H=>f.value=!0)},[h.value?(k(),B(re,{key:0},[V(" Enter Classic Mode ")],64)):(k(),B(re,{key:1},[V(" Enter DDLC Plus Mode ")],64))]),g.value?(k(),ae(ze,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:b.value,"onUpdate:modelValue":M[6]||(M[6]=H=>b.value=H)},null,8,["modelValue"])):ce("",!0),R(ze,{label:"NSFW Mode?",modelValue:w.value,"onUpdate:modelValue":M[7]||(M[7]=H=>w.value=H)},null,8,["modelValue"]),R(ze,{label:"Enlarge talking objects? (Default value)",modelValue:$.value,"onUpdate:modelValue":M[8]||(M[8]=H=>$.value=H)},null,8,["modelValue"]),R(ze,{label:"Fault tolerant text parsing",title:"Silently ignore parse errors in texts. (Like unexpected '{' characters) Prevents beginners from getting stuck working with textboxes, but also makes it harder to understand what you are doing wrong.",modelValue:p.value,"onUpdate:modelValue":M[9]||(M[9]=H=>p.value=H)},null,8,["modelValue"]),d("table",iT,[d("tr",null,[aT,d("td",null,[Oe(d("select",{"onUpdate:modelValue":M[10]||(M[10]=H=>m.value=H),class:"v-w100"},fT,512),[[Bt,m.value]])])])]),_.value?(k(),B("table",pT,[d("tr",null,[hT,d("td",null,$e(A.value),1),d("td",null,[d("button",{onClick:I},"Set"),d("button",{onClick:E},"Open")])])])):ce("",!0)],512))}});const gT=Be(vT,[["__scopeId","data-v-b7c535f5"]]);var Od=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const mT={class:"warning"},bT={style:{"word-wrap":"break-word"}},yT=Pe({__name:"sprite",setup(t){const e=De(),n=L(null),o=L(null);Mt(n);const s=S(()=>{for(const u of l.value.assets){const c=Bn(u,!1);if(console.log(c),c.startsWith("uploads:"))return c.substring(8)}return null}),r=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),l=S(()=>{const u=r.value.objects[e.state.ui.selection];if(u.type==="sprite")return u});function a(){o.value.click()}function i(u){return Od(this,null,function*(){const c=o.value;if(!c.files)return;if(c.files.length!==1){console.error("More than one file uploaded!");return}const f=c.files[0];yield K(()=>Od(this,null,function*(){const h=URL.createObjectURL(f);yield e.dispatch("uploadUrls/add",{name:s.value,url:h})}))})}return(u,c)=>(k(),ae(os,{ref_key:"root",ref:n,object:l.value,title:"Custom Sprite"},{default:Y(()=>[s.value?(k(),B(re,{key:0},[d("p",mT,[V(" MISSING SPRITE! Click below to re-upload "),d("span",bT,'"'+$e(s.value)+'"',1),V(". ")]),d("button",{onClick:c[0]||(c[0]=f=>a())},"Re-Upload"),d("input",{type:"file",ref_key:"missingSpriteUpload",ref:o,onChange:i},null,544)],64)):ce("",!0)]),_:1},8,["object"]))}});const _T=Be(yT,[["__scopeId","data-v-55fd1d74"]]);var $d=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const ht=t=>(_t("data-v-66c34976"),t=t(),wt(),t),wT={class:"upper-combos"},PT=ht(()=>d("td",null,[d("label",{for:"text_style"},"Style:")],-1)),CT={colspan:"2"},xT=ht(()=>d("option",{value:"normal"},"Normal",-1)),kT=ht(()=>d("option",{value:"corrupt"},"Corrupt",-1)),OT=ht(()=>d("option",{value:"custom"},"Custom",-1)),$T=ht(()=>d("option",{value:"custom_plus"},"Custom (Plus)",-1)),ST=ht(()=>d("option",{value:"none"},"None",-1)),IT=[xT,kT,OT,$T,ST],jT=ht(()=>d("td",null,[d("label",{for:"current_talking"},"Person talking:")],-1)),TT=ht(()=>d("option",{value:"$null$"},"No-one",-1)),AT=["value"],ET=ht(()=>d("option",{value:"$other$"},"Other",-1)),RT=["disabled"],BT=ht(()=>d("td",null,[d("label",{for:"custom_name"},"Other name:")],-1)),MT={id:"dialog_text_wrapper",class:"v-w100"},DT=ht(()=>d("label",{for:"dialog_text"},"Dialog:",-1)),LT={key:0},NT=ht(()=>d("td",null,[d("label",{for:"custom_namebox_width"},"Namebox width:")],-1)),FT=["placeholder"],HT={colspan:"2"},UT={key:0},VT=ht(()=>d("td",null,[d("label",{for:"textbox_color"},"Color:")],-1)),WT={key:1},zT={colspan:"2"},GT=ht(()=>d("td",null,[d("label",{for:"custom_controls_color"},"Controls color:")],-1)),XT=ht(()=>d("td",null,[d("label",{for:"custom_namebox_color"},"Namebox color:")],-1)),YT=ht(()=>d("td",null,[d("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1)),qT=Pe({__name:"textbox",setup(t){const e=De(),n=L(null),o=L(null),{vertical:s}=Mt(n),r=L(""),l=L("");Xe(()=>s.value,()=>{o.value.style.height="",o.value.style.width=""});const a=S(()=>e.state.panels.panels[e.state.panels.currentPanel]),i=S(()=>{const O=a.value.objects[e.state.ui.selection];if(O.type==="textBox")return O}),u=O=>Na(e,i,"panels/setTextBoxProperty",!1,O),c=S(()=>{if(!!r.value)return{title:b.value,get(){return r.value==="name"?i.value.talkingOther:r.value==="body"?_.value:""},set(O){r.value==="name"?v.value=O:r.value==="body"&&(_.value=O)},leave(){r.value=""}}}),f=S(()=>{if(!!l.value)return{title:w.value,get:()=>{switch(l.value){case"":return"#000000";case"base":return i.value.customColor;case"controls":return i.value.customControlsColor;case"namebox":return i.value.customNameboxColor;case"nameboxStroke":return i.value.customNameboxStroke;default:throw new Rt.UnreachableCaseError(l.value)}},set:O=>{K(()=>{const C=a.value.id,x=i.value.id;let J={base:"customColor",controls:"customControlsColor",namebox:"customNameboxColor",nameboxStroke:"customNameboxStroke","":void 0}[l.value];O!==void 0&&e.commit("panels/setTextBoxProperty",kv(C,x,J,O))})},leave:()=>{l.value=""}}}),h=S({get(){var O;return(O=i.value.talkingObjId)!=null?O:"$null$"},set(O){K(()=>{e.commit("panels/setTalkingObject",{id:i.value.id,panelId:i.value.panelId,talkingObjId:O==="$null$"?null:O})})}}),v=zo(e,i,"panels/setTalkingOther",!1,"talkingOther"),g=S(()=>{const O=a.value,C=[];for(const x of[...O.order,...O.onTopOrder]){const J=O.objects[x];J.label!==null&&C.push([x,J.label])}return C}),b=S(()=>r.value==="name"?"Name":r.value==="body"?"Dialog":""),w=S(()=>{switch(l.value){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:throw new Rt.UnreachableCaseError(l.value)}}),$=u("autoQuoting"),p=u("autoWrap"),m=u("overflow"),_=u("text"),A=S(()=>I.value.startsWith("custom")),I=zo(e,i,"panels/setStyle",!0,"style"),E=u("controls"),j=u("skip"),M=u("continue"),H=u("overrideColor"),te=u("deriveCustomColors"),q=u("customNameboxWidth"),pe=S(()=>le().TextBox.NameboxWidth);function we(){K(()=>$d(this,null,function*(){yield e.dispatch("panels/splitTextbox",{id:i.value.id,panelId:i.value.panelId})}))}function je(){K(()=>$d(this,null,function*(){yield e.dispatch("panels/resetTextboxBounds",{id:i.value.id,panelId:i.value.panelId})}))}function F(){K(()=>{e.commit("ui/setSelection",h.value)})}return(O,C)=>(k(),ae(os,{ref_key:"root",ref:n,object:i.value,title:"Textbox",textHandler:c.value,colorHandler:f.value},{default:Y(()=>[d("table",wT,[d("tr",null,[PT,d("td",CT,[Oe(d("select",{id:"text_style","onUpdate:modelValue":C[0]||(C[0]=x=>be(I)?I.value=x:null),onKeydown:C[1]||(C[1]=ie(()=>{},["stop"]))},IT,544),[[Bt,ne(I)]])])]),d("tr",null,[jT,d("td",null,[Oe(d("select",{id:"current_talking","onUpdate:modelValue":C[2]||(C[2]=x=>h.value=x),onKeydown:C[3]||(C[3]=ie(()=>{},["stop"]))},[TT,(k(!0),B(re,null,Ve(g.value,([x,J])=>(k(),B("option",{key:x,value:x},$e(J),9,AT))),128)),ET],544),[[Bt,h.value]])]),d("td",null,[d("button",{title:"Jump to talking character",onClick:F,disabled:h.value==="$null$"||h.value==="$other$"}," > ",8,RT)])]),d("tr",null,[BT,d("td",null,[Oe(d("input",{id:"custom_name","onUpdate:modelValue":C[4]||(C[4]=x=>be(v)?v.value=x:null),onKeydown:C[5]||(C[5]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(v)]])]),d("td",null,[d("button",{onClick:C[6]||(C[6]=x=>r.value="name")},"...")])])]),R(ze,{label:"Auto quoting?",modelValue:ne($),"onUpdate:modelValue":C[7]||(C[7]=x=>be($)?$.value=x:null),title:"Try to automatically fix missing/unclosed quotation marks when a character is speaking"},null,8,["modelValue"]),R(ze,{label:"Auto line wrap?",modelValue:ne(p),"onUpdate:modelValue":C[8]||(C[8]=x=>be(p)?p.value=x:null),title:"Automatically insert line breaks when a line of text is larger than the textbox"},null,8,["modelValue"]),R(ze,{label:"Allow overflow?",modelValue:ne(m),"onUpdate:modelValue":C[9]||(C[9]=x=>be(m)?m.value=x:null),title:"When text is too long, it is shown outside the textbox. Uses more memory"},null,8,["modelValue"]),d("div",MT,[DT,Oe(d("textarea",{class:"v-w100",ref_key:"textarea",ref:o,"onUpdate:modelValue":C[10]||(C[10]=x=>be(_)?_.value=x:null),id:"dialog_text",onKeydown:C[11]||(C[11]=ie(()=>{},["stop"]))},null,544),[[Ye,ne(_)]]),d("button",{class:"w100 bt0",onClick:C[12]||(C[12]=x=>r.value="body")}," Formatting ")])]),options:Y(()=>[R($t,{title:"Customization:",class:Le(A.value?"customization-set":"")},{default:Y(()=>[R(Wt,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:Y(()=>[R(ze,{label:"Controls visible?",modelValue:ne(E),"onUpdate:modelValue":C[13]||(C[13]=x=>be(E)?E.value=x:null)},null,8,["modelValue"]),R(ze,{label:"Able to skip?",modelValue:ne(j),"onUpdate:modelValue":C[14]||(C[14]=x=>be(j)?j.value=x:null)},null,8,["modelValue"]),R(ze,{label:"Continue arrow?",modelValue:ne(M),"onUpdate:modelValue":C[15]||(C[15]=x=>be(M)?M.value=x:null)},null,8,["modelValue"]),A.value?(k(),B("table",LT,[d("tr",null,[NT,d("td",null,[Oe(d("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},placeholder:pe.value+"","onUpdate:modelValue":C[16]||(C[16]=x=>be(q)?q.value=x:null),onKeydown:C[17]||(C[17]=ie(()=>{},["stop"]))},null,40,FT),[[Ye,ne(q),void 0,{number:!0}]])])]),d("tr",null,[d("td",HT,[R(ze,{modelValue:ne(H),"onUpdate:modelValue":C[18]||(C[18]=x=>be(H)?H.value=x:null),label:"Override color"},null,8,["modelValue"])])]),ne(H)?(k(),B("tr",UT,[VT,d("td",null,[d("button",{id:"textbox_color",class:"color-button",style:Ke({background:i.value.customColor}),onClick:C[19]||(C[19]=x=>l.value="base")},null,4)])])):ce("",!0),ne(H)?(k(),B("tr",WT,[d("td",zT,[R(ze,{id:"derive_custom_colors",modelValue:ne(te),"onUpdate:modelValue":C[20]||(C[20]=x=>be(te)?te.value=x:null),label:"Derive other colors"},null,8,["modelValue"])])])):ce("",!0),ne(H)&&!ne(te)?(k(),B(re,{key:2},[d("tr",null,[GT,d("td",null,[d("button",{id:"custom_controls_color",class:"color-button",style:Ke({background:i.value.customControlsColor}),onClick:C[21]||(C[21]=x=>l.value="controls")},null,4)])]),d("tr",null,[XT,d("td",null,[d("button",{id:"custom_namebox_color",class:"color-button",style:Ke({background:i.value.customNameboxColor}),onClick:C[22]||(C[22]=x=>l.value="namebox")},null,4)])]),d("tr",null,[YT,d("td",null,[d("button",{id:"custom_namebox_stroke",class:"color-button",style:Ke({background:i.value.customNameboxStroke}),onClick:C[23]||(C[23]=x=>l.value="nameboxStroke")},null,4)])])],64)):ce("",!0)])):ce("",!0)]),_:1})]),_:1},8,["class"]),d("button",{onClick:je},"Reset position"),d("button",{class:"bt0",onClick:we},"Split textbox")]),_:1},8,["object","textHandler","colorHandler"]))}});const KT=Be(qT,[["__scopeId","data-v-66c34976"]]),JT={id:"toolbar"},QT={id:"toolbar-end"},ZT=Pe({__name:"toolbox",emits:["show-dialog","show-prev-render","download","show-expression-dialog"],setup(t,{emit:e}){const n=De(),o=e,s=L(null),r=L("add"),l=S(()=>n.state.panels.panels[n.state.panels.currentPanel]),a=S(()=>n.state.ui.vertical),i=S(()=>n.state.ui.selection),u=S(()=>{if(r.value==="selection")if(i.value===null)r.value="add";else return l.value.objects[i.value].type;return r.value}),c=S(()=>n.state.ui.lastDownload!==null);function f(v){v===r.value&&(v="add"),r.value=v,i.value!==null&&n.commit("ui/setSelection",null)}function h(){s.value instanceof HTMLElement&&(s.value.scrollTop=0,s.value.scrollLeft=0)}return Xe(()=>i.value,v=>{if(v!=null){r.value="selection";return}r.value==="selection"&&(r.value="add")}),he.onPanelChange(v=>{r.value=v}),(v,g)=>(k(),B("div",{id:"panels",class:Le({vertical:a.value}),onScroll:h,ref_key:"panels",ref:s},[d("div",JT,[R(Ie,{icon:"add_box","icon-pos":"top",class:Le({active:u.value==="add"}),title:"Add new objects to the scene",shortcut:"a",onClick:g[0]||(g[0]=b=>f("add"))},null,8,["class"]),R(Ie,{icon:"panorama","icon-pos":"top",class:Le({active:u.value==="backgrounds"}),title:"Change the current background",shortcut:"s",onClick:g[1]||(g[1]=b=>f("backgrounds"))},null,8,["class"]),R(Ie,{icon:"view_module","icon-pos":"top",class:Le({active:u.value==="panels"}),title:"Panels",shortcut:"d",onClick:g[2]||(g[2]=b=>f("panels"))},null,8,["class"]),R(Ie,{icon:"settings_applications","icon-pos":"top",class:Le({active:u.value==="settings"}),title:"Settings",shortcut:"f",onClick:g[3]||(g[3]=b=>f("settings"))},null,8,["class"])]),u.value==="settings"?(k(),ae(gT,{key:0})):u.value==="backgrounds"?(k(),ae(dS,{key:1,onShowDialog:g[4]||(g[4]=b=>o("show-dialog",b))})):u.value==="help_credits"?(k(),ae(uj,{key:2})):u.value==="character"?(k(),ae(XI,{key:3,onShowDialog:g[5]||(g[5]=b=>o("show-dialog",b)),onShowExpressionDialog:g[6]||(g[6]=b=>o("show-expression-dialog",b))})):u.value==="sprite"?(k(),ae(_T,{key:4})):u.value==="textBox"?(k(),ae(KT,{key:5})):u.value==="choice"?(k(),ae(QI,{key:6})):u.value==="panels"?(k(),ae(Fj,{key:7})):u.value==="notification"?(k(),ae(hj,{key:8})):u.value==="poem"?(k(),ae(qj,{key:9})):(k(),ae(Jk,{key:10,onShowDialog:g[7]||(g[7]=b=>o("show-dialog",b))})),d("div",QT,[R(Ie,{icon:"help","icon-pos":"top",class:Le({active:u.value==="help_credits"}),title:"Help & Credits",shortcut:"h",onClick:g[8]||(g[8]=b=>f("help_credits"))},null,8,["class"]),R(Ie,{icon:"extension","icon-pos":"top",title:"Content Packs",shortcut:"p",onClick:g[9]||(g[9]=b=>o("show-dialog"))}),R(Ie,{icon:"flip_to_back","icon-pos":"top",title:"Show last downloaded panel",shortcut:"l",onClick:g[10]||(g[10]=b=>o("show-prev-render")),disabled:!c.value},null,8,["disabled"]),R(Ie,{icon:"photo_camera","icon-pos":"top",title:"Take a screenshot of the current scene",shortcut:"i",onClick:g[11]||(g[11]=b=>o("download"))})])],34))}});var ar=(t,e,n)=>new Promise((o,s)=>{var r=i=>{try{a(n.next(i))}catch(u){s(u)}},l=i=>{try{a(n.throw(i))}catch(u){s(u)}},a=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,l);a((n=n.apply(t,e)).next())});const e2={id:"app"},t2={class:"hidden-selectors"},n2=["data-obj-id","onKeydown"],o2=d("div",{id:"modal-messages"},null,-1),s2=20,Sd=16/9,r2=50,l2=Pe({__name:"app",setup(t){const e=tu(()=>Bu(()=>import("./single-box.c9c8f5af.js"),["./single-box.c9c8f5af.js","./single-box.162d7427.css"],import.meta.url)),n=tu(()=>Bu(()=>import("./index.e348a005.js"),["./index.e348a005.js","./index.385525f4.css"],import.meta.url)),o=De(),s=L(!0),r=L(null),l=S(()=>{const x=o.state.panels,J=x.panels[x.currentPanel];return J==null?[]:[...J.order,...J.onTopOrder]});function a(){const x=o.state.ui.lastDownload;x!=null&&r.value.blendOver(x)}function i(x){x.preventDefault()}mt(()=>{document.body.addEventListener("drop",i,!0),document.body.addEventListener("dragover",i,!0)}),Ut(()=>{document.body.removeEventListener("drop",i,!0),document.body.removeEventListener("dragover",i,!0)});const u=L(0),c=L(0),f=L(192);function h(x,J){let ve=x/Sd,Ce=J*Sd;return ve>J?ve=J:Ce=x,[Ce,ve]}function v(x,J){const ve=h(x,J-f.value),Ce=h(x-f.value,J);return ve[0]*ve[1]>Ce[0]*Ce[1]?[ve[0],ve[1],!1]:[Ce[0],Ce[1],!0]}function g(){const[x,J,ve]=v(document.documentElement.clientWidth,document.documentElement.clientHeight);u.value=x,c.value=J,o.state.ui.vertical!==ve&&o.commit("ui/setVertical",ve)}g(),mt(()=>{window.addEventListener("resize",g)}),Ut(()=>{window.removeEventListener("resize",g)});const b=L(!1),w=S(()=>o.state.ui.useDarkTheme),$=S(()=>{var x;return(x=w.value)!=null?x:b.value});if(Xe(()=>$.value,x=>{document.body.classList.toggle("dark-theme",x)},{immediate:!0}),window.matchMedia!=null){const x=window.matchMedia("(prefers-color-scheme: dark)");b.value=x.matches;const J=ve=>b.value=ve.matches;x.addEventListener?x.addEventListener("change",J):x.addListener(J)}const p=L(!1),m=L(""),_=L(void 0);function A(x){p.value=!0,m.value=x.character,_.value=x.headGroup}const I=L(null),E=L(!1);function j(x){if(E.value=!0,x==null)return;const J=()=>{I.value?I.value.setSearch(x):setTimeout(J,r2)};eo(J)}const M=S(()=>o.state.ui.nsfw);Xe(()=>M.value,x=>ar(this,null,function*(){x?yield o.dispatch("content/loadContentPacks",a0):yield o.dispatch("removePacks",{packs:i0})}));let H=null;function te(){H==null&&(H=requestAnimationFrame(()=>{H=null,Re.fire(new el)}))}function q(x){if(x.target instanceof HTMLInputElement||x.target instanceof HTMLTextAreaElement){console.log("skip keydown on potential target");return}K(()=>ar(this,null,function*(){const J=x.ctrlKey&&!x.altKey&&!x.metaKey&&!x.shiftKey,ve=!x.ctrlKey&&!x.altKey&&!x.metaKey&&!x.shiftKey;if(J&&x.key==="v"){yield o.dispatch("panels/pasteObjectFromClipboard",{}),x.preventDefault();return}if(ve&&x.key==="Escape"){if(o.state.ui.selection===null)return;o.commit("ui/setSelection",null);return}const Me=o.state.panels.panels[o.state.panels.currentPanel].objects[o.state.ui.selection];if(Me!=null){if(J){if(x.key==="c"||x.key==="x"){yield o.dispatch("panels/copyObjectToClipboard",{id:Me.id,panelId:Me.panelId}),x.key==="x"&&(yield o.dispatch("panels/removeObject",{id:Me.id,panelId:Me.panelId})),x.preventDefault();return}}else if(ve){if(x.key==="Delete"){yield o.dispatch("panels/removeObject",{id:Me.id,panelId:Me.panelId});return}if(x.key==="/"||x.key==="*"){let xe=x.key==="/"?-10:10;x.shiftKey&&(xe/=Math.abs(xe)),o.commit("panels/setRotation",{id:Me.id,panelId:Me.panelId,rotation:Me.rotation+xe}),x.stopPropagation(),x.preventDefault();return}if(Me.type==="character"){const xe=Me;if(!xe.freeMove){if(x.key==="ArrowLeft"){yield o.dispatch("panels/shiftCharacterSlot",{id:xe.id,panelId:xe.panelId,delta:-1});return}if(x.key==="ArrowRight"){yield o.dispatch("panels/shiftCharacterSlot",{id:xe.id,panelId:xe.panelId,delta:1});return}}}let{x:at,y:Q}=Me;const me=x.shiftKey?1:s2;switch(x.key){case"ArrowLeft":at-=me;break;case"ArrowRight":at+=me;break;case"ArrowUp":Q-=me;break;case"ArrowDown":Q+=me;break;default:return}yield o.dispatch("panels/setPosition",{id:Me.id,panelId:Me.panelId,x:at,y:Q})}}}))}mt(()=>{window.addEventListener("keydown",q)}),Ut(()=>{window.removeEventListener("keydown",q)});let pe=null,we=!1;function je(x){x.ctrlKey?!we&&pe===null&&(pe=setTimeout(F)):O()}function F(){document.body.classList.add("ctrl-key"),we=!0}function O(){pe!==null&&(clearTimeout(pe),pe=null),document.body.classList.remove("ctrl-key"),we=!1}mt(()=>{for(const x of["keydown","keyup","mousemove"])window.addEventListener(x,je,!0);window.addEventListener("blur",O)}),Ut(()=>{for(const x of["keydown","keyup","mousemove"])window.removeEventListener(x,je,!0);window.removeEventListener("blur",O)});function C(x){K(()=>{o.state.ui.selection!==x&&o.commit("ui/setSelection",x)})}return Xe(()=>o.state.ui.selection,x=>{var J,ve;((J=document.activeElement)==null?void 0:J.getAttribute("data-obj-id"))!==""+x&&((ve=document.querySelector(`*[data-obj-id='${x}']`))==null||ve.focus({focusVisible:!1,preventScroll:!0}))},{immediate:!0}),pn.setStore(o),window.store=o,window.env=he,mt(()=>ar(this,null,function*(){yield he.loadGameMode(),he.connectToStore(o),s.value=!1;const x=yield he.loadSettings();yield K(()=>ar(this,null,function*(){var J,ve,Ce,Me;he.state.looseTextParsing=x.looseTextParsing||!0,o.commit("ui/setLqRendering",(J=x.lq)!=null?J:!1),o.commit("ui/setDarkTheme",(ve=x.darkMode)!=null?ve:null),o.commit("ui/setDefaultCharacterTalkingZoom",(Ce=x.defaultCharacterTalkingZoom)!=null?Ce:!0),yield o.dispatch("content/loadContentPacks",[`${ct}packs/buildin.base.backgrounds.json`,`${ct}packs/buildin.base.monika.json`,`${ct}packs/buildin.base.sayori.json`,`${ct}packs/buildin.base.natsuki.json`,`${ct}packs/buildin.base.yuri.json`,`${ct}packs/buildin.extra.mc.json`,`${ct}packs/buildin.extra.concept_mc.json`,`${ct}packs/buildin.extra.mc_chad.json`,`${ct}packs/buildin.extra.femc.json`,`${ct}packs/buildin.extra.concept_femc.json`,`${ct}packs/buildin.extra.amy.json`]),yield he.loadContentPacks();const at=yield o.dispatch("panels/createPanel");Object.keys(o.state.panels.panels[at].objects).length===0&&(yield o.dispatch("panels/createTextBox",{panelId:at,text:`Hi! Click here to edit this textbox! ${o.state.ui.vertical?"To the right":"At the bottom"} you find the toolbox. There you can add things (try clicking the chibis), change backgrounds and more! Use the camera icon to download the image.`})),o.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:o.state.panels.currentPanel}),o.commit("ui/setNsfw",(Me=x.nsfw)!=null?Me:!1)}))})),(x,J)=>(k(),B(re,null,[d("div",e2,[d("div",t2,[(k(!0),B(re,null,Ve(l.value,ve=>(k(),B("div",{key:ve,tabindex:"0","data-obj-id":ve,onFocus:J[0]||(J[0]=Ce=>te()),onBlur:J[1]||(J[1]=Ce=>te()),onKeydown:[lt(ie(Ce=>C(ve),["prevent"]),["enter"]),lt(ie(Ce=>C(ve),["prevent"]),["space"])]},null,40,n2))),128))]),R(Pk,{ref_key:"renderer",ref:r,canvasWidth:u.value,canvasHeight:c.value,preLoading:s.value},null,8,["canvasWidth","canvasHeight","preLoading"]),R(nk),R(ZT,{onShowPrevRender:a,onDownload:J[2]||(J[2]=ve=>r.value.download()),onShowDialog:j,onShowExpressionDialog:A}),(k(),ae(Dg,null,[E.value?(k(),ae(So,{key:0,ref:"dialog",onLeave:J[4]||(J[4]=ve=>E.value=!1)},{default:Y(()=>[R(ne(e),{ref_key:"packDialog",ref:I,onLeave:J[3]||(J[3]=ve=>E.value=!1)},null,512)]),_:1},512)):ce("",!0)],1024)),p.value?(k(),ae(So,{key:0,ref:"dialog",onLeave:J[6]||(J[6]=ve=>p.value=!1)},{default:Y(()=>[R(ne(n),{character:m.value,initHeadGroup:_.value,onLeave:J[5]||(J[5]=ve=>p.value=!1)},null,8,["character","initHeadGroup"])]),_:1},512)):ce("",!0)]),o2],64))}});ab(l2).use(Yx).mount("#main_wrapper");export{Ut as A,Oe as B,Ye as C,gm as D,af as E,re as F,Wo as G,Re as H,Nn as I,en as J,Iv as K,Sv as L,Bt as M,$t as N,Lo as O,ah as P,K as Q,pn as R,Bn as S,a2 as T,y1 as U,Mf as V,vr as W,_v as X,un as Y,Be as _,B as a,d as b,S as c,Pe as d,Ve as e,ce as f,R as g,Y as h,eo as i,V as j,ne as k,Ge as l,ae as m,Le as n,k as o,ze as p,Ke as q,L as r,ie as s,$e as t,De as u,he as v,Xe as w,_t as x,wt as y,mt as z};
